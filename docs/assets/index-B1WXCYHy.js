var Xc=Object.defineProperty;var jc=(t,e,n)=>e in t?Xc(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var le=(t,e,n)=>jc(t,typeof e!="symbol"?e+"":e,n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();const Bo=!1;var uo=Array.isArray,Jc=Array.prototype.indexOf,da=Array.from,ll=Object.defineProperty,Jn=Object.getOwnPropertyDescriptor,cl=Object.getOwnPropertyDescriptors,Qc=Object.prototype,tu=Array.prototype,ha=Object.getPrototypeOf;function eu(t){return typeof t=="function"}const Re=()=>{};function nu(t){return t()}function Hi(t){for(var e=0;e<t.length;e++)t[e]()}const Qe=2,ul=4,fo=8,ho=16,En=32,gi=64,Oi=128,je=256,Ui=512,Ce=1024,Nn=2048,ir=4096,Cn=8192,go=16384,fl=32768,po=65536,dl=1<<17,ru=1<<19,hl=1<<20,kn=Symbol("$state"),iu=Symbol("legacy props"),ou=Symbol("");function gl(t){return t===this.v}function pl(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function ga(t){return!pl(t,this.v)}function au(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function su(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function lu(t){throw new Error("https://svelte.dev/e/effect_orphan")}function cu(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function ml(t){throw new Error("https://svelte.dev/e/lifecycle_legacy_only")}function uu(t){throw new Error("https://svelte.dev/e/props_invalid_value")}function fu(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function du(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function hu(){throw new Error("https://svelte.dev/e/state_unsafe_local_read")}function gu(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}let Sr=!1,pu=!1;function mu(){Sr=!0}const pa=1,ma=2,vl=4,vu=8,yu=16,_u=1,xu=2,bu=4,wu=8,Tu=16,Cu=4,ku=1,$u=2,De=Symbol();function Er(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}let Ot=null;function Za(t){Ot=t}function zu(t,e){return Mu().set(t,e),e}function ke(t,e=!1,n){Ot={p:Ot,c:null,e:null,m:!1,s:t,x:null,l:null},Sr&&!e&&(Ot.l={s:null,u:null,r1:[],r2:Ke(!1)})}function $e(t){const e=Ot;if(e!==null){t!==void 0&&(e.x=t);const a=e.e;if(a!==null){var n=ee,r=re;e.e=null;try{for(var i=0;i<a.length;i++){var o=a[i];hn(o.effect),dn(o.reaction),Dr(o.fn)}}finally{hn(n),dn(r)}}Ot=e.p,e.m=!0}return t||{}}function mo(){return!Sr||Ot!==null&&Ot.l===null}function Mu(t){return Ot===null&&Er(),Ot.c??(Ot.c=new Map(Au(Ot)||void 0))}function Au(t){let e=t.p;for(;e!==null;){const n=e.c;if(n!==null)return n;e=e.p}return null}function Ke(t,e){var n={f:0,v:t,reactions:null,equals:gl,rv:0,wv:0};return n}function vo(t,e=!1){var r;const n=Ke(t);return e||(n.equals=ga),Sr&&Ot!==null&&Ot.l!==null&&((r=Ot.l).s??(r.s=[])).push(n),n}function _t(t,e=!1){return Su(vo(t,e))}function Su(t){return re!==null&&!ln&&(re.f&Qe)!==0&&(un===null?Bu([t]):un.push(t)),t}function qo(t,e){return F(t,Be(()=>f(t))),e}function F(t,e){return re!==null&&!ln&&mo()&&(re.f&(Qe|ho))!==0&&(un===null||!un.includes(t))&&gu(),ei(t,e)}function ei(t,e){return t.equals(e)||(t.v,t.v=e,t.wv=Il(),yl(t,Nn),mo()&&ee!==null&&(ee.f&Ce)!==0&&(ee.f&(En|gi))===0&&(_n===null?qu([t]):_n.push(t))),e}function yl(t,e){var n=t.reactions;if(n!==null)for(var r=mo(),i=n.length,o=0;o<i;o++){var a=n[o],s=a.f;(s&Nn)===0&&(!r&&a===ee||(on(a,e),(s&(Ce|je))!==0&&((s&Qe)!==0?yl(a,ir):Co(a))))}}let _l=!1;function fr(t,e=null,n){if(typeof t!="object"||t===null||kn in t)return t;const r=ha(t);if(r!==Qc&&r!==tu)return t;var i=new Map,o=uo(t),a=Ke(0);o&&i.set("length",Ke(t.length));var s;return new Proxy(t,{defineProperty(d,l,c){(!("value"in c)||c.configurable===!1||c.enumerable===!1||c.writable===!1)&&fu();var h=i.get(l);return h===void 0?(h=Ke(c.value),i.set(l,h)):F(h,fr(c.value,s)),!0},deleteProperty(d,l){var c=i.get(l);if(c===void 0)l in d&&i.set(l,Ke(De));else{if(o&&typeof l=="string"){var h=i.get("length"),u=Number(l);Number.isInteger(u)&&u<h.v&&F(h,u)}F(c,De),Ga(a)}return!0},get(d,l,c){var p;if(l===kn)return t;var h=i.get(l),u=l in d;if(h===void 0&&(!u||(p=Jn(d,l))!=null&&p.writable)&&(h=Ke(fr(u?d[l]:De,s)),i.set(l,h)),h!==void 0){var g=f(h);return g===De?void 0:g}return Reflect.get(d,l,c)},getOwnPropertyDescriptor(d,l){var c=Reflect.getOwnPropertyDescriptor(d,l);if(c&&"value"in c){var h=i.get(l);h&&(c.value=f(h))}else if(c===void 0){var u=i.get(l),g=u==null?void 0:u.v;if(u!==void 0&&g!==De)return{enumerable:!0,configurable:!0,value:g,writable:!0}}return c},has(d,l){var g;if(l===kn)return!0;var c=i.get(l),h=c!==void 0&&c.v!==De||Reflect.has(d,l);if(c!==void 0||ee!==null&&(!h||(g=Jn(d,l))!=null&&g.writable)){c===void 0&&(c=Ke(h?fr(d[l],s):De),i.set(l,c));var u=f(c);if(u===De)return!1}return h},set(d,l,c,h){var z;var u=i.get(l),g=l in d;if(o&&l==="length")for(var p=c;p<u.v;p+=1){var v=i.get(p+"");v!==void 0?F(v,De):p in d&&(v=Ke(De),i.set(p+"",v))}u===void 0?(!g||(z=Jn(d,l))!=null&&z.writable)&&(u=Ke(void 0),F(u,fr(c,s)),i.set(l,u)):(g=u.v!==De,F(u,fr(c,s)));var y=Reflect.getOwnPropertyDescriptor(d,l);if(y!=null&&y.set&&y.set.call(h,c),!g){if(o&&typeof l=="string"){var m=i.get("length"),C=Number(l);Number.isInteger(C)&&C>=m.v&&F(m,C+1)}Ga(a)}return!0},ownKeys(d){f(a);var l=Reflect.ownKeys(d).filter(u=>{var g=i.get(u);return g===void 0||g.v!==De});for(var[c,h]of i)h.v!==De&&!(c in d)&&l.push(c);return l},setPrototypeOf(){du()}})}function Ga(t,e=1){F(t,t.v+e)}function Ka(t){return t!==null&&typeof t=="object"&&kn in t?t[kn]:t}function Eu(t,e){return Object.is(Ka(t),Ka(e))}var Xa,xl,bl,wl;function Nu(){if(Xa===void 0){Xa=window,xl=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype;bl=Jn(e,"firstChild").get,wl=Jn(e,"nextSibling").get,t.__click=void 0,t.__className="",t.__attributes=null,t.__styles=null,t.__e=void 0,Text.prototype.__t=void 0}}function va(t=""){return document.createTextNode(t)}function tr(t){return bl.call(t)}function yo(t){return wl.call(t)}function I(t,e){return tr(t)}function te(t,e){{var n=tr(t);return n instanceof Comment&&n.data===""?yo(n):n}}function yt(t,e=1,n=!1){let r=t;for(;e--;)r=yo(r);return r}function Du(t){t.textContent=""}function ni(t){var e=Qe|Nn,n=re!==null&&(re.f&Qe)!==0?re:null;return ee===null||n!==null&&(n.f&je)!==0?e|=je:ee.f|=hl,{ctx:Ot,deps:null,effects:null,equals:gl,f:e,fn:t,reactions:null,rv:0,v:null,wv:0,parent:n??ee}}function ie(t){const e=ni(t);return e.equals=ga,e}function Tl(t){var e=t.effects;if(e!==null){t.effects=null;for(var n=0;n<e.length;n+=1)$n(e[n])}}function Iu(t){for(var e=t.parent;e!==null;){if((e.f&Qe)===0)return e;e=e.parent}return null}function Lu(t){var e,n=ee;hn(Iu(t));try{Tl(t),e=Fl(t)}finally{hn(n)}return e}function Cl(t){var e=Lu(t),n=(Hn||(t.f&je)!==0)&&t.deps!==null?ir:Ce;on(t,n),t.equals(e)||(t.v=e,t.wv=Il())}function kl(t){ee===null&&re===null&&lu(),re!==null&&(re.f&je)!==0&&ee===null&&su(),xa&&au()}function Fu(t,e){var n=e.last;n===null?e.last=e.first=t:(n.next=t,t.prev=n,e.last=t)}function Nr(t,e,n,r=!0){var i=(t&gi)!==0,o=ee,a={ctx:Ot,deps:null,nodes_start:null,nodes_end:null,f:t|Nn,first:null,fn:e,last:null,next:null,parent:i?null:o,prev:null,teardown:null,transitions:null,wv:0};if(n){var s=pr;try{ja(!0),To(a),a.f|=fl}catch(c){throw $n(a),c}finally{ja(s)}}else e!==null&&Co(a);var d=n&&a.deps===null&&a.first===null&&a.nodes_start===null&&a.teardown===null&&(a.f&(hl|Oi))===0;if(!d&&!i&&r&&(o!==null&&Fu(a,o),re!==null&&(re.f&Qe)!==0)){var l=re;(l.effects??(l.effects=[])).push(a)}return a}function ya(t){const e=Nr(fo,null,!1);return on(e,Ce),e.teardown=t,e}function Vo(t){kl();var e=ee!==null&&(ee.f&En)!==0&&Ot!==null&&!Ot.m;if(e){var n=Ot;(n.e??(n.e=[])).push({fn:t,effect:ee,reaction:re})}else{var r=Dr(t);return r}}function Ru(t){return kl(),_o(t)}function Pu(t){const e=Nr(gi,t,!0);return(n={})=>new Promise(r=>{n.outro?Bi(e,()=>{$n(e),r(void 0)}):($n(e),r(void 0))})}function Dr(t){return Nr(ul,t,!1)}function me(t,e){var n=Ot,r={effect:null,ran:!1};n.l.r1.push(r),r.effect=_o(()=>{t(),!r.ran&&(r.ran=!0,F(n.l.r2,!0),Be(e))})}function pi(){var t=Ot;_o(()=>{if(f(t.l.r2)){for(var e of t.l.r1){var n=e.effect;(n.f&Ce)!==0&&on(n,ir),Ir(n)&&To(n),e.ran=!1}t.l.r2.v=!1}})}function _o(t){return Nr(fo,t,!0)}function zt(t,e=[],n=ni){const r=e.map(n);return xo(()=>t(...r.map(f)))}function xo(t,e=0){return Nr(fo|ho|e,t,!0)}function wr(t,e=!0){return Nr(fo|En,t,!0,e)}function $l(t){var e=t.teardown;if(e!==null){const n=xa,r=re;Ja(!0),dn(null);try{e.call(null)}finally{Ja(n),dn(r)}}}function zl(t,e=!1){var n=t.first;for(t.first=t.last=null;n!==null;){var r=n.next;$n(n,e),n=r}}function Hu(t){for(var e=t.first;e!==null;){var n=e.next;(e.f&En)===0&&$n(e),e=n}}function $n(t,e=!0){var n=!1;if((e||(t.f&ru)!==0)&&t.nodes_start!==null){for(var r=t.nodes_start,i=t.nodes_end;r!==null;){var o=r===i?null:yo(r);r.remove(),r=o}n=!0}zl(t,e&&!n),Yi(t,0),on(t,go);var a=t.transitions;if(a!==null)for(const d of a)d.stop();$l(t);var s=t.parent;s!==null&&s.first!==null&&Ml(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes_start=t.nodes_end=null}function Ml(t){var e=t.parent,n=t.prev,r=t.next;n!==null&&(n.next=r),r!==null&&(r.prev=n),e!==null&&(e.first===t&&(e.first=r),e.last===t&&(e.last=n))}function Bi(t,e){var n=[];_a(t,n,!0),Al(n,()=>{$n(t),e&&e()})}function Al(t,e){var n=t.length;if(n>0){var r=()=>--n||e();for(var i of t)i.out(r)}else e()}function _a(t,e,n){if((t.f&Cn)===0){if(t.f^=Cn,t.transitions!==null)for(const a of t.transitions)(a.is_global||n)&&e.push(a);for(var r=t.first;r!==null;){var i=r.next,o=(r.f&po)!==0||(r.f&En)!==0;_a(r,e,o?n:!1),r=i}}}function qi(t){Sl(t,!0)}function Sl(t,e){if((t.f&Cn)!==0){t.f^=Cn,(t.f&Ce)===0&&(t.f^=Ce),Ir(t)&&(on(t,Nn),Co(t));for(var n=t.first;n!==null;){var r=n.next,i=(n.f&po)!==0||(n.f&En)!==0;Sl(n,i?e:!1),n=r}if(t.transitions!==null)for(const o of t.transitions)(o.is_global||e)&&o.in()}}let Vi=!1,Wo=[];function El(){Vi=!1;const t=Wo.slice();Wo=[],Hi(t)}function bo(t){Vi||(Vi=!0,queueMicrotask(El)),Wo.push(t)}function Ou(){Vi&&El()}const Nl=0,Uu=1;let Si=!1,Ei=Nl,ri=!1,ii=null,pr=!1,xa=!1;function ja(t){pr=t}function Ja(t){xa=t}let Xn=[],mr=0;let re=null,ln=!1;function dn(t){re=t}let ee=null;function hn(t){ee=t}let un=null;function Bu(t){un=t}let ze=null,Ue=0,_n=null;function qu(t){_n=t}let Dl=1,Wi=0,Hn=!1,Pn=null;function Il(){return++Dl}function Ir(t){var h;var e=t.f;if((e&Nn)!==0)return!0;if((e&ir)!==0){var n=t.deps,r=(e&je)!==0;if(n!==null){var i,o,a=(e&Ui)!==0,s=r&&ee!==null&&!Hn,d=n.length;if(a||s){var l=t,c=l.parent;for(i=0;i<d;i++)o=n[i],(a||!((h=o==null?void 0:o.reactions)!=null&&h.includes(l)))&&(o.reactions??(o.reactions=[])).push(l);a&&(l.f^=Ui),s&&c!==null&&(c.f&je)===0&&(l.f^=je)}for(i=0;i<d;i++)if(o=n[i],Ir(o)&&Cl(o),o.wv>t.wv)return!0}(!r||ee!==null&&!Hn)&&on(t,Ce)}return!1}function Vu(t,e){for(var n=e;n!==null;){if((n.f&Oi)!==0)try{n.fn(t);return}catch{n.f^=Oi}n=n.parent}throw Si=!1,t}function Wu(t){return(t.f&go)===0&&(t.parent===null||(t.parent.f&Oi)===0)}function wo(t,e,n,r){if(Si){if(n===null&&(Si=!1),Wu(e))throw t;return}n!==null&&(Si=!0);{Vu(t,e);return}}function Ll(t,e,n=!0){var r=t.reactions;if(r!==null)for(var i=0;i<r.length;i++){var o=r[i];(o.f&Qe)!==0?Ll(o,e,!1):e===o&&(n?on(o,Nn):(o.f&Ce)!==0&&on(o,ir),Co(o))}}function Fl(t){var g;var e=ze,n=Ue,r=_n,i=re,o=Hn,a=un,s=Ot,d=ln,l=t.f;ze=null,Ue=0,_n=null,re=(l&(En|gi))===0?t:null,Hn=(l&je)!==0&&(!pr||i===null||d),un=null,Za(t.ctx),ln=!1,Wi++;try{var c=(0,t.fn)(),h=t.deps;if(ze!==null){var u;if(Yi(t,Ue),h!==null&&Ue>0)for(h.length=Ue+ze.length,u=0;u<ze.length;u++)h[Ue+u]=ze[u];else t.deps=h=ze;if(!Hn)for(u=Ue;u<h.length;u++)((g=h[u]).reactions??(g.reactions=[])).push(t)}else h!==null&&Ue<h.length&&(Yi(t,Ue),h.length=Ue);if(mo()&&_n!==null&&!ln&&h!==null&&(t.f&(Qe|ir|Nn))===0)for(u=0;u<_n.length;u++)Ll(_n[u],t);return i!==null&&Wi++,c}finally{ze=e,Ue=n,_n=r,re=i,Hn=o,un=a,Za(s),ln=d}}function Yu(t,e){let n=e.reactions;if(n!==null){var r=Jc.call(n,t);if(r!==-1){var i=n.length-1;i===0?n=e.reactions=null:(n[r]=n[i],n.pop())}}n===null&&(e.f&Qe)!==0&&(ze===null||!ze.includes(e))&&(on(e,ir),(e.f&(je|Ui))===0&&(e.f^=Ui),Tl(e),Yi(e,0))}function Yi(t,e){var n=t.deps;if(n!==null)for(var r=e;r<n.length;r++)Yu(t,n[r])}function To(t){var e=t.f;if((e&go)===0){on(t,Ce);var n=ee,r=Ot;ee=t;try{(e&ho)!==0?Hu(t):zl(t),$l(t);var i=Fl(t);t.teardown=typeof i=="function"?i:null,t.wv=Dl;var o=t.deps,a;Bo&&pu&&t.f&Nn}catch(s){wo(s,t,n,r||t.ctx)}finally{ee=n}}}function Rl(){if(mr>1e3){mr=0;try{cu()}catch(t){if(ii!==null)wo(t,ii,null);else throw t}}mr++}function Pl(t){var e=t.length;if(e!==0){Rl();var n=pr;pr=!0;try{for(var r=0;r<e;r++){var i=t[r];(i.f&Ce)===0&&(i.f^=Ce);var o=Ku(i);Zu(o)}}finally{pr=n}}}function Zu(t){var e=t.length;if(e!==0)for(var n=0;n<e;n++){var r=t[n];if((r.f&(go|Cn))===0)try{Ir(r)&&(To(r),r.deps===null&&r.first===null&&r.nodes_start===null&&(r.teardown===null?Ml(r):r.fn=null))}catch(i){wo(i,r,null,r.ctx)}}}function Gu(){if(ri=!1,mr>1001)return;const t=Xn;Xn=[],Pl(t),ri||(mr=0,ii=null)}function Co(t){Ei===Nl&&(ri||(ri=!0,queueMicrotask(Gu))),ii=t;for(var e=t;e.parent!==null;){e=e.parent;var n=e.f;if((n&(gi|En))!==0){if((n&Ce)===0)return;e.f^=Ce}}Xn.push(e)}function Ku(t){var e=[],n=t.first;t:for(;n!==null;){var r=n.f,i=(r&En)!==0,o=i&&(r&Ce)!==0,a=n.next;if(!o&&(r&Cn)===0){if((r&ul)!==0)e.push(n);else if(i)n.f^=Ce;else{var s=re;try{re=n,Ir(n)&&To(n)}catch(c){wo(c,n,null,n.ctx)}finally{re=s}}var d=n.first;if(d!==null){n=d;continue}}if(a===null){let c=n.parent;for(;c!==null;){if(t===c)break t;var l=c.next;if(l!==null){n=l;continue t}c=c.parent}}n=a}return e}function Hl(t){var e=Ei,n=Xn;try{Rl();const i=[];Ei=Uu,Xn=i,ri=!1,Pl(n);var r=t==null?void 0:t();return Ou(),(Xn.length>0||i.length>0)&&Hl(),mr=0,ii=null,r}finally{Ei=e,Xn=n}}async function zn(){await Promise.resolve(),Hl()}function f(t){var e=t.f,n=(e&Qe)!==0;if(Pn!==null&&Pn.add(t),re!==null&&!ln){un!==null&&un.includes(t)&&hu();var r=re.deps;t.rv<Wi&&(t.rv=Wi,ze===null&&r!==null&&r[Ue]===t?Ue++:ze===null?ze=[t]:(!Hn||!ze.includes(t))&&ze.push(t))}else if(n&&t.deps===null&&t.effects===null){var i=t,o=i.parent;o!==null&&(o.f&je)===0&&(i.f^=je)}return n&&(i=t,Ir(i)&&Cl(i)),t.v}function Xu(t){var e=Pn;Pn=new Set;var n=Pn,r;try{if(Be(t),e!==null)for(r of Pn)e.add(r)}finally{Pn=e}return n}function Qa(t){var e=Xu(()=>Be(t));for(var n of e)if((n.f&dl)!==0)for(const r of n.deps||[])(r.f&Qe)===0&&ei(r,r.v);else ei(n,n.v)}function Be(t){var e=ln;try{return ln=!0,t()}finally{ln=e}}const ju=-7169;function on(t,e){t.f=t.f&ju|e}function Le(t){if(!(typeof t!="object"||!t||t instanceof EventTarget)){if(kn in t)Yo(t);else if(!Array.isArray(t))for(let e in t){const n=t[e];typeof n=="object"&&n&&kn in n&&Yo(n)}}}function Yo(t,e=new Set){if(typeof t=="object"&&t!==null&&!(t instanceof EventTarget)&&!e.has(t)){e.add(t),t instanceof Date&&t.getTime();for(let r in t)try{Yo(t[r],e)}catch{}const n=ha(t);if(n!==Object.prototype&&n!==Array.prototype&&n!==Map.prototype&&n!==Set.prototype&&n!==Date.prototype){const r=cl(n);for(let i in r){const o=r[i].get;if(o)try{o.call(t)}catch{}}}}}const Ju=["touchstart","touchmove"];function Qu(t){return Ju.includes(t)}let ts=!1;function tf(){ts||(ts=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{var e;if(!t.defaultPrevented)for(const n of t.target.elements)(e=n.__on_r)==null||e.call(n)})},{capture:!0}))}function ba(t){var e=re,n=ee;dn(null),hn(null);try{return t()}finally{dn(e),hn(n)}}function ef(t,e,n,r=n){t.addEventListener(e,()=>ba(n));const i=t.__on_r;i?t.__on_r=()=>{i(),r(!0)}:t.__on_r=()=>r(!0),tf()}const nf=new Set,es=new Set;function rf(t,e,n,r={}){function i(o){if(r.capture||Kr.call(e,o),!o.cancelBubble)return ba(()=>n==null?void 0:n.call(this,o))}return t.startsWith("pointer")||t.startsWith("touch")||t==="wheel"?bo(()=>{e.addEventListener(t,i,r)}):e.addEventListener(t,i,r),i}function _e(t,e,n,r,i){var o={capture:r,passive:i},a=rf(t,e,n,o);(e===document.body||e===window||e===document)&&ya(()=>{e.removeEventListener(t,a,o)})}function Kr(t){var C;var e=this,n=e.ownerDocument,r=t.type,i=((C=t.composedPath)==null?void 0:C.call(t))||[],o=i[0]||t.target,a=0,s=t.__root;if(s){var d=i.indexOf(s);if(d!==-1&&(e===document||e===window)){t.__root=e;return}var l=i.indexOf(e);if(l===-1)return;d<=l&&(a=d)}if(o=i[a]||t.target,o!==e){ll(t,"currentTarget",{configurable:!0,get(){return o||n}});var c=re,h=ee;dn(null),hn(null);try{for(var u,g=[];o!==null;){var p=o.assignedSlot||o.parentNode||o.host||null;try{var v=o["__"+r];if(v!==void 0&&!o.disabled)if(uo(v)){var[y,...m]=v;y.apply(o,[t,...m])}else v.call(o,t)}catch(z){u?g.push(z):u=z}if(t.cancelBubble||p===e||p===null)break;o=p}if(u){for(let z of g)queueMicrotask(()=>{throw z});throw u}}finally{t.__root=e,delete t.currentTarget,dn(c),hn(h)}}}function wa(t){var e=document.createElement("template");return e.innerHTML=t,e.content}function oi(t,e){var n=ee;n.nodes_start===null&&(n.nodes_start=t,n.nodes_end=e)}function xt(t,e){var n=(e&ku)!==0,r=(e&$u)!==0,i,o=!t.startsWith("<!>");return()=>{i===void 0&&(i=wa(o?t:"<!>"+t),n||(i=tr(i)));var a=r||xl?document.importNode(i,!0):i.cloneNode(!0);if(n){var s=tr(a),d=a.lastChild;oi(s,d)}else oi(a,a);return a}}function Ta(t,e,n="svg"){var r=!t.startsWith("<!>"),i=`<${n}>${r?t:"<!>"+t}</${n}>`,o;return()=>{if(!o){var a=wa(i),s=tr(a);o=tr(s)}var d=o.cloneNode(!0);return oi(d,d),d}}function ue(){var t=document.createDocumentFragment(),e=document.createComment(""),n=va();return t.append(e,n),oi(e,n),t}function rt(t,e){t!==null&&t.before(e)}let Zo=!0;function ut(t,e){var n=e==null?"":typeof e=="object"?e+"":e;n!==(t.__t??(t.__t=t.nodeValue))&&(t.__t=n,t.nodeValue=n+"")}function of(t,e){return af(t,e)}const lr=new Map;function af(t,{target:e,anchor:n,props:r={},events:i,context:o,intro:a=!0}){Nu();var s=new Set,d=h=>{for(var u=0;u<h.length;u++){var g=h[u];if(!s.has(g)){s.add(g);var p=Qu(g);e.addEventListener(g,Kr,{passive:p});var v=lr.get(g);v===void 0?(document.addEventListener(g,Kr,{passive:p}),lr.set(g,1)):lr.set(g,v+1)}}};d(da(nf)),es.add(d);var l=void 0,c=Pu(()=>{var h=n??e.appendChild(va());return wr(()=>{if(o){ke({});var u=Ot;u.c=o}i&&(r.$$events=i),Zo=a,l=t(h,r)||{},Zo=!0,o&&$e()}),()=>{var p;for(var u of s){e.removeEventListener(u,Kr);var g=lr.get(u);--g===0?(document.removeEventListener(u,Kr),lr.delete(u)):lr.set(u,g)}es.delete(d),h!==n&&((p=h.parentNode)==null||p.removeChild(h))}});return sf.set(l,c),l}let sf=new WeakMap;function Lt(t,e,n=!1){var r=t,i=null,o=null,a=De,s=n?po:0,d=!1;const l=(h,u=!0)=>{d=!0,c(u,h)},c=(h,u)=>{a!==(a=h)&&(a?(i?qi(i):u&&(i=wr(()=>u(r))),o&&Bi(o,()=>{o=null})):(o?qi(o):u&&(o=wr(()=>u(r))),i&&Bi(i,()=>{i=null})))};xo(()=>{d=!1,e(l),d||c(null,null)},s)}function vr(t,e){return e}function lf(t,e,n,r){for(var i=[],o=e.length,a=0;a<o;a++)_a(e[a].e,i,!0);var s=o>0&&i.length===0&&n!==null;if(s){var d=n.parentNode;Du(d),d.append(n),r.clear(),Rn(t,e[0].prev,e[o-1].next)}Al(i,()=>{for(var l=0;l<o;l++){var c=e[l];s||(r.delete(c.k),Rn(t,c.prev,c.next)),$n(c.e,!s)}})}function Bn(t,e,n,r,i,o=null){var a=t,s={flags:e,items:new Map,first:null},d=(e&vl)!==0;if(d){var l=t;a=l.appendChild(va())}var c=null,h=!1,u=ie(()=>{var g=n();return uo(g)?g:g==null?[]:da(g)});xo(()=>{var g=f(u),p=g.length;h&&p===0||(h=p===0,cf(g,s,a,i,e,r,n),o!==null&&(p===0?c?qi(c):c=wr(()=>o(a)):c!==null&&Bi(c,()=>{c=null})),f(u))})}function cf(t,e,n,r,i,o,a){var B,pt,$,D;var s=(i&vu)!==0,d=(i&(pa|ma))!==0,l=t.length,c=e.items,h=e.first,u=h,g,p=null,v,y=[],m=[],C,z,w,b;if(s)for(b=0;b<l;b+=1)C=t[b],z=o(C,b),w=c.get(z),w!==void 0&&((B=w.a)==null||B.measure(),(v??(v=new Set)).add(w));for(b=0;b<l;b+=1){if(C=t[b],z=o(C,b),w=c.get(z),w===void 0){var _=u?u.e.nodes_start:n;p=ff(_,e,p,p===null?e.first:p.next,C,z,b,r,i,a),c.set(z,p),y=[],m=[],u=p.next;continue}if(d&&uf(w,C,b,i),(w.e.f&Cn)!==0&&(qi(w.e),s&&((pt=w.a)==null||pt.unfix(),(v??(v=new Set)).delete(w))),w!==u){if(g!==void 0&&g.has(w)){if(y.length<m.length){var M=m[0],R;p=M.prev;var U=y[0],T=y[y.length-1];for(R=0;R<y.length;R+=1)ns(y[R],M,n);for(R=0;R<m.length;R+=1)g.delete(m[R]);Rn(e,U.prev,T.next),Rn(e,p,U),Rn(e,T,M),u=M,p=T,b-=1,y=[],m=[]}else g.delete(w),ns(w,u,n),Rn(e,w.prev,w.next),Rn(e,w,p===null?e.first:p.next),Rn(e,p,w),p=w;continue}for(y=[],m=[];u!==null&&u.k!==z;)(u.e.f&Cn)===0&&(g??(g=new Set)).add(u),m.push(u),u=u.next;if(u===null)continue;w=u}y.push(w),p=w,u=w.next}if(u!==null||g!==void 0){for(var E=g===void 0?[]:da(g);u!==null;)(u.e.f&Cn)===0&&E.push(u),u=u.next;var N=E.length;if(N>0){var P=(i&vl)!==0&&l===0?n:null;if(s){for(b=0;b<N;b+=1)($=E[b].a)==null||$.measure();for(b=0;b<N;b+=1)(D=E[b].a)==null||D.fix()}lf(e,E,P,c)}}s&&bo(()=>{var G;if(v!==void 0)for(w of v)(G=w.a)==null||G.apply()}),ee.first=e.first&&e.first.e,ee.last=p&&p.e}function uf(t,e,n,r){(r&pa)!==0&&ei(t.v,e),(r&ma)!==0?ei(t.i,n):t.i=n}function ff(t,e,n,r,i,o,a,s,d,l){var c=(d&pa)!==0,h=(d&yu)===0,u=c?h?vo(i):Ke(i):i,g=(d&ma)===0?a:Ke(a),p={i:g,v:u,k:o,a:null,e:null,prev:n,next:r};try{return p.e=wr(()=>s(t,u,g,l),_l),p.e.prev=n&&n.e,p.e.next=r&&r.e,n===null?e.first=p:(n.next=p,n.e.next=p.e),r!==null&&(r.prev=p,r.e.prev=p.e),p}finally{}}function ns(t,e,n){for(var r=t.next?t.next.e.nodes_start:n,i=e?e.e.nodes_start:n,o=t.e.nodes_start;o!==r;){var a=yo(o);i.before(o),o=a}}function Rn(t,e,n){e===null?t.first=n:(e.next=n,e.e.next=n&&n.e),n!==null&&(n.prev=e,n.e.prev=e&&e.e)}function Ol(t,e,n,r,i){var o=t,a="",s;xo(()=>{a!==(a=e()??"")&&(s!==void 0&&($n(s),s=void 0),a!==""&&(s=wr(()=>{var d=a+"",l=wa(d);oi(tr(l),l.lastChild),o.before(l)})))})}function Ul(t,e,n,r,i){var s;var o=(s=e.$$slots)==null?void 0:s[n],a=!1;o===!0&&(o=e.children,a=!0),o===void 0?i!==null&&i(t):o(t,a?()=>r:r)}function rs(t,e){var n=t.__attributes??(t.__attributes={});n.value===(n.value=e??void 0)||t.value===e&&(e!==0||t.nodeName!=="PROGRESS")||(t.value=e??"")}function ve(t,e,n,r){var i=t.__attributes??(t.__attributes={});i[e]!==(i[e]=n)&&(e==="style"&&"__styles"in t&&(t.__styles={}),e==="loading"&&(t[ou]=n),n==null?t.removeAttribute(e):typeof n!="string"&&df(t).includes(e)?t[e]=n:t.setAttribute(e,n))}var is=new Map;function df(t){var e=is.get(t.nodeName);if(e)return e;is.set(t.nodeName,e=[]);for(var n,r=t,i=Element.prototype;i!==r;){n=cl(r);for(var o in n)n[o].set&&e.push(o);r=ha(r)}return e}function yr(t,e,n){var r=t.__className,i=hf(e);(r!==i||_l)&&(e==null?t.removeAttribute("class"):t.className=i,t.__className=i)}function hf(t,e){return(t??"")+""}function Bl(t,e,n){if(n){if(t.classList.contains(e))return;t.classList.add(e)}else{if(!t.classList.contains(e))return;t.classList.remove(e)}}const gf=()=>performance.now(),xn={tick:t=>requestAnimationFrame(t),now:()=>gf(),tasks:new Set};function ql(){const t=xn.now();xn.tasks.forEach(e=>{e.c(t)||(xn.tasks.delete(e),e.f())}),xn.tasks.size!==0&&xn.tick(ql)}function pf(t){let e;return xn.tasks.size===0&&xn.tick(ql),{promise:new Promise(n=>{xn.tasks.add(e={c:t,f:n})}),abort(){xn.tasks.delete(e)}}}function xi(t,e){ba(()=>{t.dispatchEvent(new CustomEvent(e))})}function mf(t){if(t==="float")return"cssFloat";if(t==="offset")return"cssOffset";if(t.startsWith("--"))return t;const e=t.split("-");return e.length===1?e[0]:e[0]+e.slice(1).map(n=>n[0].toUpperCase()+n.slice(1)).join("")}function os(t){const e={},n=t.split(";");for(const r of n){const[i,o]=r.split(":");if(!i||o===void 0)break;const a=mf(i.trim());e[a]=o.trim()}return e}const vf=t=>t;function yf(t,e,n,r){var i=(t&Cu)!==0,o="both",a,s=e.inert,d=e.style.overflow,l,c;function h(){var y=re,m=ee;dn(null),hn(null);try{return a??(a=n()(e,(r==null?void 0:r())??{},{direction:o}))}finally{dn(y),hn(m)}}var u={is_global:i,in(){e.inert=s,xi(e,"introstart"),l=Go(e,h(),c,1,()=>{xi(e,"introend"),l==null||l.abort(),l=a=void 0,e.style.overflow=d})},out(y){e.inert=!0,xi(e,"outrostart"),c=Go(e,h(),l,0,()=>{xi(e,"outroend"),y==null||y()})},stop:()=>{l==null||l.abort(),c==null||c.abort()}},g=ee;if((g.transitions??(g.transitions=[])).push(u),Zo){var p=i;if(!p){for(var v=g.parent;v&&(v.f&po)!==0;)for(;(v=v.parent)&&(v.f&ho)===0;);p=!v||(v.f&fl)!==0}p&&Dr(()=>{Be(()=>u.in())})}}function Go(t,e,n,r,i){var o=r===1;if(eu(e)){var a,s=!1;return bo(()=>{if(!s){var y=e({direction:o?"in":"out"});a=Go(t,y,n,r,i)}}),{abort:()=>{s=!0,a==null||a.abort()},deactivate:()=>a.deactivate(),reset:()=>a.reset(),t:()=>a.t()}}if(n==null||n.deactivate(),!(e!=null&&e.duration))return i(),{abort:Re,deactivate:Re,reset:Re,t:()=>r};const{delay:d=0,css:l,tick:c,easing:h=vf}=e;var u=[];if(o&&n===void 0&&(c&&c(0,1),l)){var g=os(l(0,1));u.push(g,g)}var p=()=>1-r,v=t.animate(u,{duration:d});return v.onfinish=()=>{var y=(n==null?void 0:n.t())??1-r;n==null||n.abort();var m=r-y,C=e.duration*Math.abs(m),z=[];if(C>0){var w=!1;if(l)for(var b=Math.ceil(C/16.666666666666668),_=0;_<=b;_+=1){var M=y+m*h(_/b),R=os(l(M,1-M));z.push(R),w||(w=R.overflow==="hidden")}w&&(t.style.overflow="hidden"),p=()=>{var U=v.currentTime;return y+m*h(U/C)},c&&pf(()=>{if(v.playState!=="running")return!1;var U=p();return c(U,1-U),!0})}v=t.animate(z,{duration:C,fill:"forwards"}),v.onfinish=()=>{p=()=>r,c==null||c(r,1-r),i()}},{abort:()=>{v&&(v.cancel(),v.effect=null,v.onfinish=Re)},deactivate:()=>{i=Re},reset:()=>{r===0&&(c==null||c(1,0))},t:()=>p()}}function bi(t,e,n){var r=Jn(t,e);r&&r.set&&(t[e]=n,ya(()=>{t[e]=null}))}function ai(t,e,n){if(t.multiple)return _f(t,e);for(var r of t.options){var i=ti(r);if(Eu(i,e)){r.selected=!0;return}}(!n||e!==void 0)&&(t.selectedIndex=-1)}function Ko(t,e){let n=!0;Dr(()=>{e&&ai(t,Be(e),n),n=!1;var r=new MutationObserver(()=>{var i=t.__value;ai(t,i)});return r.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{r.disconnect()}})}function as(t,e,n=e){var r=!0;ef(t,"change",i=>{var o=i?"[selected]":":checked",a;if(t.multiple)a=[].map.call(t.querySelectorAll(o),ti);else{var s=t.querySelector(o)??t.querySelector("option:not([disabled])");a=s&&ti(s)}n(a)}),Dr(()=>{var i=e();if(ai(t,i,r),r&&i===void 0){var o=t.querySelector(":checked");o!==null&&(i=ti(o),n(i))}t.__value=i,r=!1}),Ko(t)}function _f(t,e){for(var n of t.options)n.selected=~e.indexOf(ti(n))}function ti(t){return"__value"in t?t.__value:t.value}function ss(t,e){return t===e||(t==null?void 0:t[kn])===e}function qe(t={},e,n,r){return Dr(()=>{var i,o;return _o(()=>{i=o,o=[],Be(()=>{t!==n(...o)&&(e(t,...o),i&&ss(n(...i),t)&&e(null,...i))})}),()=>{bo(()=>{o&&ss(n(...o),t)&&e(null,...o)})}}),t}function Me(t=!1){const e=Ot,n=e.l.u;if(!n)return;let r=()=>Le(e.s);if(t){let i=0,o={};const a=ni(()=>{let s=!1;const d=e.s;for(const l in d)d[l]!==o[l]&&(o[l]=d[l],s=!0);return s&&i++,i});r=()=>f(a)}n.b.length&&Ru(()=>{ls(e,r),Hi(n.b)}),Vo(()=>{const i=Be(()=>n.m.map(nu));return()=>{for(const o of i)typeof o=="function"&&o()}}),n.a.length&&Vo(()=>{ls(e,r),Hi(n.a)})}function ls(t,e){if(t.l.s)for(const n of t.l.s)f(n);e()}function Ca(t,e,n){if(t==null)return e(void 0),n&&n(void 0),Re;const r=Be(()=>t.subscribe(e,n));return r.unsubscribe?()=>r.unsubscribe():r}const cr=[];function xf(t,e){return{subscribe:ka(t,e).subscribe}}function ka(t,e=Re){let n=null;const r=new Set;function i(s){if(pl(t,s)&&(t=s,n)){const d=!cr.length;for(const l of r)l[1](),cr.push(l,t);if(d){for(let l=0;l<cr.length;l+=2)cr[l][0](cr[l+1]);cr.length=0}}}function o(s){i(s(t))}function a(s,d=Re){const l=[s,d];return r.add(l),r.size===1&&(n=e(i,o)||Re),s(t),()=>{r.delete(l),r.size===0&&n&&(n(),n=null)}}return{set:i,update:o,subscribe:a}}function bf(t,e,n){const r=!Array.isArray(t),i=r?[t]:t;if(!i.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const o=e.length<2;return xf(n,(a,s)=>{let d=!1;const l=[];let c=0,h=Re;const u=()=>{if(c)return;h();const p=e(r?l[0]:l,a,s);o?a(p):h=typeof p=="function"?p:Re},g=i.map((p,v)=>Ca(p,y=>{l[v]=y,c&=~(1<<v),d&&u()},()=>{c|=1<<v}));return d=!0,u(),function(){Hi(g),h(),d=!1}})}function Vl(t){let e;return Ca(t,n=>e=n)(),e}let wi=!1,Xo=Symbol();function vt(t,e,n){const r=n[e]??(n[e]={store:null,source:vo(void 0),unsubscribe:Re});if(r.store!==t&&!(Xo in n))if(r.unsubscribe(),r.store=t??null,t==null)r.source.v=void 0,r.unsubscribe=Re;else{var i=!0;r.unsubscribe=Ca(t,o=>{i?r.source.v=o:F(r.source,o)}),i=!1}return t&&Xo in n?Vl(t):f(r.source)}function Ti(t,e,n){let r=n[e];return r&&r.store!==t&&(r.unsubscribe(),r.unsubscribe=Re),t}function tn(){const t={};function e(){ya(()=>{for(var n in t)t[n].unsubscribe();ll(t,Xo,{enumerable:!1,value:!0})})}return[t,e]}function wf(t){var e=wi;try{return wi=!1,[t(),wi]}finally{wi=e}}function Zt(t,e,n,r){var M;var i=(n&_u)!==0,o=!Sr||(n&xu)!==0,a=(n&wu)!==0,s=(n&Tu)!==0,d=!1,l;a?[l,d]=wf(()=>t[e]):l=t[e];var c=kn in t||iu in t,h=a&&(((M=Jn(t,e))==null?void 0:M.set)??(c&&e in t&&(R=>t[e]=R)))||void 0,u=r,g=!0,p=!1,v=()=>(p=!0,g&&(g=!1,s?u=Be(r):u=r),u);l===void 0&&r!==void 0&&(h&&o&&uu(),l=v(),h&&h(l));var y;if(o)y=()=>{var R=t[e];return R===void 0?v():(g=!0,p=!1,R)};else{var m=(i?ni:ie)(()=>t[e]);m.f|=dl,y=()=>{var R=f(m);return R!==void 0&&(u=void 0),R===void 0?u:R}}if((n&bu)===0)return y;if(h){var C=t.$$legacy;return function(R,U){return arguments.length>0?((!o||!U||C||d)&&h(U?y():R),R):y()}}var z=!1,w=!1,b=vo(l),_=ni(()=>{var R=y(),U=f(b);return z?(z=!1,w=!0,U):(w=!1,b.v=R)});return i||(_.equals=ga),function(R,U){if(Pn!==null&&(z=w,y(),f(b)),arguments.length>0){const T=U?f(_):o&&a?fr(R):R;return _.equals(T)||(z=!0,F(b,T),p&&u!==void 0&&(u=T),Be(()=>f(_))),R}return f(_)}}function We(t){Ot===null&&Er(),Sr&&Ot.l!==null?$a(Ot).m.push(t):Vo(()=>{const e=Be(t);if(typeof e=="function")return e})}function Dn(t){Ot===null&&Er(),We(()=>()=>Be(t))}function Tf(t,e,{bubbles:n=!1,cancelable:r=!1}={}){return new CustomEvent(t,{detail:e,bubbles:n,cancelable:r})}function Wl(){const t=Ot;return t===null&&Er(),(e,n,r)=>{var o;const i=(o=t.s.$$events)==null?void 0:o[e];if(i){const a=uo(i)?i.slice():[i],s=Tf(e,n,r);for(const d of a)d.call(t.x,s);return!s.defaultPrevented}return!0}}function Cf(t){Ot===null&&Er(),Ot.l===null&&ml(),$a(Ot).b.push(t)}function kf(t){Ot===null&&Er(),Ot.l===null&&ml(),$a(Ot).a.push(t)}function $a(t){var e=t.l;return e.u??(e.u={a:[],b:[],m:[]})}const $f="5";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add($f);mu();let Br=null;const{subscribe:zf,set:Mf,update:cs}=ka({items:[],loading:!1,error:null}),de={subscribe:zf,loadItems:async()=>Br||(cs(t=>({...t,loading:!0,error:null})),Br=(async()=>{try{const e=await(await fetch("/IWAC-overview/items.json")).json();return Mf({items:e,loading:!1,error:null}),e}catch(t){const e=t instanceof Error?t.message:"Failed to load items";throw cs(n=>({...n,loading:!1,error:e})),t}finally{Br=null}})(),Br)},Yl={en:{"app.title":"<i>Islam West Africa Collection</i> Overview","tab.countries":"Country distribution","tab.languages":"Languages","tab.timeline":"Collection growth","tab.types":"Type distribution","tab.categories":"Index","tab.words":"Word count","ui.loading":"Loading database...","ui.select_visualization":"Select a visualization from the tabs above","ui.toggle_language":"Français","ui.show_description":"Show description","ui.hide_description":"Hide description","ui.no_visualization_content":"No visualization content available","ui.enter_fullscreen":"Enter fullscreen mode","ui.exit_fullscreen":"Exit fullscreen mode","ui.download_visualization":"Download visualization","viz.summary":"Summary","viz.total_items":"Total items","viz.number_of_categories":"Number of categories","viz.top_categories":"Top Categories","viz.filter_by_country":"Filter by Country","viz.filter_by_type":"Filter by Type","viz.showing_items":"Showing {0} items in {1} languages","viz.all_countries":"All Countries","viz.all_types":"All Types","viz.no_data":"No data available with the current filters","viz.distribution_items":"Distribution of {0} items by country and sub-collection","viz.language_distribution_title":"Language Distribution","viz.language_distribution_items":"Distribution of {0} items by language","viz.language_distribution_description":"This visualization shows the distribution of items by language. You can filter by country and item type to explore the language distribution across different segments of the collection.","viz.chart_type":"Chart Type","viz.pie_chart":"Switch to Pie Chart","viz.donut_chart":"Switch to Donut Chart","viz.items_added_since_april":"Added {0} items since April 2024","viz.items_added_since_april_title":"Growth since April 2024","viz.growth_since_april_title":"Growth Since April 2024","viz.growth_since_april":"Growth of {0} items since April 2024","viz.growth_since_april_description":"This visualization shows the growth of the database since April 2024. The blue line represents monthly additions, while the green dotted line shows the cumulative total. You can filter by country and item type to explore growth patterns.","viz.time_period":"Time period","viz.avg_monthly_additions":"Average monthly additions","viz.peak_growth_months":"Peak Growth Months","viz.showing_items_over_months":"Showing {0} items over {1} months","viz.months":"months","viz.monthly_additions":"Monthly Additions","viz.month":"Month","viz.new_items":"New Items","viz.percentage":"Percentage","viz.publication_year":"Publication Year","viz.year":"Year","viz.number_of_items":"Number of Items","viz.toggle_types":"Toggle Types","viz.toggle_languages":"Toggle Languages","viz.toggled_type":"Toggled type: {0}","viz.languages":"Languages","viz.country_distribution_title":"Country Distribution","viz.country_distribution_description":"This visualization shows the distribution of items by country and sub-collection. You can click on any country block to zoom in and see its sub-collections. The size of each block represents the number of items in that country or sub-collection.","viz.country.items":"Items","viz.country.percent_parent":"% of Parent","viz.country.percent_total":"% of Total","viz.country.click_zoom_in":"Click to zoom in","viz.country.click_zoom_out":"Click to zoom out","viz.country.unknown":"Unknown","viz.country.no_set":"No Set","viz.countries":"Countries","viz.sub_collections":"Sub-collections","viz.currently_viewing":"Currently viewing","viz.click_back_to_return":'Click the "Back to All" button to return to the full view',"viz.click_zoom_in":"Click on a country block to zoom in","viz.unknown":"Unknown","viz.no_set":"No Set","viz.word_distribution":"Word Distribution","viz.total_words":"Total Words","viz.avg_words_per_item":"Average words per Item","viz.back_to_all":"← Back to All","viz.total_items_with_word_count":"Total items with word count","viz.word_distribution_subtitle":"Word Distribution by Country and Item Set ({0} items, {1} words)","viz.word_distribution_description":"This visualization shows the distribution of words across items by country and collection. The size of each block represents the word count in that country or collection.","viz.words":"words","viz.items":"items","viz.percent_of_country":"% of country","viz.percent_of_total":"% of total","viz.item_set_summary":"Item Set Summary","lang.Français":"French","lang.Anglais":"English","lang.Haoussa":"Hausa","lang.Allemand":"German","lang.Arabe":"Arabic","lang.Italien":"Italian","lang.Dendi":"Dendi","lang.Slovène":"Slovenian","lang.Espagnol":"Spanish","country.all":"All Countries","country.Bénin":"Benin","country.Nigéria":"Nigeria","country.Côte d'Ivoire":"Côte d'Ivoire","country.Burkina Faso":"Burkina Faso","country.Togo":"Togo","country.Niger":"Niger","country.Unknown":"Unknown","type.Article de presse":"Press article","type.Notice d'autorité":"Authority record","type.Périodique islamique":"Islamic periodical","type.Unknown":"Unknown","type.Article de revue":"Journal article","type.Document":"Document","type.Article de blog":"Blog post","type.Chapitre de livre":"Book chapter","type.Livre":"Book","type.Thèse de doctorat":"Doctoral thesis","type.Communication scientifique":"Scientific communication","type.Article d'encyclopédie":"Encyclopedia article","type.Compte rendu de livre":"Book review","type.Enregistrement vidéo":"Video recording","type.Mémoire de licence":"Bachelor's thesis","type.Mémoire de maitrise":"Master's thesis","type.Photographie":"Photograph","type.Rapport":"Report","type.Working paper":"Working paper","type.all":"All types","viz.index_distribution_title":"Index Distribution","viz.index_distribution_items":"Distribution of {0} index items by category","viz.index_distribution_description":"This visualization shows the distribution of index items by category. The size of each bar represents the number of items in that category. Index items are authority records that serve as reference points in the database.","viz.categories":"Categories","viz.uncategorized":"Uncategorized","viz.type_distribution_title":"Type Distribution","viz.type_distribution_items":"Distribution of {0} items by type","viz.type_distribution_description":"This visualization shows the distribution of items by type over time. You can filter by country and year range to explore how different types of items have been published over time.","viz.types":"Types","viz.published_between":"published between {0} and {1}","viz.type":"Type","viz.count":"Count","viz.others":"Others","category.Events":"Events","category.Locations":"Locations","category.Organizations":"Organizations","category.Persons":"Persons","category.Topics":"Topics","category.Authority Files":"Authority files"},fr:{"app.title":"Aperçu de la <i>Collection Islam Afrique de l'Ouest</i>","tab.countries":"Répartition par pays","tab.languages":"Langues","tab.timeline":"Croissance collection","tab.types":"Répartition par type","tab.categories":"Index","tab.words":"Nombre de mots","ui.loading":"Chargement de la base de données...","ui.select_visualization":"Sélectionnez une visualisation dans les onglets ci-dessus","ui.toggle_language":"English","ui.show_description":"Afficher la description","ui.hide_description":"Masquer la description","ui.no_visualization_content":"Aucun contenu de visualisation disponible","ui.enter_fullscreen":"Passer en mode plein écran","ui.exit_fullscreen":"Quitter le mode plein écran","ui.download_visualization":"Télécharger la visualisation","viz.summary":"Résumé","viz.total_items":"Nombre total d'éléments","viz.number_of_categories":"Nombre de catégories","viz.top_categories":"Principales catégories","viz.filter_by_country":"Filtrer par pays","viz.filter_by_type":"Filtrer par type","viz.showing_items":"Affichage de {0} éléments dans {1} langues","viz.all_countries":"Tous les pays","viz.all_types":"Tous les types","viz.no_data":"Aucune donnée disponible avec les filtres actuels","viz.distribution_items":"Répartition de {0} éléments par pays et sous-collection","viz.language_distribution_title":"Répartition par langue","viz.language_distribution_items":"Répartition de {0} éléments par langue","viz.language_distribution_description":"Cette visualisation montre la répartition des éléments par langue. Vous pouvez filtrer par pays et par type d'élément pour explorer la répartition des langues dans différents segments de la collection.","viz.chart_type":"Type de graphique","viz.pie_chart":"Passer au graphique en secteurs","viz.donut_chart":"Passer au graphique en anneau","viz.items_added_since_april":"{0} éléments ajoutés depuis avril 2024","viz.items_added_since_april_title":"Croissance depuis avril 2024","viz.growth_since_april_title":"Croissance depuis avril 2024","viz.growth_since_april":"Croissance de {0} éléments depuis avril 2024","viz.growth_since_april_description":"Cette visualisation montre la croissance de la base de données depuis avril 2024. La ligne bleue représente les ajouts mensuels, tandis que la ligne pointillée verte montre le total cumulatif. Vous pouvez filtrer par pays et par type d'élément pour explorer les modèles de croissance.","viz.time_period":"Période","viz.avg_monthly_additions":"Ajouts mensuels moyens","viz.peak_growth_months":"Mois de croissance maximale","viz.showing_items_over_months":"Affichage de {0} éléments sur {1} mois","viz.months":"mois","viz.monthly_additions":"Ajouts mensuels","viz.month":"Mois","viz.new_items":"Nouveaux Éléments","viz.percentage":"Pourcentage","viz.publication_year":"Année de publication","viz.year":"Année","viz.number_of_items":"Nombre d'éléments","viz.toggle_types":"Basculer les types","viz.toggle_languages":"Basculer les langues","viz.toggled_type":"Type basculé : {0}","viz.languages":"Langues","viz.country_distribution_title":"Répartition par pays","viz.country_distribution_description":"Cette visualisation montre la répartition des éléments par pays et sous-collection. Vous pouvez cliquer sur n'importe quel bloc pays pour zoomer et voir ses sous-collections. La taille de chaque bloc représente le nombre d'éléments dans ce pays ou cette sous-collection.","viz.country.items":"Éléments","viz.country.percent_parent":"% du parent","viz.country.percent_total":"% du total","viz.country.click_zoom_in":"Cliquer pour zoomer","viz.country.click_zoom_out":"Cliquer pour dézoomer","viz.country.unknown":"Inconnu","viz.country.no_set":"Sans ensemble","viz.countries":"Pays","viz.sub_collections":"Sous-collections","viz.currently_viewing":"Affichage actuel","viz.click_back_to_return":'Cliquez sur le bouton "Retour à tous" pour revenir à la vue complète',"viz.click_zoom_in":"Cliquez sur un bloc pays pour zoomer","viz.unknown":"Inconnu","viz.no_set":"Sans ensemble","viz.word_distribution":"Répartition des mots","viz.total_words":"Nombre total de mots","viz.avg_words_per_item":"Moyenne de mots par élément","viz.back_to_all":"← Retour à tous","viz.total_items_with_word_count":"Total des éléments avec nombre de mots","viz.word_distribution_subtitle":"Répartition des mots par pays et ensemble d'éléments ({0} éléments, {1} mots)","viz.word_distribution_description":"Cette visualisation montre la répartition des mots dans les éléments par pays et collection. La taille de chaque bloc représente le nombre de mots dans ce pays ou cette collection.","viz.words":"mots","viz.items":"éléments","viz.percent_of_country":"% du pays","viz.percent_of_total":"% du total","viz.item_set_summary":"Résumé de l'ensemble d'éléments","lang.Français":"Français","lang.Anglais":"Anglais","lang.Haoussa":"Haoussa","lang.Allemand":"Allemand","lang.Arabe":"Arabe","lang.Italien":"Italien","lang.Dendi":"Dendi","lang.Slovène":"Slovène","lang.Espagnol":"Espagnol","country.all":"Tous les pays","country.Bénin":"Bénin","country.Nigéria":"Nigéria","country.Côte d'Ivoire":"Côte d'Ivoire","country.Burkina Faso":"Burkina Faso","country.Togo":"Togo","country.Niger":"Niger","country.Unknown":"Inconnu","type.Article de presse":"Article de presse","type.Notice d'autorité":"Notice d'autorité","type.Périodique islamique":"Périodique islamique","type.Unknown":"Inconnu","type.Article de revue":"Article de revue","type.Document":"Document","type.Article de blog":"Article de blog","type.Chapitre de livre":"Chapitre de livre","type.Livre":"Livre","type.Thèse de doctorat":"Thèse de doctorat","type.Communication scientifique":"Communication scientifique","type.Article d'encyclopédie":"Article d'encyclopédie","type.Compte rendu de livre":"Compte rendu de livre","type.Enregistrement vidéo":"Enregistrement vidéo","type.Mémoire de licence":"Mémoire de licence","type.Mémoire de maitrise":"Mémoire de maitrise","type.Photographie":"Photographie","type.Rapport":"Rapport","type.Working paper":"Working paper","type.all":"Tous les types","viz.index_distribution_title":"Répartition des index","viz.index_distribution_items":"Répartition de {0} éléments d'index par catégorie","viz.index_distribution_description":"Cette visualisation montre la répartition des éléments d'index par catégorie. La taille de chaque barre représente le nombre d'éléments dans cette catégorie. Les éléments d'index sont des notices d'autorité qui servent de points de référence dans la base de données.","viz.categories":"Catégories","viz.uncategorized":"Non catégorisé","viz.type_distribution_title":"Répartition par type","viz.type_distribution_items":"Répartition de {0} éléments par type","viz.type_distribution_description":"Cette visualisation montre la répartition des éléments par type au fil du temps. Vous pouvez filtrer par pays et par plage d'années pour explorer comment différents types d'éléments ont été publiés au fil du temps.","viz.types":"Types","viz.published_between":"publiés entre {0} et {1}","viz.type":"Type","viz.count":"Nombre","viz.others":"Autres","category.Events":"Événements","category.Locations":"Lieux","category.Organizations":"Organisations","category.Persons":"Personnes","category.Topics":"Sujets","category.Authority Files":"Notices d'autorité"}};function Af(){const{subscribe:t,set:e,update:n}=ka("en"),r=typeof window<"u"&&window.location.hostname==="localhost";return{subscribe:t,setLanguage:i=>{r&&console.log("[Translation] Language changed to:",i),e(i)},toggleLanguage:()=>n(i=>i==="en"?"fr":"en")}}const xe=Af();function Zl(t,e){return e?t.replace(/{(\d+)}/g,(n,r)=>{const i=parseInt(r);return i<Object.keys(e).length?e[i].toString():n}):t}const lt=(t,e)=>{var i;const n=Vl(xe),r=((i=Yl[n])==null?void 0:i[t])||t;return Zl(r,e)},tt=(t,e)=>bf(xe,n=>{var i;const r=((i=Yl[n])==null?void 0:i[t])||t;return Zl(r,e)});var Sf=xt('<button class="btn btn-primary text-sm px-md py-sm"> </button>');function Ef(t,e){ke(e,!1);const[n,r]=tn(),i=()=>vt(o,"$toggleText",n),o=tt("ui.toggle_language");function a(){xe.toggleLanguage()}Me();var s=Sf(),d=I(s);zt(()=>{ve(s,"aria-label",i()),ut(d,i())}),_e("click",s,a),rt(t,s),$e(),r()}var Nf=Ta('<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="block"><path d="M8 3v3a2 2 0 0 1-2 2H3"></path><path d="M21 8h-3a2 2 0 0 1-2-2V3"></path><path d="M3 16h3a2 2 0 0 1 2 2v3"></path><path d="M16 21v-3a2 2 0 0 1 2-2h3"></path></svg>'),Df=Ta('<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="block"><path d="M8 3H5a2 2 0 0 0-2 2v3"></path><path d="M21 8V5a2 2 0 0 0-2-2h-3"></path><path d="M3 16v3a2 2 0 0 0 2 2h3"></path><path d="M16 21h3a2 2 0 0 0 2-2v-3"></path></svg>'),If=xt('<button class="btn btn-primary btn-icon p-sm"><!></button>');function Lf(t,e){ke(e,!1);let n=_t(!1);function r(){document.fullscreenElement?document.exitFullscreen&&document.exitFullscreen():document.documentElement.requestFullscreen().catch(c=>{console.error(`Error attempting to enable fullscreen: ${c.message}`),i()&&console.warn('This application is in an iframe. Make sure the iframe has the "allowfullscreen" attribute.')})}function i(){try{return window.self!==window.top}catch{return!0}}function o(){F(n,!!document.fullscreenElement)}We(()=>(document.addEventListener("fullscreenchange",o),()=>{document.removeEventListener("fullscreenchange",o)})),Me();var a=If(),s=I(a);{var d=c=>{var h=Nf();rt(c,h)},l=c=>{var h=Df();rt(c,h)};Lt(s,c=>{f(n)?c(d):c(l,!1)})}zt(c=>{ve(a,"title",c),ve(a,"aria-label",c)},[()=>f(n)?lt("ui.exit_fullscreen"):lt("ui.enter_fullscreen")],ie),_e("click",a,r),rt(t,a),$e()}var Ff=xt('<button class="btn btn-primary btn-icon p-sm"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="block"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg></button>');function Rf(t,e){ke(e,!1);function n(){var h,u,g,p;const c=document.querySelector(".visualization-content svg");if(!c){console.error("No SVG found to download");return}try{const v=c.cloneNode(!0),y=document.querySelector(".visualization-header h2");let m="";if(y&&(m=((h=y.textContent)==null?void 0:h.trim())||"",m||(m=((u=y.innerText)==null?void 0:u.trim())||""),m.includes("<")&&m.includes(">"))){const E=document.createElement("div");E.innerHTML=y.innerHTML,m=((g=E.textContent)==null?void 0:g.trim())||""}r(v),m&&o(v,m),s(v),d(v);const z=new XMLSerializer().serializeToString(v),w=new Blob([z],{type:"image/svg+xml;charset=utf-8"}),b=URL.createObjectURL(w),_=document.createElement("a");_.href=b;const M=document.querySelector(".tab-item.active"),R=M?(p=M.textContent)==null?void 0:p.trim():"visualization",T=`iwac-${a(m||R||"visualization")}`;_.download=`${T}.svg`,document.body.appendChild(_),_.click(),document.body.removeChild(_),URL.revokeObjectURL(b)}catch(v){console.error("Error downloading visualization:",v)}}function r(c){const h=Array.from(document.styleSheets),u=document.createElement("style");let g="";const p=getComputedStyle(document.documentElement),v=p.getPropertyValue("--font-family-base")||p.fontFamily||"'Arial', sans-serif";g+=`
            svg {
                font-family: ${v};
                font-size: ${p.fontSize||"14px"};
                line-height: ${p.lineHeight||"1.5"};
            }
        `;let y="";h.forEach(b=>{var _;try{const M=b.cssRules||b.rules;if(M)for(let R=0;R<M.length;R++){const U=M[R];if(U instanceof CSSStyleRule){const T=U.selectorText;T&&(T.includes("svg")||T.includes("g")||T.includes("path")||T.includes("rect")||T.includes("circle")||T.includes("text")||T.includes("line")||T.includes("polyline")||T.includes("polygon")||T.includes("axis")||T.includes("tick")||T.includes("label")||T.includes("legend")||T.includes("chart")||T.includes("bar")||T.includes("plot")||T.includes("point")||T.includes("marker")||T.includes("grid")||T.includes("visualization")||T.includes(".graph")||T.includes(".data")||T.includes(".series")||T.includes(".node")||T.includes(".link")||T.includes(".arc")||T.includes(".slice")||T.includes(".area")||T.includes(".line")||T.includes(".dot")||T.includes(".bubble")||T.includes(".tooltip")||T.includes(".domain")||T.includes(".tick")||/\b(vis|chart|graph|plot|axis|legend|tooltip)\b/i.test(T))&&(g+=U.cssText+`
`)}else if(U instanceof CSSFontFaceRule)y+=U.cssText+`
`;else if(U instanceof CSSImportRule)try{const T=(_=U.styleSheet)==null?void 0:_.cssRules;if(T)for(let E=0;E<T.length;E++)if(T[E]instanceof CSSStyleRule){const N=T[E].selectorText;N&&/\b(svg|g|path|rect|circle|text|line|axis|chart|graph|vis)\b/i.test(N)&&(g+=T[E].cssText+`
`)}else T[E]instanceof CSSFontFaceRule&&(y+=T[E].cssText+`
`)}catch(T){console.warn("Could not process imported stylesheet",T)}}}catch(M){console.warn("Could not access stylesheet rules",M)}});let m=`:root {
`;const C=getComputedStyle(document.documentElement);["--color-primary","--color-primary-dark","--color-primary-300","--color-text-light","--color-text-dark","--color-bg-page","--font-family-base","--font-size-base","--font-size-sm","--font-size-lg","--font-weight-normal","--font-weight-bold","--spacing-sm","--spacing-md","--spacing-lg","--color-text-primary","--color-border","--color-border-light"].forEach(b=>{const _=C.getPropertyValue(b);_&&(m+=`    ${b}: ${_};
`)}),h.forEach(b=>{try{const _=b.cssRules||b.rules;if(_){for(let M=0;M<_.length;M++)if(_[M]instanceof CSSStyleRule){const U=_[M].cssText.match(/var\(--[a-zA-Z0-9_-]+/g);U&&U.forEach(T=>{const E=T.substring(4);if(!m.includes(E)){const N=C.getPropertyValue(E);N&&(m+=`    ${E}: ${N};
`)}})}}}catch{}}),m+=`}
`;const w=y+m+g;if(u.textContent=w,c.firstChild?c.insertBefore(u,c.firstChild):c.appendChild(u),c.setAttribute("xmlns","http://www.w3.org/2000/svg"),c.setAttribute("version","1.1"),c.setAttribute("width",c.getAttribute("width")||"800"),c.setAttribute("height",c.getAttribute("height")||"600"),c.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),!c.style.backgroundColor){const b=p.getPropertyValue("--color-bg-page")||"#ffffff";c.style.backgroundColor=b}i(c)}function i(c){try{const h=c.querySelectorAll("text"),u=new Set;if(h.forEach(g=>{const p=g.getAttribute("font-family")||window.getComputedStyle(g).fontFamily;p&&p.split(",").forEach(v=>{const y=v.trim().replace(/['"]/g,"");y&&!y.includes("serif")&&!y.includes("sans")&&!y.includes("mono")&&!y.includes("Arial")&&!y.includes("Helvetica")&&u.add(y)})}),u.size>0){const g=Array.from(document.querySelectorAll("link")).filter(p=>{if(!p.href)return!1;try{const v=new URL(p.href);return v.protocol==="https:"&&(v.hostname==="fonts.googleapis.com"||v.hostname==="fonts.gstatic.com")}catch(v){return console.warn(`Invalid font URL detected: ${p.href}`,v),!1}});if(g.length>0){const p=document.createComment(` Embedded fonts: ${Array.from(u).join(", ")} `);c.insertBefore(p,c.firstChild),g.forEach(v=>{const y=document.createElementNS("http://www.w3.org/2000/svg","style");y.textContent=`@import url('${v.href}');`,c.insertBefore(y,c.firstChild)})}}}catch(h){console.warn("Could not embed web fonts:",h)}}function o(c,h){const u=document.createElementNS("http://www.w3.org/2000/svg","title");u.textContent=h,c.firstChild?c.insertBefore(u,c.firstChild):c.appendChild(u);const g=parseInt(c.getAttribute("width")||"800");parseInt(c.getAttribute("height")||"600");const p=document.createElementNS("http://www.w3.org/2000/svg","text");p.setAttribute("x",(g/2).toString()),p.setAttribute("y","24"),p.setAttribute("text-anchor","middle"),p.setAttribute("font-family","Arial, sans-serif"),p.setAttribute("font-size","16px"),p.setAttribute("font-weight","bold"),p.setAttribute("fill","var(--color-primary, #333)"),p.textContent=h,c.appendChild(p)}function a(c){let h=c.toLowerCase().replace(/[<>:"/\\|?*\x00-\x1F]/g,"-").replace(/\s+/g,"-").replace(/&/g,"and").replace(/--+/g,"-").replace(/^-+|-+$/g,"");return h.length>50&&(h=h.substring(0,50)),h.replace(/-+$/g,"")}function s(c){c.querySelectorAll("*");const h=getComputedStyle(document.documentElement),u=h.getPropertyValue("--font-family-base")||h.fontFamily||"'Arial', sans-serif";if(c.querySelectorAll("text").forEach(p=>{p.hasAttribute("font-family")||p.setAttribute("font-family",u.replace(/['"]/g,""));const v=p.getAttribute("fill");(!v||v==="none"||v==="transparent")&&p.setAttribute("fill",h.getPropertyValue("--color-text-primary")||"#333333"),p.hasAttribute("font-size")||p.setAttribute("font-size",h.getPropertyValue("--font-size-base")||"14px")}),c.querySelectorAll(".axis path, .axis line, .domain").forEach(p=>{p instanceof SVGElement&&(p.hasAttribute("stroke")||p.setAttribute("stroke",h.getPropertyValue("--color-border")||"#cccccc"))}),c.querySelectorAll(".grid line, .grid path, .tick line").forEach(p=>{p instanceof SVGElement&&(p.hasAttribute("stroke")||p.setAttribute("stroke",h.getPropertyValue("--color-border-light")||"#e5e5e5"))}),c.querySelectorAll(".bar, .line, .area, .point, .mark").forEach(p=>{p instanceof SVGElement&&!p.hasAttribute("fill")&&p.tagName.toLowerCase()!=="line"&&p.setAttribute("fill",h.getPropertyValue("--color-primary")||"#4299e1")}),!c.hasAttribute("viewBox")&&c.hasAttribute("width")&&c.hasAttribute("height")){const p=c.getAttribute("width")||"800",v=c.getAttribute("height")||"600";c.setAttribute("viewBox",`0 0 ${p} ${v}`)}c.style.backgroundColor||(c.style.backgroundColor=h.getPropertyValue("--color-bg-page")||"#ffffff")}function d(c){const h=parseInt(c.getAttribute("width")||"800"),u=parseInt(c.getAttribute("height")||"600"),g=getComputedStyle(document.documentElement),p=g.getPropertyValue("--color-bg-page")||g.getPropertyValue("--color-bg-primary")||"#ffffff",v=document.createElementNS("http://www.w3.org/2000/svg","rect");v.setAttribute("width",h.toString()),v.setAttribute("height",u.toString()),v.setAttribute("x","0"),v.setAttribute("y","0"),v.setAttribute("fill",p);const y=c.firstChild;y?c.insertBefore(v,y):c.appendChild(v),c.style.backgroundColor=p;const m=document.createComment(" Background rectangle added for proper rendering ");c.insertBefore(m,v)}Me();var l=Ff();zt(c=>{ve(l,"title",c),ve(l,"aria-label",c)},[()=>lt("ui.download_visualization")],ie),_e("click",l,n),rt(t,l),$e()}function Pf(t,e){ke(e,!1);const[n,r]=tn(),i=()=>vt(xe,"$languageStore",n),o="TranslationContext";let a=!1,s=()=>{},d=i();zu("translationContext",{componentId:o,getLanguage:()=>d,languageStore:xe});function l(u){a&&(d=u)}We(()=>{a=!0,s=xe.subscribe(u=>{l(u)})}),Dn(()=>{s&&s(),a=!1}),Me();var c=ue(),h=te(c);Ul(h,e,"default",{},null),rt(t,c),$e(),r()}function Ni(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Hf(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function za(t){let e,n,r;t.length!==2?(e=Ni,n=(s,d)=>Ni(t(s),d),r=(s,d)=>t(s)-d):(e=t===Ni||t===Hf?t:Of,n=t,r=t);function i(s,d,l=0,c=s.length){if(l<c){if(e(d,d)!==0)return c;do{const h=l+c>>>1;n(s[h],d)<0?l=h+1:c=h}while(l<c)}return l}function o(s,d,l=0,c=s.length){if(l<c){if(e(d,d)!==0)return c;do{const h=l+c>>>1;n(s[h],d)<=0?l=h+1:c=h}while(l<c)}return l}function a(s,d,l=0,c=s.length){const h=i(s,d,l,c-1);return h>l&&r(s[h-1],d)>-r(s[h],d)?h-1:h}return{left:i,center:a,right:o}}function Of(){return 0}function Uf(t){return t===null?NaN:+t}const Bf=za(Ni),qf=Bf.right;za(Uf).center;function Vf(t,e){let n,r;if(e===void 0)for(const i of t)i!=null&&(n===void 0?i>=i&&(n=r=i):(n>i&&(n=i),r<i&&(r=i)));else{let i=-1;for(let o of t)(o=e(o,++i,t))!=null&&(n===void 0?o>=o&&(n=r=o):(n>o&&(n=o),r<o&&(r=o)))}return[n,r]}class _r extends Map{constructor(e,n=Zf){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),e!=null)for(const[r,i]of e)this.set(r,i)}get(e){return super.get(us(this,e))}has(e){return super.has(us(this,e))}set(e,n){return super.set(Wf(this,e),n)}delete(e){return super.delete(Yf(this,e))}}function us({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):n}function Wf({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):(t.set(r,n),n)}function Yf({_intern:t,_key:e},n){const r=e(n);return t.has(r)&&(n=t.get(r),t.delete(r)),n}function Zf(t){return t!==null&&typeof t=="object"?t.valueOf():t}function jo(t){return t}function Ma(t,...e){return Gl(t,jo,jo,e)}function fs(t,e,...n){return Gl(t,jo,e,n)}function Gl(t,e,n,r){return function i(o,a){if(a>=r.length)return n(o);const s=new _r,d=r[a++];let l=-1;for(const c of o){const h=d(c,++l,o),u=s.get(h);u?u.push(c):s.set(h,[c])}for(const[c,h]of s)s.set(c,i(h,a));return e(s)}(t,0)}const Gf=Math.sqrt(50),Kf=Math.sqrt(10),Xf=Math.sqrt(2);function Zi(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),o=r/Math.pow(10,i),a=o>=Gf?10:o>=Kf?5:o>=Xf?2:1;let s,d,l;return i<0?(l=Math.pow(10,-i)/a,s=Math.round(t*l),d=Math.round(e*l),s/l<t&&++s,d/l>e&&--d,l=-l):(l=Math.pow(10,i)*a,s=Math.round(t/l),d=Math.round(e/l),s*l<t&&++s,d*l>e&&--d),d<s&&.5<=n&&n<2?Zi(t,e,n*2):[s,d,l]}function Jo(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const r=e<t,[i,o,a]=r?Zi(e,t,n):Zi(t,e,n);if(!(o>=i))return[];const s=o-i+1,d=new Array(s);if(r)if(a<0)for(let l=0;l<s;++l)d[l]=(o-l)/-a;else for(let l=0;l<s;++l)d[l]=(o-l)*a;else if(a<0)for(let l=0;l<s;++l)d[l]=(i+l)/-a;else for(let l=0;l<s;++l)d[l]=(i+l)*a;return d}function Qo(t,e,n){return e=+e,t=+t,n=+n,Zi(t,e,n)[2]}function ta(t,e,n){e=+e,t=+t,n=+n;const r=e<t,i=r?Qo(e,t,n):Qo(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}function Tr(t,e){let n;if(e===void 0)for(const r of t)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of t)(i=e(i,++r,t))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function jf(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((e-t)/n))|0,o=new Array(i);++r<i;)o[r]=t+r*n;return o}function Jf(t){return t}var Di=1,Ii=2,ea=3,Xr=4,ds=1e-6;function Qf(t){return"translate("+t+",0)"}function td(t){return"translate(0,"+t+")"}function ed(t){return e=>+t(e)}function nd(t,e){return e=Math.max(0,t.bandwidth()-e*2)/2,t.round()&&(e=Math.round(e)),n=>+t(n)+e}function rd(){return!this.__axis}function ko(t,e){var n=[],r=null,i=null,o=6,a=6,s=3,d=typeof window<"u"&&window.devicePixelRatio>1?0:.5,l=t===Di||t===Xr?-1:1,c=t===Xr||t===Ii?"x":"y",h=t===Di||t===ea?Qf:td;function u(g){var p=r??(e.ticks?e.ticks.apply(e,n):e.domain()),v=i??(e.tickFormat?e.tickFormat.apply(e,n):Jf),y=Math.max(o,0)+s,m=e.range(),C=+m[0]+d,z=+m[m.length-1]+d,w=(e.bandwidth?nd:ed)(e.copy(),d),b=g.selection?g.selection():g,_=b.selectAll(".domain").data([null]),M=b.selectAll(".tick").data(p,e).order(),R=M.exit(),U=M.enter().append("g").attr("class","tick"),T=M.select("line"),E=M.select("text");_=_.merge(_.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),M=M.merge(U),T=T.merge(U.append("line").attr("stroke","currentColor").attr(c+"2",l*o)),E=E.merge(U.append("text").attr("fill","currentColor").attr(c,l*y).attr("dy",t===Di?"0em":t===ea?"0.71em":"0.32em")),g!==b&&(_=_.transition(g),M=M.transition(g),T=T.transition(g),E=E.transition(g),R=R.transition(g).attr("opacity",ds).attr("transform",function(N){return isFinite(N=w(N))?h(N+d):this.getAttribute("transform")}),U.attr("opacity",ds).attr("transform",function(N){var P=this.parentNode.__axis;return h((P&&isFinite(P=P(N))?P:w(N))+d)})),R.remove(),_.attr("d",t===Xr||t===Ii?a?"M"+l*a+","+C+"H"+d+"V"+z+"H"+l*a:"M"+d+","+C+"V"+z:a?"M"+C+","+l*a+"V"+d+"H"+z+"V"+l*a:"M"+C+","+d+"H"+z),M.attr("opacity",1).attr("transform",function(N){return h(w(N)+d)}),T.attr(c+"2",l*o),E.attr(c,l*y).text(v),b.filter(rd).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===Ii?"start":t===Xr?"end":"middle"),b.each(function(){this.__axis=w})}return u.scale=function(g){return arguments.length?(e=g,u):e},u.ticks=function(){return n=Array.from(arguments),u},u.tickArguments=function(g){return arguments.length?(n=g==null?[]:Array.from(g),u):n.slice()},u.tickValues=function(g){return arguments.length?(r=g==null?null:Array.from(g),u):r&&r.slice()},u.tickFormat=function(g){return arguments.length?(i=g,u):i},u.tickSize=function(g){return arguments.length?(o=a=+g,u):o},u.tickSizeInner=function(g){return arguments.length?(o=+g,u):o},u.tickSizeOuter=function(g){return arguments.length?(a=+g,u):a},u.tickPadding=function(g){return arguments.length?(s=+g,u):s},u.offset=function(g){return arguments.length?(d=+g,u):d},u}function id(t){return ko(Di,t)}function od(t){return ko(Ii,t)}function Gi(t){return ko(ea,t)}function Ki(t){return ko(Xr,t)}var ad={value:()=>{}};function Kl(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Li(n)}function Li(t){this._=t}function sd(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Li.prototype=Kl.prototype={constructor:Li,on:function(t,e){var n=this._,r=sd(t+"",n),i,o=-1,a=r.length;if(arguments.length<2){for(;++o<a;)if((i=(t=r[o]).type)&&(i=ld(n[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++o<a;)if(i=(t=r[o]).type)n[i]=hs(n[i],t.name,e);else if(e==null)for(i in n)n[i]=hs(n[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Li(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,o;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=this._[t],r=0,i=o.length;r<i;++r)o[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(e,n)}};function ld(t,e){for(var n=0,r=t.length,i;n<r;++n)if((i=t[n]).name===e)return i.value}function hs(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=ad,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var na="http://www.w3.org/1999/xhtml";const gs={svg:"http://www.w3.org/2000/svg",xhtml:na,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function $o(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),gs.hasOwnProperty(e)?{space:gs[e],local:t}:t}function cd(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===na&&e.documentElement.namespaceURI===na?e.createElement(t):e.createElementNS(n,t)}}function ud(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Xl(t){var e=$o(t);return(e.local?ud:cd)(e)}function fd(){}function Aa(t){return t==null?fd:function(){return this.querySelector(t)}}function dd(t){typeof t!="function"&&(t=Aa(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o=e[i],a=o.length,s=r[i]=new Array(a),d,l,c=0;c<a;++c)(d=o[c])&&(l=t.call(d,d.__data__,c,o))&&("__data__"in d&&(l.__data__=d.__data__),s[c]=l);return new Ve(r,this._parents)}function hd(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function gd(){return[]}function jl(t){return t==null?gd:function(){return this.querySelectorAll(t)}}function pd(t){return function(){return hd(t.apply(this,arguments))}}function md(t){typeof t=="function"?t=pd(t):t=jl(t);for(var e=this._groups,n=e.length,r=[],i=[],o=0;o<n;++o)for(var a=e[o],s=a.length,d,l=0;l<s;++l)(d=a[l])&&(r.push(t.call(d,d.__data__,l,a)),i.push(d));return new Ve(r,i)}function Jl(t){return function(){return this.matches(t)}}function Ql(t){return function(e){return e.matches(t)}}var vd=Array.prototype.find;function yd(t){return function(){return vd.call(this.children,t)}}function _d(){return this.firstElementChild}function xd(t){return this.select(t==null?_d:yd(typeof t=="function"?t:Ql(t)))}var bd=Array.prototype.filter;function wd(){return Array.from(this.children)}function Td(t){return function(){return bd.call(this.children,t)}}function Cd(t){return this.selectAll(t==null?wd:Td(typeof t=="function"?t:Ql(t)))}function kd(t){typeof t!="function"&&(t=Jl(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o=e[i],a=o.length,s=r[i]=[],d,l=0;l<a;++l)(d=o[l])&&t.call(d,d.__data__,l,o)&&s.push(d);return new Ve(r,this._parents)}function tc(t){return new Array(t.length)}function $d(){return new Ve(this._enter||this._groups.map(tc),this._parents)}function Xi(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}Xi.prototype={constructor:Xi,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function zd(t){return function(){return t}}function Md(t,e,n,r,i,o){for(var a=0,s,d=e.length,l=o.length;a<l;++a)(s=e[a])?(s.__data__=o[a],r[a]=s):n[a]=new Xi(t,o[a]);for(;a<d;++a)(s=e[a])&&(i[a]=s)}function Ad(t,e,n,r,i,o,a){var s,d,l=new Map,c=e.length,h=o.length,u=new Array(c),g;for(s=0;s<c;++s)(d=e[s])&&(u[s]=g=a.call(d,d.__data__,s,e)+"",l.has(g)?i[s]=d:l.set(g,d));for(s=0;s<h;++s)g=a.call(t,o[s],s,o)+"",(d=l.get(g))?(r[s]=d,d.__data__=o[s],l.delete(g)):n[s]=new Xi(t,o[s]);for(s=0;s<c;++s)(d=e[s])&&l.get(u[s])===d&&(i[s]=d)}function Sd(t){return t.__data__}function Ed(t,e){if(!arguments.length)return Array.from(this,Sd);var n=e?Ad:Md,r=this._parents,i=this._groups;typeof t!="function"&&(t=zd(t));for(var o=i.length,a=new Array(o),s=new Array(o),d=new Array(o),l=0;l<o;++l){var c=r[l],h=i[l],u=h.length,g=Nd(t.call(c,c&&c.__data__,l,r)),p=g.length,v=s[l]=new Array(p),y=a[l]=new Array(p),m=d[l]=new Array(u);n(c,h,v,y,m,g,e);for(var C=0,z=0,w,b;C<p;++C)if(w=v[C]){for(C>=z&&(z=C+1);!(b=y[z])&&++z<p;);w._next=b||null}}return a=new Ve(a,r),a._enter=s,a._exit=d,a}function Nd(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Dd(){return new Ve(this._exit||this._groups.map(tc),this._parents)}function Id(t,e,n){var r=this.enter(),i=this,o=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),e!=null&&(i=e(i),i&&(i=i.selection())),n==null?o.remove():n(o),r&&i?r.merge(i).order():i}function Ld(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,o=r.length,a=Math.min(i,o),s=new Array(i),d=0;d<a;++d)for(var l=n[d],c=r[d],h=l.length,u=s[d]=new Array(h),g,p=0;p<h;++p)(g=l[p]||c[p])&&(u[p]=g);for(;d<i;++d)s[d]=n[d];return new Ve(s,this._parents)}function Fd(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],i=r.length-1,o=r[i],a;--i>=0;)(a=r[i])&&(o&&a.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(a,o),o=a);return this}function Rd(t){t||(t=Pd);function e(h,u){return h&&u?t(h.__data__,u.__data__):!h-!u}for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var a=n[o],s=a.length,d=i[o]=new Array(s),l,c=0;c<s;++c)(l=a[c])&&(d[c]=l);d.sort(e)}return new Ve(i,this._parents).order()}function Pd(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Hd(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function Od(){return Array.from(this)}function Ud(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null}function Bd(){let t=0;for(const e of this)++t;return t}function qd(){return!this.node()}function Vd(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i=e[n],o=0,a=i.length,s;o<a;++o)(s=i[o])&&t.call(s,s.__data__,o,i);return this}function Wd(t){return function(){this.removeAttribute(t)}}function Yd(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Zd(t,e){return function(){this.setAttribute(t,e)}}function Gd(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Kd(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function Xd(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function jd(t,e){var n=$o(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?Yd:Wd:typeof e=="function"?n.local?Xd:Kd:n.local?Gd:Zd)(n,e))}function ec(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Jd(t){return function(){this.style.removeProperty(t)}}function Qd(t,e,n){return function(){this.style.setProperty(t,e,n)}}function th(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function eh(t,e,n){return arguments.length>1?this.each((e==null?Jd:typeof e=="function"?th:Qd)(t,e,n??"")):Cr(this.node(),t)}function Cr(t,e){return t.style.getPropertyValue(e)||ec(t).getComputedStyle(t,null).getPropertyValue(e)}function nh(t){return function(){delete this[t]}}function rh(t,e){return function(){this[t]=e}}function ih(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function oh(t,e){return arguments.length>1?this.each((e==null?nh:typeof e=="function"?ih:rh)(t,e)):this.node()[t]}function nc(t){return t.trim().split(/^|\s+/)}function Sa(t){return t.classList||new rc(t)}function rc(t){this._node=t,this._names=nc(t.getAttribute("class")||"")}rc.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function ic(t,e){for(var n=Sa(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function oc(t,e){for(var n=Sa(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function ah(t){return function(){ic(this,t)}}function sh(t){return function(){oc(this,t)}}function lh(t,e){return function(){(e.apply(this,arguments)?ic:oc)(this,t)}}function ch(t,e){var n=nc(t+"");if(arguments.length<2){for(var r=Sa(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof e=="function"?lh:e?ah:sh)(n,e))}function uh(){this.textContent=""}function fh(t){return function(){this.textContent=t}}function dh(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function hh(t){return arguments.length?this.each(t==null?uh:(typeof t=="function"?dh:fh)(t)):this.node().textContent}function gh(){this.innerHTML=""}function ph(t){return function(){this.innerHTML=t}}function mh(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function vh(t){return arguments.length?this.each(t==null?gh:(typeof t=="function"?mh:ph)(t)):this.node().innerHTML}function yh(){this.nextSibling&&this.parentNode.appendChild(this)}function _h(){return this.each(yh)}function xh(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function bh(){return this.each(xh)}function wh(t){var e=typeof t=="function"?t:Xl(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function Th(){return null}function Ch(t,e){var n=typeof t=="function"?t:Xl(t),r=e==null?Th:typeof e=="function"?e:Aa(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function kh(){var t=this.parentNode;t&&t.removeChild(this)}function $h(){return this.each(kh)}function zh(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Mh(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Ah(t){return this.select(t?Mh:zh)}function Sh(t){return arguments.length?this.property("__data__",t):this.node().__data__}function Eh(t){return function(e){t.call(this,e,this.__data__)}}function Nh(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function Dh(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,i=e.length,o;n<i;++n)o=e[n],(!t.type||o.type===t.type)&&o.name===t.name?this.removeEventListener(o.type,o.listener,o.options):e[++r]=o;++r?e.length=r:delete this.__on}}}function Ih(t,e,n){return function(){var r=this.__on,i,o=Eh(e);if(r){for(var a=0,s=r.length;a<s;++a)if((i=r[a]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=o,i.options=n),i.value=e;return}}this.addEventListener(t.type,o,n),i={type:t.type,name:t.name,value:e,listener:o,options:n},r?r.push(i):this.__on=[i]}}function Lh(t,e,n){var r=Nh(t+""),i,o=r.length,a;if(arguments.length<2){var s=this.node().__on;if(s){for(var d=0,l=s.length,c;d<l;++d)for(i=0,c=s[d];i<o;++i)if((a=r[i]).type===c.type&&a.name===c.name)return c.value}return}for(s=e?Ih:Dh,i=0;i<o;++i)this.each(s(r[i],e,n));return this}function ac(t,e,n){var r=ec(t),i=r.CustomEvent;typeof i=="function"?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function Fh(t,e){return function(){return ac(this,t,e)}}function Rh(t,e){return function(){return ac(this,t,e.apply(this,arguments))}}function Ph(t,e){return this.each((typeof e=="function"?Rh:Fh)(t,e))}function*Hh(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length,a;i<o;++i)(a=r[i])&&(yield a)}var sc=[null];function Ve(t,e){this._groups=t,this._parents=e}function Lr(){return new Ve([[document.documentElement]],sc)}function Oh(){return this}Ve.prototype=Lr.prototype={constructor:Ve,select:dd,selectAll:md,selectChild:xd,selectChildren:Cd,filter:kd,data:Ed,enter:$d,exit:Dd,join:Id,merge:Ld,selection:Oh,order:Fd,sort:Rd,call:Hd,nodes:Od,node:Ud,size:Bd,empty:qd,each:Vd,attr:jd,style:eh,property:oh,classed:ch,text:hh,html:vh,raise:_h,lower:bh,append:wh,insert:Ch,remove:$h,clone:Ah,datum:Sh,on:Lh,dispatch:Ph,[Symbol.iterator]:Hh};function ht(t){return typeof t=="string"?new Ve([[document.querySelector(t)]],[document.documentElement]):new Ve([[t]],sc)}function Ea(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function lc(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function mi(){}var si=.7,ji=1/si,xr="\\s*([+-]?\\d+)\\s*",li="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",fn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Uh=/^#([0-9a-f]{3,8})$/,Bh=new RegExp(`^rgb\\(${xr},${xr},${xr}\\)$`),qh=new RegExp(`^rgb\\(${fn},${fn},${fn}\\)$`),Vh=new RegExp(`^rgba\\(${xr},${xr},${xr},${li}\\)$`),Wh=new RegExp(`^rgba\\(${fn},${fn},${fn},${li}\\)$`),Yh=new RegExp(`^hsl\\(${li},${fn},${fn}\\)$`),Zh=new RegExp(`^hsla\\(${li},${fn},${fn},${li}\\)$`),ps={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Ea(mi,er,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:ms,formatHex:ms,formatHex8:Gh,formatHsl:Kh,formatRgb:vs,toString:vs});function ms(){return this.rgb().formatHex()}function Gh(){return this.rgb().formatHex8()}function Kh(){return cc(this).formatHsl()}function vs(){return this.rgb().formatRgb()}function er(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Uh.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?ys(e):n===3?new Pe(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?Ci(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?Ci(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Bh.exec(t))?new Pe(e[1],e[2],e[3],1):(e=qh.exec(t))?new Pe(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Vh.exec(t))?Ci(e[1],e[2],e[3],e[4]):(e=Wh.exec(t))?Ci(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Yh.exec(t))?bs(e[1],e[2]/100,e[3]/100,1):(e=Zh.exec(t))?bs(e[1],e[2]/100,e[3]/100,e[4]):ps.hasOwnProperty(t)?ys(ps[t]):t==="transparent"?new Pe(NaN,NaN,NaN,0):null}function ys(t){return new Pe(t>>16&255,t>>8&255,t&255,1)}function Ci(t,e,n,r){return r<=0&&(t=e=n=NaN),new Pe(t,e,n,r)}function Xh(t){return t instanceof mi||(t=er(t)),t?(t=t.rgb(),new Pe(t.r,t.g,t.b,t.opacity)):new Pe}function Fe(t,e,n,r){return arguments.length===1?Xh(t):new Pe(t,e,n,r??1)}function Pe(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}Ea(Pe,Fe,lc(mi,{brighter(t){return t=t==null?ji:Math.pow(ji,t),new Pe(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?si:Math.pow(si,t),new Pe(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Pe(Qn(this.r),Qn(this.g),Qn(this.b),Ji(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:_s,formatHex:_s,formatHex8:jh,formatRgb:xs,toString:xs}));function _s(){return`#${jn(this.r)}${jn(this.g)}${jn(this.b)}`}function jh(){return`#${jn(this.r)}${jn(this.g)}${jn(this.b)}${jn((isNaN(this.opacity)?1:this.opacity)*255)}`}function xs(){const t=Ji(this.opacity);return`${t===1?"rgb(":"rgba("}${Qn(this.r)}, ${Qn(this.g)}, ${Qn(this.b)}${t===1?")":`, ${t})`}`}function Ji(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Qn(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function jn(t){return t=Qn(t),(t<16?"0":"")+t.toString(16)}function bs(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new rn(t,e,n,r)}function cc(t){if(t instanceof rn)return new rn(t.h,t.s,t.l,t.opacity);if(t instanceof mi||(t=er(t)),!t)return new rn;if(t instanceof rn)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),a=NaN,s=o-i,d=(o+i)/2;return s?(e===o?a=(n-r)/s+(n<r)*6:n===o?a=(r-e)/s+2:a=(e-n)/s+4,s/=d<.5?o+i:2-o-i,a*=60):s=d>0&&d<1?0:a,new rn(a,s,d,t.opacity)}function uc(t,e,n,r){return arguments.length===1?cc(t):new rn(t,e,n,r??1)}function rn(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}Ea(rn,uc,lc(mi,{brighter(t){return t=t==null?ji:Math.pow(ji,t),new rn(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?si:Math.pow(si,t),new rn(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Pe(No(t>=240?t-240:t+120,i,r),No(t,i,r),No(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new rn(ws(this.h),ki(this.s),ki(this.l),Ji(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Ji(this.opacity);return`${t===1?"hsl(":"hsla("}${ws(this.h)}, ${ki(this.s)*100}%, ${ki(this.l)*100}%${t===1?")":`, ${t})`}`}}));function ws(t){return t=(t||0)%360,t<0?t+360:t}function ki(t){return Math.max(0,Math.min(1,t||0))}function No(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}function Jh(t,e,n,r,i){var o=t*t,a=o*t;return((1-3*t+3*o-a)*e+(4-6*o+3*a)*n+(1+3*t+3*o-3*a)*r+a*i)/6}function Qh(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],o=t[r+1],a=r>0?t[r-1]:2*i-o,s=r<e-1?t[r+2]:2*o-i;return Jh((n-r/e)*e,a,i,o,s)}}const Na=t=>()=>t;function tg(t,e){return function(n){return t+n*e}}function eg(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function ng(t){return(t=+t)==1?fc:function(e,n){return n-e?eg(e,n,t):Na(isNaN(e)?n:e)}}function fc(t,e){var n=e-t;return n?tg(t,n):Na(isNaN(t)?e:t)}const Qi=function t(e){var n=ng(e);function r(i,o){var a=n((i=Fe(i)).r,(o=Fe(o)).r),s=n(i.g,o.g),d=n(i.b,o.b),l=fc(i.opacity,o.opacity);return function(c){return i.r=a(c),i.g=s(c),i.b=d(c),i.opacity=l(c),i+""}}return r.gamma=t,r}(1);function rg(t){return function(e){var n=e.length,r=new Array(n),i=new Array(n),o=new Array(n),a,s;for(a=0;a<n;++a)s=Fe(e[a]),r[a]=s.r||0,i[a]=s.g||0,o[a]=s.b||0;return r=t(r),i=t(i),o=t(o),s.opacity=1,function(d){return s.r=r(d),s.g=i(d),s.b=o(d),s+""}}}var ig=rg(Qh);function og(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),i;return function(o){for(i=0;i<n;++i)r[i]=t[i]*(1-o)+e[i]*o;return r}}function ag(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function sg(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,i=new Array(r),o=new Array(n),a;for(a=0;a<r;++a)i[a]=kr(t[a],e[a]);for(;a<n;++a)o[a]=e[a];return function(s){for(a=0;a<r;++a)o[a]=i[a](s);return o}}function lg(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function nn(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function cg(t,e){var n={},r={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?n[i]=kr(t[i],e[i]):r[i]=e[i];return function(o){for(i in n)r[i]=n[i](o);return r}}var ra=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Do=new RegExp(ra.source,"g");function ug(t){return function(){return t}}function fg(t){return function(e){return t(e)+""}}function dc(t,e){var n=ra.lastIndex=Do.lastIndex=0,r,i,o,a=-1,s=[],d=[];for(t=t+"",e=e+"";(r=ra.exec(t))&&(i=Do.exec(e));)(o=i.index)>n&&(o=e.slice(n,o),s[a]?s[a]+=o:s[++a]=o),(r=r[0])===(i=i[0])?s[a]?s[a]+=i:s[++a]=i:(s[++a]=null,d.push({i:a,x:nn(r,i)})),n=Do.lastIndex;return n<e.length&&(o=e.slice(n),s[a]?s[a]+=o:s[++a]=o),s.length<2?d[0]?fg(d[0].x):ug(e):(e=d.length,function(l){for(var c=0,h;c<e;++c)s[(h=d[c]).i]=h.x(l);return s.join("")})}function kr(t,e){var n=typeof e,r;return e==null||n==="boolean"?Na(e):(n==="number"?nn:n==="string"?(r=er(e))?(e=r,Qi):dc:e instanceof er?Qi:e instanceof Date?lg:ag(e)?og:Array.isArray(e)?sg:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?cg:nn)(t,e)}function hc(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var Ts=180/Math.PI,ia={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function gc(t,e,n,r,i,o){var a,s,d;return(a=Math.sqrt(t*t+e*e))&&(t/=a,e/=a),(d=t*n+e*r)&&(n-=t*d,r-=e*d),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,d/=s),t*r<e*n&&(t=-t,e=-e,d=-d,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(e,t)*Ts,skewX:Math.atan(d)*Ts,scaleX:a,scaleY:s}}var $i;function dg(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?ia:gc(e.a,e.b,e.c,e.d,e.e,e.f)}function hg(t){return t==null||($i||($i=document.createElementNS("http://www.w3.org/2000/svg","g")),$i.setAttribute("transform",t),!(t=$i.transform.baseVal.consolidate()))?ia:(t=t.matrix,gc(t.a,t.b,t.c,t.d,t.e,t.f))}function pc(t,e,n,r){function i(l){return l.length?l.pop()+" ":""}function o(l,c,h,u,g,p){if(l!==h||c!==u){var v=g.push("translate(",null,e,null,n);p.push({i:v-4,x:nn(l,h)},{i:v-2,x:nn(c,u)})}else(h||u)&&g.push("translate("+h+e+u+n)}function a(l,c,h,u){l!==c?(l-c>180?c+=360:c-l>180&&(l+=360),u.push({i:h.push(i(h)+"rotate(",null,r)-2,x:nn(l,c)})):c&&h.push(i(h)+"rotate("+c+r)}function s(l,c,h,u){l!==c?u.push({i:h.push(i(h)+"skewX(",null,r)-2,x:nn(l,c)}):c&&h.push(i(h)+"skewX("+c+r)}function d(l,c,h,u,g,p){if(l!==h||c!==u){var v=g.push(i(g)+"scale(",null,",",null,")");p.push({i:v-4,x:nn(l,h)},{i:v-2,x:nn(c,u)})}else(h!==1||u!==1)&&g.push(i(g)+"scale("+h+","+u+")")}return function(l,c){var h=[],u=[];return l=t(l),c=t(c),o(l.translateX,l.translateY,c.translateX,c.translateY,h,u),a(l.rotate,c.rotate,h,u),s(l.skewX,c.skewX,h,u),d(l.scaleX,l.scaleY,c.scaleX,c.scaleY,h,u),l=c=null,function(g){for(var p=-1,v=u.length,y;++p<v;)h[(y=u[p]).i]=y.x(g);return h.join("")}}}var gg=pc(dg,"px, ","px)","deg)"),pg=pc(hg,", ",")",")"),$r=0,jr=0,qr=0,mc=1e3,to,Jr,eo=0,nr=0,zo=0,ci=typeof performance=="object"&&performance.now?performance:Date,vc=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Da(){return nr||(vc(mg),nr=ci.now()+zo)}function mg(){nr=0}function no(){this._call=this._time=this._next=null}no.prototype=yc.prototype={constructor:no,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?Da():+n)+(e==null?0:+e),!this._next&&Jr!==this&&(Jr?Jr._next=this:to=this,Jr=this),this._call=t,this._time=n,oa()},stop:function(){this._call&&(this._call=null,this._time=1/0,oa())}};function yc(t,e,n){var r=new no;return r.restart(t,e,n),r}function vg(){Da(),++$r;for(var t=to,e;t;)(e=nr-t._time)>=0&&t._call.call(void 0,e),t=t._next;--$r}function Cs(){nr=(eo=ci.now())+zo,$r=jr=0;try{vg()}finally{$r=0,_g(),nr=0}}function yg(){var t=ci.now(),e=t-eo;e>mc&&(zo-=e,eo=t)}function _g(){for(var t,e=to,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:to=n);Jr=t,oa(r)}function oa(t){if(!$r){jr&&(jr=clearTimeout(jr));var e=t-nr;e>24?(t<1/0&&(jr=setTimeout(Cs,t-ci.now()-zo)),qr&&(qr=clearInterval(qr))):(qr||(eo=ci.now(),qr=setInterval(yg,mc)),$r=1,vc(Cs))}}function ks(t,e,n){var r=new no;return e=e==null?0:+e,r.restart(i=>{r.stop(),t(i+e)},e,n),r}var xg=Kl("start","end","cancel","interrupt"),bg=[],_c=0,$s=1,aa=2,Fi=3,zs=4,sa=5,Ri=6;function Mo(t,e,n,r,i,o){var a=t.__transition;if(!a)t.__transition={};else if(n in a)return;wg(t,n,{name:e,index:r,group:i,on:xg,tween:bg,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:_c})}function Ia(t,e){var n=an(t,e);if(n.state>_c)throw new Error("too late; already scheduled");return n}function gn(t,e){var n=an(t,e);if(n.state>Fi)throw new Error("too late; already running");return n}function an(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function wg(t,e,n){var r=t.__transition,i;r[e]=n,n.timer=yc(o,0,n.time);function o(l){n.state=$s,n.timer.restart(a,n.delay,n.time),n.delay<=l&&a(l-n.delay)}function a(l){var c,h,u,g;if(n.state!==$s)return d();for(c in r)if(g=r[c],g.name===n.name){if(g.state===Fi)return ks(a);g.state===zs?(g.state=Ri,g.timer.stop(),g.on.call("interrupt",t,t.__data__,g.index,g.group),delete r[c]):+c<e&&(g.state=Ri,g.timer.stop(),g.on.call("cancel",t,t.__data__,g.index,g.group),delete r[c])}if(ks(function(){n.state===Fi&&(n.state=zs,n.timer.restart(s,n.delay,n.time),s(l))}),n.state=aa,n.on.call("start",t,t.__data__,n.index,n.group),n.state===aa){for(n.state=Fi,i=new Array(u=n.tween.length),c=0,h=-1;c<u;++c)(g=n.tween[c].value.call(t,t.__data__,n.index,n.group))&&(i[++h]=g);i.length=h+1}}function s(l){for(var c=l<n.duration?n.ease.call(null,l/n.duration):(n.timer.restart(d),n.state=sa,1),h=-1,u=i.length;++h<u;)i[h].call(t,c);n.state===sa&&(n.on.call("end",t,t.__data__,n.index,n.group),d())}function d(){n.state=Ri,n.timer.stop(),delete r[e];for(var l in r)return;delete t.__transition}}function Tg(t,e){var n=t.__transition,r,i,o=!0,a;if(n){e=e==null?null:e+"";for(a in n){if((r=n[a]).name!==e){o=!1;continue}i=r.state>aa&&r.state<sa,r.state=Ri,r.timer.stop(),r.on.call(i?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[a]}o&&delete t.__transition}}function Cg(t){return this.each(function(){Tg(this,t)})}function kg(t,e){var n,r;return function(){var i=gn(this,t),o=i.tween;if(o!==n){r=n=o;for(var a=0,s=r.length;a<s;++a)if(r[a].name===e){r=r.slice(),r.splice(a,1);break}}i.tween=r}}function $g(t,e,n){var r,i;if(typeof n!="function")throw new Error;return function(){var o=gn(this,t),a=o.tween;if(a!==r){i=(r=a).slice();for(var s={name:e,value:n},d=0,l=i.length;d<l;++d)if(i[d].name===e){i[d]=s;break}d===l&&i.push(s)}o.tween=i}}function zg(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=an(this.node(),n).tween,i=0,o=r.length,a;i<o;++i)if((a=r[i]).name===t)return a.value;return null}return this.each((e==null?kg:$g)(n,t,e))}function La(t,e,n){var r=t._id;return t.each(function(){var i=gn(this,r);(i.value||(i.value={}))[e]=n.apply(this,arguments)}),function(i){return an(i,r).value[e]}}function xc(t,e){var n;return(typeof e=="number"?nn:e instanceof er?Qi:(n=er(e))?(e=n,Qi):dc)(t,e)}function Mg(t){return function(){this.removeAttribute(t)}}function Ag(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Sg(t,e,n){var r,i=n+"",o;return function(){var a=this.getAttribute(t);return a===i?null:a===r?o:o=e(r=a,n)}}function Eg(t,e,n){var r,i=n+"",o;return function(){var a=this.getAttributeNS(t.space,t.local);return a===i?null:a===r?o:o=e(r=a,n)}}function Ng(t,e,n){var r,i,o;return function(){var a,s=n(this),d;return s==null?void this.removeAttribute(t):(a=this.getAttribute(t),d=s+"",a===d?null:a===r&&d===i?o:(i=d,o=e(r=a,s)))}}function Dg(t,e,n){var r,i,o;return function(){var a,s=n(this),d;return s==null?void this.removeAttributeNS(t.space,t.local):(a=this.getAttributeNS(t.space,t.local),d=s+"",a===d?null:a===r&&d===i?o:(i=d,o=e(r=a,s)))}}function Ig(t,e){var n=$o(t),r=n==="transform"?pg:xc;return this.attrTween(t,typeof e=="function"?(n.local?Dg:Ng)(n,r,La(this,"attr."+t,e)):e==null?(n.local?Ag:Mg)(n):(n.local?Eg:Sg)(n,r,e))}function Lg(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function Fg(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function Rg(t,e){var n,r;function i(){var o=e.apply(this,arguments);return o!==r&&(n=(r=o)&&Fg(t,o)),n}return i._value=e,i}function Pg(t,e){var n,r;function i(){var o=e.apply(this,arguments);return o!==r&&(n=(r=o)&&Lg(t,o)),n}return i._value=e,i}function Hg(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=$o(t);return this.tween(n,(r.local?Rg:Pg)(r,e))}function Og(t,e){return function(){Ia(this,t).delay=+e.apply(this,arguments)}}function Ug(t,e){return e=+e,function(){Ia(this,t).delay=e}}function Bg(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Og:Ug)(e,t)):an(this.node(),e).delay}function qg(t,e){return function(){gn(this,t).duration=+e.apply(this,arguments)}}function Vg(t,e){return e=+e,function(){gn(this,t).duration=e}}function Wg(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?qg:Vg)(e,t)):an(this.node(),e).duration}function Yg(t,e){if(typeof e!="function")throw new Error;return function(){gn(this,t).ease=e}}function Zg(t){var e=this._id;return arguments.length?this.each(Yg(e,t)):an(this.node(),e).ease}function Gg(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;gn(this,t).ease=n}}function Kg(t){if(typeof t!="function")throw new Error;return this.each(Gg(this._id,t))}function Xg(t){typeof t!="function"&&(t=Jl(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o=e[i],a=o.length,s=r[i]=[],d,l=0;l<a;++l)(d=o[l])&&t.call(d,d.__data__,l,o)&&s.push(d);return new Mn(r,this._parents,this._name,this._id)}function jg(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,o=Math.min(r,i),a=new Array(r),s=0;s<o;++s)for(var d=e[s],l=n[s],c=d.length,h=a[s]=new Array(c),u,g=0;g<c;++g)(u=d[g]||l[g])&&(h[g]=u);for(;s<r;++s)a[s]=e[s];return new Mn(a,this._parents,this._name,this._id)}function Jg(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function Qg(t,e,n){var r,i,o=Jg(e)?Ia:gn;return function(){var a=o(this,t),s=a.on;s!==r&&(i=(r=s).copy()).on(e,n),a.on=i}}function tp(t,e){var n=this._id;return arguments.length<2?an(this.node(),n).on.on(t):this.each(Qg(n,t,e))}function ep(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function np(){return this.on("end.remove",ep(this._id))}function rp(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Aa(t));for(var r=this._groups,i=r.length,o=new Array(i),a=0;a<i;++a)for(var s=r[a],d=s.length,l=o[a]=new Array(d),c,h,u=0;u<d;++u)(c=s[u])&&(h=t.call(c,c.__data__,u,s))&&("__data__"in c&&(h.__data__=c.__data__),l[u]=h,Mo(l[u],e,n,u,l,an(c,n)));return new Mn(o,this._parents,e,n)}function ip(t){var e=this._name,n=this._id;typeof t!="function"&&(t=jl(t));for(var r=this._groups,i=r.length,o=[],a=[],s=0;s<i;++s)for(var d=r[s],l=d.length,c,h=0;h<l;++h)if(c=d[h]){for(var u=t.call(c,c.__data__,h,d),g,p=an(c,n),v=0,y=u.length;v<y;++v)(g=u[v])&&Mo(g,e,n,v,u,p);o.push(u),a.push(c)}return new Mn(o,a,e,n)}var op=Lr.prototype.constructor;function ap(){return new op(this._groups,this._parents)}function sp(t,e){var n,r,i;return function(){var o=Cr(this,t),a=(this.style.removeProperty(t),Cr(this,t));return o===a?null:o===n&&a===r?i:i=e(n=o,r=a)}}function bc(t){return function(){this.style.removeProperty(t)}}function lp(t,e,n){var r,i=n+"",o;return function(){var a=Cr(this,t);return a===i?null:a===r?o:o=e(r=a,n)}}function cp(t,e,n){var r,i,o;return function(){var a=Cr(this,t),s=n(this),d=s+"";return s==null&&(d=s=(this.style.removeProperty(t),Cr(this,t))),a===d?null:a===r&&d===i?o:(i=d,o=e(r=a,s))}}function up(t,e){var n,r,i,o="style."+e,a="end."+o,s;return function(){var d=gn(this,t),l=d.on,c=d.value[o]==null?s||(s=bc(e)):void 0;(l!==n||i!==c)&&(r=(n=l).copy()).on(a,i=c),d.on=r}}function fp(t,e,n){var r=(t+="")=="transform"?gg:xc;return e==null?this.styleTween(t,sp(t,r)).on("end.style."+t,bc(t)):typeof e=="function"?this.styleTween(t,cp(t,r,La(this,"style."+t,e))).each(up(this._id,t)):this.styleTween(t,lp(t,r,e),n).on("end.style."+t,null)}function dp(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function hp(t,e,n){var r,i;function o(){var a=e.apply(this,arguments);return a!==i&&(r=(i=a)&&dp(t,a,n)),r}return o._value=e,o}function gp(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,hp(t,e,n??""))}function pp(t){return function(){this.textContent=t}}function mp(t){return function(){var e=t(this);this.textContent=e??""}}function vp(t){return this.tween("text",typeof t=="function"?mp(La(this,"text",t)):pp(t==null?"":t+""))}function yp(t){return function(e){this.textContent=t.call(this,e)}}function _p(t){var e,n;function r(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&yp(i)),e}return r._value=t,r}function xp(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,_p(t))}function bp(){for(var t=this._name,e=this._id,n=Tc(),r=this._groups,i=r.length,o=0;o<i;++o)for(var a=r[o],s=a.length,d,l=0;l<s;++l)if(d=a[l]){var c=an(d,e);Mo(d,t,n,l,a,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new Mn(r,this._parents,t,n)}function wp(){var t,e,n=this,r=n._id,i=n.size();return new Promise(function(o,a){var s={value:a},d={value:function(){--i===0&&o()}};n.each(function(){var l=gn(this,r),c=l.on;c!==t&&(e=(t=c).copy(),e._.cancel.push(s),e._.interrupt.push(s),e._.end.push(d)),l.on=e}),i===0&&o()})}var Tp=0;function Mn(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function wc(t){return Lr().transition(t)}function Tc(){return++Tp}var yn=Lr.prototype;Mn.prototype=wc.prototype={constructor:Mn,select:rp,selectAll:ip,selectChild:yn.selectChild,selectChildren:yn.selectChildren,filter:Xg,merge:jg,selection:ap,transition:bp,call:yn.call,nodes:yn.nodes,node:yn.node,size:yn.size,empty:yn.empty,each:yn.each,on:tp,attr:Ig,attrTween:Hg,style:fp,styleTween:gp,text:vp,textTween:xp,remove:np,tween:zg,delay:Bg,duration:Wg,ease:Zg,easeVarying:Kg,end:wp,[Symbol.iterator]:yn[Symbol.iterator]};function Cc(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var Cp={time:null,delay:0,duration:250,ease:Cc};function kp(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function $p(t){var e,n;t instanceof Mn?(e=t._id,t=t._name):(e=Tc(),(n=Cp).time=Da(),t=t==null?null:t+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var a=r[o],s=a.length,d,l=0;l<s;++l)(d=a[l])&&Mo(d,t,e,l,a,n||kp(d,e));return new Mn(r,this._parents,t,e)}Lr.prototype.interrupt=Cg;Lr.prototype.transition=$p;const la=Math.PI,ca=2*la,Kn=1e-6,zp=ca-Kn;function kc(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function Mp(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return kc;const n=10**e;return function(r){this._+=r[0];for(let i=1,o=r.length;i<o;++i)this._+=Math.round(arguments[i]*n)/n+r[i]}}class Ap{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?kc:Mp(e)}moveTo(e,n){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,n){this._append`L${this._x1=+e},${this._y1=+n}`}quadraticCurveTo(e,n,r,i){this._append`Q${+e},${+n},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(e,n,r,i,o,a){this._append`C${+e},${+n},${+r},${+i},${this._x1=+o},${this._y1=+a}`}arcTo(e,n,r,i,o){if(e=+e,n=+n,r=+r,i=+i,o=+o,o<0)throw new Error(`negative radius: ${o}`);let a=this._x1,s=this._y1,d=r-e,l=i-n,c=a-e,h=s-n,u=c*c+h*h;if(this._x1===null)this._append`M${this._x1=e},${this._y1=n}`;else if(u>Kn)if(!(Math.abs(h*d-l*c)>Kn)||!o)this._append`L${this._x1=e},${this._y1=n}`;else{let g=r-a,p=i-s,v=d*d+l*l,y=g*g+p*p,m=Math.sqrt(v),C=Math.sqrt(u),z=o*Math.tan((la-Math.acos((v+u-y)/(2*m*C)))/2),w=z/C,b=z/m;Math.abs(w-1)>Kn&&this._append`L${e+w*c},${n+w*h}`,this._append`A${o},${o},0,0,${+(h*g>c*p)},${this._x1=e+b*d},${this._y1=n+b*l}`}}arc(e,n,r,i,o,a){if(e=+e,n=+n,r=+r,a=!!a,r<0)throw new Error(`negative radius: ${r}`);let s=r*Math.cos(i),d=r*Math.sin(i),l=e+s,c=n+d,h=1^a,u=a?i-o:o-i;this._x1===null?this._append`M${l},${c}`:(Math.abs(this._x1-l)>Kn||Math.abs(this._y1-c)>Kn)&&this._append`L${l},${c}`,r&&(u<0&&(u=u%ca+ca),u>zp?this._append`A${r},${r},0,1,${h},${e-s},${n-d}A${r},${r},0,1,${h},${this._x1=l},${this._y1=c}`:u>Kn&&this._append`A${r},${r},0,${+(u>=la)},${h},${this._x1=e+r*Math.cos(o)},${this._y1=n+r*Math.sin(o)}`)}rect(e,n,r,i){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}}function Sp(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function ro(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function zr(t){return t=ro(Math.abs(t)),t?t[1]:NaN}function Ep(t,e){return function(n,r){for(var i=n.length,o=[],a=0,s=t[0],d=0;i>0&&s>0&&(d+s+1>r&&(s=Math.max(1,r-d)),o.push(n.substring(i-=s,i+s)),!((d+=s+1)>r));)s=t[a=(a+1)%t.length];return o.reverse().join(e)}}function Np(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var Dp=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ui(t){if(!(e=Dp.exec(t)))throw new Error("invalid format: "+t);var e;return new Fa({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}ui.prototype=Fa.prototype;function Fa(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}Fa.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Ip(t){t:for(var e=t.length,n=1,r=-1,i;n<e;++n)switch(t[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+t[n])break t;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(i+1):t}var $c;function Lp(t,e){var n=ro(t,e);if(!n)return t+"";var r=n[0],i=n[1],o=i-($c=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+ro(t,Math.max(0,e+o-1))[0]}function Ms(t,e){var n=ro(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const As={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:Sp,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Ms(t*100,e),r:Ms,s:Lp,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Ss(t){return t}var Es=Array.prototype.map,Ns=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Fp(t){var e=t.grouping===void 0||t.thousands===void 0?Ss:Ep(Es.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",o=t.numerals===void 0?Ss:Np(Es.call(t.numerals,String)),a=t.percent===void 0?"%":t.percent+"",s=t.minus===void 0?"−":t.minus+"",d=t.nan===void 0?"NaN":t.nan+"";function l(h){h=ui(h);var u=h.fill,g=h.align,p=h.sign,v=h.symbol,y=h.zero,m=h.width,C=h.comma,z=h.precision,w=h.trim,b=h.type;b==="n"?(C=!0,b="g"):As[b]||(z===void 0&&(z=12),w=!0,b="g"),(y||u==="0"&&g==="=")&&(y=!0,u="0",g="=");var _=v==="$"?n:v==="#"&&/[boxX]/.test(b)?"0"+b.toLowerCase():"",M=v==="$"?r:/[%p]/.test(b)?a:"",R=As[b],U=/[defgprs%]/.test(b);z=z===void 0?6:/[gprs]/.test(b)?Math.max(1,Math.min(21,z)):Math.max(0,Math.min(20,z));function T(E){var N=_,P=M,B,pt,$;if(b==="c")P=R(E)+P,E="";else{E=+E;var D=E<0||1/E<0;if(E=isNaN(E)?d:R(Math.abs(E),z),w&&(E=Ip(E)),D&&+E==0&&p!=="+"&&(D=!1),N=(D?p==="("?p:s:p==="-"||p==="("?"":p)+N,P=(b==="s"?Ns[8+$c/3]:"")+P+(D&&p==="("?")":""),U){for(B=-1,pt=E.length;++B<pt;)if($=E.charCodeAt(B),48>$||$>57){P=($===46?i+E.slice(B+1):E.slice(B))+P,E=E.slice(0,B);break}}}C&&!y&&(E=e(E,1/0));var G=N.length+E.length+P.length,et=G<m?new Array(m-G+1).join(u):"";switch(C&&y&&(E=e(et+E,et.length?m-P.length:1/0),et=""),g){case"<":E=N+E+P+et;break;case"=":E=N+et+E+P;break;case"^":E=et.slice(0,G=et.length>>1)+N+E+P+et.slice(G);break;default:E=et+N+E+P;break}return o(E)}return T.toString=function(){return h+""},T}function c(h,u){var g=l((h=ui(h),h.type="f",h)),p=Math.max(-8,Math.min(8,Math.floor(zr(u)/3)))*3,v=Math.pow(10,-p),y=Ns[8+p/3];return function(m){return g(v*m)+y}}return{format:l,formatPrefix:c}}var zi,Ra,zc;Rp({thousands:",",grouping:[3],currency:["$",""]});function Rp(t){return zi=Fp(t),Ra=zi.format,zc=zi.formatPrefix,zi}function Pp(t){return Math.max(0,-zr(Math.abs(t)))}function Hp(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(zr(e)/3)))*3-zr(Math.abs(t)))}function Op(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,zr(e)-zr(t))+1}function Up(t){var e=0,n=t.children,r=n&&n.length;if(!r)e=1;else for(;--r>=0;)e+=n[r].value;t.value=e}function Bp(){return this.eachAfter(Up)}function qp(t,e){let n=-1;for(const r of this)t.call(e,r,++n,this);return this}function Vp(t,e){for(var n=this,r=[n],i,o,a=-1;n=r.pop();)if(t.call(e,n,++a,this),i=n.children)for(o=i.length-1;o>=0;--o)r.push(i[o]);return this}function Wp(t,e){for(var n=this,r=[n],i=[],o,a,s,d=-1;n=r.pop();)if(i.push(n),o=n.children)for(a=0,s=o.length;a<s;++a)r.push(o[a]);for(;n=i.pop();)t.call(e,n,++d,this);return this}function Yp(t,e){let n=-1;for(const r of this)if(t.call(e,r,++n,this))return r}function Zp(t){return this.eachAfter(function(e){for(var n=+t(e.data)||0,r=e.children,i=r&&r.length;--i>=0;)n+=r[i].value;e.value=n})}function Gp(t){return this.eachBefore(function(e){e.children&&e.children.sort(t)})}function Kp(t){for(var e=this,n=Xp(e,t),r=[e];e!==n;)e=e.parent,r.push(e);for(var i=r.length;t!==n;)r.splice(i,0,t),t=t.parent;return r}function Xp(t,e){if(t===e)return t;var n=t.ancestors(),r=e.ancestors(),i=null;for(t=n.pop(),e=r.pop();t===e;)i=t,t=n.pop(),e=r.pop();return i}function jp(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e}function Jp(){return Array.from(this)}function Qp(){var t=[];return this.eachBefore(function(e){e.children||t.push(e)}),t}function tm(){var t=this,e=[];return t.each(function(n){n!==t&&e.push({source:n.parent,target:n})}),e}function*em(){var t=this,e,n=[t],r,i,o;do for(e=n.reverse(),n=[];t=e.pop();)if(yield t,r=t.children)for(i=0,o=r.length;i<o;++i)n.push(r[i]);while(n.length)}function cn(t,e){t instanceof Map?(t=[void 0,t],e===void 0&&(e=im)):e===void 0&&(e=rm);for(var n=new io(t),r,i=[n],o,a,s,d;r=i.pop();)if((a=e(r.data))&&(d=(a=Array.from(a)).length))for(r.children=a,s=d-1;s>=0;--s)i.push(o=a[s]=new io(a[s])),o.parent=r,o.depth=r.depth+1;return n.eachBefore(am)}function nm(){return cn(this).eachBefore(om)}function rm(t){return t.children}function im(t){return Array.isArray(t)?t[1]:null}function om(t){t.data.value!==void 0&&(t.value=t.data.value),t.data=t.data.data}function am(t){var e=0;do t.height=e;while((t=t.parent)&&t.height<++e)}function io(t){this.data=t,this.depth=this.height=0,this.parent=null}io.prototype=cn.prototype={constructor:io,count:Bp,each:qp,eachAfter:Wp,eachBefore:Vp,find:Yp,sum:Zp,sort:Gp,path:Kp,ancestors:jp,descendants:Jp,leaves:Qp,links:tm,copy:nm,[Symbol.iterator]:em};function sm(t){if(typeof t!="function")throw new Error;return t}function Vr(){return 0}function Wr(t){return function(){return t}}function lm(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)}function cm(t,e,n,r,i){for(var o=t.children,a,s=-1,d=o.length,l=t.value&&(r-e)/t.value;++s<d;)a=o[s],a.y0=n,a.y1=i,a.x0=e,a.x1=e+=a.value*l}function um(t,e,n,r,i){for(var o=t.children,a,s=-1,d=o.length,l=t.value&&(i-n)/t.value;++s<d;)a=o[s],a.x0=e,a.x1=r,a.y0=n,a.y1=n+=a.value*l}var fm=(1+Math.sqrt(5))/2;function dm(t,e,n,r,i,o){for(var a=[],s=e.children,d,l,c=0,h=0,u=s.length,g,p,v=e.value,y,m,C,z,w,b,_;c<u;){g=i-n,p=o-r;do y=s[h++].value;while(!y&&h<u);for(m=C=y,b=Math.max(p/g,g/p)/(v*t),_=y*y*b,w=Math.max(C/_,_/m);h<u;++h){if(y+=l=s[h].value,l<m&&(m=l),l>C&&(C=l),_=y*y*b,z=Math.max(C/_,_/m),z>w){y-=l;break}w=z}a.push(d={value:y,dice:g<p,children:s.slice(c,h)}),d.dice?cm(d,n,r,i,v?r+=p*y/v:o):um(d,n,r,v?n+=g*y/v:i,o),v-=y,c=h}return a}const hm=function t(e){function n(r,i,o,a,s){dm(e,r,i,o,a,s)}return n.ratio=function(r){return t((r=+r)>1?r:1)},n}(fm);function Mc(){var t=hm,e=!1,n=1,r=1,i=[0],o=Vr,a=Vr,s=Vr,d=Vr,l=Vr;function c(u){return u.x0=u.y0=0,u.x1=n,u.y1=r,u.eachBefore(h),i=[0],e&&u.eachBefore(lm),u}function h(u){var g=i[u.depth],p=u.x0+g,v=u.y0+g,y=u.x1-g,m=u.y1-g;y<p&&(p=y=(p+y)/2),m<v&&(v=m=(v+m)/2),u.x0=p,u.y0=v,u.x1=y,u.y1=m,u.children&&(g=i[u.depth+1]=o(u)/2,p+=l(u)-g,v+=a(u)-g,y-=s(u)-g,m-=d(u)-g,y<p&&(p=y=(p+y)/2),m<v&&(v=m=(v+m)/2),t(u,p,v,y,m))}return c.round=function(u){return arguments.length?(e=!!u,c):e},c.size=function(u){return arguments.length?(n=+u[0],r=+u[1],c):[n,r]},c.tile=function(u){return arguments.length?(t=sm(u),c):t},c.padding=function(u){return arguments.length?c.paddingInner(u).paddingOuter(u):c.paddingInner()},c.paddingInner=function(u){return arguments.length?(o=typeof u=="function"?u:Wr(+u),c):o},c.paddingOuter=function(u){return arguments.length?c.paddingTop(u).paddingRight(u).paddingBottom(u).paddingLeft(u):c.paddingTop()},c.paddingTop=function(u){return arguments.length?(a=typeof u=="function"?u:Wr(+u),c):a},c.paddingRight=function(u){return arguments.length?(s=typeof u=="function"?u:Wr(+u),c):s},c.paddingBottom=function(u){return arguments.length?(d=typeof u=="function"?u:Wr(+u),c):d},c.paddingLeft=function(u){return arguments.length?(l=typeof u=="function"?u:Wr(+u),c):l},c}function vi(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function gm(t,e){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof e=="function"?this.interpolator(e):this.range(e);break}}return this}const Ds=Symbol("implicit");function Te(){var t=new _r,e=[],n=[],r=Ds;function i(o){let a=t.get(o);if(a===void 0){if(r!==Ds)return r;t.set(o,a=e.push(o)-1)}return n[a%n.length]}return i.domain=function(o){if(!arguments.length)return e.slice();e=[],t=new _r;for(const a of o)t.has(a)||t.set(a,e.push(a)-1);return i},i.range=function(o){return arguments.length?(n=Array.from(o),i):n.slice()},i.unknown=function(o){return arguments.length?(r=o,i):r},i.copy=function(){return Te(e,n).unknown(r)},vi.apply(i,arguments),i}function Pa(){var t=Te().unknown(void 0),e=t.domain,n=t.range,r=0,i=1,o,a,s=!1,d=0,l=0,c=.5;delete t.unknown;function h(){var u=e().length,g=i<r,p=g?i:r,v=g?r:i;o=(v-p)/Math.max(1,u-d+l*2),s&&(o=Math.floor(o)),p+=(v-p-o*(u-d))*c,a=o*(1-d),s&&(p=Math.round(p),a=Math.round(a));var y=jf(u).map(function(m){return p+o*m});return n(g?y.reverse():y)}return t.domain=function(u){return arguments.length?(e(u),h()):e()},t.range=function(u){return arguments.length?([r,i]=u,r=+r,i=+i,h()):[r,i]},t.rangeRound=function(u){return[r,i]=u,r=+r,i=+i,s=!0,h()},t.bandwidth=function(){return a},t.step=function(){return o},t.round=function(u){return arguments.length?(s=!!u,h()):s},t.padding=function(u){return arguments.length?(d=Math.min(1,l=+u),h()):d},t.paddingInner=function(u){return arguments.length?(d=Math.min(1,u),h()):d},t.paddingOuter=function(u){return arguments.length?(l=+u,h()):l},t.align=function(u){return arguments.length?(c=Math.max(0,Math.min(1,u)),h()):c},t.copy=function(){return Pa(e(),[r,i]).round(s).paddingInner(d).paddingOuter(l).align(c)},vi.apply(h(),arguments)}function pm(t){return function(){return t}}function mm(t){return+t}var Is=[0,1];function On(t){return t}function ua(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:pm(isNaN(e)?NaN:.5)}function vm(t,e){var n;return t>e&&(n=t,t=e,e=n),function(r){return Math.max(t,Math.min(e,r))}}function ym(t,e,n){var r=t[0],i=t[1],o=e[0],a=e[1];return i<r?(r=ua(i,r),o=n(a,o)):(r=ua(r,i),o=n(o,a)),function(s){return o(r(s))}}function _m(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),o=new Array(r),a=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<r;)i[a]=ua(t[a],t[a+1]),o[a]=n(e[a],e[a+1]);return function(s){var d=qf(t,s,1,r)-1;return o[d](i[d](s))}}function Ha(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Ac(){var t=Is,e=Is,n=kr,r,i,o,a=On,s,d,l;function c(){var u=Math.min(t.length,e.length);return a!==On&&(a=vm(t[0],t[u-1])),s=u>2?_m:ym,d=l=null,h}function h(u){return u==null||isNaN(u=+u)?o:(d||(d=s(t.map(r),e,n)))(r(a(u)))}return h.invert=function(u){return a(i((l||(l=s(e,t.map(r),nn)))(u)))},h.domain=function(u){return arguments.length?(t=Array.from(u,mm),c()):t.slice()},h.range=function(u){return arguments.length?(e=Array.from(u),c()):e.slice()},h.rangeRound=function(u){return e=Array.from(u),n=hc,c()},h.clamp=function(u){return arguments.length?(a=u?!0:On,c()):a!==On},h.interpolate=function(u){return arguments.length?(n=u,c()):n},h.unknown=function(u){return arguments.length?(o=u,h):o},function(u,g){return r=u,i=g,c()}}function Sc(){return Ac()(On,On)}function xm(t,e,n,r){var i=ta(t,e,n),o;switch(r=ui(r??",f"),r.type){case"s":{var a=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(o=Hp(i,a))&&(r.precision=o),zc(r,a)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(o=Op(i,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=o-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(o=Pp(i))&&(r.precision=o-(r.type==="%")*2);break}}return Ra(r)}function Ec(t){var e=t.domain;return t.ticks=function(n){var r=e();return Jo(r[0],r[r.length-1],n??10)},t.tickFormat=function(n,r){var i=e();return xm(i[0],i[i.length-1],n??10,r)},t.nice=function(n){n==null&&(n=10);var r=e(),i=0,o=r.length-1,a=r[i],s=r[o],d,l,c=10;for(s<a&&(l=a,a=s,s=l,l=i,i=o,o=l);c-- >0;){if(l=Qo(a,s,n),l===d)return r[i]=a,r[o]=s,e(r);if(l>0)a=Math.floor(a/l)*l,s=Math.ceil(s/l)*l;else if(l<0)a=Math.ceil(a*l)/l,s=Math.floor(s*l)/l;else break;d=l}return t},t}function fi(){var t=Sc();return t.copy=function(){return Ha(t,fi())},vi.apply(t,arguments),Ec(t)}function Nc(t,e){t=t.slice();var n=0,r=t.length-1,i=t[n],o=t[r],a;return o<i&&(a=n,n=r,r=a,a=i,i=o,o=a),t[n]=e.floor(i),t[r]=e.ceil(o),t}function Ls(t){return Math.log(t)}function Fs(t){return Math.exp(t)}function bm(t){return-Math.log(-t)}function wm(t){return-Math.exp(-t)}function Tm(t){return isFinite(t)?+("1e"+t):t<0?0:t}function Cm(t){return t===10?Tm:t===Math.E?Math.exp:e=>Math.pow(t,e)}function km(t){return t===Math.E?Math.log:t===10&&Math.log10||t===2&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}function Rs(t){return(e,n)=>-t(-e,n)}function $m(t){const e=t(Ls,Fs),n=e.domain;let r=10,i,o;function a(){return i=km(r),o=Cm(r),n()[0]<0?(i=Rs(i),o=Rs(o),t(bm,wm)):t(Ls,Fs),e}return e.base=function(s){return arguments.length?(r=+s,a()):r},e.domain=function(s){return arguments.length?(n(s),a()):n()},e.ticks=s=>{const d=n();let l=d[0],c=d[d.length-1];const h=c<l;h&&([l,c]=[c,l]);let u=i(l),g=i(c),p,v;const y=s==null?10:+s;let m=[];if(!(r%1)&&g-u<y){if(u=Math.floor(u),g=Math.ceil(g),l>0){for(;u<=g;++u)for(p=1;p<r;++p)if(v=u<0?p/o(-u):p*o(u),!(v<l)){if(v>c)break;m.push(v)}}else for(;u<=g;++u)for(p=r-1;p>=1;--p)if(v=u>0?p/o(-u):p*o(u),!(v<l)){if(v>c)break;m.push(v)}m.length*2<y&&(m=Jo(l,c,y))}else m=Jo(u,g,Math.min(g-u,y)).map(o);return h?m.reverse():m},e.tickFormat=(s,d)=>{if(s==null&&(s=10),d==null&&(d=r===10?"s":","),typeof d!="function"&&(!(r%1)&&(d=ui(d)).precision==null&&(d.trim=!0),d=Ra(d)),s===1/0)return d;const l=Math.max(1,r*s/e.ticks().length);return c=>{let h=c/o(Math.round(i(c)));return h*r<r-.5&&(h*=r),h<=l?d(c):""}},e.nice=()=>n(Nc(n(),{floor:s=>o(Math.floor(i(s))),ceil:s=>o(Math.ceil(i(s)))})),e}function Dc(){const t=$m(Ac()).domain([1,10]);return t.copy=()=>Ha(t,Dc()).base(t.base()),vi.apply(t,arguments),t}const Io=new Date,Lo=new Date;function he(t,e,n,r){function i(o){return t(o=arguments.length===0?new Date:new Date(+o)),o}return i.floor=o=>(t(o=new Date(+o)),o),i.ceil=o=>(t(o=new Date(o-1)),e(o,1),t(o),o),i.round=o=>{const a=i(o),s=i.ceil(o);return o-a<s-o?a:s},i.offset=(o,a)=>(e(o=new Date(+o),a==null?1:Math.floor(a)),o),i.range=(o,a,s)=>{const d=[];if(o=i.ceil(o),s=s==null?1:Math.floor(s),!(o<a)||!(s>0))return d;let l;do d.push(l=new Date(+o)),e(o,s),t(o);while(l<o&&o<a);return d},i.filter=o=>he(a=>{if(a>=a)for(;t(a),!o(a);)a.setTime(a-1)},(a,s)=>{if(a>=a)if(s<0)for(;++s<=0;)for(;e(a,-1),!o(a););else for(;--s>=0;)for(;e(a,1),!o(a););}),n&&(i.count=(o,a)=>(Io.setTime(+o),Lo.setTime(+a),t(Io),t(Lo),Math.floor(n(Io,Lo))),i.every=o=>(o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?i.filter(r?a=>r(a)%o===0:a=>i.count(0,a)%o===0):i)),i}const oo=he(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);oo.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?he(e=>{e.setTime(Math.floor(e/t)*t)},(e,n)=>{e.setTime(+e+n*t)},(e,n)=>(n-e)/t):oo);oo.range;const bn=1e3,Xe=bn*60,wn=Xe*60,An=wn*24,Oa=An*7,Ps=An*30,Fo=An*365,dr=he(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*bn)},(t,e)=>(e-t)/bn,t=>t.getUTCSeconds());dr.range;const Ua=he(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*bn)},(t,e)=>{t.setTime(+t+e*Xe)},(t,e)=>(e-t)/Xe,t=>t.getMinutes());Ua.range;const zm=he(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*Xe)},(t,e)=>(e-t)/Xe,t=>t.getUTCMinutes());zm.range;const Ba=he(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*bn-t.getMinutes()*Xe)},(t,e)=>{t.setTime(+t+e*wn)},(t,e)=>(e-t)/wn,t=>t.getHours());Ba.range;const Mm=he(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*wn)},(t,e)=>(e-t)/wn,t=>t.getUTCHours());Mm.range;const yi=he(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Xe)/An,t=>t.getDate()-1);yi.range;const qa=he(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/An,t=>t.getUTCDate()-1);qa.range;const Am=he(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/An,t=>Math.floor(t/An));Am.range;function or(t){return he(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,n)=>{e.setDate(e.getDate()+n*7)},(e,n)=>(n-e-(n.getTimezoneOffset()-e.getTimezoneOffset())*Xe)/Oa)}const Ao=or(0),ao=or(1),Sm=or(2),Em=or(3),Mr=or(4),Nm=or(5),Dm=or(6);Ao.range;ao.range;Sm.range;Em.range;Mr.range;Nm.range;Dm.range;function ar(t){return he(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCDate(e.getUTCDate()+n*7)},(e,n)=>(n-e)/Oa)}const Ic=ar(0),so=ar(1),Im=ar(2),Lm=ar(3),Ar=ar(4),Fm=ar(5),Rm=ar(6);Ic.range;so.range;Im.range;Lm.range;Ar.range;Fm.range;Rm.range;const Va=he(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12,t=>t.getMonth());Va.range;const Pm=he(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());Pm.range;const Sn=he(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());Sn.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:he(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,n)=>{e.setFullYear(e.getFullYear()+n*t)});Sn.range;const rr=he(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());rr.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:he(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCFullYear(e.getUTCFullYear()+n*t)});rr.range;function Hm(t,e,n,r,i,o){const a=[[dr,1,bn],[dr,5,5*bn],[dr,15,15*bn],[dr,30,30*bn],[o,1,Xe],[o,5,5*Xe],[o,15,15*Xe],[o,30,30*Xe],[i,1,wn],[i,3,3*wn],[i,6,6*wn],[i,12,12*wn],[r,1,An],[r,2,2*An],[n,1,Oa],[e,1,Ps],[e,3,3*Ps],[t,1,Fo]];function s(l,c,h){const u=c<l;u&&([l,c]=[c,l]);const g=h&&typeof h.range=="function"?h:d(l,c,h),p=g?g.range(l,+c+1):[];return u?p.reverse():p}function d(l,c,h){const u=Math.abs(c-l)/h,g=za(([,,y])=>y).right(a,u);if(g===a.length)return t.every(ta(l/Fo,c/Fo,h));if(g===0)return oo.every(Math.max(ta(l,c,h),1));const[p,v]=a[u/a[g-1][2]<a[g][2]/u?g-1:g];return p.every(v)}return[s,d]}const[Om,Um]=Hm(Sn,Va,Ao,yi,Ba,Ua);function Ro(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Po(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Yr(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function Bm(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,o=t.days,a=t.shortDays,s=t.months,d=t.shortMonths,l=Zr(i),c=Gr(i),h=Zr(o),u=Gr(o),g=Zr(a),p=Gr(a),v=Zr(s),y=Gr(s),m=Zr(d),C=Gr(d),z={a:D,A:G,b:et,B:V,c:null,d:Vs,e:Vs,f:fv,g:bv,G:Tv,H:lv,I:cv,j:uv,L:Lc,m:dv,M:hv,p:K,q:O,Q:Zs,s:Gs,S:gv,u:pv,U:mv,V:vv,w:yv,W:_v,x:null,X:null,y:xv,Y:wv,Z:Cv,"%":Ys},w={a:Y,A:q,b:nt,B:it,c:null,d:Ws,e:Ws,f:Mv,g:Pv,G:Ov,H:kv,I:$v,j:zv,L:Rc,m:Av,M:Sv,p:at,q:H,Q:Zs,s:Gs,S:Ev,u:Nv,U:Dv,V:Iv,w:Lv,W:Fv,x:null,X:null,y:Rv,Y:Hv,Z:Uv,"%":Ys},b={a:T,A:E,b:N,B:P,c:B,d:Bs,e:Bs,f:iv,g:Us,G:Os,H:qs,I:qs,j:tv,L:rv,m:Qm,M:ev,p:U,q:Jm,Q:av,s:sv,S:nv,u:Zm,U:Gm,V:Km,w:Ym,W:Xm,x:pt,X:$,y:Us,Y:Os,Z:jm,"%":ov};z.x=_(n,z),z.X=_(r,z),z.c=_(e,z),w.x=_(n,w),w.X=_(r,w),w.c=_(e,w);function _(S,W){return function(A){var x=[],L=-1,k=0,Z=S.length,X,dt,ot;for(A instanceof Date||(A=new Date(+A));++L<Z;)S.charCodeAt(L)===37&&(x.push(S.slice(k,L)),(dt=Hs[X=S.charAt(++L)])!=null?X=S.charAt(++L):dt=X==="e"?" ":"0",(ot=W[X])&&(X=ot(A,dt)),x.push(X),k=L+1);return x.push(S.slice(k,L)),x.join("")}}function M(S,W){return function(A){var x=Yr(1900,void 0,1),L=R(x,S,A+="",0),k,Z;if(L!=A.length)return null;if("Q"in x)return new Date(x.Q);if("s"in x)return new Date(x.s*1e3+("L"in x?x.L:0));if(W&&!("Z"in x)&&(x.Z=0),"p"in x&&(x.H=x.H%12+x.p*12),x.m===void 0&&(x.m="q"in x?x.q:0),"V"in x){if(x.V<1||x.V>53)return null;"w"in x||(x.w=1),"Z"in x?(k=Po(Yr(x.y,0,1)),Z=k.getUTCDay(),k=Z>4||Z===0?so.ceil(k):so(k),k=qa.offset(k,(x.V-1)*7),x.y=k.getUTCFullYear(),x.m=k.getUTCMonth(),x.d=k.getUTCDate()+(x.w+6)%7):(k=Ro(Yr(x.y,0,1)),Z=k.getDay(),k=Z>4||Z===0?ao.ceil(k):ao(k),k=yi.offset(k,(x.V-1)*7),x.y=k.getFullYear(),x.m=k.getMonth(),x.d=k.getDate()+(x.w+6)%7)}else("W"in x||"U"in x)&&("w"in x||(x.w="u"in x?x.u%7:"W"in x?1:0),Z="Z"in x?Po(Yr(x.y,0,1)).getUTCDay():Ro(Yr(x.y,0,1)).getDay(),x.m=0,x.d="W"in x?(x.w+6)%7+x.W*7-(Z+5)%7:x.w+x.U*7-(Z+6)%7);return"Z"in x?(x.H+=x.Z/100|0,x.M+=x.Z%100,Po(x)):Ro(x)}}function R(S,W,A,x){for(var L=0,k=W.length,Z=A.length,X,dt;L<k;){if(x>=Z)return-1;if(X=W.charCodeAt(L++),X===37){if(X=W.charAt(L++),dt=b[X in Hs?W.charAt(L++):X],!dt||(x=dt(S,A,x))<0)return-1}else if(X!=A.charCodeAt(x++))return-1}return x}function U(S,W,A){var x=l.exec(W.slice(A));return x?(S.p=c.get(x[0].toLowerCase()),A+x[0].length):-1}function T(S,W,A){var x=g.exec(W.slice(A));return x?(S.w=p.get(x[0].toLowerCase()),A+x[0].length):-1}function E(S,W,A){var x=h.exec(W.slice(A));return x?(S.w=u.get(x[0].toLowerCase()),A+x[0].length):-1}function N(S,W,A){var x=m.exec(W.slice(A));return x?(S.m=C.get(x[0].toLowerCase()),A+x[0].length):-1}function P(S,W,A){var x=v.exec(W.slice(A));return x?(S.m=y.get(x[0].toLowerCase()),A+x[0].length):-1}function B(S,W,A){return R(S,e,W,A)}function pt(S,W,A){return R(S,n,W,A)}function $(S,W,A){return R(S,r,W,A)}function D(S){return a[S.getDay()]}function G(S){return o[S.getDay()]}function et(S){return d[S.getMonth()]}function V(S){return s[S.getMonth()]}function K(S){return i[+(S.getHours()>=12)]}function O(S){return 1+~~(S.getMonth()/3)}function Y(S){return a[S.getUTCDay()]}function q(S){return o[S.getUTCDay()]}function nt(S){return d[S.getUTCMonth()]}function it(S){return s[S.getUTCMonth()]}function at(S){return i[+(S.getUTCHours()>=12)]}function H(S){return 1+~~(S.getUTCMonth()/3)}return{format:function(S){var W=_(S+="",z);return W.toString=function(){return S},W},parse:function(S){var W=M(S+="",!1);return W.toString=function(){return S},W},utcFormat:function(S){var W=_(S+="",w);return W.toString=function(){return S},W},utcParse:function(S){var W=M(S+="",!0);return W.toString=function(){return S},W}}}var Hs={"-":"",_:" ",0:"0"},ye=/^\s*\d+/,qm=/^%/,Vm=/[\\^$*+?|[\]().{}]/g;function Gt(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(e)+i:i)}function Wm(t){return t.replace(Vm,"\\$&")}function Zr(t){return new RegExp("^(?:"+t.map(Wm).join("|")+")","i")}function Gr(t){return new Map(t.map((e,n)=>[e.toLowerCase(),n]))}function Ym(t,e,n){var r=ye.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function Zm(t,e,n){var r=ye.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function Gm(t,e,n){var r=ye.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function Km(t,e,n){var r=ye.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function Xm(t,e,n){var r=ye.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function Os(t,e,n){var r=ye.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function Us(t,e,n){var r=ye.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function jm(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Jm(t,e,n){var r=ye.exec(e.slice(n,n+1));return r?(t.q=r[0]*3-3,n+r[0].length):-1}function Qm(t,e,n){var r=ye.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function Bs(t,e,n){var r=ye.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function tv(t,e,n){var r=ye.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function qs(t,e,n){var r=ye.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function ev(t,e,n){var r=ye.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function nv(t,e,n){var r=ye.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function rv(t,e,n){var r=ye.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function iv(t,e,n){var r=ye.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function ov(t,e,n){var r=qm.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function av(t,e,n){var r=ye.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function sv(t,e,n){var r=ye.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function Vs(t,e){return Gt(t.getDate(),e,2)}function lv(t,e){return Gt(t.getHours(),e,2)}function cv(t,e){return Gt(t.getHours()%12||12,e,2)}function uv(t,e){return Gt(1+yi.count(Sn(t),t),e,3)}function Lc(t,e){return Gt(t.getMilliseconds(),e,3)}function fv(t,e){return Lc(t,e)+"000"}function dv(t,e){return Gt(t.getMonth()+1,e,2)}function hv(t,e){return Gt(t.getMinutes(),e,2)}function gv(t,e){return Gt(t.getSeconds(),e,2)}function pv(t){var e=t.getDay();return e===0?7:e}function mv(t,e){return Gt(Ao.count(Sn(t)-1,t),e,2)}function Fc(t){var e=t.getDay();return e>=4||e===0?Mr(t):Mr.ceil(t)}function vv(t,e){return t=Fc(t),Gt(Mr.count(Sn(t),t)+(Sn(t).getDay()===4),e,2)}function yv(t){return t.getDay()}function _v(t,e){return Gt(ao.count(Sn(t)-1,t),e,2)}function xv(t,e){return Gt(t.getFullYear()%100,e,2)}function bv(t,e){return t=Fc(t),Gt(t.getFullYear()%100,e,2)}function wv(t,e){return Gt(t.getFullYear()%1e4,e,4)}function Tv(t,e){var n=t.getDay();return t=n>=4||n===0?Mr(t):Mr.ceil(t),Gt(t.getFullYear()%1e4,e,4)}function Cv(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Gt(e/60|0,"0",2)+Gt(e%60,"0",2)}function Ws(t,e){return Gt(t.getUTCDate(),e,2)}function kv(t,e){return Gt(t.getUTCHours(),e,2)}function $v(t,e){return Gt(t.getUTCHours()%12||12,e,2)}function zv(t,e){return Gt(1+qa.count(rr(t),t),e,3)}function Rc(t,e){return Gt(t.getUTCMilliseconds(),e,3)}function Mv(t,e){return Rc(t,e)+"000"}function Av(t,e){return Gt(t.getUTCMonth()+1,e,2)}function Sv(t,e){return Gt(t.getUTCMinutes(),e,2)}function Ev(t,e){return Gt(t.getUTCSeconds(),e,2)}function Nv(t){var e=t.getUTCDay();return e===0?7:e}function Dv(t,e){return Gt(Ic.count(rr(t)-1,t),e,2)}function Pc(t){var e=t.getUTCDay();return e>=4||e===0?Ar(t):Ar.ceil(t)}function Iv(t,e){return t=Pc(t),Gt(Ar.count(rr(t),t)+(rr(t).getUTCDay()===4),e,2)}function Lv(t){return t.getUTCDay()}function Fv(t,e){return Gt(so.count(rr(t)-1,t),e,2)}function Rv(t,e){return Gt(t.getUTCFullYear()%100,e,2)}function Pv(t,e){return t=Pc(t),Gt(t.getUTCFullYear()%100,e,2)}function Hv(t,e){return Gt(t.getUTCFullYear()%1e4,e,4)}function Ov(t,e){var n=t.getUTCDay();return t=n>=4||n===0?Ar(t):Ar.ceil(t),Gt(t.getUTCFullYear()%1e4,e,4)}function Uv(){return"+0000"}function Ys(){return"%"}function Zs(t){return+t}function Gs(t){return Math.floor(+t/1e3)}var ur,Un;Bv({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Bv(t){return ur=Bm(t),Un=ur.format,ur.parse,ur.utcFormat,ur.utcParse,ur}function qv(t){return new Date(t)}function Vv(t){return t instanceof Date?+t:+new Date(+t)}function Hc(t,e,n,r,i,o,a,s,d,l){var c=Sc(),h=c.invert,u=c.domain,g=l(".%L"),p=l(":%S"),v=l("%I:%M"),y=l("%I %p"),m=l("%a %d"),C=l("%b %d"),z=l("%B"),w=l("%Y");function b(_){return(d(_)<_?g:s(_)<_?p:a(_)<_?v:o(_)<_?y:r(_)<_?i(_)<_?m:C:n(_)<_?z:w)(_)}return c.invert=function(_){return new Date(h(_))},c.domain=function(_){return arguments.length?u(Array.from(_,Vv)):u().map(qv)},c.ticks=function(_){var M=u();return t(M[0],M[M.length-1],_??10)},c.tickFormat=function(_,M){return M==null?b:l(M)},c.nice=function(_){var M=u();return(!_||typeof _.range!="function")&&(_=e(M[0],M[M.length-1],_??10)),_?u(Nc(M,_)):c},c.copy=function(){return Ha(c,Hc(t,e,n,r,i,o,a,s,d,l))},c}function Oc(){return vi.apply(Hc(Om,Um,Sn,Va,Ao,yi,Ba,Ua,dr,Un).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Wv(){var t=0,e=1,n,r,i,o,a=On,s=!1,d;function l(h){return h==null||isNaN(h=+h)?d:a(i===0?.5:(h=(o(h)-n)*i,s?Math.max(0,Math.min(1,h)):h))}l.domain=function(h){return arguments.length?([t,e]=h,n=o(t=+t),r=o(e=+e),i=n===r?0:1/(r-n),l):[t,e]},l.clamp=function(h){return arguments.length?(s=!!h,l):s},l.interpolator=function(h){return arguments.length?(a=h,l):a};function c(h){return function(u){var g,p;return arguments.length?([g,p]=u,a=h(g,p),l):[a(0),a(1)]}}return l.range=c(kr),l.rangeRound=c(hc),l.unknown=function(h){return arguments.length?(d=h,l):d},function(h){return o=h,n=h(t),r=h(e),i=n===r?0:1/(r-n),l}}function Yv(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function fa(){var t=Ec(Wv()(On));return t.copy=function(){return Yv(t,fa())},gm.apply(t,arguments)}function So(t){for(var e=t.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+t.slice(r*6,++r*6);return n}const di=So("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),Zv=So("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),Uc=t=>ig(t[t.length-1]);var Gv=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(So);const Kv=Uc(Gv);var Xv=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(So);const jv=Uc(Xv);function oe(t){return function(){return t}}const Ks=Math.abs,we=Math.atan2,Gn=Math.cos,Jv=Math.max,Ho=Math.min,sn=Math.sin,hr=Math.sqrt,Ie=1e-12,hi=Math.PI,lo=hi/2,Pi=2*hi;function Qv(t){return t>1?0:t<-1?hi:Math.acos(t)}function Xs(t){return t>=1?lo:t<=-1?-lo:Math.asin(t)}function Bc(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(n==null)e=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);e=r}return t},()=>new Ap(e)}function t0(t){return t.innerRadius}function e0(t){return t.outerRadius}function n0(t){return t.startAngle}function r0(t){return t.endAngle}function i0(t){return t&&t.padAngle}function o0(t,e,n,r,i,o,a,s){var d=n-t,l=r-e,c=a-i,h=s-o,u=h*d-c*l;if(!(u*u<Ie))return u=(c*(e-o)-h*(t-i))/u,[t+u*d,e+u*l]}function Mi(t,e,n,r,i,o,a){var s=t-n,d=e-r,l=(a?o:-o)/hr(s*s+d*d),c=l*d,h=-l*s,u=t+c,g=e+h,p=n+c,v=r+h,y=(u+p)/2,m=(g+v)/2,C=p-u,z=v-g,w=C*C+z*z,b=i-o,_=u*v-p*g,M=(z<0?-1:1)*hr(Jv(0,b*b*w-_*_)),R=(_*z-C*M)/w,U=(-_*C-z*M)/w,T=(_*z+C*M)/w,E=(-_*C+z*M)/w,N=R-y,P=U-m,B=T-y,pt=E-m;return N*N+P*P>B*B+pt*pt&&(R=T,U=E),{cx:R,cy:U,x01:-c,y01:-h,x11:R*(i/b-1),y11:U*(i/b-1)}}function Oo(){var t=t0,e=e0,n=oe(0),r=null,i=n0,o=r0,a=i0,s=null,d=Bc(l);function l(){var c,h,u=+t.apply(this,arguments),g=+e.apply(this,arguments),p=i.apply(this,arguments)-lo,v=o.apply(this,arguments)-lo,y=Ks(v-p),m=v>p;if(s||(s=c=d()),g<u&&(h=g,g=u,u=h),!(g>Ie))s.moveTo(0,0);else if(y>Pi-Ie)s.moveTo(g*Gn(p),g*sn(p)),s.arc(0,0,g,p,v,!m),u>Ie&&(s.moveTo(u*Gn(v),u*sn(v)),s.arc(0,0,u,v,p,m));else{var C=p,z=v,w=p,b=v,_=y,M=y,R=a.apply(this,arguments)/2,U=R>Ie&&(r?+r.apply(this,arguments):hr(u*u+g*g)),T=Ho(Ks(g-u)/2,+n.apply(this,arguments)),E=T,N=T,P,B;if(U>Ie){var pt=Xs(U/u*sn(R)),$=Xs(U/g*sn(R));(_-=pt*2)>Ie?(pt*=m?1:-1,w+=pt,b-=pt):(_=0,w=b=(p+v)/2),(M-=$*2)>Ie?($*=m?1:-1,C+=$,z-=$):(M=0,C=z=(p+v)/2)}var D=g*Gn(C),G=g*sn(C),et=u*Gn(b),V=u*sn(b);if(T>Ie){var K=g*Gn(z),O=g*sn(z),Y=u*Gn(w),q=u*sn(w),nt;if(y<hi)if(nt=o0(D,G,Y,q,K,O,et,V)){var it=D-nt[0],at=G-nt[1],H=K-nt[0],S=O-nt[1],W=1/sn(Qv((it*H+at*S)/(hr(it*it+at*at)*hr(H*H+S*S)))/2),A=hr(nt[0]*nt[0]+nt[1]*nt[1]);E=Ho(T,(u-A)/(W-1)),N=Ho(T,(g-A)/(W+1))}else E=N=0}M>Ie?N>Ie?(P=Mi(Y,q,D,G,g,N,m),B=Mi(K,O,et,V,g,N,m),s.moveTo(P.cx+P.x01,P.cy+P.y01),N<T?s.arc(P.cx,P.cy,N,we(P.y01,P.x01),we(B.y01,B.x01),!m):(s.arc(P.cx,P.cy,N,we(P.y01,P.x01),we(P.y11,P.x11),!m),s.arc(0,0,g,we(P.cy+P.y11,P.cx+P.x11),we(B.cy+B.y11,B.cx+B.x11),!m),s.arc(B.cx,B.cy,N,we(B.y11,B.x11),we(B.y01,B.x01),!m))):(s.moveTo(D,G),s.arc(0,0,g,C,z,!m)):s.moveTo(D,G),!(u>Ie)||!(_>Ie)?s.lineTo(et,V):E>Ie?(P=Mi(et,V,K,O,u,-E,m),B=Mi(D,G,Y,q,u,-E,m),s.lineTo(P.cx+P.x01,P.cy+P.y01),E<T?s.arc(P.cx,P.cy,E,we(P.y01,P.x01),we(B.y01,B.x01),!m):(s.arc(P.cx,P.cy,E,we(P.y01,P.x01),we(P.y11,P.x11),!m),s.arc(0,0,u,we(P.cy+P.y11,P.cx+P.x11),we(B.cy+B.y11,B.cx+B.x11),m),s.arc(B.cx,B.cy,E,we(B.y11,B.x11),we(B.y01,B.x01),!m))):s.arc(0,0,u,b,w,m)}if(s.closePath(),c)return s=null,c+""||null}return l.centroid=function(){var c=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,h=(+i.apply(this,arguments)+ +o.apply(this,arguments))/2-hi/2;return[Gn(h)*c,sn(h)*c]},l.innerRadius=function(c){return arguments.length?(t=typeof c=="function"?c:oe(+c),l):t},l.outerRadius=function(c){return arguments.length?(e=typeof c=="function"?c:oe(+c),l):e},l.cornerRadius=function(c){return arguments.length?(n=typeof c=="function"?c:oe(+c),l):n},l.padRadius=function(c){return arguments.length?(r=c==null?null:typeof c=="function"?c:oe(+c),l):r},l.startAngle=function(c){return arguments.length?(i=typeof c=="function"?c:oe(+c),l):i},l.endAngle=function(c){return arguments.length?(o=typeof c=="function"?c:oe(+c),l):o},l.padAngle=function(c){return arguments.length?(a=typeof c=="function"?c:oe(+c),l):a},l.context=function(c){return arguments.length?(s=c??null,l):s},l}function Wa(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function qc(t){this._context=t}qc.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function a0(t){return new qc(t)}function s0(t){return t[0]}function l0(t){return t[1]}function js(t,e){var n=oe(!0),r=null,i=a0,o=null,a=Bc(s);t=typeof t=="function"?t:t===void 0?s0:oe(t),e=typeof e=="function"?e:e===void 0?l0:oe(e);function s(d){var l,c=(d=Wa(d)).length,h,u=!1,g;for(r==null&&(o=i(g=a())),l=0;l<=c;++l)!(l<c&&n(h=d[l],l,d))===u&&((u=!u)?o.lineStart():o.lineEnd()),u&&o.point(+t(h,l,d),+e(h,l,d));if(g)return o=null,g+""||null}return s.x=function(d){return arguments.length?(t=typeof d=="function"?d:oe(+d),s):t},s.y=function(d){return arguments.length?(e=typeof d=="function"?d:oe(+d),s):e},s.defined=function(d){return arguments.length?(n=typeof d=="function"?d:oe(!!d),s):n},s.curve=function(d){return arguments.length?(i=d,r!=null&&(o=i(r)),s):i},s.context=function(d){return arguments.length?(d==null?r=o=null:o=i(r=d),s):r},s}function c0(t,e){return e<t?-1:e>t?1:e>=t?0:NaN}function u0(t){return t}function f0(){var t=u0,e=c0,n=null,r=oe(0),i=oe(Pi),o=oe(0);function a(s){var d,l=(s=Wa(s)).length,c,h,u=0,g=new Array(l),p=new Array(l),v=+r.apply(this,arguments),y=Math.min(Pi,Math.max(-Pi,i.apply(this,arguments)-v)),m,C=Math.min(Math.abs(y)/l,o.apply(this,arguments)),z=C*(y<0?-1:1),w;for(d=0;d<l;++d)(w=p[g[d]=d]=+t(s[d],d,s))>0&&(u+=w);for(e!=null?g.sort(function(b,_){return e(p[b],p[_])}):n!=null&&g.sort(function(b,_){return n(s[b],s[_])}),d=0,h=u?(y-l*z)/u:0;d<l;++d,v=m)c=g[d],w=p[c],m=v+(w>0?w*h:0)+z,p[c]={data:s[c],index:d,value:w,startAngle:v,endAngle:m,padAngle:C};return p}return a.value=function(s){return arguments.length?(t=typeof s=="function"?s:oe(+s),a):t},a.sortValues=function(s){return arguments.length?(e=s,n=null,a):e},a.sort=function(s){return arguments.length?(n=s,e=null,a):n},a.startAngle=function(s){return arguments.length?(r=typeof s=="function"?s:oe(+s),a):r},a.endAngle=function(s){return arguments.length?(i=typeof s=="function"?s:oe(+s),a):i},a.padAngle=function(s){return arguments.length?(o=typeof s=="function"?s:oe(+s),a):o},a}function Js(t){return t<0?-1:1}function Qs(t,e,n){var r=t._x1-t._x0,i=e-t._x1,o=(t._y1-t._y0)/(r||i<0&&-0),a=(n-t._y1)/(i||r<0&&-0),s=(o*i+a*r)/(r+i);return(Js(o)+Js(a))*Math.min(Math.abs(o),Math.abs(a),.5*Math.abs(s))||0}function tl(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function Uo(t,e,n){var r=t._x0,i=t._y0,o=t._x1,a=t._y1,s=(o-r)/3;t._context.bezierCurveTo(r+s,i+s*e,o-s,a-s*n,o,a)}function co(t){this._context=t}co.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Uo(this,this._t0,tl(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,Uo(this,tl(this,n=Qs(this,t,e)),n);break;default:Uo(this,this._t0,n=Qs(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}};Object.create(co.prototype).point=function(t,e){co.prototype.point.call(this,e,t)};function el(t){return new co(t)}function nl(t,e){if((a=t.length)>1)for(var n=1,r,i,o=t[e[0]],a,s=o.length;n<a;++n)for(i=o,o=t[e[n]],r=0;r<s;++r)o[r][1]+=o[r][0]=isNaN(i[r][1])?i[r][0]:i[r][1]}function rl(t){for(var e=t.length,n=new Array(e);--e>=0;)n[e]=e;return n}function d0(t,e){return t[e]}function h0(t){const e=[];return e.key=t,e}function g0(){var t=oe([]),e=rl,n=nl,r=d0;function i(o){var a=Array.from(t.apply(this,arguments),h0),s,d=a.length,l=-1,c;for(const h of o)for(s=0,++l;s<d;++s)(a[s][l]=[0,+r(h,a[s].key,l,o)]).data=h;for(s=0,c=Wa(e(a));s<d;++s)a[c[s]].index=s;return n(a,c),a}return i.keys=function(o){return arguments.length?(t=typeof o=="function"?o:oe(Array.from(o)),i):t},i.value=function(o){return arguments.length?(r=typeof o=="function"?o:oe(+o),i):r},i.order=function(o){return arguments.length?(e=o==null?rl:typeof o=="function"?o:oe(Array.from(o)),i):e},i.offset=function(o){return arguments.length?(n=o??nl,i):n},i}function Qr(t,e,n){this.k=t,this.x=e,this.y=n}Qr.prototype={constructor:Qr,scale:function(t){return t===1?this:new Qr(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new Qr(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};Qr.prototype;function p0(t){const e=t-1;return e*e*e+1}function m0(t,{delay:e=0,duration:n=400,easing:r=p0,axis:i="y"}={}){const o=getComputedStyle(t),a=+o.opacity,s=i==="y"?"height":"width",d=parseFloat(o[s]),l=i==="y"?["top","bottom"]:["left","right"],c=l.map(m=>`${m[0].toUpperCase()}${m.slice(1)}`),h=parseFloat(o[`padding${c[0]}`]),u=parseFloat(o[`padding${c[1]}`]),g=parseFloat(o[`margin${c[0]}`]),p=parseFloat(o[`margin${c[1]}`]),v=parseFloat(o[`border${c[0]}Width`]),y=parseFloat(o[`border${c[1]}Width`]);return{delay:e,duration:n,easing:r,css:m=>`overflow: hidden;opacity: ${Math.min(m*20,1)*a};${s}: ${m*d}px;padding-${l[0]}: ${m*h}px;padding-${l[1]}: ${m*u}px;margin-${l[0]}: ${m*g}px;margin-${l[1]}: ${m*p}px;border-${l[0]}-width: ${m*v}px;border-${l[1]}-width: ${m*y}px;min-${s}: 0`}}var v0=xt('<button class="p-xs flex items-center justify-center rounded-full cursor-pointer bg-card border border-solid border-light info-button svelte-dipw5r" type="button"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-primary"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg> <span class="sr-only"> </span></button>'),y0=xt('<div class="absolute top-100 left-0 right-0 bg-card rounded p-md mt-xs border border-solid border-default shadow-lg z-popover description svelte-dipw5r" role="region"><p class="m-0 text-secondary text-sm"> </p></div>'),_0=xt('<div><div class="flex items-center gap-sm pb-sm bg-page relative z-above title-container"><h2 class="m-0 text-lg text-primary flex-1"><!></h2> <!></div> <!></div>');function x0(t,e){ke(e,!1);const[n,r]=tn(),i=()=>vt(f(d),"$hideInfoText",n),o=()=>vt(f(l),"$showInfoText",n),a=()=>vt(f(c),"$visualizationDescriptionText",n),s=()=>vt(f(h),"$descriptionText",n),d=_t(),l=_t(),c=_t(),h=_t();let u=Zt(e,"title",8,""),g=Zt(e,"description",8,""),p=Zt(e,"descriptionTranslationKey",8,""),v=Zt(e,"showDescription",12,!1),y=Zt(e,"descriptionId",8),m=Zt(e,"className",8,""),C=_t(),z=_t();function w(B){B.stopPropagation(),B.preventDefault(),v(!v())}function b(B){if(!v())return;const pt=B.target,$=f(C)&&!f(C).contains(pt),D=f(z)&&!f(z).contains(pt);$&&D&&v(!1)}We(()=>{document.addEventListener("click",b)}),Dn(()=>{document.removeEventListener("click",b)}),me(()=>tt,()=>{Ti(F(d,tt("ui.hide_info")),"$hideInfoText",n)}),me(()=>tt,()=>{Ti(F(l,tt("ui.show_info")),"$showInfoText",n)}),me(()=>tt,()=>{Ti(F(c,tt("ui.visualization_description")),"$visualizationDescriptionText",n)}),me(()=>(Le(p()),tt),()=>{Ti(F(h,p()?tt(p()):void 0),"$descriptionText",n)}),pi(),Me();var _=_0(),M=I(_),R=I(M),U=I(R);Ol(U,u);var T=yt(R,2);{var E=B=>{var pt=v0(),$=yt(I(pt),2),D=I($);qe(pt,G=>F(C,G),()=>f(C)),zt(()=>{ve(pt,"aria-expanded",v()),ve(pt,"aria-controls",y()),ut(D,v()?i():o())}),_e("click",pt,w),rt(B,pt)};Lt(T,B=>{(g()||p())&&B(E)})}var N=yt(M,2);{var P=B=>{var pt=y0(),$=I(pt),D=I($);qe(pt,G=>F(z,G),()=>f(z)),zt(()=>{ve(pt,"id",y()),ve(pt,"aria-label",a()),ut(D,p()?s():g())}),yf(3,pt,()=>m0,()=>({duration:150,easing:G=>G})),rt(B,pt)};Lt(N,B=>{v()&&(g()||p())&&B(P)})}zt(()=>yr(_,`mb-md relative visualization-header ${m()??""} svelte-dipw5r`)),rt(t,_),$e(),r()}function Eo(t={}){const{backgroundColor:e="rgba(0, 0, 0, 0.8)",color:n="white",padding:r="8px 12px",borderRadius:i="4px",fontSize:o="12px",zIndex:a="1000",boxShadow:s="0 2px 5px rgba(0,0,0,0.2)",defaultWidth:d=200,defaultHeight:l=100,offset:c=10}=t;let h=null;function u(){try{h&&document.body.contains(h)&&document.body.removeChild(h),h=document.createElement("div"),h.style.position="absolute",h.style.backgroundColor=e,h.style.color=n,h.style.padding=r,h.style.borderRadius=i,h.style.pointerEvents="none",h.style.display="none",h.style.fontSize=o,h.style.zIndex=a,h.style.boxShadow=s,t.maxWidth&&(h.style.maxWidth=t.maxWidth),t.whiteSpace&&(h.style.whiteSpace=t.whiteSpace),document&&document.body&&document.body.appendChild(h)}catch(m){console.error("Error creating tooltip:",m),h=null}}function g(m,C,z=d,w=l){try{if((!h||!document.body.contains(h))&&u(),!h)return;h.innerHTML=C;const b=p(m,z,w);h.style.left=`${b.left}px`,h.style.top=`${b.top}px`,h.style.display="block"}catch(b){console.error("Error showing tooltip:",b)}}function p(m,C=d,z=l){try{let w=m.pageX+c,b=m.pageY+c;return w+C>window.innerWidth&&(w=m.pageX-C-c),b+z>window.innerHeight&&(b=m.pageY-z-c),{left:w,top:b}}catch(w){return console.error("Error calculating tooltip position:",w),{left:window.innerWidth/2-C/2,top:window.innerHeight/2-z/2}}}function v(){try{h&&document.body.contains(h)&&(h.style.display="none")}catch(m){console.error("Error hiding tooltip:",m)}}function y(m){try{h&&document.body.contains(h)&&(h.innerHTML=m)}catch(C){console.error("Error updating tooltip content:",C)}}return We(()=>{u()}),Dn(()=>{h&&document.body.contains(h)&&document.body.removeChild(h)}),{showTooltip:g,hideTooltip:v,updateTooltipContent:y,calculatePosition:p,getTooltipElement:()=>h}}function Tn(t,e){const n=t?`<div class="font-bold mb-xs pb-xs border-b border-white border-opacity-30">
            ${t}
        </div>`:"",r=e.map(i=>`<span>${i.label}:</span><span class="text-right font-bold">${i.value}</span>`).join("");return`
        ${n}
        <div class="grid grid-cols-2 gap-xs">
            ${r}
        </div>
    `}var b0=xt('<div class="text-center text-secondary"> </div>'),w0=xt('<div class="text-center text-error" role="alert"> </div>'),T0=xt('<div class="text-center text-secondary"> </div>'),C0=xt('<div aria-live="polite"><!></div>'),k0=xt('<div role="region"><!> <div role="presentation"><!></div></div>');function Fr(t,e){ke(e,!1);const[n,r]=tn(),i=()=>vt(de,"$itemsStore",n),o=_t(),a=_t(),s=_t(),d=_t(),l=_t();let c=Zt(e,"title",8,""),h=Zt(e,"translationKey",8,""),u=Zt(e,"titleHtml",8,""),g=Zt(e,"description",8,""),p=Zt(e,"descriptionTranslationKey",8,""),v=Zt(e,"showDescription",12,!1),y=Zt(e,"ariaLabel",8,"");const m=`viz-desc-${Math.random().toString(36).slice(2,11)}`;let C=Zt(e,"enableResizeObserver",8,!0),z=_t(),w;const b=Wl();let _=Zt(e,"theme",8,"default"),M=Zt(e,"customBackground",8,""),R=Zt(e,"customTextColor",8,""),U=Zt(e,"minHeight",8,"400px"),T=Zt(e,"padding",8,"var(--spacing-md)"),E=Zt(e,"className",8,""),N=Zt(e,"modernStyle",8,!0),P=Zt(e,"enableTooltip",8,!0),B=Zt(e,"tooltipBackgroundColor",8,"rgba(0, 0, 0, 0.8)"),pt=Zt(e,"tooltipTextColor",8,"white"),$=Zt(e,"tooltipMaxWidth",8,"250px");const D=P()?Eo({backgroundColor:B(),color:pt(),maxWidth:$()}):null;function G(it,at,H,S){P()&&D&&D.showTooltip(it,at,H,S)}function et(){P()&&D&&D.hideTooltip()}function V(it){P()&&D&&D.updateTooltipContent(it)}We(()=>{C()&&f(z)&&(w=new ResizeObserver(it=>{const at=it[0];if(at){const{width:H,height:S}=at.contentRect;b("resize",{width:H,height:S})}}),w.observe(f(z)))}),Dn(()=>{w&&f(z)&&(w.unobserve(f(z)),w.disconnect())}),me(()=>(Le(U()),Le(T()),Le(M()),Le(R())),()=>{F(o,`
        min-height: ${U()};
        padding: ${T()};
        ${M()?`background: ${M()};`:""}
        ${R()?`color: ${R()};`:""}
    `)}),me(()=>(Le(u()),Le(h()),Le(c())),()=>{F(a,u()||(h()?lt(h()):c()))}),me(()=>(Le(p()),Le(g())),()=>{F(s,p()?lt(p()):g())}),me(()=>(Le(y()),f(a)),()=>{F(d,y()||f(a))}),me(()=>(Le(g()),Le(p())),()=>{F(l,!!(g()||p()))}),pi(),Me();var K=k0(),O=I(K);x0(O,{get title(){return f(a)},get description(){return g()},get descriptionTranslationKey(){return p()},descriptionId:m,className:"z-above",get showDescription(){return v()},set showDescription(it){v(it)},$$legacy:!0});var Y=yt(O,2),q=I(Y);Ul(q,e,"default",{},it=>{var at=C0(),H=I(at);{var S=A=>{var x=b0(),L=I(x);zt(k=>ut(L,k),[()=>lt("ui.loading")],ie),rt(A,x)},W=A=>{var x=ue(),L=te(x);{var k=X=>{var dt=w0(),ot=I(dt);zt(()=>ut(ot,i().error)),rt(X,dt)},Z=X=>{var dt=T0(),ot=I(dt);zt(J=>ut(ot,J),[()=>lt("ui.no_visualization_content")],ie),rt(X,dt)};Lt(L,X=>{i().error?X(k):X(Z,!1)},!0)}rt(A,x)};Lt(H,A=>{i().loading?A(S):A(W,!1)})}zt(()=>{yr(at,`empty-visualization ${(N()?"chart-skeleton":"")??""} svelte-1f9no0t`),ve(at,"style",f(o))}),rt(it,at)}),qe(Y,it=>F(z,it),()=>f(z)),zt(()=>{yr(K,`w-full flex flex-col relative visualization-wrapper ${_()??""} ${E()??""} svelte-1f9no0t`),ve(K,"aria-label",f(d)),ve(K,"aria-describedby",f(l)?m:void 0),yr(Y,`w-full flex-1 flex flex-col relative z-base visualization-content ${(N()?"chart-modern":"")??""}`)}),rt(t,K),bi(e,"showTooltip",G),bi(e,"hideTooltip",et),bi(e,"updateTooltipContent",V),bi(e,"createGridTooltipContent",Tn);var nt=$e({showTooltip:G,hideTooltip:et,updateTooltipContent:V,createGridTooltipContent:Tn});return r(),nt}const gr={news_article:{id:"news_article",nameEn:"News article",nameFr:"Article de presse",description:"Newspaper and magazine articles"},islamic_periodical:{id:"islamic_periodical",nameEn:"Islamic periodical",nameFr:"Périodique islamique",description:"Islamic magazines and periodicals"},documents:{id:"documents",nameEn:"Documents",nameFr:"Documents divers",description:"Various documents"},photographs:{id:"photographs",nameEn:"Photographs",nameFr:"Photographies",description:"Photographs and images"},video_recording:{id:"video_recording",nameEn:"Video recording",nameFr:"Enregistrement vidéo",description:"Video recordings and footage"},references:{id:"references",nameEn:"References",nameFr:"Références",description:"Reference materials"},other:{id:"other",nameEn:"Other",nameFr:"Autre",description:"Uncategorized items"}},$0={"24h au Bénin":"news_article","Agence Bénin Presse":"news_article",Banouto:"news_article","Bénin Intelligent":"news_article","Boulevard des Infos":"news_article","Daho-Express":"news_article",Ehuzu:"news_article",Fraternité:"news_article","L'Evénement Précis":"news_article","La Nation":"news_article","La Nouvelle Tribune":"news_article","Le Matinal":"news_article","Les Pharaons":"news_article","Matin Libre":"news_article","Burkina 24":"news_article","Carrefour africain":"news_article",FasoZine:"news_article","L'Evénement":"news_article","L'Observateur":"news_article","L'Observateur Paalga":"news_article","Le Pays":"news_article","LeFaso.net":"news_article",Mutations:"news_article","San Finna":"news_article",Sidwaya:"news_article","Agence Ivoirienne de Presse":"news_article","Fraternité Hebdo":"news_article","Fraternité Matin":"news_article","Ivoire Dimanche":"news_article","L'Alternative":"news_article","L'Intelligent d'Abidjan":"news_article","La Voie":"news_article","Le Jour":"news_article","Le Jour Plus":"news_article","Le Nouvel Horizon":"news_article","Le Patriote":"news_article","Notre Temps":"news_article","Notre Voie":"news_article","Le Sahel":"news_article","Agence Togolaise de Presse":"news_article","Atopani Express":"news_article","Courrier du Golfe":"news_article","Forum Hebdo":"news_article","La Lettre de Tchaoudjo":"news_article","La Nouvelle Marche":"news_article","Le Démocrate":"news_article","L'éveil du Peuple":"news_article","Togo-Presse":"news_article",ASSALAM:"islamic_periodical","Islam Hebdo":"islamic_periodical","Al Mawadda":"islamic_periodical","An-Nasr Trimestriel":"islamic_periodical","An-Nasr Vendredi":"islamic_periodical","L'Appel":"islamic_periodical","L'Autre Regard":"islamic_periodical","La Preuve":"islamic_periodical","Le CERFIste":"islamic_periodical","Le vrai visage de l'islam":"islamic_periodical","AJMCI Infos":"islamic_periodical","Al Minbar":"islamic_periodical","Al Muwassat Info":"islamic_periodical","Al-Azan":"islamic_periodical",Alif:"islamic_periodical","Allahou Akbar":"islamic_periodical","Bulletin d'information du CNI":"islamic_periodical","Islam Info":"islamic_periodical","Les Échos de l'AEEMCI":"islamic_periodical","Plume Libre":"islamic_periodical","Al Maoulid Info":"islamic_periodical","Al Maoulid Magazine":"islamic_periodical","Al Maoulid Magazine (arabe)":"islamic_periodical","Le Pacific":"islamic_periodical","Le Rendez-Vous":"islamic_periodical","Documents divers (Burkina Faso)":"documents","Documents divers (Bénin)":"documents","Documents divers (Côte d'Ivoire)":"documents","Documents divers (Niger)":"documents","Documents divers (Togo)":"documents","Photographies (Burkina Faso)":"photographs","Photographies (Bénin)":"photographs","Photographies (Côte d'Ivoire)":"photographs","Photographies (Niger)":"photographs","Photographies (Togo)":"photographs","Collection de sermons islamiques sur vidéo":"video_recording","Références (Bénin)":"references","Références (Burkina Faso)":"references","Références (Côte d'Ivoire)":"references","Références (Niger)":"references","Références (Nigéria)":"references","Références (Togo)":"references"};function il(t,e){const n=gr[t]||gr.other;return e==="fr"?n.nameFr:n.nameEn}function Rr(t){const{container:e,onResize:n,debounce:r=!0,debounceDelay:i=100}=t;let o=0,a=0,s=null,d=null;function l(){if(!e)return;const h=e.getBoundingClientRect(),u=Math.abs(o-h.width)>1,g=Math.abs(a-h.height)>1;if(!u&&!g)return;o=h.width;const p=window.getComputedStyle(e);p.height!=="auto"&&!p.height.includes("%")||(a=h.height),r?(d!==null&&window.clearTimeout(d),d=window.setTimeout(()=>{n()},i)):n()}e&&(l(),s=new ResizeObserver(()=>{l()}),s.observe(e));function c(){s&&(s.disconnect(),s=null),d!==null&&(window.clearTimeout(d),d=null)}return{width:o,height:a,dimensions:{width:o,height:a},updateDimensions:l,cleanup:c}}function Je(t={}){const{filterMissingValues:e=!0,requiredFields:n=[],filterFn:r,calculatePercentages:i=!0,sortByCount:o=!0,sortDescending:a=!0}=t;function s(h){if(!h||h.length===0)return[];let u=[...h];return r&&(u=u.filter(r)),e&&n.length>0&&(u=u.filter(g=>n.every(p=>g[p]!==void 0&&g[p]!==null&&g[p]!==""))),u}function d(h,u,g){const p=s(h),v=g||p.length,y=fs(p,C=>C.length,u),m=Array.from(y,([C,z])=>{const w={key:C,count:z,originalKey:C};return i&&(w.percentage=z/v*100),w});return o&&m.sort((C,z)=>a?z.count-C.count:C.count-z.count),m}function l(h,u,g){const p=s(h),v=g||p.length,y=Ma(p,...u);function m(C,z=0){return Array.from(C,([w,b])=>{const _={name:w,originalName:w,value:b instanceof _r?0:b.length,itemCount:b instanceof _r?0:b.length};return i&&(_.percentage=_.value/v*100),b instanceof _r&&(_.children=m(b,z+1),_.value=_.children.reduce((M,R)=>M+R.value,0),_.itemCount=_.value),_})}return{name:"root",children:m(y)}}function c(h,u,g={}){try{const p=s(h),{startDate:v,endDate:y,includeCumulative:m=!0,initialTotal:C=0}=g;console.log("[useDataProcessing] Processing time data for",p.length,"items"),console.log("[useDataProcessing] Date range:",{startDate:v,endDate:y}),C>0&&console.log("[useDataProcessing] Using initial total of",C);const z=p.filter(_=>{try{const M=_[u];if(!M)return!1;const R=new Date(M),U=!isNaN(R.getTime()),T=!v||R>=v,E=!y||R<=y;return U&&T&&E}catch{return console.warn("[useDataProcessing] Error parsing date for item:",_),!1}});if(console.log("[useDataProcessing] Valid items after date filtering:",z.length),z.length>0)console.log("[useDataProcessing] Sample dates:",z.slice(0,3).map(_=>_[u]));else return console.warn("[useDataProcessing] No valid items with dates in the specified range"),[];const w=fs(z,_=>_.length,_=>{try{const M=new Date(_[u]);return`${M.getFullYear()}-${String(M.getMonth()+1).padStart(2,"0")}`}catch(M){return console.error("[useDataProcessing] Error formatting date for grouping:",M),"unknown"}});w.has("unknown")&&(console.warn("[useDataProcessing] Removing unknown date entries"),w.delete("unknown"));const b=Array.from(w,([_,M])=>{try{const[R,U]=_.split("-"),T=new Date(parseInt(R),parseInt(U)-1);return{date:T,month:_,monthFormatted:T.toLocaleDateString(void 0,{month:"short",year:"numeric"}),count:M,total:0,percentage:M/z.length*100}}catch(R){return console.error("[useDataProcessing] Error parsing month data:",R),null}}).filter(_=>_!==null).sort((_,M)=>_.date.getTime()-M.date.getTime());if(b.length>1){const _=[],M=b[0].date,R=b[b.length-1].date;let U=new Date(M);for(;U<=R;){const T=U.getFullYear(),E=U.getMonth(),N=`${T}-${String(E+1).padStart(2,"0")}`,P=b.find(B=>B.month===N);P?_.push(P):_.push({date:new Date(T,E),month:N,monthFormatted:new Date(T,E).toLocaleDateString(void 0,{month:"short",year:"numeric"}),count:0,total:0,percentage:0}),U.setMonth(U.getMonth()+1)}_.length>b.length&&(console.log("[useDataProcessing] Filled in missing months:",_.length-b.length),b.length=0,b.push(..._))}if(m){let _=C;b.forEach(M=>{_+=M.count,M.total=_})}return console.log("[useDataProcessing] Processed timeline data:",b.length,"data points"),b}catch(p){return console.error("[useDataProcessing] Error processing time data:",p),[]}}return{filterItems:s,groupAndCount:d,groupHierarchically:l,processTimeData:c}}var z0=xt('<span class="breadcrumb-separator svelte-rlneyb"> </span>'),M0=xt('<!> <span tabindex="0" role="link"> </span>',1),A0=xt('<nav class="breadcrumb-navigation svelte-rlneyb"></nav>');function S0(t,e){ke(e,!1);let n=Zt(e,"items",24,()=>[]),r=Zt(e,"separator",8,"/"),i=Zt(e,"navItemClass",8,"");const o=Wl();function a(d){o("navigate",{id:d})}Me();var s=A0();Bn(s,5,n,vr,(d,l,c)=>{var h=M0(),u=te(h);{var g=y=>{var m=z0(),C=I(m);zt(()=>ut(C,r())),rt(y,m)};Lt(u,y=>{c>0&&y(g)})}var p=yt(u,2),v=I(p);zt(()=>{yr(p,`${`breadcrumb-item ${c===n().length-1?"breadcrumb-item--active":""} ${i()}`??""} svelte-rlneyb`),Bl(p,"active",c===n().length-1),ut(v,f(l).label)}),_e("click",p,()=>a(f(l).id)),_e("keypress",p,y=>y.key==="Enter"&&a(f(l).id)),rt(d,h)}),rt(t,s),$e()}const E0={primary:["#5B6EE8","#FF6B9D","#4ECDC4","#FFD93D","#95E1D3","#C7CEEA","#FFA502","#786FA6","#F8B500","#EE5A6F"],professional:["#2563eb","#dc2626","#059669","#d97706","#7c3aed","#0891b2","#be185d","#4b5563","#65a30d","#c2410c"],pastel:["#B5C7FF","#FFB5CC","#A8E6CF","#FFE5B5","#D4A5FF","#FFD3B6","#AADAFF","#E8BBE8","#B5FFD9","#FFC8DD"],monochrome:["#1e3a8a","#2563eb","#3b82f6","#60a5fa","#93bbfc","#bfdbfe","#dbeafe","#eff6ff"],earth:["#8B7355","#CD853F","#DEB887","#F4A460","#D2691E","#BC8F8F","#A0522D","#8B4513","#D2B48C","#FFE4B5"],contrast:["#1A202C","#E53E3E","#38A169","#3182CE","#D69E2E","#805AD5","#DD6B20","#38B2AC","#E53E3E","#718096"]};function qn(t="primary",e){const n=E0[t];if(!e||e>=n.length)return[...n];const r=n.length/e,i=[];for(let o=0;o<e;o++){const a=Math.floor(o*r);i.push(n[a])}return i}qn("primary");var N0=xt('<div class="loading absolute inset-center text-secondary svelte-1i7b4wq"> </div>'),D0=xt('<div class="error absolute inset-center text-error svelte-1i7b4wq"> </div>'),I0=xt('<div class="no-data absolute inset-center text-secondary svelte-1i7b4wq"> </div>'),L0=xt('<div class="loading absolute inset-center text-secondary svelte-1i7b4wq">Initializing visualization...</div>'),F0=xt('<div class="breadcrumb-wrapper absolute top-0 left-0 right-0 bg-white bg-opacity-90 p-xs z-10 shadow-sm glass-overlay svelte-1i7b4wq" style="height: 30px;"><div class="px-sm py-xs svelte-1i7b4wq"><!></div></div>'),R0=xt('<p class="text-sm text-secondary mb-xs svelte-1i7b4wq"> <strong class="font-medium svelte-1i7b4wq"> </strong></p>'),P0=xt('<p class="text-sm text-secondary mb-xs svelte-1i7b4wq"> <strong class="font-medium svelte-1i7b4wq"> </strong></p>'),H0=xt('<p class="text-sm text-secondary mb-xs svelte-1i7b4wq"> </p>'),O0=xt('<div class="chart-container relative flex-1 min-h-450 bg-card rounded p-md overflow-hidden chart-modern svelte-1i7b4wq"><!></div> <div class="stats bg-card shadow rounded p-md stats-modern svelte-1i7b4wq"><div class="stat-summary svelte-1i7b4wq"><h3 class="text-primary font-medium border-b pb-xs mb-sm svelte-1i7b4wq"> </h3> <p class="text-sm text-secondary mb-xs svelte-1i7b4wq"> <strong class="font-medium svelte-1i7b4wq"> </strong></p> <!> <p class="text-sm text-secondary mb-xs svelte-1i7b4wq"> <strong class="font-medium svelte-1i7b4wq"> </strong></p> <p class="text-sm text-secondary mb-xs svelte-1i7b4wq"> <strong class="font-medium svelte-1i7b4wq"> </strong></p> <!></div></div>',1),U0=xt('<div class="flex flex-col gap-sm w-full h-full country-distribution-container svelte-1i7b4wq"><!></div>');function B0(t,e){ke(e,!1);const[n,r]=tn(),i=()=>vt(de,"$itemsStore",n),o=()=>vt(Y,"$noSetText",n),a=()=>vt(G,"$noDataText",n),s=()=>vt(et,"$itemsText",n),d=()=>vt(at,"$categoriesText",n),l=()=>vt(K,"$percentTotalText",n),c=()=>vt(O,"$clickZoomInText",n),h=()=>vt(H,"$subCollectionsText",n),u=()=>vt(V,"$percentParentText",n),g=()=>vt(q,"$summaryText",n),p=()=>vt(nt,"$totalItemsText",n),v=()=>vt(it,"$countriesText",n),y=()=>vt(S,"$currentlyViewingText",n);let m=_t(),C={name:"root",children:[]},z=null,w="en",b=_t(""),_=_t(0),M=_t(0),R=_t(0),U=_t(0),T=[],E=null,N=_t(null),P=new Map,B=_t([{id:null,label:lt("viz.all_countries")}]),pt=new Map,$=new Map;const D=qn("primary"),G=tt("viz.no_data"),et=tt("viz.items"),V=tt("viz.percent_of_country"),K=tt("viz.percent_of_total"),O=tt("viz.click_zoom_in");tt("viz.back_to_all"),tt("viz.all_countries"),tt("viz.unknown");const Y=tt("viz.no_set"),q=tt("viz.summary"),nt=tt("viz.total_items"),it=tt("viz.countries"),at=tt("viz.categories"),H=tt("viz.sub_collections"),S=tt("viz.currently_viewing");tt("viz.click_back_to_return");let W=_t(),A,x=0,L=0,k;const{groupHierarchically:Z}=Je({filterMissingValues:!0,requiredFields:["country"],calculatePercentages:!0,sortByCount:!0,sortDescending:!0});function X($t){return $t.toLocaleString(w==="fr"?"fr-FR":"en-US")}function dt(){if(!(!f(ot)||f(J)))try{if(f(_)>0){const $t=X(f(_));F(b,lt("viz.distribution_items",{0:$t}))}else F(b,lt("viz.country_distribution_title"))}catch($t){console.error("Error updating title HTML:",$t),F(b,"Country Distribution")}}let ot=_t(!1),J=_t(!1),ft;function Ft(){f(ot)&&(ft=de.subscribe($t=>{f(ot)&&document.body.contains(f(m))&&(console.log("ItemsStore updated, handling change"),$t.items&&$t.items.length>0&&jt())}))}We(()=>(F(ot,!0),F(J,!1),console.log("CountryDistribution component mounted"),(async()=>{try{if(await zn(),f(J)||!f(ot)){console.log("Component unmounted after tick, aborting initialization");return}if(!f(m)){console.error("Container element not found in onMount");return}if(console.log("Container is ready, initializing visualization"),A=Rr({container:f(m),onResize:()=>{if(f(ot)&&f(m)&&document.body.contains(f(m))){const{width:$t,height:bt}=A.dimensions;x=$t,L=bt,console.log(`Resizing to ${x}x${L}`),x>0&&L>0&&jt()}},debounceDelay:50}),k=xe.subscribe($t=>{var bt;if(!(!f(ot)||!document.body.contains(f(m)))&&(console.log("Language changed to:",$t),w=$t,f(B)&&f(B).length>0&&qo(B,f(B)[0].label=lt("viz.all_countries")),dt(),i().items&&i().items.length>0)){const At=f(N),Mt=At==null?void 0:At.data.originalName;if(F(N,null),C=Kt(i().items),At&&Mt){const Ut=(bt=cn(C).children)==null?void 0:bt.find(Ht=>Ht.data.originalName===Mt);if(Ut){qt(Ut);return}}f(ot)&&f(m)&&document.body.contains(f(m))&&jt()}}),Ft(),i().items&&i().items.length>0){if(console.log("Processing initial data"),f(J)||!f(ot)){console.log("Component unmounted before processing data, aborting");return}if(C=Kt(i().items),C.children&&C.children.length>0){const At=Te().domain(C.children.map(Mt=>Mt.originalName||Mt.name)).range(D);C.children.forEach(Mt=>{const Pt=Mt.originalName||Mt.name;pt.has(Pt)||pt.set(Pt,At(Pt))})}const{width:$t,height:bt}=A.dimensions;if(x=$t,L=bt,P=new Map,await zn(),f(J)||!f(ot)){console.log("Component unmounted after second tick, aborting visualization");return}f(ot)&&f(m)&&document.body.contains(f(m))&&(console.log("Updating visualization after initialization"),jt())}else{if(f(J)||!f(ot)){console.log("Component unmounted before loading items, aborting");return}console.log("Loading items from store"),de.loadItems()}}catch($t){console.error("Error during initialization:",$t)}})(),()=>{try{console.log("CountryDistribution component unmounting"),F(ot,!1),F(J,!0),A&&A.cleanup(),k&&k(),ft&&ft(),f(m)&&ht(f(m)).selectAll("*").remove(),z=null,F(N,null),E=null,T=[],P.clear(),console.log("CountryDistribution cleanup complete")}catch($t){console.error("Error during cleanup:",$t)}}));function Kt($t){if(f(J))return console.log("Component unmounted during data processing, aborting"),{name:"root",children:[]};const bt=Z($t,[Mt=>Mt.country||"",Mt=>Mt.item_set_title||o()]),At={name:"root",children:bt.children.map(Mt=>{const Pt=lt(`country.${Mt.name}`)||Mt.name,Ut=new Map;Object.values(gr).forEach(Ct=>{Ut.set(Ct.id,{name:il(Ct.id,w),children:[],itemCount:0,originalName:Ct.id,categoryId:Ct.id,isCategory:!0})}),Mt.children&&Mt.children.forEach(Ct=>{const j=$0[Ct.name]||"other",st=Ut.get(j);st!=null&&st.children&&(st.children.push({name:Ct.name,value:Ct.value,itemCount:Ct.value,originalName:Ct.name,categoryId:j}),st.itemCount=(st.itemCount||0)+Ct.value)});const Ht=Array.from(Ut.values()).filter(Ct=>Ct.children&&Ct.children.length>0).sort((Ct,j)=>(j.itemCount||0)-(Ct.itemCount||0));return Ht.forEach(Ct=>{Ct.children&&Ct.children.sort((j,st)=>(st.itemCount||0)-(j.itemCount||0))}),{name:Pt,children:Ht,itemCount:Mt.value,originalName:Mt.name}})};return F(_,bt.children.reduce((Mt,Pt)=>Mt+Pt.value,0)),F(M,bt.children.length),F(U,Object.keys(gr).length),F(R,0),At.children&&At.children.forEach(Mt=>{Mt.children&&Mt.children.forEach(Pt=>{Pt.children&&F(R,f(R)+Pt.children.length)})}),dt(),At}function qt($t){var bt,At,Mt;if(F(N,$t),f(N)){f(N).data.isCategory;const Pt=f(N).data.isCategory;if(F(B,[{id:null,label:lt("viz.all_countries")}]),Pt){const Ut=f(N).parent;Ut&&(f(B).push({id:Ut.data.originalName||null,label:Ut.data.name}),console.log("Added country to breadcrumb:",Ut.data.name,"with ID:",Ut.data.originalName))}if(Pt&&f(N).data.categoryId){const Ut=f(N).data.categoryId,Ht=il(Ut,w);f(B).push({id:f(N).data.categoryId||null,label:Ht}),console.log("Added category to breadcrumb:",Ht,"with ID:",f(N).data.categoryId)}else f(B).push({id:f(N).data.originalName||null,label:f(N).data.name}),console.log("Added item to breadcrumb:",f(N).data.name,"with ID:",f(N).data.originalName);if(!f(N).children||f(N).children.length===0){console.warn("Cannot zoom to node without children");return}if(console.log("Zooming to node:",f(N).data.name,"Original name:",f(N).data.originalName,"Is category:",f(N).data.isCategory),F(_,f(N).data.itemCount||0),f(N).data.isCategory)f(N).data.isCategory&&(F(R,((At=f(N).children)==null?void 0:At.length)||0),F(U,1));else{const Ut=((bt=f(N).children)==null?void 0:bt.filter(Ht=>Ht.data.isCategory))||[];F(U,Ut.length),F(R,0),Ut.forEach(Ht=>{Ht.children&&F(R,f(R)+Ht.children.length)})}}else if(F(B,[{id:null,label:lt("viz.all_countries")}]),i().items&&i().items.length>0){C=Kt(i().items);const Pt=i().items.filter(Ht=>Ht.country&&Ht.country.trim()!=="");F(_,Pt.length);const Ut=Ma(Pt,Ht=>Ht.country);F(M,Ut.size),F(U,Object.keys(gr).length),F(R,0),(Mt=C.children)==null||Mt.forEach(Ht=>{var Ct;(Ct=Ht.children)==null||Ct.forEach(j=>{j.children&&F(R,f(R)+j.children.length)})})}dt(),jt()}function Xt($t){const{id:bt}=$t.detail;if(!f(ot)||f(J)||!document.body.contains(f(m))){console.log("Component not mounted, ignoring breadcrumb click");return}if(console.log("Breadcrumb navigation requested for ID:",bt),bt===null){console.log("Navigating to root view"),qt(null);return}if(P&&P.has(bt)){const At=P.get(bt);console.log("Found country node in map:",At==null?void 0:At.data.name),qt(At||null);return}if(z&&P)for(const At of P.values()){if(!At.children)continue;const Mt=At.children.find(Pt=>Pt.data.categoryId===bt||Pt.data.originalName===bt||Pt.data.name===bt);if(Mt){console.log("Found category node:",Mt.data.name,"in country:",At.data.name),qt(Mt);return}}console.log("Could not find a node matching ID:",bt)}function jt(){var $t,bt;try{if(!f(ot)||f(J)){console.log("Component unmounted, skipping visualization update");return}if(!f(m)){console.error("Container element not found");return}const At={top:30,right:10,bottom:10,left:10};if(f(N)||(C=Kt(i().items)),!C.children||C.children.length===0){ht(f(m)).select("svg").remove(),ht(f(m)).append("div").attr("class","no-data absolute inset-center text-secondary").text(a());return}ht(f(m)).select("svg").remove(),ht(f(m)).select(".no-data").remove();const Mt=f(m).getBoundingClientRect(),Pt=Mt.width-At.left-At.right,Ut=Mt.height-At.top-At.bottom,Ct=ht(f(m)).append("svg").attr("width","100%").attr("height","100%").attr("viewBox",`0 0 ${Mt.width} ${Mt.height}`).attr("preserveAspectRatio","xMidYMid meet").append("g").attr("transform",`translate(${At.left}, ${At.top})`),j=Mc().size([Pt,Ut]).paddingOuter(4).paddingTop(20).paddingInner(2).round(!0);let st;if(f(N)){const St={name:f(N).data.name,children:f(N).data.children,originalName:f(N).data.originalName,isCategory:f(N).data.isCategory,categoryId:f(N).data.categoryId};st=cn(St).sum(Jt=>Jt.value||0).sort((Jt,Wt)=>(Wt.value||0)-(Jt.value||0))}else st=cn(C).sum(St=>St.value||0).sort((St,Jt)=>(Jt.value||0)-(St.value||0)),P.clear(),st.children&&st.children.forEach(St=>{const Jt=St.data.originalName||St.data.name;P.set(Jt,St)});z=st;try{j(st)}catch(St){console.error("Error applying treemap layout:",St),F(N,null),C=Kt(i().items),st=cn(C).sum(Jt=>Jt.value||0).sort((Jt,Wt)=>(Wt.value||0)-(Jt.value||0)),z=st,j(st)}const mt=Te().domain(st.children?st.children.map(St=>St.data.originalName||St.data.name):[st.data.originalName||st.data.name]).range(di),gt=Te().domain(Object.keys(gr)).range(Zv),ct=!f(N),It=f(N)&&!f(N).data.isCategory,ae=f(N)&&f(N).data.isCategory;if(ct){const St=st.children||[];Ct.selectAll(".country").data(St).enter().append("g").attr("class","country").each(function(Wt){const Nt=ht(this),Tt=Wt.data.name,Et=Wt.data.originalName||Tt;let ne;pt.has(Et)?ne=pt.get(Et)||mt(Et):(ne=mt(Et),pt.set(Et,ne));const He=Wt.children||[],Ae=Nt.selectAll(".category").data(He).enter().append("g").attr("class","category").attr("transform",wt=>{const Dt=wt.x0||0,Yt=wt.y0||0;return`translate(${Dt},${Yt})`});Ae.append("rect").attr("width",wt=>{const Dt=wt.x0||0,Yt=wt.x1||0;return Math.max(0,Yt-Dt)}).attr("height",wt=>{const Dt=wt.y0||0,Yt=wt.y1||0;return Math.max(0,Yt-Dt)}).attr("fill",wt=>{const Dt=wt.data.categoryId||"other",Yt=Fe(ne),ge=`${Et}-${Dt}`;let ce;if($.has(ge))ce=$.get(ge)||Yt.toString();else{const Rt=Fe(gt(Dt));ce=Fe(Yt.r*.7+Rt.r*.3,Yt.g*.7+Rt.g*.3,Yt.b*.7+Rt.b*.3).toString(),$.set(ge,ce)}return ce}).attr("stroke","white").attr("stroke-width",1.5).attr("opacity",.8).attr("class","cursor-pointer").on("click",(wt,Dt)=>{qt(Wt)}).on("mouseover",function(wt,Dt){Q(wt,Dt)}).on("mousemove",function(wt,Dt){Q(wt,Dt)}).on("mouseout",function(){f(W).hideTooltip()}),Ae.append("text").attr("x",5).attr("y",15).attr("font-size","var(--font-size-xs)").attr("font-weight","bold").attr("fill","white").attr("class","pointer-events-none").text(wt=>wt.x1-wt.x0<100?wt.data.name:`${wt.data.name} (${wt.data.itemCount||0})`).each(function(wt){const Dt=ht(this),Yt=this.getComputedTextLength(),ge=wt.x1-wt.x0-10;if(Yt>ge){let ce=wt.data.name;Dt.text(ce);let Rt=this.getComputedTextLength(),Bt=!1;for(;Rt>ge&&ce.length>3;)ce=ce.slice(0,-1),Dt.text(ce),Rt=this.getComputedTextLength(),Bt=!0;Bt&&Dt.text(ce+"..."),Dt.append("title").text(`${Tt} > ${wt.data.name} (${wt.data.itemCount||0} ${s()})`)}});let Se=1/0,Oe=1/0,Ye=-1/0,Ze=-1/0;He.forEach(wt=>{const Dt=wt.x0||0,Yt=wt.y0||0,ge=wt.x1||0,ce=wt.y1||0;Se=Math.min(Se,Dt),Oe=Math.min(Oe,Yt),Ye=Math.max(Ye,ge),Ze=Math.max(Ze,ce)}),Nt.append("rect").attr("x",Se).attr("y",Oe-20).attr("width",Ye-Se).attr("height",20).attr("fill",ne).attr("opacity",.9).attr("class","cursor-pointer").on("click",wt=>{qt(Wt)}),Nt.append("text").attr("x",Se+5).attr("y",Oe-6).attr("font-size","var(--font-size-sm)").attr("font-weight","bold").attr("fill","white").attr("class","pointer-events-none").text(`${Tt} (${Wt.data.itemCount||0} ${s()})`)})}else if(It){const St=Ct.selectAll(".category").data(st.children||[]).enter().append("g").attr("class","category").attr("transform",Nt=>{const Tt=Nt.x0||0,Et=Nt.y0||0;return`translate(${Tt},${Et})`}),Jt=(($t=f(N))==null?void 0:$t.data.originalName)||((bt=f(N))==null?void 0:bt.data.name)||"",Wt=pt.get(Jt)||mt(Jt);St.append("rect").attr("width",Nt=>{const Tt=Nt.x0||0,Et=Nt.x1||0;return Math.max(0,Et-Tt)}).attr("height",Nt=>{const Tt=Nt.y0||0,Et=Nt.y1||0;return Math.max(0,Et-Tt)}).attr("fill",Nt=>{const Tt=Nt.data.categoryId||"other",Et=`${Jt}-${Tt}`;if($.has(Et))return $.get(Et)||Wt;{const ne=Fe(Wt),He=Fe(gt(Tt)),Se=Fe(ne.r*.7+He.r*.3,ne.g*.7+He.g*.3,ne.b*.7+He.b*.3).toString();return $.set(Et,Se),Se}}).attr("stroke","white").attr("stroke-width",1.5).attr("opacity",.8).attr("class","cursor-pointer").on("click",(Nt,Tt)=>{qt(Tt)}).on("mouseover",function(Nt,Tt){Q(Nt,Tt)}).on("mousemove",function(Nt,Tt){Q(Nt,Tt)}).on("mouseout",function(){f(W).hideTooltip()}),St.append("text").attr("x",5).attr("y",15).attr("font-size","var(--font-size-sm)").attr("font-weight","bold").attr("fill","white").attr("class","pointer-events-none").text(Nt=>`${Nt.data.name} (${Nt.data.itemCount||0} ${s()})`).each(function(Nt){const Tt=ht(this),Et=this.getComputedTextLength(),ne=Nt.x1-Nt.x0-10;Et>ne&&Tt.text(Nt.data.name).append("title").text(`${Nt.data.name} (${Nt.data.itemCount||0} ${s()})`)})}else if(ae&&f(N)){const St=Ct.selectAll(".subcollection").data(st.children||[]).enter().append("g").attr("class","subcollection").attr("transform",Tt=>{const Et=Tt.x0||0,ne=Tt.y0||0;return`translate(${Et},${ne})`}),Jt=f(N).data.categoryId||"other",Wt=f(N).parent;let Nt;if(Wt){const Et=`${Wt.data.originalName||Wt.data.name}-${Jt}`;Nt=$.get(Et)||gt(Jt)}else Nt=gt(Jt);St.append("rect").attr("width",Tt=>{const Et=Tt.x0||0,ne=Tt.x1||0;return Math.max(0,ne-Et)}).attr("height",Tt=>{const Et=Tt.y0||0,ne=Tt.y1||0;return Math.max(0,ne-Et)}).attr("fill",Tt=>{const Et=Fe(Nt);return Fe(Et).brighter(.5).toString()}).attr("stroke","white").attr("stroke-width",.5).attr("class","cursor-pointer").on("mouseover",function(Tt,Et){ht(this).attr("stroke","var(--color-primary)").attr("stroke-width",2),Q(Tt,Et)}).on("mousemove",function(Tt,Et){Q(Tt,Et)}).on("mouseout",function(){ht(this).attr("stroke","white").attr("stroke-width",.5),f(W).hideTooltip()}),St.append("text").attr("x",3).attr("y",13).attr("font-size","var(--font-size-xs)").attr("fill","var(--color-text-primary)").attr("class","pointer-events-none").each(function(Tt){const Et=ht(this),ne=Tt.x1-Tt.x0,He=Tt.y1-Tt.y0;if(ne<30||He<20)return;let Ae=Tt.data.name;const Se=ne-6,Oe=Wt?Wt.data.name:"",Ye=f(N)?f(N).data.name:"";let Ze="";Oe&&Ye?Ze=`${Oe} > ${Ye} > ${Tt.data.name}: ${Tt.data.itemCount||Tt.value||0} ${s()}`:Ye?Ze=`${Ye} > ${Tt.data.name}: ${Tt.data.itemCount||Tt.value||0} ${s()}`:Ze=`${Tt.data.name}: ${Tt.data.itemCount||Tt.value||0} ${s()}`,Et.text(Ae).append("title").text(Ze);const wt=this;let Dt=wt.getComputedTextLength(),Yt=!1;for(;Dt>Se&&Ae.length>3;)Ae=Ae.slice(0,-1),Et.text(Ae),Dt=wt.getComputedTextLength(),Yt=!0;Yt&&(Et.text(Ae+"..."),Et.append("title").text(Ze))})}}catch(At){console.error("Error in updateVisualization:",At)}}function Q($t,bt){var At,Mt;try{if(!f(W))return;const Pt=bt.parent===z,Ut=bt.data.isCategory===!0,Ht=!Pt&&!Ut;if(Pt){const Ct=bt.data.name,j=bt.data.itemCount||bt.value||0,st=((At=bt.children)==null?void 0:At.length)||0,mt=f(_)>0?(j/f(_)*100).toFixed(1)+"%":"N/A",gt=`
                    <div class="font-bold mb-xs pb-xs border-b border-white border-opacity-30">
                        ${Ct}
                    </div>
                    <div class="grid grid-cols-2 gap-xs">
                        <span>${s()}:</span>
                        <span class="text-right font-medium">${j}</span>
                        <span>${d()}:</span>
                        <span class="text-right">${st}</span>
                        <span>${l()}:</span>
                        <span class="text-right">${mt}</span>
                    </div>
                    <div class="mt-xs italic text-xs">
                        ${c()}
                    </div>
                `;f(W).showTooltip($t,gt,250,150)}else if(Ut){const Ct=bt.data.name,j=bt.data.itemCount||bt.value||0,st=((Mt=bt.children)==null?void 0:Mt.length)||0,mt=bt.parent,gt=mt?mt.data.name:"",ct=mt&&(mt.data.itemCount||mt.value)||0,It=ct>0?(j/ct*100).toFixed(1)+"%":"N/A",ae=f(_)>0?(j/f(_)*100).toFixed(1)+"%":"N/A",St=`
                    <div class="font-bold mb-xs pb-xs border-b border-white border-opacity-30">
                        ${gt} > ${Ct}
                    </div>
                    <div class="grid grid-cols-2 gap-xs">
                        <span>${s()}:</span>
                        <span class="text-right font-medium">${j}</span>
                        <span>${h()}:</span>
                        <span class="text-right">${st}</span>
                        <span>${u()}:</span>
                        <span class="text-right">${It}</span>
                        <span>${l()}:</span>
                        <span class="text-right">${ae}</span>
                    </div>
                    <div class="mt-xs italic text-xs">
                        ${c()}
                    </div>
                `;f(W).showTooltip($t,St,250,150)}else{const Ct=bt.data.name,j=bt.data.itemCount||bt.value||0,st=bt.parent,mt=st==null?void 0:st.parent,gt=st?st.data.name:"",ct=mt?mt.data.name:"",It=st&&(st.data.itemCount||st.value)||0,ae=mt&&(mt.data.itemCount||mt.value)||0,St=It>0?(j/It*100).toFixed(1)+"%":"N/A",Jt=ae>0?(j/ae*100).toFixed(1)+"%":"N/A",Wt=f(_)>0?(j/f(_)*100).toFixed(1)+"%":"N/A";let Nt=Ct;gt&&ct?Nt=`${ct} > ${gt} > ${Ct}`:gt?Nt=`${gt} > ${Ct}`:ct&&(Nt=`${ct} > ${Ct}`);const Tt=gt||null,Et=ct||null,ne=`
                    <div class="font-bold mb-xs pb-xs border-b border-white border-opacity-30">
                        ${Nt}
                    </div>
                    <div class="grid grid-cols-2 gap-xs">
                        <span>${s()}:</span>
                        <span class="text-right font-medium">${j}</span>
                        ${Tt?`<span>% of ${Tt}:</span>
                        <span class="text-right">${St}</span>`:""}
                        ${Et?`<span>${u()}:</span>
                        <span class="text-right">${Jt}</span>`:""}
                        <span>${l()}:</span>
                        <span class="text-right">${Wt}</span>
                    </div>
                `;f(W).showTooltip($t,ne,250,150)}}catch(Pt){console.error("Error showing tooltip:",Pt)}}Me();var kt=U0(),Vt=I(kt);qe(Fr(Vt,{get titleHtml(){return f(b)},descriptionTranslationKey:"viz.country_distribution_description",theme:"default",className:"country-distribution",children:($t,bt)=>{var At=O0(),Mt=te(At),Pt=I(Mt);{var Ut=wt=>{var Dt=N0(),Yt=I(Dt);zt(ge=>ut(Yt,ge),[()=>lt("ui.loading")],ie),rt(wt,Dt)},Ht=wt=>{var Dt=ue(),Yt=te(Dt);{var ge=Rt=>{var Bt=D0(),se=I(Bt);zt(()=>ut(se,i().error)),rt(Rt,Bt)},ce=Rt=>{var Bt=ue(),se=te(Bt);{var Ee=fe=>{var Ne=I0(),mn=I(Ne);zt(()=>ut(mn,a())),rt(fe,Ne)},pn=fe=>{var Ne=ue(),mn=te(Ne);{var Vn=be=>{var Ge=L0();rt(be,Ge)},In=be=>{var Ge=ue(),Wn=te(Ge);{var Pr=Ln=>{var en=F0(),Fn=I(en),Hr=I(Fn);{var sr=vn=>{S0(vn,{get items(){return f(B)},separator:"/",navItemClass:"text-sm hover:text-primary transition-colors cursor-pointer font-medium",activeItemClass:"text-primary font-bold",$$events:{navigate:Xt}})};Lt(Hr,vn=>{f(B)&&f(B).length&&vn(sr)})}rt(Ln,en)};Lt(Wn,Ln=>{f(ot)&&!f(J)&&Ln(Pr)},!0)}rt(be,Ge)};Lt(mn,be=>{f(m)?be(In,!1):be(Vn)},!0)}rt(fe,Ne)};Lt(se,fe=>{!i().items||i().items.length===0?fe(Ee):fe(pn,!1)},!0)}rt(Rt,Bt)};Lt(Yt,Rt=>{i().error?Rt(ge):Rt(ce,!1)},!0)}rt(wt,Dt)};Lt(Pt,wt=>{i().loading?wt(Ut):wt(Ht,!1)})}qe(Mt,wt=>F(m,wt),()=>f(m));var Ct=yt(Mt,2),j=I(Ct),st=I(j),mt=I(st),gt=yt(st,2),ct=I(gt),It=yt(ct),ae=I(It),St=yt(gt,2);{var Jt=wt=>{var Dt=R0(),Yt=I(Dt),ge=yt(Yt),ce=I(ge);zt(Rt=>{ut(Yt,`${v()??""}: `),ut(ce,Rt)},[()=>X(f(M))],ie),rt(wt,Dt)};Lt(St,wt=>{f(N)||wt(Jt)})}var Wt=yt(St,2),Nt=I(Wt),Tt=yt(Nt),Et=I(Tt),ne=yt(Wt,2),He=I(ne),Ae=yt(He),Se=I(Ae),Oe=yt(ne,2);{var Ye=wt=>{var Dt=P0(),Yt=I(Dt),ge=yt(Yt),ce=I(ge);zt(()=>{ut(Yt,`${y()??""}: `),ut(ce,f(N).data.name)}),rt(wt,Dt)},Ze=wt=>{var Dt=H0(),Yt=I(Dt);zt(()=>ut(Yt,c())),rt(wt,Dt)};Lt(Oe,wt=>{f(N)?wt(Ye):wt(Ze,!1)})}zt((wt,Dt,Yt)=>{ut(mt,g()),ut(ct,`${p()??""}: `),ut(ae,wt),ut(Nt,`${d()??""}: `),ut(Et,Dt),ut(He,`${h()??""}: `),ut(Se,Yt)},[()=>X(f(_)),()=>X(f(U)),()=>X(f(R))],ie),rt($t,At)},$$slots:{default:!0},$$legacy:!0}),$t=>F(W,$t),()=>f(W)),rt(t,kt),$e(),r()}function Vc(t){const{container:e,title:n,titleTranslationKey:r,items:i=[],type:o="html",orientation:a="vertical",position:s="right",customPosition:d,maxItems:l=10,showValues:c=!0,className:h="",valueFormatter:u=$=>$.toLocaleString(),translateKeys:g={itemPrefix:"",othersLabel:"viz.others",countLabel:"viz.items"},responsive:p=!0,breakpoint:v=768,interactive:y=!1,onItemClick:m=()=>{},customProperties:C}=t;let z=n,w=null,b=[...i],_=null;function M(){if(!(e instanceof HTMLElement))return console.error("Container must be an HTMLElement for HTML legend"),null;if(w instanceof HTMLElement)w.innerHTML="";else{w=document.createElement("div");const q=p&&window.innerWidth<v;w.className=`legend ${q?"legend-mobile":"legend-desktop"} ${h}`.trim(),s==="custom"&&d?(w.style.position="absolute",w.style.left=`${d.x}px`,w.style.top=`${d.y}px`):w.classList.add(`legend-${s}`),e.appendChild(w)}const $=p&&window.innerWidth<v;let D="";if(r){const q=tt(r);typeof q=="string"?D=q:q.subscribe(nt=>{D=nt})()}else z&&(D=z);let G=[...b],et=null;if(l>0&&G.length>l){const q=G.slice(0,l),nt=G.slice(l);et={key:"others",label:lt(g.othersLabel||"viz.others"),color:"#999999",value:nt.reduce((it,at)=>it+(at.value||0),0)},G=q}const V=D?`<div class="legend-heading${$?"-mobile":""}">${D}</div>`:"",K=$?"legend-grid-mobile":"legend-grid",O=G.map(q=>{let nt=q.label||q.key;if(g.itemPrefix){const W=`${g.itemPrefix}${q.key}`,A=lt(W);A!==W&&(nt=A)}const it=$?"legend-color-mobile":"legend-color",at=$?"legend-label-mobile":"legend-label",H=$?"legend-value-mobile":"legend-value",S=q.visible===!1?"opacity: 0.5; text-decoration: line-through;":"";return`
        <div class="${it}" data-color="${q.color}" style="${S}"></div>
        <div class="${at}" style="${S}">${nt}</div>
        ${c&&q.value!==void 0?`<div class="${H}" style="${S}">${u(q.value)}</div>`:""}
      `}).join(""),Y=et?`
      <div class="${$?"legend-color-mobile":"legend-color"}" data-color="${et.color}"></div>
      <div class="${$?"legend-label-mobile":"legend-label"}">${et.label}</div>
      ${c&&et.value!==void 0?`<div class="${$?"legend-value-mobile":"legend-value"}">${u(et.value)}</div>`:""}
    `:"";return w.innerHTML=`
      ${V}
      <div class="${K}">
        ${O}
        ${Y}
      </div>
    `,w.querySelectorAll("[data-color]").forEach(q=>{q.style.backgroundColor=q.dataset.color||""}),y&&w.querySelectorAll(`.${$?"legend-label-mobile":"legend-label"}`).forEach((nt,it)=>{it<G.length&&(nt.classList.add("cursor-pointer"),nt.addEventListener("click",()=>m(G[it],it)))}),w}function R(){let $;e instanceof HTMLElement?$=ht(e):$=e,$.selectAll(`.legend${h?`.${h}`:""}`).remove();let D=10,G=10;if(s==="custom"&&d)D=d.x,G=d.y;else if(s==="right"){const it=$.node();it&&(D=it.getBoundingClientRect().width-120)}else if(s==="bottom"){const it=$.node();it&&(G=it.getBoundingClientRect().height-50)}const et=$.append("g").attr("class",`legend legend-${a} ${h}`.trim()).attr("transform",`translate(${D}, ${G})`);if(z||r){let it="";if(r){const at=tt(r);typeof at=="string"?it=at:at.subscribe(H=>{it=H})()}else z&&(it=z);et.append("text").attr("class","legend-title").attr("x",0).attr("y",-10).attr("font-size","var(--font-size-xs)").attr("fill","var(--color-text-secondary)").text(it)}const V=a==="horizontal",K=20,O=20,Y=5,q=5,nt=l>0&&b.length>l?b.slice(0,l):b;if(nt.forEach((it,at)=>{const H=V?at*(K+Y*3+60):0,S=V?0:at*(O+Y);let W=it.label||it.key;if(g.itemPrefix){const L=`${g.itemPrefix}${it.key}`,k=lt(L);k!==L&&(W=k)}const A=et.append("g").attr("class","legend-item").attr("transform",`translate(${H}, ${S})`);A.append("rect").attr("width",K).attr("height",O).attr("fill",it.color).attr("stroke",it.visible===!1?"#999":"none").attr("stroke-width",it.visible===!1?1:0).attr("opacity",it.visible===!1?.5:1);const x=A.append("text").attr("x",K+q).attr("y",O/2).attr("dy","0.35em").attr("fill","var(--color-text-primary)").attr("font-size","var(--font-size-sm)").text(W);if(c&&it.value!==void 0){const L=V?K+q+T(x)+5:K+q,k=V?O/2:O/2+15;A.append("text").attr("x",L).attr("y",k).attr("dy","0.35em").attr("fill","var(--color-text-secondary)").attr("font-size","var(--font-size-xs)").text(u(it.value))}if(y&&(A.attr("class","legend-item cursor-pointer").attr("role","button").style("cursor","pointer").on("click",()=>m(it,at)),it.visible===!1)){const L=x.node();if(L){const k=L.getComputedTextLength();A.append("line").attr("x1",K+q).attr("y1",O/2).attr("x2",K+q+k).attr("y2",O/2).attr("stroke","var(--color-text-primary)").attr("stroke-width",1)}}}),l>0&&b.length>l){const at=b.slice(l).reduce((x,L)=>x+(L.value||0),0),H=V?nt.length*(K+Y*3+60):0,S=V?0:nt.length*(O+Y),W=et.append("g").attr("class","legend-item").attr("transform",`translate(${H}, ${S})`);W.append("rect").attr("width",K).attr("height",O).attr("fill","#999999");const A=lt(g.othersLabel||"viz.others");W.append("text").attr("x",K+q).attr("y",O/2).attr("dy","0.35em").attr("fill","var(--color-text-primary)").attr("font-size","var(--font-size-sm)").text(A),c&&W.append("text").attr("x",V?K+q+A.length*8+5:K+q).attr("y",V?O/2:O/2+15).attr("dy","0.35em").attr("fill","var(--color-text-secondary)").attr("font-size","var(--font-size-xs)").text(u(at))}return w=et,et}function U(){let $;e instanceof HTMLElement?$=ht(e):$=e,$.selectAll(`.legend${h?`.${h}`:""}`).remove();let D=10,G=10;if(s==="custom"&&d)D=d.x,G=d.y;else if(s==="right"){const Y=$.node();Y&&(D=Y.getBoundingClientRect().width-120)}const et=$.append("g").attr("class",`legend legend-${a} ${h}`.trim()).attr("transform",`translate(${D}, ${G})`);if(z||r){let Y="";if(r){const q=tt(r);typeof q=="string"?Y=q:q.subscribe(nt=>{Y=nt})()}else z&&(Y=z);et.append("text").attr("class","legend-title").attr("x",0).attr("y",-10).attr("font-size","var(--font-size-xs)").attr("fill","var(--color-text-secondary)").text(Y)}const V=20,K=20,O=5;return b.forEach((Y,q)=>{var H,S;const nt=q*K;let it=Y.label||Y.key;if(g.itemPrefix){const W=`${g.itemPrefix}${Y.key}`,A=lt(W);A!==W&&(it=A)}const at=et.append("g").attr("class","legend-item").attr("transform",`translate(0, ${nt})`);if(at.append("line").attr("x1",0).attr("y1",0).attr("x2",V).attr("y2",0).attr("stroke",Y.color).attr("stroke-width",2).attr("stroke-dasharray",((H=Y.customProperties)==null?void 0:H.dashArray)||"none"),(S=Y.customProperties)!=null&&S.marker&&at.append("circle").attr("cx",V).attr("cy",0).attr("r",3).attr("fill",Y.color),at.append("text").attr("x",V+O+5).attr("y",0).attr("dy","0.35em").attr("fill","var(--color-text-primary)").attr("font-size","var(--font-size-sm)").attr("class","legend-item-label").text(it),y&&(at.attr("class","legend-item cursor-pointer").attr("role","button").style("cursor","pointer").on("click",()=>m(Y,q)),Y.visible===!1)){const W=it.length*6;at.append("line").attr("x1",V+O+5).attr("y1",0).attr("x2",V+O+5+W).attr("y2",0).attr("stroke","var(--color-text-primary)").attr("stroke-width",1)}}),w=et,et}function T($){const D=$.node();return D?D.getComputedTextLength():0}function E(){var $;o==="html"?M():o==="svg"&&((($=t.customProperties)==null?void 0:$.lineChart)===!0?U():R()),p&&!_&&(_=()=>{const D=w instanceof HTMLElement&&w.classList.contains("legend-mobile"),G=window.innerWidth<v;D!==G&&E()},window.addEventListener("resize",_))}function N($,D){b=[...$],D!==void 0&&(z=D),E()}function P($,D){b=b.map(et=>et.key===$?{...et,visible:D}:et),E()}function B(){return w}function pt(){_&&(window.removeEventListener("resize",_),_=null),w instanceof HTMLElement&&w.parentNode&&w.parentNode.removeChild(w),e&&o==="svg"&&(e instanceof HTMLElement?ht(e).selectAll(`.legend${h?`.${h}`:""}`).remove():e.selectAll(`.legend${h?`.${h}`:""}`).remove()),w=null}return{render:E,update:N,updateVisibility:P,getLegendElement:B,cleanup:pt}}const q0={top:20,right:30,bottom:40,left:50};function V0(t){const{container:e,width:n=e.clientWidth,height:r=e.clientHeight,margin:i=q0,className:o="d3-visualization",responsive:a=!0}=t;ht(e).select("svg").remove();const s=ht(e).append("svg").attr("width",n).attr("height",r).attr("class",o);a&&s.attr("viewBox",`0 0 ${n} ${r}`).attr("preserveAspectRatio","xMidYMid meet");const d=s.append("g").attr("transform",`translate(${i.left}, ${i.top})`);return{svg:s,chart:d,width:n,height:r,margin:i,chartWidth:n-i.left-i.right,chartHeight:r-i.top-i.bottom}}function W0(t){const{type:e,domain:n,range:r,padding:i=.1,nice:o=!0}=t;let a;switch(e){case"linear":a=fi().domain(n).range(r);break;case"log":a=Dc().domain(n).range(r);break;case"time":a=Oc().domain(n).range(r);break;case"ordinal":a=Te().domain(n).range(r);break;case"band":a=Pa().domain(n).range(r).padding(i);break;default:throw new Error(`Unsupported scale type: ${e}`)}return o&&["linear","time","log"].includes(e)&&a.nice(),a}function Y0(t){const{type:e,scale:n,position:r=e==="x"?"bottom":"left",ticks:i,tickFormat:o,tickSize:a,tickPadding:s,rotate:d}=t;let l;if(r==="bottom")l=Gi(n);else if(r==="top")l=id(n);else if(r==="left")l=Ki(n);else if(r==="right")l=od(n);else throw new Error(`Unsupported axis position: ${r}`);return i!==void 0&&l.ticks(i),o!==void 0&&l.tickFormat(o),a!==void 0&&l.tickSize(a),s!==void 0&&l.tickPadding(s),{axis:l,rotate:d}}function Z0(t,e){const{axis:n,rotate:r}=e;t.call(n),r&&t.selectAll("text").style("text-anchor",r<0?"end":r>0?"start":"middle").attr("dx",r<0?"-0.8em":r>0?"0.8em":"0").attr("dy",r!==0?"0.15em":"0.71em").attr("transform",`rotate(${r})`)}function G0(t,e="categorical"){if(e==="categorical")return Te().domain(t).range(di);if(e==="sequential")return fa(jv).domain([0,t.length-1]);if(e==="diverging")return fa(Kv).domain([0,t.length-1]);throw new Error(`Unsupported color range type: ${e}`)}function K0(t,e,n="chart-title"){t.append("text").attr("class",n).attr("x",t.attr("width")?parseInt(t.attr("width"))/2:0).attr("y",20).attr("text-anchor","middle").text(e)}function X0(t,e,n={}){const{position:r={x:10,y:10},orientation:i="horizontal",itemWidth:o=20,itemHeight:a=20,itemMargin:s=5,className:d="legend",width:l=300}=n,c=t.append("g").attr("class",d).attr("transform",`translate(${r.x}, ${r.y})`),h=i==="horizontal"?"legend-horizontal":"legend-vertical";c.classed(h,!0);const u=i==="horizontal",g=c.append("g").attr("class","legend-items");if(d.includes("multi-row-legend")){const y=Math.floor(((l||300)-r.x-20)/(o+s*4)),m=Math.max(3,y);e.forEach((C,z)=>{const w=Math.floor(z/m),_=z%m*(o+s*4),M=w*(a+s*2),R=g.append("g").attr("class","legend-item").attr("transform",`translate(${_}, ${M})`);R.append("rect").attr("class","legend-item-swatch").attr("width",o).attr("height",a).attr("fill",C.color),R.append("text").attr("class","legend-item-label").attr("x",o+s).attr("y",a/2).attr("dy","0.35em").text(C.key)})}else e.forEach((v,y)=>{const m=u?y*(o+s*3):0,C=u?0:y*(a+s),z=g.append("g").attr("class","legend-item").attr("transform",`translate(${m}, ${C})`);z.append("rect").attr("class","legend-item-swatch").attr("width",o).attr("height",a).attr("fill",v.color),z.append("text").attr("class","legend-item-label").attr("x",o+s).attr("y",a/2).attr("dy","0.35em").text(v.key)});return c}function ol(t,e){return"ticks"in t&&typeof t.ticks=="function"?t.ticks(e):"domain"in t&&typeof t.domain=="function"?t.domain():[]}function j0(t,e){const{width:n,height:r,xScale:i,yScale:o,xTicks:a=10,yTicks:s=10,className:d="grid"}=e,l=t.append("g").attr("class",d);if(i){const c=ol(i,a);l.append("g").attr("class","grid-x").selectAll("line").data(c).enter().append("line").attr("x1",h=>i(h)).attr("x2",h=>i(h)).attr("y1",0).attr("y2",r).attr("stroke","#e0e0e0").attr("stroke-dasharray","3,3")}if(o){const c=ol(o,s);l.append("g").attr("class","grid-y").selectAll("line").data(c).enter().append("line").attr("x1",0).attr("x2",n).attr("y1",h=>o(h)).attr("y2",h=>o(h)).attr("stroke","#e0e0e0").attr("stroke-dasharray","3,3")}return l}function J0(t=500,e=Cc){return wc().duration(t).ease(e)}function Q0(t){const e=parseInt(t.attr("width")),n=parseInt(t.attr("height"));t.attr("viewBox",`0 0 ${e} ${n}`).attr("preserveAspectRatio","xMidYMid meet").attr("width","100%").attr("height","100%")}function ty(t,e="No data available",n="absolute inset-center text-secondary z-50"){ht(t).select("svg").remove(),ht(t).selectAll(`.${n.split(" ")[0]}`).remove(),ht(t).append("div").attr("class",n).text(e)}function ey(t="visualization-tooltip",e={}){return ht(`.${t}`).remove(),ht("body").append("div").attr("class",t).style("position","absolute").style("pointer-events","none").style("opacity",0).style("background",e.background||"rgba(0, 0, 0, 0.8)").style("color",e.color||"white").style("padding",e.padding||"8px 12px").style("border-radius",e.borderRadius||"4px").style("font-size",e.fontSize||"12px").style("z-index",e.zIndex||"1000").style("box-shadow",e.boxShadow||"0 2px 5px rgba(0,0,0,0.2)")}const pe={createSVG:V0,createScale:W0,createAxis:Y0,renderAxis:Z0,createColorScale:G0,addTitle:K0,createLegend:X0,addGrid:j0,createTransition:J0,makeResponsive:Q0,handleNoData:ty,createTooltipContainer:ey},ny={margin:{top:20,right:20,bottom:20,left:20},innerRadius:0,responsive:!0,colorScheme:qn("primary"),animationDuration:500,hoverEffectEnabled:!0,hoverRadiusIncrease:10,showLegend:!0,legendPosition:"right",showLabels:!1,labelMinAngle:15,sortValues:!1,sortDescending:!0};function ry(t,e){const n={...ny,...e},{container:r,width:i=r.clientWidth,height:o=r.clientHeight,margin:a={top:20,right:20,bottom:20,left:20},innerRadius:s=0,responsive:d=!0,animationDuration:l=500,hoverEffectEnabled:c=!0,hoverRadiusIncrease:h=10,showLabels:u=!1,labelMinAngle:g=15,sortValues:p=!1,sortDescending:v=!0}=n;ht(r).select("svg").remove();let y=[...t];p&&y.sort(($,D)=>v?D.value-$.value:$.value-D.value);const{svg:m,chartWidth:C,chartHeight:z}=pe.createSVG({container:r,width:i,height:o,margin:a,responsive:d}),b=Math.min(C,z)/2*.9,_=f0().value($=>$.value);p||_.sort(null);const M=Oo().innerRadius(s*b).outerRadius(b),R=Oo().innerRadius(s*b).outerRadius(b+h),U=Oo().innerRadius(b*.7).outerRadius(b*.7);let T;if(typeof n.colorScheme=="function")T=n.colorScheme;else{const $=Te().domain(y.map(D=>D.key)).range(n.colorScheme||di);T=D=>$(D)}const E=m.append("g").attr("transform",`translate(${i/2}, ${o/2})`),N=_(y),P=E.selectAll("path").data(N).enter().append("path").attr("class","pie-segment pie-slice-modern cursor-pointer").attr("d",M).attr("fill",$=>T($.data.key)).attr("stroke","var(--color-bg-card)").attr("stroke-width",2);if(c&&P.on("mouseenter",function($,D){ht(this).transition().duration(200).attr("d",R),n.onMouseEnter&&n.onMouseEnter($,D)}).on("mousemove",function($,D){n.onMouseMove&&n.onMouseMove($,D)}).on("mouseleave",function($,D){ht(this).transition().duration(200).attr("d",M),n.onMouseLeave&&n.onMouseLeave($,D)}),u&&E.selectAll("text").data(N).enter().append("text").attr("transform",$=>($.endAngle-$.startAngle)*(180/Math.PI)>=g?`translate(${U.centroid($)})`:"").attr("dy","0.35em").attr("text-anchor","middle").text($=>$.data.key).style("font-size","12px").style("fill","var(--color-text-primary, #333)").style("opacity",$=>($.endAngle-$.startAngle)*(180/Math.PI)>=g?1:0),n.showLegend){y.map(at=>({key:at.key,color:T(at.key),value:at.value,percentage:at.percentage}));const $=i<768,D=$?{width:C,height:100}:{width:180,height:z};$?E.attr("transform",`translate(${i/2}, ${(o-D.height)/2})`):n.legendPosition==="right"&&E.attr("transform",`translate(${(i-D.width)/2}, ${o/2})`);const G=$?a.left:i-D.width,et=$?o-D.height:a.top+20,V=m.append("g").attr("class","legend legend-modern").attr("transform",`translate(${G}, ${et})`);n.legendTitle&&V.append("text").attr("class","legend-title").attr("x",0).attr("y",$?0:-5).attr("font-size","14px").attr("font-weight","bold").attr("fill","var(--color-text-primary, #333)").text(n.legendTitle);const K=15,O=$?20:25,Y=5,q=$?6:12;let nt=$?Math.floor(C/120):1;if(nt=Math.max(1,nt),y.slice(0,q).forEach((at,H)=>{var Z;const S=Math.floor(H/nt),W=H%nt,A=$?W*(C/nt):0,x=($?20:0)+S*O,L=V.append("g").attr("class","legend-item").attr("transform",`translate(${A}, ${x})`);L.append("rect").attr("width",K).attr("height",K).attr("fill",T(at.key)).attr("stroke","var(--color-border, #e2e8f0)").attr("stroke-width",.5).attr("rx",2);const k=at.label||at.key;if(L.append("text").attr("x",K+Y).attr("y",K/2).attr("dy","0.35em").attr("fill","var(--color-text-primary, #333)").attr("font-size","12px").attr("font-family","var(--font-family-base, sans-serif)").text(k),at.value!==void 0){const X=$?at.value.toLocaleString():`${at.value.toLocaleString()} (${(Z=at.percentage)==null?void 0:Z.toFixed(1)}%)`;$?L.append("text").attr("x",K+Y+k.length*7+10).attr("y",K/2).attr("dy","0.35em").attr("text-anchor","start").attr("fill","var(--color-text-secondary, #666)").attr("font-size","11px").attr("font-family","var(--font-family-base, sans-serif)").text(`(${at.value.toLocaleString()})`):L.append("text").attr("x",K+Y).attr("y",K/2+14).attr("fill","var(--color-text-secondary, #666)").attr("font-size","11px").attr("font-family","var(--font-family-base, sans-serif)").text(X)}}),y.length>q){const at=y.length-q,H=Math.floor(q/nt),S=q%nt,W=$?S*(C/nt):0,A=($?20:0)+H*O;V.append("text").attr("x",W+($?0:K+Y)).attr("y",A+($?0:K/2)).attr("fill","var(--color-text-secondary, #666)").attr("font-size","11px").attr("font-style","italic").attr("font-family","var(--font-family-base, sans-serif)").text(`+${at} more...`)}}return{svg:m,pieGroup:E,update:$=>{let D=[...$];if(p&&D.sort((V,K)=>v?K.value-V.value:V.value-K.value),typeof n.colorScheme!="function"){const V=Te().domain(D.map(K=>K.key)).range(n.colorScheme||di);T=K=>V(K)}const G=_(D),et=E.selectAll("path").data(G);if(et.exit().transition().duration(l).attrTween("d",function(V){const K=V,O=K.endAngle,Y={...K,startAngle:O,endAngle:O},q=kr(K,Y);return function(nt){return M(q(nt))}}).remove(),et.enter().append("path").attr("class","pie-segment pie-slice-modern cursor-pointer").attr("fill",V=>T(V.data.key)).attr("stroke","var(--color-bg-card)").attr("stroke-width",2).attr("d",M).style("opacity",0).transition().duration(l).style("opacity",1),et.transition().duration(l).attrTween("d",function(V){const O=this.__data__,Y=kr(O,V);return function(q){return M(Y(q))}}).attr("fill",V=>T(V.data.key)),c&&E.selectAll("path").on("mouseenter",function(V,K){ht(this).transition().duration(200).attr("d",R),n.onMouseEnter&&n.onMouseEnter(V,K)}).on("mousemove",function(V,K){n.onMouseMove&&n.onMouseMove(V,K)}).on("mouseleave",function(V,K){ht(this).transition().duration(200).attr("d",M),n.onMouseLeave&&n.onMouseLeave(V,K)}),u){const V=E.selectAll("text").data(G);V.exit().remove(),V.enter().append("text").attr("dy","0.35em").attr("text-anchor","middle").style("font-size","12px").style("fill","var(--color-text-primary, #333)").merge(V).transition().duration(l).attr("transform",K=>(K.endAngle-K.startAngle)*(180/Math.PI)>=g?`translate(${U.centroid(K)})`:"").text(K=>K.data.key).style("opacity",K=>(K.endAngle-K.startAngle)*(180/Math.PI)>=g?1:0)}if(n.showLegend){m.select(".legend").remove();const V=i<768,K=V?{width:C,height:100}:{width:180,height:z};V?E.attr("transform",`translate(${i/2}, ${(o-K.height)/2})`):n.legendPosition==="right"&&E.attr("transform",`translate(${(i-K.width)/2}, ${o/2})`);const O=V?a.left:i-K.width,Y=V?o-K.height:a.top+20,q=m.append("g").attr("class","legend").attr("transform",`translate(${O}, ${Y})`);n.legendTitle&&q.append("text").attr("class","legend-title").attr("x",0).attr("y",V?0:-5).attr("font-size","14px").attr("font-weight","bold").attr("fill","var(--color-text-primary, #333)").text(n.legendTitle);const nt=15,it=V?20:25,at=5,H=V?6:12;let S=V?Math.floor(C/120):1;if(S=Math.max(1,S),D.slice(0,H).forEach((A,x)=>{var J;const L=Math.floor(x/S),k=x%S,Z=V?k*(C/S):0,X=(V?20:0)+L*it,dt=q.append("g").attr("class","legend-item").attr("transform",`translate(${Z}, ${X})`);dt.append("rect").attr("width",nt).attr("height",nt).attr("fill",T(A.key)).attr("stroke","var(--color-border, #e2e8f0)").attr("stroke-width",.5).attr("rx",2);const ot=A.label||A.key;if(dt.append("text").attr("x",nt+at).attr("y",nt/2).attr("dy","0.35em").attr("fill","var(--color-text-primary, #333)").attr("font-size","12px").attr("font-family","var(--font-family-base, sans-serif)").text(ot),A.value!==void 0){const ft=V?A.value.toLocaleString():`${A.value.toLocaleString()} (${(J=A.percentage)==null?void 0:J.toFixed(1)}%)`;V?dt.append("text").attr("x",nt+at+ot.length*7+10).attr("y",nt/2).attr("dy","0.35em").attr("text-anchor","start").attr("fill","var(--color-text-secondary, #666)").attr("font-size","11px").attr("font-family","var(--font-family-base, sans-serif)").text(`(${A.value.toLocaleString()})`):dt.append("text").attr("x",nt+at).attr("y",nt/2+14).attr("fill","var(--color-text-secondary, #666)").attr("font-size","11px").attr("font-family","var(--font-family-base, sans-serif)").text(ft)}}),D.length>H){const A=D.length-H,x=Math.floor(H/S),L=H%S,k=V?L*(C/S):0,Z=(V?20:0)+x*it;q.append("text").attr("x",k+(V?0:nt+at)).attr("y",Z+(V?0:nt/2)).attr("fill","var(--color-text-secondary, #666)").attr("font-size","11px").attr("font-style","italic").attr("font-family","var(--font-family-base, sans-serif)").text(`+${A} more...`)}}},destroy:()=>{r&&ht(r).select("svg").remove()}}}function iy(t,e){return ry(t,{...e,innerRadius:e.innerRadius===void 0?.5:e.innerRadius})}var oy=xt("<option> </option>"),ay=xt("<option> </option>"),sy=xt("<span> </span>"),ly=xt('<div class="absolute inset-center text-secondary"> </div>'),cy=xt('<div class="absolute inset-center text-error"> </div>'),uy=xt('<div class="flex flex-wrap gap-md p-md bg-card rounded-t border-b border-solid border-default filters glass-overlay svelte-1sh5f3k"><div class="flex flex-col gap-xs filter-group svelte-1sh5f3k"><label for="country-filter" class="text-xs font-bold text-secondary"> </label> <select id="country-filter" class="p-xs px-sm rounded-sm border border-solid border-default bg-card text-primary svelte-1sh5f3k"></select></div> <div class="flex flex-col gap-xs filter-group svelte-1sh5f3k"><label for="type-filter" class="text-xs font-bold text-secondary"> </label> <select id="type-filter" class="p-xs px-sm rounded-sm border border-solid border-default bg-card text-primary svelte-1sh5f3k"></select></div> <div class="flex flex-col gap-xs filter-group svelte-1sh5f3k"><label for="chart-type" class="text-xs font-bold text-secondary"> </label> <div class="flex items-center"><button class="p-xs px-sm rounded-sm border border-solid border-default bg-card text-primary hover:bg-hover svelte-1sh5f3k"> </button></div></div> <div class="ml-auto flex items-end text-sm text-secondary summary svelte-1sh5f3k"><!></div></div> <div class="chart-container chart-modern svelte-1sh5f3k"><!></div>',1),fy=xt('<div class="w-full h-full flex flex-col language-visualization-container"><!></div>');function dy(t,e){ke(e,!1);const[n,r]=tn(),i=()=>vt(de,"$itemsStore",n),o=()=>vt(K,"$toggleLanguagesText",n),a=()=>vt(xe,"$languageStore",n),s=()=>vt(et,"$filterByCountryText",n),d=()=>vt(V,"$filterByTypeText",n);let l=_t("all"),c=_t("all"),h=_t(!0),u=_t([]),g=_t([]),p=_t([]),v=_t(0),y="en",m=_t(""),C=[],z=0,w=0,b=_t(),_=null,M=_t(),R;const{groupAndCount:U}=Je({filterMissingValues:!0,requiredFields:["language"],filterFn:k=>!(f(l)!=="all"&&k.country!==f(l)||f(c)!=="all"&&k.type!==f(c)),calculatePercentages:!0,sortByCount:!0,sortDescending:!0}),T=Je({filterMissingValues:!0,requiredFields:["language","country"],filterFn:k=>f(c)==="all"||k.type===f(c)}),E=Je({filterMissingValues:!0,requiredFields:["language","type"],filterFn:k=>f(l)==="all"||k.country===f(l)});let N,P,B=_t(!1);const pt=qn("primary"),$=Te(pt);let D=new Map;function G(k){if(D.has(k))return D.get(k);const Z=$(k);return D.set(k,Z),Z}tt("viz.all_countries"),tt("viz.all_types");const et=tt("viz.filter_by_country"),V=tt("viz.filter_by_type");tt("viz.no_data");const K=tt("viz.toggle_languages");tt("viz.showing_items",{0:O(f(v)),1:O(f(u).length)}),tt("viz.items"),tt("viz.percent_of_total");function O(k){return k.toLocaleString(y==="fr"?"fr-FR":"en-US")}function Y(k){const Z=O(k);return lt("viz.language_distribution_items",{0:Z})}function q(){f(v)>0?F(m,Y(f(v))):F(m,lt("viz.language_distribution_title"))}We(()=>(F(B,!0),(async()=>{try{if(await zn(),!f(b)){console.error("Container element not found in onMount");return}if(R=Rr({container:f(b),onResize:()=>{if(f(B)&&f(b)){const{width:k,height:Z}=R.dimensions;z=k,w=Z,H()}}}),N=xe.subscribe(k=>{f(B)&&(y=k,f(b)&&(q(),i().items&&i().items.length>0&&H()))}),i().items&&i().items.length>0){const{width:k,height:Z}=R.dimensions;z=k,w=Z,await zn(),f(b)&&H()}else de.loadItems()}catch(k){console.error("Error during initialization:",k)}})(),()=>{try{F(B,!1),R&&R.cleanup(),N&&N(),P&&(P.cleanup(),P=null),_&&(_.destroy(),_=null),f(b)&&ht(f(b)).selectAll("*").remove()}catch(k){console.error("Error during cleanup:",k)}})),Dn(()=>{try{F(B,!1),R&&R.cleanup(),N&&N(),P&&(P.cleanup(),P=null),f(b)&&ht(f(b)).selectAll("*").remove()}catch(k){console.error("Error during cleanup:",k)}});function nt(){if(!i().items||i().items.length===0)return;const Z=U(i().items,X=>X.language||"Unknown").map(X=>({language:X.key,count:X.count,percentage:X.percentage||0}));return Z.forEach(X=>{D.has(X.language)||D.set(X.language,$(X.language))}),F(v,Z.reduce((X,dt)=>X+dt.count,0)),q(),Z}function it(){if(!i().items||i().items.length===0)return;const k=lt("viz.all_countries"),Z=lt("viz.all_types"),X=T.filterItems(i().items),dt=E.filterItems(i().items),ot=T.groupAndCount(X,ft=>ft.country||"Unknown");F(g,[{value:"all",label:k,count:X.length},...ot.filter(ft=>ft.key!=="Unknown").map(ft=>{const Ft=lt(`country.${ft.key}`)||ft.key;return{value:ft.key,label:Ft,count:ft.count}}).sort((ft,Ft)=>Ft.count-ft.count)]);const J=E.groupAndCount(dt,ft=>ft.type||"Unknown");F(p,[{value:"all",label:Z,count:dt.length},...J.map(ft=>({value:ft.key,label:ft.key,count:ft.count})).sort((ft,Ft)=>Ft.count-ft.count)])}function at(k,Z){var J;if(!f(M))return;const X=Z.data,dt=lt(`lang.${X.key}`)||X.key,ot=Tn(dt,[{label:lt("viz.items"),value:O(X.value)},{label:lt("viz.percent_of_total"),value:`${((J=X.percentage)==null?void 0:J.toFixed(2))||0}%`}]);f(M).showTooltip(k,ot)}function H(){if(!f(b))return;const k=nt();if(F(u,k||[]),!k||k.length===0){_&&(_.destroy(),_=null),P&&(P.cleanup(),P=null),pe.handleNoData(f(b),lt("viz.no_data"));return}if(C.length===0)C=k.map(J=>({language:J.language,visible:!0}));else{const J=C.map(ft=>ft.language);k.forEach(ft=>{J.includes(ft.language)||C.push({language:ft.language,visible:!0})})}const Z=k.filter(J=>{const ft=C.find(Ft=>Ft.language===J.language);return(ft==null?void 0:ft.visible)??!0}).map(J=>({key:J.language,label:lt(`lang.${J.language}`)||J.language,value:J.count,percentage:J.percentage}));if(Z.length===0){_&&(_.destroy(),_=null),P&&(P.cleanup(),P=null),pe.handleNoData(f(b),lt("viz.no_data"));return}_&&(_.destroy(),_=null),P&&(P.cleanup(),P=null);const X=f(b).getBoundingClientRect();z=X.width,w=X.height;const dt=z<768,ot=dt?{top:10,right:10,bottom:50,left:10}:{top:20,right:20,bottom:20,left:20};if(_=iy(Z,{container:f(b),width:z,height:w,margin:ot,innerRadius:f(h)?.5:0,responsive:!0,colorScheme:J=>G(J),hoverEffectEnabled:!0,hoverRadiusIncrease:dt?8:12,showLegend:!1,showLabels:!1,sortValues:!0,sortDescending:!0,onMouseEnter:at,onMouseMove:at,onMouseLeave:()=>f(M).hideTooltip()}),_){const J=k.map(qt=>{var jt;const Xt=((jt=C.find(Q=>Q.language===qt.language))==null?void 0:jt.visible)??!0;return{key:qt.language,label:lt(`lang.${qt.language}`)||qt.language,color:G(qt.language),value:qt.count,visible:Xt,customProperties:{language:qt.language}}});P=Vc({container:f(b),title:o(),items:J,type:"html",position:"bottom",orientation:"horizontal",className:"multi-row-legend",showValues:!0,valueFormatter:qt=>O(qt),translateKeys:{itemPrefix:"lang."},responsive:!0,breakpoint:768,interactive:!0,onItemClick:qt=>{const Xt=C.findIndex(jt=>{var Q;return jt.language===((Q=qt.customProperties)==null?void 0:Q.language)});Xt>=0&&(C[Xt].visible=!C[Xt].visible,C=[...C],H())}}),P.render();const Ft=Math.ceil(k.length/5)*22+30,Kt=ht(f(b)).select("svg");Kt.empty()||Kt.attr("height",w+Ft+30)}}function S(k){const Z=k.target;F(l,Z.value),it(),H()}function W(k){const Z=k.target;F(c,Z.value),it(),H()}function A(){F(h,!f(h)),H()}me(()=>{},()=>{q()}),me(()=>(f(B),i(),f(b)),()=>{f(B)&&i().items&&f(b)&&H()}),me(()=>(a(),f(l),f(c),i()),()=>{(a()||f(l)||f(c))&&i().items&&i().items.length>0&&it()}),pi(),Me();var x=fy(),L=I(x);qe(Fr(L,{get titleHtml(){return f(m)},descriptionTranslationKey:"viz.language_distribution_description",theme:"default",className:"language-visualization",children:(k,Z)=>{var X=uy(),dt=te(X),ot=I(dt),J=I(ot),ft=I(J),Ft=yt(J,2);zt(()=>{f(l),Qa(()=>{f(g)})}),Bn(Ft,5,()=>f(g),mt=>mt.value,(mt,gt)=>{var ct=oy(),It={},ae=I(ct);zt(St=>{It!==(It=f(gt).value)&&(ct.value=(ct.__value=f(gt).value)==null?"":f(gt).value),ut(ae,`${f(gt).label??""} (${St??""})`)},[()=>O(f(gt).count)],ie),rt(mt,ct)});var Kt=yt(ot,2),qt=I(Kt),Xt=I(qt),jt=yt(qt,2);zt(()=>{f(c),Qa(()=>{f(p)})}),Bn(jt,5,()=>f(p),mt=>mt.value,(mt,gt)=>{var ct=ay(),It={},ae=I(ct);zt(St=>{It!==(It=f(gt).value)&&(ct.value=(ct.__value=f(gt).value)==null?"":f(gt).value),ut(ae,`${f(gt).label??""} (${St??""})`)},[()=>O(f(gt).count)],ie),rt(mt,ct)});var Q=yt(Kt,2),kt=I(Q),Vt=I(kt),$t=yt(kt,2),bt=I($t),At=I(bt),Mt=yt(Q,2),Pt=I(Mt);{var Ut=mt=>{var gt=sy(),ct=I(gt);zt(It=>ut(ct,It),[()=>lt("viz.showing_items",{0:O(f(v)),1:f(u).length.toString()})],ie),rt(mt,gt)};Lt(Pt,mt=>{f(u).length>0&&mt(Ut)})}var Ht=yt(dt,2),Ct=I(Ht);{var j=mt=>{var gt=ly(),ct=I(gt);zt(It=>ut(ct,It),[()=>lt("ui.loading")],ie),rt(mt,gt)},st=mt=>{var gt=ue(),ct=te(gt);{var It=ae=>{var St=cy(),Jt=I(St);zt(()=>ut(Jt,i().error)),rt(ae,St)};Lt(ct,ae=>{i().error&&ae(It)},!0)}rt(mt,gt)};Lt(Ct,mt=>{i().loading?mt(j):mt(st,!1)})}qe(Ht,mt=>F(b,mt),()=>f(b)),zt((mt,gt)=>{ut(ft,`${s()??""}:`),ut(Xt,`${d()??""}:`),ut(Vt,`${mt??""}:`),ut(At,gt)},[()=>lt("viz.chart_type"),()=>f(h)?lt("viz.pie_chart"):lt("viz.donut_chart")],ie),_e("change",Ft,S),as(Ft,()=>f(l),mt=>F(l,mt)),_e("change",jt,W),as(jt,()=>f(c),mt=>F(c,mt)),_e("click",bt,A),rt(k,X)},$$slots:{default:!0},$$legacy:!0}),k=>F(M,k),()=>f(M)),rt(t,x),$e(),r()}function hy(t){const{container:e,width:n=e.clientWidth,height:r=e.clientHeight,data:i,keyField:o="key",valueField:a="value",className:s="bar-chart",barPadding:d=.2,barCornerRadius:l=3,barStroke:c="white",barStrokeWidth:h=1,margin:u={top:20,right:30,bottom:60,left:50},responsive:g=!0,isMobile:p=!1,showXAxis:v=!0,showYAxis:y=!0,xAxisLabel:m,yAxisLabel:C,xAxisRotation:z=-45,xAxisTickFormat:w,yAxisTickFormat:b,xAxisTicks:_,yAxisTicks:M=5,showValueLabels:R=!0,valueLabelMinHeight:U=15,valueFormatter:T=H=>H.toString(),enableInteraction:E=!0,highlightColor:N,onBarMouseEnter:P,onBarMouseMove:B,onBarMouseLeave:pt,onBarClick:$}=t;let D;if(t.barColors)Array.isArray(t.barColors)?D=Te().domain(i.map(H=>H[t.keyField||"key"])).range(t.barColors):D=t.barColors;else{const H=qn("primary",i.length);D=Te().domain(i.map(S=>S[t.keyField||"key"])).range(H)}const G=Tr(i,H=>H[a])||0,{svg:et,chart:V,chartWidth:K,chartHeight:O}=pe.createSVG({container:e,width:n,height:r,margin:u,className:s,responsive:g}),Y=pe.createScale({type:"band",domain:i.map(H=>H[o]),range:[0,K],padding:p?Math.min(d,.1):d}),q=pe.createScale({type:"linear",domain:[0,G*1.1],range:[O,0]});if(v){const H=pe.createAxis({type:"x",scale:Y,position:"bottom",tickFormat:w,ticks:_,rotate:z});V.append("g").attr("class","x-axis axis-modern").attr("transform",`translate(0, ${O})`).call(S=>pe.renderAxis(S,H)).selectAll("text").attr("font-size",p?"8px":"var(--font-size-xs)").attr("fill","var(--color-text-secondary)"),m&&V.append("text").attr("class","x-axis-label").attr("text-anchor","middle").attr("x",K/2).attr("y",O+(p?u.bottom*.6:u.bottom*.7)).text(m)}if(y){const H=pe.createAxis({type:"y",scale:q,position:"left",tickFormat:b,ticks:p?Math.min(M,3):M});V.append("g").attr("class","y-axis axis-modern").call(S=>pe.renderAxis(S,H)).selectAll("text").attr("font-size",p?"8px":"var(--font-size-xs)").attr("fill","var(--color-text-secondary)"),C&&V.append("text").attr("class","y-axis-label").attr("text-anchor","middle").attr("transform","rotate(-90)").attr("x",-O/2).attr("y",p?-u.left+12:-u.left+15).text(C)}const nt=V.selectAll(".bar").data(i).enter().append("rect").attr("class","bar bar-modern").attr("x",H=>Y(H[o])||0).attr("y",H=>q(H[a])).attr("width",Y.bandwidth()).attr("height",H=>Math.max(0,O-q(H[a]))).attr("fill",H=>D(H.originalKey||H[o])).attr("rx",p?Math.min(l,2):l).attr("ry",p?Math.min(l,2):l).attr("stroke",c).attr("stroke-width",p?h/2:h);E&&nt.classed("cursor-pointer",!0).on("mouseenter",function(H,S){const W=this;if(N)ht(W).transition().duration(200).attr("fill",N);else{const A=D(S.originalKey||S[o]);ht(W).transition().duration(200).attr("fill",Fe(A).brighter(.5).toString())}P&&P(H,S,W)}).on("mousemove",function(H,S){B&&B(H,S,this)}).on("mouseleave",function(H,S){const W=this;ht(W).transition().duration(200).attr("fill",D(S.originalKey||S[o])),pt&&pt(H,S,W)}).on("click",function(H,S){$&&$(H,S,this)}),R&&V.selectAll(".bar-label").data(i).enter().append("text").attr("class","bar-label").attr("x",H=>(Y(H[o])||0)+Y.bandwidth()/2).attr("y",H=>q(H[a])-5).attr("text-anchor","middle").attr("font-size",p?"8px":"var(--font-size-xs)").attr("fill","var(--color-text-secondary)").attr("display",H=>O-q(H[a])<U&&p?"none":"block").text(H=>T(H[a]));function it(H){Y.domain(H.map(x=>x[o]));const S=Tr(H,x=>x[a])||0;if(q.domain([0,S*1.1]),v){const x=V.select(".x-axis"),L=pe.createAxis({type:"x",scale:Y,position:"bottom",tickFormat:w,ticks:_,rotate:z});x.transition().duration(500).call(k=>pe.renderAxis(k,L))}if(y){const x=V.select(".y-axis"),L=pe.createAxis({type:"y",scale:q,position:"left",tickFormat:b,ticks:p?Math.min(M,3):M});x.transition().duration(500).call(k=>pe.renderAxis(k,L))}const W=V.selectAll(".bar").data(H);W.exit().transition().duration(300).attr("y",O).attr("height",0).remove();const A=W.enter().append("rect").attr("class","bar bar-modern").attr("x",x=>Y(x[o])||0).attr("y",O).attr("width",Y.bandwidth()).attr("height",0).attr("fill",x=>D(x.originalKey||x[o])).attr("rx",p?Math.min(l,2):l).attr("ry",p?Math.min(l,2):l).attr("stroke",c).attr("stroke-width",p?h/2:h);if(E&&A.classed("cursor-pointer",!0).on("mouseenter",function(x,L){const k=this;if(N)ht(k).transition().duration(200).attr("fill",N);else{const Z=D(L.originalKey||L[o]);ht(k).transition().duration(200).attr("fill",Fe(Z).brighter(.5).toString())}P&&P(x,L,k)}).on("mousemove",function(x,L){B&&B(x,L,this)}).on("mouseleave",function(x,L){const k=this;ht(k).transition().duration(200).attr("fill",D(L.originalKey||L[o])),pt&&pt(x,L,k)}).on("click",function(x,L){$&&$(x,L,this)}),W.transition().duration(500).attr("x",x=>Y(x[o])||0).attr("y",x=>q(x[a])).attr("width",Y.bandwidth()).attr("height",x=>Math.max(0,O-q(x[a]))).attr("fill",x=>D(x.originalKey||x[o])),A.transition().duration(500).attr("y",x=>q(x[a])).attr("height",x=>Math.max(0,O-q(x[a]))),R){const x=V.selectAll(".bar-label").data(H);x.exit().remove(),x.enter().append("text").attr("class","bar-label").attr("x",L=>(Y(L[o])||0)+Y.bandwidth()/2).attr("y",L=>q(L[a])-5).attr("text-anchor","middle").attr("font-size",p?"8px":"var(--font-size-xs)").attr("fill","var(--color-text-secondary)").attr("opacity",0).text(L=>T(L[a])).attr("display",L=>O-q(L[a])<U&&p?"none":"block").transition().duration(500).attr("opacity",1),x.transition().duration(500).attr("x",L=>(Y(L[o])||0)+Y.bandwidth()/2).attr("y",L=>q(L[a])-5).text(L=>T(L[a])).attr("display",L=>O-q(L[a])<U&&p?"none":"block")}}function at(){et&&(et.selectAll("*").remove(),et.remove())}return{svg:et,chart:V,xScale:Y,yScale:q,chartWidth:K,chartHeight:O,update:it,destroy:at}}var gy=xt('<div class="absolute inset-center text-secondary loading svelte-m83f2p"> </div>'),py=xt('<div class="absolute inset-center text-error error svelte-m83f2p"> </div>'),my=xt('<div class="relative bg-card rounded p-md overflow-hidden min-h-400 w-full chart-container chart-modern"><!></div>'),vy=xt('<div class="w-full index-visualization-container"><!></div>');function yy(t,e){ke(e,!1);const[n,r]=tn(),i=()=>vt(de,"$itemsStore",n),o={Évènements:"Events",Associations:"Organizations",Individus:"Persons",Emplacements:"Locations",Sujets:"Topics","Notices d'autorité":"Authority Files"};function a($){return o[$]||$}let s=[],d=0,l=!1,c=_t(),h="en",u=_t(""),g=0,p=0,v=null,y=null,m=_t(),C=null;const{groupAndCount:z}=Je({filterMissingValues:!0,requiredFields:["type"],filterFn:$=>$.type==="Notice d'autorité",calculatePercentages:!0,sortByCount:!0,sortDescending:!0}),w="viz.index_distribution_description",b=qn("primary"),_=Te(b);function M($){return $.toLocaleString(h==="fr"?"fr-FR":"en-US")}function R($){const D=M($);return lt("viz.index_distribution_items",{0:D})}function U(){l&&(d>0?F(u,R(d)):F(u,lt("viz.index_distribution_title")))}let T=null;We(async()=>{try{if(l=!0,await zn(),!f(c)){console.error("Container element not found in onMount");return}const $=f(c).getBoundingClientRect();g=$.width||100,p=$.height||400,C=Rr({container:f(c),onResize:()=>{l&&f(c)&&C&&(g=C.width,E())},debounce:!0,debounceDelay:200}),T=xe.subscribe(D=>{l&&(h=D,f(c)&&(U(),i().items&&i().items.length>0&&E()))}),y=de.subscribe(D=>{l&&f(c)&&D.items&&D.items.length>0&&E()}),i().items&&i().items.length>0?E():de.loadItems()}catch($){console.error("Error during initialization:",$)}});function E(){if(!(!l||!f(c)))try{g=f(c).getBoundingClientRect().width,p=500;const D=N();if(!D||D.length===0){pe.handleNoData(f(c),lt("viz.no_data"));return}s=D;const G=g<768;v&&(v.destroy(),v=null);const et=D.map(O=>({key:O.category,value:O.count,originalKey:O.originalCategory,percentage:O.percentage})),V=D.length>5,K={top:20,right:30,bottom:120,left:60};v=hy({container:f(c),width:g,height:p,data:et,margin:K,className:"index-distribution-chart chart-modern",isMobile:G,barColors:_,barPadding:.2,barCornerRadius:6,xAxisLabel:lt("viz.categories"),yAxisLabel:lt("viz.number_of_items"),xAxisRotation:-45,xAxisTicks:Math.max(3,Math.floor(g/120)),yAxisTicks:G?3:5,xAxisTickFormat:O=>O.length>15?O.substring(0,12)+"...":O,valueFormatter:M,onBarMouseEnter:(O,Y)=>{if(!l)return;const q=s.find(nt=>nt.category===Y.key);q&&P(O,q)},onBarMouseMove:(O,Y)=>{if(!l)return;const q=s.find(nt=>nt.category===Y.key);q&&P(O,q)},onBarMouseLeave:()=>{l&&f(m)&&f(m).hideTooltip()}})}catch($){console.error("Error creating bar chart:",$)}}function N(){if(!i().items||i().items.length===0)return[];console.log(`Processing ${i().items.length} items`);const $=i().items.filter(et=>et.type==="Notice d'autorité");if(console.log(`Found ${$.length} items of type "Notice d'autorité"`),$.length===0)return[];const D=z($,et=>et.item_set_title||lt("viz.uncategorized"));console.log(`Grouped into ${D.length} categories`);const G=D.map(et=>{const K=`category.${a(et.key)}`,O=lt(K);return{category:O!==K?O:et.key,originalCategory:et.key,count:et.count,percentage:et.percentage||0}});return d=D.reduce((et,V)=>et+V.count,0),Tr(G,et=>et.count),U(),G}function P($,D){if(!l||!f(m))return;const G=f(m).createGridTooltipContent(D.category,[{label:lt("viz.items"),value:M(D.count)},{label:lt("viz.percent_of_total"),value:`${D.percentage.toFixed(2)}%`}]);f(m).showTooltip($,G)}Dn(()=>{try{l=!1,v&&(v.destroy(),v=null),C&&(C.cleanup(),C=null),T&&(T(),T=null),y&&(y(),y=null),f(c)&&ht(f(c)).selectAll("*").remove()}catch($){console.error("Error during cleanup:",$)}}),Me();var B=vy(),pt=I(B);qe(Fr(pt,{get titleHtml(){return f(u)},descriptionTranslationKey:w,theme:"default",className:"index-visualization",children:($,D)=>{var G=my(),et=I(G);{var V=O=>{var Y=gy(),q=I(Y);zt(nt=>ut(q,nt),[()=>lt("ui.loading")],ie),rt(O,Y)},K=O=>{var Y=ue(),q=te(Y);{var nt=it=>{var at=py(),H=I(at);zt(()=>ut(H,i().error)),rt(it,at)};Lt(q,it=>{i().error&&it(nt)},!0)}rt(O,Y)};Lt(et,O=>{i().loading?O(V):O(K,!1)})}qe(G,O=>F(c,O),()=>f(c)),rt($,G)},$$slots:{default:!0},$$legacy:!0}),$=>F(m,$),()=>f(m)),rt(t,B),$e(),r()}class al{constructor(e){le(this,"options");le(this,"tooltipCallbacks",null);le(this,"monthFormat",Un("%Y-%m"));le(this,"displayFormat",Un("%b %Y"));this.options={...e,isMobile:e.width<768,isExtraSmall:e.width<480}}setTooltipCallbacks(e){this.tooltipCallbacks=e}render(e){try{const{container:n,width:r,height:i,isMobile:o,isExtraSmall:a,currentLang:s="en"}=this.options;if(console.log("[TimelineChart] Rendering with dimensions:",{width:r,height:i}),console.log("[TimelineChart] Container element:",n),console.log("[TimelineChart] Data points to render:",e.length),!e||e.length===0){console.warn("[TimelineChart] No timeline data available"),ht(n).selectAll("*").remove(),ht(n).append("div").attr("class","absolute inset-center text-secondary").text("No timeline data available with the current filters");return}if(!n){console.error("[TimelineChart] Container element is null or undefined");return}let d=r,l=i;(!d||d<=0)&&(console.warn("[TimelineChart] Invalid width, using minimum width of 300px"),d=300),(!l||l<=0)&&(console.warn("[TimelineChart] Invalid height, using minimum height of 500px"),l=500),console.log("[TimelineChart] Using dimensions:",{width:d,height:l}),ht(n).selectAll("*").remove();const c={top:o?20:40,right:o?15:30,bottom:o?70:80,left:o?40:60},h=ht(n).append("svg").attr("width",d).attr("height",l).attr("viewBox",`0 0 ${d} ${l}`).attr("class","timeline-chart timeline-modern"),u=d-c.left-c.right,p=(l-c.top-c.bottom-(o?30:50))/2,v=Oc().domain(Vf(e,y=>y.date)).range([0,u]);h.append("line").attr("x1",c.left).attr("y1",c.top+p+(o?15:25)).attr("x2",d-c.right).attr("y2",c.top+p+(o?15:25)).attr("stroke","var(--color-border-default)").attr("stroke-width",1).attr("stroke-dasharray","3,3"),this.addLegend(h,c,a,d),h.append("defs").append("marker").attr("id","circle").attr("viewBox","-5 -5 10 10").attr("refX",0).attr("refY",0).attr("markerWidth",5).attr("markerHeight",5).append("circle").attr("r",3).attr("fill","var(--color-accent-1)"),this.renderMonthlyChart(h,e,c,u,p,v,o),this.renderTotalChart(h,e,c,u,p,v,o),console.log("[TimelineChart] Successfully rendered timeline chart")}catch(n){console.error("[TimelineChart] Error rendering timeline chart:",n);try{this.options.container&&(ht(this.options.container).selectAll("*").remove(),ht(this.options.container).append("div").attr("class","absolute inset-center text-error p-md").text("Error rendering timeline chart. Please check console for details."))}catch(r){console.error("[TimelineChart] Error showing error message:",r)}}}addLegend(e,n,r,i){if(r)return;const{translations:o}=this.options,a=e.append("g").attr("transform",`translate(${i-n.right}, ${n.top-10})`);a.append("line").attr("x1",-100).attr("y1",0).attr("x2",-80).attr("y2",0).attr("stroke","var(--color-accent-1)").attr("stroke-width",2).attr("marker-end","url(#circle)"),a.append("text").attr("x",-75).attr("y",4).attr("class","text-xs text-secondary").text((o==null?void 0:o.monthlyAdditions)||"Monthly Additions"),a.append("line").attr("x1",-100).attr("y1",20).attr("x2",-80).attr("y2",20).attr("stroke","var(--color-accent-2)").attr("stroke-width",2).attr("stroke-dasharray","4 2"),a.append("text").attr("x",-75).attr("y",24).attr("class","text-xs text-secondary").text((o==null?void 0:o.totalItems)||"Total Items")}renderMonthlyChart(e,n,r,i,o,a,s){const{translations:d,currentLang:l="en"}=this.options,c=e.append("g").attr("transform",`translate(${r.left}, ${r.top})`),h=fi().domain([0,(Tr(n,y=>y.count)||0)*1.1]).range([o,0]);c.append("g").attr("class","grid chart-grid-modern").selectAll("line").data(h.ticks(s?3:5)).enter().append("line").attr("x1",0).attr("x2",i).attr("y1",y=>h(y)).attr("y2",y=>h(y)).attr("stroke","var(--color-border-light)").attr("stroke-width",.5).attr("stroke-dasharray","1,3");const u=Math.max(2,Math.floor(i/(s?60:80))),g=Gi(a).ticks(u).tickFormat(y=>{const m=y;return l==="fr"?m.toLocaleDateString("fr-FR",{month:"short",year:"2-digit"}):Un("%b '%y")(m)});c.append("g").attr("class","x-axis axis-modern").attr("transform",`translate(0, ${o})`).call(g).selectAll("text").attr("class","text-xs text-secondary").attr("text-anchor","end").attr("dx","-.8em").attr("dy",".15em").attr("transform",`rotate(${s?-45:-30})`);const p=Ki(h).ticks(s?3:5);c.append("g").attr("class","y-axis axis-modern").call(p).selectAll("text").attr("class","text-xs text-secondary"),s||c.append("text").attr("class","text-xs text-secondary").attr("transform","rotate(-90)").attr("y",-50).attr("x",-o/2).attr("text-anchor","middle").text((d==null?void 0:d.monthlyAdditions)||"Monthly Additions");const v=js().x(y=>a(y.date)).y(y=>h(y.count)).curve(el);c.append("path").datum(n).attr("fill","none").attr("stroke","var(--color-accent-1)").attr("stroke-width",s?1.5:2).attr("d",v).attr("class","timeline-bar"),this.addMonthlyDots(c,n,a,h,s)}addMonthlyDots(e,n,r,i,o){const{formatNumber:a,translations:s,currentLang:d="en"}=this.options;if(!this.tooltipCallbacks)return;const{showTooltip:l,hideTooltip:c}=this.tooltipCallbacks;e.selectAll(".dot-monthly").data(o?n.filter((h,u)=>u%2===0):n).enter().append("circle").attr("class","dot-monthly cursor-pointer").attr("cx",h=>r(h.date)).attr("cy",h=>i(h.count)).attr("r",o?3:4).attr("fill","var(--color-accent-1)").attr("stroke","var(--color-bg-card)").attr("stroke-width",2).on("mouseenter",function(h,u){ht(this).transition().duration(200).attr("r",o?5:6);const g=u.date.toLocaleString(d==="fr"?"fr-FR":"en-US",{month:"long"}),p=u.date.getFullYear(),v=Tn(`${g} ${p}`,[{label:(s==null?void 0:s.newItems)||"New Items",value:a?a(u.count):u.count.toString()},{label:(s==null?void 0:s.percentage)||"Percentage",value:`${u.percentage.toFixed(2)}%`}]);l(h,v)}).on("mousemove",function(h,u){const g=u.date.toLocaleString(d==="fr"?"fr-FR":"en-US",{month:"long"}),p=u.date.getFullYear(),v=Tn(`${g} ${p}`,[{label:(s==null?void 0:s.newItems)||"New Items",value:a?a(u.count):u.count.toString()},{label:(s==null?void 0:s.percentage)||"Percentage",value:`${u.percentage.toFixed(2)}%`}]);l(h,v)}).on("mouseleave",function(){ht(this).transition().duration(200).attr("r",o?3:4),c()})}renderTotalChart(e,n,r,i,o,a,s){const{translations:d,currentLang:l="en"}=this.options,c=e.append("g").attr("transform",`translate(${r.left}, ${r.top+o+(s?30:50)})`),h=fi().domain([0,(Tr(n,y=>y.total)||0)*1.1]).range([o,0]);c.append("g").attr("class","grid").selectAll("line").data(h.ticks(s?3:5)).enter().append("line").attr("x1",0).attr("x2",i).attr("y1",y=>h(y)).attr("y2",y=>h(y)).attr("stroke","var(--color-border-default)").attr("stroke-width",.5);const u=Math.max(2,Math.floor(i/(s?60:80))),g=Gi(a).ticks(u).tickFormat(y=>{const m=y;return l==="fr"?m.toLocaleDateString("fr-FR",{month:"short",year:"2-digit"}):Un("%b '%y")(m)});c.append("g").attr("class","x-axis").attr("transform",`translate(0, ${o})`).call(g).selectAll("text").attr("class","text-xs text-primary").attr("text-anchor","end").attr("dx","-.8em").attr("dy",".15em").attr("transform",`rotate(${s?-45:-30})`);const p=Ki(h).ticks(s?3:5);c.append("g").attr("class","y-axis").call(p).selectAll("text").attr("class","text-xs text-primary"),s||(c.append("text").attr("class","text-xs text-secondary").attr("transform","rotate(-90)").attr("y",-50).attr("x",-o/2).attr("text-anchor","middle").text((d==null?void 0:d.totalItems)||"Total Items"),c.append("text").attr("class","text-xs text-secondary").attr("text-anchor","middle").attr("x",i/2).attr("y",o+45).text((d==null?void 0:d.month)||"Month"));const v=js().x(y=>a(y.date)).y(y=>h(y.total)).curve(el);c.append("path").datum(n).attr("fill","none").attr("stroke","var(--color-secondary)").attr("stroke-width",s?1.5:2).attr("stroke-dasharray","4 2").attr("d",v),this.addTotalDots(c,n,a,h,s)}addTotalDots(e,n,r,i,o){const{formatNumber:a,translations:s,currentLang:d="en"}=this.options;if(!this.tooltipCallbacks)return;const{showTooltip:l,hideTooltip:c}=this.tooltipCallbacks;e.selectAll(".dot-total").data(o?n.filter((h,u)=>u%2===0):n).enter().append("circle").attr("class","dot-total cursor-pointer").attr("cx",h=>r(h.date)).attr("cy",h=>i(h.total)).attr("r",o?3:4).attr("fill","var(--color-secondary)").attr("stroke","white").attr("stroke-width",1).on("mouseenter",function(h,u){ht(this).transition().duration(200).attr("r",o?5:6);const g=u.date.toLocaleString(d==="fr"?"fr-FR":"en-US",{month:"long"}),p=u.date.getFullYear(),v=Tn(`${g} ${p}`,[{label:(s==null?void 0:s.totalItems)||"Total Items",value:a?a(u.total):u.total.toString()}]);l(h,v)}).on("mousemove",function(h,u){const g=u.date.toLocaleString(d==="fr"?"fr-FR":"en-US",{month:"long"}),p=u.date.getFullYear(),v=Tn(`${g} ${p}`,[{label:(s==null?void 0:s.totalItems)||"Total Items",value:a?a(u.total):u.total.toString()}]);l(h,v)}).on("mouseleave",function(){ht(this).transition().duration(200).attr("r",o?3:4),c()})}}var _y=xt("<option> </option>"),xy=xt("<option> </option>"),by=xt("<span> </span>"),wy=xt('<div class="absolute inset-center text-error">Store not available</div>'),Ty=xt('<div class="absolute inset-center text-secondary"><div class="loading-spinner mr-sm svelte-ixrij9"></div> <span> </span></div>'),Cy=xt('<div class="absolute inset-center text-error"> </div>'),ky=xt('<div class="absolute inset-center text-secondary"><div class="loading-spinner mr-sm svelte-ixrij9"></div> <span>Initializing visualization...</span></div>'),$y=xt('<div class="absolute inset-center text-secondary"> </div>'),zy=xt('<li class="flex justify-between mb-xs text-sm"><span class="text-primary"> </span> <span class="text-secondary font-medium"> </span></li>'),My=xt('<div class="p-md stat-summary svelte-ixrij9"><h3 class="mt-0 mb-sm text-md text-primary border-b border-solid border-default pb-xs"> </h3> <p class="text-sm mb-xs"> <strong class="font-medium"> </strong></p> <p class="text-sm mb-xs"> <strong class="font-medium"> </strong></p> <p class="text-sm"> <strong class="font-medium"> </strong></p></div> <div class="p-md peak-months svelte-ixrij9"><h3 class="mt-0 mb-sm text-md text-primary border-b border-solid border-default pb-xs"> </h3> <ul class="list-style-none p-0 m-0"></ul></div>',1),Ay=xt('<div class="p-md col-span-2 text-center text-secondary"> </div>'),Sy=xt('<div class="flex flex-wrap gap-md p-md bg-card rounded-t border-b border-solid border-default filters glass-overlay svelte-ixrij9"><div class="flex flex-col gap-xs filter-group svelte-ixrij9"><label for="country-filter" class="text-xs font-bold text-secondary"> </label> <select id="country-filter" class="p-xs px-sm rounded-sm border border-solid border-default bg-card text-primary text-sm svelte-ixrij9"></select></div> <div class="flex flex-col gap-xs filter-group svelte-ixrij9"><label for="type-filter" class="text-xs font-bold text-secondary"> </label> <select id="type-filter" class="p-xs px-sm rounded-sm border border-solid border-default bg-card text-primary text-sm svelte-ixrij9"></select></div> <div class="ml-auto self-end text-sm text-secondary summary svelte-ixrij9"><!></div></div> <div class="flex-1 relative min-h-500 bg-card rounded-b p-md chart-container chart-modern overflow-hidden svelte-ixrij9" style="height: 500px;"><!></div> <div class="grid grid-cols-2 gap-md p-md bg-card rounded shadow mt-md stats svelte-ixrij9"><!></div>',1),Ey=xt('<div class="w-full h-full flex flex-col gap-md"><!></div>');function Ny(t,e){ke(e,!1);const[n,r]=tn(),i=()=>vt(xe,"$languageStore",n),o=()=>vt(de,"$itemsStore",n),a=()=>vt(ft,"$monthlyAdditionsText",n),s=()=>vt(k,"$totalItemsText",n),d=()=>vt(Kt,"$newItemsText",n),l=()=>vt(qt,"$percentageText",n),c=()=>vt(Ft,"$monthText",n),h=()=>vt(W,"$filterByCountryText",n),u=()=>vt(A,"$filterByTypeText",n),g=()=>vt(ot,"$showingItemsOverMonthsText",n),p=()=>vt(x,"$noDataText",n),v=()=>vt(L,"$summaryText",n),y=()=>vt(Z,"$timePeriodText",n),m=()=>vt(X,"$avgMonthlyAdditionsText",n),C=()=>vt(dt,"$peakGrowthMonthsText",n),z=()=>vt(J,"$itemsText",n),w="viz.growth_since_april_description";let b=_t("all"),_=_t("all"),M=_t([]),R=_t([]),U=_t([]),T=_t(0),E=0,N=0,P=0,B="en",pt=_t(""),$=_t(0),D=_t(0),G=_t(),et;const{showTooltip:V,hideTooltip:K}=Eo({defaultWidth:200,defaultHeight:100});let O=_t();const{filterItems:Y,processTimeData:q}=Je({filterMissingValues:!0,requiredFields:["created_date"],calculatePercentages:!0,sortByCount:!0,sortDescending:!0,filterFn:j=>!(j.type==="Notice d'autorité"||f(b)!=="all"&&j.country!==f(b)||f(_)!=="all"&&j.type!==f(_))}),nt=Je({filterMissingValues:!0,requiredFields:["created_date"],filterFn:j=>{if(j.type==="Notice d'autorité"||!j.created_date)return!1;const st=new Date(j.created_date);return isNaN(st.getTime())||st<new Date(2024,3,1)?!1:f(_)==="all"||j.type===f(_)}}),it=Je({filterMissingValues:!0,requiredFields:["created_date"],filterFn:j=>{if(j.type==="Notice d'autorité"||!j.created_date)return!1;const st=new Date(j.created_date);return isNaN(st.getTime())||st<new Date(2024,3,1)?!1:f(b)==="all"||j.country===f(b)}});let at,H=_t(!1),S=_t(!1);Un("%Y-%m"),Un("%b %Y");const W=tt("viz.filter_by_country"),A=tt("viz.filter_by_type"),x=tt("viz.no_data"),L=tt("viz.summary"),k=tt("viz.total_items"),Z=tt("viz.time_period"),X=tt("viz.avg_monthly_additions"),dt=tt("viz.peak_growth_months"),ot=tt("viz.showing_items_over_months"),J=tt("viz.items");tt("viz.timeline_distribution_items");const ft=tt("viz.monthly_additions"),Ft=tt("viz.month");tt("viz.growth_since_april");const Kt=tt("viz.new_items"),qt=tt("viz.percentage");function Xt(j){return j.toLocaleString(B==="fr"?"fr-FR":"en-US")}function jt(){if(E>0){const j=Xt(E);return lt("viz.items_added_since_april",{0:j})}else return lt("viz.items_added_since_april_title")}function Q(){console.log("[TimelineDistribution] Updating title with count:",f(T)),F(pt,jt())}let kt=null;function Vt(){kt&&clearTimeout(kt),kt=setTimeout(()=>{bt(),kt=null},250)}We(()=>(F(H,!0),console.log("[TimelineDistribution] Component mounted"),(async()=>{var j;try{if(await zn(),!f(G)){console.error("[TimelineDistribution] Container element not found in onMount");return}console.log("[TimelineDistribution] Container element found:",f(G)),F(O,Rr({container:f(G),onResize:()=>{if(f(H)&&f(S)&&f(G)){const{width:gt,height:ct}=f(O).dimensions,It=Math.abs(f($)-gt)>5,ae=Math.abs(f(D)-ct)>5;(It||ae)&&(console.log("[TimelineDistribution] Size changed, updating visualization",{newWidth:gt,newHeight:ct}),F($,gt),F(D,ct),Vt())}}}));const{width:st,height:mt}=f(O).dimensions;if(F($,st),F(D,mt||500),console.log("[TimelineDistribution] Initial dimensions:",{width:f($),height:f(D)}),at=xe.subscribe(gt=>{f(H)&&(console.log("[TimelineDistribution] Language changed to:",gt),B=gt,Q(),f(S)&&f(G)&&Vt())}),!o().items||o().items.length===0){console.log("[TimelineDistribution] No items loaded, loading items");try{await de.loadItems(),console.log("[TimelineDistribution] Items loaded:",(j=o().items)==null?void 0:j.length)}catch(gt){console.error("[TimelineDistribution] Error loading items:",gt)}}else console.log("[TimelineDistribution] Items already loaded:",o().items.length);Ut(),F(S,!0),await zn(),f(G)?($t(),bt(),console.log("[TimelineDistribution] Visualization initialized")):console.error("[TimelineDistribution] Container not available after initialization")}catch(st){console.error("[TimelineDistribution] Error during initialization:",st)}})(),()=>{try{console.log("[TimelineDistribution] Component unmounting, cleaning up"),F(H,!1),F(S,!1),f(O)&&f(O).cleanup(),at&&at(),kt&&(clearTimeout(kt),kt=null),f(G)&&ht(f(G)).selectAll("*").remove()}catch(j){console.error("[TimelineDistribution] Error during cleanup:",j)}}));function $t(){try{console.log("[TimelineDistribution] Initializing timeline chart with dimensions:",{width:f($),height:f(D)}),console.log("[TimelineDistribution] Container element:",f(G)),ht(f(G)).selectAll("*").remove(),et=new al({container:f(G),width:f($),height:f(D),formatNumber:Xt,currentLang:B,translations:{monthlyAdditions:a(),totalItems:s(),newItems:d(),percentage:l(),month:c()}}),et.setTooltipCallbacks({showTooltip:V,hideTooltip:K}),console.log("[TimelineDistribution] Timeline chart initialized with modern styling")}catch(j){console.error("[TimelineDistribution] Error initializing timeline chart:",j)}}function bt(){try{if(!f(G)||!f(H)||!f(S)){console.error("[TimelineDistribution] Cannot update visualization - component not ready",{container:!!f(G),isMounted:f(H),isInitialized:f(S)});return}console.log("[TimelineDistribution] Updating visualization with dimensions:",{width:f($),height:f(D)}),f(D)<=0&&(F(D,500),console.log("[TimelineDistribution] Using fallback height of 500px"));const j=Pt();if(!j||j.length===0){console.warn("[TimelineDistribution] No timeline data available with current filters"),ht(f(G)).selectAll("*").remove(),ht(f(G)).append("div").attr("class","absolute inset-center text-secondary").text("No timeline data available with the current filters");return}F(M,j),console.log("[TimelineDistribution] Timeline data updated with",f(M).length,"data points"),ht(f(G)).selectAll("*").remove(),et=new al({container:f(G),width:f($),height:f(D),formatNumber:Xt,currentLang:B,translations:{monthlyAdditions:a(),totalItems:s(),newItems:d(),percentage:l(),month:c()}}),et.setTooltipCallbacks({showTooltip:V,hideTooltip:K}),et.render(j),console.log("[TimelineDistribution] Chart rendered with",j.length,"data points"),Q()}catch(j){if(console.error("[TimelineDistribution] Error updating visualization:",j),f(G))try{ht(f(G)).selectAll("*").remove(),ht(f(G)).append("div").attr("class","absolute inset-center text-error").text("Error rendering timeline visualization")}catch(st){console.error("[TimelineDistribution] Error showing error message:",st)}}}function At(j){const st=j.target;F(b,st.value),Ut(),Vt()}function Mt(j){const st=j.target;F(_,st.value),Ut(),Vt()}function Pt(){var j;if(!o().items||o().items.length===0)return console.warn("[TimelineDistribution] No items available for timeline data"),[];console.log("[TimelineDistribution] Processing data with filters:",{country:f(b),type:f(_)}),console.log("[TimelineDistribution] Total items before filtering:",o().items.length);try{const st=new Date(2024,3,1),mt=8874;o().items.length>0&&console.log("[TimelineDistribution] Sample created_date values:",o().items.slice(0,5).map(It=>It.created_date));const gt=Y(o().items);console.log("[TimelineDistribution] Items after filtering:",gt.length);const ct=q(gt,"created_date",{startDate:st,includeCumulative:!0,initialTotal:mt});return console.log("[TimelineDistribution] Processed timeline data length:",ct.length),ct.length>0&&console.log("[TimelineDistribution] First and last data points:",ct[0],ct[ct.length-1]),ct.length===0?(console.warn("[TimelineDistribution] No timeline data generated after processing"),[]):(F(T,((j=ct[ct.length-1])==null?void 0:j.total)||mt),E=f(T)-mt,N=Math.max(...ct.map(It=>It.count)),P=Math.max(...ct.map(It=>It.total)),ct)}catch(st){return console.error("[TimelineDistribution] Error processing timeline data:",st),[]}}function Ut(){if(!o().items||o().items.length===0)return;console.log("[TimelineDistribution] Generating facet options with filters:",{country:f(b),type:f(_)});const j=nt.filterItems(o().items),st=it.filterItems(o().items);console.log("[TimelineDistribution] Items for country facets:",j.length),console.log("[TimelineDistribution] Items for type facets:",st.length);const mt=nt.groupAndCount(j,ct=>ct.country||"Unknown",j.length);F(R,[{value:"all",label:lt("country.all"),count:j.length},...mt.filter(ct=>ct.key!=="Unknown").map(ct=>({value:ct.key,label:lt(`country.${ct.key}`),count:ct.count})).sort((ct,It)=>It.count-ct.count)]);const gt=it.groupAndCount(st,ct=>ct.type||"Unknown",st.length);F(U,[{value:"all",label:lt("type.all"),count:st.length},...gt.filter(ct=>ct.key!=="Unknown"&&ct.count>0).map(ct=>({value:ct.key,label:lt(`type.${ct.key}`),count:ct.count})).sort((ct,It)=>It.count-ct.count)]),console.log("[TimelineDistribution] Updated facet options:",{countryOptions:f(R).length,typeOptions:f(U).length})}me(()=>i(),()=>{i(),Q()}),me(()=>(f(H),f(S),o(),f(G),f(O),f($),f(D)),()=>{f(H)&&f(S)&&o().items&&f(G)&&f(O)&&(f($)!==f(O).dimensions.width||f(D)!==f(O).dimensions.height)&&(F($,f(O).dimensions.width),F(D,f(O).dimensions.height),bt())}),me(()=>(f(H),i(),o()),()=>{f(H)&&i()&&o().items&&o().items.length>0&&Ut()}),me(()=>(f(S),f(b),f(_)),()=>{f(S)&&(f(b)||f(_))&&Vt()}),pi(),Me();var Ht=Ey(),Ct=I(Ht);Fr(Ct,{title:"Growth of the Database",get titleHtml(){return f(pt)},descriptionTranslationKey:w,theme:"default",className:"timeline-visualization",children:(j,st)=>{var mt=Sy(),gt=te(mt),ct=I(gt),It=I(ct),ae=I(It),St=yt(It,2);Ko(St,()=>f(b));var Jt;Bn(St,5,()=>f(R),vr,(Rt,Bt)=>{var se=_y(),Ee={},pn=I(se);zt(fe=>{Ee!==(Ee=f(Bt).value)&&(se.value=(se.__value=f(Bt).value)==null?"":f(Bt).value),ut(pn,`${f(Bt).label??""} (${fe??""})`)},[()=>Xt(f(Bt).count)],ie),rt(Rt,se)});var Wt=yt(ct,2),Nt=I(Wt),Tt=I(Nt),Et=yt(Nt,2);Ko(Et,()=>f(_));var ne;Bn(Et,5,()=>f(U),vr,(Rt,Bt)=>{var se=xy(),Ee={},pn=I(se);zt(fe=>{Ee!==(Ee=f(Bt).value)&&(se.value=(se.__value=f(Bt).value)==null?"":f(Bt).value),ut(pn,`${f(Bt).label??""} (${fe??""})`)},[()=>Xt(f(Bt).count)],ie),rt(Rt,se)});var He=yt(Wt,2),Ae=I(He);{var Se=Rt=>{var Bt=by(),se=I(Bt);zt(Ee=>ut(se,Ee),[()=>g().replace("{0}",Xt(f(T))).replace("{1}",f(M).length.toString())],ie),rt(Rt,Bt)};Lt(Ae,Rt=>{f(M)&&f(M).length>0&&Rt(Se)})}var Oe=yt(gt,2),Ye=I(Oe);{var Ze=Rt=>{var Bt=wy();rt(Rt,Bt)},wt=Rt=>{var Bt=ue(),se=te(Bt);{var Ee=fe=>{var Ne=Ty(),mn=yt(I(Ne),2),Vn=I(mn);zt(In=>ut(Vn,In),[()=>lt("ui.loading")],ie),rt(fe,Ne)},pn=fe=>{var Ne=ue(),mn=te(Ne);{var Vn=be=>{var Ge=Cy(),Wn=I(Ge);zt(()=>ut(Wn,o().error)),rt(be,Ge)},In=be=>{var Ge=ue(),Wn=te(Ge);{var Pr=en=>{var Fn=ky();rt(en,Fn)},Ln=en=>{var Fn=ue(),Hr=te(Fn);{var sr=vn=>{var _i=$y(),Yn=I(_i);zt(()=>ut(Yn,p())),rt(vn,_i)};Lt(Hr,vn=>{(!f(M)||f(M).length===0)&&vn(sr)},!0)}rt(en,Fn)};Lt(Wn,en=>{f(S)?en(Ln,!1):en(Pr)},!0)}rt(be,Ge)};Lt(mn,be=>{o().error?be(Vn):be(In,!1)},!0)}rt(fe,Ne)};Lt(se,fe=>{o().loading?fe(Ee):fe(pn,!1)},!0)}rt(Rt,Bt)};Lt(Ye,Rt=>{o()?Rt(wt,!1):Rt(Ze)})}qe(Oe,Rt=>F(G,Rt),()=>f(G));var Dt=yt(Oe,2),Yt=I(Dt);{var ge=Rt=>{var Bt=My(),se=te(Bt),Ee=I(se),pn=I(Ee),fe=yt(Ee,2),Ne=I(fe),mn=yt(Ne),Vn=I(mn),In=yt(fe,2),be=I(In),Ge=yt(be),Wn=I(Ge),Pr=yt(In,2),Ln=I(Pr),en=yt(Ln),Fn=I(en),Hr=yt(se,2),sr=I(Hr),vn=I(sr),_i=yt(sr,2);Bn(_i,5,()=>[...f(M)].sort((Yn,Zn)=>Zn.count-Yn.count).slice(0,3),vr,(Yn,Zn)=>{var Or=zy(),Ur=I(Or),Wc=I(Ur),Yc=yt(Ur,2),Zc=I(Yc);zt((Gc,Kc)=>{ut(Wc,f(Zn).monthFormatted),ut(Zc,`${Gc??""} ${z()??""} (${Kc??""}%)`)},[()=>Xt(f(Zn).count),()=>(f(Zn).count/(f(T)||1)*100).toFixed(1)],ie),rt(Yn,Or)}),zt((Yn,Zn)=>{var Or,Ur;ut(pn,v()),ut(Ne,`${s()??""}: `),ut(Vn,Yn),ut(be,`${y()??""}: `),ut(Wn,`${((Or=f(M)[0])==null?void 0:Or.monthFormatted)||""} to ${((Ur=f(M)[f(M).length-1])==null?void 0:Ur.monthFormatted)||""}`),ut(Ln,`${m()??""}: `),ut(Fn,Zn),ut(vn,C())},[()=>Xt(f(T)),()=>Xt(Math.round(f(T)/(f(M).length||1)))],ie),rt(Rt,Bt)},ce=Rt=>{var Bt=Ay(),se=I(Bt);zt(()=>ut(se,p())),rt(Rt,Bt)};Lt(Yt,Rt=>{f(M)&&f(M).length>0?Rt(ge):Rt(ce,!1)})}zt(()=>{ut(ae,`${h()??""}:`),Jt!==(Jt=f(b))&&(St.value=(St.__value=f(b))==null?"":f(b),ai(St,f(b))),ut(Tt,`${u()??""}:`),ne!==(ne=f(_))&&(Et.value=(Et.__value=f(_))==null?"":f(_),ai(Et,f(_)))}),_e("change",St,At),_e("change",Et,Mt),rt(j,mt)},$$slots:{default:!0}}),rt(t,Ht),$e(),r()}const br=[],Dy=1e3;function Iy(){return new Date().toISOString()}function Qt(t,e,n){const i={timestamp:Iy(),component:t,action:e,details:n};br.push(i),br.length>Dy&&br.shift()}const Ly=new Set,Fy={};function Ry(){console.group("IWAC Debug Logs"),br.forEach(t=>{console.groupCollapsed(`${t.timestamp} - ${t.component} - ${t.action}`),console.log("Component:",t.component),console.log("Action:",t.action),t.details&&console.log("Details:",t.details),console.groupEnd()}),console.groupEnd()}function Py(){return JSON.stringify(br,null,2)}typeof window<"u"&&(window.__IWAC_DEBUG={logs:br,dumpLogs:Ry,exportLogs:Py,mountedComponents:()=>Array.from(Ly),hierarchy:Fy});var Hy=Ta('<svg viewBox="0 0 24 24" width="14" height="14"><path fill="currentColor" d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"></path></svg>'),Oy=xt('<div class="facet-option svelte-zdtio0" role="checkbox" tabindex="0"><span class="facet-checkbox svelte-zdtio0"><!></span> <span class="facet-label svelte-zdtio0"> </span> <span class="facet-count svelte-zdtio0"> </span></div>'),Uy=xt('<div class="absolute inset-center text-secondary z-50"> </div>'),By=xt('<div class="absolute inset-center text-error z-50"> </div>'),qy=xt('<div class="type-distribution-container svelte-zdtio0"><div class="controls-container svelte-zdtio0"><div class="facets svelte-zdtio0"><div class="facet-group svelte-zdtio0"><h3 class="svelte-zdtio0"> </h3> <div class="facet-options table-layout svelte-zdtio0"></div></div></div> <div class="year-range svelte-zdtio0"><h3 class="svelte-zdtio0"> </h3> <div class="slider-container svelte-zdtio0"><div class="slider-labels svelte-zdtio0"><span> </span> <span> </span></div> <div class="slider-inputs svelte-zdtio0"><input type="range" data-index="0" class="svelte-zdtio0"> <input type="range" data-index="1" class="svelte-zdtio0"></div></div></div></div> <div class="chart-container chart-modern svelte-zdtio0"><!></div></div>');function Vy(t,e){ke(e,!1);const[n,r]=tn(),i=()=>vt(de,"$itemsStore",n),o=()=>vt(B,"$noDataText",n),a=()=>vt(pt,"$yearText",n),s=()=>vt($,"$numberOfItemsText",n),d=()=>vt(D,"$toggleTypesText",n),l=()=>vt(G,"$countriesText",n),c=()=>vt(et,"$yearRangeText",n),h="TypeDistribution";let u=!1,g,p,v="en",y,m=_t(),C=0,z=0,w=_t([]),b=_t([]),_=_t([0,0]),M=[],R=0,U=[];qn("primary");const{showTooltip:T,hideTooltip:E}=Eo({defaultWidth:250,defaultHeight:150});let N;const{groupHierarchically:P}=Je({filterMissingValues:!0,requiredFields:["publication_date","type"],calculatePercentages:!0,sortByCount:!0,sortDescending:!0}),B=tt("viz.no_data");tt("viz.filter_by_country"),tt("viz.all_countries"),tt("viz.publication_year");const pt=tt("viz.year"),$=tt("viz.number_of_items"),D=tt("viz.toggle_types");tt("viz.toggled_type");const G=tt("viz.countries"),et=tt("viz.time_period");tt("viz.summary"),tt("viz.showing_items_over_months"),tt("viz.types"),tt("viz.published_between");let V=_t("");function K(A){return A.toLocaleString(v==="fr"?"fr-FR":"en-US")}function O(){if(R>0){const A=R.toLocaleString();F(V,lt("viz.type_distribution_items",{0:A}))}else F(V,lt("viz.type_distribution_title"));console.log("Type Distribution Title updated:",f(V))}function Y(A){return A?/^\d{4}$/.test(A)?parseInt(A):/^\d{4}-\d{2}$/.test(A)||/^\d{4}-\d{2}-\d{2}$/.test(A)?parseInt(A.substring(0,4)):null:null}function q(){var ot;if(!u||!i().items||i().items.length===0)return[];const A=f(w).filter(J=>J.selected).map(J=>J.value),x=A.includes("all"),L=J=>{if(J.type==="Notice d'autorité")return!1;const ft=Y(J.publication_date);return!(!ft||ft<f(_)[0]||ft>f(_)[1]||!J.country||J.country.trim()===""||J.country==="Unknown"||!x&&!A.includes(J.country))},{filterItems:k}=Je({filterMissingValues:!0,requiredFields:["publication_date","type"],filterFn:L}),Z=k(i().items);R=Z.length,O();const X=P(Z,[J=>{var ft;return((ft=Y(J.publication_date))==null?void 0:ft.toString())||"Unknown"},J=>J.type||"Unknown"]),dt=[];return(ot=X.children)==null||ot.forEach(J=>{var Ft;const ft=parseInt(J.name);(Ft=J.children)==null||Ft.forEach(Kt=>{dt.push({year:ft,type:Kt.name,count:Kt.value})})}),dt}function nt(){var dt;if(!u||!i().items||i().items.length===0)return;const A=ot=>{if(ot.type==="Notice d'autorité")return!1;const J=Y(ot.publication_date);return J!==null&&J>=f(_)[0]&&J<=f(_)[1]},{filterItems:x,groupAndCount:L}=Je({filterMissingValues:!0,requiredFields:["publication_date"],filterFn:A}),k=x(i().items),Z=L(k,ot=>ot.country||"Unknown"),X=k.filter(ot=>ot.country&&ot.country.trim()!==""&&ot.country!=="Unknown").length;F(w,[{value:"all",label:lt("country.all"),count:X,selected:((dt=f(w).find(ot=>ot.value==="all"))==null?void 0:dt.selected)??!0},...Z.filter(ot=>ot.key!=="Unknown").map(ot=>{var J;return{value:ot.key,label:lt(`country.${ot.key}`)||ot.key,count:ot.count,selected:((J=f(w).find(ft=>ft.value===ot.key))==null?void 0:J.selected)??!1}})]),f(w).sort((ot,J)=>ot.value==="all"?-1:J.value==="all"?1:ot.label.localeCompare(J.label))}function it(){if(!u||!i().items||i().items.length===0)return;const A=i().items.filter(k=>k.type!=="Notice d'autorité").map(k=>Y(k.publication_date)).filter(k=>k!==null);if(A.length===0)return;const x=Math.min(...A),L=Math.max(...A);F(b,Array.from({length:L-x+1},(k,Z)=>x+Z)),(f(_)[0]===0||f(_)[1]===0)&&F(_,[x,L])}function at(A){u&&(A.value==="all"?f(w).forEach(x=>{x.selected=x.value==="all"}):(f(w).find(x=>x.value==="all").selected=!1,A.selected=!A.selected,f(w).some(x=>x.selected)||(f(w).find(x=>x.value==="all").selected=!0)),F(w,[...f(w)]),S())}function H(A){const x=A.target,L=parseInt(x.dataset.index||"0"),k=parseInt(x.value);L===0?F(_,[k,Math.max(k,f(_)[1])]):F(_,[Math.min(k,f(_)[0]),k]),nt(),S()}function S(){if(!u||!f(m)||!document.body.contains(f(m))){console.error("Cannot update visualization - component not mounted or container not found");return}try{if(M=q(),ht(f(m)).select("svg").remove(),ht(f(m)).selectAll(".absolute.inset-center").remove(),y&&(y.cleanup(),y=null),M.length===0){ht(f(m)).append("div").attr("class","absolute inset-center text-secondary z-50").text(o());return}if(!u||!document.body.contains(f(m)))return;const A=f(m).getBoundingClientRect();if(C=A.width,z=Math.max(400,A.height-100),!u||!document.body.contains(f(m)))return;const x=Array.from(new Set(M.map(Q=>Q.type))),L={top:20,right:30,bottom:70,left:60},k=C-L.left-L.right;if(x.sort((Q,kt)=>{const Vt=lt(`type.${Q}`)!==`type.${Q}`?lt(`type.${Q}`):Q,$t=lt(`type.${kt}`)!==`type.${kt}`?lt(`type.${kt}`):kt;return Vt.localeCompare($t)}),!u||!document.body.contains(f(m)))return;if(U.length===0)U=x.map(Q=>({type:Q,visible:!0}));else{const Q=U.map(kt=>kt.type);x.forEach(kt=>{Q.includes(kt)||U.push({type:kt,visible:!0})})}const Z=x.filter(Q=>{var kt;return((kt=U.find(Vt=>Vt.type===Q))==null?void 0:kt.visible)??!0}),X=z-L.top-L.bottom;if(!u||!document.body.contains(f(m)))return;if(Z.length===0){ht(f(m)).selectAll(".absolute.inset-center").remove(),ht(f(m)).append("div").attr("class","absolute inset-center text-secondary z-50").text(o());return}const dt=ht(f(m)).append("svg").attr("width",C).attr("height",z),ot=dt.append("g").attr("transform",`translate(${L.left}, ${L.top})`),J=Array.from(Ma(M.filter(Q=>{var kt;return((kt=U.find(Vt=>Vt.type===Q.type))==null?void 0:kt.visible)??!0}),Q=>Q.year),([Q,kt])=>{const Vt={year:Q};return kt.forEach($t=>{Vt[$t.type]=$t.count}),Vt}).sort((Q,kt)=>Q.year-kt.year);if(J.length===0){ht(f(m)).selectAll(".absolute.inset-center").remove(),ht(f(m)).append("div").attr("class","absolute inset-center text-secondary z-50").text(o());return}const ft=Pa().domain(J.map(Q=>Q.year.toString())).range([0,k]).padding(.1),Ft=g0().keys(Z).value((Q,kt)=>Q[kt]||0)(J),Kt=fi().domain([0,Tr(Ft.length>0?Ft[Ft.length-1]:[],Q=>Q[1])||0]).range([X,0]);if(!u||!document.body.contains(f(m)))return;const qt=["Press Article","Journal Article","Book Chapter","Doctoral Thesis","type.Article d'encyclopédie","type.Mémoire de maitrise","Book","type.Compte rendu de livre","type.Rapport","type.Working paper","type.Mémoire de licence","Islamic Periodical","Document","type.Photographie","Blog Post","Scientific Communication","type.Enregistrement vidéo","Article de presse","Article de revue","Chapitre de livre","Thèse de doctorat","Article d'encyclopédie","Mémoire de maitrise","Livre","Compte rendu de livre","Rapport","Working paper","Mémoire de licence","Périodique islamique","Document","Photographie","Article de blog","Communication scientifique","Enregistrement vidéo"],Xt=Te().domain(qt).range(di);if(ot.append("g").attr("transform",`translate(0, ${X})`).call(Gi(ft).tickValues(J.filter(Q=>Q.year%5===0).map(Q=>Q.year.toString())).tickSizeOuter(0)).selectAll("text").attr("text-anchor","end").attr("dx","-.8em").attr("dy",".15em").attr("transform","rotate(-45)").attr("class","text-xs text-primary"),!u||!document.body.contains(f(m))||(ot.append("g").call(Ki(Kt).ticks(5)).selectAll("text").attr("class","text-xs text-primary"),ot.append("text").attr("text-anchor","middle").attr("x",k/2).attr("y",X+40).attr("fill","var(--color-text-secondary)").attr("class","text-sm text-secondary").text(a()),ot.append("text").attr("text-anchor","middle").attr("transform","rotate(-90)").attr("x",-X/2).attr("y",-L.left+15).attr("fill","var(--color-text-secondary)").attr("class","text-sm text-secondary").text(s()),!u||!document.body.contains(f(m)))||(ot.selectAll(".type-bars").data(Ft).enter().append("g").attr("class","type-bars").attr("fill",Q=>Xt(Q.key)).selectAll("rect").data(Q=>Q).enter().append("rect").attr("x",Q=>ft(Q.data.year.toString())||0).attr("y",Q=>Kt(Q[1])).attr("height",Q=>Kt(Q[0])-Kt(Q[1])).attr("width",ft.bandwidth()).attr("stroke","white").attr("stroke-width",1).on("mouseenter",(Q,kt)=>{if(u){const Vt=W(kt,Ft);T(Q,Vt)}}).on("mousemove",(Q,kt)=>{if(u){const Vt=W(kt,Ft);T(Q,Vt)}}).on("mouseleave",()=>{u&&E()}),!u||!document.body.contains(f(m))))return;const jt=x.map(Q=>{const kt=M.filter(Vt=>Vt.type===Q).reduce((Vt,$t)=>Vt+$t.count,0);return{type:Q,count:kt}}).sort((Q,kt)=>kt.count-Q.count);y=Vc({container:f(m),title:d(),items:jt.map(Q=>{var kt;return{key:Q.type,label:lt(`type.${Q.type}`)!==`type.${Q.type}`?lt(`type.${Q.type}`):Q.type,color:Xt(Q.type),value:Q.count,visible:((kt=U.find(Vt=>Vt.type===Q.type))==null?void 0:kt.visible)??!0,customProperties:{type:Q.type}}}),type:"html",position:"bottom",orientation:"horizontal",className:"multi-row-legend",showValues:!0,valueFormatter:Q=>K(Q),translateKeys:{itemPrefix:"type."},responsive:!0,breakpoint:768,interactive:!0,onItemClick:Q=>{if(!u)return;const kt=U.findIndex(Vt=>{var $t;return Vt.type===(($t=Q.customProperties)==null?void 0:$t.type)});kt>=0&&(U[kt].visible=!U[kt].visible,U=[...U],S())}}),y.render(),dt.attr("height",z)}catch(A){console.error("Error updating visualization:",A)}}function W(A,x){const L=A.data.year,k=x.map(dt=>{const ot=dt.find(J=>J.data.year===L);return{type:dt.key,count:ot?ot[1]-ot[0]:0}}).filter(dt=>dt.count>0),Z=k.reduce((dt,ot)=>dt+ot.count,0),X=[{label:lt("viz.type"),value:lt("viz.count")+" / %"}];return k.forEach(dt=>{const ot=`type.${dt.type}`;let J=dt.type;const ft=lt(ot);ft!==ot&&(J=ft),X.push({label:J,value:`${K(dt.count)} (${(dt.count/Z*100).toFixed(1)}%)`})}),X.push({label:lt("viz.total_items"),value:K(Z)}),Tn(`${lt("viz.year")}: ${L}`,X)}We(()=>(u=!0,(async()=>{try{if(await zn(),!f(m)){console.error("Container element not found in onMount");return}N=Rr({container:f(m),onResize:()=>{if(u&&f(m)){const{width:A,height:x}=N.dimensions;C=A,z=x,S()}}}),p=xe.subscribe(A=>{u&&(v=A,f(m)&&(O(),console.log("Language changed to",A,"- updating legend with",d()),i().items&&i().items.length>0&&(y&&(y.cleanup(),y=null),nt(),S())))}),g=de.subscribe(A=>{u&&A!=null&&A.items&&A.items.length>0&&(it(),nt(),O(),f(m)&&S())}),i().items&&i().items.length>0?(it(),nt(),O(),S()):de.loadItems()}catch(A){console.error("Error during initialization:",A)}})(),()=>{u=!1,N&&N.cleanup(),g&&(g(),g=null),p&&(p(),p=null),y&&(y.cleanup(),y=null),f(m)&&ht(f(m)).selectAll("*").remove()})),Dn(()=>{u=!1,g&&(g(),g=null),p&&(p(),p=null),y&&(y.cleanup(),y=null),Qt(h,"Component destroyed")}),Me(),Fr(t,{title:"",translationKey:"",description:"This visualization shows the distribution of items by type over time. You can filter by country and year range to explore how different types of items have been published over time.",descriptionTranslationKey:"viz.type_distribution_description",get titleHtml(){return f(V)},className:"word-visualization-compact-header",children:(A,x)=>{var L=qy(),k=I(L),Z=I(k),X=I(Z),dt=I(X),ot=I(dt),J=yt(dt,2);Bn(J,5,()=>f(w),vr,(Ct,j)=>{var st=Oy(),mt=I(st),gt=I(mt);{var ct=Wt=>{var Nt=Hy();rt(Wt,Nt)};Lt(gt,Wt=>{f(j).selected&&Wt(ct)})}var It=yt(mt,2),ae=I(It),St=yt(It,2),Jt=I(St);zt(()=>{ve(st,"aria-checked",f(j).selected),Bl(st,"selected",f(j).selected),ut(ae,f(j).label),ut(Jt,f(j).count)}),_e("click",st,()=>at(f(j))),_e("keydown",st,Wt=>Wt.key==="Enter"&&at(f(j))),rt(Ct,st)});var ft=yt(Z,2),Ft=I(ft),Kt=I(Ft),qt=yt(Ft,2),Xt=I(qt),jt=I(Xt),Q=I(jt),kt=yt(jt,2),Vt=I(kt),$t=yt(Xt,2),bt=I($t),At=yt(bt,2),Mt=yt(k,2),Pt=I(Mt);{var Ut=Ct=>{var j=Uy(),st=I(j);zt(mt=>ut(st,mt),[()=>lt("ui.loading")],ie),rt(Ct,j)},Ht=Ct=>{var j=ue(),st=te(j);{var mt=gt=>{var ct=By(),It=I(ct);zt(()=>ut(It,i().error)),rt(gt,ct)};Lt(st,gt=>{i().error&&gt(mt)},!0)}rt(Ct,j)};Lt(Pt,Ct=>{i().loading?Ct(Ut):Ct(Ht,!1)})}qe(Mt,Ct=>F(m,Ct),()=>f(m)),zt(()=>{ut(ot,l()),ut(Kt,c()),ut(Q,f(_)[0]),ut(Vt,f(_)[1]),ve(bt,"min",f(b)[0]),ve(bt,"max",f(b)[f(b).length-1]),rs(bt,f(_)[0]),ve(At,"min",f(b)[0]),ve(At,"max",f(b)[f(b).length-1]),rs(At,f(_)[1])}),_e("input",bt,H),_e("input",At,H),rt(A,L)},$$slots:{default:!0}}),$e(),r()}var Wy=xt('<p class="my-xs text-sm text-secondary"> <strong class="font-medium"> </strong></p>'),Yy=xt('<p class="my-xs text-sm text-secondary"> <strong class="font-medium"> </strong></p> <p class="my-xs text-sm text-secondary"> </p>',1),Zy=xt('<p class="my-xs text-sm text-secondary"> </p>'),Gy=xt('<div class="p-md bg-card rounded shadow mt-md"><div><h3 class="mt-0 mb-sm text-primary text-md font-medium border-b border-solid border-default pb-xs"> </h3> <p class="my-xs text-sm text-secondary"> <strong class="font-medium"> </strong></p> <p class="my-xs text-sm text-secondary"> <strong class="font-medium"> </strong></p> <!> <!></div></div>');function Ky(t,e){ke(e,!1);const[n,r]=tn(),i=()=>vt(v,"$summaryText",n),o=()=>vt(y,"$totalItemsWithWordCountText",n),a=()=>vt(m,"$totalWordsText",n),s=()=>vt(C,"$avgWordsPerItemText",n),d=()=>vt(z,"$currentlyViewingText",n),l=()=>vt(w,"$clickBackText",n),c=()=>vt(b,"$clickZoomInText",n);let h=Zt(e,"totalItems",8),u=Zt(e,"totalWordCount",8),g=Zt(e,"zoomedNode",8),p=Zt(e,"formatNumber",8);const v=tt("viz.summary"),y=tt("viz.total_items_with_word_count"),m=tt("viz.total_words"),C=tt("viz.avg_words_per_item"),z=tt("viz.currently_viewing"),w=tt("viz.click_back_to_return"),b=tt("viz.click_zoom_in");Me();var _=Gy(),M=I(_),R=I(M),U=I(R),T=yt(R,2),E=I(T),N=yt(E),P=I(N),B=yt(T,2),pt=I(B),$=yt(pt),D=I($),G=yt(B,2);{var et=Y=>{var q=Wy(),nt=I(q),it=yt(nt),at=I(it);zt(H=>{ut(nt,`${s()??""}: `),ut(at,H)},[()=>p()(Math.round(u()/h()))],ie),rt(Y,q)};Lt(G,Y=>{h()>0&&Y(et)})}var V=yt(G,2);{var K=Y=>{var q=Yy(),nt=te(q),it=I(nt),at=yt(it),H=I(at),S=yt(nt,2),W=I(S);zt(()=>{ut(it,`${d()??""}: `),ut(H,g().data.name),ut(W,l())}),rt(Y,q)},O=Y=>{var q=Zy(),nt=I(q);zt(()=>ut(nt,c())),rt(Y,q)};Lt(V,Y=>{g()?Y(K):Y(O,!1)})}zt((Y,q)=>{ut(U,i()),ut(E,`${o()??""}: `),ut(P,Y),ut(pt,`${a()??""}: `),ut(D,q)},[()=>p()(h()),()=>p()(u())],ie),rt(t,_),$e(),r()}class Xy{constructor(e,n={}){le(this,"config");this.config=this.mergeWithDefaults(e,n),this.validate()}mergeWithDefaults(e,n){var i,o,a,s,d,l,c,h,u,g;return{container:e,dimensions:{width:((i=n.dimensions)==null?void 0:i.width)??e.clientWidth,height:((o=n.dimensions)==null?void 0:o.height)??Math.min(e.clientHeight,500),margin:{top:10,right:10,bottom:10,left:10,...(a=n.dimensions)==null?void 0:a.margin}},style:{padding:{outer:3,top:16,inner:1,...(s=n.style)==null?void 0:s.padding},labelOptions:{parentLabel:{fontSize:"var(--font-size-sm)",fontWeight:"bold",color:"white",...(l=(d=n.style)==null?void 0:d.labelOptions)==null?void 0:l.parentLabel},childLabel:{fontSize:"var(--font-size-xs)",color:"var(--color-text-primary)",minWidth:30,minHeight:20,...(h=(c=n.style)==null?void 0:c.labelOptions)==null?void 0:h.childLabel}},colors:(u=n.style)==null?void 0:u.colors,colorMap:(g=n.style)==null?void 0:g.colorMap},navigation:{useBreadcrumbs:!1,rootName:"All",showZoomButton:!0,...n.navigation},behavior:{minSizeThreshold:.001,enableZoom:!0,enableTooltips:!0,responsive:!1,...n.behavior},callbacks:{...n.callbacks},currentZoomedNode:n.currentZoomedNode}}validate(){if(!this.config.container)throw new Error("TreemapConfig: container is required");if(this.config.dimensions.width<=0||this.config.dimensions.height<=0)throw new Error("TreemapConfig: width and height must be positive numbers");if(this.config.behavior.minSizeThreshold<0||this.config.behavior.minSizeThreshold>1)throw new Error("TreemapConfig: minSizeThreshold must be between 0 and 1")}get(){return{...this.config}}update(e){this.config={...this.config,...e},this.validate()}getChartDimensions(){const{width:e,height:n,margin:r}=this.config.dimensions;return{chartWidth:e-r.left-r.right,chartHeight:n-r.top-r.bottom}}getAdjustedMargin(){const{margin:e}=this.config.dimensions,{useBreadcrumbs:n}=this.config.navigation,{currentZoomedNode:r}=this.config;return r&&n?{...e,top:e.top+30}:e}}class Ai{static prepareHierarchy(e,n=0){const r=cn(e).sum(i=>i.value||0).sort((i,o)=>(o.value||0)-(i.value||0));if(r.children&&n>0){const i=r.value||0;r.children=r.children.filter(o=>(o.value||0)/i>=n)}return r}static prepareZoomedHierarchy(e){if(e.data.children&&e.data.children.length>0){const n={name:e.data.name,children:e.data.children};return cn(n).sum(r=>r.value||0).sort((r,i)=>(i.value||0)-(r.value||0))}else if(e.children&&e.children.length>0){const n=e.children.map(i=>({name:i.data.name,value:i.data.value||i.value,wordCount:i.data.wordCount,itemCount:i.data.itemCount})),r={name:e.data.name,children:n};return cn(r).sum(i=>i.value||0).sort((i,o)=>(o.value||0)-(i.value||0))}else return console.warn("Zoomed node has no valid children data"),cn({name:"Empty",children:[]}).sum(n=>n.value||0)}static validateData(e){return e?e.name?!e.children||e.children.length===0?(console.warn("TreemapDataProcessor: No children data found"),!1):e.children.every(r=>r.name&&(r.value!==void 0||r.children))?!0:(console.error("TreemapDataProcessor: Invalid children structure - each child must have a name and either a value or children"),!1):(console.error("TreemapDataProcessor: Root node must have a name"),!1):(console.error("TreemapDataProcessor: No data provided"),!1)}static calculateTotalValue(e){return e.value!==void 0?e.value:e.children&&e.children.length>0?e.children.reduce((n,r)=>n+this.calculateTotalValue(r),0):0}static getLeafNodes(e){return e.leaves()}static getParentNodes(e){return e.children||[]}}class Ya{constructor(e,n,r){le(this,"colorScale");le(this,"colorMap");le(this,"defaultColors");le(this,"parentColorMap");this.colorMap=n||new Map,this.parentColorMap=new Map,this.defaultColors=r||["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],e?this.colorScale=e:this.colorScale=Te().range(this.defaultColors)}initializeFromHierarchy(e){const n=e.children?e.children.map(r=>r.data.name):[e.data.name];this.colorScale.domain(n),this.parentColorMap.clear(),e.children&&e.children.forEach(r=>{if(this.colorMap.has(r.data.name)||this.colorMap.set(r.data.name,this.colorScale(r.data.name)),r.children){const i=this.colorMap.get(r.data.name);r.children.forEach(o=>{this.parentColorMap.set(o.data.name,i)})}})}getColor(e){if(this.colorMap.has(e))return this.colorMap.get(e);const n=this.colorScale(e);return this.colorMap.set(e,n),n}getChildColor(e,n,r=!1){if(this.parentColorMap.has(e)){const i=this.parentColorMap.get(e);return this.createColorVariant(i,e)}if(r&&n){const i=this.getColor(n);return this.createColorVariant(i,e)}return this.getColor(e)}getZoomedChildColor(e,n){return this.createColorVariant(n,e)}createColorVariant(e,n){const r=this.simpleHash(n),i=uc(e);if(!i)return e;const o=.15+r%.3,a=.25+r%.5;return i.s=Math.min(1,Math.max(.2,i.s*o)),i.l=Math.min(.9,Math.max(.1,a)),i.toString()}simpleHash(e){let n=0;for(let r=0;r<e.length;r++){const i=e.charCodeAt(r);n=(n<<5)-n+i,n=n&n}return Math.abs(n)/2147483647}getColorScale(){return this.colorScale}getColorMap(){return new Map(this.colorMap)}setColor(e,n){this.colorMap.set(e,n)}clear(){this.colorMap.clear(),this.parentColorMap.clear()}clone(){const e=new Ya(this.colorScale,new Map(this.colorMap),this.defaultColors);return e.parentColorMap=new Map(this.parentColorMap),e}}class jy{constructor(e,n){le(this,"colorManager");le(this,"labelOptions");this.colorManager=e,this.labelOptions=n}renderParentNodes(e,n,r){const i=e.selectAll(".parent-node").data(n).enter().append("g").attr("class","parent-node").attr("transform",o=>`translate(${o.x0},${o.y0})`);i.append("rect").attr("width",o=>Math.max(0,(o.x1||0)-(o.x0||0))).attr("height",o=>Math.max(0,(o.y1||0)-(o.y0||0))).attr("fill",o=>this.colorManager.getColor(o.data.name)).attr("stroke","white").attr("stroke-width",2).attr("opacity",.7).attr("class","cursor-pointer treemap-rect-modern").on("click",(o,a)=>{r&&r(a)}),this.addParentLabels(i)}renderLeafNodes(e,n,r,i,o){const a=e.selectAll(".leaf-node").data(n).enter().append("g").attr("class","leaf-node").attr("transform",s=>`translate(${s.x0},${s.y0})`);a.append("rect").attr("width",s=>Math.max(0,(s.x1||0)-(s.x0||0))).attr("height",s=>Math.max(0,(s.y1||0)-(s.y0||0))).attr("fill",s=>{var d;if(r)return r;{const l=(d=s.parent)==null?void 0:d.data.name;return l?this.colorManager.getColor(l):this.colorManager.getColor(s.data.name)}}).attr("stroke","white").attr("stroke-width",.5).attr("class","cursor-pointer treemap-rect-modern").on("mouseover",(s,d)=>{i&&i(s,d)}).on("mousemove",(s,d)=>{i&&i(s,d)}).on("mouseout",()=>{o&&o()}),this.addChildLabels(a)}addParentLabels(e){e.append("text").attr("x",5).attr("y",15).attr("font-size",this.labelOptions.parentLabel.fontSize).attr("font-weight",this.labelOptions.parentLabel.fontWeight).attr("fill",this.labelOptions.parentLabel.color).attr("class","treemap-text").text(n=>{const r=Math.max(0,(n.x1||0)-(n.x0||0))-10;return this.truncateText(n.data.name,r,this.labelOptions.parentLabel.fontSize)}).attr("pointer-events","none").each(function(n){const r=Math.max(0,(n.x1||0)-(n.x0||0)),i=Math.max(0,(n.y1||0)-(n.y0||0));(r<50||i<20)&&ht(this).style("display","none")})}addChildLabels(e){e.append("text").attr("x",3).attr("y",13).attr("font-size",this.labelOptions.childLabel.fontSize).attr("fill",this.labelOptions.childLabel.color).attr("class","treemap-text").attr("pointer-events","none").each(function(n){var l,c;const r=Math.max(0,(n.x1||0)-(n.x0||0)),i=Math.max(0,(n.y1||0)-(n.y0||0));if(r<30||i<20){ht(this).style("display","none");return}const o=r-6,a=ht(this);let s=n.data.name;a.text(s);let d=((l=a.node())==null?void 0:l.getComputedTextLength())||0;for(;d>o&&s.length>3;)s=s.slice(0,-1),a.text(s+"..."),d=((c=a.node())==null?void 0:c.getComputedTextLength())||0})}truncateText(e,n,r){const i=this.getAverageCharWidth(r),o=Math.floor(n/i);return e.length<=o?e:e.slice(0,Math.max(1,o-3))+"..."}getAverageCharWidth(e){const n=e.match(/(\d+)/);return(n?parseInt(n[1]):12)*.6}updateLabelOptions(e){this.labelOptions=e}updateColorManager(e){this.colorManager=e}}class Jy{constructor(e,n){le(this,"config");le(this,"currentZoomedNode",null);le(this,"onZoomCallback");this.config=e,this.onZoomCallback=n}setZoomCallback(e){this.onZoomCallback=e}setCurrentNode(e){this.currentZoomedNode=e}getCurrentNode(){return this.currentZoomedNode}zoomToNode(e){this.currentZoomedNode=e,this.onZoomCallback&&this.onZoomCallback(e)}zoomOut(){this.zoomToNode(null)}isZoomedIn(){return this.currentZoomedNode!==null}addZoomOutButton(e,n){if(!this.config.showZoomButton||!this.currentZoomedNode)return;const r=e.append("g").attr("class","zoom-out-button cursor-pointer").attr("transform",`translate(${n.left}, ${n.top})`).on("click",()=>this.zoomOut());r.append("rect").attr("width",100).attr("height",24).attr("rx",4).attr("fill","var(--primary-color)").attr("opacity",.8),r.append("text").attr("x",50).attr("y",16).attr("text-anchor","middle").attr("fill","white").attr("font-size","var(--font-size-sm)").text("Back to All")}addBreadcrumbNavigation(e,n){var d,l;if(!this.config.useBreadcrumbs||!this.currentZoomedNode)return;const r=30,i=((d=e.node())==null?void 0:d.getBoundingClientRect().width)||300;e.append("rect").attr("x",0).attr("y",0).attr("width",i).attr("height",r).attr("fill","white").attr("opacity",.9);const o=e.append("g").attr("class","breadcrumb-navigation").attr("transform",`translate(${n.left+10}, ${n.top+10})`),s=((l=o.append("text").attr("x",0).attr("y",5).attr("font-size","var(--font-size-sm)").attr("fill","var(--primary-color)").attr("class","cursor-pointer").text(this.config.rootName).on("click",()=>this.zoomOut()).node())==null?void 0:l.getComputedTextLength())||20;o.append("line").attr("x1",0).attr("y1",22).attr("x2",s).attr("y2",22).attr("stroke","var(--primary-color)").attr("stroke-width",1),o.append("text").attr("x",s+8).attr("y",5).attr("font-size","var(--font-size-sm)").attr("fill","var(--color-text-secondary)").text("/"),o.append("text").attr("x",s+20).attr("y",5).attr("font-size","var(--font-size-sm)").attr("font-weight","bold").attr("fill","var(--color-text-primary)").text(this.currentZoomedNode.data.name)}addNavigation(e,n){this.config.useBreadcrumbs?this.addBreadcrumbNavigation(e,n):this.config.showZoomButton&&this.addZoomOutButton(e,n)}updateConfig(e){this.config={...this.config,...e}}getNavigationPath(){if(!this.currentZoomedNode)return[this.config.rootName];const e=[this.config.rootName];return e.push(this.currentZoomedNode.data.name),e}shouldAdjustMargins(){return this.isZoomedIn()&&this.config.useBreadcrumbs}}class Qy{constructor(e,n={}){le(this,"config");le(this,"dataProcessor");le(this,"colorManager");le(this,"nodeRenderer");le(this,"navigator");le(this,"svg",null);le(this,"chart",null);var r,i;this.config=new Xy(e,n),this.dataProcessor=new Ai,this.colorManager=new Ya((r=n.style)==null?void 0:r.colors,(i=n.style)==null?void 0:i.colorMap),this.nodeRenderer=new jy(this.colorManager,this.config.get().style.labelOptions),this.navigator=new Jy(this.config.get().navigation,this.handleZoom.bind(this))}render(e){try{const n=this.config.get();if(!Ai.validateData(e))return this.handleNoData("Invalid data structure"),{svg:null,chart:null};this.clearContainer(),this.setupContainer();const r=this.prepareHierarchy(e);return r?(this.colorManager.initializeFromHierarchy(r),this.createSVG(r),this.applyTreemapLayout(r),this.renderNodes(r),this.addNavigation(),{svg:this.svg,chart:this.chart}):(this.handleNoData("No data to display"),{svg:null,chart:null})}catch(n){return console.error("Error creating treemap:",n),this.handleError("Error creating treemap"),{svg:null,chart:null}}}zoomToNode(e){this.navigator.zoomToNode(e),this.config.update({currentZoomedNode:e})}updateConfig(e){this.config.update(e);const n=this.config.get();this.nodeRenderer.updateLabelOptions(n.style.labelOptions),this.navigator.updateConfig(n.navigation)}getConfig(){return this.config.get()}destroy(){this.svg&&this.svg.remove(),this.svg=null,this.chart=null}clearContainer(){const e=this.config.get();ht(e.container).select("svg").remove(),ht(e.container).select(".absolute").remove()}setupContainer(){const e=this.config.get(),{height:n}=e.dimensions;e.container.style.height=`${n}px`,e.container.style.maxHeight=`${n}px`,e.container.style.overflow="hidden"}prepareHierarchy(e){const n=this.config.get();return n.currentZoomedNode?Ai.prepareZoomedHierarchy(n.currentZoomedNode):Ai.prepareHierarchy(e,n.behavior.minSizeThreshold)}createSVG(e){const n=this.config.get(),{width:r,height:i}=n.dimensions,o=this.config.getAdjustedMargin(),a=pe.createSVG({container:n.container,width:r,height:i,margin:o,responsive:n.behavior.responsive});this.svg=a.svg,this.chart=a.chart,this.svg.attr("height",i).attr("viewBox",`0 0 ${r} ${i}`).style("height",`${i}px`).style("max-height",`${i}px`).style("overflow","hidden").on("mouseout",s=>{var d,l;if(s.relatedTarget&&!((l=(d=this.svg)==null?void 0:d.node())!=null&&l.contains(s.relatedTarget))){const c=this.config.get();c.callbacks.onTooltipHide&&c.callbacks.onTooltipHide()}})}applyTreemapLayout(e){const n=this.config.get(),{chartWidth:r,chartHeight:i}=this.config.getChartDimensions(),{padding:o}=n.style,a=Mc().size([r,i]).paddingOuter(o.outer).paddingTop(o.top).paddingInner(o.inner).round(!0);try{a(e)}catch(s){throw console.error("Error applying treemap layout:",s),new Error("Failed to apply treemap layout")}}renderNodes(e){if(!this.chart)return;const n=this.config.get(),r=n.currentZoomedNode;if(r){const i=this.colorManager.getColor(r.data.name);this.nodeRenderer.renderLeafNodes(this.chart,e.children||[],i,n.callbacks.onTooltipShow,n.callbacks.onTooltipHide)}else this.nodeRenderer.renderParentNodes(this.chart,e.children||[],i=>this.handleNodeClick(i)),this.nodeRenderer.renderLeafNodes(this.chart,e.leaves(),void 0,n.callbacks.onTooltipShow,n.callbacks.onTooltipHide)}addNavigation(){if(!this.svg)return;const e=this.config.get(),n=this.config.getAdjustedMargin();this.navigator.setCurrentNode(e.currentZoomedNode||null),this.navigator.addNavigation(this.svg,n)}handleNodeClick(e){this.config.get().behavior.enableZoom&&this.zoomToNode(e)}handleZoom(e){const n=this.config.get();n.callbacks.onZoom&&n.callbacks.onZoom(e)}handleNoData(e){const n=this.config.get();pe.handleNoData(n.container,e)}handleError(e){const n=this.config.get();pe.handleNoData(n.container,e)}}function t_(t){if(!t||t.length===0)return{name:"root",children:[]};const e=t.filter(i=>i.word_count!==void 0&&i.word_count>0&&i.country),n=new Map;e.forEach(i=>{const o=i.country||"Unknown",a=i.item_set_title||"No Set",s=i.word_count||0;n.has(o)||n.set(o,{words:0,items:0,sets:new Map});const d=n.get(o);d.words+=s,d.items+=1,d.sets.has(a)||d.sets.set(a,{words:0,items:0});const l=d.sets.get(a);l.words+=s,l.items+=1});const r={name:"Word Distribution",children:Array.from(n.entries()).map(([i,o])=>({name:i,wordCount:o.words,itemCount:o.items,children:Array.from(o.sets.entries()).map(([a,s])=>({name:a,value:s.words,wordCount:s.words,itemCount:s.items}))}))};return r.children&&(r.children.sort((i,o)=>(o.wordCount||0)-(i.wordCount||0)),r.children.forEach(i=>{i.children&&i.children.sort((o,a)=>(a.wordCount||0)-(o.wordCount||0))})),r}var e_=xt('<div class="absolute inset-center text-secondary"> </div>'),n_=xt('<div class="absolute inset-center text-error"> </div>'),r_=xt('<div class="flex-1 min-h-500 relative overflow-hidden bg-card rounded shadow chart-modern" style="height: 500px; max-height: 500px;"><!></div> <!>',1),i_=xt('<div class="w-full h-full flex flex-col gap-md"><!></div>');function o_(t,e){ke(e,!1);const[n,r]=tn(),i=()=>vt(D,"$wordsText",n),o=()=>vt(de,"$itemsStore",n),a=()=>vt(G,"$itemsText",n),s=()=>vt($,"$avgWordsPerItemText",n),d=()=>vt(et,"$percentOfCountryText",n),l=()=>vt(V,"$percentOfTotalText",n),c=()=>vt(pt,"$noDataText",n),h="WordDistributionRefactored";let u=!1,g,p=_t(),v=0,y=0,m=_t(0),C=_t(0),z={name:"root",children:[]},w=_t(null),b=0,_=_t(""),M="en",R=new Map,U=null;const T=qn("professional"),E=Te().range(T),{showTooltip:N,hideTooltip:P}=Eo({maxWidth:"250px"});let B;const pt=tt("viz.no_data");tt("viz.word_distribution"),tt("viz.total_words");const $=tt("viz.avg_words_per_item");tt("viz.click_zoom_in"),tt("viz.click_zoom_out"),tt("viz.unknown"),tt("viz.no_set"),tt("viz.back_to_all"),tt("viz.total_items_with_word_count");const D=tt("viz.words"),G=tt("viz.items"),et=tt("viz.percent_of_country"),V=tt("viz.percent_of_total");tt("viz.item_set_summary");const{filterItems:K}=Je({filterMissingValues:!0,requiredFields:["word_count","country"],filterFn:x=>!!(x.word_count!==void 0&&x.word_count>0&&x.country)});function O(x){return x.toLocaleString(M==="fr"?"fr-FR":"en-US")}function Y(){f(C)>0?M==="en"?F(_,`Distribution of ${O(f(m))} ${i()} by country and sub-collection`):F(_,`Répartition de ${O(f(m))} ${i()} par pays et sous-collection`):F(_,lt("viz.word_distribution"))}function q(){f(w)&&(M==="en"?F(_,`${f(w).data.name}: ${O(f(w).data.wordCount||0)} ${i()}`):F(_,`${f(w).data.name}: ${O(f(w).data.wordCount||0)} ${i()}`))}function nt(){var L,k;if(!o().items||o().items.length===0)return F(C,0),F(m,0),Y(),{name:"root",children:[]};const x=t_(o().items);return x.children&&x.children.forEach((Z,X)=>{if(!R.has(Z.name)){const dt=X%T.length;R.set(Z.name,T[dt])}}),F(C,((L=x.children)==null?void 0:L.reduce((Z,X)=>Z+(X.itemCount||0),0))||0),F(m,((k=x.children)==null?void 0:k.reduce((Z,X)=>Z+(X.wordCount||0),0))||0),b=f(m),Y(),x}function it(x){if(F(w,x),f(w))F(C,f(w).data.itemCount||0),F(m,f(w).data.wordCount||0),q();else{if(o().items&&o().items.length>0){const L=K(o().items);F(C,L.length),F(m,L.reduce((k,Z)=>k+(Z.word_count||0),0))}Y()}H()}function at(x,L){try{if(!x){Qt(h,"Event object is undefined in handleShowTooltip");return}const k=L.parent?L.parent.data.name:L.data.name,Z=L.parent?L.data.name:"All",X=L.data.wordCount||0,dt=L.data.itemCount||0,ot=dt>0?Math.round(X/dt):0,J=f(w)?f(w).data.wordCount:L.parent?L.parent.data.wordCount:0,ft=J&&J>0?(X/J*100).toFixed(1)+"%":"N/A",Ft=b>0?(X/b*100).toFixed(1)+"%":"N/A",Kt=Tn(`${k} > ${Z}`,[{label:i(),value:X.toLocaleString()},{label:a(),value:dt},{label:s(),value:ot},{label:d(),value:ft},{label:l(),value:Ft}]);N(x,Kt,250,150),Qt(h,"Tooltip shown",{country:k,itemSet:Z})}catch(k){console.error("Error showing tooltip:",k),Qt(h,"Error showing tooltip",k)}}function H(x=z){var L;try{if(!f(p)){console.error("Container element not found");return}if(!x.children||x.children.length===0){ht(f(p)).select("svg").remove(),ht(f(p)).append("div").attr("class","absolute inset-center text-secondary").text(c());return}if(U)U.updateConfig({callbacks:{onTooltipShow:at,onTooltipHide:P,onZoom:k=>{it(k)}},currentZoomedNode:f(w),style:{colors:E,colorMap:R,padding:{outer:3,top:16,inner:1},labelOptions:{parentLabel:{fontSize:"var(--font-size-sm)",fontWeight:"bold",color:"white"},childLabel:{fontSize:"var(--font-size-xs)",color:"var(--color-text-primary)",minWidth:30,minHeight:20}}},navigation:{useBreadcrumbs:!0,rootName:M==="en"?"All":"Tous",showZoomButton:!0}});else{const k={container:f(p),dimensions:{width:f(p).clientWidth,height:500,margin:{top:10,right:10,bottom:10,left:10}},style:{colors:E,padding:{outer:3,top:16,inner:1},labelOptions:{parentLabel:{fontSize:"var(--font-size-sm)",fontWeight:"bold",color:"white"},childLabel:{fontSize:"var(--font-size-xs)",color:"var(--color-text-primary)",minWidth:30,minHeight:20}},colorMap:R},navigation:{useBreadcrumbs:!0,rootName:M==="en"?"All":"Tous",showZoomButton:!0},behavior:{minSizeThreshold:.001,enableZoom:!0,enableTooltips:!0,responsive:!1},callbacks:{onTooltipShow:at,onTooltipHide:P,onZoom:Z=>{it(Z)}},currentZoomedNode:f(w)};U=new Qy(f(p),k)}U.render(x),Qt(h,"Visualization updated successfully",{itemCount:((L=x.children)==null?void 0:L.length)||0,isZoomed:!!f(w)})}catch(k){console.error("Error in updateVisualization:",k)}}function S(x){!u||!f(p)||(Qt(h,"Items store changed",{itemCount:(x==null?void 0:x.length)||0}),document.body.contains(f(p))&&(f(w)||(z=nt(),H(z))))}We(()=>{try{u=!0,Qt(h,"Component mounted");const L=(async()=>{if(await zn(),!f(p))return console.error("Container element not found in onMount"),()=>{};B=Rr({container:f(p),onResize:()=>{if(u&&f(p)){const{width:Z}=B.dimensions;v=Z,y=500,H()}},debounce:!0,debounceDelay:300}),v=f(p).clientWidth,y=Math.min(f(p).clientHeight,500);const k=xe.subscribe(Z=>{u&&(M=Z,f(w)?q():Y(),f(p)&&document.body.contains(f(p))&&H())});return g=de.subscribe(Z=>{S(Z.items)}),o().items&&o().items.length>0?(z=nt(),H(z)):de.loadItems(),()=>{try{u=!1,Qt(h,"Component cleanup started"),U&&(U.destroy(),U=null,Qt(h,"Treemap visualization cleaned up")),f(p)&&(ht(f(p)).selectAll("*").remove(),Qt(h,"D3 selections removed")),B&&(B.cleanup(),Qt(h,"Resize hook cleaned up")),g&&(g(),Qt(h,"Unsubscribed from items store")),k&&(k(),Qt(h,"Unsubscribed from language store")),Qt(h,"Component cleanup completed")}catch(Z){console.error("Error during cleanup:",Z)}}})();return()=>{L.then(k=>k())}}catch(x){return console.error("Error in onMount:",x),()=>{}}}),Dn(()=>{if(u){u=!1,Qt(h,"Component destroyed (backup cleanup)");try{U&&(U.destroy(),U=null,Qt(h,"Treemap visualization cleaned up (backup)")),B&&(B.cleanup(),Qt(h,"Resize hook cleaned up (backup)")),g&&(g(),Qt(h,"Unsubscribed from items store (backup)"))}catch(x){console.error("Error during backup cleanup:",x)}}}),Me();var W=i_(),A=I(W);Fr(A,{title:"",translationKey:"",description:"This visualization shows the distribution of words across items by country and collection. The size of each block represents the word count in that country or collection.",descriptionTranslationKey:"viz.word_distribution_description",get titleHtml(){return f(_)},className:"word-visualization-compact-header",children:(x,L)=>{var k=r_(),Z=te(k),X=I(Z);{var dt=ft=>{var Ft=e_(),Kt=I(Ft);zt(qt=>ut(Kt,qt),[()=>lt("ui.loading")],ie),rt(ft,Ft)},ot=ft=>{var Ft=ue(),Kt=te(Ft);{var qt=Xt=>{var jt=n_(),Q=I(jt);zt(()=>ut(Q,o().error)),rt(Xt,jt)};Lt(Kt,Xt=>{o().error&&Xt(qt)},!0)}rt(ft,Ft)};Lt(X,ft=>{o().loading?ft(dt):ft(ot,!1)})}qe(Z,ft=>F(p,ft),()=>f(p));var J=yt(Z,2);Ky(J,{get totalItems(){return f(C)},get totalWordCount(){return f(m)},get zoomedNode(){return f(w)},formatNumber:O}),rt(x,k)},$$slots:{default:!0}}),rt(t,W),$e(),r()}function a_(t,e,n){const r=new URL(window.location.href);return r.searchParams.set("lang",t),r.searchParams.set("tab",e),r.toString()}function s_(){if(typeof window>"u")return{lang:null,tab:null};const t=new URLSearchParams(window.location.search),e=t.get("lang"),n=t.get("tab");return{lang:e==="en"||e==="fr"?e:null,tab:n}}function sl(t,e){if(typeof window>"u")return;const n=a_(t,e);window.history.pushState({},"",n)}var l_=xt('<li role="tab" tabindex="0"> </li>'),c_=xt('<div class="flex justify-center items-center text-lg h-full"> </div>'),u_=xt('<div class="flex justify-center items-center text-lg text-error h-full"> </div>'),f_=xt('<main class="container mx-auto p-md svelte-11fq0ez"><header class="mb-lg svelte-11fq0ez"><div class="flex justify-between items-center mb-md header-top svelte-11fq0ez"><h1 class="m-0 text-2xl font-bold text-primary header-title svelte-11fq0ez"><!></h1> <div class="flex gap-md items-center header-actions svelte-11fq0ez"><!> <!> <!></div></div> <nav><ul class="flex p-0 m-0 border-b border-solid border-default list-style-none app-tabs tabs-container svelte-11fq0ez"><div class="tab-scroll-left-indicator svelte-11fq0ez"></div> <div class="tab-scroll-indicator svelte-11fq0ez"></div> <!></ul></nav></header> <div class="bg-card rounded shadow p-md min-h-500"><!></div></main> <!>',1);function d_(t,e){ke(e,!1);const[n,r]=tn(),i=()=>vt(xe,"$languageStore",n),o=()=>vt(de,"$itemsStore",n),a=()=>vt(p,"$appTitle",n),s=_t(),d="App";let l=_t(!1),c=0,h=()=>{},u=0,g=_t();const p=tt("app.title");let v=_t("countries");const y=[{id:"countries",label:"tab.countries"},{id:"types",label:"tab.types"},{id:"words",label:"tab.words"},{id:"languages",label:"tab.languages"},{id:"categories",label:"tab.categories"},{id:"timeline",label:"tab.timeline"}];let m="",C="";function z(){if(typeof window>"u")return;const{lang:T,tab:E}=s_();Qt(d,`URL parameters: lang=${T}, tab=${E}`),T&&(xe.setLanguage(T),Qt(d,`Setting language from URL: ${T}`)),E&&y.some(N=>N.id===E)&&(F(v,E),Qt(d,`Setting tab from URL: ${E}`))}function w(){if(!f(g))return;f(g).scrollWidth>f(g).clientWidth?f(g).classList.add("tab-scroll-active"):f(g).classList.remove("tab-scroll-active")}function b(){if(!f(g))return;const T=f(g).querySelector(".tab-item.active");if(!T)return;const E=f(g).getBoundingClientRect(),N=T.getBoundingClientRect(),P=N.right<=E.right,B=N.left>=E.left;if(P){if(!B)try{T.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})}catch{qo(g,f(g).scrollLeft+=N.left-E.left-16)}}else try{T.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})}catch{qo(g,f(g).scrollLeft+=N.right-E.right+16)}}function _(T){F(v,T),m&&sl(m,T),setTimeout(()=>{b()},50)}function M(T){var E;if(!f(l)){Qt(d,`Language change ignored (not mounted): ${T}`);return}C=m,m=T,sl(T,f(v)),F(s,y.map(N=>({...N,translatedLabel:lt(N.label)}))),Qt(d,`Language changed from ${C} to ${T}`,{isMounted:f(l),updateCount:c,subscriptionActive:!!h}),Qt(d,"Current translations:",{title:lt("app.title"),loading:lt("ui.loading"),activeTab:lt(((E=y.find(N=>N.id===f(v)))==null?void 0:E.label)||"")}),setTimeout(()=>{w(),b()},100)}Cf(()=>{u++,Qt(d,`Before update (render #${u})`,{isMounted:f(l),currentLanguage:m,activeTab:f(v)})}),We(()=>{try{F(l,!0),z(),Qt(d,`Component mounted, initial language: ${i()}`,{storeValue:i(),activeTab:f(v)}),m=i(),F(s,y.map(T=>({...T,translatedLabel:lt(T.label)})));try{h=xe.subscribe(E=>{M(E)}),Qt(d,"Successfully subscribed to language store")}catch(T){Qt(d,`Error subscribing to language store: ${T}`)}if((!o().items||o().items.length===0)&&de.loadItems(),f(g)){if(w(),navigator.userAgent.toLowerCase().indexOf("firefox")>-1){const T=document.createElement("style");T.textContent=".tabs-container { scrollbar-width: none; }",T.setAttribute("data-firefox-scrollbar","true"),document.head.appendChild(T)}f(g).addEventListener("scroll",R),f(g).dispatchEvent(new Event("scroll")),window.addEventListener("resize",U),setTimeout(()=>{b()},100)}}catch(T){console.error("[App] Error in onMount:",T)}}),Dn(()=>{try{if(h&&h(),F(l,!1),Qt(d,"Component unmounted"),f(g)){f(g).removeEventListener("scroll",R);const T=document.querySelector("style[data-firefox-scrollbar]");T&&T.remove()}window.removeEventListener("resize",U)}catch(T){console.error("[App] Error in onDestroy:",T)}}),kf(()=>{c++,Qt(d,`Component updated (${c})`,{isMounted:f(l),currentLanguage:m,storeValue:i(),activeTab:f(v)}),setTimeout(()=>{w()},50)});function R(){if(!f(g))return;const T=f(g).scrollLeft+f(g).clientWidth>=f(g).scrollWidth-5,E=f(g).scrollLeft<=5;T?f(g).classList.remove("tab-scroll-active"):f(g).classList.add("tab-scroll-active"),E?f(g).classList.remove("tab-scroll-not-at-start"):f(g).classList.add("tab-scroll-not-at-start")}function U(){w(),b()}me(()=>lt,()=>{F(s,y.map(T=>({...T,translatedLabel:lt(T.label)})))}),me(()=>(i(),f(l),lt),()=>{i()&&f(l)&&F(s,y.map(T=>({...T,translatedLabel:lt(T.label)})))}),pi(),Me(),Pf(t,{children:(T,E)=>{var N=f_(),P=te(N),B=I(P),pt=I(B),$=I(pt),D=I($);Ol(D,a);var G=yt($,2),et=I(G);Rf(et,{});var V=yt(et,2);Lf(V,{});var K=yt(V,2);Ef(K,{});var O=yt(pt,2),Y=I(O),q=yt(I(Y),4);Bn(q,1,()=>f(s),vr,(W,A)=>{var x=l_(),L=I(x);zt(()=>{yr(x,`py-sm px-md cursor-pointer transition-colors tab-item tab-flexible tabs-mobile ${(f(v)===f(A).id?"active":"")??""} svelte-11fq0ez`),ve(x,"aria-selected",f(v)===f(A).id),ut(L,f(A).translatedLabel)}),_e("click",x,()=>_(f(A).id)),_e("keydown",x,k=>k.key==="Enter"&&_(f(A).id)),rt(W,x)}),qe(Y,W=>F(g,W),()=>f(g));var nt=yt(B,2),it=I(nt);{var at=W=>{var A=c_(),x=I(A);zt(L=>ut(x,L),[()=>lt("ui.loading")],ie),rt(W,A)},H=W=>{var A=ue(),x=te(A);{var L=Z=>{var X=u_(),dt=I(X);zt(()=>ut(dt,o().error)),rt(Z,X)},k=Z=>{var X=ue(),dt=te(X);{var ot=ft=>{B0(ft,{})},J=ft=>{var Ft=ue(),Kt=te(Ft);{var qt=jt=>{Vy(jt,{})},Xt=jt=>{var Q=ue(),kt=te(Q);{var Vt=bt=>{o_(bt,{})},$t=bt=>{var At=ue(),Mt=te(At);{var Pt=Ht=>{dy(Ht,{})},Ut=Ht=>{var Ct=ue(),j=te(Ct);{var st=gt=>{yy(gt,{})},mt=gt=>{var ct=ue(),It=te(ct);{var ae=St=>{Ny(St,{})};Lt(It,St=>{f(v)==="timeline"&&St(ae)},!0)}rt(gt,ct)};Lt(j,gt=>{f(v)==="categories"?gt(st):gt(mt,!1)},!0)}rt(Ht,Ct)};Lt(Mt,Ht=>{f(v)==="languages"?Ht(Pt):Ht(Ut,!1)},!0)}rt(bt,At)};Lt(kt,bt=>{f(v)==="words"?bt(Vt):bt($t,!1)},!0)}rt(jt,Q)};Lt(Kt,jt=>{f(v)==="types"?jt(qt):jt(Xt,!1)},!0)}rt(ft,Ft)};Lt(dt,ft=>{f(v)==="countries"?ft(ot):ft(J,!1)})}rt(Z,X)};Lt(x,Z=>{o().error?Z(L):Z(k,!1)},!0)}rt(W,A)};Lt(it,W=>{o().loading?W(at):W(H,!1)})}var S=yt(P,2);Lt(S,W=>{}),rt(T,N)},$$slots:{default:!0}}),$e(),r()}of(d_,{target:document.getElementById("app")});
