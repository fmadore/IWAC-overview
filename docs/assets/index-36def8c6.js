(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();function xt(){}const ts=t=>t;function es(t,e){for(const n in e)t[n]=e[n];return t}function Xo(t){return t()}function yi(){return Object.create(null)}function Ut(t){t.forEach(Xo)}function fr(t){return typeof t=="function"}function Xt(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function ns(t){return Object.keys(t).length===0}function Xr(t,...e){if(t==null)return xt;const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function rs(t){let e;return Xr(t,n=>e=n)(),e}function yt(t,e,n){t.$$.on_destroy.push(Xr(e,n))}function jo(t,e,n,r){if(t){const i=Ko(t,e,n,r);return t[0](i)}}function Ko(t,e,n,r){return t[1]&&r?es(n.ctx.slice(),t[1](r(e))):n.ctx}function Go(t,e,n,r){if(t[2]&&r){const i=t[2](r(n));if(e.dirty===void 0)return i;if(typeof i=="object"){const o=[],l=Math.max(e.dirty.length,i.length);for(let s=0;s<l;s+=1)o[s]=e.dirty[s]|i[s];return o}return e.dirty|i}return e.dirty}function Zo(t,e,n,r,i,o){if(i){const l=Ko(e,n,r,o);t.p(l,i)}}function Jo(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let r=0;r<n;r++)e[r]=-1;return e}return-1}const Qo=typeof window<"u";let is=Qo?()=>window.performance.now():()=>Date.now(),jr=Qo?t=>requestAnimationFrame(t):xt;const Pe=new Set;function tl(t){Pe.forEach(e=>{e.c(t)||(Pe.delete(e),e.f())}),Pe.size!==0&&jr(tl)}function os(t){let e;return Pe.size===0&&jr(tl),{promise:new Promise(n=>{Pe.add(e={c:t,f:n})}),abort(){Pe.delete(e)}}}function p(t,e){t.appendChild(e)}function el(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function ls(t){const e=z("style");return ss(el(t),e),e.sheet}function ss(t,e){return p(t.head||t,e),e.sheet}function J(t,e,n){t.insertBefore(e,n||null)}function Z(t){t.parentNode&&t.parentNode.removeChild(t)}function Ce(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function z(t){return document.createElement(t)}function mn(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function L(t){return document.createTextNode(t)}function rt(){return L(" ")}function nl(){return L("")}function St(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function y(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function as(t){return Array.from(t.childNodes)}function et(t,e){e=""+e,t.data!==e&&(t.data=e)}function Nn(t,e){t.value=e??""}function ve(t,e,n){for(let r=0;r<t.options.length;r+=1){const i=t.options[r];if(i.__value===e){i.selected=!0;return}}(!n||e!==void 0)&&(t.selectedIndex=-1)}function vi(t){const e=t.querySelector(":checked");return e&&e.__value}function oe(t,e,n){t.classList[n?"add":"remove"](e)}function us(t,e,{bubbles:n=!1,cancelable:r=!1}={}){const i=document.createEvent("CustomEvent");return i.initCustomEvent(t,n,r,e),i}class cs{constructor(e=!1){this.is_svg=!1,this.is_svg=e,this.e=this.n=null}c(e){this.h(e)}m(e,n,r=null){this.e||(this.is_svg?this.e=mn(n.nodeName):this.e=z(n.nodeType===11?"TEMPLATE":n.nodeName),this.t=n.tagName!=="TEMPLATE"?n:n.content,this.c(e)),this.i(r)}h(e){this.e.innerHTML=e,this.n=Array.from(this.e.nodeName==="TEMPLATE"?this.e.content.childNodes:this.e.childNodes)}i(e){for(let n=0;n<this.n.length;n+=1)J(this.t,this.n[n],e)}p(e){this.d(),this.h(e),this.i(this.a)}d(){this.n.forEach(Z)}}const qn=new Map;let Vn=0;function fs(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}function ds(t,e){const n={stylesheet:ls(e),rules:{}};return qn.set(t,n),n}function _i(t,e,n,r,i,o,l,s=0){const c=16.666/r;let a=`{
`;for(let b=0;b<=1;b+=c){const T=e+(n-e)*o(b);a+=b*100+`%{${l(T,1-T)}}
`}const u=a+`100% {${l(n,1-n)}}
}`,d=`__svelte_${fs(u)}_${s}`,f=el(t),{stylesheet:h,rules:g}=qn.get(f)||ds(f,t);g[d]||(g[d]=!0,h.insertRule(`@keyframes ${d} ${u}`,h.cssRules.length));const x=t.style.animation||"";return t.style.animation=`${x?`${x}, `:""}${d} ${r}ms linear ${i}ms 1 both`,Vn+=1,d}function hs(t,e){const n=(t.style.animation||"").split(", "),r=n.filter(e?o=>o.indexOf(e)<0:o=>o.indexOf("__svelte")===-1),i=n.length-r.length;i&&(t.style.animation=r.join(", "),Vn-=i,Vn||ps())}function ps(){jr(()=>{Vn||(qn.forEach(t=>{const{ownerNode:e}=t.stylesheet;e&&Z(e)}),qn.clear())})}let yn;function gn(t){yn=t}function Tn(){if(!yn)throw new Error("Function called outside component initialization");return yn}function rl(t){Tn().$$.before_update.push(t)}function me(t){Tn().$$.on_mount.push(t)}function il(t){Tn().$$.after_update.push(t)}function Cn(t){Tn().$$.on_destroy.push(t)}function gs(t,e){return Tn().$$.context.set(t,e),e}const Fe=[],de=[];let Be=[];const Dr=[],ol=Promise.resolve();let Nr=!1;function ll(){Nr||(Nr=!0,ol.then(sl))}function ze(){return ll(),ol}function Me(t){Be.push(t)}function ms(t){Dr.push(t)}const vr=new Set;let Ie=0;function sl(){if(Ie!==0)return;const t=yn;do{try{for(;Ie<Fe.length;){const e=Fe[Ie];Ie++,gn(e),ys(e.$$)}}catch(e){throw Fe.length=0,Ie=0,e}for(gn(null),Fe.length=0,Ie=0;de.length;)de.pop()();for(let e=0;e<Be.length;e+=1){const n=Be[e];vr.has(n)||(vr.add(n),n())}Be.length=0}while(Fe.length);for(;Dr.length;)Dr.pop()();Nr=!1,vr.clear(),gn(t)}function ys(t){if(t.fragment!==null){t.update(),Ut(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Me)}}function vs(t){const e=[],n=[];Be.forEach(r=>t.indexOf(r)===-1?e.push(r):n.push(r)),n.forEach(r=>r()),Be=e}let rn;function _s(){return rn||(rn=Promise.resolve(),rn.then(()=>{rn=null})),rn}function _r(t,e,n){t.dispatchEvent(us(`${e?"intro":"outro"}${n}`))}const Hn=new Set;let ue;function Kr(){ue={r:0,c:[],p:ue}}function Gr(){ue.r||Ut(ue.c),ue=ue.p}function At(t,e){t&&t.i&&(Hn.delete(t),t.i(e))}function $t(t,e,n,r){if(t&&t.o){if(Hn.has(t))return;Hn.add(t),ue.c.push(()=>{Hn.delete(t),r&&(n&&t.d(1),r())}),t.o(e)}else r&&r()}const bs={duration:0};function bi(t,e,n,r){const i={direction:"both"};let o=e(t,n,i),l=r?0:1,s=null,c=null,a=null;function u(){a&&hs(t,a)}function d(h,g){const x=h.b-l;return g*=Math.abs(x),{a:l,b:h.b,d:x,duration:g,start:h.start,end:h.start+g,group:h.group}}function f(h){const{delay:g=0,duration:x=300,easing:b=ts,tick:T=xt,css:w}=o||bs,m={start:is()+g,b:h};h||(m.group=ue,ue.r+=1),s||c?c=m:(w&&(u(),a=_i(t,l,h,x,g,b,w)),h&&T(0,1),s=d(m,x),Me(()=>_r(t,h,"start")),os(v=>{if(c&&v>c.start&&(s=d(c,x),c=null,_r(t,s.b,"start"),w&&(u(),a=_i(t,l,s.b,s.duration,0,b,o.css))),s){if(v>=s.end)T(l=s.b,1-l),_r(t,s.b,"end"),c||(s.b?u():--s.group.r||Ut(s.group.c)),s=null;else if(v>=s.start){const S=v-s.start;l=s.a+s.d*b(S/s.duration),T(l,1-l)}}return!!(s||c)}))}return{run(h){fr(o)?_s().then(()=>{o=o(i),f(h)}):f(h)},end(){u(),s=c=null}}}function wi(t,e){t.d(1),e.delete(t.key)}function xi(t,e,n,r,i,o,l,s,c,a,u,d){let f=t.length,h=o.length,g=f;const x={};for(;g--;)x[t[g].key]=g;const b=[],T=new Map,w=new Map,m=[];for(g=h;g--;){const M=d(i,o,g),N=n(M);let A=l.get(N);A?r&&m.push(()=>A.p(M,e)):(A=a(N,M),A.c()),T.set(N,b[g]=A),N in x&&w.set(N,Math.abs(g-x[N]))}const v=new Set,S=new Set;function _(M){At(M,1),M.m(s,u),l.set(M.key,M),u=M.first,h--}for(;f&&h;){const M=b[h-1],N=t[f-1],A=M.key,I=N.key;M===N?(u=M.first,f--,h--):T.has(I)?!l.has(A)||v.has(A)?_(M):S.has(I)?f--:w.get(A)>w.get(I)?(S.add(A),_(M)):(v.add(I),f--):(c(N,l),f--)}for(;f--;){const M=t[f];T.has(M.key)||c(M,l)}for(;h;)_(b[h-1]);return Ut(m),b}function ws(t,e,n){const r=t.$$.props[e];r!==void 0&&(t.$$.bound[r]=n,n(t.$$.ctx[r]))}function Bt(t){t&&t.c()}function Ht(t,e,n,r){const{fragment:i,after_update:o}=t.$$;i&&i.m(e,n),r||Me(()=>{const l=t.$$.on_mount.map(Xo).filter(fr);t.$$.on_destroy?t.$$.on_destroy.push(...l):Ut(l),t.$$.on_mount=[]}),o.forEach(Me)}function Ot(t,e){const n=t.$$;n.fragment!==null&&(vs(n.after_update),Ut(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function xs(t,e){t.$$.dirty[0]===-1&&(Fe.push(t),ll(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Gt(t,e,n,r,i,o,l,s=[-1]){const c=yn;gn(t);const a=t.$$={fragment:null,ctx:[],props:o,update:xt,not_equal:i,bound:yi(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(c?c.$$.context:[])),callbacks:yi(),dirty:s,skip_bound:!1,root:e.target||c.$$.root};l&&l(a.root);let u=!1;if(a.ctx=n?n(t,e.props||{},(d,f,...h)=>{const g=h.length?h[0]:f;return a.ctx&&i(a.ctx[d],a.ctx[d]=g)&&(!a.skip_bound&&a.bound[d]&&a.bound[d](g),u&&xs(t,d)),f}):[],a.update(),u=!0,Ut(a.before_update),a.fragment=r?r(a.ctx):!1,e.target){if(e.hydrate){const d=as(e.target);a.fragment&&a.fragment.l(d),d.forEach(Z)}else a.fragment&&a.fragment.c();e.intro&&At(t.$$.fragment),Ht(t,e.target,e.anchor,e.customElement),sl()}gn(c)}class Zt{$destroy(){Ot(this,1),this.$destroy=xt}$on(e,n){if(!fr(n))return xt;const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(n),()=>{const i=r.indexOf(n);i!==-1&&r.splice(i,1)}}$set(e){this.$$set&&!ns(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Le=[];function ks(t,e){return{subscribe:Zr(t,e).subscribe}}function Zr(t,e=xt){let n;const r=new Set;function i(s){if(Xt(t,s)&&(t=s,n)){const c=!Le.length;for(const a of r)a[1](),Le.push(a,t);if(c){for(let a=0;a<Le.length;a+=2)Le[a][0](Le[a+1]);Le.length=0}}}function o(s){i(s(t))}function l(s,c=xt){const a=[s,c];return r.add(a),r.size===1&&(n=e(i)||xt),s(t),()=>{r.delete(a),r.size===0&&n&&(n(),n=null)}}return{set:i,update:o,subscribe:l}}function Ts(t,e,n){const r=!Array.isArray(t),i=r?[t]:t,o=e.length<2;return ks(n,l=>{let s=!1;const c=[];let a=0,u=xt;const d=()=>{if(a)return;u();const h=e(r?c[0]:c,l);o?l(h):u=fr(h)?h:xt},f=i.map((h,g)=>Xr(h,x=>{c[g]=x,a&=~(1<<g),s&&d()},()=>{a|=1<<g}));return s=!0,d(),function(){Ut(f),u(),s=!1}})}const Cs=()=>{const{subscribe:t,set:e,update:n}=Zr({items:[],loading:!1,error:null});return{subscribe:t,loadItems:async()=>{n(r=>({...r,loading:!0,error:null}));try{const o=await(await fetch("/IWAC-overview/items.json")).json();e({items:o,loading:!1,error:null})}catch(r){n(i=>({...i,loading:!1,error:r instanceof Error?r.message:"Failed to load items"}))}}}},It=Cs(),al={en:{"app.title":"IWAC Database Overview","tab.countries":"Country Distribution","tab.languages":"Languages","tab.timeline":"Timeline","tab.types":"Type Distribution","tab.categories":"Index Categories","tab.words":"Word Distribution","ui.loading":"Loading database...","ui.select_visualization":"Select a visualization from the tabs above","ui.toggle_language":"Changer en français","ui.show_description":"Show description","ui.hide_description":"Hide description","ui.no_visualization_content":"No visualization content available","viz.summary":"Summary","viz.total_items":"Total items","viz.number_of_categories":"Number of categories","viz.top_categories":"Top Categories","viz.filter_by_country":"Filter by Country","viz.filter_by_type":"Filter by Type","viz.showing_items":"Showing {0} items in {1} languages","viz.all_countries":"All Countries","viz.all_types":"All Types","viz.no_data":"No data available with the current filters","viz.distribution_items":"Distribution of {0} items by country and sub-collection","viz.language_distribution_title":"Language Distribution","viz.language_distribution_items":"Distribution of {0} items by language","viz.language_distribution_description":"This visualization shows the distribution of items by language. You can filter by country and item type to explore the language distribution across different segments of the collection.","viz.timeline_distribution_title":"Timeline Distribution","viz.timeline_distribution_items":"Growth timeline of {0} items over time","viz.timeline_distribution_description":"This visualization shows the growth of the database over time. The blue line represents monthly additions, while the green dotted line shows the cumulative total. You can filter by country and item type to explore growth patterns across different segments of the collection.","viz.time_period":"Time period","viz.avg_monthly_additions":"Average monthly additions","viz.peak_growth_months":"Peak Growth Months","viz.showing_items_over_months":"Showing {0} items over {1} months","viz.months":"months","viz.monthly_additions":"Monthly Additions","viz.month":"Month","viz.publication_year":"Publication Year","viz.number_of_items":"Number of Items","viz.toggle_types":"Toggle Types","viz.toggled_type":"Toggled type: {0}","viz.languages":"Languages","viz.country_distribution_title":"Country Distribution","viz.country_distribution_description":"This visualization shows the distribution of items by country and sub-collection. You can click on any country block to zoom in and see its sub-collections. The size of each block represents the number of items in that country or sub-collection.","viz.country.items":"Items","viz.country.percent_parent":"% of Parent","viz.country.percent_total":"% of Total","viz.country.click_zoom_in":"Click to zoom in","viz.country.click_zoom_out":"Click to zoom out","viz.country.unknown":"Unknown","viz.country.no_set":"No Set","viz.countries":"Countries","viz.sub_collections":"Sub-collections","viz.currently_viewing":"Currently viewing","viz.click_back_to_return":'Click the "Back to All" button to return to the full view',"viz.click_zoom_in":"Click on a country block to zoom in","viz.unknown":"Unknown","viz.no_set":"No Set","viz.word_distribution":"Word Distribution","viz.total_words":"Total Words","viz.avg_words_per_item":"Average Words per Item","viz.back_to_all":"← Back to All","viz.total_items_with_word_count":"Total items with word count","viz.word_distribution_subtitle":"Word Distribution by Country and Item Set ({0} items, {1} words)","viz.words":"words","viz.items":"items","viz.percent_of_country":"% of country","viz.percent_of_total":"% of total","viz.item_set_summary":"Item Set Summary","lang.Français":"French","lang.Anglais":"English","lang.Haoussa":"Hausa","lang.Allemand":"German","lang.Arabe":"Arabic","lang.Italien":"Italian","lang.Dendi":"Dendi","lang.Slovène":"Slovenian","lang.Espagnol":"Spanish","country.all":"All Countries","country.Bénin":"Benin","country.Nigéria":"Nigeria","country.Côte d'Ivoire":"Côte d'Ivoire","country.Burkina Faso":"Burkina Faso","country.Togo":"Togo","country.Niger":"Niger","country.Unknown":"Unknown","type.Article de presse":"Press Article","type.Notice d'autorité":"Authority Record","type.Périodique islamique":"Islamic Periodical","type.Unknown":"Unknown","type.Article de revue":"Journal Article","type.Document":"Document","type.Article de blog":"Blog Post","type.Chapitre de livre":"Book Chapter","type.Livre":"Book","type.Thèse de doctorat":"Doctoral Thesis","type.Communication scientifique":"Scientific Communication","type.all":"All Types"},fr:{"app.title":"Aperçu de la base de données IWAC","tab.countries":"Répartition par pays","tab.languages":"Langues","tab.timeline":"Chronologie","tab.types":"Répartition par type","tab.categories":"Catégories d'index","tab.words":"Répartition des mots","ui.loading":"Chargement de la base de données...","ui.select_visualization":"Sélectionnez une visualisation dans les onglets ci-dessus","ui.toggle_language":"Switch to English","ui.show_description":"Afficher la description","ui.hide_description":"Masquer la description","ui.no_visualization_content":"Aucun contenu de visualisation disponible","viz.summary":"Résumé","viz.total_items":"Nombre total d'éléments","viz.number_of_categories":"Nombre de catégories","viz.top_categories":"Principales catégories","viz.filter_by_country":"Filtrer par pays","viz.filter_by_type":"Filtrer par type","viz.showing_items":"Affichage de {0} éléments dans {1} langues","viz.all_countries":"Tous les pays","viz.all_types":"Tous les types","viz.no_data":"Aucune donnée disponible avec les filtres actuels","viz.distribution_items":"Répartition de {0} éléments par pays et sous-collection","viz.language_distribution_title":"Répartition par langue","viz.language_distribution_items":"Répartition de {0} éléments par langue","viz.language_distribution_description":"Cette visualisation montre la répartition des éléments par langue. Vous pouvez filtrer par pays et par type d'élément pour explorer la répartition des langues dans différents segments de la collection.","viz.timeline_distribution_title":"Chronologie","viz.timeline_distribution_items":"Chronologie de croissance de {0} éléments au fil du temps","viz.timeline_distribution_description":"Cette visualisation montre la croissance de la base de données au fil du temps. La ligne bleue représente les ajouts mensuels, tandis que la ligne pointillée verte montre le total cumulatif. Vous pouvez filtrer par pays et par type d'élément pour explorer les modèles de croissance dans différents segments de la collection.","viz.time_period":"Période","viz.avg_monthly_additions":"Ajouts mensuels moyens","viz.peak_growth_months":"Mois de croissance maximale","viz.showing_items_over_months":"Affichage de {0} éléments sur {1} mois","viz.months":"mois","viz.monthly_additions":"Ajouts mensuels","viz.month":"Mois","viz.publication_year":"Année de publication","viz.number_of_items":"Nombre d'éléments","viz.toggle_types":"Basculer les types","viz.toggled_type":"Type basculé : {0}","viz.languages":"Langues","viz.country_distribution_title":"Répartition par pays","viz.country_distribution_description":"Cette visualisation montre la répartition des éléments par pays et sous-collection. Vous pouvez cliquer sur n'importe quel bloc pays pour zoomer et voir ses sous-collections. La taille de chaque bloc représente le nombre d'éléments dans ce pays ou cette sous-collection.","viz.country.items":"Éléments","viz.country.percent_parent":"% du parent","viz.country.percent_total":"% du total","viz.country.click_zoom_in":"Cliquer pour zoomer","viz.country.click_zoom_out":"Cliquer pour dézoomer","viz.country.unknown":"Inconnu","viz.country.no_set":"Sans ensemble","viz.countries":"Pays","viz.sub_collections":"Sous-collections","viz.currently_viewing":"Affichage actuel","viz.click_back_to_return":'Cliquez sur le bouton "Retour à tous" pour revenir à la vue complète',"viz.click_zoom_in":"Cliquez sur un bloc pays pour zoomer","viz.unknown":"Inconnu","viz.no_set":"Sans ensemble","viz.word_distribution":"Répartition des mots","viz.total_words":"Nombre total de mots","viz.avg_words_per_item":"Moyenne de mots par élément","viz.back_to_all":"← Retour à tous","viz.total_items_with_word_count":"Total des éléments avec nombre de mots","viz.word_distribution_subtitle":"Répartition des mots par pays et ensemble d'éléments ({0} éléments, {1} mots)","viz.words":"mots","viz.items":"éléments","viz.percent_of_country":"% du pays","viz.percent_of_total":"% du total","viz.item_set_summary":"Résumé de l'ensemble d'éléments","lang.Français":"Français","lang.Anglais":"Anglais","lang.Haoussa":"Haoussa","lang.Allemand":"Allemand","lang.Arabe":"Arabe","lang.Italien":"Italien","lang.Dendi":"Dendi","lang.Slovène":"Slovène","lang.Espagnol":"Espagnol","country.all":"Tous les pays","country.Bénin":"Bénin","country.Nigéria":"Nigéria","country.Côte d'Ivoire":"Côte d'Ivoire","country.Burkina Faso":"Burkina Faso","country.Togo":"Togo","country.Niger":"Niger","country.Unknown":"Inconnu","type.Article de presse":"Article de presse","type.Notice d'autorité":"Notice d'autorité","type.Périodique islamique":"Périodique islamique","type.Unknown":"Inconnu","type.Article de revue":"Article de revue","type.Document":"Document","type.Article de blog":"Article de blog","type.Chapitre de livre":"Chapitre de livre","type.Livre":"Livre","type.Thèse de doctorat":"Thèse de doctorat","type.Communication scientifique":"Communication scientifique","type.all":"Tous les types"}};function zs(){const{subscribe:t,set:e,update:n}=Zr("en");return{subscribe:t,setLanguage:r=>{console.log("[TranslationStore] Setting language to:",r),e(r)},toggleLanguage:()=>n(r=>{const i=r==="en"?"fr":"en";return console.log("[TranslationStore] Toggling language from",r,"to",i),i})}}const qt=zs();function ul(t,e=[]){console.log("[TranslationStore] Processing translation:",{text:t,replacements:e});const n=t.replace(/{(\d+)}/g,(r,i)=>{const o=parseInt(i);return o<e.length?e[o]:r});return console.log("[TranslationStore] Processed result:",n),n}function bt(t,e=[]){var i;const n=rs(qt);console.log("[TranslationStore] t() translation lookup:",{key:t,currentLang:n,replacements:e});const r=((i=al[n])==null?void 0:i[t])||t;return ul(r,e)}function pt(t,e=[]){return console.log("[TranslationStore] Creating reactive translation for key:",t),Ts(qt,n=>{var i;console.log("[TranslationStore] Reactive translation update:",{key:t,language:n});const r=((i=al[n])==null?void 0:i[t])||t;return ul(r,e)})}function Ms(t){let e,n,r,i;return{c(){e=z("button"),n=L(t[0]),y(e,"class","language-toggle svelte-u9ii1h")},m(o,l){J(o,e,l),p(e,n),r||(i=St(e,"click",t[2]),r=!0)},p(o,[l]){l&1&&et(n,o[0])},i:xt,o:xt,d(o){o&&Z(e),r=!1,i()}}}function As(t,e,n){let r,i;yt(t,qt,s=>n(3,i=s));const o=pt("ui.toggle_language");yt(t,o,s=>n(0,r=s));function l(){console.log("[LanguageToggle] Button clicked, current language:",i),qt.toggleLanguage(),console.log("[LanguageToggle] Toggle text is:",r)}return[r,o,l]}class Ss extends Zt{constructor(e){super(),Gt(this,e,As,Ms,Xt,{})}}const qe=[],$s=1e3;function Ds(){return new Date().toISOString()}function mt(t,e,n){const r=Ds(),i={timestamp:r,component:t,action:e,details:n};qe.push(i),qe.length>$s&&qe.shift();{const o=`[${r}] [${t}] ${e}`;n!==void 0?console.log(o,n):console.log(o)}}const ke=new Set,ae={};function dr(t,e){ke.add(t),e&&(ae[e]||(ae[e]=[]),ae[e].push(t)),mt("DEBUG",`Component mounted: ${t}`,{total:ke.size,all:Array.from(ke),parent:e||"none"})}function je(t){ke.delete(t),Object.keys(ae).forEach(e=>{const n=ae[e].indexOf(t);n!==-1&&ae[e].splice(n,1)}),delete ae[t],mt("DEBUG",`Component unmounted: ${t}`,{total:ke.size,all:Array.from(ke),hierarchy:ae})}function cl(){console.group("IWAC Debug Logs"),qe.forEach(t=>{console.groupCollapsed(`${t.timestamp} - ${t.component} - ${t.action}`),console.log("Component:",t.component),console.log("Action:",t.action),t.details&&console.log("Details:",t.details),console.groupEnd()}),console.groupEnd()}function Jr(){return JSON.stringify(qe,null,2)}typeof window<"u"&&(window.__IWAC_DEBUG={logs:qe,dumpLogs:cl,exportLogs:Jr,mountedComponents:()=>Array.from(ke),hierarchy:ae});function Ns(t){let e;const n=t[1].default,r=jo(n,t,t[0],null);return{c(){r&&r.c()},m(i,o){r&&r.m(i,o),e=!0},p(i,[o]){r&&r.p&&(!e||o&1)&&Zo(r,n,i,i[0],e?Go(n,i[0],o,null):Jo(i[0]),null)},i(i){e||(At(r,i),e=!0)},o(i){$t(r,i),e=!1},d(i){r&&r.d(i)}}}const Wt="TranslationContext";function Es(t,e,n){let r;yt(t,qt,f=>n(7,r=f));let{$$slots:i={},$$scope:o}=e,l=!1,s,c=0,a=r,u="";gs("translationContext",{componentId:Wt,getLanguage:()=>a});function d(f){if(!l){mt(Wt,`Language change ignored (not mounted): ${f}`);return}u=a,a=f,mt(Wt,`Language changed from ${u} to ${f}`,{isMounted:l,updateCount:c,subscriptionActive:!!s})}return rl(()=>{mt(Wt,"Before update",{isMounted:l,currentLanguage:a,updateCount:c})}),me(()=>{l=!0,dr(Wt),mt(Wt,`Component mounted, initial language: ${r}`,{storeValue:r,currentLanguage:a});try{s=qt.subscribe(f=>{d(f)}),mt(Wt,"Subscribed to language store")}catch(f){mt(Wt,"Error subscribing to language store",f)}typeof window<"u"&&(window.__TRANSLATION_DEBUG={dumpLogs:cl,exportLogs:Jr,currentLanguage:()=>a,isMounted:()=>l})}),Cn(()=>{if(mt(Wt,"Component being destroyed",{isMounted:l,currentLanguage:a,hasUnsubscribe:!!s}),l=!1,je(Wt),s)try{s(),mt(Wt,"Unsubscribed from language store"),s=void 0}catch(f){mt(Wt,"Error unsubscribing from language store",f)}}),il(()=>{c++,mt(Wt,`Component updated (${c})`,{isMounted:l,currentLanguage:a,storeValue:r})}),t.$$set=f=>{"$$scope"in f&&n(0,o=f.$$scope)},[o,i]}class Is extends Zt{constructor(e){super(),Gt(this,e,Es,Ns,Xt,{})}}function On(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Ls(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Qr(t){let e,n,r;t.length!==2?(e=On,n=(s,c)=>On(t(s),c),r=(s,c)=>t(s)-c):(e=t===On||t===Ls?t:Us,n=t,r=t);function i(s,c,a=0,u=s.length){if(a<u){if(e(c,c)!==0)return u;do{const d=a+u>>>1;n(s[d],c)<0?a=d+1:u=d}while(a<u)}return a}function o(s,c,a=0,u=s.length){if(a<u){if(e(c,c)!==0)return u;do{const d=a+u>>>1;n(s[d],c)<=0?a=d+1:u=d}while(a<u)}return a}function l(s,c,a=0,u=s.length){const d=i(s,c,a,u-1);return d>a&&r(s[d-1],c)>-r(s[d],c)?d-1:d}return{left:i,center:l,right:o}}function Us(){return 0}function Fs(t){return t===null?NaN:+t}const Rs=Qr(On),Hs=Rs.right;Qr(Fs).center;const Os=Hs;function Ys(t,e){let n,r;if(e===void 0)for(const i of t)i!=null&&(n===void 0?i>=i&&(n=r=i):(n>i&&(n=i),r<i&&(r=i)));else{let i=-1;for(let o of t)(o=e(o,++i,t))!=null&&(n===void 0?o>=o&&(n=r=o):(n>o&&(n=o),r<o&&(r=o)))}return[n,r]}class Er extends Map{constructor(e,n=Bs){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),e!=null)for(const[r,i]of e)this.set(r,i)}get(e){return super.get(ki(this,e))}has(e){return super.has(ki(this,e))}set(e,n){return super.set(Ws(this,e),n)}delete(e){return super.delete(Ps(this,e))}}function ki({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):n}function Ws({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):(t.set(r,n),n)}function Ps({_intern:t,_key:e},n){const r=e(n);return t.has(r)&&(n=t.get(r),t.delete(r)),n}function Bs(t){return t!==null&&typeof t=="object"?t.valueOf():t}function Ir(t){return t}function Ke(t,...e){return fl(t,Ir,Ir,e)}function Ve(t,e,...n){return fl(t,Ir,e,n)}function fl(t,e,n,r){return function i(o,l){if(l>=r.length)return n(o);const s=new Er,c=r[l++];let a=-1;for(const u of o){const d=c(u,++a,o),f=s.get(d);f?f.push(u):s.set(d,[u])}for(const[u,d]of s)s.set(u,i(d,l));return e(s)}(t,0)}const qs=Math.sqrt(50),Vs=Math.sqrt(10),Xs=Math.sqrt(2);function Xn(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),o=r/Math.pow(10,i),l=o>=qs?10:o>=Vs?5:o>=Xs?2:1;let s,c,a;return i<0?(a=Math.pow(10,-i)/l,s=Math.round(t*a),c=Math.round(e*a),s/a<t&&++s,c/a>e&&--c,a=-a):(a=Math.pow(10,i)*l,s=Math.round(t/a),c=Math.round(e/a),s*a<t&&++s,c*a>e&&--c),c<s&&.5<=n&&n<2?Xn(t,e,n*2):[s,c,a]}function js(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const r=e<t,[i,o,l]=r?Xn(e,t,n):Xn(t,e,n);if(!(o>=i))return[];const s=o-i+1,c=new Array(s);if(r)if(l<0)for(let a=0;a<s;++a)c[a]=(o-a)/-l;else for(let a=0;a<s;++a)c[a]=(o-a)*l;else if(l<0)for(let a=0;a<s;++a)c[a]=(i+a)/-l;else for(let a=0;a<s;++a)c[a]=(i+a)*l;return c}function Lr(t,e,n){return e=+e,t=+t,n=+n,Xn(t,e,n)[2]}function Ur(t,e,n){e=+e,t=+t,n=+n;const r=e<t,i=r?Lr(e,t,n):Lr(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}function Re(t,e){let n;if(e===void 0)for(const r of t)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of t)(i=e(i,++r,t))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function Ks(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((e-t)/n))|0,o=new Array(i);++r<i;)o[r]=t+r*n;return o}function Gs(t){return t}var br=1,wr=2,Fr=3,fn=4,Ti=1e-6;function Zs(t){return"translate("+t+",0)"}function Js(t){return"translate(0,"+t+")"}function Qs(t){return e=>+t(e)}function ta(t,e){return e=Math.max(0,t.bandwidth()-e*2)/2,t.round()&&(e=Math.round(e)),n=>+t(n)+e}function ea(){return!this.__axis}function dl(t,e){var n=[],r=null,i=null,o=6,l=6,s=3,c=typeof window<"u"&&window.devicePixelRatio>1?0:.5,a=t===br||t===fn?-1:1,u=t===fn||t===wr?"x":"y",d=t===br||t===Fr?Zs:Js;function f(h){var g=r??(e.ticks?e.ticks.apply(e,n):e.domain()),x=i??(e.tickFormat?e.tickFormat.apply(e,n):Gs),b=Math.max(o,0)+s,T=e.range(),w=+T[0]+c,m=+T[T.length-1]+c,v=(e.bandwidth?ta:Qs)(e.copy(),c),S=h.selection?h.selection():h,_=S.selectAll(".domain").data([null]),M=S.selectAll(".tick").data(g,e).order(),N=M.exit(),A=M.enter().append("g").attr("class","tick"),I=M.select("line"),B=M.select("text");_=_.merge(_.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),M=M.merge(A),I=I.merge(A.append("line").attr("stroke","currentColor").attr(u+"2",a*o)),B=B.merge(A.append("text").attr("fill","currentColor").attr(u,a*b).attr("dy",t===br?"0em":t===Fr?"0.71em":"0.32em")),h!==S&&(_=_.transition(h),M=M.transition(h),I=I.transition(h),B=B.transition(h),N=N.transition(h).attr("opacity",Ti).attr("transform",function(W){return isFinite(W=v(W))?d(W+c):this.getAttribute("transform")}),A.attr("opacity",Ti).attr("transform",function(W){var D=this.parentNode.__axis;return d((D&&isFinite(D=D(W))?D:v(W))+c)})),N.remove(),_.attr("d",t===fn||t===wr?l?"M"+a*l+","+w+"H"+c+"V"+m+"H"+a*l:"M"+c+","+w+"V"+m:l?"M"+w+","+a*l+"V"+c+"H"+m+"V"+a*l:"M"+w+","+c+"H"+m),M.attr("opacity",1).attr("transform",function(W){return d(v(W)+c)}),I.attr(u+"2",a*o),B.attr(u,a*b).text(x),S.filter(ea).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===wr?"start":t===fn?"end":"middle"),S.each(function(){this.__axis=v})}return f.scale=function(h){return arguments.length?(e=h,f):e},f.ticks=function(){return n=Array.from(arguments),f},f.tickArguments=function(h){return arguments.length?(n=h==null?[]:Array.from(h),f):n.slice()},f.tickValues=function(h){return arguments.length?(r=h==null?null:Array.from(h),f):r&&r.slice()},f.tickFormat=function(h){return arguments.length?(i=h,f):i},f.tickSize=function(h){return arguments.length?(o=l=+h,f):o},f.tickSizeInner=function(h){return arguments.length?(o=+h,f):o},f.tickSizeOuter=function(h){return arguments.length?(l=+h,f):l},f.tickPadding=function(h){return arguments.length?(s=+h,f):s},f.offset=function(h){return arguments.length?(c=+h,f):c},f}function jn(t){return dl(Fr,t)}function Kn(t){return dl(fn,t)}var na={value:()=>{}};function hl(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Yn(n)}function Yn(t){this._=t}function ra(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Yn.prototype=hl.prototype={constructor:Yn,on:function(t,e){var n=this._,r=ra(t+"",n),i,o=-1,l=r.length;if(arguments.length<2){for(;++o<l;)if((i=(t=r[o]).type)&&(i=ia(n[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++o<l;)if(i=(t=r[o]).type)n[i]=Ci(n[i],t.name,e);else if(e==null)for(i in n)n[i]=Ci(n[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Yn(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,o;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=this._[t],r=0,i=o.length;r<i;++r)o[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(e,n)}};function ia(t,e){for(var n=0,r=t.length,i;n<r;++n)if((i=t[n]).name===e)return i.value}function Ci(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=na,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var Rr="http://www.w3.org/1999/xhtml";const zi={svg:"http://www.w3.org/2000/svg",xhtml:Rr,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function hr(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),zi.hasOwnProperty(e)?{space:zi[e],local:t}:t}function oa(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Rr&&e.documentElement.namespaceURI===Rr?e.createElement(t):e.createElementNS(n,t)}}function la(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function pl(t){var e=hr(t);return(e.local?la:oa)(e)}function sa(){}function ti(t){return t==null?sa:function(){return this.querySelector(t)}}function aa(t){typeof t!="function"&&(t=ti(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o=e[i],l=o.length,s=r[i]=new Array(l),c,a,u=0;u<l;++u)(c=o[u])&&(a=t.call(c,c.__data__,u,o))&&("__data__"in c&&(a.__data__=c.__data__),s[u]=a);return new Vt(r,this._parents)}function ua(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function ca(){return[]}function gl(t){return t==null?ca:function(){return this.querySelectorAll(t)}}function fa(t){return function(){return ua(t.apply(this,arguments))}}function da(t){typeof t=="function"?t=fa(t):t=gl(t);for(var e=this._groups,n=e.length,r=[],i=[],o=0;o<n;++o)for(var l=e[o],s=l.length,c,a=0;a<s;++a)(c=l[a])&&(r.push(t.call(c,c.__data__,a,l)),i.push(c));return new Vt(r,i)}function ml(t){return function(){return this.matches(t)}}function yl(t){return function(e){return e.matches(t)}}var ha=Array.prototype.find;function pa(t){return function(){return ha.call(this.children,t)}}function ga(){return this.firstElementChild}function ma(t){return this.select(t==null?ga:pa(typeof t=="function"?t:yl(t)))}var ya=Array.prototype.filter;function va(){return Array.from(this.children)}function _a(t){return function(){return ya.call(this.children,t)}}function ba(t){return this.selectAll(t==null?va:_a(typeof t=="function"?t:yl(t)))}function wa(t){typeof t!="function"&&(t=ml(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o=e[i],l=o.length,s=r[i]=[],c,a=0;a<l;++a)(c=o[a])&&t.call(c,c.__data__,a,o)&&s.push(c);return new Vt(r,this._parents)}function vl(t){return new Array(t.length)}function xa(){return new Vt(this._enter||this._groups.map(vl),this._parents)}function Gn(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}Gn.prototype={constructor:Gn,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function ka(t){return function(){return t}}function Ta(t,e,n,r,i,o){for(var l=0,s,c=e.length,a=o.length;l<a;++l)(s=e[l])?(s.__data__=o[l],r[l]=s):n[l]=new Gn(t,o[l]);for(;l<c;++l)(s=e[l])&&(i[l]=s)}function Ca(t,e,n,r,i,o,l){var s,c,a=new Map,u=e.length,d=o.length,f=new Array(u),h;for(s=0;s<u;++s)(c=e[s])&&(f[s]=h=l.call(c,c.__data__,s,e)+"",a.has(h)?i[s]=c:a.set(h,c));for(s=0;s<d;++s)h=l.call(t,o[s],s,o)+"",(c=a.get(h))?(r[s]=c,c.__data__=o[s],a.delete(h)):n[s]=new Gn(t,o[s]);for(s=0;s<u;++s)(c=e[s])&&a.get(f[s])===c&&(i[s]=c)}function za(t){return t.__data__}function Ma(t,e){if(!arguments.length)return Array.from(this,za);var n=e?Ca:Ta,r=this._parents,i=this._groups;typeof t!="function"&&(t=ka(t));for(var o=i.length,l=new Array(o),s=new Array(o),c=new Array(o),a=0;a<o;++a){var u=r[a],d=i[a],f=d.length,h=Aa(t.call(u,u&&u.__data__,a,r)),g=h.length,x=s[a]=new Array(g),b=l[a]=new Array(g),T=c[a]=new Array(f);n(u,d,x,b,T,h,e);for(var w=0,m=0,v,S;w<g;++w)if(v=x[w]){for(w>=m&&(m=w+1);!(S=b[m])&&++m<g;);v._next=S||null}}return l=new Vt(l,r),l._enter=s,l._exit=c,l}function Aa(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Sa(){return new Vt(this._exit||this._groups.map(vl),this._parents)}function $a(t,e,n){var r=this.enter(),i=this,o=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),e!=null&&(i=e(i),i&&(i=i.selection())),n==null?o.remove():n(o),r&&i?r.merge(i).order():i}function Da(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,o=r.length,l=Math.min(i,o),s=new Array(i),c=0;c<l;++c)for(var a=n[c],u=r[c],d=a.length,f=s[c]=new Array(d),h,g=0;g<d;++g)(h=a[g]||u[g])&&(f[g]=h);for(;c<i;++c)s[c]=n[c];return new Vt(s,this._parents)}function Na(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],i=r.length-1,o=r[i],l;--i>=0;)(l=r[i])&&(o&&l.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(l,o),o=l);return this}function Ea(t){t||(t=Ia);function e(d,f){return d&&f?t(d.__data__,f.__data__):!d-!f}for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var l=n[o],s=l.length,c=i[o]=new Array(s),a,u=0;u<s;++u)(a=l[u])&&(c[u]=a);c.sort(e)}return new Vt(i,this._parents).order()}function Ia(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function La(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function Ua(){return Array.from(this)}function Fa(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length;i<o;++i){var l=r[i];if(l)return l}return null}function Ra(){let t=0;for(const e of this)++t;return t}function Ha(){return!this.node()}function Oa(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i=e[n],o=0,l=i.length,s;o<l;++o)(s=i[o])&&t.call(s,s.__data__,o,i);return this}function Ya(t){return function(){this.removeAttribute(t)}}function Wa(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Pa(t,e){return function(){this.setAttribute(t,e)}}function Ba(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function qa(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function Va(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function Xa(t,e){var n=hr(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?Wa:Ya:typeof e=="function"?n.local?Va:qa:n.local?Ba:Pa)(n,e))}function _l(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function ja(t){return function(){this.style.removeProperty(t)}}function Ka(t,e,n){return function(){this.style.setProperty(t,e,n)}}function Ga(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function Za(t,e,n){return arguments.length>1?this.each((e==null?ja:typeof e=="function"?Ga:Ka)(t,e,n??"")):Ge(this.node(),t)}function Ge(t,e){return t.style.getPropertyValue(e)||_l(t).getComputedStyle(t,null).getPropertyValue(e)}function Ja(t){return function(){delete this[t]}}function Qa(t,e){return function(){this[t]=e}}function tu(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function eu(t,e){return arguments.length>1?this.each((e==null?Ja:typeof e=="function"?tu:Qa)(t,e)):this.node()[t]}function bl(t){return t.trim().split(/^|\s+/)}function ei(t){return t.classList||new wl(t)}function wl(t){this._node=t,this._names=bl(t.getAttribute("class")||"")}wl.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function xl(t,e){for(var n=ei(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function kl(t,e){for(var n=ei(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function nu(t){return function(){xl(this,t)}}function ru(t){return function(){kl(this,t)}}function iu(t,e){return function(){(e.apply(this,arguments)?xl:kl)(this,t)}}function ou(t,e){var n=bl(t+"");if(arguments.length<2){for(var r=ei(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof e=="function"?iu:e?nu:ru)(n,e))}function lu(){this.textContent=""}function su(t){return function(){this.textContent=t}}function au(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function uu(t){return arguments.length?this.each(t==null?lu:(typeof t=="function"?au:su)(t)):this.node().textContent}function cu(){this.innerHTML=""}function fu(t){return function(){this.innerHTML=t}}function du(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function hu(t){return arguments.length?this.each(t==null?cu:(typeof t=="function"?du:fu)(t)):this.node().innerHTML}function pu(){this.nextSibling&&this.parentNode.appendChild(this)}function gu(){return this.each(pu)}function mu(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function yu(){return this.each(mu)}function vu(t){var e=typeof t=="function"?t:pl(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function _u(){return null}function bu(t,e){var n=typeof t=="function"?t:pl(t),r=e==null?_u:typeof e=="function"?e:ti(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function wu(){var t=this.parentNode;t&&t.removeChild(this)}function xu(){return this.each(wu)}function ku(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Tu(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Cu(t){return this.select(t?Tu:ku)}function zu(t){return arguments.length?this.property("__data__",t):this.node().__data__}function Mu(t){return function(e){t.call(this,e,this.__data__)}}function Au(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function Su(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,i=e.length,o;n<i;++n)o=e[n],(!t.type||o.type===t.type)&&o.name===t.name?this.removeEventListener(o.type,o.listener,o.options):e[++r]=o;++r?e.length=r:delete this.__on}}}function $u(t,e,n){return function(){var r=this.__on,i,o=Mu(e);if(r){for(var l=0,s=r.length;l<s;++l)if((i=r[l]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=o,i.options=n),i.value=e;return}}this.addEventListener(t.type,o,n),i={type:t.type,name:t.name,value:e,listener:o,options:n},r?r.push(i):this.__on=[i]}}function Du(t,e,n){var r=Au(t+""),i,o=r.length,l;if(arguments.length<2){var s=this.node().__on;if(s){for(var c=0,a=s.length,u;c<a;++c)for(i=0,u=s[c];i<o;++i)if((l=r[i]).type===u.type&&l.name===u.name)return u.value}return}for(s=e?$u:Su,i=0;i<o;++i)this.each(s(r[i],e,n));return this}function Tl(t,e,n){var r=_l(t),i=r.CustomEvent;typeof i=="function"?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function Nu(t,e){return function(){return Tl(this,t,e)}}function Eu(t,e){return function(){return Tl(this,t,e.apply(this,arguments))}}function Iu(t,e){return this.each((typeof e=="function"?Eu:Nu)(t,e))}function*Lu(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length,l;i<o;++i)(l=r[i])&&(yield l)}var Cl=[null];function Vt(t,e){this._groups=t,this._parents=e}function zn(){return new Vt([[document.documentElement]],Cl)}function Uu(){return this}Vt.prototype=zn.prototype={constructor:Vt,select:aa,selectAll:da,selectChild:ma,selectChildren:ba,filter:wa,data:Ma,enter:xa,exit:Sa,join:$a,merge:Da,selection:Uu,order:Na,sort:Ea,call:La,nodes:Ua,node:Fa,size:Ra,empty:Ha,each:Oa,attr:Xa,style:Za,property:eu,classed:ou,text:uu,html:hu,raise:gu,lower:yu,append:vu,insert:bu,remove:xu,clone:Cu,datum:zu,on:Du,dispatch:Iu,[Symbol.iterator]:Lu};function _t(t){return typeof t=="string"?new Vt([[document.querySelector(t)]],[document.documentElement]):new Vt([[t]],Cl)}function ni(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function zl(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Mn(){}var vn=.7,Zn=1/vn,Xe="\\s*([+-]?\\d+)\\s*",_n="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ie="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Fu=/^#([0-9a-f]{3,8})$/,Ru=new RegExp(`^rgb\\(${Xe},${Xe},${Xe}\\)$`),Hu=new RegExp(`^rgb\\(${ie},${ie},${ie}\\)$`),Ou=new RegExp(`^rgba\\(${Xe},${Xe},${Xe},${_n}\\)$`),Yu=new RegExp(`^rgba\\(${ie},${ie},${ie},${_n}\\)$`),Wu=new RegExp(`^hsl\\(${_n},${ie},${ie}\\)$`),Pu=new RegExp(`^hsla\\(${_n},${ie},${ie},${_n}\\)$`),Mi={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};ni(Mn,Ae,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Ai,formatHex:Ai,formatHex8:Bu,formatHsl:qu,formatRgb:Si,toString:Si});function Ai(){return this.rgb().formatHex()}function Bu(){return this.rgb().formatHex8()}function qu(){return Ml(this).formatHsl()}function Si(){return this.rgb().formatRgb()}function Ae(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Fu.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?$i(e):n===3?new Rt(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?En(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?En(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Ru.exec(t))?new Rt(e[1],e[2],e[3],1):(e=Hu.exec(t))?new Rt(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Ou.exec(t))?En(e[1],e[2],e[3],e[4]):(e=Yu.exec(t))?En(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Wu.exec(t))?Ei(e[1],e[2]/100,e[3]/100,1):(e=Pu.exec(t))?Ei(e[1],e[2]/100,e[3]/100,e[4]):Mi.hasOwnProperty(t)?$i(Mi[t]):t==="transparent"?new Rt(NaN,NaN,NaN,0):null}function $i(t){return new Rt(t>>16&255,t>>8&255,t&255,1)}function En(t,e,n,r){return r<=0&&(t=e=n=NaN),new Rt(t,e,n,r)}function Vu(t){return t instanceof Mn||(t=Ae(t)),t?(t=t.rgb(),new Rt(t.r,t.g,t.b,t.opacity)):new Rt}function _e(t,e,n,r){return arguments.length===1?Vu(t):new Rt(t,e,n,r??1)}function Rt(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}ni(Rt,_e,zl(Mn,{brighter(t){return t=t==null?Zn:Math.pow(Zn,t),new Rt(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?vn:Math.pow(vn,t),new Rt(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Rt(Te(this.r),Te(this.g),Te(this.b),Jn(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Di,formatHex:Di,formatHex8:Xu,formatRgb:Ni,toString:Ni}));function Di(){return`#${xe(this.r)}${xe(this.g)}${xe(this.b)}`}function Xu(){return`#${xe(this.r)}${xe(this.g)}${xe(this.b)}${xe((isNaN(this.opacity)?1:this.opacity)*255)}`}function Ni(){const t=Jn(this.opacity);return`${t===1?"rgb(":"rgba("}${Te(this.r)}, ${Te(this.g)}, ${Te(this.b)}${t===1?")":`, ${t})`}`}function Jn(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Te(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function xe(t){return t=Te(t),(t<16?"0":"")+t.toString(16)}function Ei(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Qt(t,e,n,r)}function Ml(t){if(t instanceof Qt)return new Qt(t.h,t.s,t.l,t.opacity);if(t instanceof Mn||(t=Ae(t)),!t)return new Qt;if(t instanceof Qt)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),l=NaN,s=o-i,c=(o+i)/2;return s?(e===o?l=(n-r)/s+(n<r)*6:n===o?l=(r-e)/s+2:l=(e-n)/s+4,s/=c<.5?o+i:2-o-i,l*=60):s=c>0&&c<1?0:l,new Qt(l,s,c,t.opacity)}function ju(t,e,n,r){return arguments.length===1?Ml(t):new Qt(t,e,n,r??1)}function Qt(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}ni(Qt,ju,zl(Mn,{brighter(t){return t=t==null?Zn:Math.pow(Zn,t),new Qt(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?vn:Math.pow(vn,t),new Qt(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Rt(xr(t>=240?t-240:t+120,i,r),xr(t,i,r),xr(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new Qt(Ii(this.h),In(this.s),In(this.l),Jn(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Jn(this.opacity);return`${t===1?"hsl(":"hsla("}${Ii(this.h)}, ${In(this.s)*100}%, ${In(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Ii(t){return t=(t||0)%360,t<0?t+360:t}function In(t){return Math.max(0,Math.min(1,t||0))}function xr(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const ri=t=>()=>t;function Ku(t,e){return function(n){return t+n*e}}function Gu(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function Zu(t){return(t=+t)==1?Al:function(e,n){return n-e?Gu(e,n,t):ri(isNaN(e)?n:e)}}function Al(t,e){var n=e-t;return n?Ku(t,n):ri(isNaN(t)?e:t)}const Qn=function t(e){var n=Zu(e);function r(i,o){var l=n((i=_e(i)).r,(o=_e(o)).r),s=n(i.g,o.g),c=n(i.b,o.b),a=Al(i.opacity,o.opacity);return function(u){return i.r=l(u),i.g=s(u),i.b=c(u),i.opacity=a(u),i+""}}return r.gamma=t,r}(1);function Ju(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),i;return function(o){for(i=0;i<n;++i)r[i]=t[i]*(1-o)+e[i]*o;return r}}function Qu(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function tc(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,i=new Array(r),o=new Array(n),l;for(l=0;l<r;++l)i[l]=ii(t[l],e[l]);for(;l<n;++l)o[l]=e[l];return function(s){for(l=0;l<r;++l)o[l]=i[l](s);return o}}function ec(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function Jt(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function nc(t,e){var n={},r={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?n[i]=ii(t[i],e[i]):r[i]=e[i];return function(o){for(i in n)r[i]=n[i](o);return r}}var Hr=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,kr=new RegExp(Hr.source,"g");function rc(t){return function(){return t}}function ic(t){return function(e){return t(e)+""}}function Sl(t,e){var n=Hr.lastIndex=kr.lastIndex=0,r,i,o,l=-1,s=[],c=[];for(t=t+"",e=e+"";(r=Hr.exec(t))&&(i=kr.exec(e));)(o=i.index)>n&&(o=e.slice(n,o),s[l]?s[l]+=o:s[++l]=o),(r=r[0])===(i=i[0])?s[l]?s[l]+=i:s[++l]=i:(s[++l]=null,c.push({i:l,x:Jt(r,i)})),n=kr.lastIndex;return n<e.length&&(o=e.slice(n),s[l]?s[l]+=o:s[++l]=o),s.length<2?c[0]?ic(c[0].x):rc(e):(e=c.length,function(a){for(var u=0,d;u<e;++u)s[(d=c[u]).i]=d.x(a);return s.join("")})}function ii(t,e){var n=typeof e,r;return e==null||n==="boolean"?ri(e):(n==="number"?Jt:n==="string"?(r=Ae(e))?(e=r,Qn):Sl:e instanceof Ae?Qn:e instanceof Date?ec:Qu(e)?Ju:Array.isArray(e)?tc:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?nc:Jt)(t,e)}function oc(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var Li=180/Math.PI,Or={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function $l(t,e,n,r,i,o){var l,s,c;return(l=Math.sqrt(t*t+e*e))&&(t/=l,e/=l),(c=t*n+e*r)&&(n-=t*c,r-=e*c),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,c/=s),t*r<e*n&&(t=-t,e=-e,c=-c,l=-l),{translateX:i,translateY:o,rotate:Math.atan2(e,t)*Li,skewX:Math.atan(c)*Li,scaleX:l,scaleY:s}}var Ln;function lc(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Or:$l(e.a,e.b,e.c,e.d,e.e,e.f)}function sc(t){return t==null||(Ln||(Ln=document.createElementNS("http://www.w3.org/2000/svg","g")),Ln.setAttribute("transform",t),!(t=Ln.transform.baseVal.consolidate()))?Or:(t=t.matrix,$l(t.a,t.b,t.c,t.d,t.e,t.f))}function Dl(t,e,n,r){function i(a){return a.length?a.pop()+" ":""}function o(a,u,d,f,h,g){if(a!==d||u!==f){var x=h.push("translate(",null,e,null,n);g.push({i:x-4,x:Jt(a,d)},{i:x-2,x:Jt(u,f)})}else(d||f)&&h.push("translate("+d+e+f+n)}function l(a,u,d,f){a!==u?(a-u>180?u+=360:u-a>180&&(a+=360),f.push({i:d.push(i(d)+"rotate(",null,r)-2,x:Jt(a,u)})):u&&d.push(i(d)+"rotate("+u+r)}function s(a,u,d,f){a!==u?f.push({i:d.push(i(d)+"skewX(",null,r)-2,x:Jt(a,u)}):u&&d.push(i(d)+"skewX("+u+r)}function c(a,u,d,f,h,g){if(a!==d||u!==f){var x=h.push(i(h)+"scale(",null,",",null,")");g.push({i:x-4,x:Jt(a,d)},{i:x-2,x:Jt(u,f)})}else(d!==1||f!==1)&&h.push(i(h)+"scale("+d+","+f+")")}return function(a,u){var d=[],f=[];return a=t(a),u=t(u),o(a.translateX,a.translateY,u.translateX,u.translateY,d,f),l(a.rotate,u.rotate,d,f),s(a.skewX,u.skewX,d,f),c(a.scaleX,a.scaleY,u.scaleX,u.scaleY,d,f),a=u=null,function(h){for(var g=-1,x=f.length,b;++g<x;)d[(b=f[g]).i]=b.x(h);return d.join("")}}}var ac=Dl(lc,"px, ","px)","deg)"),uc=Dl(sc,", ",")",")"),Ze=0,dn=0,on=0,Nl=1e3,tr,hn,er=0,Se=0,pr=0,bn=typeof performance=="object"&&performance.now?performance:Date,El=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function oi(){return Se||(El(cc),Se=bn.now()+pr)}function cc(){Se=0}function nr(){this._call=this._time=this._next=null}nr.prototype=Il.prototype={constructor:nr,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?oi():+n)+(e==null?0:+e),!this._next&&hn!==this&&(hn?hn._next=this:tr=this,hn=this),this._call=t,this._time=n,Yr()},stop:function(){this._call&&(this._call=null,this._time=1/0,Yr())}};function Il(t,e,n){var r=new nr;return r.restart(t,e,n),r}function fc(){oi(),++Ze;for(var t=tr,e;t;)(e=Se-t._time)>=0&&t._call.call(void 0,e),t=t._next;--Ze}function Ui(){Se=(er=bn.now())+pr,Ze=dn=0;try{fc()}finally{Ze=0,hc(),Se=0}}function dc(){var t=bn.now(),e=t-er;e>Nl&&(pr-=e,er=t)}function hc(){for(var t,e=tr,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:tr=n);hn=t,Yr(r)}function Yr(t){if(!Ze){dn&&(dn=clearTimeout(dn));var e=t-Se;e>24?(t<1/0&&(dn=setTimeout(Ui,t-bn.now()-pr)),on&&(on=clearInterval(on))):(on||(er=bn.now(),on=setInterval(dc,Nl)),Ze=1,El(Ui))}}function Fi(t,e,n){var r=new nr;return e=e==null?0:+e,r.restart(i=>{r.stop(),t(i+e)},e,n),r}var pc=hl("start","end","cancel","interrupt"),gc=[],Ll=0,Ri=1,Wr=2,Wn=3,Hi=4,Pr=5,Pn=6;function gr(t,e,n,r,i,o){var l=t.__transition;if(!l)t.__transition={};else if(n in l)return;mc(t,n,{name:e,index:r,group:i,on:pc,tween:gc,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:Ll})}function li(t,e){var n=te(t,e);if(n.state>Ll)throw new Error("too late; already scheduled");return n}function le(t,e){var n=te(t,e);if(n.state>Wn)throw new Error("too late; already running");return n}function te(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function mc(t,e,n){var r=t.__transition,i;r[e]=n,n.timer=Il(o,0,n.time);function o(a){n.state=Ri,n.timer.restart(l,n.delay,n.time),n.delay<=a&&l(a-n.delay)}function l(a){var u,d,f,h;if(n.state!==Ri)return c();for(u in r)if(h=r[u],h.name===n.name){if(h.state===Wn)return Fi(l);h.state===Hi?(h.state=Pn,h.timer.stop(),h.on.call("interrupt",t,t.__data__,h.index,h.group),delete r[u]):+u<e&&(h.state=Pn,h.timer.stop(),h.on.call("cancel",t,t.__data__,h.index,h.group),delete r[u])}if(Fi(function(){n.state===Wn&&(n.state=Hi,n.timer.restart(s,n.delay,n.time),s(a))}),n.state=Wr,n.on.call("start",t,t.__data__,n.index,n.group),n.state===Wr){for(n.state=Wn,i=new Array(f=n.tween.length),u=0,d=-1;u<f;++u)(h=n.tween[u].value.call(t,t.__data__,n.index,n.group))&&(i[++d]=h);i.length=d+1}}function s(a){for(var u=a<n.duration?n.ease.call(null,a/n.duration):(n.timer.restart(c),n.state=Pr,1),d=-1,f=i.length;++d<f;)i[d].call(t,u);n.state===Pr&&(n.on.call("end",t,t.__data__,n.index,n.group),c())}function c(){n.state=Pn,n.timer.stop(),delete r[e];for(var a in r)return;delete t.__transition}}function yc(t,e){var n=t.__transition,r,i,o=!0,l;if(n){e=e==null?null:e+"";for(l in n){if((r=n[l]).name!==e){o=!1;continue}i=r.state>Wr&&r.state<Pr,r.state=Pn,r.timer.stop(),r.on.call(i?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[l]}o&&delete t.__transition}}function vc(t){return this.each(function(){yc(this,t)})}function _c(t,e){var n,r;return function(){var i=le(this,t),o=i.tween;if(o!==n){r=n=o;for(var l=0,s=r.length;l<s;++l)if(r[l].name===e){r=r.slice(),r.splice(l,1);break}}i.tween=r}}function bc(t,e,n){var r,i;if(typeof n!="function")throw new Error;return function(){var o=le(this,t),l=o.tween;if(l!==r){i=(r=l).slice();for(var s={name:e,value:n},c=0,a=i.length;c<a;++c)if(i[c].name===e){i[c]=s;break}c===a&&i.push(s)}o.tween=i}}function wc(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=te(this.node(),n).tween,i=0,o=r.length,l;i<o;++i)if((l=r[i]).name===t)return l.value;return null}return this.each((e==null?_c:bc)(n,t,e))}function si(t,e,n){var r=t._id;return t.each(function(){var i=le(this,r);(i.value||(i.value={}))[e]=n.apply(this,arguments)}),function(i){return te(i,r).value[e]}}function Ul(t,e){var n;return(typeof e=="number"?Jt:e instanceof Ae?Qn:(n=Ae(e))?(e=n,Qn):Sl)(t,e)}function xc(t){return function(){this.removeAttribute(t)}}function kc(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Tc(t,e,n){var r,i=n+"",o;return function(){var l=this.getAttribute(t);return l===i?null:l===r?o:o=e(r=l,n)}}function Cc(t,e,n){var r,i=n+"",o;return function(){var l=this.getAttributeNS(t.space,t.local);return l===i?null:l===r?o:o=e(r=l,n)}}function zc(t,e,n){var r,i,o;return function(){var l,s=n(this),c;return s==null?void this.removeAttribute(t):(l=this.getAttribute(t),c=s+"",l===c?null:l===r&&c===i?o:(i=c,o=e(r=l,s)))}}function Mc(t,e,n){var r,i,o;return function(){var l,s=n(this),c;return s==null?void this.removeAttributeNS(t.space,t.local):(l=this.getAttributeNS(t.space,t.local),c=s+"",l===c?null:l===r&&c===i?o:(i=c,o=e(r=l,s)))}}function Ac(t,e){var n=hr(t),r=n==="transform"?uc:Ul;return this.attrTween(t,typeof e=="function"?(n.local?Mc:zc)(n,r,si(this,"attr."+t,e)):e==null?(n.local?kc:xc)(n):(n.local?Cc:Tc)(n,r,e))}function Sc(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function $c(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function Dc(t,e){var n,r;function i(){var o=e.apply(this,arguments);return o!==r&&(n=(r=o)&&$c(t,o)),n}return i._value=e,i}function Nc(t,e){var n,r;function i(){var o=e.apply(this,arguments);return o!==r&&(n=(r=o)&&Sc(t,o)),n}return i._value=e,i}function Ec(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=hr(t);return this.tween(n,(r.local?Dc:Nc)(r,e))}function Ic(t,e){return function(){li(this,t).delay=+e.apply(this,arguments)}}function Lc(t,e){return e=+e,function(){li(this,t).delay=e}}function Uc(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Ic:Lc)(e,t)):te(this.node(),e).delay}function Fc(t,e){return function(){le(this,t).duration=+e.apply(this,arguments)}}function Rc(t,e){return e=+e,function(){le(this,t).duration=e}}function Hc(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Fc:Rc)(e,t)):te(this.node(),e).duration}function Oc(t,e){if(typeof e!="function")throw new Error;return function(){le(this,t).ease=e}}function Yc(t){var e=this._id;return arguments.length?this.each(Oc(e,t)):te(this.node(),e).ease}function Wc(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;le(this,t).ease=n}}function Pc(t){if(typeof t!="function")throw new Error;return this.each(Wc(this._id,t))}function Bc(t){typeof t!="function"&&(t=ml(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o=e[i],l=o.length,s=r[i]=[],c,a=0;a<l;++a)(c=o[a])&&t.call(c,c.__data__,a,o)&&s.push(c);return new he(r,this._parents,this._name,this._id)}function qc(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,o=Math.min(r,i),l=new Array(r),s=0;s<o;++s)for(var c=e[s],a=n[s],u=c.length,d=l[s]=new Array(u),f,h=0;h<u;++h)(f=c[h]||a[h])&&(d[h]=f);for(;s<r;++s)l[s]=e[s];return new he(l,this._parents,this._name,this._id)}function Vc(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function Xc(t,e,n){var r,i,o=Vc(e)?li:le;return function(){var l=o(this,t),s=l.on;s!==r&&(i=(r=s).copy()).on(e,n),l.on=i}}function jc(t,e){var n=this._id;return arguments.length<2?te(this.node(),n).on.on(t):this.each(Xc(n,t,e))}function Kc(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function Gc(){return this.on("end.remove",Kc(this._id))}function Zc(t){var e=this._name,n=this._id;typeof t!="function"&&(t=ti(t));for(var r=this._groups,i=r.length,o=new Array(i),l=0;l<i;++l)for(var s=r[l],c=s.length,a=o[l]=new Array(c),u,d,f=0;f<c;++f)(u=s[f])&&(d=t.call(u,u.__data__,f,s))&&("__data__"in u&&(d.__data__=u.__data__),a[f]=d,gr(a[f],e,n,f,a,te(u,n)));return new he(o,this._parents,e,n)}function Jc(t){var e=this._name,n=this._id;typeof t!="function"&&(t=gl(t));for(var r=this._groups,i=r.length,o=[],l=[],s=0;s<i;++s)for(var c=r[s],a=c.length,u,d=0;d<a;++d)if(u=c[d]){for(var f=t.call(u,u.__data__,d,c),h,g=te(u,n),x=0,b=f.length;x<b;++x)(h=f[x])&&gr(h,e,n,x,f,g);o.push(f),l.push(u)}return new he(o,l,e,n)}var Qc=zn.prototype.constructor;function tf(){return new Qc(this._groups,this._parents)}function ef(t,e){var n,r,i;return function(){var o=Ge(this,t),l=(this.style.removeProperty(t),Ge(this,t));return o===l?null:o===n&&l===r?i:i=e(n=o,r=l)}}function Fl(t){return function(){this.style.removeProperty(t)}}function nf(t,e,n){var r,i=n+"",o;return function(){var l=Ge(this,t);return l===i?null:l===r?o:o=e(r=l,n)}}function rf(t,e,n){var r,i,o;return function(){var l=Ge(this,t),s=n(this),c=s+"";return s==null&&(c=s=(this.style.removeProperty(t),Ge(this,t))),l===c?null:l===r&&c===i?o:(i=c,o=e(r=l,s))}}function of(t,e){var n,r,i,o="style."+e,l="end."+o,s;return function(){var c=le(this,t),a=c.on,u=c.value[o]==null?s||(s=Fl(e)):void 0;(a!==n||i!==u)&&(r=(n=a).copy()).on(l,i=u),c.on=r}}function lf(t,e,n){var r=(t+="")=="transform"?ac:Ul;return e==null?this.styleTween(t,ef(t,r)).on("end.style."+t,Fl(t)):typeof e=="function"?this.styleTween(t,rf(t,r,si(this,"style."+t,e))).each(of(this._id,t)):this.styleTween(t,nf(t,r,e),n).on("end.style."+t,null)}function sf(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function af(t,e,n){var r,i;function o(){var l=e.apply(this,arguments);return l!==i&&(r=(i=l)&&sf(t,l,n)),r}return o._value=e,o}function uf(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,af(t,e,n??""))}function cf(t){return function(){this.textContent=t}}function ff(t){return function(){var e=t(this);this.textContent=e??""}}function df(t){return this.tween("text",typeof t=="function"?ff(si(this,"text",t)):cf(t==null?"":t+""))}function hf(t){return function(e){this.textContent=t.call(this,e)}}function pf(t){var e,n;function r(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&hf(i)),e}return r._value=t,r}function gf(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,pf(t))}function mf(){for(var t=this._name,e=this._id,n=Rl(),r=this._groups,i=r.length,o=0;o<i;++o)for(var l=r[o],s=l.length,c,a=0;a<s;++a)if(c=l[a]){var u=te(c,e);gr(c,t,n,a,l,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new he(r,this._parents,t,n)}function yf(){var t,e,n=this,r=n._id,i=n.size();return new Promise(function(o,l){var s={value:l},c={value:function(){--i===0&&o()}};n.each(function(){var a=le(this,r),u=a.on;u!==t&&(e=(t=u).copy(),e._.cancel.push(s),e._.interrupt.push(s),e._.end.push(c)),a.on=e}),i===0&&o()})}var vf=0;function he(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function Rl(){return++vf}var se=zn.prototype;he.prototype={constructor:he,select:Zc,selectAll:Jc,selectChild:se.selectChild,selectChildren:se.selectChildren,filter:Bc,merge:qc,selection:tf,transition:mf,call:se.call,nodes:se.nodes,node:se.node,size:se.size,empty:se.empty,each:se.each,on:jc,attr:Ac,attrTween:Ec,style:lf,styleTween:uf,text:df,textTween:gf,remove:Gc,tween:wc,delay:Uc,duration:Hc,ease:Yc,easeVarying:Pc,end:yf,[Symbol.iterator]:se[Symbol.iterator]};function _f(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var bf={time:null,delay:0,duration:250,ease:_f};function wf(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function xf(t){var e,n;t instanceof he?(e=t._id,t=t._name):(e=Rl(),(n=bf).time=oi(),t=t==null?null:t+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var l=r[o],s=l.length,c,a=0;a<s;++a)(c=l[a])&&gr(c,t,e,a,l,n||wf(c,e));return new he(r,this._parents,t,e)}zn.prototype.interrupt=vc;zn.prototype.transition=xf;const Br=Math.PI,qr=2*Br,we=1e-6,kf=qr-we;function Hl(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function Tf(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return Hl;const n=10**e;return function(r){this._+=r[0];for(let i=1,o=r.length;i<o;++i)this._+=Math.round(arguments[i]*n)/n+r[i]}}class Cf{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?Hl:Tf(e)}moveTo(e,n){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,n){this._append`L${this._x1=+e},${this._y1=+n}`}quadraticCurveTo(e,n,r,i){this._append`Q${+e},${+n},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(e,n,r,i,o,l){this._append`C${+e},${+n},${+r},${+i},${this._x1=+o},${this._y1=+l}`}arcTo(e,n,r,i,o){if(e=+e,n=+n,r=+r,i=+i,o=+o,o<0)throw new Error(`negative radius: ${o}`);let l=this._x1,s=this._y1,c=r-e,a=i-n,u=l-e,d=s-n,f=u*u+d*d;if(this._x1===null)this._append`M${this._x1=e},${this._y1=n}`;else if(f>we)if(!(Math.abs(d*c-a*u)>we)||!o)this._append`L${this._x1=e},${this._y1=n}`;else{let h=r-l,g=i-s,x=c*c+a*a,b=h*h+g*g,T=Math.sqrt(x),w=Math.sqrt(f),m=o*Math.tan((Br-Math.acos((x+f-b)/(2*T*w)))/2),v=m/w,S=m/T;Math.abs(v-1)>we&&this._append`L${e+v*u},${n+v*d}`,this._append`A${o},${o},0,0,${+(d*h>u*g)},${this._x1=e+S*c},${this._y1=n+S*a}`}}arc(e,n,r,i,o,l){if(e=+e,n=+n,r=+r,l=!!l,r<0)throw new Error(`negative radius: ${r}`);let s=r*Math.cos(i),c=r*Math.sin(i),a=e+s,u=n+c,d=1^l,f=l?i-o:o-i;this._x1===null?this._append`M${a},${u}`:(Math.abs(this._x1-a)>we||Math.abs(this._y1-u)>we)&&this._append`L${a},${u}`,r&&(f<0&&(f=f%qr+qr),f>kf?this._append`A${r},${r},0,1,${d},${e-s},${n-c}A${r},${r},0,1,${d},${this._x1=a},${this._y1=u}`:f>we&&this._append`A${r},${r},0,${+(f>=Br)},${d},${this._x1=e+r*Math.cos(o)},${this._y1=n+r*Math.sin(o)}`)}rect(e,n,r,i){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}}function zf(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function rr(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function Je(t){return t=rr(Math.abs(t)),t?t[1]:NaN}function Mf(t,e){return function(n,r){for(var i=n.length,o=[],l=0,s=t[0],c=0;i>0&&s>0&&(c+s+1>r&&(s=Math.max(1,r-c)),o.push(n.substring(i-=s,i+s)),!((c+=s+1)>r));)s=t[l=(l+1)%t.length];return o.reverse().join(e)}}function Af(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var Sf=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ir(t){if(!(e=Sf.exec(t)))throw new Error("invalid format: "+t);var e;return new ai({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}ir.prototype=ai.prototype;function ai(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}ai.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function $f(t){t:for(var e=t.length,n=1,r=-1,i;n<e;++n)switch(t[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+t[n])break t;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(i+1):t}var Ol;function Df(t,e){var n=rr(t,e);if(!n)return t+"";var r=n[0],i=n[1],o=i-(Ol=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,l=r.length;return o===l?r:o>l?r+new Array(o-l+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+rr(t,Math.max(0,e+o-1))[0]}function Oi(t,e){var n=rr(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const Yi={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:zf,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Oi(t*100,e),r:Oi,s:Df,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Wi(t){return t}var Pi=Array.prototype.map,Bi=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Nf(t){var e=t.grouping===void 0||t.thousands===void 0?Wi:Mf(Pi.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",o=t.numerals===void 0?Wi:Af(Pi.call(t.numerals,String)),l=t.percent===void 0?"%":t.percent+"",s=t.minus===void 0?"−":t.minus+"",c=t.nan===void 0?"NaN":t.nan+"";function a(d){d=ir(d);var f=d.fill,h=d.align,g=d.sign,x=d.symbol,b=d.zero,T=d.width,w=d.comma,m=d.precision,v=d.trim,S=d.type;S==="n"?(w=!0,S="g"):Yi[S]||(m===void 0&&(m=12),v=!0,S="g"),(b||f==="0"&&h==="=")&&(b=!0,f="0",h="=");var _=x==="$"?n:x==="#"&&/[boxX]/.test(S)?"0"+S.toLowerCase():"",M=x==="$"?r:/[%p]/.test(S)?l:"",N=Yi[S],A=/[defgprs%]/.test(S);m=m===void 0?6:/[gprs]/.test(S)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m));function I(B){var W=_,D=M,H,Q,U;if(S==="c")D=N(B)+D,B="";else{B=+B;var K=B<0||1/B<0;if(B=isNaN(B)?c:N(Math.abs(B),m),v&&(B=$f(B)),K&&+B==0&&g!=="+"&&(K=!1),W=(K?g==="("?g:s:g==="-"||g==="("?"":g)+W,D=(S==="s"?Bi[8+Ol/3]:"")+D+(K&&g==="("?")":""),A){for(H=-1,Q=B.length;++H<Q;)if(U=B.charCodeAt(H),48>U||U>57){D=(U===46?i+B.slice(H+1):B.slice(H))+D,B=B.slice(0,H);break}}}w&&!b&&(B=e(B,1/0));var tt=W.length+B.length+D.length,ft=tt<T?new Array(T-tt+1).join(f):"";switch(w&&b&&(B=e(ft+B,ft.length?T-D.length:1/0),ft=""),h){case"<":B=W+B+D+ft;break;case"=":B=W+ft+B+D;break;case"^":B=ft.slice(0,tt=ft.length>>1)+W+B+D+ft.slice(tt);break;default:B=ft+W+B+D;break}return o(B)}return I.toString=function(){return d+""},I}function u(d,f){var h=a((d=ir(d),d.type="f",d)),g=Math.max(-8,Math.min(8,Math.floor(Je(f)/3)))*3,x=Math.pow(10,-g),b=Bi[8+g/3];return function(T){return h(x*T)+b}}return{format:a,formatPrefix:u}}var Un,Yl,Wl;Ef({thousands:",",grouping:[3],currency:["$",""]});function Ef(t){return Un=Nf(t),Yl=Un.format,Wl=Un.formatPrefix,Un}function If(t){return Math.max(0,-Je(Math.abs(t)))}function Lf(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Je(e)/3)))*3-Je(Math.abs(t)))}function Uf(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Je(e)-Je(t))+1}function Ff(t){var e=0,n=t.children,r=n&&n.length;if(!r)e=1;else for(;--r>=0;)e+=n[r].value;t.value=e}function Rf(){return this.eachAfter(Ff)}function Hf(t,e){let n=-1;for(const r of this)t.call(e,r,++n,this);return this}function Of(t,e){for(var n=this,r=[n],i,o,l=-1;n=r.pop();)if(t.call(e,n,++l,this),i=n.children)for(o=i.length-1;o>=0;--o)r.push(i[o]);return this}function Yf(t,e){for(var n=this,r=[n],i=[],o,l,s,c=-1;n=r.pop();)if(i.push(n),o=n.children)for(l=0,s=o.length;l<s;++l)r.push(o[l]);for(;n=i.pop();)t.call(e,n,++c,this);return this}function Wf(t,e){let n=-1;for(const r of this)if(t.call(e,r,++n,this))return r}function Pf(t){return this.eachAfter(function(e){for(var n=+t(e.data)||0,r=e.children,i=r&&r.length;--i>=0;)n+=r[i].value;e.value=n})}function Bf(t){return this.eachBefore(function(e){e.children&&e.children.sort(t)})}function qf(t){for(var e=this,n=Vf(e,t),r=[e];e!==n;)e=e.parent,r.push(e);for(var i=r.length;t!==n;)r.splice(i,0,t),t=t.parent;return r}function Vf(t,e){if(t===e)return t;var n=t.ancestors(),r=e.ancestors(),i=null;for(t=n.pop(),e=r.pop();t===e;)i=t,t=n.pop(),e=r.pop();return i}function Xf(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e}function jf(){return Array.from(this)}function Kf(){var t=[];return this.eachBefore(function(e){e.children||t.push(e)}),t}function Gf(){var t=this,e=[];return t.each(function(n){n!==t&&e.push({source:n.parent,target:n})}),e}function*Zf(){var t=this,e,n=[t],r,i,o;do for(e=n.reverse(),n=[];t=e.pop();)if(yield t,r=t.children)for(i=0,o=r.length;i<o;++i)n.push(r[i]);while(n.length)}function re(t,e){t instanceof Map?(t=[void 0,t],e===void 0&&(e=td)):e===void 0&&(e=Qf);for(var n=new or(t),r,i=[n],o,l,s,c;r=i.pop();)if((l=e(r.data))&&(c=(l=Array.from(l)).length))for(r.children=l,s=c-1;s>=0;--s)i.push(o=l[s]=new or(l[s])),o.parent=r,o.depth=r.depth+1;return n.eachBefore(nd)}function Jf(){return re(this).eachBefore(ed)}function Qf(t){return t.children}function td(t){return Array.isArray(t)?t[1]:null}function ed(t){t.data.value!==void 0&&(t.value=t.data.value),t.data=t.data.data}function nd(t){var e=0;do t.height=e;while((t=t.parent)&&t.height<++e)}function or(t){this.data=t,this.depth=this.height=0,this.parent=null}or.prototype=re.prototype={constructor:or,count:Rf,each:Hf,eachAfter:Yf,eachBefore:Of,find:Wf,sum:Pf,sort:Bf,path:qf,ancestors:Xf,descendants:jf,leaves:Kf,links:Gf,copy:Jf,[Symbol.iterator]:Zf};function rd(t){if(typeof t!="function")throw new Error;return t}function ln(){return 0}function sn(t){return function(){return t}}function id(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)}function od(t,e,n,r,i){for(var o=t.children,l,s=-1,c=o.length,a=t.value&&(r-e)/t.value;++s<c;)l=o[s],l.y0=n,l.y1=i,l.x0=e,l.x1=e+=l.value*a}function ld(t,e,n,r,i){for(var o=t.children,l,s=-1,c=o.length,a=t.value&&(i-n)/t.value;++s<c;)l=o[s],l.x0=e,l.x1=r,l.y0=n,l.y1=n+=l.value*a}var sd=(1+Math.sqrt(5))/2;function ad(t,e,n,r,i,o){for(var l=[],s=e.children,c,a,u=0,d=0,f=s.length,h,g,x=e.value,b,T,w,m,v,S,_;u<f;){h=i-n,g=o-r;do b=s[d++].value;while(!b&&d<f);for(T=w=b,S=Math.max(g/h,h/g)/(x*t),_=b*b*S,v=Math.max(w/_,_/T);d<f;++d){if(b+=a=s[d].value,a<T&&(T=a),a>w&&(w=a),_=b*b*S,m=Math.max(w/_,_/T),m>v){b-=a;break}v=m}l.push(c={value:b,dice:h<g,children:s.slice(u,d)}),c.dice?od(c,n,r,i,x?r+=g*b/x:o):ld(c,n,r,x?n+=h*b/x:i,o),x-=b,u=d}return l}const ud=function t(e){function n(r,i,o,l,s){ad(e,r,i,o,l,s)}return n.ratio=function(r){return t((r=+r)>1?r:1)},n}(sd);function Pl(){var t=ud,e=!1,n=1,r=1,i=[0],o=ln,l=ln,s=ln,c=ln,a=ln;function u(f){return f.x0=f.y0=0,f.x1=n,f.y1=r,f.eachBefore(d),i=[0],e&&f.eachBefore(id),f}function d(f){var h=i[f.depth],g=f.x0+h,x=f.y0+h,b=f.x1-h,T=f.y1-h;b<g&&(g=b=(g+b)/2),T<x&&(x=T=(x+T)/2),f.x0=g,f.y0=x,f.x1=b,f.y1=T,f.children&&(h=i[f.depth+1]=o(f)/2,g+=a(f)-h,x+=l(f)-h,b-=s(f)-h,T-=c(f)-h,b<g&&(g=b=(g+b)/2),T<x&&(x=T=(x+T)/2),t(f,g,x,b,T))}return u.round=function(f){return arguments.length?(e=!!f,u):e},u.size=function(f){return arguments.length?(n=+f[0],r=+f[1],u):[n,r]},u.tile=function(f){return arguments.length?(t=rd(f),u):t},u.padding=function(f){return arguments.length?u.paddingInner(f).paddingOuter(f):u.paddingInner()},u.paddingInner=function(f){return arguments.length?(o=typeof f=="function"?f:sn(+f),u):o},u.paddingOuter=function(f){return arguments.length?u.paddingTop(f).paddingRight(f).paddingBottom(f).paddingLeft(f):u.paddingTop()},u.paddingTop=function(f){return arguments.length?(l=typeof f=="function"?f:sn(+f),u):l},u.paddingRight=function(f){return arguments.length?(s=typeof f=="function"?f:sn(+f),u):s},u.paddingBottom=function(f){return arguments.length?(c=typeof f=="function"?f:sn(+f),u):c},u.paddingLeft=function(f){return arguments.length?(a=typeof f=="function"?f:sn(+f),u):a},u}function mr(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}const qi=Symbol("implicit");function De(){var t=new Er,e=[],n=[],r=qi;function i(o){let l=t.get(o);if(l===void 0){if(r!==qi)return r;t.set(o,l=e.push(o)-1)}return n[l%n.length]}return i.domain=function(o){if(!arguments.length)return e.slice();e=[],t=new Er;for(const l of o)t.has(l)||t.set(l,e.push(l)-1);return i},i.range=function(o){return arguments.length?(n=Array.from(o),i):n.slice()},i.unknown=function(o){return arguments.length?(r=o,i):r},i.copy=function(){return De(e,n).unknown(r)},mr.apply(i,arguments),i}function ui(){var t=De().unknown(void 0),e=t.domain,n=t.range,r=0,i=1,o,l,s=!1,c=0,a=0,u=.5;delete t.unknown;function d(){var f=e().length,h=i<r,g=h?i:r,x=h?r:i;o=(x-g)/Math.max(1,f-c+a*2),s&&(o=Math.floor(o)),g+=(x-g-o*(f-c))*u,l=o*(1-c),s&&(g=Math.round(g),l=Math.round(l));var b=Ks(f).map(function(T){return g+o*T});return n(h?b.reverse():b)}return t.domain=function(f){return arguments.length?(e(f),d()):e()},t.range=function(f){return arguments.length?([r,i]=f,r=+r,i=+i,d()):[r,i]},t.rangeRound=function(f){return[r,i]=f,r=+r,i=+i,s=!0,d()},t.bandwidth=function(){return l},t.step=function(){return o},t.round=function(f){return arguments.length?(s=!!f,d()):s},t.padding=function(f){return arguments.length?(c=Math.min(1,a=+f),d()):c},t.paddingInner=function(f){return arguments.length?(c=Math.min(1,f),d()):c},t.paddingOuter=function(f){return arguments.length?(a=+f,d()):a},t.align=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),d()):u},t.copy=function(){return ui(e(),[r,i]).round(s).paddingInner(c).paddingOuter(a).align(u)},mr.apply(d(),arguments)}function cd(t){return function(){return t}}function fd(t){return+t}var Vi=[0,1];function He(t){return t}function Vr(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:cd(isNaN(e)?NaN:.5)}function dd(t,e){var n;return t>e&&(n=t,t=e,e=n),function(r){return Math.max(t,Math.min(e,r))}}function hd(t,e,n){var r=t[0],i=t[1],o=e[0],l=e[1];return i<r?(r=Vr(i,r),o=n(l,o)):(r=Vr(r,i),o=n(o,l)),function(s){return o(r(s))}}function pd(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),o=new Array(r),l=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++l<r;)i[l]=Vr(t[l],t[l+1]),o[l]=n(e[l],e[l+1]);return function(s){var c=Os(t,s,1,r)-1;return o[c](i[c](s))}}function Bl(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function gd(){var t=Vi,e=Vi,n=ii,r,i,o,l=He,s,c,a;function u(){var f=Math.min(t.length,e.length);return l!==He&&(l=dd(t[0],t[f-1])),s=f>2?pd:hd,c=a=null,d}function d(f){return f==null||isNaN(f=+f)?o:(c||(c=s(t.map(r),e,n)))(r(l(f)))}return d.invert=function(f){return l(i((a||(a=s(e,t.map(r),Jt)))(f)))},d.domain=function(f){return arguments.length?(t=Array.from(f,fd),u()):t.slice()},d.range=function(f){return arguments.length?(e=Array.from(f),u()):e.slice()},d.rangeRound=function(f){return e=Array.from(f),n=oc,u()},d.clamp=function(f){return arguments.length?(l=f?!0:He,u()):l!==He},d.interpolate=function(f){return arguments.length?(n=f,u()):n},d.unknown=function(f){return arguments.length?(o=f,d):o},function(f,h){return r=f,i=h,u()}}function ql(){return gd()(He,He)}function md(t,e,n,r){var i=Ur(t,e,n),o;switch(r=ir(r??",f"),r.type){case"s":{var l=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(o=Lf(i,l))&&(r.precision=o),Wl(r,l)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(o=Uf(i,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=o-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(o=If(i))&&(r.precision=o-(r.type==="%")*2);break}}return Yl(r)}function yd(t){var e=t.domain;return t.ticks=function(n){var r=e();return js(r[0],r[r.length-1],n??10)},t.tickFormat=function(n,r){var i=e();return md(i[0],i[i.length-1],n??10,r)},t.nice=function(n){n==null&&(n=10);var r=e(),i=0,o=r.length-1,l=r[i],s=r[o],c,a,u=10;for(s<l&&(a=l,l=s,s=a,a=i,i=o,o=a);u-- >0;){if(a=Lr(l,s,n),a===c)return r[i]=l,r[o]=s,e(r);if(a>0)l=Math.floor(l/a)*a,s=Math.ceil(s/a)*a;else if(a<0)l=Math.ceil(l*a)/a,s=Math.floor(s*a)/a;else break;c=a}return t},t}function wn(){var t=ql();return t.copy=function(){return Bl(t,wn())},mr.apply(t,arguments),yd(t)}function vd(t,e){t=t.slice();var n=0,r=t.length-1,i=t[n],o=t[r],l;return o<i&&(l=n,n=r,r=l,l=i,i=o,o=l),t[n]=e.floor(i),t[r]=e.ceil(o),t}const Tr=new Date,Cr=new Date;function Nt(t,e,n,r){function i(o){return t(o=arguments.length===0?new Date:new Date(+o)),o}return i.floor=o=>(t(o=new Date(+o)),o),i.ceil=o=>(t(o=new Date(o-1)),e(o,1),t(o),o),i.round=o=>{const l=i(o),s=i.ceil(o);return o-l<s-o?l:s},i.offset=(o,l)=>(e(o=new Date(+o),l==null?1:Math.floor(l)),o),i.range=(o,l,s)=>{const c=[];if(o=i.ceil(o),s=s==null?1:Math.floor(s),!(o<l)||!(s>0))return c;let a;do c.push(a=new Date(+o)),e(o,s),t(o);while(a<o&&o<l);return c},i.filter=o=>Nt(l=>{if(l>=l)for(;t(l),!o(l);)l.setTime(l-1)},(l,s)=>{if(l>=l)if(s<0)for(;++s<=0;)for(;e(l,-1),!o(l););else for(;--s>=0;)for(;e(l,1),!o(l););}),n&&(i.count=(o,l)=>(Tr.setTime(+o),Cr.setTime(+l),t(Tr),t(Cr),Math.floor(n(Tr,Cr))),i.every=o=>(o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?i.filter(r?l=>r(l)%o===0:l=>i.count(0,l)%o===0):i)),i}const lr=Nt(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);lr.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?Nt(e=>{e.setTime(Math.floor(e/t)*t)},(e,n)=>{e.setTime(+e+n*t)},(e,n)=>(n-e)/t):lr);lr.range;const ce=1e3,Kt=ce*60,fe=Kt*60,pe=fe*24,ci=pe*7,Xi=pe*30,zr=pe*365,Oe=Nt(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*ce)},(t,e)=>(e-t)/ce,t=>t.getUTCSeconds());Oe.range;const fi=Nt(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*ce)},(t,e)=>{t.setTime(+t+e*Kt)},(t,e)=>(e-t)/Kt,t=>t.getMinutes());fi.range;const _d=Nt(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*Kt)},(t,e)=>(e-t)/Kt,t=>t.getUTCMinutes());_d.range;const di=Nt(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*ce-t.getMinutes()*Kt)},(t,e)=>{t.setTime(+t+e*fe)},(t,e)=>(e-t)/fe,t=>t.getHours());di.range;const bd=Nt(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*fe)},(t,e)=>(e-t)/fe,t=>t.getUTCHours());bd.range;const An=Nt(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Kt)/pe,t=>t.getDate()-1);An.range;const hi=Nt(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/pe,t=>t.getUTCDate()-1);hi.range;const wd=Nt(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/pe,t=>Math.floor(t/pe));wd.range;function Ne(t){return Nt(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,n)=>{e.setDate(e.getDate()+n*7)},(e,n)=>(n-e-(n.getTimezoneOffset()-e.getTimezoneOffset())*Kt)/ci)}const yr=Ne(0),sr=Ne(1),xd=Ne(2),kd=Ne(3),Qe=Ne(4),Td=Ne(5),Cd=Ne(6);yr.range;sr.range;xd.range;kd.range;Qe.range;Td.range;Cd.range;function Ee(t){return Nt(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCDate(e.getUTCDate()+n*7)},(e,n)=>(n-e)/ci)}const Vl=Ee(0),ar=Ee(1),zd=Ee(2),Md=Ee(3),tn=Ee(4),Ad=Ee(5),Sd=Ee(6);Vl.range;ar.range;zd.range;Md.range;tn.range;Ad.range;Sd.range;const xn=Nt(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12,t=>t.getMonth());xn.range;const $d=Nt(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());$d.range;const ge=Nt(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());ge.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:Nt(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,n)=>{e.setFullYear(e.getFullYear()+n*t)});ge.range;const $e=Nt(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());$e.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:Nt(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCFullYear(e.getUTCFullYear()+n*t)});$e.range;function Dd(t,e,n,r,i,o){const l=[[Oe,1,ce],[Oe,5,5*ce],[Oe,15,15*ce],[Oe,30,30*ce],[o,1,Kt],[o,5,5*Kt],[o,15,15*Kt],[o,30,30*Kt],[i,1,fe],[i,3,3*fe],[i,6,6*fe],[i,12,12*fe],[r,1,pe],[r,2,2*pe],[n,1,ci],[e,1,Xi],[e,3,3*Xi],[t,1,zr]];function s(a,u,d){const f=u<a;f&&([a,u]=[u,a]);const h=d&&typeof d.range=="function"?d:c(a,u,d),g=h?h.range(a,+u+1):[];return f?g.reverse():g}function c(a,u,d){const f=Math.abs(u-a)/d,h=Qr(([,,b])=>b).right(l,f);if(h===l.length)return t.every(Ur(a/zr,u/zr,d));if(h===0)return lr.every(Math.max(Ur(a,u,d),1));const[g,x]=l[f/l[h-1][2]<l[h][2]/f?h-1:h];return g.every(x)}return[s,c]}const[Nd,Ed]=Dd(ge,xn,yr,An,di,fi);function Mr(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Ar(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function an(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function Id(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,o=t.days,l=t.shortDays,s=t.months,c=t.shortMonths,a=un(i),u=cn(i),d=un(o),f=cn(o),h=un(l),g=cn(l),x=un(s),b=cn(s),T=un(c),w=cn(c),m={a:K,A:tt,b:ft,B:kt,c:null,d:Qi,e:Qi,f:rh,g:hh,G:gh,H:th,I:eh,j:nh,L:Xl,m:ih,M:oh,p:j,q:P,Q:no,s:ro,S:lh,u:sh,U:ah,V:uh,w:ch,W:fh,x:null,X:null,y:dh,Y:ph,Z:mh,"%":eo},v={a:E,A:V,b:it,B:at,c:null,d:to,e:to,f:bh,g:$h,G:Nh,H:yh,I:vh,j:_h,L:Kl,m:wh,M:xh,p:wt,q:ut,Q:no,s:ro,S:kh,u:Th,U:Ch,V:zh,w:Mh,W:Ah,x:null,X:null,y:Sh,Y:Dh,Z:Eh,"%":eo},S={a:I,A:B,b:W,B:D,c:H,d:Zi,e:Zi,f:Gd,g:Gi,G:Ki,H:Ji,I:Ji,j:Vd,L:Kd,m:qd,M:Xd,p:A,q:Bd,Q:Jd,s:Qd,S:jd,u:Hd,U:Od,V:Yd,w:Rd,W:Wd,x:Q,X:U,y:Gi,Y:Ki,Z:Pd,"%":Zd};m.x=_(n,m),m.X=_(r,m),m.c=_(e,m),v.x=_(n,v),v.X=_(r,v),v.c=_(e,v);function _(q,lt){return function(st){var k=[],F=-1,G=0,ot=q.length,C,R,Y;for(st instanceof Date||(st=new Date(+st));++F<ot;)q.charCodeAt(F)===37&&(k.push(q.slice(G,F)),(R=ji[C=q.charAt(++F)])!=null?C=q.charAt(++F):R=C==="e"?" ":"0",(Y=lt[C])&&(C=Y(st,R)),k.push(C),G=F+1);return k.push(q.slice(G,F)),k.join("")}}function M(q,lt){return function(st){var k=an(1900,void 0,1),F=N(k,q,st+="",0),G,ot;if(F!=st.length)return null;if("Q"in k)return new Date(k.Q);if("s"in k)return new Date(k.s*1e3+("L"in k?k.L:0));if(lt&&!("Z"in k)&&(k.Z=0),"p"in k&&(k.H=k.H%12+k.p*12),k.m===void 0&&(k.m="q"in k?k.q:0),"V"in k){if(k.V<1||k.V>53)return null;"w"in k||(k.w=1),"Z"in k?(G=Ar(an(k.y,0,1)),ot=G.getUTCDay(),G=ot>4||ot===0?ar.ceil(G):ar(G),G=hi.offset(G,(k.V-1)*7),k.y=G.getUTCFullYear(),k.m=G.getUTCMonth(),k.d=G.getUTCDate()+(k.w+6)%7):(G=Mr(an(k.y,0,1)),ot=G.getDay(),G=ot>4||ot===0?sr.ceil(G):sr(G),G=An.offset(G,(k.V-1)*7),k.y=G.getFullYear(),k.m=G.getMonth(),k.d=G.getDate()+(k.w+6)%7)}else("W"in k||"U"in k)&&("w"in k||(k.w="u"in k?k.u%7:"W"in k?1:0),ot="Z"in k?Ar(an(k.y,0,1)).getUTCDay():Mr(an(k.y,0,1)).getDay(),k.m=0,k.d="W"in k?(k.w+6)%7+k.W*7-(ot+5)%7:k.w+k.U*7-(ot+6)%7);return"Z"in k?(k.H+=k.Z/100|0,k.M+=k.Z%100,Ar(k)):Mr(k)}}function N(q,lt,st,k){for(var F=0,G=lt.length,ot=st.length,C,R;F<G;){if(k>=ot)return-1;if(C=lt.charCodeAt(F++),C===37){if(C=lt.charAt(F++),R=S[C in ji?lt.charAt(F++):C],!R||(k=R(q,st,k))<0)return-1}else if(C!=st.charCodeAt(k++))return-1}return k}function A(q,lt,st){var k=a.exec(lt.slice(st));return k?(q.p=u.get(k[0].toLowerCase()),st+k[0].length):-1}function I(q,lt,st){var k=h.exec(lt.slice(st));return k?(q.w=g.get(k[0].toLowerCase()),st+k[0].length):-1}function B(q,lt,st){var k=d.exec(lt.slice(st));return k?(q.w=f.get(k[0].toLowerCase()),st+k[0].length):-1}function W(q,lt,st){var k=T.exec(lt.slice(st));return k?(q.m=w.get(k[0].toLowerCase()),st+k[0].length):-1}function D(q,lt,st){var k=x.exec(lt.slice(st));return k?(q.m=b.get(k[0].toLowerCase()),st+k[0].length):-1}function H(q,lt,st){return N(q,e,lt,st)}function Q(q,lt,st){return N(q,n,lt,st)}function U(q,lt,st){return N(q,r,lt,st)}function K(q){return l[q.getDay()]}function tt(q){return o[q.getDay()]}function ft(q){return c[q.getMonth()]}function kt(q){return s[q.getMonth()]}function j(q){return i[+(q.getHours()>=12)]}function P(q){return 1+~~(q.getMonth()/3)}function E(q){return l[q.getUTCDay()]}function V(q){return o[q.getUTCDay()]}function it(q){return c[q.getUTCMonth()]}function at(q){return s[q.getUTCMonth()]}function wt(q){return i[+(q.getUTCHours()>=12)]}function ut(q){return 1+~~(q.getUTCMonth()/3)}return{format:function(q){var lt=_(q+="",m);return lt.toString=function(){return q},lt},parse:function(q){var lt=M(q+="",!1);return lt.toString=function(){return q},lt},utcFormat:function(q){var lt=_(q+="",v);return lt.toString=function(){return q},lt},utcParse:function(q){var lt=M(q+="",!0);return lt.toString=function(){return q},lt}}}var ji={"-":"",_:" ",0:"0"},Et=/^\s*\d+/,Ld=/^%/,Ud=/[\\^$*+?|[\]().{}]/g;function zt(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(e)+i:i)}function Fd(t){return t.replace(Ud,"\\$&")}function un(t){return new RegExp("^(?:"+t.map(Fd).join("|")+")","i")}function cn(t){return new Map(t.map((e,n)=>[e.toLowerCase(),n]))}function Rd(t,e,n){var r=Et.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function Hd(t,e,n){var r=Et.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function Od(t,e,n){var r=Et.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function Yd(t,e,n){var r=Et.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function Wd(t,e,n){var r=Et.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function Ki(t,e,n){var r=Et.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function Gi(t,e,n){var r=Et.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function Pd(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Bd(t,e,n){var r=Et.exec(e.slice(n,n+1));return r?(t.q=r[0]*3-3,n+r[0].length):-1}function qd(t,e,n){var r=Et.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function Zi(t,e,n){var r=Et.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function Vd(t,e,n){var r=Et.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function Ji(t,e,n){var r=Et.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function Xd(t,e,n){var r=Et.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function jd(t,e,n){var r=Et.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function Kd(t,e,n){var r=Et.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function Gd(t,e,n){var r=Et.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function Zd(t,e,n){var r=Ld.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function Jd(t,e,n){var r=Et.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function Qd(t,e,n){var r=Et.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function Qi(t,e){return zt(t.getDate(),e,2)}function th(t,e){return zt(t.getHours(),e,2)}function eh(t,e){return zt(t.getHours()%12||12,e,2)}function nh(t,e){return zt(1+An.count(ge(t),t),e,3)}function Xl(t,e){return zt(t.getMilliseconds(),e,3)}function rh(t,e){return Xl(t,e)+"000"}function ih(t,e){return zt(t.getMonth()+1,e,2)}function oh(t,e){return zt(t.getMinutes(),e,2)}function lh(t,e){return zt(t.getSeconds(),e,2)}function sh(t){var e=t.getDay();return e===0?7:e}function ah(t,e){return zt(yr.count(ge(t)-1,t),e,2)}function jl(t){var e=t.getDay();return e>=4||e===0?Qe(t):Qe.ceil(t)}function uh(t,e){return t=jl(t),zt(Qe.count(ge(t),t)+(ge(t).getDay()===4),e,2)}function ch(t){return t.getDay()}function fh(t,e){return zt(sr.count(ge(t)-1,t),e,2)}function dh(t,e){return zt(t.getFullYear()%100,e,2)}function hh(t,e){return t=jl(t),zt(t.getFullYear()%100,e,2)}function ph(t,e){return zt(t.getFullYear()%1e4,e,4)}function gh(t,e){var n=t.getDay();return t=n>=4||n===0?Qe(t):Qe.ceil(t),zt(t.getFullYear()%1e4,e,4)}function mh(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+zt(e/60|0,"0",2)+zt(e%60,"0",2)}function to(t,e){return zt(t.getUTCDate(),e,2)}function yh(t,e){return zt(t.getUTCHours(),e,2)}function vh(t,e){return zt(t.getUTCHours()%12||12,e,2)}function _h(t,e){return zt(1+hi.count($e(t),t),e,3)}function Kl(t,e){return zt(t.getUTCMilliseconds(),e,3)}function bh(t,e){return Kl(t,e)+"000"}function wh(t,e){return zt(t.getUTCMonth()+1,e,2)}function xh(t,e){return zt(t.getUTCMinutes(),e,2)}function kh(t,e){return zt(t.getUTCSeconds(),e,2)}function Th(t){var e=t.getUTCDay();return e===0?7:e}function Ch(t,e){return zt(Vl.count($e(t)-1,t),e,2)}function Gl(t){var e=t.getUTCDay();return e>=4||e===0?tn(t):tn.ceil(t)}function zh(t,e){return t=Gl(t),zt(tn.count($e(t),t)+($e(t).getUTCDay()===4),e,2)}function Mh(t){return t.getUTCDay()}function Ah(t,e){return zt(ar.count($e(t)-1,t),e,2)}function Sh(t,e){return zt(t.getUTCFullYear()%100,e,2)}function $h(t,e){return t=Gl(t),zt(t.getUTCFullYear()%100,e,2)}function Dh(t,e){return zt(t.getUTCFullYear()%1e4,e,4)}function Nh(t,e){var n=t.getUTCDay();return t=n>=4||n===0?tn(t):tn.ceil(t),zt(t.getUTCFullYear()%1e4,e,4)}function Eh(){return"+0000"}function eo(){return"%"}function no(t){return+t}function ro(t){return Math.floor(+t/1e3)}var Ue,Ye;Ih({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Ih(t){return Ue=Id(t),Ye=Ue.format,Ue.parse,Ue.utcFormat,Ue.utcParse,Ue}function Lh(t){return new Date(t)}function Uh(t){return t instanceof Date?+t:+new Date(+t)}function Zl(t,e,n,r,i,o,l,s,c,a){var u=ql(),d=u.invert,f=u.domain,h=a(".%L"),g=a(":%S"),x=a("%I:%M"),b=a("%I %p"),T=a("%a %d"),w=a("%b %d"),m=a("%B"),v=a("%Y");function S(_){return(c(_)<_?h:s(_)<_?g:l(_)<_?x:o(_)<_?b:r(_)<_?i(_)<_?T:w:n(_)<_?m:v)(_)}return u.invert=function(_){return new Date(d(_))},u.domain=function(_){return arguments.length?f(Array.from(_,Uh)):f().map(Lh)},u.ticks=function(_){var M=f();return t(M[0],M[M.length-1],_??10)},u.tickFormat=function(_,M){return M==null?S:a(M)},u.nice=function(_){var M=f();return(!_||typeof _.range!="function")&&(_=e(M[0],M[M.length-1],_??10)),_?f(vd(M,_)):u},u.copy=function(){return Bl(u,Zl(t,e,n,r,i,o,l,s,c,a))},u}function Fh(){return mr.apply(Zl(Nd,Ed,ge,xn,yr,An,di,fi,Oe,Ye).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Rh(t){for(var e=t.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+t.slice(r*6,++r*6);return n}const Sn=Rh("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf");function Mt(t){return function(){return t}}const io=Math.abs,Lt=Math.atan2,be=Math.cos,Hh=Math.max,Sr=Math.min,ne=Math.sin,We=Math.sqrt,Ft=1e-12,kn=Math.PI,ur=kn/2,Bn=2*kn;function Oh(t){return t>1?0:t<-1?kn:Math.acos(t)}function oo(t){return t>=1?ur:t<=-1?-ur:Math.asin(t)}function Jl(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(n==null)e=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);e=r}return t},()=>new Cf(e)}function Yh(t){return t.innerRadius}function Wh(t){return t.outerRadius}function Ph(t){return t.startAngle}function Bh(t){return t.endAngle}function qh(t){return t&&t.padAngle}function Vh(t,e,n,r,i,o,l,s){var c=n-t,a=r-e,u=l-i,d=s-o,f=d*c-u*a;if(!(f*f<Ft))return f=(u*(e-o)-d*(t-i))/f,[t+f*c,e+f*a]}function Fn(t,e,n,r,i,o,l){var s=t-n,c=e-r,a=(l?o:-o)/We(s*s+c*c),u=a*c,d=-a*s,f=t+u,h=e+d,g=n+u,x=r+d,b=(f+g)/2,T=(h+x)/2,w=g-f,m=x-h,v=w*w+m*m,S=i-o,_=f*x-g*h,M=(m<0?-1:1)*We(Hh(0,S*S*v-_*_)),N=(_*m-w*M)/v,A=(-_*w-m*M)/v,I=(_*m+w*M)/v,B=(-_*w+m*M)/v,W=N-b,D=A-T,H=I-b,Q=B-T;return W*W+D*D>H*H+Q*Q&&(N=I,A=B),{cx:N,cy:A,x01:-u,y01:-d,x11:N*(i/S-1),y11:A*(i/S-1)}}function lo(){var t=Yh,e=Wh,n=Mt(0),r=null,i=Ph,o=Bh,l=qh,s=null,c=Jl(a);function a(){var u,d,f=+t.apply(this,arguments),h=+e.apply(this,arguments),g=i.apply(this,arguments)-ur,x=o.apply(this,arguments)-ur,b=io(x-g),T=x>g;if(s||(s=u=c()),h<f&&(d=h,h=f,f=d),!(h>Ft))s.moveTo(0,0);else if(b>Bn-Ft)s.moveTo(h*be(g),h*ne(g)),s.arc(0,0,h,g,x,!T),f>Ft&&(s.moveTo(f*be(x),f*ne(x)),s.arc(0,0,f,x,g,T));else{var w=g,m=x,v=g,S=x,_=b,M=b,N=l.apply(this,arguments)/2,A=N>Ft&&(r?+r.apply(this,arguments):We(f*f+h*h)),I=Sr(io(h-f)/2,+n.apply(this,arguments)),B=I,W=I,D,H;if(A>Ft){var Q=oo(A/f*ne(N)),U=oo(A/h*ne(N));(_-=Q*2)>Ft?(Q*=T?1:-1,v+=Q,S-=Q):(_=0,v=S=(g+x)/2),(M-=U*2)>Ft?(U*=T?1:-1,w+=U,m-=U):(M=0,w=m=(g+x)/2)}var K=h*be(w),tt=h*ne(w),ft=f*be(S),kt=f*ne(S);if(I>Ft){var j=h*be(m),P=h*ne(m),E=f*be(v),V=f*ne(v),it;if(b<kn)if(it=Vh(K,tt,E,V,j,P,ft,kt)){var at=K-it[0],wt=tt-it[1],ut=j-it[0],q=P-it[1],lt=1/ne(Oh((at*ut+wt*q)/(We(at*at+wt*wt)*We(ut*ut+q*q)))/2),st=We(it[0]*it[0]+it[1]*it[1]);B=Sr(I,(f-st)/(lt-1)),W=Sr(I,(h-st)/(lt+1))}else B=W=0}M>Ft?W>Ft?(D=Fn(E,V,K,tt,h,W,T),H=Fn(j,P,ft,kt,h,W,T),s.moveTo(D.cx+D.x01,D.cy+D.y01),W<I?s.arc(D.cx,D.cy,W,Lt(D.y01,D.x01),Lt(H.y01,H.x01),!T):(s.arc(D.cx,D.cy,W,Lt(D.y01,D.x01),Lt(D.y11,D.x11),!T),s.arc(0,0,h,Lt(D.cy+D.y11,D.cx+D.x11),Lt(H.cy+H.y11,H.cx+H.x11),!T),s.arc(H.cx,H.cy,W,Lt(H.y11,H.x11),Lt(H.y01,H.x01),!T))):(s.moveTo(K,tt),s.arc(0,0,h,w,m,!T)):s.moveTo(K,tt),!(f>Ft)||!(_>Ft)?s.lineTo(ft,kt):B>Ft?(D=Fn(ft,kt,j,P,f,-B,T),H=Fn(K,tt,E,V,f,-B,T),s.lineTo(D.cx+D.x01,D.cy+D.y01),B<I?s.arc(D.cx,D.cy,B,Lt(D.y01,D.x01),Lt(H.y01,H.x01),!T):(s.arc(D.cx,D.cy,B,Lt(D.y01,D.x01),Lt(D.y11,D.x11),!T),s.arc(0,0,f,Lt(D.cy+D.y11,D.cx+D.x11),Lt(H.cy+H.y11,H.cx+H.x11),T),s.arc(H.cx,H.cy,B,Lt(H.y11,H.x11),Lt(H.y01,H.x01),!T))):s.arc(0,0,f,S,v,T)}if(s.closePath(),u)return s=null,u+""||null}return a.centroid=function(){var u=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,d=(+i.apply(this,arguments)+ +o.apply(this,arguments))/2-kn/2;return[be(d)*u,ne(d)*u]},a.innerRadius=function(u){return arguments.length?(t=typeof u=="function"?u:Mt(+u),a):t},a.outerRadius=function(u){return arguments.length?(e=typeof u=="function"?u:Mt(+u),a):e},a.cornerRadius=function(u){return arguments.length?(n=typeof u=="function"?u:Mt(+u),a):n},a.padRadius=function(u){return arguments.length?(r=u==null?null:typeof u=="function"?u:Mt(+u),a):r},a.startAngle=function(u){return arguments.length?(i=typeof u=="function"?u:Mt(+u),a):i},a.endAngle=function(u){return arguments.length?(o=typeof u=="function"?u:Mt(+u),a):o},a.padAngle=function(u){return arguments.length?(l=typeof u=="function"?u:Mt(+u),a):l},a.context=function(u){return arguments.length?(s=u??null,a):s},a}function pi(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Ql(t){this._context=t}Ql.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function Xh(t){return new Ql(t)}function jh(t){return t[0]}function Kh(t){return t[1]}function so(t,e){var n=Mt(!0),r=null,i=Xh,o=null,l=Jl(s);t=typeof t=="function"?t:t===void 0?jh:Mt(t),e=typeof e=="function"?e:e===void 0?Kh:Mt(e);function s(c){var a,u=(c=pi(c)).length,d,f=!1,h;for(r==null&&(o=i(h=l())),a=0;a<=u;++a)!(a<u&&n(d=c[a],a,c))===f&&((f=!f)?o.lineStart():o.lineEnd()),f&&o.point(+t(d,a,c),+e(d,a,c));if(h)return o=null,h+""||null}return s.x=function(c){return arguments.length?(t=typeof c=="function"?c:Mt(+c),s):t},s.y=function(c){return arguments.length?(e=typeof c=="function"?c:Mt(+c),s):e},s.defined=function(c){return arguments.length?(n=typeof c=="function"?c:Mt(!!c),s):n},s.curve=function(c){return arguments.length?(i=c,r!=null&&(o=i(r)),s):i},s.context=function(c){return arguments.length?(c==null?r=o=null:o=i(r=c),s):r},s}function Gh(t,e){return e<t?-1:e>t?1:e>=t?0:NaN}function Zh(t){return t}function Jh(){var t=Zh,e=Gh,n=null,r=Mt(0),i=Mt(Bn),o=Mt(0);function l(s){var c,a=(s=pi(s)).length,u,d,f=0,h=new Array(a),g=new Array(a),x=+r.apply(this,arguments),b=Math.min(Bn,Math.max(-Bn,i.apply(this,arguments)-x)),T,w=Math.min(Math.abs(b)/a,o.apply(this,arguments)),m=w*(b<0?-1:1),v;for(c=0;c<a;++c)(v=g[h[c]=c]=+t(s[c],c,s))>0&&(f+=v);for(e!=null?h.sort(function(S,_){return e(g[S],g[_])}):n!=null&&h.sort(function(S,_){return n(s[S],s[_])}),c=0,d=f?(b-a*m)/f:0;c<a;++c,x=T)u=h[c],v=g[u],T=x+(v>0?v*d:0)+m,g[u]={data:s[u],index:c,value:v,startAngle:x,endAngle:T,padAngle:w};return g}return l.value=function(s){return arguments.length?(t=typeof s=="function"?s:Mt(+s),l):t},l.sortValues=function(s){return arguments.length?(e=s,n=null,l):e},l.sort=function(s){return arguments.length?(n=s,e=null,l):n},l.startAngle=function(s){return arguments.length?(r=typeof s=="function"?s:Mt(+s),l):r},l.endAngle=function(s){return arguments.length?(i=typeof s=="function"?s:Mt(+s),l):i},l.padAngle=function(s){return arguments.length?(o=typeof s=="function"?s:Mt(+s),l):o},l}function ao(t){return t<0?-1:1}function uo(t,e,n){var r=t._x1-t._x0,i=e-t._x1,o=(t._y1-t._y0)/(r||i<0&&-0),l=(n-t._y1)/(i||r<0&&-0),s=(o*i+l*r)/(r+i);return(ao(o)+ao(l))*Math.min(Math.abs(o),Math.abs(l),.5*Math.abs(s))||0}function co(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function $r(t,e,n){var r=t._x0,i=t._y0,o=t._x1,l=t._y1,s=(o-r)/3;t._context.bezierCurveTo(r+s,i+s*e,o-s,l-s*n,o,l)}function cr(t){this._context=t}cr.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:$r(this,this._t0,co(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,$r(this,co(this,n=uo(this,t,e)),n);break;default:$r(this,this._t0,n=uo(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}};Object.create(cr.prototype).point=function(t,e){cr.prototype.point.call(this,e,t)};function fo(t){return new cr(t)}function ho(t,e){if((l=t.length)>1)for(var n=1,r,i,o=t[e[0]],l,s=o.length;n<l;++n)for(i=o,o=t[e[n]],r=0;r<s;++r)o[r][1]+=o[r][0]=isNaN(i[r][1])?i[r][0]:i[r][1]}function po(t){for(var e=t.length,n=new Array(e);--e>=0;)n[e]=e;return n}function Qh(t,e){return t[e]}function tp(t){const e=[];return e.key=t,e}function ep(){var t=Mt([]),e=po,n=ho,r=Qh;function i(o){var l=Array.from(t.apply(this,arguments),tp),s,c=l.length,a=-1,u;for(const d of o)for(s=0,++a;s<c;++s)(l[s][a]=[0,+r(d,l[s].key,a,o)]).data=d;for(s=0,u=pi(e(l));s<c;++s)l[u[s]].index=s;return n(l,u),l}return i.keys=function(o){return arguments.length?(t=typeof o=="function"?o:Mt(Array.from(o)),i):t},i.value=function(o){return arguments.length?(r=typeof o=="function"?o:Mt(+o),i):r},i.order=function(o){return arguments.length?(e=o==null?po:typeof o=="function"?o:Mt(Array.from(o)),i):e},i.offset=function(o){return arguments.length?(n=o??ho,i):n},i}function pn(t,e,n){this.k=t,this.x=e,this.y=n}pn.prototype={constructor:pn,scale:function(t){return t===1?this:new pn(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new pn(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};pn.prototype;function np(t){const e=t-1;return e*e*e+1}function go(t,{delay:e=0,duration:n=400,easing:r=np,axis:i="y"}={}){const o=getComputedStyle(t),l=+o.opacity,s=i==="y"?"height":"width",c=parseFloat(o[s]),a=i==="y"?["top","bottom"]:["left","right"],u=a.map(T=>`${T[0].toUpperCase()}${T.slice(1)}`),d=parseFloat(o[`padding${u[0]}`]),f=parseFloat(o[`padding${u[1]}`]),h=parseFloat(o[`margin${u[0]}`]),g=parseFloat(o[`margin${u[1]}`]),x=parseFloat(o[`border${u[0]}Width`]),b=parseFloat(o[`border${u[1]}Width`]);return{delay:e,duration:n,easing:r,css:T=>`overflow: hidden;opacity: ${Math.min(T*20,1)*l};${s}: ${T*c}px;padding-${a[0]}: ${T*d}px;padding-${a[1]}: ${T*f}px;margin-${a[0]}: ${T*h}px;margin-${a[1]}: ${T*g}px;border-${a[0]}-width: ${T*x}px;border-${a[1]}-width: ${T*b}px;`}}function rp(t){let e;return{c(){e=L(t[7])},m(n,r){J(n,e,r)},p(n,r){r&128&&et(e,n[7])},d(n){n&&Z(e)}}}function ip(t){let e,n;return{c(){e=new cs(!1),n=nl(),e.a=n},m(r,i){e.m(t[5],r,i),J(r,n,i)},p(r,i){i&32&&e.p(r[5])},d(r){r&&Z(n),r&&e.d()}}}function mo(t){let e,n,r=(t[0]?bt("ui.hide_description"):bt("ui.show_description"))+"",i,o,l,s,c,a;return{c(){e=z("button"),n=z("span"),i=L(r),o=rt(),l=mn("svg"),s=mn("path"),y(n,"class","sr-only svelte-1o4uev"),y(s,"d","M5 7.5L10 12.5L15 7.5"),y(s,"stroke","currentColor"),y(s,"stroke-width","2"),y(s,"stroke-linecap","round"),y(s,"stroke-linejoin","round"),y(l,"class","accordion-icon svelte-1o4uev"),y(l,"width","20"),y(l,"height","20"),y(l,"viewBox","0 0 20 20"),y(l,"fill","none"),y(l,"xmlns","http://www.w3.org/2000/svg"),oe(l,"open",t[0]),y(e,"class","accordion-toggle svelte-1o4uev"),y(e,"aria-expanded",t[0]),y(e,"aria-controls","description-panel")},m(u,d){J(u,e,d),p(e,n),p(n,i),p(e,o),p(e,l),p(l,s),c||(a=[St(e,"click",t[8]),St(e,"keydown",t[9])],c=!0)},p(u,d){d&1&&r!==(r=(u[0]?bt("ui.hide_description"):bt("ui.show_description"))+"")&&et(i,r),d&1&&oe(l,"open",u[0]),d&1&&y(e,"aria-expanded",u[0])},d(u){u&&Z(e),c=!1,Ut(a)}}}function yo(t){let e,n,r=t[0]&&vo(t);return{c(){e=z("div"),r&&r.c(),y(e,"class","description-panel-wrapper svelte-1o4uev")},m(i,o){J(i,e,o),r&&r.m(e,null),n=!0},p(i,o){i[0]?r?(r.p(i,o),o&1&&At(r,1)):(r=vo(i),r.c(),At(r,1),r.m(e,null)):r&&(Kr(),$t(r,1,1,()=>{r=null}),Gr())},i(i){n||(At(r),n=!0)},o(i){$t(r),n=!1},d(i){i&&Z(e),r&&r.d()}}}function vo(t){let e,n,r,i,o;return{c(){e=z("div"),n=z("p"),r=L(t[6]),y(n,"class","svelte-1o4uev"),y(e,"id","description-panel"),y(e,"class","description-panel svelte-1o4uev")},m(l,s){J(l,e,s),p(e,n),p(n,r),o=!0},p(l,s){(!o||s&64)&&et(r,l[6])},i(l){o||(Me(()=>{o&&(i||(i=bi(e,go,{duration:300},!0)),i.run(1))}),o=!0)},o(l){i||(i=bi(e,go,{duration:300},!1)),i.run(0),o=!1},d(l){l&&Z(e),l&&i&&i.end()}}}function op(t){let e,n,r,i,o,l;function s(f,h){if(f[5])return ip;if(f[2]||f[1])return rp}let c=s(t),a=c&&c(t),u=(t[3]||t[4])&&mo(t),d=(t[3]||t[4])&&yo(t);return{c(){e=z("div"),n=z("div"),r=z("h2"),a&&a.c(),i=rt(),u&&u.c(),o=rt(),d&&d.c(),y(r,"class","visualization-title svelte-1o4uev"),y(n,"class","title-container svelte-1o4uev"),y(e,"class","visualization-header svelte-1o4uev"),oe(e,"has-description",t[0])},m(f,h){J(f,e,h),p(e,n),p(n,r),a&&a.m(r,null),p(n,i),u&&u.m(n,null),p(e,o),d&&d.m(e,null),l=!0},p(f,[h]){c===(c=s(f))&&a?a.p(f,h):(a&&a.d(1),a=c&&c(f),a&&(a.c(),a.m(r,null))),f[3]||f[4]?u?u.p(f,h):(u=mo(f),u.c(),u.m(n,null)):u&&(u.d(1),u=null),f[3]||f[4]?d?(d.p(f,h),h&24&&At(d,1)):(d=yo(f),d.c(),At(d,1),d.m(e,null)):d&&(Kr(),$t(d,1,1,()=>{d=null}),Gr()),(!l||h&1)&&oe(e,"has-description",f[0])},i(f){l||(At(d),l=!0)},o(f){$t(d),l=!1},d(f){f&&Z(e),a&&a.d(),u&&u.d(),d&&d.d()}}}function lp(t,e,n){let r,i,{title:o}=e,{translationKey:l=""}=e,{description:s=""}=e,{showDescription:c=!1}=e,{descriptionTranslationKey:a=""}=e,{titleHtml:u=""}=e;function d(){n(0,c=!c)}const f=h=>h.key==="Enter"&&d();return t.$$set=h=>{"title"in h&&n(1,o=h.title),"translationKey"in h&&n(2,l=h.translationKey),"description"in h&&n(3,s=h.description),"showDescription"in h&&n(0,c=h.showDescription),"descriptionTranslationKey"in h&&n(4,a=h.descriptionTranslationKey),"titleHtml"in h&&n(5,u=h.titleHtml)},t.$$.update=()=>{t.$$.dirty&6&&n(7,r=l?bt(l):o),t.$$.dirty&24&&n(6,i=a?bt(a):s)},[c,o,l,s,a,u,i,r,d,f]}class sp extends Zt{constructor(e){super(),Gt(this,e,lp,op,Xt,{title:1,translationKey:2,description:3,showDescription:0,descriptionTranslationKey:4,titleHtml:5})}}function ap(t){let e;return{c(){e=z("div"),e.textContent=`${bt("ui.no_visualization_content")}`,y(e,"class","no-content svelte-1jo3qap")},m(n,r){J(n,e,r)},p:xt,d(n){n&&Z(e)}}}function up(t){let e,n=t[6].error+"",r;return{c(){e=z("div"),r=L(n),y(e,"class","error svelte-1jo3qap")},m(i,o){J(i,e,o),p(e,r)},p(i,o){o&64&&n!==(n=i[6].error+"")&&et(r,n)},d(i){i&&Z(e)}}}function cp(t){let e;return{c(){e=z("div"),e.textContent=`${bt("ui.loading")}`,y(e,"class","loading svelte-1jo3qap")},m(n,r){J(n,e,r)},p:xt,d(n){n&&Z(e)}}}function fp(t){let e;function n(o,l){return o[6].loading?cp:o[6].error?up:ap}let r=n(t),i=r(t);return{c(){e=z("div"),i.c(),y(e,"class","empty-visualization svelte-1jo3qap")},m(o,l){J(o,e,l),i.m(e,null)},p(o,l){r===(r=n(o))&&i?i.p(o,l):(i.d(1),i=r(o),i&&(i.c(),i.m(e,null)))},d(o){o&&Z(e),i.d()}}}function dp(t){let e,n,r,i,o,l;function s(f){t[9](f)}let c={title:t[1],translationKey:t[2],description:t[3],descriptionTranslationKey:t[4],titleHtml:t[5]};t[0]!==void 0&&(c.showDescription=t[0]),n=new sp({props:c}),de.push(()=>ws(n,"showDescription",s));const a=t[8].default,u=jo(a,t,t[7],null),d=u||fp(t);return{c(){e=z("div"),Bt(n.$$.fragment),i=rt(),o=z("div"),d&&d.c(),y(o,"class","visualization-content svelte-1jo3qap"),y(e,"class","visualization-wrapper svelte-1jo3qap")},m(f,h){J(f,e,h),Ht(n,e,null),p(e,i),p(e,o),d&&d.m(o,null),l=!0},p(f,[h]){const g={};h&2&&(g.title=f[1]),h&4&&(g.translationKey=f[2]),h&8&&(g.description=f[3]),h&16&&(g.descriptionTranslationKey=f[4]),h&32&&(g.titleHtml=f[5]),!r&&h&1&&(r=!0,g.showDescription=f[0],ms(()=>r=!1)),n.$set(g),u?u.p&&(!l||h&128)&&Zo(u,a,f,f[7],l?Go(a,f[7],h,null):Jo(f[7]),null):d&&d.p&&(!l||h&64)&&d.p(f,l?h:-1)},i(f){l||(At(n.$$.fragment,f),At(d,f),l=!0)},o(f){$t(n.$$.fragment,f),$t(d,f),l=!1},d(f){f&&Z(e),Ot(n),d&&d.d(f)}}}function hp(t,e,n){let r;yt(t,It,h=>n(6,r=h));let{$$slots:i={},$$scope:o}=e,{title:l}=e,{translationKey:s=""}=e,{description:c=""}=e,{descriptionTranslationKey:a=""}=e,{showDescription:u=!1}=e,{titleHtml:d=""}=e;function f(h){u=h,n(0,u)}return t.$$set=h=>{"title"in h&&n(1,l=h.title),"translationKey"in h&&n(2,s=h.translationKey),"description"in h&&n(3,c=h.description),"descriptionTranslationKey"in h&&n(4,a=h.descriptionTranslationKey),"showDescription"in h&&n(0,u=h.showDescription),"titleHtml"in h&&n(5,d=h.titleHtml),"$$scope"in h&&n(7,o=h.$$scope)},[u,l,s,c,a,d,r,o,i,f]}class gi extends Zt{constructor(e){super(),Gt(this,e,hp,dp,Xt,{title:1,translationKey:2,description:3,descriptionTranslationKey:4,showDescription:0,titleHtml:5})}}function pp(t){let e;return{c(){e=z("div"),e.textContent="Initializing visualization...",y(e,"class","loading svelte-63tjyd")},m(n,r){J(n,e,r)},p:xt,d(n){n&&Z(e)}}}function gp(t){let e,n;return{c(){e=z("div"),n=L(t[9]),y(e,"class","no-data svelte-63tjyd")},m(r,i){J(r,e,i),p(e,n)},p(r,i){i[0]&512&&et(n,r[9])},d(r){r&&Z(e)}}}function mp(t){let e,n=t[3].error+"",r;return{c(){e=z("div"),r=L(n),y(e,"class","error svelte-63tjyd")},m(i,o){J(i,e,o),p(e,r)},p(i,o){o[0]&8&&n!==(n=i[3].error+"")&&et(r,n)},d(i){i&&Z(e)}}}function yp(t){let e;return{c(){e=z("div"),e.textContent=`${bt("ui.loading")}`,y(e,"class","loading svelte-63tjyd")},m(n,r){J(n,e,r)},p:xt,d(n){n&&Z(e)}}}function vp(t){let e,n;return{c(){e=z("p"),n=L(t[7]),y(e,"class","svelte-63tjyd")},m(r,i){J(r,e,i),p(e,n)},p(r,i){i[0]&128&&et(n,r[7])},d(r){r&&Z(e)}}}function _p(t){let e,n,r,i,o=t[6].data.name+"",l,s,c,a;return{c(){e=z("p"),n=L(t[13]),r=L(": "),i=z("strong"),l=L(o),s=rt(),c=z("p"),a=L(t[14]),y(e,"class","svelte-63tjyd"),y(c,"class","svelte-63tjyd")},m(u,d){J(u,e,d),p(e,n),p(e,r),p(e,i),p(i,l),J(u,s,d),J(u,c,d),p(c,a)},p(u,d){d[0]&8192&&et(n,u[13]),d[0]&64&&o!==(o=u[6].data.name+"")&&et(l,o),d[0]&16384&&et(a,u[14])},d(u){u&&Z(e),u&&Z(s),u&&Z(c)}}}function bp(t){let e,n,r,i,o,l,s,c,a,u,d,f,h,g,x,b,T,w,m,v,S,_,M,N,A;function I(U,K){if(U[3].loading)return yp;if(U[3].error)return mp;if(!U[3].items||U[3].items.length===0)return gp;if(!U[0])return pp}let B=I(t),W=B&&B(t);function D(U,K){return U[6]?_p:vp}let H=D(t),Q=H(t);return{c(){e=z("div"),W&&W.c(),n=rt(),r=z("div"),i=z("div"),o=z("h3"),l=L(t[10]),s=rt(),c=z("p"),a=L(t[11]),u=L(": "),d=z("strong"),f=L(t[2]),h=rt(),g=z("p"),x=L(t[12]),b=L(": "),T=z("strong"),w=L(t[4]),m=rt(),v=z("p"),S=L(t[8]),_=L(": "),M=z("strong"),N=L(t[5]),A=rt(),Q.c(),y(e,"class","chart-container svelte-63tjyd"),y(o,"class","svelte-63tjyd"),y(c,"class","svelte-63tjyd"),y(g,"class","svelte-63tjyd"),y(v,"class","svelte-63tjyd"),y(i,"class","stat-summary svelte-63tjyd"),y(r,"class","stats svelte-63tjyd")},m(U,K){J(U,e,K),W&&W.m(e,null),t[28](e),J(U,n,K),J(U,r,K),p(r,i),p(i,o),p(o,l),p(i,s),p(i,c),p(c,a),p(c,u),p(c,d),p(d,f),p(i,h),p(i,g),p(g,x),p(g,b),p(g,T),p(T,w),p(i,m),p(i,v),p(v,S),p(v,_),p(v,M),p(M,N),p(i,A),Q.m(i,null)},p(U,K){B===(B=I(U))&&W?W.p(U,K):(W&&W.d(1),W=B&&B(U),W&&(W.c(),W.m(e,null))),K[0]&1024&&et(l,U[10]),K[0]&2048&&et(a,U[11]),K[0]&4&&et(f,U[2]),K[0]&4096&&et(x,U[12]),K[0]&16&&et(w,U[4]),K[0]&256&&et(S,U[8]),K[0]&32&&et(N,U[5]),H===(H=D(U))&&Q?Q.p(U,K):(Q.d(1),Q=H(U),Q&&(Q.c(),Q.m(i,null)))},d(U){U&&Z(e),W&&W.d(),t[28](null),U&&Z(n),U&&Z(r),Q.d()}}}function wp(t){let e,n,r;return n=new gi({props:{title:"",translationKey:"",description:"This visualization shows the distribution of items by country and sub-collection. You can click on any country block to zoom in and see its sub-collections. The size of each block represents the number of items in that country or sub-collection.",descriptionTranslationKey:xp,titleHtml:t[1],$$slots:{default:[bp]},$$scope:{ctx:t}}}),{c(){e=z("div"),Bt(n.$$.fragment),y(e,"class","country-distribution-container svelte-63tjyd")},m(i,o){J(i,e,o),Ht(n,e,null),r=!0},p(i,o){const l={};o[0]&2&&(l.titleHtml=i[1]),o[0]&32765|o[1]&1048576&&(l.$$scope={dirty:o,ctx:i}),n.$set(l)},i(i){r||(At(n.$$.fragment,i),r=!0)},o(i){$t(n.$$.fragment,i),r=!1},d(i){i&&Z(e),Ot(n)}}}const xp="viz.country_distribution_description";function kp(t,e,n){let r,i,o,l,s,c,a,u,d,f,h,g,x,b;yt(t,It,C=>n(3,r=C));let T=0,w=0,m,v,S={name:"root",children:[]},_=null,M="en",N="",A=0,I=0,B=0,W=null;const D=pt("viz.no_data");yt(t,D,C=>n(9,u=C));const H=pt("viz.items");yt(t,H,C=>n(37,l=C));const Q=pt("viz.percent_of_country");yt(t,Q,C=>n(36,o=C));const U=pt("viz.percent_of_total");yt(t,U,C=>n(35,i=C));const K=pt("viz.click_zoom_in");yt(t,K,C=>n(7,s=C));const tt=pt("viz.back_to_all");yt(t,tt,C=>n(38,a=C)),pt("viz.unknown");const ft=pt("viz.no_set");yt(t,ft,C=>n(39,d=C));const kt=pt("viz.summary");yt(t,kt,C=>n(10,f=C));const j=pt("viz.total_items");yt(t,j,C=>n(11,h=C));const P=pt("viz.countries");yt(t,P,C=>n(12,g=C));const E=pt("viz.sub_collections");yt(t,E,C=>n(8,c=C));const V=pt("viz.currently_viewing");yt(t,V,C=>n(13,x=C));const it=pt("viz.click_back_to_return");yt(t,it,C=>n(14,b=C));function at(C){return C.toLocaleString(M==="fr"?"fr-FR":"en-US")}function wt(C){const R=at(C);return bt("viz.distribution_items",[R])}function ut(){A>0?n(1,N=wt(A)):n(1,N=bt("viz.country_distribution_title")),console.log("Title HTML updated:",N)}qt.subscribe(C=>{console.log("Language changed to:",C),M=C,ut()});function q(C){var vt;const R=C.filter(O=>O.country&&O.country.trim()!==""),Y=Ke(R,O=>O.country),nt={name:"root",children:Array.from(Y,([O,gt])=>{const dt=Array.from(Ke(gt,Tt=>Tt.item_set_title||d),([Tt,X])=>({name:Tt,value:X.length,itemCount:X.length}));return{name:O,children:dt,itemCount:gt.length}})};return n(2,A=R.length),n(4,I=Y.size),n(5,B=((vt=nt.children)==null?void 0:vt.reduce((O,gt)=>{var dt;return O+(((dt=gt.children)==null?void 0:dt.length)||0)},0))||0),ut(),console.log("Data processed, total items:",A),nt}function lt(C){if(n(6,W=C),W&&(!W.children||W.children.length===0)){console.warn("Cannot zoom to node without children");return}st()}function st(){try{if(!m){console.error("Container element not found");return}if(W||(S=q(r.items)),!S.children||S.children.length===0){_t(m).select("svg").remove(),_t(m).append("div").attr("class","no-data").style("position","absolute").style("top","50%").style("left","50%").style("transform","translate(-50%, -50%)").style("text-align","center").style("color","var(--text-color-secondary)").text(u);return}_t(m).select("svg").remove(),_t(m).select(".no-data").remove();const C=m.getBoundingClientRect();T=C.width,w=C.height;const R={top:40,right:10,bottom:10,left:10},Y=T-R.left-R.right,nt=w-R.top-R.bottom,O=_t(m).append("svg").attr("width",T).attr("height",w).append("g").attr("transform",`translate(${R.left}, ${R.top})`);if(W){const $=O.append("g").attr("class","zoom-out-button").attr("transform","translate(0, -10)").style("cursor","pointer").on("click",()=>lt(null));$.append("rect").attr("width",100).attr("height",24).attr("rx",4).attr("fill","var(--primary-color)").attr("opacity",.8),$.append("text").attr("x",50).attr("y",16).attr("text-anchor","middle").attr("fill","white").attr("font-size","var(--font-size-sm)").text(a)}const gt=Pl().size([Y,nt]).paddingOuter(4).paddingTop(20).paddingInner(1).round(!0);let dt;if(W){const $={name:W.data.name,children:W.data.children};dt=re($).sum(ht=>ht.value||0).sort((ht,Ct)=>(Ct.value||0)-(ht.value||0))}else dt=re(S).sum($=>$.value||0).sort(($,ht)=>(ht.value||0)-($.value||0));_=dt;try{gt(dt)}catch($){console.error("Error applying treemap layout:",$),n(6,W=null),S=q(r.items),dt=re(S).sum(ht=>ht.value||0).sort((ht,Ct)=>(Ct.value||0)-(ht.value||0)),_=dt,gt(dt)}const Tt=De().domain(dt.children?dt.children.map($=>$.data.name):[dt.data.name]).range(Sn),X=O.selectAll(".country").data(W?[]:dt.children||[]).enter().append("g").attr("class","country").attr("transform",$=>{const ht=$.x0||0,Ct=$.y0||0;return`translate(${ht},${Ct})`});X.append("rect").attr("width",$=>{const ht=$.x0||0,Ct=$.x1||0;return Math.max(0,Ct-ht)}).attr("height",$=>{const ht=$.y0||0,Ct=$.y1||0;return Math.max(0,Ct-ht)}).attr("fill",$=>Tt($.data.name)).attr("stroke","white").attr("stroke-width",2).style("opacity",.7).style("cursor","pointer").on("click",($,ht)=>{lt(ht)}).on("mouseover",function($,ht){F($,ht)}).on("mousemove",function($,ht){F($,ht)}).on("mouseout",function(){G()}).attr("title",s).append("title").text(()=>s),X.append("text").attr("x",5).attr("y",15).attr("font-size","var(--font-size-sm)").attr("font-weight","bold").attr("fill","white").text($=>`${$.data.name} (${$.data.itemCount||0} ${l})`).style("pointer-events","none").each(function($){const ht=_t(this),Ct=this.getComputedTextLength(),ee=$.x1-$.x0-10;Ct>ee&&ht.text($.data.name).append("title").text(`${$.data.name} (${$.data.itemCount||0} ${l})`)});const ct=O.selectAll(".item-set").data(W?dt.children||[]:dt.leaves()).enter().append("g").attr("class","item-set").attr("transform",$=>{const ht=$.x0||0,Ct=$.y0||0;return`translate(${ht},${Ct})`});ct.append("rect").attr("width",$=>{const ht=$.x0||0,Ct=$.x1||0;return Math.max(0,Ct-ht)}).attr("height",$=>{const ht=$.y0||0,Ct=$.y1||0;return Math.max(0,Ct-ht)}).attr("fill",$=>{var ee,Yt;const ht=Tt(W?W.data.name:((Yt=(ee=$.parent)==null?void 0:ee.data)==null?void 0:Yt.name)||"Unknown"),Ct=_e(ht);return _e(Ct).brighter(.7).toString()}).attr("stroke","white").attr("stroke-width",.5).style("cursor","pointer").on("mouseover",function($,ht){_t(this).attr("stroke","var(--primary-color)").attr("stroke-width",2),F($,ht)}).on("mousemove",function($,ht){F($,ht)}).on("mouseout",function(){_t(this).attr("stroke","white").attr("stroke-width",.5),G()}),ct.append("text").attr("x",3).attr("y",13).attr("font-size","var(--font-size-xs)").attr("fill","var(--text-color-primary)").style("pointer-events","none").each(function($){const ht=_t(this),Ct=$.x1-$.x0,ee=$.y1-$.y0;if(Ct<30||ee<20)return;let Yt=$.data.name;const $n=Ct-6,Dn=W?W.data.name:$.parent?$.parent.data.name:"";ht.text(Yt).append("title").text(`${Dn} > ${$.data.name}: ${$.data.itemCount||$.value||0} ${l}`);const en=this;let nn=en.getComputedTextLength(),mi=!1;for(;nn>$n&&Yt.length>3;)Yt=Yt.slice(0,-1),ht.text(Yt),nn=en.getComputedTextLength(),mi=!0;mi&&ht.text(Yt+"...")})}catch(C){console.error("Error in updateVisualization:",C)}}function k(){v&&document.body.contains(v)&&document.body.removeChild(v);try{v=document.createElement("div"),v.style.position="absolute",v.style.backgroundColor="rgba(0, 0, 0, 0.8)",v.style.color="white",v.style.padding="8px 12px",v.style.borderRadius="4px",v.style.pointerEvents="none",v.style.display="none",v.style.fontSize="12px",v.style.zIndex="1000",v.style.boxShadow="0 2px 5px rgba(0,0,0,0.2)",v.style.maxWidth="250px",v.style.whiteSpace="nowrap",document&&document.body&&document.body.appendChild(v)}catch(C){console.error("Error creating tooltip:",C)}}function F(C,R){var Y;(!v||!document.body.contains(v))&&k();try{const nt=R.parent===_,vt=!nt;if(nt){const X=R.data.name,ct=R.data.itemCount||R.value||0,$=((Y=R.children)==null?void 0:Y.length)||0,ht=A>0?(ct/A*100).toFixed(1)+"%":"N/A";v.innerHTML=`
                    <div style="font-weight:bold;margin-bottom:4px;border-bottom:1px solid rgba(255,255,255,0.3);padding-bottom:2px;">
                        ${X}
                    </div>
                    <div style="display:grid;grid-template-columns:auto auto;gap:4px;">
                        <span>${l}:</span>
                        <span style="text-align:right;font-weight:bold">${ct}</span>
                        <span>${c}:</span>
                        <span style="text-align:right">${$}</span>
                        <span>${i}:</span>
                        <span style="text-align:right">${ht}</span>
                    </div>
                    <div style="margin-top:4px;font-style:italic;font-size:10px;">
                        ${s}
                    </div>
                `}else{const X=W?W.data.name:R.parent?R.parent.data.name:"",ct=R.data.name,$=R.data.itemCount||R.value||0,ht=A,Ct=W?W.data.itemCount:R.parent?R.parent.data.itemCount:0,ee=Ct&&Ct>0?($/Ct*100).toFixed(1)+"%":"N/A",Yt=ht>0?($/ht*100).toFixed(1)+"%":"N/A";v.innerHTML=`
                    <div style="font-weight:bold;margin-bottom:4px;border-bottom:1px solid rgba(255,255,255,0.3);padding-bottom:2px;">
                        ${X} > ${ct}
                    </div>
                    <div style="display:grid;grid-template-columns:auto auto;gap:4px;">
                        <span>${l}:</span>
                        <span style="text-align:right;font-weight:bold">${$}</span>
                        <span>${o}:</span>
                        <span style="text-align:right">${ee}</span>
                        <span>${i}:</span>
                        <span style="text-align:right">${Yt}</span>
                    </div>
                `}const O=250,gt=120;let dt=C.pageX+10,Tt=C.pageY+10;dt+O>window.innerWidth&&(dt=C.pageX-O-10),Tt+gt>window.innerHeight&&(Tt=C.pageY-gt-10),v.style.left=`${dt}px`,v.style.top=`${Tt}px`,v.style.display="block"}catch(nt){console.error("Error showing tooltip:",nt)}}function G(){try{v&&document.body.contains(v)&&(v.style.display="none")}catch(C){console.error("Error hiding tooltip:",C)}}me(async()=>{try{if(await ze(),!m){console.error("Container element not found in onMount");return}k(),r.items&&r.items.length>0?(S=q(r.items),st()):It.loadItems();const C=new ResizeObserver(()=>{m&&st()});return m?C.observe(m):console.error("Container element not available for ResizeObserver"),()=>{try{C&&C.disconnect(),m&&_t(m).selectAll("*").remove(),v&&document.body.contains(v)&&document.body.removeChild(v)}catch(R){console.error("Error during cleanup:",R)}}}catch(C){console.error("Error in onMount:",C)}});function ot(C){de[C?"unshift":"push"](()=>{m=C,n(0,m)})}return t.$$.update=()=>{t.$$.dirty[0]&2&&console.log("Title HTML updated:",N),t.$$.dirty[0]&12&&r.items&&r.items.length>0&&!A&&(S=q(r.items)),t.$$.dirty[0]&9&&r.items&&m&&st()},ut(),[m,N,A,r,I,B,W,s,c,u,f,h,g,x,b,D,H,Q,U,K,tt,ft,kt,j,P,E,V,it,ot]}class Tp extends Zt{constructor(e){super(),Gt(this,e,kp,wp,Xt,{},null,[-1,-1])}}function _o(t,e,n){const r=t.slice();return r[42]=e[n],r}function bo(t,e,n){const r=t.slice();return r[42]=e[n],r}function wo(t,e){let n,r=e[42].label+"",i,o,l=e[13](e[42].count)+"",s,c,a;return{key:t,first:null,c(){n=z("option"),i=L(r),o=L(" ("),s=L(l),c=L(")"),n.__value=a=e[42].value,n.value=n.__value,this.first=n},m(u,d){J(u,n,d),p(n,i),p(n,o),p(n,s),p(n,c)},p(u,d){e=u,d[0]&32&&r!==(r=e[42].label+"")&&et(i,r),d[0]&32&&l!==(l=e[13](e[42].count)+"")&&et(s,l),d[0]&32&&a!==(a=e[42].value)&&(n.__value=a,n.value=n.__value)},d(u){u&&Z(n)}}}function xo(t,e){let n,r=e[42].label+"",i,o,l=e[13](e[42].count)+"",s,c,a;return{key:t,first:null,c(){n=z("option"),i=L(r),o=L(" ("),s=L(l),c=L(")"),n.__value=a=e[42].value,n.value=n.__value,this.first=n},m(u,d){J(u,n,d),p(n,i),p(n,o),p(n,s),p(n,c)},p(u,d){e=u,d[0]&64&&r!==(r=e[42].label+"")&&et(i,r),d[0]&64&&l!==(l=e[13](e[42].count)+"")&&et(s,l),d[0]&64&&a!==(a=e[42].value)&&(n.__value=a,n.value=n.__value)},d(u){u&&Z(n)}}}function ko(t){let e,n=bt("viz.showing_items",[t[13](t[7]),t[4].length.toString()])+"",r;return{c(){e=z("span"),r=L(n)},m(i,o){J(i,e,o),p(e,r)},p(i,o){o[0]&144&&n!==(n=bt("viz.showing_items",[i[13](i[7]),i[4].length.toString()])+"")&&et(r,n)},d(i){i&&Z(e)}}}function Cp(t){let e,n=t[1].error+"",r;return{c(){e=z("div"),r=L(n),y(e,"class","error svelte-1ci7ag1")},m(i,o){J(i,e,o),p(e,r)},p(i,o){o[0]&2&&n!==(n=i[1].error+"")&&et(r,n)},d(i){i&&Z(e)}}}function zp(t){let e;return{c(){e=z("div"),e.textContent=`${bt("ui.loading")}`,y(e,"class","loading svelte-1ci7ag1")},m(n,r){J(n,e,r)},p:xt,d(n){n&&Z(e)}}}function Mp(t){let e,n,r,i,o,l,s,c=[],a=new Map,u,d,f,h,g,x,b,T=[],w=new Map,m,v,S,_,M,N,A,I,B,W,D=bt("viz.total_items")+"",H,Q,U,K,tt,ft,kt=bt("viz.languages")+"",j,P,E,V=t[4].length+"",it,at,wt,ut=t[5];const q=C=>C[42].value;for(let C=0;C<ut.length;C+=1){let R=bo(t,ut,C),Y=q(R);a.set(Y,c[C]=wo(Y,R))}let lt=t[6];const st=C=>C[42].value;for(let C=0;C<lt.length;C+=1){let R=_o(t,lt,C),Y=st(R);w.set(Y,T[C]=xo(Y,R))}let k=t[4].length>0&&ko(t);function F(C,R){if(C[1].loading)return zp;if(C[1].error)return Cp}let G=F(t),ot=G&&G(t);return{c(){e=z("div"),n=z("div"),r=z("label"),i=L(t[9]),o=L(":"),l=rt(),s=z("select");for(let C=0;C<c.length;C+=1)c[C].c();u=rt(),d=z("div"),f=z("label"),h=L(t[10]),g=L(":"),x=rt(),b=z("select");for(let C=0;C<T.length;C+=1)T[C].c();m=rt(),v=z("div"),k&&k.c(),S=rt(),_=z("div"),ot&&ot.c(),M=rt(),N=z("div"),A=z("div"),I=z("h3"),I.textContent=`${bt("viz.summary")}`,B=rt(),W=z("p"),H=L(D),Q=L(": "),U=z("strong"),K=L(t[7]),tt=rt(),ft=z("p"),j=L(kt),P=L(": "),E=z("strong"),it=L(V),y(r,"for","country-filter"),y(r,"class","svelte-1ci7ag1"),y(s,"id","country-filter"),y(s,"class","svelte-1ci7ag1"),t[2]===void 0&&Me(()=>t[17].call(s)),y(n,"class","filter-group svelte-1ci7ag1"),y(f,"for","type-filter"),y(f,"class","svelte-1ci7ag1"),y(b,"id","type-filter"),y(b,"class","svelte-1ci7ag1"),t[3]===void 0&&Me(()=>t[18].call(b)),y(d,"class","filter-group svelte-1ci7ag1"),y(v,"class","summary svelte-1ci7ag1"),y(e,"class","filters svelte-1ci7ag1"),y(_,"class","pie-container svelte-1ci7ag1"),y(I,"class","svelte-1ci7ag1"),y(W,"class","svelte-1ci7ag1"),y(ft,"class","svelte-1ci7ag1"),y(A,"class","stat-summary svelte-1ci7ag1"),y(N,"class","stats svelte-1ci7ag1")},m(C,R){J(C,e,R),p(e,n),p(n,r),p(r,i),p(r,o),p(n,l),p(n,s);for(let Y=0;Y<c.length;Y+=1)c[Y]&&c[Y].m(s,null);ve(s,t[2],!0),p(e,u),p(e,d),p(d,f),p(f,h),p(f,g),p(d,x),p(d,b);for(let Y=0;Y<T.length;Y+=1)T[Y]&&T[Y].m(b,null);ve(b,t[3],!0),p(e,m),p(e,v),k&&k.m(v,null),J(C,S,R),J(C,_,R),ot&&ot.m(_,null),t[19](_),J(C,M,R),J(C,N,R),p(N,A),p(A,I),p(A,B),p(A,W),p(W,H),p(W,Q),p(W,U),p(U,K),p(A,tt),p(A,ft),p(ft,j),p(ft,P),p(ft,E),p(E,it),at||(wt=[St(s,"change",t[14]),St(s,"change",t[17]),St(b,"change",t[15]),St(b,"change",t[18])],at=!0)},p(C,R){R[0]&512&&et(i,C[9]),R[0]&8224&&(ut=C[5],c=xi(c,R,q,1,C,ut,a,s,wi,wo,null,bo)),R[0]&36&&ve(s,C[2]),R[0]&1024&&et(h,C[10]),R[0]&8256&&(lt=C[6],T=xi(T,R,st,1,C,lt,w,b,wi,xo,null,_o)),R[0]&72&&ve(b,C[3]),C[4].length>0?k?k.p(C,R):(k=ko(C),k.c(),k.m(v,null)):k&&(k.d(1),k=null),G===(G=F(C))&&ot?ot.p(C,R):(ot&&ot.d(1),ot=G&&G(C),ot&&(ot.c(),ot.m(_,null))),R[0]&128&&et(K,C[7]),R[0]&16&&V!==(V=C[4].length+"")&&et(it,V)},d(C){C&&Z(e);for(let R=0;R<c.length;R+=1)c[R].d();for(let R=0;R<T.length;R+=1)T[R].d();k&&k.d(),C&&Z(S),C&&Z(_),ot&&ot.d(),t[19](null),C&&Z(M),C&&Z(N),at=!1,Ut(wt)}}}function Ap(t){let e,n,r;return n=new gi({props:{title:"",translationKey:"",description:"",descriptionTranslationKey:"viz.language_distribution_description",titleHtml:t[8],$$slots:{default:[Mp]},$$scope:{ctx:t}}}),{c(){e=z("div"),Bt(n.$$.fragment),y(e,"class","language-visualization-container svelte-1ci7ag1")},m(i,o){J(i,e,o),Ht(n,e,null),r=!0},p(i,o){const l={};o[0]&256&&(l.titleHtml=i[8]),o[0]&1791|o[1]&65536&&(l.$$scope={dirty:o,ctx:i}),n.$set(l)},i(i){r||(At(n.$$.fragment,i),r=!0)},o(i){$t(n.$$.fragment,i),r=!1},d(i){i&&Z(e),Ot(n)}}}function Sp(t,e,n){let r,i,o,l;yt(t,It,E=>n(1,r=E)),yt(t,qt,E=>n(16,i=E));let s="all",c="all",a=[],u=[],d=[],f=0,h="en",g="",x=0,b=0,T,w,m;const v=De(Sn);pt("viz.all_countries"),pt("viz.all_types");const S=pt("viz.filter_by_country");yt(t,S,E=>n(9,o=E));const _=pt("viz.filter_by_type");yt(t,_,E=>n(10,l=E)),pt("viz.no_data"),pt("viz.showing_items"),pt("viz.items"),pt("viz.percent_of_total");function M(E){return E.toLocaleString(h==="fr"?"fr-FR":"en-US")}function N(E){const V=M(E);return bt("viz.language_distribution_items",[V])}function A(){f>0?n(8,g=N(f)):n(8,g=bt("viz.language_distribution_title")),console.log("Language Distribution Title updated:",g)}qt.subscribe(E=>{console.log("Language changed to:",E),h=E,A(),B(),m&&a.length>0&&U(a),T&&K()});function I(){if(!r.items||r.items.length===0)return;let E=r.items.filter(at=>!(!at.language||s!=="all"&&at.country!==s||c!=="all"&&at.type!==c));n(7,f=E.length),A(),console.log(`Processed ${f} items with language data`);const V=Ve(E,at=>at.length,at=>at.language||"Unknown");return Array.from(V,([at,wt])=>({language:at,count:wt,percentage:wt/f*100})).sort((at,wt)=>wt.count-at.count)}function B(){if(!r.items||r.items.length===0)return;const E=r.items.filter(ut=>ut.language),V=Ve(E,ut=>ut.length,ut=>ut.country||"Unknown"),it=bt("viz.all_countries"),at=bt("viz.all_types");n(5,u=[{value:"all",label:it,count:E.length},...Array.from(V,([ut,q])=>{if(ut==="Unknown")return null;const lt=bt(`country.${ut}`)||ut;return{value:ut,label:lt,count:q}}).filter(ut=>ut!==null).sort((ut,q)=>q.count-ut.count)]);const wt=Ve(E,ut=>ut.length,ut=>ut.type||"Unknown");n(6,d=[{value:"all",label:at,count:E.length},...Array.from(wt,([ut,q])=>({value:ut,label:ut,count:q})).sort((ut,q)=>q.count-ut.count)])}function W(){w=document.createElement("div"),w.style.position="absolute",w.style.backgroundColor="rgba(0, 0, 0, 0.8)",w.style.color="white",w.style.padding="8px 12px",w.style.borderRadius="4px",w.style.pointerEvents="none",w.style.display="none",w.style.fontSize="12px",w.style.zIndex="1000",w.style.boxShadow="0 2px 5px rgba(0,0,0,0.2)",document&&document.body&&document.body.appendChild(w)}function D(E,V){if(!w)return;const it=V.data,at=bt(`lang.${it.language}`)||it.language;w.innerHTML=`
            <div style="font-weight:bold;margin-bottom:4px;border-bottom:1px solid rgba(255,255,255,0.3);padding-bottom:2px;">
                ${at}
            </div>
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:4px;">
                <span>${bt("viz.items")}:</span><span style="text-align:right;font-weight:bold;">${M(it.count)}</span>
                <span>${bt("viz.percent_of_total")}:</span><span style="text-align:right;font-weight:bold;">${it.percentage.toFixed(2)}%</span>
            </div>
        `;const wt=200,ut=100;let q=E.pageX+10,lt=E.pageY+10;q+wt>window.innerWidth&&(q=E.pageX-wt-10),lt+ut>window.innerHeight&&(lt=E.pageY-ut-10),w.style.left=`${q}px`,w.style.top=`${lt}px`,w.style.display="block"}function H(){w&&(w.style.display="none")}function Q(){m?m.innerHTML="":(m=document.createElement("div"),m.style.position="absolute",m.style.right="20px",m.style.top="20px",m.style.backgroundColor="rgba(255, 255, 255, 0.9)",m.style.padding="10px",m.style.borderRadius="4px",m.style.boxShadow="0 2px 4px rgba(0,0,0,0.1)",m.style.maxHeight="300px",m.style.overflowY="auto",m.style.color="var(--text-color-primary)",m.style.fontFamily="var(--font-family-primary)",m.style.fontSize="var(--font-size-sm)",T.appendChild(m))}function U(E){m&&(m.innerHTML=`
            <div style="font-weight:bold;margin-bottom:8px;font-size:14px;color:var(--text-color-primary);">${bt("viz.languages")} (${E.length})</div>
            <div style="display:grid;grid-template-columns:20px auto 40px;gap:4px;font-size:12px;">
                ${E.map((V,it)=>{const at=bt(`lang.${V.language}`)||V.language;return`
                        <div style="width:12px;height:12px;background-color:${v(V.language)};border-radius:2px;margin-top:2px;"></div>
                        <div style="white-space:nowrap;overflow:hidden;text-overflow:ellipsis;color:var(--text-color-primary);">${at}</div>
                        <div style="text-align:right;color:var(--text-color-secondary);">${M(V.count)}</div>
                    `}).join("")}
            </div>
        `)}function K(){if(!T)return;const E=I();if(n(4,a=E||[]),!E||E.length===0){_t(T).select("svg").remove();return}_t(T).select("svg").remove();const V=T.getBoundingClientRect();x=V.width,b=V.height;const it={top:20,right:20,bottom:20,left:20},at=x-it.left-it.right,wt=b-it.top-it.bottom,ut=Math.min(at,wt)/2,q=_t(T).append("svg").attr("width",x).attr("height",b).append("g").attr("transform",`translate(${x/2}, ${b/2})`),lt=Jh().value(F=>F.count).sort(null),st=lo().innerRadius(0).outerRadius(ut),k=lo().innerRadius(0).outerRadius(ut+10);q.selectAll("path").data(lt(E)).enter().append("path").attr("d",st).attr("fill",F=>v(F.data.language)).attr("stroke","white").attr("stroke-width",2).on("mouseenter",function(F,G){_t(this).transition().duration(200).attr("d",ot=>k(ot)),D(F,G)}).on("mousemove",function(F,G){D(F,G)}).on("mouseleave",function(F,G){_t(this).transition().duration(200).attr("d",ot=>st(ot)),H()}),Q(),U(E)}function tt(E){const V=E.target;n(2,s=V.value),K()}function ft(E){const V=E.target;n(3,c=V.value),K()}me(async()=>{if(await ze(),!T){console.error("Container element not found");return}W(),r.items&&r.items.length>0?(B(),K()):It.loadItems();const E=new ResizeObserver(()=>{T&&K()});return E.observe(T),()=>{E.disconnect(),w&&document.body.contains(w)&&document.body.removeChild(w),m&&m.parentNode&&m.parentNode.removeChild(m)}});function kt(){s=vi(this),n(2,s),n(5,u)}function j(){c=vi(this),n(3,c),n(6,d)}function P(E){de[E?"unshift":"push"](()=>{T=E,n(0,T)})}return t.$$.update=()=>{t.$$.dirty[0]&3&&r.items&&T&&(B(),K()),t.$$.dirty[0]&65538&&i&&r.items&&r.items.length>0&&B()},A(),[T,r,s,c,a,u,d,f,g,o,l,S,_,M,tt,ft,i,kt,j,P]}class $p extends Zt{constructor(e){super(),Gt(this,e,Sp,Ap,Xt,{},null,[-1,-1])}}function To(t,e,n){const r=t.slice();return r[15]=e[n],r}function Dp(t){let e,n=t[1].error+"",r;return{c(){e=z("div"),r=L(n),y(e,"class","error svelte-18pj101")},m(i,o){J(i,e,o),p(e,r)},p(i,o){o&2&&n!==(n=i[1].error+"")&&et(r,n)},d(i){i&&Z(e)}}}function Np(t){let e;return{c(){e=z("div"),e.textContent="Loading...",y(e,"class","loading svelte-18pj101")},m(n,r){J(n,e,r)},p:xt,d(n){n&&Z(e)}}}function Co(t){let e,n,r,i,o,l,s,c,a,u,d,f=t[2].length+"",h,g,x,b,T,w,m=t[2].slice(0,5),v=[];for(let S=0;S<m.length;S+=1)v[S]=zo(To(t,m,S));return{c(){e=z("div"),n=z("h3"),n.textContent="Summary",r=rt(),i=z("p"),o=L("Total index items: "),l=z("strong"),s=L(t[3]),c=rt(),a=z("p"),u=L("Number of categories: "),d=z("strong"),h=L(f),g=rt(),x=z("div"),b=z("h3"),b.textContent="Top Categories",T=rt(),w=z("ul");for(let S=0;S<v.length;S+=1)v[S].c();y(n,"class","svelte-18pj101"),y(e,"class","stat-summary svelte-18pj101"),y(b,"class","svelte-18pj101"),y(w,"class","svelte-18pj101"),y(x,"class","top-categories svelte-18pj101")},m(S,_){J(S,e,_),p(e,n),p(e,r),p(e,i),p(i,o),p(i,l),p(l,s),p(e,c),p(e,a),p(a,u),p(a,d),p(d,h),J(S,g,_),J(S,x,_),p(x,b),p(x,T),p(x,w);for(let M=0;M<v.length;M+=1)v[M]&&v[M].m(w,null)},p(S,_){if(_&8&&et(s,S[3]),_&4&&f!==(f=S[2].length+"")&&et(h,f),_&4){m=S[2].slice(0,5);let M;for(M=0;M<m.length;M+=1){const N=To(S,m,M);v[M]?v[M].p(N,_):(v[M]=zo(N),v[M].c(),v[M].m(w,null))}for(;M<v.length;M+=1)v[M].d(1);v.length=m.length}},d(S){S&&Z(e),S&&Z(g),S&&Z(x),Ce(v,S)}}}function zo(t){let e,n,r=t[15].category+"",i,o,l,s=t[15].count+"",c,a,u=t[15].percentage.toFixed(1)+"",d,f,h;return{c(){e=z("li"),n=z("span"),i=L(r),o=rt(),l=z("span"),c=L(s),a=L(" items ("),d=L(u),f=L("%)"),h=rt(),y(n,"class","category-name svelte-18pj101"),y(l,"class","category-count svelte-18pj101"),y(e,"class","svelte-18pj101")},m(g,x){J(g,e,x),p(e,n),p(n,i),p(e,o),p(e,l),p(l,c),p(l,a),p(l,d),p(l,f),p(e,h)},p(g,x){x&4&&r!==(r=g[15].category+"")&&et(i,r),x&4&&s!==(s=g[15].count+"")&&et(c,s),x&4&&u!==(u=g[15].percentage.toFixed(1)+"")&&et(d,u)},d(g){g&&Z(e)}}}function Ep(t){let e,n,r,i;function o(a,u){if(a[1].loading)return Np;if(a[1].error)return Dp}let l=o(t),s=l&&l(t),c=t[2].length>0&&Co(t);return{c(){e=z("div"),n=z("div"),s&&s.c(),r=rt(),i=z("div"),c&&c.c(),y(n,"class","chart-container svelte-18pj101"),y(i,"class","stats svelte-18pj101"),y(e,"class","index-visualization-container svelte-18pj101")},m(a,u){J(a,e,u),p(e,n),s&&s.m(n,null),t[4](n),p(e,r),p(e,i),c&&c.m(i,null)},p(a,[u]){l===(l=o(a))&&s?s.p(a,u):(s&&s.d(1),s=l&&l(a),s&&(s.c(),s.m(n,null))),a[2].length>0?c?c.p(a,u):(c=Co(a),c.c(),c.m(i,null)):c&&(c.d(1),c=null)},i:xt,o:xt,d(a){a&&Z(e),s&&s.d(),t[4](null),c&&c.d()}}}function Ip(t,e,n){let r;yt(t,It,w=>n(1,r=w));let i=[],o=0,l=0,s=0,c=0,a,u;const d=De(Sn);function f(){if(!r.items||r.items.length===0)return[];const w=r.items.filter(_=>_.type==="Notice d'autorité");if(n(3,o=w.length),o===0)return[];const m=Ve(w,_=>_.length,_=>_.item_set_title||"Uncategorized"),S=Array.from(m,([_,M])=>({category:_,count:M,percentage:M/o*100})).sort((_,M)=>M.count-_.count);return l=Re(S,_=>_.count)||0,S}function h(){try{u&&document.body.contains(u)&&document.body.removeChild(u),u=document.createElement("div"),u.style.position="absolute",u.style.backgroundColor="rgba(0, 0, 0, 0.8)",u.style.color="white",u.style.padding="8px 12px",u.style.borderRadius="4px",u.style.pointerEvents="none",u.style.display="none",u.style.fontSize="12px",u.style.zIndex="1000",u.style.boxShadow="0 2px 5px rgba(0,0,0,0.2)",document&&document.body&&document.body.appendChild(u)}catch(w){console.error("Error creating tooltip:",w)}}function g(w,m){try{if((!u||!document.body.contains(u))&&h(),!u)return;u.innerHTML=`
                <div style="font-weight:bold;margin-bottom:4px;border-bottom:1px solid rgba(255,255,255,0.3);padding-bottom:2px;">
                    ${m.category}
                </div>
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:4px;">
                    <span>Count:</span><span style="text-align:right;font-weight:bold;">${m.count}</span>
                    <span>Percentage:</span><span style="text-align:right;font-weight:bold;">${m.percentage.toFixed(2)}%</span>
                </div>
            `;const v=200,S=100;let _=w.pageX+10,M=w.pageY+10;_+v>window.innerWidth&&(_=w.pageX-v-10),M+S>window.innerHeight&&(M=w.pageY-S-10),u.style.left=`${_}px`,u.style.top=`${M}px`,u.style.display="block"}catch(v){console.error("Error showing tooltip:",v)}}function x(){try{u&&document.body.contains(u)&&(u.style.display="none")}catch(w){console.error("Error hiding tooltip:",w)}}function b(){try{if(!a)return;const w=f();if(!w||w.length===0){_t(a).select("svg").remove(),_t(a).append("div").attr("class","no-data").style("position","absolute").style("top","50%").style("left","50%").style("transform","translate(-50%, -50%)").style("text-align","center").style("color","var(--text-color-secondary)").text("No index items available");return}n(2,i=w),_t(a).select("svg").remove(),_t(a).select(".no-data").remove();const m=a.getBoundingClientRect();s=m.width,c=m.height-40;const v={top:60,right:30,bottom:120,left:60},S=s-v.left-v.right,_=c-v.top-v.bottom,M=_t(a).append("svg").attr("width",s).attr("height",c).attr("viewBox",`0 0 ${s} ${c}`),N=M.append("g").attr("transform",`translate(${v.left}, ${v.top})`),A=ui().domain(w.map(D=>D.category)).range([0,S]).padding(.2),I=wn().domain([0,l*1.1]).range([_,0]),B=jn(A);N.append("g").attr("class","x-axis").attr("transform",`translate(0, ${_})`).call(B).selectAll("text").attr("transform","rotate(-45)").style("text-anchor","end").attr("dx","-.8em").attr("dy",".15em").style("font-size","var(--font-size-xs)").style("fill","var(--text-color-primary)");const W=Kn(I).ticks(5);N.append("g").attr("class","y-axis").call(W).selectAll("text").style("font-size","var(--font-size-xs)").style("fill","var(--text-color-primary)"),N.append("text").attr("class","x-axis-label").attr("text-anchor","middle").attr("x",S/2).attr("y",_+v.bottom-10).style("font-size","var(--font-size-sm)").style("fill","var(--text-color-secondary)").text("Categories"),N.append("text").attr("class","y-axis-label").attr("text-anchor","middle").attr("transform","rotate(-90)").attr("x",-_/2).attr("y",-v.left+15).style("font-size","var(--font-size-sm)").style("fill","var(--text-color-secondary)").text("Number of Items"),N.selectAll(".bar").data(w).enter().append("rect").attr("class","bar").attr("x",D=>A(D.category)||0).attr("y",D=>I(D.count)).attr("width",A.bandwidth()).attr("height",D=>_-I(D.count)).attr("fill",(D,H)=>d(D.category)).attr("rx",3).attr("ry",3).style("stroke","white").style("stroke-width",1).on("mouseenter",function(D,H){_t(this).transition().duration(200).attr("fill",_e(d(H.category)).brighter(.5).toString()),g(D,H)}).on("mousemove",function(D,H){g(D,H)}).on("mouseleave",function(D,H){_t(this).transition().duration(200).attr("fill",d(H.category)),x()}),N.selectAll(".bar-label").data(w).enter().append("text").attr("class","bar-label").attr("x",D=>(A(D.category)||0)+A.bandwidth()/2).attr("y",D=>I(D.count)-5).attr("text-anchor","middle").style("font-size","var(--font-size-xs)").style("fill","var(--text-color-secondary)").text(D=>D.count),M.append("text").attr("text-anchor","middle").attr("x",s/2).attr("y",30).attr("font-size","var(--font-size-lg)").attr("font-weight","bold").attr("fill","var(--text-color-primary)").text(`Index Distribution by Category (${o} items)`)}catch(w){console.error("Error creating bar chart:",w)}}me(async()=>{try{if(await ze(),!a){console.error("Container element not found");return}h(),r.items&&r.items.length>0?b():It.loadItems();const w=new ResizeObserver(()=>{a&&b()});return w.observe(a),()=>{try{w&&w.disconnect(),a&&_t(a).selectAll("*").remove(),u&&document.body.contains(u)&&document.body.removeChild(u)}catch(m){console.error("Error during cleanup:",m)}}}catch(w){console.error("Error in onMount:",w)}});function T(w){de[w?"unshift":"push"](()=>{a=w,n(0,a)})}return t.$$.update=()=>{t.$$.dirty&3&&r.items&&a&&b()},[a,r,i,o,T]}class Lp extends Zt{constructor(e){super(),Gt(this,e,Ip,Ep,Xt,{})}}function Mo(t,e,n){const r=t.slice();return r[52]=e[n],r}function Ao(t,e,n){const r=t.slice();return r[55]=e[n],r}function So(t,e,n){const r=t.slice();return r[55]=e[n],r}function $o(t){let e,n=t[55].label+"",r,i,o=t[27](t[55].count)+"",l,s,c;return{c(){e=z("option"),r=L(n),i=L(" ("),l=L(o),s=L(")"),e.__value=c=t[55].value,e.value=e.__value},m(a,u){J(a,e,u),p(e,r),p(e,i),p(e,l),p(e,s)},p(a,u){u[0]&32&&n!==(n=a[55].label+"")&&et(r,n),u[0]&32&&o!==(o=a[27](a[55].count)+"")&&et(l,o),u[0]&32&&c!==(c=a[55].value)&&(e.__value=c,e.value=e.__value)},d(a){a&&Z(e)}}}function Do(t){let e,n=t[55].label+"",r,i,o=t[27](t[55].count)+"",l,s,c;return{c(){e=z("option"),r=L(n),i=L(" ("),l=L(o),s=L(")"),e.__value=c=t[55].value,e.value=e.__value},m(a,u){J(a,e,u),p(e,r),p(e,i),p(e,l),p(e,s)},p(a,u){u[0]&64&&n!==(n=a[55].label+"")&&et(r,n),u[0]&64&&o!==(o=a[27](a[55].count)+"")&&et(l,o),u[0]&64&&c!==(c=a[55].value)&&(e.__value=c,e.value=e.__value)},d(a){a&&Z(e)}}}function No(t){let e,n=t[11].replace("{0}",t[27](t[7])).replace("{1}",t[4].length.toString())+"",r;return{c(){e=z("span"),r=L(n)},m(i,o){J(i,e,o),p(e,r)},p(i,o){o[0]&2192&&n!==(n=i[11].replace("{0}",i[27](i[7])).replace("{1}",i[4].length.toString())+"")&&et(r,n)},d(i){i&&Z(e)}}}function Up(t){let e,n=t[3].error+"",r;return{c(){e=z("div"),r=L(n),y(e,"class","error svelte-1ftjyys")},m(i,o){J(i,e,o),p(e,r)},p(i,o){o[0]&8&&n!==(n=i[3].error+"")&&et(r,n)},d(i){i&&Z(e)}}}function Fp(t){let e;return{c(){e=z("div"),e.textContent=`${bt("ui.loading")}`,y(e,"class","loading svelte-1ftjyys")},m(n,r){J(n,e,r)},p:xt,d(n){n&&Z(e)}}}function Eo(t){var kt,j;let e,n,r,i,o,l,s,c,a=t[27](t[7])+"",u,d,f,h,g,x,b=(((kt=t[4][0])==null?void 0:kt.monthFormatted)||"")+"",T,w,m=(((j=t[4][t[4].length-1])==null?void 0:j.monthFormatted)||"")+"",v,S,_,M,N,A,I=t[27](Math.round(t[7]/(t[4].length||1)))+"",B,W,D,H,Q,U,K,tt=[...t[4]].sort(Lo).slice(0,3),ft=[];for(let P=0;P<tt.length;P+=1)ft[P]=Io(Mo(t,tt,P));return{c(){e=z("div"),n=z("h3"),r=L(t[12]),i=rt(),o=z("p"),l=L(t[13]),s=L(": "),c=z("strong"),u=L(a),d=rt(),f=z("p"),h=L(t[14]),g=L(": "),x=z("strong"),T=L(b),w=L(" to "),v=L(m),S=rt(),_=z("p"),M=L(t[15]),N=L(": "),A=z("strong"),B=L(I),W=rt(),D=z("div"),H=z("h3"),Q=L(t[16]),U=rt(),K=z("ul");for(let P=0;P<ft.length;P+=1)ft[P].c();y(n,"class","svelte-1ftjyys"),y(e,"class","stat-summary svelte-1ftjyys"),y(H,"class","svelte-1ftjyys"),y(K,"class","svelte-1ftjyys"),y(D,"class","peak-months svelte-1ftjyys")},m(P,E){J(P,e,E),p(e,n),p(n,r),p(e,i),p(e,o),p(o,l),p(o,s),p(o,c),p(c,u),p(e,d),p(e,f),p(f,h),p(f,g),p(f,x),p(x,T),p(x,w),p(x,v),p(e,S),p(e,_),p(_,M),p(_,N),p(_,A),p(A,B),J(P,W,E),J(P,D,E),p(D,H),p(H,Q),p(D,U),p(D,K);for(let V=0;V<ft.length;V+=1)ft[V]&&ft[V].m(K,null)},p(P,E){var V,it;if(E[0]&4096&&et(r,P[12]),E[0]&8192&&et(l,P[13]),E[0]&128&&a!==(a=P[27](P[7])+"")&&et(u,a),E[0]&16384&&et(h,P[14]),E[0]&16&&b!==(b=(((V=P[4][0])==null?void 0:V.monthFormatted)||"")+"")&&et(T,b),E[0]&16&&m!==(m=(((it=P[4][P[4].length-1])==null?void 0:it.monthFormatted)||"")+"")&&et(v,m),E[0]&32768&&et(M,P[15]),E[0]&144&&I!==(I=P[27](Math.round(P[7]/(P[4].length||1)))+"")&&et(B,I),E[0]&65536&&et(Q,P[16]),E[0]&134348944){tt=[...P[4]].sort(Lo).slice(0,3);let at;for(at=0;at<tt.length;at+=1){const wt=Mo(P,tt,at);ft[at]?ft[at].p(wt,E):(ft[at]=Io(wt),ft[at].c(),ft[at].m(K,null))}for(;at<ft.length;at+=1)ft[at].d(1);ft.length=tt.length}},d(P){P&&Z(e),P&&Z(W),P&&Z(D),Ce(ft,P)}}}function Io(t){let e,n,r=t[52].monthFormatted+"",i,o,l,s=t[27](t[52].count)+"",c,a,u,d,f=(t[52].count/(t[7]||1)*100).toFixed(1)+"",h,g,x;return{c(){e=z("li"),n=z("span"),i=L(r),o=rt(),l=z("span"),c=L(s),a=rt(),u=L(t[17]),d=L(" ("),h=L(f),g=L("%)"),x=rt(),y(n,"class","month-name svelte-1ftjyys"),y(l,"class","month-count svelte-1ftjyys"),y(e,"class","svelte-1ftjyys")},m(b,T){J(b,e,T),p(e,n),p(n,i),p(e,o),p(e,l),p(l,c),p(l,a),p(l,u),p(l,d),p(l,h),p(l,g),p(e,x)},p(b,T){T[0]&16&&r!==(r=b[52].monthFormatted+"")&&et(i,r),T[0]&16&&s!==(s=b[27](b[52].count)+"")&&et(c,s),T[0]&131072&&et(u,b[17]),T[0]&144&&f!==(f=(b[52].count/(b[7]||1)*100).toFixed(1)+"")&&et(h,f)},d(b){b&&Z(e)}}}function Rp(t){let e,n,r,i,o,l,s,c,a,u,d,f,h,g,x,b,T,w,m,v,S,_,M=t[5],N=[];for(let U=0;U<M.length;U+=1)N[U]=$o(So(t,M,U));let A=t[6],I=[];for(let U=0;U<A.length;U+=1)I[U]=Do(Ao(t,A,U));let B=t[4].length>0&&No(t);function W(U,K){if(U[3].loading)return Fp;if(U[3].error)return Up}let D=W(t),H=D&&D(t),Q=t[4].length>0&&Eo(t);return{c(){e=z("div"),n=z("div"),r=z("label"),i=L(t[9]),o=L(":"),l=rt(),s=z("select");for(let U=0;U<N.length;U+=1)N[U].c();c=rt(),a=z("div"),u=z("label"),d=L(t[10]),f=L(":"),h=rt(),g=z("select");for(let U=0;U<I.length;U+=1)I[U].c();x=rt(),b=z("div"),B&&B.c(),T=rt(),w=z("div"),H&&H.c(),m=rt(),v=z("div"),Q&&Q.c(),y(r,"for","country-filter"),y(r,"class","svelte-1ftjyys"),y(s,"id","country-filter"),y(s,"class","svelte-1ftjyys"),y(n,"class","filter-group svelte-1ftjyys"),y(u,"for","type-filter"),y(u,"class","svelte-1ftjyys"),y(g,"id","type-filter"),y(g,"class","svelte-1ftjyys"),y(a,"class","filter-group svelte-1ftjyys"),y(b,"class","summary svelte-1ftjyys"),y(e,"class","filters svelte-1ftjyys"),y(w,"class","chart-container svelte-1ftjyys"),y(v,"class","stats svelte-1ftjyys")},m(U,K){J(U,e,K),p(e,n),p(n,r),p(r,i),p(r,o),p(n,l),p(n,s);for(let tt=0;tt<N.length;tt+=1)N[tt]&&N[tt].m(s,null);ve(s,t[0]),p(e,c),p(e,a),p(a,u),p(u,d),p(u,f),p(a,h),p(a,g);for(let tt=0;tt<I.length;tt+=1)I[tt]&&I[tt].m(g,null);ve(g,t[1]),p(e,x),p(e,b),B&&B.m(b,null),J(U,T,K),J(U,w,K),H&&H.m(w,null),t[31](w),J(U,m,K),J(U,v,K),Q&&Q.m(v,null),S||(_=[St(s,"change",t[28]),St(g,"change",t[29])],S=!0)},p(U,K){if(K[0]&512&&et(i,U[9]),K[0]&134217760){M=U[5];let tt;for(tt=0;tt<M.length;tt+=1){const ft=So(U,M,tt);N[tt]?N[tt].p(ft,K):(N[tt]=$o(ft),N[tt].c(),N[tt].m(s,null))}for(;tt<N.length;tt+=1)N[tt].d(1);N.length=M.length}if(K[0]&33&&ve(s,U[0]),K[0]&1024&&et(d,U[10]),K[0]&134217792){A=U[6];let tt;for(tt=0;tt<A.length;tt+=1){const ft=Ao(U,A,tt);I[tt]?I[tt].p(ft,K):(I[tt]=Do(ft),I[tt].c(),I[tt].m(g,null))}for(;tt<I.length;tt+=1)I[tt].d(1);I.length=A.length}K[0]&66&&ve(g,U[1]),U[4].length>0?B?B.p(U,K):(B=No(U),B.c(),B.m(b,null)):B&&(B.d(1),B=null),D===(D=W(U))&&H?H.p(U,K):(H&&H.d(1),H=D&&D(U),H&&(H.c(),H.m(w,null))),U[4].length>0?Q?Q.p(U,K):(Q=Eo(U),Q.c(),Q.m(v,null)):Q&&(Q.d(1),Q=null)},d(U){U&&Z(e),Ce(N,U),Ce(I,U),B&&B.d(),U&&Z(T),U&&Z(w),H&&H.d(),t[31](null),U&&Z(m),U&&Z(v),Q&&Q.d(),S=!1,Ut(_)}}}function Hp(t){let e,n,r;return n=new gi({props:{title:"Timeline Distribution",titleHtml:t[8],descriptionTranslationKey:Op,$$slots:{default:[Rp]},$$scope:{ctx:t}}}),{c(){e=z("div"),Bt(n.$$.fragment),y(e,"class","timeline-visualization-container svelte-1ftjyys")},m(i,o){J(i,e,o),Ht(n,e,null),r=!0},p(i,o){const l={};o[0]&256&&(l.titleHtml=i[8]),o[0]&261887|o[1]&536870912&&(l.$$scope={dirty:o,ctx:i}),n.$set(l)},i(i){r||(At(n.$$.fragment,i),r=!0)},o(i){$t(n.$$.fragment,i),r=!1},d(i){i&&Z(e),Ot(n)}}}const Op="viz.timeline_distribution_description",Lo=(t,e)=>e.count-t.count;function Yp(t,e,n){let r,i,o,l,s,c,a,u,d,f,h;yt(t,It,F=>n(3,r=F)),yt(t,qt,F=>n(30,i=F));let g="all",x="all",b=[],T=[],w=[],m=0,v="en",S="",_=0,M=0,N,A;const I=Ye("%Y-%m"),B=Ye("%b %Y"),W=pt("viz.filter_by_country");yt(t,W,F=>n(9,o=F));const D=pt("viz.filter_by_type");yt(t,D,F=>n(10,l=F)),pt("viz.no_data");const H=pt("viz.summary");yt(t,H,F=>n(12,c=F));const Q=pt("viz.total_items");yt(t,Q,F=>n(13,a=F));const U=pt("viz.time_period");yt(t,U,F=>n(14,u=F));const K=pt("viz.avg_monthly_additions");yt(t,K,F=>n(15,d=F));const tt=pt("viz.peak_growth_months");yt(t,tt,F=>n(16,f=F));const ft=pt("viz.showing_items_over_months");yt(t,ft,F=>n(11,s=F));const kt=pt("viz.items");yt(t,kt,F=>n(17,h=F)),pt("viz.timeline_distribution_items"),pt("viz.monthly_additions"),pt("viz.month");function j(F){return F.toLocaleString(v==="fr"?"fr-FR":"en-US")}function P(){if(m>0){const F=j(m);return bt("viz.timeline_distribution_items",[F])}else return bt("viz.timeline_distribution_title")}function E(){console.log("[TimelineDistribution] Updating title with count:",m),n(8,S=P())}qt.subscribe(F=>{console.log("[TimelineDistribution] Language changed to:",F),v=F,it(),N&&q()});function V(){if(!r.items||r.items.length===0)return[];const F=new Date(2024,3,1);let G=0;const ot=O=>!(!O.created_date||g!=="all"&&O.country!==g||x!=="all"&&O.type!==x);G=r.items.filter(O=>ot(O)?new Date(O.created_date)<F:!1).length;let R=r.items.filter(O=>ot(O)?new Date(O.created_date)>=F:!1);if(n(7,m=G+R.length),R.length===0)return[];const Y=new Map;R.forEach(O=>{const gt=new Date(O.created_date),dt=I(gt);Y.set(dt,(Y.get(dt)||0)+1)});const nt=Array.from(Y.entries()).map(([O,gt])=>{const[dt,Tt]=O.split("-").map(Number),X=new Date(dt,Tt-1,1);return{date:X,month:O,monthFormatted:B(X),count:gt,total:0,percentage:0}}).sort((O,gt)=>O.date.getTime()-gt.date.getTime());let vt=G;return nt.forEach(O=>{vt+=O.count,O.total=vt,O.percentage=O.count/R.length*100}),Re(nt,O=>O.count),Re(nt,O=>O.total),nt}function it(){if(!r.items||r.items.length===0)return;const F=new Date(2024,3,1),G=r.items.filter(R=>R.created_date?new Date(R.created_date)>=F:!1),ot=Ve(G,R=>R.length,R=>R.country||"Unknown");n(5,T=[{value:"all",label:bt("country.all"),count:G.length},...Array.from(ot,([R,Y])=>({value:R,label:bt(`country.${R}`),count:Y})).filter(R=>R.value!=="Unknown").sort((R,Y)=>Y.count-R.count)]);const C=Ve(G,R=>R.length,R=>R.type||"Unknown");n(6,w=[{value:"all",label:bt("type.all"),count:G.length},...Array.from(C,([R,Y])=>({value:R,label:bt(`type.${R}`),count:Y})).filter(R=>R.value!=="Unknown").sort((R,Y)=>Y.count-R.count)])}function at(){try{A&&document.body.contains(A)&&document.body.removeChild(A),A=document.createElement("div"),A.style.position="absolute",A.style.backgroundColor="rgba(0, 0, 0, 0.8)",A.style.color="white",A.style.padding="8px 12px",A.style.borderRadius="4px",A.style.pointerEvents="none",A.style.display="none",A.style.fontSize="12px",A.style.zIndex="1000",A.style.boxShadow="0 2px 5px rgba(0,0,0,0.2)",document&&document.body&&document.body.appendChild(A)}catch(F){console.error("Error creating tooltip:",F)}}function wt(F,G,ot){try{if((!A||!document.body.contains(A))&&at(),!A)return;const C=G.date.toLocaleString("default",{month:"long"}),R=G.date.getFullYear();ot==="monthly"?A.innerHTML=`
                    <div style="font-weight:bold;margin-bottom:4px;border-bottom:1px solid rgba(255,255,255,0.3);padding-bottom:2px;">
                        ${C} ${R}
                    </div>
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:4px;">
                        <span>New Items:</span><span style="text-align:right;font-weight:bold;">${G.count}</span>
                        <span>Percentage:</span><span style="text-align:right;font-weight:bold;">${G.percentage.toFixed(2)}%</span>
                    </div>
                `:A.innerHTML=`
                    <div style="font-weight:bold;margin-bottom:4px;border-bottom:1px solid rgba(255,255,255,0.3);padding-bottom:2px;">
                        ${C} ${R}
                    </div>
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:4px;">
                        <span>Total Items:</span><span style="text-align:right;font-weight:bold;">${G.total}</span>
                    </div>
                `;const Y=200,nt=100;let vt=F.pageX+10,O=F.pageY+10;vt+Y>window.innerWidth&&(vt=F.pageX-Y-10),O+nt>window.innerHeight&&(O=F.pageY-nt-10),A.style.left=`${vt}px`,A.style.top=`${O}px`,A.style.display="block"}catch(C){console.error("Error showing tooltip:",C)}}function ut(){try{A&&document.body.contains(A)&&(A.style.display="none")}catch(F){console.error("Error hiding tooltip:",F)}}function q(){if(!N){console.error("[TimelineDistribution] Container element not found in createTimeline");return}const F=V();if(!F||F.length===0){_t(N).select("svg").remove(),_t(N).append("div").attr("class","no-data").style("position","absolute").style("top","50%").style("left","50%").style("transform","translate(-50%, -50%)").style("text-align","center").style("color","var(--text-color-secondary)").text("No timeline data available with the current filters");return}n(4,b=F),_t(N).select("svg").remove(),_t(N).select(".no-data").remove();const G=N.getBoundingClientRect();_=G.width,M=G.height-50;const ot=_t(N).append("svg").attr("width",_).attr("height",M).attr("viewBox",`0 0 ${_} ${M}`),C={top:30,right:60,bottom:50,left:70},R=_-C.left-C.right,Y=(M-C.top-C.bottom-50)/2,nt=Fh().domain(Ys(F,$=>$.date)).range([0,R]);ot.append("line").attr("x1",C.left).attr("y1",C.top+Y+25).attr("x2",_-C.right).attr("y2",C.top+Y+25).attr("stroke","var(--divider-color)").attr("stroke-width",1).attr("stroke-dasharray","3,3");const vt=ot.append("g").attr("transform",`translate(${_-C.right}, ${C.top-10})`);vt.append("line").attr("x1",-100).attr("y1",0).attr("x2",-80).attr("y2",0).attr("stroke","var(--primary-color)").attr("stroke-width",2).attr("marker-end","url(#circle)"),vt.append("text").attr("x",-75).attr("y",4).attr("fill","var(--text-color-primary)").attr("font-size","var(--font-size-sm)").text(bt("viz.monthly_additions")),vt.append("line").attr("x1",-100).attr("y1",20).attr("x2",-80).attr("y2",20).attr("stroke","var(--secondary-color)").attr("stroke-width",2).attr("stroke-dasharray","4 2"),vt.append("text").attr("x",-75).attr("y",24).attr("fill","var(--text-color-primary)").attr("font-size","var(--font-size-sm)").text(bt("viz.total_items")),ot.append("defs").append("marker").attr("id","circle").attr("viewBox","-5 -5 10 10").attr("refX",0).attr("refY",0).attr("markerWidth",5).attr("markerHeight",5).append("circle").attr("r",3).attr("fill","var(--primary-color)");const O=ot.append("g").attr("transform",`translate(${C.left}, ${C.top})`),gt=wn().domain([0,(Re(F,$=>$.count)||0)*1.1]).range([Y,0]);O.append("g").attr("class","grid").selectAll("line").data(gt.ticks(5)).enter().append("line").attr("x1",0).attr("x2",R).attr("y1",$=>gt($)).attr("y2",$=>gt($)).attr("stroke","var(--divider-color)").attr("stroke-width",.5),O.append("g").attr("class","x-axis").attr("transform",`translate(0, ${Y})`).call(jn(nt).ticks(xn.every(1)).tickFormat(Ye("%Y-%m"))).selectAll("text").style("font-size","var(--font-size-xs)").style("fill","var(--text-color-primary)").style("text-anchor","end").attr("dx","-.8em").attr("dy",".15em").attr("transform","rotate(-45)"),O.append("g").attr("class","y-axis").call(Kn(gt).ticks(5)).selectAll("text").style("font-size","var(--font-size-xs)").style("fill","var(--text-color-primary)"),O.append("text").attr("class","axis-label").attr("transform","rotate(-90)").attr("y",-55).attr("x",-Y/2).attr("text-anchor","middle").style("font-size","var(--font-size-sm)").style("fill","var(--text-color-secondary)").text(bt("viz.monthly_additions"));const dt=so().x($=>nt($.date)).y($=>gt($.count)).curve(fo);O.append("path").datum(F).attr("fill","none").attr("stroke","var(--primary-color)").attr("stroke-width",2).attr("d",dt),O.selectAll(".dot-monthly").data(F).enter().append("circle").attr("class","dot-monthly").attr("cx",$=>nt($.date)).attr("cy",$=>gt($.count)).attr("r",4).attr("fill","var(--primary-color)").attr("stroke","white").attr("stroke-width",1).on("mouseenter",function($,ht){_t(this).transition().duration(200).attr("r",6),wt($,ht,"monthly")}).on("mousemove",function($,ht){wt($,ht,"monthly")}).on("mouseleave",function(){_t(this).transition().duration(200).attr("r",4),ut()});const Tt=ot.append("g").attr("transform",`translate(${C.left}, ${C.top+Y+50})`),X=wn().domain([0,(Re(F,$=>$.total)||0)*1.1]).range([Y,0]);Tt.append("g").attr("class","grid").selectAll("line").data(X.ticks(5)).enter().append("line").attr("x1",0).attr("x2",R).attr("y1",$=>X($)).attr("y2",$=>X($)).attr("stroke","var(--divider-color)").attr("stroke-width",.5),Tt.append("g").attr("class","x-axis").attr("transform",`translate(0, ${Y})`).call(jn(nt).ticks(xn.every(1)).tickFormat(Ye("%Y-%m"))).selectAll("text").style("font-size","var(--font-size-xs)").style("fill","var(--text-color-primary)").style("text-anchor","end").attr("dx","-.8em").attr("dy",".15em").attr("transform","rotate(-45)"),Tt.append("g").attr("class","y-axis").call(Kn(X).ticks(5)).selectAll("text").style("font-size","var(--font-size-xs)").style("fill","var(--text-color-primary)"),Tt.append("text").attr("class","axis-label").attr("transform","rotate(-90)").attr("y",-55).attr("x",-Y/2).attr("text-anchor","middle").style("font-size","var(--font-size-sm)").style("fill","var(--text-color-secondary)").text(bt("viz.total_items")),Tt.append("text").attr("class","axis-label").attr("text-anchor","middle").attr("x",R/2).attr("y",Y+50).style("font-size","var(--font-size-sm)").style("fill","var(--text-color-secondary)").text(bt("viz.month"));const ct=so().x($=>nt($.date)).y($=>X($.total)).curve(fo);Tt.append("path").datum(F).attr("fill","none").attr("stroke","var(--secondary-color)").attr("stroke-width",2).attr("stroke-dasharray","4 2").attr("d",ct),Tt.selectAll(".dot-total").data(F).enter().append("circle").attr("class","dot-total").attr("cx",$=>nt($.date)).attr("cy",$=>X($.total)).attr("r",4).attr("fill","var(--secondary-color)").attr("stroke","white").attr("stroke-width",1).on("mouseenter",function($,ht){_t(this).transition().duration(200).attr("r",6),wt($,ht,"total")}).on("mousemove",function($,ht){wt($,ht,"total")}).on("mouseleave",function(){_t(this).transition().duration(200).attr("r",4),ut()})}function lt(F){const G=F.target;n(0,g=G.value),q()}function st(F){const G=F.target;n(1,x=G.value),q()}me(async()=>{if(console.log("[TimelineDistribution] Component mounted"),await ze(),at(),(!r.items||r.items.length===0)&&(console.log("[TimelineDistribution] No items loaded, waiting for data"),await It.loadItems()),await ze(),!N){console.error("[TimelineDistribution] Container element not found after waiting");return}console.log("[TimelineDistribution] Container found, generating visualization"),it(),q();const F=new ResizeObserver(()=>{N&&q()});return F.observe(N),()=>{F.disconnect(),A&&document.body.contains(A)&&document.body.removeChild(A)}});function k(F){de[F?"unshift":"push"](()=>{N=F,n(2,N)})}return t.$$.update=()=>{t.$$.dirty[0]&11&&r.items&&r.items.length>0&&(console.log("[TimelineDistribution] Items loaded, updating title"),n(7,m=r.items.filter(F=>!(g!=="all"&&F.country!==g||x!=="all"&&F.type!==x)).length),E()),t.$$.dirty[0]&1073741824&&E(),t.$$.dirty[0]&12&&r.items&&N&&(it(),q())},[g,x,N,r,b,T,w,m,S,o,l,s,c,a,u,d,f,h,W,D,H,Q,U,K,tt,ft,kt,j,lt,st,i,k]}class Wp extends Zt{constructor(e){super(),Gt(this,e,Yp,Hp,Xt,{},null,[-1,-1])}}function Uo(t,e,n){const r=t.slice();return r[37]=e[n],r}function Fo(t){let e,n;return{c(){e=mn("svg"),n=mn("path"),y(n,"fill","currentColor"),y(n,"d","M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"),y(e,"viewBox","0 0 24 24"),y(e,"width","14"),y(e,"height","14")},m(r,i){J(r,e,i),p(e,n)},d(r){r&&Z(e)}}}function Ro(t){let e,n,r,i,o=t[37].label+"",l,s,c,a=t[37].count+"",u,d,f,h,g,x=t[37].selected&&Fo();function b(){return t[13](t[37])}function T(...w){return t[14](t[37],...w)}return{c(){e=z("div"),n=z("span"),x&&x.c(),r=rt(),i=z("span"),l=L(o),s=rt(),c=z("span"),u=L(a),d=rt(),y(n,"class","facet-checkbox svelte-1w69s2v"),y(i,"class","facet-label svelte-1w69s2v"),y(c,"class","facet-count svelte-1w69s2v"),y(e,"class","facet-option svelte-1w69s2v"),y(e,"role","checkbox"),y(e,"aria-checked",f=t[37].selected),y(e,"tabindex","0"),oe(e,"selected",t[37].selected)},m(w,m){J(w,e,m),p(e,n),x&&x.m(n,null),p(e,r),p(e,i),p(i,l),p(e,s),p(e,c),p(c,u),p(e,d),h||(g=[St(e,"click",b),St(e,"keydown",T)],h=!0)},p(w,m){t=w,t[37].selected?x||(x=Fo(),x.c(),x.m(n,null)):x&&(x.d(1),x=null),m[0]&2&&o!==(o=t[37].label+"")&&et(l,o),m[0]&2&&a!==(a=t[37].count+"")&&et(u,a),m[0]&2&&f!==(f=t[37].selected)&&y(e,"aria-checked",f),m[0]&2&&oe(e,"selected",t[37].selected)},d(w){w&&Z(e),x&&x.d(),h=!1,Ut(g)}}}function Pp(t){let e,n=t[6].error+"",r;return{c(){e=z("div"),r=L(n),y(e,"class","error svelte-1w69s2v")},m(i,o){J(i,e,o),p(e,r)},p(i,o){o[0]&64&&n!==(n=i[6].error+"")&&et(r,n)},d(i){i&&Z(e)}}}function Bp(t){let e;return{c(){e=z("div"),e.textContent=`${bt("ui.loading")}`,y(e,"class","loading svelte-1w69s2v")},m(n,r){J(n,e,r)},p:xt,d(n){n&&Z(e)}}}function Ho(t){let e,n,r=Array.from(new Set(t[4].map(Oo))).join(", ")+"",i;return{c(){e=z("p"),n=L(`Types: \r
                    `),i=L(r),y(e,"class","svelte-1w69s2v")},m(o,l){J(o,e,l),p(e,n),p(e,i)},p(o,l){l[0]&16&&r!==(r=Array.from(new Set(o[4].map(Oo))).join(", ")+"")&&et(i,r)},d(o){o&&Z(e)}}}function qp(t){let e,n,r,i,o,l,s,c,a,u,d,f,h,g,x=t[3][0]+"",b,T,w,m=t[3][1]+"",v,S,_,M,N,A,I,B,W,D,H,Q,U,K,tt,ft,kt,j,P,E,V,it,at,wt=t[3][0]+"",ut,q,lt=t[3][1]+"",st,k,F,G,ot=t[1],C=[];for(let O=0;O<ot.length;O+=1)C[O]=Ro(Uo(t,ot,O));function R(O,gt){if(O[6].loading)return Bp;if(O[6].error)return Pp}let Y=R(t),nt=Y&&Y(t),vt=t[4].length>0&&Ho(t);return{c(){e=z("div"),n=z("div"),r=z("div"),i=z("div"),o=z("h3"),o.textContent="Countries",l=rt(),s=z("div");for(let O=0;O<C.length;O+=1)C[O].c();c=rt(),a=z("div"),u=z("h3"),u.textContent="Year Range",d=rt(),f=z("div"),h=z("div"),g=z("span"),b=L(x),T=rt(),w=z("span"),v=L(m),S=rt(),_=z("div"),M=z("input"),B=rt(),W=z("input"),U=rt(),K=z("div"),nt&&nt.c(),tt=rt(),ft=z("div"),kt=z("div"),j=z("h3"),j.textContent="Summary",P=rt(),E=z("p"),V=L("Showing "),it=L(t[5]),at=L(" items published between "),ut=L(wt),q=L(" and "),st=L(lt),k=rt(),vt&&vt.c(),y(o,"class","svelte-1w69s2v"),y(s,"class","facet-options svelte-1w69s2v"),y(i,"class","facet-group"),y(r,"class","facets svelte-1w69s2v"),y(u,"class","svelte-1w69s2v"),y(h,"class","slider-labels svelte-1w69s2v"),y(M,"type","range"),y(M,"min",N=t[2][0]),y(M,"max",A=t[2][t[2].length-1]),M.value=I=t[3][0],y(M,"data-index","0"),y(M,"class","svelte-1w69s2v"),y(W,"type","range"),y(W,"min",D=t[2][0]),y(W,"max",H=t[2][t[2].length-1]),W.value=Q=t[3][1],y(W,"data-index","1"),y(W,"class","svelte-1w69s2v"),y(_,"class","slider-inputs svelte-1w69s2v"),y(f,"class","slider-container svelte-1w69s2v"),y(a,"class","year-range svelte-1w69s2v"),y(n,"class","controls svelte-1w69s2v"),y(K,"class","chart-container svelte-1w69s2v"),y(j,"class","svelte-1w69s2v"),y(E,"class","svelte-1w69s2v"),y(kt,"class","stat-summary svelte-1w69s2v"),y(ft,"class","stats svelte-1w69s2v"),y(e,"class","type-distribution-container svelte-1w69s2v")},m(O,gt){J(O,e,gt),p(e,n),p(n,r),p(r,i),p(i,o),p(i,l),p(i,s);for(let dt=0;dt<C.length;dt+=1)C[dt]&&C[dt].m(s,null);p(n,c),p(n,a),p(a,u),p(a,d),p(a,f),p(f,h),p(h,g),p(g,b),p(h,T),p(h,w),p(w,v),p(f,S),p(f,_),p(_,M),p(_,B),p(_,W),p(e,U),p(e,K),nt&&nt.m(K,null),t[15](K),p(e,tt),p(e,ft),p(ft,kt),p(kt,j),p(kt,P),p(kt,E),p(E,V),p(E,it),p(E,at),p(E,ut),p(E,q),p(E,st),p(kt,k),vt&&vt.m(kt,null),F||(G=[St(M,"input",t[12]),St(W,"input",t[12])],F=!0)},p(O,gt){if(gt[0]&2050){ot=O[1];let dt;for(dt=0;dt<ot.length;dt+=1){const Tt=Uo(O,ot,dt);C[dt]?C[dt].p(Tt,gt):(C[dt]=Ro(Tt),C[dt].c(),C[dt].m(s,null))}for(;dt<C.length;dt+=1)C[dt].d(1);C.length=ot.length}gt[0]&8&&x!==(x=O[3][0]+"")&&et(b,x),gt[0]&8&&m!==(m=O[3][1]+"")&&et(v,m),gt[0]&4&&N!==(N=O[2][0])&&y(M,"min",N),gt[0]&4&&A!==(A=O[2][O[2].length-1])&&y(M,"max",A),gt[0]&8&&I!==(I=O[3][0])&&(M.value=I),gt[0]&4&&D!==(D=O[2][0])&&y(W,"min",D),gt[0]&4&&H!==(H=O[2][O[2].length-1])&&y(W,"max",H),gt[0]&8&&Q!==(Q=O[3][1])&&(W.value=Q),Y===(Y=R(O))&&nt?nt.p(O,gt):(nt&&nt.d(1),nt=Y&&Y(O),nt&&(nt.c(),nt.m(K,null))),gt[0]&32&&et(it,O[5]),gt[0]&8&&wt!==(wt=O[3][0]+"")&&et(ut,wt),gt[0]&8&&lt!==(lt=O[3][1]+"")&&et(st,lt),O[4].length>0?vt?vt.p(O,gt):(vt=Ho(O),vt.c(),vt.m(kt,null)):vt&&(vt.d(1),vt=null)},i:xt,o:xt,d(O){O&&Z(e),Ce(C,O),nt&&nt.d(),t[15](null),vt&&vt.d(),F=!1,Ut(G)}}}const jt="TypeDistribution";function Rn(t){return t?/^\d{4}$/.test(t)?parseInt(t):/^\d{4}-\d{2}$/.test(t)||/^\d{4}-\d{2}-\d{2}$/.test(t)?parseInt(t.substring(0,4)):null:null}const Oo=t=>t.type;function Vp(t,e,n){let r,i,o,l,s;yt(t,It,j=>n(6,r=j));let c=!1,a,u,d,f=0,h=0,g=[],x=[],b=[0,0],T=[],w=0,m=[];const v=pt("viz.no_data");yt(t,v,j=>n(25,s=j)),pt("viz.filter_by_country"),pt("viz.all_countries");const S=pt("viz.publication_year");yt(t,S,j=>n(24,l=j));const _=pt("viz.number_of_items");yt(t,_,j=>n(23,o=j));const M=pt("viz.toggle_types");yt(t,M,j=>n(22,i=j)),pt("viz.toggled_type");function N(){if(!r.items||r.items.length===0)return[];const j=g.filter(it=>it.selected).map(it=>it.value),P=r.items.filter(it=>{if(it.type==="Notice d'autorité")return!1;const at=Rn(it.publication_date);return!(!at||at<b[0]||at>b[1]||j.length>0&&!j.includes(it.country))});n(5,w=P.length);const E=new Map;P.forEach(it=>{const at=Rn(it.publication_date);if(!at)return;const wt=it.type||"Unknown",ut=`${at}-${wt}`;E.has(ut)?E.set(ut,E.get(ut)+1):E.set(ut,1)});const V=[];return E.forEach((it,at)=>{const[wt,ut]=at.split("-");V.push({year:parseInt(wt),type:ut,count:it})}),V}function A(){if(!r.items||r.items.length===0)return;const j=r.items.filter(E=>Rn(E.publication_date)!==null&&E.type!=="Notice d'autorité"),P=Ke(j,E=>E.country||"Unknown");n(1,g=Array.from(P,([E,V])=>({value:E,label:E,count:V.length,selected:!1})).filter(E=>E.value!=="Unknown").sort((E,V)=>V.count-E.count))}function I(){if(!r.items||r.items.length===0)return;const j=r.items.filter(V=>V.type!=="Notice d'autorité").map(V=>Rn(V.publication_date)).filter(V=>V!==null);if(j.length===0)return;const P=Math.min(...j),E=Math.max(...j);n(2,x=Array.from({length:E-P+1},(V,it)=>P+it)),n(3,b=[P,E])}function B(j){j.selected=!j.selected,n(1,g=[...g]),U()}function W(j){const P=j.target,E=parseInt(P.dataset.index||"0"),V=parseInt(P.value);E===0?n(3,b=[V,Math.max(V,b[1])]):n(3,b=[Math.min(V,b[0]),V]),U()}function D(){try{d&&document.body.contains(d)&&document.body.removeChild(d),d=document.createElement("div"),d.style.position="absolute",d.style.backgroundColor="rgba(0, 0, 0, 0.8)",d.style.color="white",d.style.padding="8px 12px",d.style.borderRadius="4px",d.style.pointerEvents="none",d.style.display="none",d.style.fontSize="12px",d.style.zIndex="1000",d.style.boxShadow="0 2px 5px rgba(0,0,0,0.2)",document&&document.body&&document.body.appendChild(d)}catch(j){console.error("Error creating tooltip:",j)}}function H(j,P,E){try{if((!d||!document.body.contains(d))&&D(),!d)return;const V=P.data.year,it=E.map(st=>{const k=st.find(F=>F.data.year===V);return{type:st.key,count:k?k[1]-k[0]:0}}).filter(st=>st.count>0),at=it.reduce((st,k)=>st+k.count,0);d.innerHTML=`
                <div style="font-weight:bold;margin-bottom:4px;border-bottom:1px solid rgba(255,255,255,0.3);padding-bottom:2px;">
                    Year: ${V}
                </div>
                <div style="display:grid;grid-template-columns:auto 1fr 1fr;gap:4px;">
                    <span style="font-weight:bold">Type</span>
                    <span style="text-align:right;font-weight:bold">Count</span>
                    <span style="text-align:right;font-weight:bold">%</span>
                    ${it.map(st=>`
                        <span>${st.type}</span>
                        <span style="text-align:right">${st.count}</span>
                        <span style="text-align:right">${(st.count/at*100).toFixed(1)}%</span>
                    `).join("")}
                    <span style="border-top:1px solid rgba(255,255,255,0.3);font-weight:bold;margin-top:2px;padding-top:2px;">Total</span>
                    <span style="border-top:1px solid rgba(255,255,255,0.3);text-align:right;font-weight:bold;margin-top:2px;padding-top:2px;">${at}</span>
                    <span></span>
                </div>
            `;const wt=250,ut=150;let q=j.pageX+10,lt=j.pageY+10;q+wt>window.innerWidth&&(q=j.pageX-wt-10),lt+ut>window.innerHeight&&(lt=j.pageY-ut-10),d.style.left=`${q}px`,d.style.top=`${lt}px`,d.style.display="block"}catch(V){console.error("Error showing tooltip:",V)}}function Q(){try{d&&document.body.contains(d)&&(d.style.display="none")}catch(j){console.error("Error hiding tooltip:",j)}}function U(){if(!u){console.error("Container element not found in updateVisualization");return}if(n(4,T=N()),T.length===0){_t(u).select("svg").remove(),_t(u).select(".no-data").remove(),_t(u).append("div").attr("class","no-data").style("position","absolute").style("top","50%").style("left","50%").style("transform","translate(-50%, -50%)").style("text-align","center").style("color","var(--text-color-secondary)").text(s);return}_t(u).select("svg").remove(),_t(u).select(".no-data").remove();const j=u.getBoundingClientRect();f=j.width,h=j.height;const P={top:40,right:60,bottom:120,left:60},E=f-P.left-P.right,V=h-P.top-P.bottom,it=Array.from(new Set(T.map(Y=>Y.type)));if(m.length===0)m=it.map(Y=>({type:Y,visible:!0}));else{const Y=m.map(nt=>nt.type);it.forEach(nt=>{Y.includes(nt)||m.push({type:nt,visible:!0})})}const at=Array.from(Ke(T.filter(Y=>{var nt;return((nt=m.find(vt=>vt.type===Y.type))==null?void 0:nt.visible)??!0}),Y=>Y.year),([Y,nt])=>{const vt={year:Y};return nt.forEach(O=>{vt[O.type]=O.count}),vt}).sort((Y,nt)=>Y.year-nt.year),wt=it.filter(Y=>{var nt;return((nt=m.find(vt=>vt.type===Y))==null?void 0:nt.visible)??!0}),ut=_t(u).append("svg").attr("width",f).attr("height",h),q=ut.append("g").attr("transform",`translate(${P.left}, ${P.top})`),lt=ui().domain(at.map(Y=>Y.year.toString())).range([0,E]).padding(.1),st=ep().keys(wt).value((Y,nt)=>Y[nt]||0)(at),k=wn().domain([0,Re(st.length>0?st[st.length-1]:[],Y=>Y[1])||0]).range([V,0]),F=De().domain(it).range(Sn);q.append("g").attr("transform",`translate(0, ${V})`).call(jn(lt).tickSizeOuter(0)).selectAll("text").style("text-anchor","middle").attr("dy","0.8em").style("font-size","var(--font-size-xs)").style("fill","var(--text-color-primary)"),q.append("g").call(Kn(k).ticks(5)).selectAll("text").style("font-size","var(--font-size-xs)").style("fill","var(--text-color-primary)"),q.append("text").attr("text-anchor","middle").attr("x",E/2).attr("y",V+P.bottom-10).attr("fill","var(--text-color-secondary)").style("font-size","var(--font-size-sm)").text(l),q.append("text").attr("text-anchor","middle").attr("transform","rotate(-90)").attr("x",-V/2).attr("y",-P.left+15).attr("fill","var(--text-color-secondary)").style("font-size","var(--font-size-sm)").text(o),q.selectAll(".type-bars").data(st).enter().append("g").attr("class","type-bars").attr("fill",Y=>F(Y.key)).selectAll("rect").data(Y=>Y).enter().append("rect").attr("x",Y=>lt(Y.data.year.toString())||0).attr("y",Y=>k(Y[1])).attr("height",Y=>k(Y[0])-k(Y[1])).attr("width",lt.bandwidth()).attr("stroke","white").attr("stroke-width",1).on("mouseenter",(Y,nt)=>{H(Y,nt,st)}).on("mousemove",(Y,nt)=>{H(Y,nt,st)}).on("mouseleave",()=>{Q()}),ut.append("text").attr("x",f/2).attr("y",20).attr("text-anchor","middle").attr("font-size","var(--font-size-lg)").attr("font-weight","bold").attr("fill","var(--text-color-primary)").text(`Item Types by Publication Year (${w} items)`);const G=150,ot=Math.floor(E/G),C=25,R=ut.append("g").attr("class","legend").attr("transform",`translate(${P.left}, ${P.top+V+40})`);R.append("text").attr("x",0).attr("y",-10).attr("font-size","var(--font-size-sm)").attr("font-weight","bold").attr("fill","var(--text-color-primary)").text(i),it.forEach((Y,nt)=>{var X;const vt=((X=m.find(ct=>ct.type===Y))==null?void 0:X.visible)??!0,O=Math.floor(nt/ot),gt=nt%ot,dt=R.append("g").attr("transform",`translate(${gt*G}, ${O*C})`).attr("class","legend-item").attr("role","button").style("cursor","pointer");dt.append("rect").attr("x",-5).attr("y",-5).attr("width",G-10).attr("height",20).attr("fill","transparent").attr("class","legend-hitbox"),dt.append("rect").attr("width",14).attr("height",14).attr("fill",F(Y)).attr("stroke",vt?"none":"#999").attr("stroke-width",vt?0:1).attr("opacity",vt?1:.5);const Tt=dt.append("text").attr("x",24).attr("y",12).attr("font-size","var(--font-size-sm)").attr("fill","var(--text-color-primary)").style("opacity",vt?1:.5).text(Y);if(!vt){const ct=Tt.node();if(ct){const $=ct.getComputedTextLength();dt.append("line").attr("x1",24).attr("y1",12).attr("x2",24+$).attr("y2",12).attr("stroke","var(--text-color-primary)").attr("stroke-width",1).attr("opacity",.7)}}dt.on("click",()=>{console.log(`Clicked on type: ${Y}`),_t(u).append("div").attr("class","debug-message").style("position","fixed").style("bottom","10px").style("left","10px").style("background","rgba(0,0,0,0.7)").style("color","white").style("padding","5px 10px").style("border-radius","4px").style("z-index",9999).text(`Toggled type: ${Y}`).transition().duration(2e3).style("opacity",0).remove();const ct=m.findIndex($=>$.type===Y);ct>=0&&(m[ct].visible=!m[ct].visible,m=[...m],U())}).attr("tabindex","0").on("keydown",ct=>{if(ct.key==="Enter"||ct.key===" "){ct.preventDefault();const $=m.findIndex(ht=>ht.type===Y);$>=0&&(m[$].visible=!m[$].visible,m=[...m],U())}}),dt.on("mouseenter",function(){_t(this).select("text").style("font-weight","bold"),_t(this).select(".legend-hitbox").attr("fill","rgba(0,0,0,0.05)")}).on("mouseleave",function(){_t(this).select("text").style("font-weight","normal"),_t(this).select(".legend-hitbox").attr("fill","transparent")})})}function K(j){!c||!u||(mt(jt,"Items store changed",{itemCount:(j==null?void 0:j.length)||0}),document.body.contains(u)&&(A(),I(),U()))}me(async()=>{if(c=!0,dr(jt),mt(jt,"Component mounted"),await ze(),!u){console.error("Container element not found in onMount");return}D(),a=It.subscribe(P=>{K(P.items)}),r.items&&r.items.length>0?(A(),I(),U()):It.loadItems();const j=new ResizeObserver(()=>{c&&u&&document.body.contains(u)&&U()});return j.observe(u),()=>{c=!1,je(jt),mt(jt,"Component cleanup started");try{j.disconnect(),mt(jt,"Resize observer disconnected")}catch(P){console.error("Error disconnecting resize observer:",P)}try{d&&document.body.contains(d)&&(document.body.removeChild(d),mt(jt,"Tooltip removed"))}catch(P){console.error("Error removing tooltip:",P)}a&&(a(),mt(jt,"Unsubscribed from items store")),mt(jt,"Component cleanup completed")}}),Cn(()=>{c&&(c=!1,je(jt),mt(jt,"Component destroyed (backup cleanup)"),a&&(a(),mt(jt,"Unsubscribed from items store (backup)")))});const tt=j=>B(j),ft=(j,P)=>P.key==="Enter"&&B(j);function kt(j){de[j?"unshift":"push"](()=>{u=j,n(0,u)})}return[u,g,x,b,T,w,r,v,S,_,M,B,W,tt,ft,kt]}class Xp extends Zt{constructor(e){super(),Gt(this,e,Vp,qp,Xt,{},null,[-1,-1])}}function jp(t){let e,n=t[4].error+"",r;return{c(){e=z("div"),r=L(n),y(e,"class","error svelte-dvynwo")},m(i,o){J(i,e,o),p(e,r)},p(i,o){o[0]&16&&n!==(n=i[4].error+"")&&et(r,n)},d(i){i&&Z(e)}}}function Kp(t){let e;return{c(){e=z("div"),e.textContent=`${bt("ui.loading")}`,y(e,"class","loading svelte-dvynwo")},m(n,r){J(n,e,r)},p:xt,d(n){n&&Z(e)}}}function Yo(t){let e,n,r,i,o=Math.round(t[1]/t[2]).toLocaleString()+"",l;return{c(){e=z("p"),n=L(t[5]),r=L(": "),i=z("strong"),l=L(o),y(e,"class","svelte-dvynwo")},m(s,c){J(s,e,c),p(e,n),p(e,r),p(e,i),p(i,l)},p(s,c){c[0]&32&&et(n,s[5]),c[0]&6&&o!==(o=Math.round(s[1]/s[2]).toLocaleString()+"")&&et(l,o)},d(s){s&&Z(e)}}}function Gp(t){let e,n;return{c(){e=z("p"),n=L(t[6]),y(e,"class","svelte-dvynwo")},m(r,i){J(r,e,i),p(e,n)},p(r,i){i[0]&64&&et(n,r[6])},d(r){r&&Z(e)}}}function Zp(t){let e,n,r,i,o=t[3].data.name+"",l,s,c,a;return{c(){e=z("p"),n=L(t[10]),r=L(": "),i=z("strong"),l=L(o),s=rt(),c=z("p"),a=L(t[11]),y(e,"class","svelte-dvynwo"),y(c,"class","svelte-dvynwo")},m(u,d){J(u,e,d),p(e,n),p(e,r),p(e,i),p(i,l),J(u,s,d),J(u,c,d),p(c,a)},p(u,d){d[0]&1024&&et(n,u[10]),d[0]&8&&o!==(o=u[3].data.name+"")&&et(l,o),d[0]&2048&&et(a,u[11])},d(u){u&&Z(e),u&&Z(s),u&&Z(c)}}}function Jp(t){let e,n,r,i,o,l,s,c,a,u,d,f,h,g,x,b,T,w,m=t[1].toLocaleString()+"",v,S,_;function M(H,Q){if(H[4].loading)return Kp;if(H[4].error)return jp}let N=M(t),A=N&&N(t),I=t[2]>0&&Yo(t);function B(H,Q){return H[3]?Zp:Gp}let W=B(t),D=W(t);return{c(){e=z("div"),n=z("div"),A&&A.c(),r=rt(),i=z("div"),o=z("div"),l=z("h3"),s=L(t[7]),c=rt(),a=z("p"),u=L(t[8]),d=L(": "),f=z("strong"),h=L(t[2]),g=rt(),x=z("p"),b=L(t[9]),T=L(": "),w=z("strong"),v=L(m),S=rt(),I&&I.c(),_=rt(),D.c(),y(n,"class","chart-container svelte-dvynwo"),y(l,"class","svelte-dvynwo"),y(a,"class","svelte-dvynwo"),y(x,"class","svelte-dvynwo"),y(o,"class","stat-summary svelte-dvynwo"),y(i,"class","stats svelte-dvynwo"),y(e,"class","word-distribution-container svelte-dvynwo")},m(H,Q){J(H,e,Q),p(e,n),A&&A.m(n,null),t[25](n),p(e,r),p(e,i),p(i,o),p(o,l),p(l,s),p(o,c),p(o,a),p(a,u),p(a,d),p(a,f),p(f,h),p(o,g),p(o,x),p(x,b),p(x,T),p(x,w),p(w,v),p(o,S),I&&I.m(o,null),p(o,_),D.m(o,null)},p(H,Q){N===(N=M(H))&&A?A.p(H,Q):(A&&A.d(1),A=N&&N(H),A&&(A.c(),A.m(n,null))),Q[0]&128&&et(s,H[7]),Q[0]&256&&et(u,H[8]),Q[0]&4&&et(h,H[2]),Q[0]&512&&et(b,H[9]),Q[0]&2&&m!==(m=H[1].toLocaleString()+"")&&et(v,m),H[2]>0?I?I.p(H,Q):(I=Yo(H),I.c(),I.m(o,_)):I&&(I.d(1),I=null),W===(W=B(H))&&D?D.p(H,Q):(D.d(1),D=W(H),D&&(D.c(),D.m(o,null)))},i:xt,o:xt,d(H){H&&Z(e),A&&A.d(),t[25](null),I&&I.d(),D.d()}}}const Dt="WordDistribution";function Qp(t,e,n){let r,i,o,l,s,c,a,u,d,f,h,g,x,b;yt(t,It,k=>n(4,r=k));let T=!1,w,m,v,S=0,_=0,M=0,N=0,A={name:"root",children:[]},I=null;const B=pt("viz.no_data");yt(t,B,k=>n(37,d=k)),pt("viz.word_distribution");const W=pt("viz.total_words");yt(t,W,k=>n(9,g=k));const D=pt("viz.avg_words_per_item");yt(t,D,k=>n(5,l=k));const H=pt("viz.click_zoom_in");yt(t,H,k=>n(6,a=k)),pt("viz.click_zoom_out"),pt("viz.unknown"),pt("viz.no_set");const Q=pt("viz.back_to_all");yt(t,Q,k=>n(36,u=k));const U=pt("viz.currently_viewing");yt(t,U,k=>n(10,x=k));const K=pt("viz.click_back_to_return");yt(t,K,k=>n(11,b=k));const tt=pt("viz.total_items_with_word_count");yt(t,tt,k=>n(8,h=k));const ft=pt("viz.summary");yt(t,ft,k=>n(7,f=k));const kt=pt("viz.words");yt(t,kt,k=>n(35,c=k));const j=pt("viz.items");yt(t,j,k=>n(34,s=k));const P=pt("viz.percent_of_country");yt(t,P,k=>n(33,o=k));const E=pt("viz.percent_of_total");yt(t,E,k=>n(32,i=k)),pt("viz.item_set_summary");function V(){if(!r.items||r.items.length===0)return{name:"root",children:[]};const k=r.items.filter(ot=>ot.word_count!==void 0);n(2,N=k.length),n(1,M=k.reduce((ot,C)=>ot+(C.word_count||0),0));const F=Ke(k,ot=>ot.country||"Unknown"),G={name:"Word Distribution",children:[]};return F.forEach((ot,C)=>{const R=Ke(ot,nt=>nt.item_set_title||"No Set"),Y={name:C,children:[],wordCount:0,itemCount:ot.length};R.forEach((nt,vt)=>{const O=nt.reduce((dt,Tt)=>dt+(Tt.word_count||0),0),gt={name:vt,value:O,wordCount:O,itemCount:nt.length};Y.children.push(gt),Y.wordCount!==void 0?Y.wordCount+=O:Y.wordCount=O}),Y.children.sort((nt,vt)=>(vt.wordCount||0)-(nt.wordCount||0)),G.children.push(Y)}),G.children.sort((ot,C)=>(C.wordCount||0)-(ot.wordCount||0)),G}function it(k){if(n(3,I=k),I&&(!I.children||I.children.length===0)){const F={name:I.data.name,children:I.data.children||[],wordCount:I.data.wordCount,itemCount:I.data.itemCount};if(!F.children||F.children.length===0){console.warn("Cannot zoom to node without children");return}}at()}function at(){var k;try{if(!m){console.error("Container element not found");return}if(I||(A=V()),!A.children||A.children.length===0){_t(m).select("svg").remove(),_t(m).append("div").attr("class","no-data").style("position","absolute").style("top","50%").style("left","50%").style("transform","translate(-50%, -50%)").style("text-align","center").style("color","var(--text-color-secondary)").text(d);return}_t(m).select("svg").remove(),_t(m).select(".no-data").remove();const F=m.getBoundingClientRect();S=F.width,_=F.height;const G={top:40,right:10,bottom:10,left:10},ot=S-G.left-G.right,C=_-G.top-G.bottom,R=_t(m).append("svg").attr("width",S).attr("height",_),Y=I?`${I.data.name}: ${((k=I.data.wordCount)==null?void 0:k.toLocaleString())||0} ${c} (${I.data.itemCount} ${s})`:bt("viz.word_distribution_subtitle",[N.toString(),M.toLocaleString()]);R.append("text").attr("x",S/2).attr("y",20).attr("text-anchor","middle").attr("font-size","var(--font-size-lg)").attr("font-weight","bold").attr("fill","var(--text-color-primary)").text(Y);const nt=R.append("g").attr("transform",`translate(${G.left}, ${G.top})`);if(I){const X=R.append("g").attr("class","zoom-out-button").attr("transform",`translate(${G.left}, ${G.top-30})`).style("cursor","pointer").on("click",()=>it(null));X.append("rect").attr("width",100).attr("height",24).attr("rx",4).attr("fill","var(--primary-color)").attr("opacity",.8),X.append("text").attr("x",50).attr("y",16).attr("text-anchor","middle").attr("fill","white").attr("font-size","var(--font-size-sm)").text(u)}const vt=Pl().size([ot,C]).paddingOuter(4).paddingTop(20).paddingInner(1).round(!0);let O;if(I)if(I.data.children&&I.data.children.length>0){const X={name:I.data.name,children:I.data.children};O=re(X).sum(ct=>ct.value||0).sort((ct,$)=>($.value||0)-(ct.value||0))}else if(I.children&&I.children.length>0){const X=I.children.map($=>({name:$.data.name,value:$.data.value||$.value,wordCount:$.data.wordCount,itemCount:$.data.itemCount})),ct={name:I.data.name,children:X};O=re(ct).sum($=>$.value||0).sort(($,ht)=>(ht.value||0)-($.value||0))}else console.warn("Zoomed node has no valid children data, falling back to full hierarchy"),A=V(),O=re(A).sum(X=>X.value||0).sort((X,ct)=>(ct.value||0)-(X.value||0));else O=re(A).sum(X=>X.value||0).sort((X,ct)=>(ct.value||0)-(X.value||0));try{vt(O)}catch(X){console.error("Error applying treemap layout:",X),n(3,I=null),A=V(),O=re(A).sum(ct=>ct.value||0).sort((ct,$)=>($.value||0)-(ct.value||0)),vt(O)}const gt=De().domain(O.children?O.children.map(X=>X.data.name):[O.data.name]).range(Sn),dt=nt.selectAll(".country").data(I?[]:O.children||[]).enter().append("g").attr("class","country").attr("transform",X=>{const ct=X.x0||0,$=X.y0||0;return`translate(${ct},${$})`});dt.append("rect").attr("width",X=>{const ct=X.x0||0,$=X.x1||0;return Math.max(0,$-ct)}).attr("height",X=>{const ct=X.y0||0,$=X.y1||0;return Math.max(0,$-ct)}).attr("fill",X=>gt(X.data.name)).attr("stroke","white").attr("stroke-width",2).style("opacity",.7).style("cursor","pointer").on("click",(X,ct)=>{it(ct)}).attr("title",a).append("title").text(()=>a),dt.append("text").attr("x",5).attr("y",15).attr("font-size","var(--font-size-sm)").attr("font-weight","bold").attr("fill","white").text(X=>{var ct;return`${X.data.name} (${((ct=X.data.wordCount)==null?void 0:ct.toLocaleString())||0} ${c})`}).style("pointer-events","none").each(function(X){var Ct;const ct=_t(this),$=this.getComputedTextLength(),ht=X.x1-X.x0-10;$>ht&&ct.text(X.data.name).append("title").text(`${X.data.name} (${((Ct=X.data.wordCount)==null?void 0:Ct.toLocaleString())||0} ${c})`)});const Tt=nt.selectAll(".item-set").data(I?O.children||[]:O.leaves()).enter().append("g").attr("class","item-set").attr("transform",X=>{const ct=X.x0||0,$=X.y0||0;return`translate(${ct},${$})`});Tt.append("rect").attr("width",X=>{const ct=X.x0||0,$=X.x1||0;return Math.max(0,$-ct)}).attr("height",X=>{const ct=X.y0||0,$=X.y1||0;return Math.max(0,$-ct)}).attr("fill",X=>{var ht,Ct;const ct=gt(I?I.data.name:((Ct=(ht=X.parent)==null?void 0:ht.data)==null?void 0:Ct.name)||"Unknown"),$=_e(ct);return _e($).brighter(.7).toString()}).attr("stroke","white").attr("stroke-width",.5).style("cursor","pointer").on("mouseover",function(X,ct){_t(this).attr("stroke","var(--primary-color)").attr("stroke-width",2),ut(ct,X)}).on("mousemove",function(X,ct){ut(ct,X)}).on("mouseout",function(){_t(this).attr("stroke","white").attr("stroke-width",.5),q()}),Tt.append("text").attr("x",3).attr("y",13).attr("font-size","var(--font-size-xs)").attr("fill","var(--text-color-primary)").style("pointer-events","none").each(function(X){var nn;const ct=_t(this),$=X.x1-X.x0,ht=X.y1-X.y0;if($<30||ht<20)return;let Ct=X.data.name;const ee=$-6,Yt=I?I.data.name:X.parent?X.parent.data.name:"";ct.text(Ct).append("title").text(`${Yt} > ${X.data.name}: ${((nn=X.data.wordCount)==null?void 0:nn.toLocaleString())||0} ${c} (${X.data.itemCount} ${s})`);const $n=this;let Dn=$n.getComputedTextLength(),en=!1;for(;Dn>ee&&Ct.length>3;)Ct=Ct.slice(0,-1),ct.text(Ct),Dn=$n.getComputedTextLength(),en=!0;en&&ct.text(Ct+"...")})}catch(F){console.error("Error in updateVisualization:",F)}}function wt(){try{v&&document.body.contains(v)&&document.body.removeChild(v),v=document.createElement("div"),v.style.position="absolute",v.style.backgroundColor="rgba(0, 0, 0, 0.8)",v.style.color="white",v.style.padding="8px 12px",v.style.borderRadius="4px",v.style.pointerEvents="none",v.style.display="none",v.style.fontSize="12px",v.style.zIndex="1000",v.style.boxShadow="0 2px 5px rgba(0,0,0,0.2)",document&&document.body&&document.body.appendChild(v)}catch(k){console.error("Error creating tooltip:",k)}}function ut(k,F){try{if((!v||!document.body.contains(v))&&(mt(Dt,"Tooltip element not found, creating new one"),wt()),!F){mt(Dt,"Event object is undefined in showTooltip");return}const G=k.parent?k.parent.data.name:k.data.name,ot=k.parent?k.data.name:"All",C=k.data.wordCount||0,R=k.data.itemCount||0,Y=R>0?Math.round(C/R):0,nt=I?I.data.wordCount:k.parent?k.parent.data.wordCount:0,vt=nt&&nt>0?(C/nt*100).toFixed(1)+"%":"N/A",O=M>0?(C/M*100).toFixed(1)+"%":"N/A";v.innerHTML=`
                <div style="font-weight:bold;margin-bottom:4px;border-bottom:1px solid rgba(255,255,255,0.3);padding-bottom:2px;">
                    ${G} > ${ot}
                </div>
                <div style="display:grid;grid-template-columns:auto auto;gap:4px;">
                    <span>${c}:</span>
                    <span style="text-align:right;font-weight:bold">${C.toLocaleString()}</span>
                    <span>${s}:</span>
                    <span style="text-align:right">${R}</span>
                    <span>${l}:</span>
                    <span style="text-align:right">${Y}</span>
                    <span>${o}:</span>
                    <span style="text-align:right">${vt}</span>
                    <span>${i}:</span>
                    <span style="text-align:right">${O}</span>
                </div>
            `;const gt=200,dt=120;let Tt=0,X=0;try{Tt=F.pageX+10,X=F.pageY+10,Tt+gt>window.innerWidth&&(Tt=F.pageX-gt-10),X+dt>window.innerHeight&&(X=F.pageY-dt-10),Tt=Math.max(0,Tt),X=Math.max(0,X)}catch(ct){mt(Dt,"Error calculating tooltip position",ct),Tt=window.innerWidth/2-gt/2,X=window.innerHeight/2-dt/2}v.style.left=`${Tt}px`,v.style.top=`${X}px`,v.style.display="block",mt(Dt,"Tooltip shown",{country:G,itemSet:ot,position:{left:Tt,top:X}})}catch(G){console.error("Error showing tooltip:",G),mt(Dt,"Error showing tooltip",G)}}function q(){try{v&&document.body.contains(v)&&(v.style.display="none")}catch(k){console.error("Error hiding tooltip:",k)}}function lt(k){!T||!m||(mt(Dt,"Items store changed",{itemCount:(k==null?void 0:k.length)||0}),document.body.contains(m)&&at())}me(async()=>{try{if(T=!0,dr(Dt),mt(Dt,"Component mounted"),await ze(),!m){console.error("Container element not found in onMount");return}wt(),w=It.subscribe(F=>{lt(F.items)}),r.items&&r.items.length>0?at():It.loadItems();const k=new ResizeObserver(()=>{T&&m&&document.body.contains(m)&&at()});return k.observe(m),()=>{try{T=!1,je(Dt),mt(Dt,"Component cleanup started"),k&&(k.disconnect(),mt(Dt,"Resize observer disconnected")),m&&(_t(m).selectAll("*").remove(),mt(Dt,"D3 selections removed")),v&&document.body.contains(v)&&(document.body.removeChild(v),mt(Dt,"Tooltip removed")),w&&(w(),mt(Dt,"Unsubscribed from items store")),mt(Dt,"Component cleanup completed")}catch(F){console.error("Error during cleanup:",F)}}}catch(k){console.error("Error in onMount:",k)}}),Cn(()=>{if(T){T=!1,je(Dt),mt(Dt,"Component destroyed (backup cleanup)");try{w&&(w(),mt(Dt,"Unsubscribed from items store (backup)")),v&&document.body.contains(v)&&(document.body.removeChild(v),mt(Dt,"Tooltip removed (backup)"))}catch(k){console.error("Error during backup cleanup:",k)}}});function st(k){de[k?"unshift":"push"](()=>{m=k,n(0,m)})}return[m,M,N,I,r,l,a,f,h,g,x,b,B,W,D,H,Q,U,K,tt,ft,kt,j,P,E,st]}class tg extends Zt{constructor(e){super(),Gt(this,e,Qp,Jp,Xt,{},null,[-1,-1])}}function Wo(t,e,n){const r=t.slice();return r[15]=e[n],r}function Po(t){let e,n,r,i,o,l,s,c,a=t[4]?"⏸️":"▶️",u,d,f,h,g,x,b,T,w,m,v,S,_,M,N,A,I=t[10]().length+"",B,W,D=t[1].length+"",H,Q,U,K,tt,ft,kt=t[10]().slice().reverse(),j=[];for(let P=0;P<kt.length;P+=1)j[P]=Bo(Wo(t,kt,P));return{c(){e=z("div"),n=z("div"),r=z("h2"),r.textContent="IWAC Debug Panel",i=rt(),o=z("div"),l=z("button"),l.textContent="🔄",s=rt(),c=z("button"),u=L(a),d=rt(),f=z("button"),f.textContent="💾",h=rt(),g=z("button"),g.textContent="🗑️",x=rt(),b=z("button"),b.textContent="❌",T=rt(),w=z("div"),m=z("input"),v=rt(),S=z("input"),_=rt(),M=z("div"),N=z("div"),A=L("Showing "),B=L(I),W=L(" of "),H=L(D),Q=L(" logs"),U=rt(),K=z("div");for(let P=0;P<j.length;P+=1)j[P].c();y(r,"class","svelte-uin0mg"),y(l,"title","Refresh Logs"),y(l,"class","svelte-uin0mg"),y(c,"title","Auto Refresh"),y(c,"class","svelte-uin0mg"),oe(c,"active",t[4]),y(f,"title","Download Logs"),y(f,"class","svelte-uin0mg"),y(g,"title","Clear Logs"),y(g,"class","svelte-uin0mg"),y(b,"title","Close"),y(b,"class","svelte-uin0mg"),y(o,"class","debug-controls svelte-uin0mg"),y(n,"class","debug-header svelte-uin0mg"),y(m,"type","text"),y(m,"placeholder","Filter logs..."),y(m,"title","Filter by any text"),y(m,"class","svelte-uin0mg"),y(S,"type","text"),y(S,"placeholder","Filter by component..."),y(S,"title","Filter by component name"),y(S,"class","svelte-uin0mg"),y(w,"class","debug-filters svelte-uin0mg"),y(N,"class","log-count svelte-uin0mg"),y(K,"class","log-list svelte-uin0mg"),y(M,"class","debug-content svelte-uin0mg"),y(e,"class","debug-panel svelte-uin0mg")},m(P,E){J(P,e,E),p(e,n),p(n,r),p(n,i),p(n,o),p(o,l),p(o,s),p(o,c),p(c,u),p(o,d),p(o,f),p(o,h),p(o,g),p(o,x),p(o,b),p(e,T),p(e,w),p(w,m),Nn(m,t[2]),p(w,v),p(w,S),Nn(S,t[3]),p(e,_),p(e,M),p(M,N),p(N,A),p(N,B),p(N,W),p(N,H),p(N,Q),p(M,U),p(M,K);for(let V=0;V<j.length;V+=1)j[V]&&j[V].m(K,null);tt||(ft=[St(l,"click",t[6]),St(c,"click",t[9]),St(f,"click",t[7]),St(g,"click",t[8]),St(b,"click",t[5]),St(m,"input",t[12]),St(S,"input",t[13])],tt=!0)},p(P,E){if(E&16&&a!==(a=P[4]?"⏸️":"▶️")&&et(u,a),E&16&&oe(c,"active",P[4]),E&4&&m.value!==P[2]&&Nn(m,P[2]),E&8&&S.value!==P[3]&&Nn(S,P[3]),E&2&&D!==(D=P[1].length+"")&&et(H,D),E&1024){kt=P[10]().slice().reverse();let V;for(V=0;V<kt.length;V+=1){const it=Wo(P,kt,V);j[V]?j[V].p(it,E):(j[V]=Bo(it),j[V].c(),j[V].m(K,null))}for(;V<j.length;V+=1)j[V].d(1);j.length=kt.length}},d(P){P&&Z(e),Ce(j,P),tt=!1,Ut(ft)}}}function eg(t){let e,n,r=JSON.stringify(t[15].details,null,2)+"",i;return{c(){e=z("div"),n=z("pre"),i=L(r),y(n,"class","svelte-uin0mg"),y(e,"class","log-details svelte-uin0mg")},m(o,l){J(o,e,l),p(e,n),p(n,i)},p:xt,d(o){o&&Z(e)}}}function Bo(t){let e,n,r=new Date(t[15].timestamp).toLocaleTimeString()+"",i,o,l,s=t[15].component+"",c,a,u,d=t[15].action+"",f,h,g,x=t[15].details&&eg(t);return{c(){e=z("div"),n=z("div"),i=L(r),o=rt(),l=z("div"),c=L(s),a=rt(),u=z("div"),f=L(d),h=rt(),x&&x.c(),g=rt(),y(n,"class","log-timestamp svelte-uin0mg"),y(l,"class","log-component svelte-uin0mg"),y(u,"class","log-action svelte-uin0mg"),y(e,"class","log-entry svelte-uin0mg")},m(b,T){J(b,e,T),p(e,n),p(n,i),p(e,o),p(e,l),p(l,c),p(e,a),p(e,u),p(u,f),p(e,h),x&&x.m(e,null),p(e,g)},p(b,T){b[15].details&&x.p(b,T)},d(b){b&&Z(e),x&&x.d()}}}function ng(t){let e,n,r,i,o,l=t[0]&&Po(t);return{c(){e=z("div"),e.textContent="🐞",n=rt(),l&&l.c(),r=nl(),y(e,"class","debug-toggle svelte-uin0mg"),y(e,"role","button"),y(e,"tabindex","0"),y(e,"title","Toggle Debug Panel (Ctrl+Shift+D)")},m(s,c){J(s,e,c),J(s,n,c),l&&l.m(s,c),J(s,r,c),i||(o=[St(e,"click",t[5]),St(e,"keydown",t[11])],i=!0)},p(s,[c]){s[0]?l?l.p(s,c):(l=Po(s),l.c(),l.m(r.parentNode,r)):l&&(l.d(1),l=null)},i:xt,o:xt,d(s){s&&Z(e),s&&Z(n),l&&l.d(s),s&&Z(r),i=!1,Ut(o)}}}const ye="DebugPanel";function rg(t,e,n){let r=!1,i=[],o="",l="",s=!1,c;function a(){n(0,r=!r),mt(ye,`Debug panel ${r?"shown":"hidden"}`)}function u(){typeof window<"u"&&window.__IWAC_DEBUG&&(n(1,i=[...window.__IWAC_DEBUG.logs]),mt(ye,`Refreshed logs, count: ${i.length}`))}function d(){const w=typeof window<"u"&&window.__IWAC_DEBUG?JSON.stringify(window.__IWAC_DEBUG.logs,null,2):Jr(),m=new Blob([w],{type:"application/json"}),v=URL.createObjectURL(m),S=document.createElement("a");S.href=v,S.download=`iwac-debug-logs-${new Date().toISOString().replace(/:/g,"-")}.json`,document.body.appendChild(S),S.click(),document.body.removeChild(S),URL.revokeObjectURL(v),mt(ye,"Logs downloaded")}function f(){typeof window<"u"&&window.__IWAC_DEBUG&&(window.__IWAC_DEBUG.logs.length=0,u(),mt(ye,"Logs cleared"))}function h(){n(4,s=!s),s?(c=setInterval(u,1e3),mt(ye,"Auto-refresh enabled")):(clearInterval(c),mt(ye,"Auto-refresh disabled"))}function g(){return i.filter(w=>{const m=o===""||JSON.stringify(w).toLowerCase().includes(o.toLowerCase()),v=l===""||w.component.toLowerCase().includes(l.toLowerCase());return m&&v})}me(()=>{mt(ye,"Debug panel mounted"),u();const w=m=>{m.ctrlKey&&m.shiftKey&&m.key==="D"&&(m.preventDefault(),a())};return window.addEventListener("keydown",w),()=>{window.removeEventListener("keydown",w),c&&clearInterval(c)}}),Cn(()=>{mt(ye,"Debug panel destroyed"),c&&clearInterval(c)});const x=w=>w.key==="Enter"&&a();function b(){o=this.value,n(2,o)}function T(){l=this.value,n(3,l)}return[r,i,o,l,s,a,u,d,f,h,g,x,b,T]}class ig extends Zt{constructor(e){super(),Gt(this,e,rg,ng,Xt,{})}}function qo(t,e,n){const r=t.slice();return r[13]=e[n],r}function Vo(t){let e,n=bt(t[13].label)+"",r,i,o,l,s;function c(){return t[3](t[13])}function a(...u){return t[4](t[13],...u)}return{c(){e=z("li"),r=L(n),i=rt(),y(e,"role","tab"),y(e,"tabindex","0"),y(e,"aria-selected",o=t[0]===t[13].id),y(e,"class","svelte-s68afz"),oe(e,"active",t[0]===t[13].id)},m(u,d){J(u,e,d),p(e,r),p(e,i),l||(s=[St(e,"click",c),St(e,"keydown",a)],l=!0)},p(u,d){t=u,d&1&&o!==(o=t[0]===t[13].id)&&y(e,"aria-selected",o),d&5&&oe(e,"active",t[0]===t[13].id)},d(u){u&&Z(e),l=!1,Ut(s)}}}function og(t){let e,n;return e=new tg({}),{c(){Bt(e.$$.fragment)},m(r,i){Ht(e,r,i),n=!0},p:xt,i(r){n||(At(e.$$.fragment,r),n=!0)},o(r){$t(e.$$.fragment,r),n=!1},d(r){Ot(e,r)}}}function lg(t){let e,n;return e=new Lp({}),{c(){Bt(e.$$.fragment)},m(r,i){Ht(e,r,i),n=!0},p:xt,i(r){n||(At(e.$$.fragment,r),n=!0)},o(r){$t(e.$$.fragment,r),n=!1},d(r){Ot(e,r)}}}function sg(t){let e,n;return e=new Xp({}),{c(){Bt(e.$$.fragment)},m(r,i){Ht(e,r,i),n=!0},p:xt,i(r){n||(At(e.$$.fragment,r),n=!0)},o(r){$t(e.$$.fragment,r),n=!1},d(r){Ot(e,r)}}}function ag(t){let e,n;return e=new Wp({}),{c(){Bt(e.$$.fragment)},m(r,i){Ht(e,r,i),n=!0},p:xt,i(r){n||(At(e.$$.fragment,r),n=!0)},o(r){$t(e.$$.fragment,r),n=!1},d(r){Ot(e,r)}}}function ug(t){let e,n;return e=new $p({}),{c(){Bt(e.$$.fragment)},m(r,i){Ht(e,r,i),n=!0},p:xt,i(r){n||(At(e.$$.fragment,r),n=!0)},o(r){$t(e.$$.fragment,r),n=!1},d(r){Ot(e,r)}}}function cg(t){let e,n;return e=new Tp({}),{c(){Bt(e.$$.fragment)},m(r,i){Ht(e,r,i),n=!0},p:xt,i(r){n||(At(e.$$.fragment,r),n=!0)},o(r){$t(e.$$.fragment,r),n=!1},d(r){Ot(e,r)}}}function fg(t){let e,n=t[1].error+"",r;return{c(){e=z("div"),r=L(n),y(e,"class","error svelte-s68afz")},m(i,o){J(i,e,o),p(e,r)},p(i,o){o&2&&n!==(n=i[1].error+"")&&et(r,n)},i:xt,o:xt,d(i){i&&Z(e)}}}function dg(t){let e;return{c(){e=z("div"),e.textContent=`${bt("ui.loading")}`,y(e,"class","loading svelte-s68afz")},m(n,r){J(n,e,r)},p:xt,i:xt,o:xt,d(n){n&&Z(e)}}}function hg(t){let e,n,r,i,o,l,s,c,a,u,d,f,h,g,x,b;l=new Ss({});let T=t[2],w=[];for(let _=0;_<T.length;_+=1)w[_]=Vo(qo(t,T,_));const m=[dg,fg,cg,ug,ag,sg,lg,og],v=[];function S(_,M){return _[1].loading?0:_[1].error?1:_[0]==="countries"?2:_[0]==="languages"?3:_[0]==="timeline"?4:_[0]==="types"?5:_[0]==="categories"?6:_[0]==="words"?7:-1}return~(f=S(t))&&(h=v[f]=m[f](t)),x=new ig({}),{c(){e=z("main"),n=z("header"),r=z("div"),i=z("h1"),i.textContent=`${bt("app.title")}`,o=rt(),Bt(l.$$.fragment),s=rt(),c=z("nav"),a=z("ul");for(let _=0;_<w.length;_+=1)w[_].c();u=rt(),d=z("div"),h&&h.c(),g=rt(),Bt(x.$$.fragment),y(i,"class","svelte-s68afz"),y(r,"class","header-top svelte-s68afz"),y(a,"class","tabs svelte-s68afz"),y(n,"class","svelte-s68afz"),y(d,"class","content svelte-s68afz"),y(e,"class","svelte-s68afz")},m(_,M){J(_,e,M),p(e,n),p(n,r),p(r,i),p(r,o),Ht(l,r,null),p(n,s),p(n,c),p(c,a);for(let N=0;N<w.length;N+=1)w[N]&&w[N].m(a,null);p(e,u),p(e,d),~f&&v[f].m(d,null),J(_,g,M),Ht(x,_,M),b=!0},p(_,M){if(M&5){T=_[2];let A;for(A=0;A<T.length;A+=1){const I=qo(_,T,A);w[A]?w[A].p(I,M):(w[A]=Vo(I),w[A].c(),w[A].m(a,null))}for(;A<w.length;A+=1)w[A].d(1);w.length=T.length}let N=f;f=S(_),f===N?~f&&v[f].p(_,M):(h&&(Kr(),$t(v[N],1,1,()=>{v[N]=null}),Gr()),~f?(h=v[f],h?h.p(_,M):(h=v[f]=m[f](_),h.c()),At(h,1),h.m(d,null)):h=null)},i(_){b||(At(l.$$.fragment,_),At(h),At(x.$$.fragment,_),b=!0)},o(_){$t(l.$$.fragment,_),$t(h),$t(x.$$.fragment,_),b=!1},d(_){_&&Z(e),Ot(l),Ce(w,_),~f&&v[f].d(),_&&Z(g),Ot(x,_)}}}function pg(t){let e,n;return e=new Is({props:{$$slots:{default:[hg]},$$scope:{ctx:t}}}),{c(){Bt(e.$$.fragment)},m(r,i){Ht(e,r,i),n=!0},p(r,[i]){const o={};i&65539&&(o.$$scope={dirty:i,ctx:r}),e.$set(o)},i(r){n||(At(e.$$.fragment,r),n=!0)},o(r){$t(e.$$.fragment,r),n=!1},d(r){Ot(e,r)}}}const Pt="App";function gg(t,e,n){let r,i;yt(t,qt,b=>n(11,r=b)),yt(t,It,b=>n(1,i=b));let o=!1,l,s=0,c=0,a="countries";const u=[{id:"countries",label:"tab.countries"},{id:"languages",label:"tab.languages"},{id:"timeline",label:"tab.timeline"},{id:"types",label:"tab.types"},{id:"categories",label:"tab.categories"},{id:"words",label:"tab.words"}];let d="",f="";function h(b){var T;if(!o){mt(Pt,`Language change ignored (not mounted): ${b}`);return}f=d,d=b,mt(Pt,`Language changed from ${f} to ${b}`,{isMounted:o,updateCount:s,subscriptionActive:!!l}),mt(Pt,"Current translations:",{title:bt("app.title"),loading:bt("ui.loading"),activeTab:bt(((T=u.find(w=>w.id===a))==null?void 0:T.label)||"")})}return rl(()=>{c++,mt(Pt,`Before update (render #${c})`,{isMounted:o,currentLanguage:d,activeTab:a})}),me(()=>{o=!0,dr(Pt),mt(Pt,`Component mounted, initial language: ${r}`,{storeValue:r,activeTab:a}),d=r;try{l=qt.subscribe(b=>{h(b)}),mt(Pt,"Subscribed to language store")}catch(b){mt(Pt,"Error subscribing to language store",b)}It.loadItems()}),Cn(()=>{if(mt(Pt,"Component being destroyed",{isMounted:o,currentLanguage:d,hasUnsubscribe:!!l}),o=!1,je(Pt),l)try{l(),mt(Pt,"Unsubscribed from language store"),l=void 0}catch(b){mt(Pt,"Error unsubscribing from language store",b)}}),il(()=>{s++,mt(Pt,`Component updated (${s})`,{isMounted:o,currentLanguage:d,storeValue:r,activeTab:a})}),[a,i,u,b=>n(0,a=b.id),(b,T)=>T.key==="Enter"&&n(0,a=b.id)]}class mg extends Zt{constructor(e){super(),Gt(this,e,gg,pg,Xt,{})}}new mg({target:document.getElementById("app")});
