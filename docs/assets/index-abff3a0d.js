(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();function Ft(){}const dl=t=>t;function hl(t,e){for(const n in e)t[n]=e[n];return t}function na(t){return t()}function Si(){return Object.create(null)}function le(t){t.forEach(na)}function zr(t){return typeof t=="function"}function ce(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function pl(t){return Object.keys(t).length===0}function si(t,...e){if(t==null)return Ft;const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function gl(t){let e;return si(t,n=>e=n)(),e}function vt(t,e,n){t.$$.on_destroy.push(si(e,n))}function ra(t,e,n,r){if(t){const i=ia(t,e,n,r);return t[0](i)}}function ia(t,e,n,r){return t[1]&&r?hl(n.ctx.slice(),t[1](r(e))):n.ctx}function oa(t,e,n,r){if(t[2]&&r){const i=t[2](r(n));if(e.dirty===void 0)return i;if(typeof i=="object"){const o=[],a=Math.max(e.dirty.length,i.length);for(let l=0;l<a;l+=1)o[l]=e.dirty[l]|i[l];return o}return e.dirty|i}return e.dirty}function aa(t,e,n,r,i,o){if(i){const a=ia(e,n,r,o);t.p(a,i)}}function la(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let r=0;r<n;r++)e[r]=-1;return e}return-1}const sa=typeof window<"u";let ml=sa?()=>window.performance.now():()=>Date.now(),ui=sa?t=>requestAnimationFrame(t):Ft;const fn=new Set;function ua(t){fn.forEach(e=>{e.c(t)||(fn.delete(e),e.f())}),fn.size!==0&&ui(ua)}function yl(t){let e;return fn.size===0&&ui(ua),{promise:new Promise(n=>{fn.add(e={c:t,f:n})}),abort(){fn.delete(e)}}}function p(t,e){t.appendChild(e)}function ca(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function _l(t){const e=S("style");return vl(ca(t),e),e.sheet}function vl(t,e){return p(t.head||t,e),e.sheet}function Q(t,e,n){t.insertBefore(e,n||null)}function J(t){t.parentNode&&t.parentNode.removeChild(t)}function mn(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function S(t){return document.createElement(t)}function ne(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function H(t){return document.createTextNode(t)}function ht(){return H(" ")}function fa(){return H("")}function Qt(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function _(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function bl(t){return Array.from(t.childNodes)}function ot(t,e){e=""+e,t.data!==e&&(t.data=e)}function He(t,e,n){for(let r=0;r<t.options.length;r+=1){const i=t.options[r];if(i.__value===e){i.selected=!0;return}}(!n||e!==void 0)&&(t.selectedIndex=-1)}function Ni(t){const e=t.querySelector(":checked");return e&&e.__value}function Ue(t,e,n){t.classList[n?"add":"remove"](e)}function da(t,e,{bubbles:n=!1,cancelable:r=!1}={}){const i=document.createEvent("CustomEvent");return i.initCustomEvent(t,n,r,e),i}class wl{constructor(e=!1){this.is_svg=!1,this.is_svg=e,this.e=this.n=null}c(e){this.h(e)}m(e,n,r=null){this.e||(this.is_svg?this.e=ne(n.nodeName):this.e=S(n.nodeType===11?"TEMPLATE":n.nodeName),this.t=n.tagName!=="TEMPLATE"?n:n.content,this.c(e)),this.i(r)}h(e){this.e.innerHTML=e,this.n=Array.from(this.e.nodeName==="TEMPLATE"?this.e.content.childNodes:this.e.childNodes)}i(e){for(let n=0;n<this.n.length;n+=1)Q(this.t,this.n[n],e)}p(e){this.d(),this.h(e),this.i(this.a)}d(){this.n.forEach(J)}}const ar=new Map;let lr=0;function xl(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}function kl(t,e){const n={stylesheet:_l(e),rules:{}};return ar.set(t,n),n}function Di(t,e,n,r,i,o,a,l=0){const u=16.666/r;let s=`{
`;for(let v=0;v<=1;v+=u){const T=e+(n-e)*o(v);s+=v*100+`%{${a(T,1-T)}}
`}const c=s+`100% {${a(n,1-n)}}
}`,d=`__svelte_${xl(c)}_${l}`,f=ca(t),{stylesheet:h,rules:g}=ar.get(f)||kl(f,t);g[d]||(g[d]=!0,h.insertRule(`@keyframes ${d} ${c}`,h.cssRules.length));const y=t.style.animation||"";return t.style.animation=`${y?`${y}, `:""}${d} ${r}ms linear ${i}ms 1 both`,lr+=1,d}function Tl(t,e){const n=(t.style.animation||"").split(", "),r=n.filter(e?o=>o.indexOf(e)<0:o=>o.indexOf("__svelte")===-1),i=n.length-r.length;i&&(t.style.animation=r.join(", "),lr-=i,lr||Cl())}function Cl(){ui(()=>{lr||(ar.forEach(t=>{const{ownerNode:e}=t.stylesheet;e&&J(e)}),ar.clear())})}let Rn;function Fn(t){Rn=t}function kn(){if(!Rn)throw new Error("Function called outside component initialization");return Rn}function ha(t){kn().$$.before_update.push(t)}function Te(t){kn().$$.on_mount.push(t)}function pa(t){kn().$$.after_update.push(t)}function Bn(t){kn().$$.on_destroy.push(t)}function zl(){const t=kn();return(e,n,{cancelable:r=!1}={})=>{const i=t.$$.callbacks[e];if(i){const o=da(e,n,{cancelable:r});return i.slice().forEach(a=>{a.call(t,o)}),!o.defaultPrevented}return!0}}function Ml(t,e){return kn().$$.context.set(t,e),e}const rn=[],ke=[];let dn=[];const Vr=[],ga=Promise.resolve();let Xr=!1;function ma(){Xr||(Xr=!0,ga.then(ya))}function Ve(){return ma(),ga}function Xe(t){dn.push(t)}function Al(t){Vr.push(t)}const Er=new Set;let tn=0;function ya(){if(tn!==0)return;const t=Rn;do{try{for(;tn<rn.length;){const e=rn[tn];tn++,Fn(e),Sl(e.$$)}}catch(e){throw rn.length=0,tn=0,e}for(Fn(null),rn.length=0,tn=0;ke.length;)ke.pop()();for(let e=0;e<dn.length;e+=1){const n=dn[e];Er.has(n)||(Er.add(n),n())}dn.length=0}while(rn.length);for(;Vr.length;)Vr.pop()();Xr=!1,Er.clear(),Fn(t)}function Sl(t){if(t.fragment!==null){t.update(),le(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Xe)}}function Nl(t){const e=[],n=[];dn.forEach(r=>t.indexOf(r)===-1?e.push(r):n.push(r)),n.forEach(r=>r()),dn=e}let Cn;function Dl(){return Cn||(Cn=Promise.resolve(),Cn.then(()=>{Cn=null})),Cn}function Lr(t,e,n){t.dispatchEvent(da(`${e?"intro":"outro"}${n}`))}const tr=new Set;let Ae;function ci(){Ae={r:0,c:[],p:Ae}}function fi(){Ae.r||le(Ae.c),Ae=Ae.p}function Ot(t,e){t&&t.i&&(tr.delete(t),t.i(e))}function Yt(t,e,n,r){if(t&&t.o){if(tr.has(t))return;tr.add(t),Ae.c.push(()=>{tr.delete(t),r&&(n&&t.d(1),r())}),t.o(e)}else r&&r()}const $l={duration:0};function $i(t,e,n,r){const i={direction:"both"};let o=e(t,n,i),a=r?0:1,l=null,u=null,s=null;function c(){s&&Tl(t,s)}function d(h,g){const y=h.b-a;return g*=Math.abs(y),{a,b:h.b,d:y,duration:g,start:h.start,end:h.start+g,group:h.group}}function f(h){const{delay:g=0,duration:y=300,easing:v=dl,tick:T=Ft,css:D}=o||$l,M={start:ml()+g,b:h};h||(M.group=Ae,Ae.r+=1),l||u?u=M:(D&&(c(),s=Di(t,a,h,y,g,v,D)),h&&T(0,1),l=d(M,y),Xe(()=>Lr(t,h,"start")),yl(C=>{if(u&&C>u.start&&(l=d(u,y),u=null,Lr(t,l.b,"start"),D&&(c(),s=Di(t,a,l.b,l.duration,0,v,o.css))),l){if(C>=l.end)T(a=l.b,1-a),Lr(t,l.b,"end"),u||(l.b?c():--l.group.r||le(l.group.c)),l=null;else if(C>=l.start){const b=C-l.start;a=l.a+l.d*v(b/l.duration),T(a,1-a)}}return!!(l||u)}))}return{run(h){zr(o)?Dl().then(()=>{o=o(i),f(h)}):f(h)},end(){c(),l=u=null}}}function Ei(t,e){t.d(1),e.delete(t.key)}function Li(t,e,n,r,i,o,a,l,u,s,c,d){let f=t.length,h=o.length,g=f;const y={};for(;g--;)y[t[g].key]=g;const v=[],T=new Map,D=new Map,M=[];for(g=h;g--;){const k=d(i,o,g),L=n(k);let z=a.get(L);z?r&&M.push(()=>z.p(k,e)):(z=s(L,k),z.c()),T.set(L,v[g]=z),L in y&&D.set(L,Math.abs(g-y[L]))}const C=new Set,b=new Set;function A(k){Ot(k,1),k.m(l,c),a.set(k.key,k),c=k.first,h--}for(;f&&h;){const k=v[h-1],L=t[f-1],z=k.key,m=L.key;k===L?(c=k.first,f--,h--):T.has(m)?!a.has(z)||C.has(z)?A(k):b.has(m)?f--:D.get(z)>D.get(m)?(b.add(z),A(k)):(C.add(m),f--):(u(L,a),f--)}for(;f--;){const k=t[f];T.has(k.key)||u(k,a)}for(;h;)A(v[h-1]);return le(M),v}function El(t,e,n){const r=t.$$.props[e];r!==void 0&&(t.$$.bound[r]=n,n(t.$$.ctx[r]))}function te(t){t&&t.c()}function Gt(t,e,n,r){const{fragment:i,after_update:o}=t.$$;i&&i.m(e,n),r||Xe(()=>{const a=t.$$.on_mount.map(na).filter(zr);t.$$.on_destroy?t.$$.on_destroy.push(...a):le(a),t.$$.on_mount=[]}),o.forEach(Xe)}function jt(t,e){const n=t.$$;n.fragment!==null&&(Nl(n.after_update),le(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Ll(t,e){t.$$.dirty[0]===-1&&(rn.push(t),ma(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function he(t,e,n,r,i,o,a,l=[-1]){const u=Rn;Fn(t);const s=t.$$={fragment:null,ctx:[],props:o,update:Ft,not_equal:i,bound:Si(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(u?u.$$.context:[])),callbacks:Si(),dirty:l,skip_bound:!1,root:e.target||u.$$.root};a&&a(s.root);let c=!1;if(s.ctx=n?n(t,e.props||{},(d,f,...h)=>{const g=h.length?h[0]:f;return s.ctx&&i(s.ctx[d],s.ctx[d]=g)&&(!s.skip_bound&&s.bound[d]&&s.bound[d](g),c&&Ll(t,d)),f}):[],s.update(),c=!0,le(s.before_update),s.fragment=r?r(s.ctx):!1,e.target){if(e.hydrate){const d=bl(e.target);s.fragment&&s.fragment.l(d),d.forEach(J)}else s.fragment&&s.fragment.c();e.intro&&Ot(t.$$.fragment),Gt(t,e.target,e.anchor,e.customElement),ya()}Fn(u)}class pe{$destroy(){jt(this,1),this.$destroy=Ft}$on(e,n){if(!zr(n))return Ft;const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(n),()=>{const i=r.indexOf(n);i!==-1&&r.splice(i,1)}}$set(e){this.$$set&&!pl(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const en=[];function Il(t,e){return{subscribe:di(t,e).subscribe}}function di(t,e=Ft){let n;const r=new Set;function i(l){if(ce(t,l)&&(t=l,n)){const u=!en.length;for(const s of r)s[1](),en.push(s,t);if(u){for(let s=0;s<en.length;s+=2)en[s][0](en[s+1]);en.length=0}}}function o(l){i(l(t))}function a(l,u=Ft){const s=[l,u];return r.add(s),r.size===1&&(n=e(i)||Ft),l(t),()=>{r.delete(s),r.size===0&&n&&(n(),n=null)}}return{set:i,update:o,subscribe:a}}function Fl(t,e,n){const r=!Array.isArray(t),i=r?[t]:t,o=e.length<2;return Il(n,a=>{let l=!1;const u=[];let s=0,c=Ft;const d=()=>{if(s)return;c();const h=e(r?u[0]:u,a);o?a(h):c=zr(h)?h:Ft},f=i.map((h,g)=>si(h,y=>{u[g]=y,s&=~(1<<g),l&&d()},()=>{s|=1<<g}));return l=!0,d(),function(){le(f),c(),l=!1}})}const Rl=()=>{const{subscribe:t,set:e,update:n}=di({items:[],loading:!1,error:null});return{subscribe:t,loadItems:async()=>{n(r=>({...r,loading:!0,error:null}));try{const o=await(await fetch("/IWAC-overview/items.json")).json();e({items:o,loading:!1,error:null})}catch(r){n(i=>({...i,loading:!1,error:r instanceof Error?r.message:"Failed to load items"}))}}}},Kt=Rl(),_a={en:{"app.title":"<i>Islam West Africa Collection</i> Overview","tab.countries":"Country distribution","tab.languages":"Languages","tab.timeline":"Database growth","tab.types":"Type distribution","tab.categories":"Index","tab.words":"Word count","ui.loading":"Loading database...","ui.select_visualization":"Select a visualization from the tabs above","ui.toggle_language":"Changer en français","ui.show_description":"Show description","ui.hide_description":"Hide description","ui.no_visualization_content":"No visualization content available","ui.enter_fullscreen":"Enter fullscreen mode","ui.exit_fullscreen":"Exit fullscreen mode","viz.summary":"Summary","viz.total_items":"Total items","viz.number_of_categories":"Number of categories","viz.top_categories":"Top Categories","viz.filter_by_country":"Filter by Country","viz.filter_by_type":"Filter by Type","viz.showing_items":"Showing {0} items in {1} languages","viz.all_countries":"All Countries","viz.all_types":"All Types","viz.no_data":"No data available with the current filters","viz.distribution_items":"Distribution of {0} items by country and sub-collection","viz.language_distribution_title":"Language Distribution","viz.language_distribution_items":"Distribution of {0} items by language","viz.language_distribution_description":"This visualization shows the distribution of items by language. You can filter by country and item type to explore the language distribution across different segments of the collection.","viz.timeline_distribution_title":"Timeline Distribution","viz.timeline_distribution_items":"Growth timeline of {0} items over time","viz.timeline_distribution_description":"This visualization shows the growth of the database over time. The blue line represents monthly additions, while the green dotted line shows the cumulative total. You can filter by country and item type to explore growth patterns across different segments of the collection.","viz.time_period":"Time period","viz.avg_monthly_additions":"Average monthly additions","viz.peak_growth_months":"Peak Growth Months","viz.showing_items_over_months":"Showing {0} items over {1} months","viz.months":"months","viz.monthly_additions":"Monthly Additions","viz.month":"Month","viz.publication_year":"Publication Year","viz.year":"Year","viz.number_of_items":"Number of Items","viz.toggle_types":"Toggle Types","viz.toggled_type":"Toggled type: {0}","viz.languages":"Languages","viz.country_distribution_title":"Country Distribution","viz.country_distribution_description":"This visualization shows the distribution of items by country and sub-collection. You can click on any country block to zoom in and see its sub-collections. The size of each block represents the number of items in that country or sub-collection.","viz.country.items":"Items","viz.country.percent_parent":"% of Parent","viz.country.percent_total":"% of Total","viz.country.click_zoom_in":"Click to zoom in","viz.country.click_zoom_out":"Click to zoom out","viz.country.unknown":"Unknown","viz.country.no_set":"No Set","viz.countries":"Countries","viz.sub_collections":"Sub-collections","viz.currently_viewing":"Currently viewing","viz.click_back_to_return":'Click the "Back to All" button to return to the full view',"viz.click_zoom_in":"Click on a country block to zoom in","viz.unknown":"Unknown","viz.no_set":"No Set","viz.word_distribution":"Word Distribution","viz.total_words":"Total Words","viz.avg_words_per_item":"Average words per Item","viz.back_to_all":"← Back to All","viz.total_items_with_word_count":"Total items with word count","viz.word_distribution_subtitle":"Word Distribution by Country and Item Set ({0} items, {1} words)","viz.word_distribution_description":"This visualization shows the distribution of words across items by country and collection. The size of each block represents the word count in that country or collection.","viz.words":"words","viz.items":"items","viz.percent_of_country":"% of country","viz.percent_of_total":"% of total","viz.item_set_summary":"Item Set Summary","lang.Français":"French","lang.Anglais":"English","lang.Haoussa":"Hausa","lang.Allemand":"German","lang.Arabe":"Arabic","lang.Italien":"Italian","lang.Dendi":"Dendi","lang.Slovène":"Slovenian","lang.Espagnol":"Spanish","country.all":"All Countries","country.Bénin":"Benin","country.Nigéria":"Nigeria","country.Côte d'Ivoire":"Côte d'Ivoire","country.Burkina Faso":"Burkina Faso","country.Togo":"Togo","country.Niger":"Niger","country.Unknown":"Unknown","type.Article de presse":"Press Article","type.Notice d'autorité":"Authority Record","type.Périodique islamique":"Islamic Periodical","type.Unknown":"Unknown","type.Article de revue":"Journal Article","type.Document":"Document","type.Article de blog":"Blog Post","type.Chapitre de livre":"Book Chapter","type.Livre":"Book","type.Thèse de doctorat":"Doctoral Thesis","type.Communication scientifique":"Scientific Communication","type.all":"All Types","viz.index_distribution_title":"Index Distribution","viz.index_distribution_items":"Distribution of {0} index items by category","viz.index_distribution_description":"This visualization shows the distribution of index items by category. The size of each bar represents the number of items in that category. Index items are authority records that serve as reference points in the database.","viz.categories":"Categories","viz.uncategorized":"Uncategorized","viz.type_distribution_title":"Type Distribution","viz.type_distribution_items":"Distribution of {0} items by type","viz.type_distribution_description":"This visualization shows the distribution of items by type over time. You can filter by country and year range to explore how different types of items have been published over time.","viz.types":"Types","viz.published_between":"published between {0} and {1}","category.Events":"Events","category.Locations":"Locations","category.Organizations":"Organizations","category.Persons":"Persons","category.Topics":"Topics"},fr:{"app.title":"Aperçu de la <i>Collection Islam Afrique de l'Ouest</i>","tab.countries":"Répartition par pays","tab.languages":"Langues","tab.timeline":"Croissance base de données","tab.types":"Répartition par type","tab.categories":"Index","tab.words":"Nombre de mots","ui.loading":"Chargement de la base de données...","ui.select_visualization":"Sélectionnez une visualisation dans les onglets ci-dessus","ui.toggle_language":"Switch to English","ui.show_description":"Afficher la description","ui.hide_description":"Masquer la description","ui.no_visualization_content":"Aucun contenu de visualisation disponible","ui.enter_fullscreen":"Passer en mode plein écran","ui.exit_fullscreen":"Quitter le mode plein écran","viz.summary":"Résumé","viz.total_items":"Nombre total d'éléments","viz.number_of_categories":"Nombre de catégories","viz.top_categories":"Principales catégories","viz.filter_by_country":"Filtrer par pays","viz.filter_by_type":"Filtrer par type","viz.showing_items":"Affichage de {0} éléments dans {1} langues","viz.all_countries":"Tous les pays","viz.all_types":"Tous les types","viz.no_data":"Aucune donnée disponible avec les filtres actuels","viz.distribution_items":"Répartition de {0} éléments par pays et sous-collection","viz.language_distribution_title":"Répartition par langue","viz.language_distribution_items":"Répartition de {0} éléments par langue","viz.language_distribution_description":"Cette visualisation montre la répartition des éléments par langue. Vous pouvez filtrer par pays et par type d'élément pour explorer la répartition des langues dans différents segments de la collection.","viz.timeline_distribution_title":"Chronologie","viz.timeline_distribution_items":"Chronologie de croissance de {0} éléments au fil du temps","viz.timeline_distribution_description":"Cette visualisation montre la croissance de la base de données au fil du temps. La ligne bleue représente les ajouts mensuels, tandis que la ligne pointillée verte montre le total cumulatif. Vous pouvez filtrer par pays et par type d'élément pour explorer les modèles de croissance dans différents segments de la collection.","viz.time_period":"Période","viz.avg_monthly_additions":"Ajouts mensuels moyens","viz.peak_growth_months":"Mois de croissance maximale","viz.showing_items_over_months":"Affichage de {0} éléments sur {1} mois","viz.months":"mois","viz.monthly_additions":"Ajouts mensuels","viz.month":"Mois","viz.publication_year":"Année de publication","viz.year":"Année","viz.number_of_items":"Nombre d'éléments","viz.toggle_types":"Basculer les types","viz.toggled_type":"Type basculé : {0}","viz.languages":"Langues","viz.country_distribution_title":"Répartition par pays","viz.country_distribution_description":"Cette visualisation montre la répartition des éléments par pays et sous-collection. Vous pouvez cliquer sur n'importe quel bloc pays pour zoomer et voir ses sous-collections. La taille de chaque bloc représente le nombre d'éléments dans ce pays ou cette sous-collection.","viz.country.items":"Éléments","viz.country.percent_parent":"% du parent","viz.country.percent_total":"% du total","viz.country.click_zoom_in":"Cliquer pour zoomer","viz.country.click_zoom_out":"Cliquer pour dézoomer","viz.country.unknown":"Inconnu","viz.country.no_set":"Sans ensemble","viz.countries":"Pays","viz.sub_collections":"Sous-collections","viz.currently_viewing":"Affichage actuel","viz.click_back_to_return":'Cliquez sur le bouton "Retour à tous" pour revenir à la vue complète',"viz.click_zoom_in":"Cliquez sur un bloc pays pour zoomer","viz.unknown":"Inconnu","viz.no_set":"Sans ensemble","viz.word_distribution":"Répartition des mots","viz.total_words":"Nombre total de mots","viz.avg_words_per_item":"Moyenne de mots par élément","viz.back_to_all":"← Retour à tous","viz.total_items_with_word_count":"Total des éléments avec nombre de mots","viz.word_distribution_subtitle":"Répartition des mots par pays et ensemble d'éléments ({0} éléments, {1} mots)","viz.word_distribution_description":"Cette visualisation montre la répartition des mots dans les éléments par pays et collection. La taille de chaque bloc représente le nombre de mots dans ce pays ou cette collection.","viz.words":"mots","viz.items":"éléments","viz.percent_of_country":"% du pays","viz.percent_of_total":"% du total","viz.item_set_summary":"Résumé de l'ensemble d'éléments","lang.Français":"Français","lang.Anglais":"Anglais","lang.Haoussa":"Haoussa","lang.Allemand":"Allemand","lang.Arabe":"Arabe","lang.Italien":"Italien","lang.Dendi":"Dendi","lang.Slovène":"Slovène","lang.Espagnol":"Espagnol","country.all":"Tous les pays","country.Bénin":"Bénin","country.Nigéria":"Nigéria","country.Côte d'Ivoire":"Côte d'Ivoire","country.Burkina Faso":"Burkina Faso","country.Togo":"Togo","country.Niger":"Niger","country.Unknown":"Inconnu","type.Article de presse":"Article de presse","type.Notice d'autorité":"Notice d'autorité","type.Périodique islamique":"Périodique islamique","type.Unknown":"Inconnu","type.Article de revue":"Article de revue","type.Document":"Document","type.Article de blog":"Article de blog","type.Chapitre de livre":"Chapitre de livre","type.Livre":"Livre","type.Thèse de doctorat":"Thèse de doctorat","type.Communication scientifique":"Communication scientifique","type.all":"Tous les types","viz.index_distribution_title":"Répartition des index","viz.index_distribution_items":"Répartition de {0} éléments d'index par catégorie","viz.index_distribution_description":"Cette visualisation montre la répartition des éléments d'index par catégorie. La taille de chaque barre représente le nombre d'éléments dans cette catégorie. Les éléments d'index sont des notices d'autorité qui servent de points de référence dans la base de données.","viz.categories":"Catégories","viz.uncategorized":"Non catégorisé","viz.type_distribution_title":"Répartition par type","viz.type_distribution_items":"Répartition de {0} éléments par type","viz.type_distribution_description":"Cette visualisation montre la répartition des éléments par type au fil du temps. Vous pouvez filtrer par pays et par plage d'années pour explorer comment différents types d'éléments ont été publiés au fil du temps.","viz.types":"Types","viz.published_between":"publiés entre {0} et {1}","category.Events":"Événements","category.Locations":"Lieux","category.Organizations":"Organisations","category.Persons":"Personnes","category.Topics":"Sujets"}};function Hl(){const{subscribe:t,set:e,update:n}=di("en");return{subscribe:t,setLanguage:r=>{console.log("[TranslationStore] Setting language to:",r),e(r)},toggleLanguage:()=>n(r=>{const i=r==="en"?"fr":"en";return console.log("[TranslationStore] Toggling language from",r,"to",i),i})}}const Zt=Hl();function va(t,e=[]){console.log("[TranslationStore] Processing translation:",{text:t,replacements:e});const n=t.replace(/{(\d+)}/g,(r,i)=>{const o=parseInt(i);return o<e.length?e[o]:r});return console.log("[TranslationStore] Processed result:",n),n}function it(t,e=[]){var i;const n=gl(Zt);console.log("[TranslationStore] t() translation lookup:",{key:t,currentLang:n,replacements:e});const r=((i=_a[n])==null?void 0:i[t])||t;return va(r,e)}function lt(t,e=[]){return console.log("[TranslationStore] Creating reactive translation for key:",t),Fl(Zt,n=>{var i;console.log("[TranslationStore] Reactive translation update:",{key:t,language:n});const r=((i=_a[n])==null?void 0:i[t])||t;return va(r,e)})}function Ul(t){let e,n,r,i;return{c(){e=S("button"),n=H(t[0]),_(e,"class","language-toggle svelte-u9ii1h")},m(o,a){Q(o,e,a),p(e,n),r||(i=Qt(e,"click",t[2]),r=!0)},p(o,[a]){a&1&&ot(n,o[0])},i:Ft,o:Ft,d(o){o&&J(e),r=!1,i()}}}function Ol(t,e,n){let r,i;vt(t,Zt,l=>n(3,i=l));const o=lt("ui.toggle_language");vt(t,o,l=>n(0,r=l));function a(){console.log("[LanguageToggle] Button clicked, current language:",i),Zt.toggleLanguage(),console.log("[LanguageToggle] Toggle text is:",r)}return[r,o,a]}class Pl extends pe{constructor(e){super(),he(this,e,Ol,Ul,ce,{})}}function Yl(t){let e,n,r,i,o;return{c(){e=ne("svg"),n=ne("path"),r=ne("path"),i=ne("path"),o=ne("path"),_(n,"d","M8 3H5a2 2 0 0 0-2 2v3"),_(r,"d","M21 8V5a2 2 0 0 0-2-2h-3"),_(i,"d","M3 16v3a2 2 0 0 0 2 2h3"),_(o,"d","M16 21h3a2 2 0 0 0 2-2v-3"),_(e,"xmlns","http://www.w3.org/2000/svg"),_(e,"width","16"),_(e,"height","16"),_(e,"viewBox","0 0 24 24"),_(e,"fill","none"),_(e,"stroke","currentColor"),_(e,"stroke-width","2"),_(e,"stroke-linecap","round"),_(e,"stroke-linejoin","round"),_(e,"class","svelte-ov1obo")},m(a,l){Q(a,e,l),p(e,n),p(e,r),p(e,i),p(e,o)},d(a){a&&J(e)}}}function Wl(t){let e,n,r,i,o;return{c(){e=ne("svg"),n=ne("path"),r=ne("path"),i=ne("path"),o=ne("path"),_(n,"d","M8 3v3a2 2 0 0 1-2 2H3"),_(r,"d","M21 8h-3a2 2 0 0 1-2-2V3"),_(i,"d","M3 16h3a2 2 0 0 1 2 2v3"),_(o,"d","M16 21v-3a2 2 0 0 1 2-2h3"),_(e,"xmlns","http://www.w3.org/2000/svg"),_(e,"width","16"),_(e,"height","16"),_(e,"viewBox","0 0 24 24"),_(e,"fill","none"),_(e,"stroke","currentColor"),_(e,"stroke-width","2"),_(e,"stroke-linecap","round"),_(e,"stroke-linejoin","round"),_(e,"class","svelte-ov1obo")},m(a,l){Q(a,e,l),p(e,n),p(e,r),p(e,i),p(e,o)},d(a){a&&J(e)}}}function Bl(t){let e,n,r,i;function o(u,s){return u[0]?Wl:Yl}let a=o(t),l=a(t);return{c(){e=S("button"),l.c(),_(e,"class","fullscreen-toggle svelte-ov1obo"),_(e,"title",n=t[0]?it("ui.exit_fullscreen"):it("ui.enter_fullscreen"))},m(u,s){Q(u,e,s),l.m(e,null),r||(i=Qt(e,"click",ql),r=!0)},p(u,[s]){a!==(a=o(u))&&(l.d(1),l=a(u),l&&(l.c(),l.m(e,null))),s&1&&n!==(n=u[0]?it("ui.exit_fullscreen"):it("ui.enter_fullscreen"))&&_(e,"title",n)},i:Ft,o:Ft,d(u){u&&J(e),l.d(),r=!1,i()}}}function ql(){document.fullscreenElement?document.exitFullscreen&&document.exitFullscreen():document.documentElement.requestFullscreen().catch(t=>{console.error(`Error attempting to enable fullscreen: ${t.message}`),Vl()&&console.warn('This application is in an iframe. Make sure the iframe has the "allowfullscreen" attribute.')})}function Vl(){try{return window.self!==window.top}catch{return!0}}function Xl(t,e,n){let r=!1;function i(){n(0,r=!!document.fullscreenElement)}return Te(()=>(document.addEventListener("fullscreenchange",i),()=>{document.removeEventListener("fullscreenchange",i)})),[r]}class Kl extends pe{constructor(e){super(),he(this,e,Xl,Bl,ce,{})}}const Zl=!1,hn=[],Gl=1e3;function jl(){return new Date().toISOString()}function zt(t,e,n){const i={timestamp:jl(),component:t,action:e,details:n};hn.push(i),hn.length>Gl&&hn.shift()}const Jl=new Set,Ql={};function ba(){console.group("IWAC Debug Logs"),hn.forEach(t=>{console.groupCollapsed(`${t.timestamp} - ${t.component} - ${t.action}`),console.log("Component:",t.component),console.log("Action:",t.action),t.details&&console.log("Details:",t.details),console.groupEnd()}),console.groupEnd()}function wa(){return JSON.stringify(hn,null,2)}typeof window<"u"&&(window.__IWAC_DEBUG={logs:hn,dumpLogs:ba,exportLogs:wa,mountedComponents:()=>Array.from(Jl),hierarchy:Ql});function ts(t){let e;const n=t[1].default,r=ra(n,t,t[0],null);return{c(){r&&r.c()},m(i,o){r&&r.m(i,o),e=!0},p(i,[o]){r&&r.p&&(!e||o&1)&&aa(r,n,i,i[0],e?oa(n,i[0],o,null):la(i[0]),null)},i(i){e||(Ot(r,i),e=!0)},o(i){Yt(r,i),e=!1},d(i){r&&r.d(i)}}}const ge="TranslationContext";function es(t,e,n){let r;vt(t,Zt,f=>n(7,r=f));let{$$slots:i={},$$scope:o}=e,a=!1,l=()=>{},u=0,s=r,c="en";Ml("translationContext",{componentId:ge,getLanguage:()=>s});function d(f){if(!a){zt(ge,`Language change ignored (not mounted): ${f}`);return}c=s,s=f,zt(ge,`Language changed from ${c} to ${f}`,{isMounted:a,updateCount:u,subscriptionActive:!!l})}return ha(()=>{zt(ge,"Before update",{isMounted:a,currentLanguage:s,updateCount:u})}),Te(()=>{try{a=!0,zt(ge,`Component mounted, initial language: ${r}`,{storeValue:r,currentLanguage:s});try{l=Zt.subscribe(h=>{d(h)}),zt(ge,"Successfully subscribed to language store")}catch(f){zt(ge,`Error subscribing to language store: ${f}`)}typeof window<"u"&&(window.__TRANSLATION_DEBUG={dumpLogs:ba,exportLogs:wa,currentLanguage:()=>s,isMounted:()=>a})}catch(f){console.error("[TranslationContext] Error in onMount:",f)}}),Bn(()=>{try{l&&l(),a=!1,zt(ge,"Component unmounted")}catch(f){console.error("[TranslationContext] Error in onDestroy:",f)}}),pa(()=>{u++,zt(ge,`Component updated (${u})`,{isMounted:a,currentLanguage:s,storeValue:r})}),t.$$set=f=>{"$$scope"in f&&n(0,o=f.$$scope)},[o,i]}class ns extends pe{constructor(e){super(),he(this,e,es,ts,ce,{})}}function er(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function rs(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function hi(t){let e,n,r;t.length!==2?(e=er,n=(l,u)=>er(t(l),u),r=(l,u)=>t(l)-u):(e=t===er||t===rs?t:is,n=t,r=t);function i(l,u,s=0,c=l.length){if(s<c){if(e(u,u)!==0)return c;do{const d=s+c>>>1;n(l[d],u)<0?s=d+1:c=d}while(s<c)}return s}function o(l,u,s=0,c=l.length){if(s<c){if(e(u,u)!==0)return c;do{const d=s+c>>>1;n(l[d],u)<=0?s=d+1:c=d}while(s<c)}return s}function a(l,u,s=0,c=l.length){const d=i(l,u,s,c-1);return d>s&&r(l[d-1],u)>-r(l[d],u)?d-1:d}return{left:i,center:a,right:o}}function is(){return 0}function os(t){return t===null?NaN:+t}const as=hi(er),ls=as.right;hi(os).center;const ss=ls;function us(t,e){let n,r;if(e===void 0)for(const i of t)i!=null&&(n===void 0?i>=i&&(n=r=i):(n>i&&(n=i),r<i&&(r=i)));else{let i=-1;for(let o of t)(o=e(o,++i,t))!=null&&(n===void 0?o>=o&&(n=r=o):(n>o&&(n=o),r<o&&(r=o)))}return[n,r]}class Kr extends Map{constructor(e,n=ds){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),e!=null)for(const[r,i]of e)this.set(r,i)}get(e){return super.get(Ii(this,e))}has(e){return super.has(Ii(this,e))}set(e,n){return super.set(cs(this,e),n)}delete(e){return super.delete(fs(this,e))}}function Ii({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):n}function cs({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):(t.set(r,n),n)}function fs({_intern:t,_key:e},n){const r=e(n);return t.has(r)&&(n=t.get(r),t.delete(r)),n}function ds(t){return t!==null&&typeof t=="object"?t.valueOf():t}function Zr(t){return t}function pn(t,...e){return xa(t,Zr,Zr,e)}function Be(t,e,...n){return xa(t,Zr,e,n)}function xa(t,e,n,r){return function i(o,a){if(a>=r.length)return n(o);const l=new Kr,u=r[a++];let s=-1;for(const c of o){const d=u(c,++s,o),f=l.get(d);f?f.push(c):l.set(d,[c])}for(const[c,d]of l)l.set(c,i(d,a));return e(l)}(t,0)}const hs=Math.sqrt(50),ps=Math.sqrt(10),gs=Math.sqrt(2);function sr(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),o=r/Math.pow(10,i),a=o>=hs?10:o>=ps?5:o>=gs?2:1;let l,u,s;return i<0?(s=Math.pow(10,-i)/a,l=Math.round(t*s),u=Math.round(e*s),l/s<t&&++l,u/s>e&&--u,s=-s):(s=Math.pow(10,i)*a,l=Math.round(t/s),u=Math.round(e/s),l*s<t&&++l,u*s>e&&--u),u<l&&.5<=n&&n<2?sr(t,e,n*2):[l,u,s]}function ms(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const r=e<t,[i,o,a]=r?sr(e,t,n):sr(t,e,n);if(!(o>=i))return[];const l=o-i+1,u=new Array(l);if(r)if(a<0)for(let s=0;s<l;++s)u[s]=(o-s)/-a;else for(let s=0;s<l;++s)u[s]=(o-s)*a;else if(a<0)for(let s=0;s<l;++s)u[s]=(i+s)/-a;else for(let s=0;s<l;++s)u[s]=(i+s)*a;return u}function Gr(t,e,n){return e=+e,t=+t,n=+n,sr(t,e,n)[2]}function jr(t,e,n){e=+e,t=+t,n=+n;const r=e<t,i=r?Gr(e,t,n):Gr(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}function on(t,e){let n;if(e===void 0)for(const r of t)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of t)(i=e(i,++r,t))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function ys(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((e-t)/n))|0,o=new Array(i);++r<i;)o[r]=t+r*n;return o}function _s(t){return t}var Ir=1,Fr=2,Jr=3,$n=4,Fi=1e-6;function vs(t){return"translate("+t+",0)"}function bs(t){return"translate(0,"+t+")"}function ws(t){return e=>+t(e)}function xs(t,e){return e=Math.max(0,t.bandwidth()-e*2)/2,t.round()&&(e=Math.round(e)),n=>+t(n)+e}function ks(){return!this.__axis}function ka(t,e){var n=[],r=null,i=null,o=6,a=6,l=3,u=typeof window<"u"&&window.devicePixelRatio>1?0:.5,s=t===Ir||t===$n?-1:1,c=t===$n||t===Fr?"x":"y",d=t===Ir||t===Jr?vs:bs;function f(h){var g=r??(e.ticks?e.ticks.apply(e,n):e.domain()),y=i??(e.tickFormat?e.tickFormat.apply(e,n):_s),v=Math.max(o,0)+l,T=e.range(),D=+T[0]+u,M=+T[T.length-1]+u,C=(e.bandwidth?xs:ws)(e.copy(),u),b=h.selection?h.selection():h,A=b.selectAll(".domain").data([null]),k=b.selectAll(".tick").data(g,e).order(),L=k.exit(),z=k.enter().append("g").attr("class","tick"),m=k.select("line"),N=k.select("text");A=A.merge(A.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),k=k.merge(z),m=m.merge(z.append("line").attr("stroke","currentColor").attr(c+"2",s*o)),N=N.merge(z.append("text").attr("fill","currentColor").attr(c,s*v).attr("dy",t===Ir?"0em":t===Jr?"0.71em":"0.32em")),h!==b&&(A=A.transition(h),k=k.transition(h),m=m.transition(h),N=N.transition(h),L=L.transition(h).attr("opacity",Fi).attr("transform",function(R){return isFinite(R=C(R))?d(R+u):this.getAttribute("transform")}),z.attr("opacity",Fi).attr("transform",function(R){var E=this.parentNode.__axis;return d((E&&isFinite(E=E(R))?E:C(R))+u)})),L.remove(),A.attr("d",t===$n||t===Fr?a?"M"+s*a+","+D+"H"+u+"V"+M+"H"+s*a:"M"+u+","+D+"V"+M:a?"M"+D+","+s*a+"V"+u+"H"+M+"V"+s*a:"M"+D+","+u+"H"+M),k.attr("opacity",1).attr("transform",function(R){return d(C(R)+u)}),m.attr(c+"2",s*o),N.attr(c,s*v).text(y),b.filter(ks).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===Fr?"start":t===$n?"end":"middle"),b.each(function(){this.__axis=C})}return f.scale=function(h){return arguments.length?(e=h,f):e},f.ticks=function(){return n=Array.from(arguments),f},f.tickArguments=function(h){return arguments.length?(n=h==null?[]:Array.from(h),f):n.slice()},f.tickValues=function(h){return arguments.length?(r=h==null?null:Array.from(h),f):r&&r.slice()},f.tickFormat=function(h){return arguments.length?(i=h,f):i},f.tickSize=function(h){return arguments.length?(o=a=+h,f):o},f.tickSizeInner=function(h){return arguments.length?(o=+h,f):o},f.tickSizeOuter=function(h){return arguments.length?(a=+h,f):a},f.tickPadding=function(h){return arguments.length?(l=+h,f):l},f.offset=function(h){return arguments.length?(u=+h,f):u},f}function ur(t){return ka(Jr,t)}function cr(t){return ka($n,t)}var Ts={value:()=>{}};function Ta(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new nr(n)}function nr(t){this._=t}function Cs(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}nr.prototype=Ta.prototype={constructor:nr,on:function(t,e){var n=this._,r=Cs(t+"",n),i,o=-1,a=r.length;if(arguments.length<2){for(;++o<a;)if((i=(t=r[o]).type)&&(i=zs(n[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++o<a;)if(i=(t=r[o]).type)n[i]=Ri(n[i],t.name,e);else if(e==null)for(i in n)n[i]=Ri(n[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new nr(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,o;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=this._[t],r=0,i=o.length;r<i;++r)o[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(e,n)}};function zs(t,e){for(var n=0,r=t.length,i;n<r;++n)if((i=t[n]).name===e)return i.value}function Ri(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=Ts,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var Qr="http://www.w3.org/1999/xhtml";const Hi={svg:"http://www.w3.org/2000/svg",xhtml:Qr,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Mr(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),Hi.hasOwnProperty(e)?{space:Hi[e],local:t}:t}function Ms(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Qr&&e.documentElement.namespaceURI===Qr?e.createElement(t):e.createElementNS(n,t)}}function As(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Ca(t){var e=Mr(t);return(e.local?As:Ms)(e)}function Ss(){}function pi(t){return t==null?Ss:function(){return this.querySelector(t)}}function Ns(t){typeof t!="function"&&(t=pi(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o=e[i],a=o.length,l=r[i]=new Array(a),u,s,c=0;c<a;++c)(u=o[c])&&(s=t.call(u,u.__data__,c,o))&&("__data__"in u&&(s.__data__=u.__data__),l[c]=s);return new ue(r,this._parents)}function Ds(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function $s(){return[]}function za(t){return t==null?$s:function(){return this.querySelectorAll(t)}}function Es(t){return function(){return Ds(t.apply(this,arguments))}}function Ls(t){typeof t=="function"?t=Es(t):t=za(t);for(var e=this._groups,n=e.length,r=[],i=[],o=0;o<n;++o)for(var a=e[o],l=a.length,u,s=0;s<l;++s)(u=a[s])&&(r.push(t.call(u,u.__data__,s,a)),i.push(u));return new ue(r,i)}function Ma(t){return function(){return this.matches(t)}}function Aa(t){return function(e){return e.matches(t)}}var Is=Array.prototype.find;function Fs(t){return function(){return Is.call(this.children,t)}}function Rs(){return this.firstElementChild}function Hs(t){return this.select(t==null?Rs:Fs(typeof t=="function"?t:Aa(t)))}var Us=Array.prototype.filter;function Os(){return Array.from(this.children)}function Ps(t){return function(){return Us.call(this.children,t)}}function Ys(t){return this.selectAll(t==null?Os:Ps(typeof t=="function"?t:Aa(t)))}function Ws(t){typeof t!="function"&&(t=Ma(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o=e[i],a=o.length,l=r[i]=[],u,s=0;s<a;++s)(u=o[s])&&t.call(u,u.__data__,s,o)&&l.push(u);return new ue(r,this._parents)}function Sa(t){return new Array(t.length)}function Bs(){return new ue(this._enter||this._groups.map(Sa),this._parents)}function fr(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}fr.prototype={constructor:fr,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function qs(t){return function(){return t}}function Vs(t,e,n,r,i,o){for(var a=0,l,u=e.length,s=o.length;a<s;++a)(l=e[a])?(l.__data__=o[a],r[a]=l):n[a]=new fr(t,o[a]);for(;a<u;++a)(l=e[a])&&(i[a]=l)}function Xs(t,e,n,r,i,o,a){var l,u,s=new Map,c=e.length,d=o.length,f=new Array(c),h;for(l=0;l<c;++l)(u=e[l])&&(f[l]=h=a.call(u,u.__data__,l,e)+"",s.has(h)?i[l]=u:s.set(h,u));for(l=0;l<d;++l)h=a.call(t,o[l],l,o)+"",(u=s.get(h))?(r[l]=u,u.__data__=o[l],s.delete(h)):n[l]=new fr(t,o[l]);for(l=0;l<c;++l)(u=e[l])&&s.get(f[l])===u&&(i[l]=u)}function Ks(t){return t.__data__}function Zs(t,e){if(!arguments.length)return Array.from(this,Ks);var n=e?Xs:Vs,r=this._parents,i=this._groups;typeof t!="function"&&(t=qs(t));for(var o=i.length,a=new Array(o),l=new Array(o),u=new Array(o),s=0;s<o;++s){var c=r[s],d=i[s],f=d.length,h=Gs(t.call(c,c&&c.__data__,s,r)),g=h.length,y=l[s]=new Array(g),v=a[s]=new Array(g),T=u[s]=new Array(f);n(c,d,y,v,T,h,e);for(var D=0,M=0,C,b;D<g;++D)if(C=y[D]){for(D>=M&&(M=D+1);!(b=v[M])&&++M<g;);C._next=b||null}}return a=new ue(a,r),a._enter=l,a._exit=u,a}function Gs(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function js(){return new ue(this._exit||this._groups.map(Sa),this._parents)}function Js(t,e,n){var r=this.enter(),i=this,o=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),e!=null&&(i=e(i),i&&(i=i.selection())),n==null?o.remove():n(o),r&&i?r.merge(i).order():i}function Qs(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,o=r.length,a=Math.min(i,o),l=new Array(i),u=0;u<a;++u)for(var s=n[u],c=r[u],d=s.length,f=l[u]=new Array(d),h,g=0;g<d;++g)(h=s[g]||c[g])&&(f[g]=h);for(;u<i;++u)l[u]=n[u];return new ue(l,this._parents)}function tu(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],i=r.length-1,o=r[i],a;--i>=0;)(a=r[i])&&(o&&a.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(a,o),o=a);return this}function eu(t){t||(t=nu);function e(d,f){return d&&f?t(d.__data__,f.__data__):!d-!f}for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var a=n[o],l=a.length,u=i[o]=new Array(l),s,c=0;c<l;++c)(s=a[c])&&(u[c]=s);u.sort(e)}return new ue(i,this._parents).order()}function nu(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function ru(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function iu(){return Array.from(this)}function ou(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null}function au(){let t=0;for(const e of this)++t;return t}function lu(){return!this.node()}function su(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i=e[n],o=0,a=i.length,l;o<a;++o)(l=i[o])&&t.call(l,l.__data__,o,i);return this}function uu(t){return function(){this.removeAttribute(t)}}function cu(t){return function(){this.removeAttributeNS(t.space,t.local)}}function fu(t,e){return function(){this.setAttribute(t,e)}}function du(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function hu(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function pu(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function gu(t,e){var n=Mr(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?cu:uu:typeof e=="function"?n.local?pu:hu:n.local?du:fu)(n,e))}function Na(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function mu(t){return function(){this.style.removeProperty(t)}}function yu(t,e,n){return function(){this.style.setProperty(t,e,n)}}function _u(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function vu(t,e,n){return arguments.length>1?this.each((e==null?mu:typeof e=="function"?_u:yu)(t,e,n??"")):yn(this.node(),t)}function yn(t,e){return t.style.getPropertyValue(e)||Na(t).getComputedStyle(t,null).getPropertyValue(e)}function bu(t){return function(){delete this[t]}}function wu(t,e){return function(){this[t]=e}}function xu(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function ku(t,e){return arguments.length>1?this.each((e==null?bu:typeof e=="function"?xu:wu)(t,e)):this.node()[t]}function Da(t){return t.trim().split(/^|\s+/)}function gi(t){return t.classList||new $a(t)}function $a(t){this._node=t,this._names=Da(t.getAttribute("class")||"")}$a.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function Ea(t,e){for(var n=gi(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function La(t,e){for(var n=gi(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function Tu(t){return function(){Ea(this,t)}}function Cu(t){return function(){La(this,t)}}function zu(t,e){return function(){(e.apply(this,arguments)?Ea:La)(this,t)}}function Mu(t,e){var n=Da(t+"");if(arguments.length<2){for(var r=gi(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof e=="function"?zu:e?Tu:Cu)(n,e))}function Au(){this.textContent=""}function Su(t){return function(){this.textContent=t}}function Nu(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function Du(t){return arguments.length?this.each(t==null?Au:(typeof t=="function"?Nu:Su)(t)):this.node().textContent}function $u(){this.innerHTML=""}function Eu(t){return function(){this.innerHTML=t}}function Lu(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function Iu(t){return arguments.length?this.each(t==null?$u:(typeof t=="function"?Lu:Eu)(t)):this.node().innerHTML}function Fu(){this.nextSibling&&this.parentNode.appendChild(this)}function Ru(){return this.each(Fu)}function Hu(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Uu(){return this.each(Hu)}function Ou(t){var e=typeof t=="function"?t:Ca(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function Pu(){return null}function Yu(t,e){var n=typeof t=="function"?t:Ca(t),r=e==null?Pu:typeof e=="function"?e:pi(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function Wu(){var t=this.parentNode;t&&t.removeChild(this)}function Bu(){return this.each(Wu)}function qu(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Vu(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Xu(t){return this.select(t?Vu:qu)}function Ku(t){return arguments.length?this.property("__data__",t):this.node().__data__}function Zu(t){return function(e){t.call(this,e,this.__data__)}}function Gu(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function ju(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,i=e.length,o;n<i;++n)o=e[n],(!t.type||o.type===t.type)&&o.name===t.name?this.removeEventListener(o.type,o.listener,o.options):e[++r]=o;++r?e.length=r:delete this.__on}}}function Ju(t,e,n){return function(){var r=this.__on,i,o=Zu(e);if(r){for(var a=0,l=r.length;a<l;++a)if((i=r[a]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=o,i.options=n),i.value=e;return}}this.addEventListener(t.type,o,n),i={type:t.type,name:t.name,value:e,listener:o,options:n},r?r.push(i):this.__on=[i]}}function Qu(t,e,n){var r=Gu(t+""),i,o=r.length,a;if(arguments.length<2){var l=this.node().__on;if(l){for(var u=0,s=l.length,c;u<s;++u)for(i=0,c=l[u];i<o;++i)if((a=r[i]).type===c.type&&a.name===c.name)return c.value}return}for(l=e?Ju:ju,i=0;i<o;++i)this.each(l(r[i],e,n));return this}function Ia(t,e,n){var r=Na(t),i=r.CustomEvent;typeof i=="function"?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function tc(t,e){return function(){return Ia(this,t,e)}}function ec(t,e){return function(){return Ia(this,t,e.apply(this,arguments))}}function nc(t,e){return this.each((typeof e=="function"?ec:tc)(t,e))}function*rc(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length,a;i<o;++i)(a=r[i])&&(yield a)}var Fa=[null];function ue(t,e){this._groups=t,this._parents=e}function qn(){return new ue([[document.documentElement]],Fa)}function ic(){return this}ue.prototype=qn.prototype={constructor:ue,select:Ns,selectAll:Ls,selectChild:Hs,selectChildren:Ys,filter:Ws,data:Zs,enter:Bs,exit:js,join:Js,merge:Qs,selection:ic,order:tu,sort:eu,call:ru,nodes:iu,node:ou,size:au,empty:lu,each:su,attr:gu,style:vu,property:ku,classed:Mu,text:Du,html:Iu,raise:Ru,lower:Uu,append:Ou,insert:Yu,remove:Bu,clone:Xu,datum:Ku,on:Qu,dispatch:nc,[Symbol.iterator]:rc};function wt(t){return typeof t=="string"?new ue([[document.querySelector(t)]],[document.documentElement]):new ue([[t]],Fa)}function mi(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Ra(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Vn(){}var Hn=.7,dr=1/Hn,gn="\\s*([+-]?\\d+)\\s*",Un="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",xe="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",oc=/^#([0-9a-f]{3,8})$/,ac=new RegExp(`^rgb\\(${gn},${gn},${gn}\\)$`),lc=new RegExp(`^rgb\\(${xe},${xe},${xe}\\)$`),sc=new RegExp(`^rgba\\(${gn},${gn},${gn},${Un}\\)$`),uc=new RegExp(`^rgba\\(${xe},${xe},${xe},${Un}\\)$`),cc=new RegExp(`^hsl\\(${Un},${xe},${xe}\\)$`),fc=new RegExp(`^hsla\\(${Un},${xe},${xe},${Un}\\)$`),Ui={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};mi(Vn,Ke,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Oi,formatHex:Oi,formatHex8:dc,formatHsl:hc,formatRgb:Pi,toString:Pi});function Oi(){return this.rgb().formatHex()}function dc(){return this.rgb().formatHex8()}function hc(){return Ha(this).formatHsl()}function Pi(){return this.rgb().formatRgb()}function Ke(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=oc.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?Yi(e):n===3?new ae(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?Kn(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?Kn(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=ac.exec(t))?new ae(e[1],e[2],e[3],1):(e=lc.exec(t))?new ae(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=sc.exec(t))?Kn(e[1],e[2],e[3],e[4]):(e=uc.exec(t))?Kn(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=cc.exec(t))?qi(e[1],e[2]/100,e[3]/100,1):(e=fc.exec(t))?qi(e[1],e[2]/100,e[3]/100,e[4]):Ui.hasOwnProperty(t)?Yi(Ui[t]):t==="transparent"?new ae(NaN,NaN,NaN,0):null}function Yi(t){return new ae(t>>16&255,t>>8&255,t&255,1)}function Kn(t,e,n,r){return r<=0&&(t=e=n=NaN),new ae(t,e,n,r)}function pc(t){return t instanceof Vn||(t=Ke(t)),t?(t=t.rgb(),new ae(t.r,t.g,t.b,t.opacity)):new ae}function oe(t,e,n,r){return arguments.length===1?pc(t):new ae(t,e,n,r??1)}function ae(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}mi(ae,oe,Ra(Vn,{brighter(t){return t=t==null?dr:Math.pow(dr,t),new ae(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?Hn:Math.pow(Hn,t),new ae(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new ae(qe(this.r),qe(this.g),qe(this.b),hr(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Wi,formatHex:Wi,formatHex8:gc,formatRgb:Bi,toString:Bi}));function Wi(){return`#${We(this.r)}${We(this.g)}${We(this.b)}`}function gc(){return`#${We(this.r)}${We(this.g)}${We(this.b)}${We((isNaN(this.opacity)?1:this.opacity)*255)}`}function Bi(){const t=hr(this.opacity);return`${t===1?"rgb(":"rgba("}${qe(this.r)}, ${qe(this.g)}, ${qe(this.b)}${t===1?")":`, ${t})`}`}function hr(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function qe(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function We(t){return t=qe(t),(t<16?"0":"")+t.toString(16)}function qi(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new ye(t,e,n,r)}function Ha(t){if(t instanceof ye)return new ye(t.h,t.s,t.l,t.opacity);if(t instanceof Vn||(t=Ke(t)),!t)return new ye;if(t instanceof ye)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),a=NaN,l=o-i,u=(o+i)/2;return l?(e===o?a=(n-r)/l+(n<r)*6:n===o?a=(r-e)/l+2:a=(e-n)/l+4,l/=u<.5?o+i:2-o-i,a*=60):l=u>0&&u<1?0:a,new ye(a,l,u,t.opacity)}function mc(t,e,n,r){return arguments.length===1?Ha(t):new ye(t,e,n,r??1)}function ye(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}mi(ye,mc,Ra(Vn,{brighter(t){return t=t==null?dr:Math.pow(dr,t),new ye(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Hn:Math.pow(Hn,t),new ye(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new ae(Rr(t>=240?t-240:t+120,i,r),Rr(t,i,r),Rr(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new ye(Vi(this.h),Zn(this.s),Zn(this.l),hr(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=hr(this.opacity);return`${t===1?"hsl(":"hsla("}${Vi(this.h)}, ${Zn(this.s)*100}%, ${Zn(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Vi(t){return t=(t||0)%360,t<0?t+360:t}function Zn(t){return Math.max(0,Math.min(1,t||0))}function Rr(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const yi=t=>()=>t;function yc(t,e){return function(n){return t+n*e}}function _c(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function vc(t){return(t=+t)==1?Ua:function(e,n){return n-e?_c(e,n,t):yi(isNaN(e)?n:e)}}function Ua(t,e){var n=e-t;return n?yc(t,n):yi(isNaN(t)?e:t)}const pr=function t(e){var n=vc(e);function r(i,o){var a=n((i=oe(i)).r,(o=oe(o)).r),l=n(i.g,o.g),u=n(i.b,o.b),s=Ua(i.opacity,o.opacity);return function(c){return i.r=a(c),i.g=l(c),i.b=u(c),i.opacity=s(c),i+""}}return r.gamma=t,r}(1);function bc(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),i;return function(o){for(i=0;i<n;++i)r[i]=t[i]*(1-o)+e[i]*o;return r}}function wc(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function xc(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,i=new Array(r),o=new Array(n),a;for(a=0;a<r;++a)i[a]=_i(t[a],e[a]);for(;a<n;++a)o[a]=e[a];return function(l){for(a=0;a<r;++a)o[a]=i[a](l);return o}}function kc(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function me(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function Tc(t,e){var n={},r={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?n[i]=_i(t[i],e[i]):r[i]=e[i];return function(o){for(i in n)r[i]=n[i](o);return r}}var ti=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Hr=new RegExp(ti.source,"g");function Cc(t){return function(){return t}}function zc(t){return function(e){return t(e)+""}}function Oa(t,e){var n=ti.lastIndex=Hr.lastIndex=0,r,i,o,a=-1,l=[],u=[];for(t=t+"",e=e+"";(r=ti.exec(t))&&(i=Hr.exec(e));)(o=i.index)>n&&(o=e.slice(n,o),l[a]?l[a]+=o:l[++a]=o),(r=r[0])===(i=i[0])?l[a]?l[a]+=i:l[++a]=i:(l[++a]=null,u.push({i:a,x:me(r,i)})),n=Hr.lastIndex;return n<e.length&&(o=e.slice(n),l[a]?l[a]+=o:l[++a]=o),l.length<2?u[0]?zc(u[0].x):Cc(e):(e=u.length,function(s){for(var c=0,d;c<e;++c)l[(d=u[c]).i]=d.x(s);return l.join("")})}function _i(t,e){var n=typeof e,r;return e==null||n==="boolean"?yi(e):(n==="number"?me:n==="string"?(r=Ke(e))?(e=r,pr):Oa:e instanceof Ke?pr:e instanceof Date?kc:wc(e)?bc:Array.isArray(e)?xc:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?Tc:me)(t,e)}function Mc(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var Xi=180/Math.PI,ei={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Pa(t,e,n,r,i,o){var a,l,u;return(a=Math.sqrt(t*t+e*e))&&(t/=a,e/=a),(u=t*n+e*r)&&(n-=t*u,r-=e*u),(l=Math.sqrt(n*n+r*r))&&(n/=l,r/=l,u/=l),t*r<e*n&&(t=-t,e=-e,u=-u,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(e,t)*Xi,skewX:Math.atan(u)*Xi,scaleX:a,scaleY:l}}var Gn;function Ac(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?ei:Pa(e.a,e.b,e.c,e.d,e.e,e.f)}function Sc(t){return t==null||(Gn||(Gn=document.createElementNS("http://www.w3.org/2000/svg","g")),Gn.setAttribute("transform",t),!(t=Gn.transform.baseVal.consolidate()))?ei:(t=t.matrix,Pa(t.a,t.b,t.c,t.d,t.e,t.f))}function Ya(t,e,n,r){function i(s){return s.length?s.pop()+" ":""}function o(s,c,d,f,h,g){if(s!==d||c!==f){var y=h.push("translate(",null,e,null,n);g.push({i:y-4,x:me(s,d)},{i:y-2,x:me(c,f)})}else(d||f)&&h.push("translate("+d+e+f+n)}function a(s,c,d,f){s!==c?(s-c>180?c+=360:c-s>180&&(s+=360),f.push({i:d.push(i(d)+"rotate(",null,r)-2,x:me(s,c)})):c&&d.push(i(d)+"rotate("+c+r)}function l(s,c,d,f){s!==c?f.push({i:d.push(i(d)+"skewX(",null,r)-2,x:me(s,c)}):c&&d.push(i(d)+"skewX("+c+r)}function u(s,c,d,f,h,g){if(s!==d||c!==f){var y=h.push(i(h)+"scale(",null,",",null,")");g.push({i:y-4,x:me(s,d)},{i:y-2,x:me(c,f)})}else(d!==1||f!==1)&&h.push(i(h)+"scale("+d+","+f+")")}return function(s,c){var d=[],f=[];return s=t(s),c=t(c),o(s.translateX,s.translateY,c.translateX,c.translateY,d,f),a(s.rotate,c.rotate,d,f),l(s.skewX,c.skewX,d,f),u(s.scaleX,s.scaleY,c.scaleX,c.scaleY,d,f),s=c=null,function(h){for(var g=-1,y=f.length,v;++g<y;)d[(v=f[g]).i]=v.x(h);return d.join("")}}}var Nc=Ya(Ac,"px, ","px)","deg)"),Dc=Ya(Sc,", ",")",")"),_n=0,En=0,zn=0,Wa=1e3,gr,Ln,mr=0,Ze=0,Ar=0,On=typeof performance=="object"&&performance.now?performance:Date,Ba=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function vi(){return Ze||(Ba($c),Ze=On.now()+Ar)}function $c(){Ze=0}function yr(){this._call=this._time=this._next=null}yr.prototype=qa.prototype={constructor:yr,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?vi():+n)+(e==null?0:+e),!this._next&&Ln!==this&&(Ln?Ln._next=this:gr=this,Ln=this),this._call=t,this._time=n,ni()},stop:function(){this._call&&(this._call=null,this._time=1/0,ni())}};function qa(t,e,n){var r=new yr;return r.restart(t,e,n),r}function Ec(){vi(),++_n;for(var t=gr,e;t;)(e=Ze-t._time)>=0&&t._call.call(void 0,e),t=t._next;--_n}function Ki(){Ze=(mr=On.now())+Ar,_n=En=0;try{Ec()}finally{_n=0,Ic(),Ze=0}}function Lc(){var t=On.now(),e=t-mr;e>Wa&&(Ar-=e,mr=t)}function Ic(){for(var t,e=gr,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:gr=n);Ln=t,ni(r)}function ni(t){if(!_n){En&&(En=clearTimeout(En));var e=t-Ze;e>24?(t<1/0&&(En=setTimeout(Ki,t-On.now()-Ar)),zn&&(zn=clearInterval(zn))):(zn||(mr=On.now(),zn=setInterval(Lc,Wa)),_n=1,Ba(Ki))}}function Zi(t,e,n){var r=new yr;return e=e==null?0:+e,r.restart(i=>{r.stop(),t(i+e)},e,n),r}var Fc=Ta("start","end","cancel","interrupt"),Rc=[],Va=0,Gi=1,ri=2,rr=3,ji=4,ii=5,ir=6;function Sr(t,e,n,r,i,o){var a=t.__transition;if(!a)t.__transition={};else if(n in a)return;Hc(t,n,{name:e,index:r,group:i,on:Fc,tween:Rc,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:Va})}function bi(t,e){var n=ve(t,e);if(n.state>Va)throw new Error("too late; already scheduled");return n}function Ce(t,e){var n=ve(t,e);if(n.state>rr)throw new Error("too late; already running");return n}function ve(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function Hc(t,e,n){var r=t.__transition,i;r[e]=n,n.timer=qa(o,0,n.time);function o(s){n.state=Gi,n.timer.restart(a,n.delay,n.time),n.delay<=s&&a(s-n.delay)}function a(s){var c,d,f,h;if(n.state!==Gi)return u();for(c in r)if(h=r[c],h.name===n.name){if(h.state===rr)return Zi(a);h.state===ji?(h.state=ir,h.timer.stop(),h.on.call("interrupt",t,t.__data__,h.index,h.group),delete r[c]):+c<e&&(h.state=ir,h.timer.stop(),h.on.call("cancel",t,t.__data__,h.index,h.group),delete r[c])}if(Zi(function(){n.state===rr&&(n.state=ji,n.timer.restart(l,n.delay,n.time),l(s))}),n.state=ri,n.on.call("start",t,t.__data__,n.index,n.group),n.state===ri){for(n.state=rr,i=new Array(f=n.tween.length),c=0,d=-1;c<f;++c)(h=n.tween[c].value.call(t,t.__data__,n.index,n.group))&&(i[++d]=h);i.length=d+1}}function l(s){for(var c=s<n.duration?n.ease.call(null,s/n.duration):(n.timer.restart(u),n.state=ii,1),d=-1,f=i.length;++d<f;)i[d].call(t,c);n.state===ii&&(n.on.call("end",t,t.__data__,n.index,n.group),u())}function u(){n.state=ir,n.timer.stop(),delete r[e];for(var s in r)return;delete t.__transition}}function Uc(t,e){var n=t.__transition,r,i,o=!0,a;if(n){e=e==null?null:e+"";for(a in n){if((r=n[a]).name!==e){o=!1;continue}i=r.state>ri&&r.state<ii,r.state=ir,r.timer.stop(),r.on.call(i?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[a]}o&&delete t.__transition}}function Oc(t){return this.each(function(){Uc(this,t)})}function Pc(t,e){var n,r;return function(){var i=Ce(this,t),o=i.tween;if(o!==n){r=n=o;for(var a=0,l=r.length;a<l;++a)if(r[a].name===e){r=r.slice(),r.splice(a,1);break}}i.tween=r}}function Yc(t,e,n){var r,i;if(typeof n!="function")throw new Error;return function(){var o=Ce(this,t),a=o.tween;if(a!==r){i=(r=a).slice();for(var l={name:e,value:n},u=0,s=i.length;u<s;++u)if(i[u].name===e){i[u]=l;break}u===s&&i.push(l)}o.tween=i}}function Wc(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=ve(this.node(),n).tween,i=0,o=r.length,a;i<o;++i)if((a=r[i]).name===t)return a.value;return null}return this.each((e==null?Pc:Yc)(n,t,e))}function wi(t,e,n){var r=t._id;return t.each(function(){var i=Ce(this,r);(i.value||(i.value={}))[e]=n.apply(this,arguments)}),function(i){return ve(i,r).value[e]}}function Xa(t,e){var n;return(typeof e=="number"?me:e instanceof Ke?pr:(n=Ke(e))?(e=n,pr):Oa)(t,e)}function Bc(t){return function(){this.removeAttribute(t)}}function qc(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Vc(t,e,n){var r,i=n+"",o;return function(){var a=this.getAttribute(t);return a===i?null:a===r?o:o=e(r=a,n)}}function Xc(t,e,n){var r,i=n+"",o;return function(){var a=this.getAttributeNS(t.space,t.local);return a===i?null:a===r?o:o=e(r=a,n)}}function Kc(t,e,n){var r,i,o;return function(){var a,l=n(this),u;return l==null?void this.removeAttribute(t):(a=this.getAttribute(t),u=l+"",a===u?null:a===r&&u===i?o:(i=u,o=e(r=a,l)))}}function Zc(t,e,n){var r,i,o;return function(){var a,l=n(this),u;return l==null?void this.removeAttributeNS(t.space,t.local):(a=this.getAttributeNS(t.space,t.local),u=l+"",a===u?null:a===r&&u===i?o:(i=u,o=e(r=a,l)))}}function Gc(t,e){var n=Mr(t),r=n==="transform"?Dc:Xa;return this.attrTween(t,typeof e=="function"?(n.local?Zc:Kc)(n,r,wi(this,"attr."+t,e)):e==null?(n.local?qc:Bc)(n):(n.local?Xc:Vc)(n,r,e))}function jc(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function Jc(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function Qc(t,e){var n,r;function i(){var o=e.apply(this,arguments);return o!==r&&(n=(r=o)&&Jc(t,o)),n}return i._value=e,i}function tf(t,e){var n,r;function i(){var o=e.apply(this,arguments);return o!==r&&(n=(r=o)&&jc(t,o)),n}return i._value=e,i}function ef(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=Mr(t);return this.tween(n,(r.local?Qc:tf)(r,e))}function nf(t,e){return function(){bi(this,t).delay=+e.apply(this,arguments)}}function rf(t,e){return e=+e,function(){bi(this,t).delay=e}}function of(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?nf:rf)(e,t)):ve(this.node(),e).delay}function af(t,e){return function(){Ce(this,t).duration=+e.apply(this,arguments)}}function lf(t,e){return e=+e,function(){Ce(this,t).duration=e}}function sf(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?af:lf)(e,t)):ve(this.node(),e).duration}function uf(t,e){if(typeof e!="function")throw new Error;return function(){Ce(this,t).ease=e}}function cf(t){var e=this._id;return arguments.length?this.each(uf(e,t)):ve(this.node(),e).ease}function ff(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;Ce(this,t).ease=n}}function df(t){if(typeof t!="function")throw new Error;return this.each(ff(this._id,t))}function hf(t){typeof t!="function"&&(t=Ma(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o=e[i],a=o.length,l=r[i]=[],u,s=0;s<a;++s)(u=o[s])&&t.call(u,u.__data__,s,o)&&l.push(u);return new $e(r,this._parents,this._name,this._id)}function pf(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,o=Math.min(r,i),a=new Array(r),l=0;l<o;++l)for(var u=e[l],s=n[l],c=u.length,d=a[l]=new Array(c),f,h=0;h<c;++h)(f=u[h]||s[h])&&(d[h]=f);for(;l<r;++l)a[l]=e[l];return new $e(a,this._parents,this._name,this._id)}function gf(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function mf(t,e,n){var r,i,o=gf(e)?bi:Ce;return function(){var a=o(this,t),l=a.on;l!==r&&(i=(r=l).copy()).on(e,n),a.on=i}}function yf(t,e){var n=this._id;return arguments.length<2?ve(this.node(),n).on.on(t):this.each(mf(n,t,e))}function _f(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function vf(){return this.on("end.remove",_f(this._id))}function bf(t){var e=this._name,n=this._id;typeof t!="function"&&(t=pi(t));for(var r=this._groups,i=r.length,o=new Array(i),a=0;a<i;++a)for(var l=r[a],u=l.length,s=o[a]=new Array(u),c,d,f=0;f<u;++f)(c=l[f])&&(d=t.call(c,c.__data__,f,l))&&("__data__"in c&&(d.__data__=c.__data__),s[f]=d,Sr(s[f],e,n,f,s,ve(c,n)));return new $e(o,this._parents,e,n)}function wf(t){var e=this._name,n=this._id;typeof t!="function"&&(t=za(t));for(var r=this._groups,i=r.length,o=[],a=[],l=0;l<i;++l)for(var u=r[l],s=u.length,c,d=0;d<s;++d)if(c=u[d]){for(var f=t.call(c,c.__data__,d,u),h,g=ve(c,n),y=0,v=f.length;y<v;++y)(h=f[y])&&Sr(h,e,n,y,f,g);o.push(f),a.push(c)}return new $e(o,a,e,n)}var xf=qn.prototype.constructor;function kf(){return new xf(this._groups,this._parents)}function Tf(t,e){var n,r,i;return function(){var o=yn(this,t),a=(this.style.removeProperty(t),yn(this,t));return o===a?null:o===n&&a===r?i:i=e(n=o,r=a)}}function Ka(t){return function(){this.style.removeProperty(t)}}function Cf(t,e,n){var r,i=n+"",o;return function(){var a=yn(this,t);return a===i?null:a===r?o:o=e(r=a,n)}}function zf(t,e,n){var r,i,o;return function(){var a=yn(this,t),l=n(this),u=l+"";return l==null&&(u=l=(this.style.removeProperty(t),yn(this,t))),a===u?null:a===r&&u===i?o:(i=u,o=e(r=a,l))}}function Mf(t,e){var n,r,i,o="style."+e,a="end."+o,l;return function(){var u=Ce(this,t),s=u.on,c=u.value[o]==null?l||(l=Ka(e)):void 0;(s!==n||i!==c)&&(r=(n=s).copy()).on(a,i=c),u.on=r}}function Af(t,e,n){var r=(t+="")=="transform"?Nc:Xa;return e==null?this.styleTween(t,Tf(t,r)).on("end.style."+t,Ka(t)):typeof e=="function"?this.styleTween(t,zf(t,r,wi(this,"style."+t,e))).each(Mf(this._id,t)):this.styleTween(t,Cf(t,r,e),n).on("end.style."+t,null)}function Sf(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function Nf(t,e,n){var r,i;function o(){var a=e.apply(this,arguments);return a!==i&&(r=(i=a)&&Sf(t,a,n)),r}return o._value=e,o}function Df(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,Nf(t,e,n??""))}function $f(t){return function(){this.textContent=t}}function Ef(t){return function(){var e=t(this);this.textContent=e??""}}function Lf(t){return this.tween("text",typeof t=="function"?Ef(wi(this,"text",t)):$f(t==null?"":t+""))}function If(t){return function(e){this.textContent=t.call(this,e)}}function Ff(t){var e,n;function r(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&If(i)),e}return r._value=t,r}function Rf(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,Ff(t))}function Hf(){for(var t=this._name,e=this._id,n=Za(),r=this._groups,i=r.length,o=0;o<i;++o)for(var a=r[o],l=a.length,u,s=0;s<l;++s)if(u=a[s]){var c=ve(u,e);Sr(u,t,n,s,a,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new $e(r,this._parents,t,n)}function Uf(){var t,e,n=this,r=n._id,i=n.size();return new Promise(function(o,a){var l={value:a},u={value:function(){--i===0&&o()}};n.each(function(){var s=Ce(this,r),c=s.on;c!==t&&(e=(t=c).copy(),e._.cancel.push(l),e._.interrupt.push(l),e._.end.push(u)),s.on=e}),i===0&&o()})}var Of=0;function $e(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function Za(){return++Of}var ze=qn.prototype;$e.prototype={constructor:$e,select:bf,selectAll:wf,selectChild:ze.selectChild,selectChildren:ze.selectChildren,filter:hf,merge:pf,selection:kf,transition:Hf,call:ze.call,nodes:ze.nodes,node:ze.node,size:ze.size,empty:ze.empty,each:ze.each,on:yf,attr:Gc,attrTween:ef,style:Af,styleTween:Df,text:Lf,textTween:Rf,remove:vf,tween:Wc,delay:of,duration:sf,ease:cf,easeVarying:df,end:Uf,[Symbol.iterator]:ze[Symbol.iterator]};function Pf(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var Yf={time:null,delay:0,duration:250,ease:Pf};function Wf(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function Bf(t){var e,n;t instanceof $e?(e=t._id,t=t._name):(e=Za(),(n=Yf).time=vi(),t=t==null?null:t+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var a=r[o],l=a.length,u,s=0;s<l;++s)(u=a[s])&&Sr(u,t,e,s,a,n||Wf(u,e));return new $e(r,this._parents,t,e)}qn.prototype.interrupt=Oc;qn.prototype.transition=Bf;const oi=Math.PI,ai=2*oi,Ye=1e-6,qf=ai-Ye;function Ga(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function Vf(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return Ga;const n=10**e;return function(r){this._+=r[0];for(let i=1,o=r.length;i<o;++i)this._+=Math.round(arguments[i]*n)/n+r[i]}}class Xf{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?Ga:Vf(e)}moveTo(e,n){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,n){this._append`L${this._x1=+e},${this._y1=+n}`}quadraticCurveTo(e,n,r,i){this._append`Q${+e},${+n},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(e,n,r,i,o,a){this._append`C${+e},${+n},${+r},${+i},${this._x1=+o},${this._y1=+a}`}arcTo(e,n,r,i,o){if(e=+e,n=+n,r=+r,i=+i,o=+o,o<0)throw new Error(`negative radius: ${o}`);let a=this._x1,l=this._y1,u=r-e,s=i-n,c=a-e,d=l-n,f=c*c+d*d;if(this._x1===null)this._append`M${this._x1=e},${this._y1=n}`;else if(f>Ye)if(!(Math.abs(d*u-s*c)>Ye)||!o)this._append`L${this._x1=e},${this._y1=n}`;else{let h=r-a,g=i-l,y=u*u+s*s,v=h*h+g*g,T=Math.sqrt(y),D=Math.sqrt(f),M=o*Math.tan((oi-Math.acos((y+f-v)/(2*T*D)))/2),C=M/D,b=M/T;Math.abs(C-1)>Ye&&this._append`L${e+C*c},${n+C*d}`,this._append`A${o},${o},0,0,${+(d*h>c*g)},${this._x1=e+b*u},${this._y1=n+b*s}`}}arc(e,n,r,i,o,a){if(e=+e,n=+n,r=+r,a=!!a,r<0)throw new Error(`negative radius: ${r}`);let l=r*Math.cos(i),u=r*Math.sin(i),s=e+l,c=n+u,d=1^a,f=a?i-o:o-i;this._x1===null?this._append`M${s},${c}`:(Math.abs(this._x1-s)>Ye||Math.abs(this._y1-c)>Ye)&&this._append`L${s},${c}`,r&&(f<0&&(f=f%ai+ai),f>qf?this._append`A${r},${r},0,1,${d},${e-l},${n-u}A${r},${r},0,1,${d},${this._x1=s},${this._y1=c}`:f>Ye&&this._append`A${r},${r},0,${+(f>=oi)},${d},${this._x1=e+r*Math.cos(o)},${this._y1=n+r*Math.sin(o)}`)}rect(e,n,r,i){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}}function Kf(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function _r(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function vn(t){return t=_r(Math.abs(t)),t?t[1]:NaN}function Zf(t,e){return function(n,r){for(var i=n.length,o=[],a=0,l=t[0],u=0;i>0&&l>0&&(u+l+1>r&&(l=Math.max(1,r-u)),o.push(n.substring(i-=l,i+l)),!((u+=l+1)>r));)l=t[a=(a+1)%t.length];return o.reverse().join(e)}}function Gf(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var jf=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function vr(t){if(!(e=jf.exec(t)))throw new Error("invalid format: "+t);var e;return new xi({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}vr.prototype=xi.prototype;function xi(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}xi.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Jf(t){t:for(var e=t.length,n=1,r=-1,i;n<e;++n)switch(t[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+t[n])break t;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(i+1):t}var ja;function Qf(t,e){var n=_r(t,e);if(!n)return t+"";var r=n[0],i=n[1],o=i-(ja=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+_r(t,Math.max(0,e+o-1))[0]}function Ji(t,e){var n=_r(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const Qi={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:Kf,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Ji(t*100,e),r:Ji,s:Qf,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function to(t){return t}var eo=Array.prototype.map,no=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function td(t){var e=t.grouping===void 0||t.thousands===void 0?to:Zf(eo.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",o=t.numerals===void 0?to:Gf(eo.call(t.numerals,String)),a=t.percent===void 0?"%":t.percent+"",l=t.minus===void 0?"−":t.minus+"",u=t.nan===void 0?"NaN":t.nan+"";function s(d){d=vr(d);var f=d.fill,h=d.align,g=d.sign,y=d.symbol,v=d.zero,T=d.width,D=d.comma,M=d.precision,C=d.trim,b=d.type;b==="n"?(D=!0,b="g"):Qi[b]||(M===void 0&&(M=12),C=!0,b="g"),(v||f==="0"&&h==="=")&&(v=!0,f="0",h="=");var A=y==="$"?n:y==="#"&&/[boxX]/.test(b)?"0"+b.toLowerCase():"",k=y==="$"?r:/[%p]/.test(b)?a:"",L=Qi[b],z=/[defgprs%]/.test(b);M=M===void 0?6:/[gprs]/.test(b)?Math.max(1,Math.min(21,M)):Math.max(0,Math.min(20,M));function m(N){var R=A,E=k,w,tt,Y;if(b==="c")E=L(N)+E,N="";else{N=+N;var Z=N<0||1/N<0;if(N=isNaN(N)?u:L(Math.abs(N),M),C&&(N=Jf(N)),Z&&+N==0&&g!=="+"&&(Z=!1),R=(Z?g==="("?g:l:g==="-"||g==="("?"":g)+R,E=(b==="s"?no[8+ja/3]:"")+E+(Z&&g==="("?")":""),z){for(w=-1,tt=N.length;++w<tt;)if(Y=N.charCodeAt(w),48>Y||Y>57){E=(Y===46?i+N.slice(w+1):N.slice(w))+E,N=N.slice(0,w);break}}}D&&!v&&(N=e(N,1/0));var q=R.length+N.length+E.length,et=q<T?new Array(T-q+1).join(f):"";switch(D&&v&&(N=e(et+N,et.length?T-E.length:1/0),et=""),h){case"<":N=R+N+E+et;break;case"=":N=R+et+N+E;break;case"^":N=et.slice(0,q=et.length>>1)+R+N+E+et.slice(q);break;default:N=et+R+N+E;break}return o(N)}return m.toString=function(){return d+""},m}function c(d,f){var h=s((d=vr(d),d.type="f",d)),g=Math.max(-8,Math.min(8,Math.floor(vn(f)/3)))*3,y=Math.pow(10,-g),v=no[8+g/3];return function(T){return h(y*T)+v}}return{format:s,formatPrefix:c}}var jn,Ja,Qa;ed({thousands:",",grouping:[3],currency:["$",""]});function ed(t){return jn=td(t),Ja=jn.format,Qa=jn.formatPrefix,jn}function nd(t){return Math.max(0,-vn(Math.abs(t)))}function rd(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(vn(e)/3)))*3-vn(Math.abs(t)))}function id(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,vn(e)-vn(t))+1}function od(t){var e=0,n=t.children,r=n&&n.length;if(!r)e=1;else for(;--r>=0;)e+=n[r].value;t.value=e}function ad(){return this.eachAfter(od)}function ld(t,e){let n=-1;for(const r of this)t.call(e,r,++n,this);return this}function sd(t,e){for(var n=this,r=[n],i,o,a=-1;n=r.pop();)if(t.call(e,n,++a,this),i=n.children)for(o=i.length-1;o>=0;--o)r.push(i[o]);return this}function ud(t,e){for(var n=this,r=[n],i=[],o,a,l,u=-1;n=r.pop();)if(i.push(n),o=n.children)for(a=0,l=o.length;a<l;++a)r.push(o[a]);for(;n=i.pop();)t.call(e,n,++u,this);return this}function cd(t,e){let n=-1;for(const r of this)if(t.call(e,r,++n,this))return r}function fd(t){return this.eachAfter(function(e){for(var n=+t(e.data)||0,r=e.children,i=r&&r.length;--i>=0;)n+=r[i].value;e.value=n})}function dd(t){return this.eachBefore(function(e){e.children&&e.children.sort(t)})}function hd(t){for(var e=this,n=pd(e,t),r=[e];e!==n;)e=e.parent,r.push(e);for(var i=r.length;t!==n;)r.splice(i,0,t),t=t.parent;return r}function pd(t,e){if(t===e)return t;var n=t.ancestors(),r=e.ancestors(),i=null;for(t=n.pop(),e=r.pop();t===e;)i=t,t=n.pop(),e=r.pop();return i}function gd(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e}function md(){return Array.from(this)}function yd(){var t=[];return this.eachBefore(function(e){e.children||t.push(e)}),t}function _d(){var t=this,e=[];return t.each(function(n){n!==t&&e.push({source:n.parent,target:n})}),e}function*vd(){var t=this,e,n=[t],r,i,o;do for(e=n.reverse(),n=[];t=e.pop();)if(yield t,r=t.children)for(i=0,o=r.length;i<o;++i)n.push(r[i]);while(n.length)}function _e(t,e){t instanceof Map?(t=[void 0,t],e===void 0&&(e=xd)):e===void 0&&(e=wd);for(var n=new br(t),r,i=[n],o,a,l,u;r=i.pop();)if((a=e(r.data))&&(u=(a=Array.from(a)).length))for(r.children=a,l=u-1;l>=0;--l)i.push(o=a[l]=new br(a[l])),o.parent=r,o.depth=r.depth+1;return n.eachBefore(Td)}function bd(){return _e(this).eachBefore(kd)}function wd(t){return t.children}function xd(t){return Array.isArray(t)?t[1]:null}function kd(t){t.data.value!==void 0&&(t.value=t.data.value),t.data=t.data.data}function Td(t){var e=0;do t.height=e;while((t=t.parent)&&t.height<++e)}function br(t){this.data=t,this.depth=this.height=0,this.parent=null}br.prototype=_e.prototype={constructor:br,count:ad,each:ld,eachAfter:ud,eachBefore:sd,find:cd,sum:fd,sort:dd,path:hd,ancestors:gd,descendants:md,leaves:yd,links:_d,copy:bd,[Symbol.iterator]:vd};function Cd(t){if(typeof t!="function")throw new Error;return t}function Mn(){return 0}function An(t){return function(){return t}}function zd(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)}function Md(t,e,n,r,i){for(var o=t.children,a,l=-1,u=o.length,s=t.value&&(r-e)/t.value;++l<u;)a=o[l],a.y0=n,a.y1=i,a.x0=e,a.x1=e+=a.value*s}function Ad(t,e,n,r,i){for(var o=t.children,a,l=-1,u=o.length,s=t.value&&(i-n)/t.value;++l<u;)a=o[l],a.x0=e,a.x1=r,a.y0=n,a.y1=n+=a.value*s}var Sd=(1+Math.sqrt(5))/2;function Nd(t,e,n,r,i,o){for(var a=[],l=e.children,u,s,c=0,d=0,f=l.length,h,g,y=e.value,v,T,D,M,C,b,A;c<f;){h=i-n,g=o-r;do v=l[d++].value;while(!v&&d<f);for(T=D=v,b=Math.max(g/h,h/g)/(y*t),A=v*v*b,C=Math.max(D/A,A/T);d<f;++d){if(v+=s=l[d].value,s<T&&(T=s),s>D&&(D=s),A=v*v*b,M=Math.max(D/A,A/T),M>C){v-=s;break}C=M}a.push(u={value:v,dice:h<g,children:l.slice(c,d)}),u.dice?Md(u,n,r,i,y?r+=g*v/y:o):Ad(u,n,r,y?n+=h*v/y:i,o),y-=v,c=d}return a}const Dd=function t(e){function n(r,i,o,a,l){Nd(e,r,i,o,a,l)}return n.ratio=function(r){return t((r=+r)>1?r:1)},n}(Sd);function tl(){var t=Dd,e=!1,n=1,r=1,i=[0],o=Mn,a=Mn,l=Mn,u=Mn,s=Mn;function c(f){return f.x0=f.y0=0,f.x1=n,f.y1=r,f.eachBefore(d),i=[0],e&&f.eachBefore(zd),f}function d(f){var h=i[f.depth],g=f.x0+h,y=f.y0+h,v=f.x1-h,T=f.y1-h;v<g&&(g=v=(g+v)/2),T<y&&(y=T=(y+T)/2),f.x0=g,f.y0=y,f.x1=v,f.y1=T,f.children&&(h=i[f.depth+1]=o(f)/2,g+=s(f)-h,y+=a(f)-h,v-=l(f)-h,T-=u(f)-h,v<g&&(g=v=(g+v)/2),T<y&&(y=T=(y+T)/2),t(f,g,y,v,T))}return c.round=function(f){return arguments.length?(e=!!f,c):e},c.size=function(f){return arguments.length?(n=+f[0],r=+f[1],c):[n,r]},c.tile=function(f){return arguments.length?(t=Cd(f),c):t},c.padding=function(f){return arguments.length?c.paddingInner(f).paddingOuter(f):c.paddingInner()},c.paddingInner=function(f){return arguments.length?(o=typeof f=="function"?f:An(+f),c):o},c.paddingOuter=function(f){return arguments.length?c.paddingTop(f).paddingRight(f).paddingBottom(f).paddingLeft(f):c.paddingTop()},c.paddingTop=function(f){return arguments.length?(a=typeof f=="function"?f:An(+f),c):a},c.paddingRight=function(f){return arguments.length?(l=typeof f=="function"?f:An(+f),c):l},c.paddingBottom=function(f){return arguments.length?(u=typeof f=="function"?f:An(+f),c):u},c.paddingLeft=function(f){return arguments.length?(s=typeof f=="function"?f:An(+f),c):s},c}function Nr(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}const ro=Symbol("implicit");function De(){var t=new Kr,e=[],n=[],r=ro;function i(o){let a=t.get(o);if(a===void 0){if(r!==ro)return r;t.set(o,a=e.push(o)-1)}return n[a%n.length]}return i.domain=function(o){if(!arguments.length)return e.slice();e=[],t=new Kr;for(const a of o)t.has(a)||t.set(a,e.push(a)-1);return i},i.range=function(o){return arguments.length?(n=Array.from(o),i):n.slice()},i.unknown=function(o){return arguments.length?(r=o,i):r},i.copy=function(){return De(e,n).unknown(r)},Nr.apply(i,arguments),i}function ki(){var t=De().unknown(void 0),e=t.domain,n=t.range,r=0,i=1,o,a,l=!1,u=0,s=0,c=.5;delete t.unknown;function d(){var f=e().length,h=i<r,g=h?i:r,y=h?r:i;o=(y-g)/Math.max(1,f-u+s*2),l&&(o=Math.floor(o)),g+=(y-g-o*(f-u))*c,a=o*(1-u),l&&(g=Math.round(g),a=Math.round(a));var v=ys(f).map(function(T){return g+o*T});return n(h?v.reverse():v)}return t.domain=function(f){return arguments.length?(e(f),d()):e()},t.range=function(f){return arguments.length?([r,i]=f,r=+r,i=+i,d()):[r,i]},t.rangeRound=function(f){return[r,i]=f,r=+r,i=+i,l=!0,d()},t.bandwidth=function(){return a},t.step=function(){return o},t.round=function(f){return arguments.length?(l=!!f,d()):l},t.padding=function(f){return arguments.length?(u=Math.min(1,s=+f),d()):u},t.paddingInner=function(f){return arguments.length?(u=Math.min(1,f),d()):u},t.paddingOuter=function(f){return arguments.length?(s=+f,d()):s},t.align=function(f){return arguments.length?(c=Math.max(0,Math.min(1,f)),d()):c},t.copy=function(){return ki(e(),[r,i]).round(l).paddingInner(u).paddingOuter(s).align(c)},Nr.apply(d(),arguments)}function $d(t){return function(){return t}}function Ed(t){return+t}var io=[0,1];function an(t){return t}function li(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:$d(isNaN(e)?NaN:.5)}function Ld(t,e){var n;return t>e&&(n=t,t=e,e=n),function(r){return Math.max(t,Math.min(e,r))}}function Id(t,e,n){var r=t[0],i=t[1],o=e[0],a=e[1];return i<r?(r=li(i,r),o=n(a,o)):(r=li(r,i),o=n(o,a)),function(l){return o(r(l))}}function Fd(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),o=new Array(r),a=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<r;)i[a]=li(t[a],t[a+1]),o[a]=n(e[a],e[a+1]);return function(l){var u=ss(t,l,1,r)-1;return o[u](i[u](l))}}function el(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Rd(){var t=io,e=io,n=_i,r,i,o,a=an,l,u,s;function c(){var f=Math.min(t.length,e.length);return a!==an&&(a=Ld(t[0],t[f-1])),l=f>2?Fd:Id,u=s=null,d}function d(f){return f==null||isNaN(f=+f)?o:(u||(u=l(t.map(r),e,n)))(r(a(f)))}return d.invert=function(f){return a(i((s||(s=l(e,t.map(r),me)))(f)))},d.domain=function(f){return arguments.length?(t=Array.from(f,Ed),c()):t.slice()},d.range=function(f){return arguments.length?(e=Array.from(f),c()):e.slice()},d.rangeRound=function(f){return e=Array.from(f),n=Mc,c()},d.clamp=function(f){return arguments.length?(a=f?!0:an,c()):a!==an},d.interpolate=function(f){return arguments.length?(n=f,c()):n},d.unknown=function(f){return arguments.length?(o=f,d):o},function(f,h){return r=f,i=h,c()}}function nl(){return Rd()(an,an)}function Hd(t,e,n,r){var i=jr(t,e,n),o;switch(r=vr(r??",f"),r.type){case"s":{var a=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(o=rd(i,a))&&(r.precision=o),Qa(r,a)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(o=id(i,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=o-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(o=nd(i))&&(r.precision=o-(r.type==="%")*2);break}}return Ja(r)}function Ud(t){var e=t.domain;return t.ticks=function(n){var r=e();return ms(r[0],r[r.length-1],n??10)},t.tickFormat=function(n,r){var i=e();return Hd(i[0],i[i.length-1],n??10,r)},t.nice=function(n){n==null&&(n=10);var r=e(),i=0,o=r.length-1,a=r[i],l=r[o],u,s,c=10;for(l<a&&(s=a,a=l,l=s,s=i,i=o,o=s);c-- >0;){if(s=Gr(a,l,n),s===u)return r[i]=a,r[o]=l,e(r);if(s>0)a=Math.floor(a/s)*s,l=Math.ceil(l/s)*s;else if(s<0)a=Math.ceil(a*s)/s,l=Math.floor(l*s)/s;else break;u=s}return t},t}function Pn(){var t=nl();return t.copy=function(){return el(t,Pn())},Nr.apply(t,arguments),Ud(t)}function Od(t,e){t=t.slice();var n=0,r=t.length-1,i=t[n],o=t[r],a;return o<i&&(a=n,n=r,r=a,a=i,i=o,o=a),t[n]=e.floor(i),t[r]=e.ceil(o),t}const Ur=new Date,Or=new Date;function Bt(t,e,n,r){function i(o){return t(o=arguments.length===0?new Date:new Date(+o)),o}return i.floor=o=>(t(o=new Date(+o)),o),i.ceil=o=>(t(o=new Date(o-1)),e(o,1),t(o),o),i.round=o=>{const a=i(o),l=i.ceil(o);return o-a<l-o?a:l},i.offset=(o,a)=>(e(o=new Date(+o),a==null?1:Math.floor(a)),o),i.range=(o,a,l)=>{const u=[];if(o=i.ceil(o),l=l==null?1:Math.floor(l),!(o<a)||!(l>0))return u;let s;do u.push(s=new Date(+o)),e(o,l),t(o);while(s<o&&o<a);return u},i.filter=o=>Bt(a=>{if(a>=a)for(;t(a),!o(a);)a.setTime(a-1)},(a,l)=>{if(a>=a)if(l<0)for(;++l<=0;)for(;e(a,-1),!o(a););else for(;--l>=0;)for(;e(a,1),!o(a););}),n&&(i.count=(o,a)=>(Ur.setTime(+o),Or.setTime(+a),t(Ur),t(Or),Math.floor(n(Ur,Or))),i.every=o=>(o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?i.filter(r?a=>r(a)%o===0:a=>i.count(0,a)%o===0):i)),i}const wr=Bt(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);wr.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?Bt(e=>{e.setTime(Math.floor(e/t)*t)},(e,n)=>{e.setTime(+e+n*t)},(e,n)=>(n-e)/t):wr);wr.range;const Se=1e3,de=Se*60,Ne=de*60,Ee=Ne*24,Ti=Ee*7,oo=Ee*30,Pr=Ee*365,ln=Bt(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*Se)},(t,e)=>(e-t)/Se,t=>t.getUTCSeconds());ln.range;const Ci=Bt(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Se)},(t,e)=>{t.setTime(+t+e*de)},(t,e)=>(e-t)/de,t=>t.getMinutes());Ci.range;const Pd=Bt(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*de)},(t,e)=>(e-t)/de,t=>t.getUTCMinutes());Pd.range;const zi=Bt(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Se-t.getMinutes()*de)},(t,e)=>{t.setTime(+t+e*Ne)},(t,e)=>(e-t)/Ne,t=>t.getHours());zi.range;const Yd=Bt(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*Ne)},(t,e)=>(e-t)/Ne,t=>t.getUTCHours());Yd.range;const Xn=Bt(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*de)/Ee,t=>t.getDate()-1);Xn.range;const Mi=Bt(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/Ee,t=>t.getUTCDate()-1);Mi.range;const Wd=Bt(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/Ee,t=>Math.floor(t/Ee));Wd.range;function je(t){return Bt(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,n)=>{e.setDate(e.getDate()+n*7)},(e,n)=>(n-e-(n.getTimezoneOffset()-e.getTimezoneOffset())*de)/Ti)}const Dr=je(0),xr=je(1),Bd=je(2),qd=je(3),bn=je(4),Vd=je(5),Xd=je(6);Dr.range;xr.range;Bd.range;qd.range;bn.range;Vd.range;Xd.range;function Je(t){return Bt(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCDate(e.getUTCDate()+n*7)},(e,n)=>(n-e)/Ti)}const rl=Je(0),kr=Je(1),Kd=Je(2),Zd=Je(3),wn=Je(4),Gd=Je(5),jd=Je(6);rl.range;kr.range;Kd.range;Zd.range;wn.range;Gd.range;jd.range;const Yn=Bt(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12,t=>t.getMonth());Yn.range;const Jd=Bt(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());Jd.range;const Le=Bt(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());Le.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:Bt(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,n)=>{e.setFullYear(e.getFullYear()+n*t)});Le.range;const Ge=Bt(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());Ge.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:Bt(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCFullYear(e.getUTCFullYear()+n*t)});Ge.range;function Qd(t,e,n,r,i,o){const a=[[ln,1,Se],[ln,5,5*Se],[ln,15,15*Se],[ln,30,30*Se],[o,1,de],[o,5,5*de],[o,15,15*de],[o,30,30*de],[i,1,Ne],[i,3,3*Ne],[i,6,6*Ne],[i,12,12*Ne],[r,1,Ee],[r,2,2*Ee],[n,1,Ti],[e,1,oo],[e,3,3*oo],[t,1,Pr]];function l(s,c,d){const f=c<s;f&&([s,c]=[c,s]);const h=d&&typeof d.range=="function"?d:u(s,c,d),g=h?h.range(s,+c+1):[];return f?g.reverse():g}function u(s,c,d){const f=Math.abs(c-s)/d,h=hi(([,,v])=>v).right(a,f);if(h===a.length)return t.every(jr(s/Pr,c/Pr,d));if(h===0)return wr.every(Math.max(jr(s,c,d),1));const[g,y]=a[f/a[h-1][2]<a[h][2]/f?h-1:h];return g.every(y)}return[l,u]}const[th,eh]=Qd(Le,Yn,Dr,Xn,zi,Ci);function Yr(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Wr(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Sn(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function nh(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,o=t.days,a=t.shortDays,l=t.months,u=t.shortMonths,s=Nn(i),c=Dn(i),d=Nn(o),f=Dn(o),h=Nn(a),g=Dn(a),y=Nn(l),v=Dn(l),T=Nn(u),D=Dn(u),M={a:Z,A:q,b:et,B:Dt,c:null,d:fo,e:fo,f:Ch,g:Ih,G:Rh,H:xh,I:kh,j:Th,L:il,m:zh,M:Mh,p:ct,q:nt,Q:go,s:mo,S:Ah,u:Sh,U:Nh,V:Dh,w:$h,W:Eh,x:null,X:null,y:Lh,Y:Fh,Z:Hh,"%":po},C={a:V,A:bt,b:kt,B:ut,c:null,d:ho,e:ho,f:Yh,g:Jh,G:tp,H:Uh,I:Oh,j:Ph,L:al,m:Wh,M:Bh,p:at,q:st,Q:go,s:mo,S:qh,u:Vh,U:Xh,V:Kh,w:Zh,W:Gh,x:null,X:null,y:jh,Y:Qh,Z:ep,"%":po},b={a:m,A:N,b:R,B:E,c:w,d:uo,e:uo,f:_h,g:so,G:lo,H:co,I:co,j:ph,L:yh,m:hh,M:gh,p:z,q:dh,Q:bh,s:wh,S:mh,u:lh,U:sh,V:uh,w:ah,W:ch,x:tt,X:Y,y:so,Y:lo,Z:fh,"%":vh};M.x=A(n,M),M.X=A(r,M),M.c=A(e,M),C.x=A(n,C),C.X=A(r,C),C.c=A(e,C);function A(x,W){return function(ft){var $=[],O=-1,G=0,K=x.length,U,B,I;for(ft instanceof Date||(ft=new Date(+ft));++O<K;)x.charCodeAt(O)===37&&($.push(x.slice(G,O)),(B=ao[U=x.charAt(++O)])!=null?U=x.charAt(++O):B=U==="e"?" ":"0",(I=W[U])&&(U=I(ft,B)),$.push(U),G=O+1);return $.push(x.slice(G,O)),$.join("")}}function k(x,W){return function(ft){var $=Sn(1900,void 0,1),O=L($,x,ft+="",0),G,K;if(O!=ft.length)return null;if("Q"in $)return new Date($.Q);if("s"in $)return new Date($.s*1e3+("L"in $?$.L:0));if(W&&!("Z"in $)&&($.Z=0),"p"in $&&($.H=$.H%12+$.p*12),$.m===void 0&&($.m="q"in $?$.q:0),"V"in $){if($.V<1||$.V>53)return null;"w"in $||($.w=1),"Z"in $?(G=Wr(Sn($.y,0,1)),K=G.getUTCDay(),G=K>4||K===0?kr.ceil(G):kr(G),G=Mi.offset(G,($.V-1)*7),$.y=G.getUTCFullYear(),$.m=G.getUTCMonth(),$.d=G.getUTCDate()+($.w+6)%7):(G=Yr(Sn($.y,0,1)),K=G.getDay(),G=K>4||K===0?xr.ceil(G):xr(G),G=Xn.offset(G,($.V-1)*7),$.y=G.getFullYear(),$.m=G.getMonth(),$.d=G.getDate()+($.w+6)%7)}else("W"in $||"U"in $)&&("w"in $||($.w="u"in $?$.u%7:"W"in $?1:0),K="Z"in $?Wr(Sn($.y,0,1)).getUTCDay():Yr(Sn($.y,0,1)).getDay(),$.m=0,$.d="W"in $?($.w+6)%7+$.W*7-(K+5)%7:$.w+$.U*7-(K+6)%7);return"Z"in $?($.H+=$.Z/100|0,$.M+=$.Z%100,Wr($)):Yr($)}}function L(x,W,ft,$){for(var O=0,G=W.length,K=ft.length,U,B;O<G;){if($>=K)return-1;if(U=W.charCodeAt(O++),U===37){if(U=W.charAt(O++),B=b[U in ao?W.charAt(O++):U],!B||($=B(x,ft,$))<0)return-1}else if(U!=ft.charCodeAt($++))return-1}return $}function z(x,W,ft){var $=s.exec(W.slice(ft));return $?(x.p=c.get($[0].toLowerCase()),ft+$[0].length):-1}function m(x,W,ft){var $=h.exec(W.slice(ft));return $?(x.w=g.get($[0].toLowerCase()),ft+$[0].length):-1}function N(x,W,ft){var $=d.exec(W.slice(ft));return $?(x.w=f.get($[0].toLowerCase()),ft+$[0].length):-1}function R(x,W,ft){var $=T.exec(W.slice(ft));return $?(x.m=D.get($[0].toLowerCase()),ft+$[0].length):-1}function E(x,W,ft){var $=y.exec(W.slice(ft));return $?(x.m=v.get($[0].toLowerCase()),ft+$[0].length):-1}function w(x,W,ft){return L(x,e,W,ft)}function tt(x,W,ft){return L(x,n,W,ft)}function Y(x,W,ft){return L(x,r,W,ft)}function Z(x){return a[x.getDay()]}function q(x){return o[x.getDay()]}function et(x){return u[x.getMonth()]}function Dt(x){return l[x.getMonth()]}function ct(x){return i[+(x.getHours()>=12)]}function nt(x){return 1+~~(x.getMonth()/3)}function V(x){return a[x.getUTCDay()]}function bt(x){return o[x.getUTCDay()]}function kt(x){return u[x.getUTCMonth()]}function ut(x){return l[x.getUTCMonth()]}function at(x){return i[+(x.getUTCHours()>=12)]}function st(x){return 1+~~(x.getUTCMonth()/3)}return{format:function(x){var W=A(x+="",M);return W.toString=function(){return x},W},parse:function(x){var W=k(x+="",!1);return W.toString=function(){return x},W},utcFormat:function(x){var W=A(x+="",C);return W.toString=function(){return x},W},utcParse:function(x){var W=k(x+="",!0);return W.toString=function(){return x},W}}}var ao={"-":"",_:" ",0:"0"},qt=/^\s*\d+/,rh=/^%/,ih=/[\\^$*+?|[\]().{}]/g;function Ut(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(e)+i:i)}function oh(t){return t.replace(ih,"\\$&")}function Nn(t){return new RegExp("^(?:"+t.map(oh).join("|")+")","i")}function Dn(t){return new Map(t.map((e,n)=>[e.toLowerCase(),n]))}function ah(t,e,n){var r=qt.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function lh(t,e,n){var r=qt.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function sh(t,e,n){var r=qt.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function uh(t,e,n){var r=qt.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function ch(t,e,n){var r=qt.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function lo(t,e,n){var r=qt.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function so(t,e,n){var r=qt.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function fh(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function dh(t,e,n){var r=qt.exec(e.slice(n,n+1));return r?(t.q=r[0]*3-3,n+r[0].length):-1}function hh(t,e,n){var r=qt.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function uo(t,e,n){var r=qt.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function ph(t,e,n){var r=qt.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function co(t,e,n){var r=qt.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function gh(t,e,n){var r=qt.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function mh(t,e,n){var r=qt.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function yh(t,e,n){var r=qt.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function _h(t,e,n){var r=qt.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function vh(t,e,n){var r=rh.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function bh(t,e,n){var r=qt.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function wh(t,e,n){var r=qt.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function fo(t,e){return Ut(t.getDate(),e,2)}function xh(t,e){return Ut(t.getHours(),e,2)}function kh(t,e){return Ut(t.getHours()%12||12,e,2)}function Th(t,e){return Ut(1+Xn.count(Le(t),t),e,3)}function il(t,e){return Ut(t.getMilliseconds(),e,3)}function Ch(t,e){return il(t,e)+"000"}function zh(t,e){return Ut(t.getMonth()+1,e,2)}function Mh(t,e){return Ut(t.getMinutes(),e,2)}function Ah(t,e){return Ut(t.getSeconds(),e,2)}function Sh(t){var e=t.getDay();return e===0?7:e}function Nh(t,e){return Ut(Dr.count(Le(t)-1,t),e,2)}function ol(t){var e=t.getDay();return e>=4||e===0?bn(t):bn.ceil(t)}function Dh(t,e){return t=ol(t),Ut(bn.count(Le(t),t)+(Le(t).getDay()===4),e,2)}function $h(t){return t.getDay()}function Eh(t,e){return Ut(xr.count(Le(t)-1,t),e,2)}function Lh(t,e){return Ut(t.getFullYear()%100,e,2)}function Ih(t,e){return t=ol(t),Ut(t.getFullYear()%100,e,2)}function Fh(t,e){return Ut(t.getFullYear()%1e4,e,4)}function Rh(t,e){var n=t.getDay();return t=n>=4||n===0?bn(t):bn.ceil(t),Ut(t.getFullYear()%1e4,e,4)}function Hh(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Ut(e/60|0,"0",2)+Ut(e%60,"0",2)}function ho(t,e){return Ut(t.getUTCDate(),e,2)}function Uh(t,e){return Ut(t.getUTCHours(),e,2)}function Oh(t,e){return Ut(t.getUTCHours()%12||12,e,2)}function Ph(t,e){return Ut(1+Mi.count(Ge(t),t),e,3)}function al(t,e){return Ut(t.getUTCMilliseconds(),e,3)}function Yh(t,e){return al(t,e)+"000"}function Wh(t,e){return Ut(t.getUTCMonth()+1,e,2)}function Bh(t,e){return Ut(t.getUTCMinutes(),e,2)}function qh(t,e){return Ut(t.getUTCSeconds(),e,2)}function Vh(t){var e=t.getUTCDay();return e===0?7:e}function Xh(t,e){return Ut(rl.count(Ge(t)-1,t),e,2)}function ll(t){var e=t.getUTCDay();return e>=4||e===0?wn(t):wn.ceil(t)}function Kh(t,e){return t=ll(t),Ut(wn.count(Ge(t),t)+(Ge(t).getUTCDay()===4),e,2)}function Zh(t){return t.getUTCDay()}function Gh(t,e){return Ut(kr.count(Ge(t)-1,t),e,2)}function jh(t,e){return Ut(t.getUTCFullYear()%100,e,2)}function Jh(t,e){return t=ll(t),Ut(t.getUTCFullYear()%100,e,2)}function Qh(t,e){return Ut(t.getUTCFullYear()%1e4,e,4)}function tp(t,e){var n=t.getUTCDay();return t=n>=4||n===0?wn(t):wn.ceil(t),Ut(t.getUTCFullYear()%1e4,e,4)}function ep(){return"+0000"}function po(){return"%"}function go(t){return+t}function mo(t){return Math.floor(+t/1e3)}var nn,sn;np({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function np(t){return nn=nh(t),sn=nn.format,nn.parse,nn.utcFormat,nn.utcParse,nn}function rp(t){return new Date(t)}function ip(t){return t instanceof Date?+t:+new Date(+t)}function sl(t,e,n,r,i,o,a,l,u,s){var c=nl(),d=c.invert,f=c.domain,h=s(".%L"),g=s(":%S"),y=s("%I:%M"),v=s("%I %p"),T=s("%a %d"),D=s("%b %d"),M=s("%B"),C=s("%Y");function b(A){return(u(A)<A?h:l(A)<A?g:a(A)<A?y:o(A)<A?v:r(A)<A?i(A)<A?T:D:n(A)<A?M:C)(A)}return c.invert=function(A){return new Date(d(A))},c.domain=function(A){return arguments.length?f(Array.from(A,ip)):f().map(rp)},c.ticks=function(A){var k=f();return t(k[0],k[k.length-1],A??10)},c.tickFormat=function(A,k){return k==null?b:s(k)},c.nice=function(A){var k=f();return(!A||typeof A.range!="function")&&(A=e(k[0],k[k.length-1],A??10)),A?f(Od(k,A)):c},c.copy=function(){return el(c,sl(t,e,n,r,i,o,a,l,u,s))},c}function op(){return Nr.apply(sl(th,eh,Le,Yn,Dr,Xn,zi,Ci,ln,sn).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function ul(t){for(var e=t.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+t.slice(r*6,++r*6);return n}const xn=ul("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),ap=ul("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f");function Pt(t){return function(){return t}}const yo=Math.abs,Jt=Math.atan2,Pe=Math.cos,lp=Math.max,Br=Math.min,we=Math.sin,un=Math.sqrt,ie=1e-12,Wn=Math.PI,Tr=Wn/2,or=2*Wn;function sp(t){return t>1?0:t<-1?Wn:Math.acos(t)}function _o(t){return t>=1?Tr:t<=-1?-Tr:Math.asin(t)}function cl(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(n==null)e=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);e=r}return t},()=>new Xf(e)}function up(t){return t.innerRadius}function cp(t){return t.outerRadius}function fp(t){return t.startAngle}function dp(t){return t.endAngle}function hp(t){return t&&t.padAngle}function pp(t,e,n,r,i,o,a,l){var u=n-t,s=r-e,c=a-i,d=l-o,f=d*u-c*s;if(!(f*f<ie))return f=(c*(e-o)-d*(t-i))/f,[t+f*u,e+f*s]}function Jn(t,e,n,r,i,o,a){var l=t-n,u=e-r,s=(a?o:-o)/un(l*l+u*u),c=s*u,d=-s*l,f=t+c,h=e+d,g=n+c,y=r+d,v=(f+g)/2,T=(h+y)/2,D=g-f,M=y-h,C=D*D+M*M,b=i-o,A=f*y-g*h,k=(M<0?-1:1)*un(lp(0,b*b*C-A*A)),L=(A*M-D*k)/C,z=(-A*D-M*k)/C,m=(A*M+D*k)/C,N=(-A*D+M*k)/C,R=L-v,E=z-T,w=m-v,tt=N-T;return R*R+E*E>w*w+tt*tt&&(L=m,z=N),{cx:L,cy:z,x01:-c,y01:-d,x11:L*(i/b-1),y11:z*(i/b-1)}}function vo(){var t=up,e=cp,n=Pt(0),r=null,i=fp,o=dp,a=hp,l=null,u=cl(s);function s(){var c,d,f=+t.apply(this,arguments),h=+e.apply(this,arguments),g=i.apply(this,arguments)-Tr,y=o.apply(this,arguments)-Tr,v=yo(y-g),T=y>g;if(l||(l=c=u()),h<f&&(d=h,h=f,f=d),!(h>ie))l.moveTo(0,0);else if(v>or-ie)l.moveTo(h*Pe(g),h*we(g)),l.arc(0,0,h,g,y,!T),f>ie&&(l.moveTo(f*Pe(y),f*we(y)),l.arc(0,0,f,y,g,T));else{var D=g,M=y,C=g,b=y,A=v,k=v,L=a.apply(this,arguments)/2,z=L>ie&&(r?+r.apply(this,arguments):un(f*f+h*h)),m=Br(yo(h-f)/2,+n.apply(this,arguments)),N=m,R=m,E,w;if(z>ie){var tt=_o(z/f*we(L)),Y=_o(z/h*we(L));(A-=tt*2)>ie?(tt*=T?1:-1,C+=tt,b-=tt):(A=0,C=b=(g+y)/2),(k-=Y*2)>ie?(Y*=T?1:-1,D+=Y,M-=Y):(k=0,D=M=(g+y)/2)}var Z=h*Pe(D),q=h*we(D),et=f*Pe(b),Dt=f*we(b);if(m>ie){var ct=h*Pe(M),nt=h*we(M),V=f*Pe(C),bt=f*we(C),kt;if(v<Wn)if(kt=pp(Z,q,V,bt,ct,nt,et,Dt)){var ut=Z-kt[0],at=q-kt[1],st=ct-kt[0],x=nt-kt[1],W=1/we(sp((ut*st+at*x)/(un(ut*ut+at*at)*un(st*st+x*x)))/2),ft=un(kt[0]*kt[0]+kt[1]*kt[1]);N=Br(m,(f-ft)/(W-1)),R=Br(m,(h-ft)/(W+1))}else N=R=0}k>ie?R>ie?(E=Jn(V,bt,Z,q,h,R,T),w=Jn(ct,nt,et,Dt,h,R,T),l.moveTo(E.cx+E.x01,E.cy+E.y01),R<m?l.arc(E.cx,E.cy,R,Jt(E.y01,E.x01),Jt(w.y01,w.x01),!T):(l.arc(E.cx,E.cy,R,Jt(E.y01,E.x01),Jt(E.y11,E.x11),!T),l.arc(0,0,h,Jt(E.cy+E.y11,E.cx+E.x11),Jt(w.cy+w.y11,w.cx+w.x11),!T),l.arc(w.cx,w.cy,R,Jt(w.y11,w.x11),Jt(w.y01,w.x01),!T))):(l.moveTo(Z,q),l.arc(0,0,h,D,M,!T)):l.moveTo(Z,q),!(f>ie)||!(A>ie)?l.lineTo(et,Dt):N>ie?(E=Jn(et,Dt,ct,nt,f,-N,T),w=Jn(Z,q,V,bt,f,-N,T),l.lineTo(E.cx+E.x01,E.cy+E.y01),N<m?l.arc(E.cx,E.cy,N,Jt(E.y01,E.x01),Jt(w.y01,w.x01),!T):(l.arc(E.cx,E.cy,N,Jt(E.y01,E.x01),Jt(E.y11,E.x11),!T),l.arc(0,0,f,Jt(E.cy+E.y11,E.cx+E.x11),Jt(w.cy+w.y11,w.cx+w.x11),T),l.arc(w.cx,w.cy,N,Jt(w.y11,w.x11),Jt(w.y01,w.x01),!T))):l.arc(0,0,f,b,C,T)}if(l.closePath(),c)return l=null,c+""||null}return s.centroid=function(){var c=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,d=(+i.apply(this,arguments)+ +o.apply(this,arguments))/2-Wn/2;return[Pe(d)*c,we(d)*c]},s.innerRadius=function(c){return arguments.length?(t=typeof c=="function"?c:Pt(+c),s):t},s.outerRadius=function(c){return arguments.length?(e=typeof c=="function"?c:Pt(+c),s):e},s.cornerRadius=function(c){return arguments.length?(n=typeof c=="function"?c:Pt(+c),s):n},s.padRadius=function(c){return arguments.length?(r=c==null?null:typeof c=="function"?c:Pt(+c),s):r},s.startAngle=function(c){return arguments.length?(i=typeof c=="function"?c:Pt(+c),s):i},s.endAngle=function(c){return arguments.length?(o=typeof c=="function"?c:Pt(+c),s):o},s.padAngle=function(c){return arguments.length?(a=typeof c=="function"?c:Pt(+c),s):a},s.context=function(c){return arguments.length?(l=c??null,s):l},s}function Ai(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function fl(t){this._context=t}fl.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function gp(t){return new fl(t)}function mp(t){return t[0]}function yp(t){return t[1]}function bo(t,e){var n=Pt(!0),r=null,i=gp,o=null,a=cl(l);t=typeof t=="function"?t:t===void 0?mp:Pt(t),e=typeof e=="function"?e:e===void 0?yp:Pt(e);function l(u){var s,c=(u=Ai(u)).length,d,f=!1,h;for(r==null&&(o=i(h=a())),s=0;s<=c;++s)!(s<c&&n(d=u[s],s,u))===f&&((f=!f)?o.lineStart():o.lineEnd()),f&&o.point(+t(d,s,u),+e(d,s,u));if(h)return o=null,h+""||null}return l.x=function(u){return arguments.length?(t=typeof u=="function"?u:Pt(+u),l):t},l.y=function(u){return arguments.length?(e=typeof u=="function"?u:Pt(+u),l):e},l.defined=function(u){return arguments.length?(n=typeof u=="function"?u:Pt(!!u),l):n},l.curve=function(u){return arguments.length?(i=u,r!=null&&(o=i(r)),l):i},l.context=function(u){return arguments.length?(u==null?r=o=null:o=i(r=u),l):r},l}function _p(t,e){return e<t?-1:e>t?1:e>=t?0:NaN}function vp(t){return t}function bp(){var t=vp,e=_p,n=null,r=Pt(0),i=Pt(or),o=Pt(0);function a(l){var u,s=(l=Ai(l)).length,c,d,f=0,h=new Array(s),g=new Array(s),y=+r.apply(this,arguments),v=Math.min(or,Math.max(-or,i.apply(this,arguments)-y)),T,D=Math.min(Math.abs(v)/s,o.apply(this,arguments)),M=D*(v<0?-1:1),C;for(u=0;u<s;++u)(C=g[h[u]=u]=+t(l[u],u,l))>0&&(f+=C);for(e!=null?h.sort(function(b,A){return e(g[b],g[A])}):n!=null&&h.sort(function(b,A){return n(l[b],l[A])}),u=0,d=f?(v-s*M)/f:0;u<s;++u,y=T)c=h[u],C=g[c],T=y+(C>0?C*d:0)+M,g[c]={data:l[c],index:u,value:C,startAngle:y,endAngle:T,padAngle:D};return g}return a.value=function(l){return arguments.length?(t=typeof l=="function"?l:Pt(+l),a):t},a.sortValues=function(l){return arguments.length?(e=l,n=null,a):e},a.sort=function(l){return arguments.length?(n=l,e=null,a):n},a.startAngle=function(l){return arguments.length?(r=typeof l=="function"?l:Pt(+l),a):r},a.endAngle=function(l){return arguments.length?(i=typeof l=="function"?l:Pt(+l),a):i},a.padAngle=function(l){return arguments.length?(o=typeof l=="function"?l:Pt(+l),a):o},a}function wo(t){return t<0?-1:1}function xo(t,e,n){var r=t._x1-t._x0,i=e-t._x1,o=(t._y1-t._y0)/(r||i<0&&-0),a=(n-t._y1)/(i||r<0&&-0),l=(o*i+a*r)/(r+i);return(wo(o)+wo(a))*Math.min(Math.abs(o),Math.abs(a),.5*Math.abs(l))||0}function ko(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function qr(t,e,n){var r=t._x0,i=t._y0,o=t._x1,a=t._y1,l=(o-r)/3;t._context.bezierCurveTo(r+l,i+l*e,o-l,a-l*n,o,a)}function Cr(t){this._context=t}Cr.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:qr(this,this._t0,ko(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,qr(this,ko(this,n=xo(this,t,e)),n);break;default:qr(this,this._t0,n=xo(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}};Object.create(Cr.prototype).point=function(t,e){Cr.prototype.point.call(this,e,t)};function To(t){return new Cr(t)}function Co(t,e){if((a=t.length)>1)for(var n=1,r,i,o=t[e[0]],a,l=o.length;n<a;++n)for(i=o,o=t[e[n]],r=0;r<l;++r)o[r][1]+=o[r][0]=isNaN(i[r][1])?i[r][0]:i[r][1]}function zo(t){for(var e=t.length,n=new Array(e);--e>=0;)n[e]=e;return n}function wp(t,e){return t[e]}function xp(t){const e=[];return e.key=t,e}function kp(){var t=Pt([]),e=zo,n=Co,r=wp;function i(o){var a=Array.from(t.apply(this,arguments),xp),l,u=a.length,s=-1,c;for(const d of o)for(l=0,++s;l<u;++l)(a[l][s]=[0,+r(d,a[l].key,s,o)]).data=d;for(l=0,c=Ai(e(a));l<u;++l)a[c[l]].index=l;return n(a,c),a}return i.keys=function(o){return arguments.length?(t=typeof o=="function"?o:Pt(Array.from(o)),i):t},i.value=function(o){return arguments.length?(r=typeof o=="function"?o:Pt(+o),i):r},i.order=function(o){return arguments.length?(e=o==null?zo:typeof o=="function"?o:Pt(Array.from(o)),i):e},i.offset=function(o){return arguments.length?(n=o??Co,i):n},i}function In(t,e,n){this.k=t,this.x=e,this.y=n}In.prototype={constructor:In,scale:function(t){return t===1?this:new In(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new In(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};In.prototype;function Tp(t){const e=t-1;return e*e*e+1}function Mo(t,{delay:e=0,duration:n=400,easing:r=Tp,axis:i="y"}={}){const o=getComputedStyle(t),a=+o.opacity,l=i==="y"?"height":"width",u=parseFloat(o[l]),s=i==="y"?["top","bottom"]:["left","right"],c=s.map(T=>`${T[0].toUpperCase()}${T.slice(1)}`),d=parseFloat(o[`padding${c[0]}`]),f=parseFloat(o[`padding${c[1]}`]),h=parseFloat(o[`margin${c[0]}`]),g=parseFloat(o[`margin${c[1]}`]),y=parseFloat(o[`border${c[0]}Width`]),v=parseFloat(o[`border${c[1]}Width`]);return{delay:e,duration:n,easing:r,css:T=>`overflow: hidden;opacity: ${Math.min(T*20,1)*a};${l}: ${T*u}px;padding-${s[0]}: ${T*d}px;padding-${s[1]}: ${T*f}px;margin-${s[0]}: ${T*h}px;margin-${s[1]}: ${T*g}px;border-${s[0]}-width: ${T*y}px;border-${s[1]}-width: ${T*v}px;`}}function Cp(t){let e;return{c(){e=H(t[7])},m(n,r){Q(n,e,r)},p(n,r){r&128&&ot(e,n[7])},d(n){n&&J(e)}}}function zp(t){let e,n;return{c(){e=new wl(!1),n=fa(),e.a=n},m(r,i){e.m(t[5],r,i),Q(r,n,i)},p(r,i){i&32&&e.p(r[5])},d(r){r&&J(n),r&&e.d()}}}function Ao(t){let e,n,r=(t[0]?it("ui.hide_description"):it("ui.show_description"))+"",i,o,a,l,u,s;return{c(){e=S("button"),n=S("span"),i=H(r),o=ht(),a=ne("svg"),l=ne("path"),_(n,"class","sr-only svelte-1o4uev"),_(l,"d","M5 7.5L10 12.5L15 7.5"),_(l,"stroke","currentColor"),_(l,"stroke-width","2"),_(l,"stroke-linecap","round"),_(l,"stroke-linejoin","round"),_(a,"class","accordion-icon svelte-1o4uev"),_(a,"width","20"),_(a,"height","20"),_(a,"viewBox","0 0 20 20"),_(a,"fill","none"),_(a,"xmlns","http://www.w3.org/2000/svg"),Ue(a,"open",t[0]),_(e,"class","accordion-toggle svelte-1o4uev"),_(e,"aria-expanded",t[0]),_(e,"aria-controls","description-panel")},m(c,d){Q(c,e,d),p(e,n),p(n,i),p(e,o),p(e,a),p(a,l),u||(s=[Qt(e,"click",t[8]),Qt(e,"keydown",t[9])],u=!0)},p(c,d){d&1&&r!==(r=(c[0]?it("ui.hide_description"):it("ui.show_description"))+"")&&ot(i,r),d&1&&Ue(a,"open",c[0]),d&1&&_(e,"aria-expanded",c[0])},d(c){c&&J(e),u=!1,le(s)}}}function So(t){let e,n,r=t[0]&&No(t);return{c(){e=S("div"),r&&r.c(),_(e,"class","description-panel-wrapper svelte-1o4uev")},m(i,o){Q(i,e,o),r&&r.m(e,null),n=!0},p(i,o){i[0]?r?(r.p(i,o),o&1&&Ot(r,1)):(r=No(i),r.c(),Ot(r,1),r.m(e,null)):r&&(ci(),Yt(r,1,1,()=>{r=null}),fi())},i(i){n||(Ot(r),n=!0)},o(i){Yt(r),n=!1},d(i){i&&J(e),r&&r.d()}}}function No(t){let e,n,r,i,o;return{c(){e=S("div"),n=S("p"),r=H(t[6]),_(n,"class","svelte-1o4uev"),_(e,"id","description-panel"),_(e,"class","description-panel svelte-1o4uev")},m(a,l){Q(a,e,l),p(e,n),p(n,r),o=!0},p(a,l){(!o||l&64)&&ot(r,a[6])},i(a){o||(Xe(()=>{o&&(i||(i=$i(e,Mo,{duration:300},!0)),i.run(1))}),o=!0)},o(a){i||(i=$i(e,Mo,{duration:300},!1)),i.run(0),o=!1},d(a){a&&J(e),a&&i&&i.end()}}}function Mp(t){let e,n,r,i,o,a;function l(f,h){if(f[5])return zp;if(f[2]||f[1])return Cp}let u=l(t),s=u&&u(t),c=(t[3]||t[4])&&Ao(t),d=(t[3]||t[4])&&So(t);return{c(){e=S("div"),n=S("div"),r=S("h2"),s&&s.c(),i=ht(),c&&c.c(),o=ht(),d&&d.c(),_(r,"class","visualization-title svelte-1o4uev"),_(n,"class","title-container svelte-1o4uev"),_(e,"class","visualization-header svelte-1o4uev"),Ue(e,"has-description",t[0])},m(f,h){Q(f,e,h),p(e,n),p(n,r),s&&s.m(r,null),p(n,i),c&&c.m(n,null),p(e,o),d&&d.m(e,null),a=!0},p(f,[h]){u===(u=l(f))&&s?s.p(f,h):(s&&s.d(1),s=u&&u(f),s&&(s.c(),s.m(r,null))),f[3]||f[4]?c?c.p(f,h):(c=Ao(f),c.c(),c.m(n,null)):c&&(c.d(1),c=null),f[3]||f[4]?d?(d.p(f,h),h&24&&Ot(d,1)):(d=So(f),d.c(),Ot(d,1),d.m(e,null)):d&&(ci(),Yt(d,1,1,()=>{d=null}),fi()),(!a||h&1)&&Ue(e,"has-description",f[0])},i(f){a||(Ot(d),a=!0)},o(f){Yt(d),a=!1},d(f){f&&J(e),s&&s.d(),c&&c.d(),d&&d.d()}}}function Ap(t,e,n){let r,i,{title:o}=e,{translationKey:a=""}=e,{description:l=""}=e,{showDescription:u=!1}=e,{descriptionTranslationKey:s=""}=e,{titleHtml:c=""}=e;function d(){n(0,u=!u)}const f=h=>h.key==="Enter"&&d();return t.$$set=h=>{"title"in h&&n(1,o=h.title),"translationKey"in h&&n(2,a=h.translationKey),"description"in h&&n(3,l=h.description),"showDescription"in h&&n(0,u=h.showDescription),"descriptionTranslationKey"in h&&n(4,s=h.descriptionTranslationKey),"titleHtml"in h&&n(5,c=h.titleHtml)},t.$$.update=()=>{t.$$.dirty&6&&n(7,r=a?it(a):o),t.$$.dirty&24&&n(6,i=s?it(s):l)},[u,o,a,l,s,c,i,r,d,f]}class Sp extends pe{constructor(e){super(),he(this,e,Ap,Mp,ce,{title:1,translationKey:2,description:3,showDescription:0,descriptionTranslationKey:4,titleHtml:5})}}function Np(t){let e;return{c(){e=S("div"),e.textContent=`${it("ui.no_visualization_content")}`,_(e,"class","no-content svelte-1cq0dtf")},m(n,r){Q(n,e,r)},p:Ft,d(n){n&&J(e)}}}function Dp(t){let e,n=t[11].error+"",r;return{c(){e=S("div"),r=H(n),_(e,"class","error svelte-1cq0dtf"),_(e,"role","alert")},m(i,o){Q(i,e,o),p(e,r)},p(i,o){o&2048&&n!==(n=i[11].error+"")&&ot(r,n)},d(i){i&&J(e)}}}function $p(t){let e;return{c(){e=S("div"),e.textContent=`${it("ui.loading")}`,_(e,"class","loading svelte-1cq0dtf")},m(n,r){Q(n,e,r)},p:Ft,d(n){n&&J(e)}}}function Ep(t){let e;function n(o,a){return o[11].loading?$p:o[11].error?Dp:Np}let r=n(t),i=r(t);return{c(){e=S("div"),i.c(),_(e,"class","empty-visualization svelte-1cq0dtf"),_(e,"aria-live","polite"),_(e,"style",t[10])},m(o,a){Q(o,e,a),i.m(e,null)},p(o,a){r===(r=n(o))&&i?i.p(o,a):(i.d(1),i=r(o),i&&(i.c(),i.m(e,null))),a&1024&&_(e,"style",o[10])},d(o){o&&J(e),i.d()}}}function Lp(t){let e,n,r,i,o,a,l,u;function s(g){t[19](g)}let c={title:t[1],translationKey:t[2],description:t[3],descriptionTranslationKey:t[4],titleHtml:t[5]};t[0]!==void 0&&(c.showDescription=t[0]),n=new Sp({props:c}),ke.push(()=>El(n,"showDescription",s));const d=t[18].default,f=ra(d,t,t[17],null),h=f||Ep(t);return{c(){e=S("div"),te(n.$$.fragment),i=ht(),o=S("div"),h&&h.c(),_(o,"class","visualization-content svelte-1cq0dtf"),_(o,"role","presentation"),_(e,"class",a="visualization-wrapper "+t[7]+" "+t[8]+" svelte-1cq0dtf"),_(e,"role","region"),_(e,"aria-label",l=t[6]||t[1])},m(g,y){Q(g,e,y),Gt(n,e,null),p(e,i),p(e,o),h&&h.m(o,null),t[20](o),u=!0},p(g,[y]){const v={};y&2&&(v.title=g[1]),y&4&&(v.translationKey=g[2]),y&8&&(v.description=g[3]),y&16&&(v.descriptionTranslationKey=g[4]),y&32&&(v.titleHtml=g[5]),!r&&y&1&&(r=!0,v.showDescription=g[0],Al(()=>r=!1)),n.$set(v),f?f.p&&(!u||y&131072)&&aa(f,d,g,g[17],u?oa(d,g[17],y,null):la(g[17]),null):h&&h.p&&(!u||y&3072)&&h.p(g,u?y:-1),(!u||y&384&&a!==(a="visualization-wrapper "+g[7]+" "+g[8]+" svelte-1cq0dtf"))&&_(e,"class",a),(!u||y&66&&l!==(l=g[6]||g[1]))&&_(e,"aria-label",l)},i(g){u||(Ot(n.$$.fragment,g),Ot(h,g),u=!0)},o(g){Yt(n.$$.fragment,g),Yt(h,g),u=!1},d(g){g&&J(e),jt(n),h&&h.d(g),t[20](null)}}}function Ip(t,e,n){let r,i;vt(t,Kt,m=>n(11,i=m));let{$$slots:o={},$$scope:a}=e,{title:l}=e,{translationKey:u=""}=e,{description:s=""}=e,{descriptionTranslationKey:c=""}=e,{showDescription:d=!1}=e,{titleHtml:f=""}=e,{ariaLabel:h=""}=e,{enableResizeObserver:g=!0}=e,y,v;const T=zl();let{theme:D="default"}=e,{customBackground:M=""}=e,{customTextColor:C=""}=e,{minHeight:b="400px"}=e,{padding:A="var(--spacing-md)"}=e,{className:k=""}=e;Te(()=>{g&&y&&(v=new ResizeObserver(m=>{const N=m[0];if(N){const{width:R,height:E}=N.contentRect;T("resize",{width:R,height:E})}}),v.observe(y))}),Bn(()=>{v&&y&&(v.unobserve(y),v.disconnect())});function L(m){d=m,n(0,d)}function z(m){ke[m?"unshift":"push"](()=>{y=m,n(9,y)})}return t.$$set=m=>{"title"in m&&n(1,l=m.title),"translationKey"in m&&n(2,u=m.translationKey),"description"in m&&n(3,s=m.description),"descriptionTranslationKey"in m&&n(4,c=m.descriptionTranslationKey),"showDescription"in m&&n(0,d=m.showDescription),"titleHtml"in m&&n(5,f=m.titleHtml),"ariaLabel"in m&&n(6,h=m.ariaLabel),"enableResizeObserver"in m&&n(12,g=m.enableResizeObserver),"theme"in m&&n(7,D=m.theme),"customBackground"in m&&n(13,M=m.customBackground),"customTextColor"in m&&n(14,C=m.customTextColor),"minHeight"in m&&n(15,b=m.minHeight),"padding"in m&&n(16,A=m.padding),"className"in m&&n(8,k=m.className),"$$scope"in m&&n(17,a=m.$$scope)},t.$$.update=()=>{t.$$.dirty&122880&&n(10,r=`
        min-height: ${b};
        padding: ${A};
        ${M?`background: ${M};`:""}
        ${C?`color: ${C};`:""}
    `)},[d,l,u,s,c,f,h,D,k,y,r,i,g,M,C,b,A,a,o,L,z]}class Tn extends pe{constructor(e){super(),he(this,e,Ip,Lp,ce,{title:1,translationKey:2,description:3,descriptionTranslationKey:4,showDescription:0,titleHtml:5,ariaLabel:6,enableResizeObserver:12,theme:7,customBackground:13,customTextColor:14,minHeight:15,padding:16,className:8})}}const cn={news_article:{id:"news_article",nameEn:"News article",nameFr:"Article de presse",description:"Newspaper and magazine articles"},islamic_periodical:{id:"islamic_periodical",nameEn:"Islamic periodical",nameFr:"Périodique islamique",description:"Islamic magazines and periodicals"},documents:{id:"documents",nameEn:"Documents",nameFr:"Documents divers",description:"Various documents"},photographs:{id:"photographs",nameEn:"Photographs",nameFr:"Photographies",description:"Photographs and images"},video_recording:{id:"video_recording",nameEn:"Video recording",nameFr:"Enregistrement vidéo",description:"Video recordings and footage"},references:{id:"references",nameEn:"References",nameFr:"Références",description:"Reference materials"},other:{id:"other",nameEn:"Other",nameFr:"Autre",description:"Uncategorized items"}},Fp={"24h au Bénin":"news_article","Agence Bénin Presse":"news_article",Banouto:"news_article","Bénin Intelligent":"news_article","Boulevard des Infos":"news_article","Daho-Express":"news_article",Ehuzu:"news_article",Fraternité:"news_article","L'Evénement Précis":"news_article","La Nation":"news_article","La Nouvelle Tribune":"news_article","Le Matinal":"news_article","Les Pharaons":"news_article","Matin Libre":"news_article","Burkina 24":"news_article","Carrefour africain":"news_article",FasoZine:"news_article","L'Evénement":"news_article","L'Observateur":"news_article","L'Observateur Paalga":"news_article","Le Pays":"news_article","LeFaso.net":"news_article",Mutations:"news_article","San Finna":"news_article",Sidwaya:"news_article","Agence Ivoirienne de Presse":"news_article","Fraternité Hebdo":"news_article","Fraternité Matin":"news_article","Ivoire Dimanche":"news_article","L'Alternative":"news_article","L'Intelligent d'Abidjan":"news_article","La Voie":"news_article","Le Jour":"news_article","Le Jour Plus":"news_article","Le Nouvel Horizon":"news_article","Le Patriote":"news_article","Notre Temps":"news_article","Notre Voie":"news_article","Le Sahel":"news_article","Agence Togolaise de Presse":"news_article","Atopani Express":"news_article","Courrier du Golfe":"news_article","Forum Hebdo":"news_article","La Lettre de Tchaoudjo":"news_article","La Nouvelle Marche":"news_article","Le Démocrate":"news_article","L'éveil du Peuple":"news_article","Togo-Presse":"news_article",ASSALAM:"islamic_periodical","Islam Hebdo":"islamic_periodical","Al Mawadda":"islamic_periodical","An-Nasr Trimestriel":"islamic_periodical","An-Nasr Vendredi":"islamic_periodical","L'Appel":"islamic_periodical","L'Autre Regard":"islamic_periodical","La Preuve":"islamic_periodical","Le CERFIste":"islamic_periodical","Le vrai visage de l'islam":"islamic_periodical","AJMCI Infos":"islamic_periodical","Al Minbar":"islamic_periodical","Al Muwassat Info":"islamic_periodical","Al-Azan":"islamic_periodical",Alif:"islamic_periodical","Allahou Akbar":"islamic_periodical","Bulletin d'information du CNI":"islamic_periodical","Islam Info":"islamic_periodical","Les Échos de l'AEEMCI":"islamic_periodical","Plume Libre":"islamic_periodical","Al Maoulid Info":"islamic_periodical","Al Maoulid Magazine":"islamic_periodical","Al Maoulid Magazine (arabe)":"islamic_periodical","Le Pacific":"islamic_periodical","Le Rendez-Vous":"islamic_periodical","Documents divers (Burkina Faso)":"documents","Documents divers (Bénin)":"documents","Documents divers (Côte d'Ivoire)":"documents","Documents divers (Niger)":"documents","Documents divers (Togo)":"documents","Photographies (Burkina Faso)":"photographs","Photographies (Bénin)":"photographs","Photographies (Côte d'Ivoire)":"photographs","Photographies (Niger)":"photographs","Photographies (Togo)":"photographs","Collection de sermons islamiques sur vidéo":"video_recording","Références (Bénin)":"references","Références (Burkina Faso)":"references","Références (Côte d'Ivoire)":"references","Références (Niger)":"references","Références (Nigéria)":"references","Références (Togo)":"references"};function Rp(t,e){const n=cn[t]||cn.other;return e==="fr"?n.nameFr:n.nameEn}function Hp(t){let e;return{c(){e=S("div"),e.textContent="Initializing visualization...",_(e,"class","loading svelte-nnbg8i")},m(n,r){Q(n,e,r)},p:Ft,d(n){n&&J(e)}}}function Up(t){let e,n;return{c(){e=S("div"),n=H(t[11]),_(e,"class","no-data svelte-nnbg8i")},m(r,i){Q(r,e,i),p(e,n)},p(r,i){i[0]&2048&&ot(n,r[11])},d(r){r&&J(e)}}}function Op(t){let e,n=t[3].error+"",r;return{c(){e=S("div"),r=H(n),_(e,"class","error svelte-nnbg8i")},m(i,o){Q(i,e,o),p(e,r)},p(i,o){o[0]&8&&n!==(n=i[3].error+"")&&ot(r,n)},d(i){i&&J(e)}}}function Pp(t){let e;return{c(){e=S("div"),e.textContent=`${it("ui.loading")}`,_(e,"class","loading svelte-nnbg8i")},m(n,r){Q(n,e,r)},p:Ft,d(n){n&&J(e)}}}function Do(t){let e,n,r,i,o=t[31](t[4])+"",a;return{c(){e=S("p"),n=H(t[14]),r=H(": "),i=S("strong"),a=H(o),_(e,"class","svelte-nnbg8i")},m(l,u){Q(l,e,u),p(e,n),p(e,r),p(e,i),p(i,a)},p(l,u){u[0]&16384&&ot(n,l[14]),u[0]&16&&o!==(o=l[31](l[4])+"")&&ot(a,o)},d(l){l&&J(e)}}}function Yp(t){let e,n;return{c(){e=S("p"),n=H(t[8]),_(e,"class","svelte-nnbg8i")},m(r,i){Q(r,e,i),p(e,n)},p(r,i){i[0]&256&&ot(n,r[8])},d(r){r&&J(e)}}}function Wp(t){let e,n,r,i,o=t[7].data.name+"",a,l,u,s;return{c(){e=S("p"),n=H(t[15]),r=H(": "),i=S("strong"),a=H(o),l=ht(),u=S("p"),s=H(t[16]),_(e,"class","svelte-nnbg8i"),_(u,"class","svelte-nnbg8i")},m(c,d){Q(c,e,d),p(e,n),p(e,r),p(e,i),p(i,a),Q(c,l,d),Q(c,u,d),p(u,s)},p(c,d){d[0]&32768&&ot(n,c[15]),d[0]&128&&o!==(o=c[7].data.name+"")&&ot(a,o),d[0]&65536&&ot(s,c[16])},d(c){c&&J(e),c&&J(l),c&&J(u)}}}function Bp(t){let e,n,r,i,o,a,l,u,s,c,d,f=t[31](t[2])+"",h,g,y,v,T,D,M,C=t[31](t[6])+"",b,A,k,L,z,m,N=t[31](t[5])+"",R,E;function w(ct,nt){if(ct[3].loading)return Pp;if(ct[3].error)return Op;if(!ct[3].items||ct[3].items.length===0)return Up;if(!ct[0])return Hp}let tt=w(t),Y=tt&&tt(t),Z=!t[7]&&Do(t);function q(ct,nt){return ct[7]?Wp:Yp}let et=q(t),Dt=et(t);return{c(){e=S("div"),Y&&Y.c(),n=ht(),r=S("div"),i=S("div"),o=S("h3"),a=H(t[12]),l=ht(),u=S("p"),s=H(t[13]),c=H(": "),d=S("strong"),h=H(f),g=ht(),Z&&Z.c(),y=ht(),v=S("p"),T=H(t[10]),D=H(": "),M=S("strong"),b=H(C),A=ht(),k=S("p"),L=H(t[9]),z=H(": "),m=S("strong"),R=H(N),E=ht(),Dt.c(),_(e,"class","chart-container svelte-nnbg8i"),_(o,"class","svelte-nnbg8i"),_(u,"class","svelte-nnbg8i"),_(v,"class","svelte-nnbg8i"),_(k,"class","svelte-nnbg8i"),_(i,"class","stat-summary svelte-nnbg8i"),_(r,"class","stats svelte-nnbg8i")},m(ct,nt){Q(ct,e,nt),Y&&Y.m(e,null),t[32](e),Q(ct,n,nt),Q(ct,r,nt),p(r,i),p(i,o),p(o,a),p(i,l),p(i,u),p(u,s),p(u,c),p(u,d),p(d,h),p(i,g),Z&&Z.m(i,null),p(i,y),p(i,v),p(v,T),p(v,D),p(v,M),p(M,b),p(i,A),p(i,k),p(k,L),p(k,z),p(k,m),p(m,R),p(i,E),Dt.m(i,null)},p(ct,nt){tt===(tt=w(ct))&&Y?Y.p(ct,nt):(Y&&Y.d(1),Y=tt&&tt(ct),Y&&(Y.c(),Y.m(e,null))),nt[0]&4096&&ot(a,ct[12]),nt[0]&8192&&ot(s,ct[13]),nt[0]&4&&f!==(f=ct[31](ct[2])+"")&&ot(h,f),ct[7]?Z&&(Z.d(1),Z=null):Z?Z.p(ct,nt):(Z=Do(ct),Z.c(),Z.m(i,y)),nt[0]&1024&&ot(T,ct[10]),nt[0]&64&&C!==(C=ct[31](ct[6])+"")&&ot(b,C),nt[0]&512&&ot(L,ct[9]),nt[0]&32&&N!==(N=ct[31](ct[5])+"")&&ot(R,N),et===(et=q(ct))&&Dt?Dt.p(ct,nt):(Dt.d(1),Dt=et(ct),Dt&&(Dt.c(),Dt.m(i,null)))},d(ct){ct&&J(e),Y&&Y.d(),t[32](null),ct&&J(n),ct&&J(r),Z&&Z.d(),Dt.d()}}}function qp(t){let e,n,r;return n=new Tn({props:{title:"",translationKey:"",description:"This visualization shows the distribution of items by country and sub-collection. You can click on any country block to zoom in and see its sub-collections. The size of each block represents the number of items in that country or sub-collection.",descriptionTranslationKey:Vp,titleHtml:t[1],$$slots:{default:[Bp]},$$scope:{ctx:t}}}),{c(){e=S("div"),te(n.$$.fragment),_(e,"class","country-distribution-container svelte-nnbg8i")},m(i,o){Q(i,e,o),Gt(n,e,null),r=!0},p(i,o){const a={};o[0]&2&&(a.titleHtml=i[1]),o[0]&131069|o[1]&67108864&&(a.$$scope={dirty:o,ctx:i}),n.$set(a)},i(i){r||(Ot(n.$$.fragment,i),r=!0)},o(i){Yt(n.$$.fragment,i),r=!1},d(i){i&&J(e),jt(n)}}}const Vp="viz.country_distribution_description";function Xp(t,e,n){let r,i,o,a,l,u,s,c,d,f,h,g,y,v,T;vt(t,Kt,X=>n(3,r=X));let D=0,M=0,C,b,A={name:"root",children:[]},k=null,L="en",z="",m=0,N=0,R=0,E=0,w=null,tt=null,Y=new Map,Z=new Map;const q=lt("viz.no_data");vt(t,q,X=>n(11,d=X));const et=lt("viz.items");vt(t,et,X=>n(42,a=X));const Dt=lt("viz.percent_of_country");vt(t,Dt,X=>n(41,o=X));const ct=lt("viz.percent_of_total");vt(t,ct,X=>n(40,i=X));const nt=lt("viz.click_zoom_in");vt(t,nt,X=>n(8,l=X));const V=lt("viz.back_to_all");vt(t,V,X=>n(43,c=X)),lt("viz.unknown");const bt=lt("viz.no_set");vt(t,bt,X=>n(44,f=X));const kt=lt("viz.summary");vt(t,kt,X=>n(12,h=X));const ut=lt("viz.total_items");vt(t,ut,X=>n(13,g=X));const at=lt("viz.countries");vt(t,at,X=>n(14,y=X));const st=lt("viz.categories");vt(t,st,X=>n(10,s=X));const x=lt("viz.sub_collections");vt(t,x,X=>n(9,u=X));const W=lt("viz.currently_viewing");vt(t,W,X=>n(15,v=X));const ft=lt("viz.click_back_to_return");vt(t,ft,X=>n(16,T=X));function $(X){return X.toLocaleString(L==="fr"?"fr-FR":"en-US")}function O(X){const gt=$(X);return it("viz.distribution_items",[gt])}function G(){m>0?n(1,z=O(m)):n(1,z=it("viz.country_distribution_title")),console.log("Title HTML updated:",z)}Zt.subscribe(X=>{var gt;if(console.log("Language changed to:",X),L=X,G(),r.items&&r.items.length>0){const St=w,_t=St==null?void 0:St.data.originalName;if(n(7,w=null),A=K(r.items),St&&_t){const rt=(gt=_e(A).children)==null?void 0:gt.find(Nt=>Nt.data.originalName===_t);if(rt){U(rt);return}}B()}});function K(X){var It;const gt=X.filter(rt=>rt.country&&rt.country.trim()!==""),St=pn(gt,rt=>rt.country),_t={name:"root",children:Array.from(St,([rt,Nt])=>{const P=it(`country.${rt}`)||rt,F=pn(Nt,Tt=>Tt.item_set_title||f),j=new Map;Object.values(cn).forEach(Tt=>{j.set(Tt.id,{name:Rp(Tt.id,L),children:[],itemCount:0,originalName:Tt.id,categoryId:Tt.id,isCategory:!0})}),F.forEach((Tt,Et)=>{const xt=Fp[Et]||"other",At=j.get(xt);if(At&&At.children){const Rt={name:Et,value:Tt.length,itemCount:Tt.length,originalName:Et,categoryId:xt};At.children.push(Rt),At.itemCount!==void 0&&(At.itemCount+=Tt.length)}});const $t=Array.from(j.values()).filter(Tt=>Tt.children&&Tt.children.length>0);return $t.sort((Tt,Et)=>(Et.itemCount||0)-(Tt.itemCount||0)),$t.forEach(Tt=>{Tt.children&&Tt.children.sort((Et,xt)=>(xt.itemCount||0)-(Et.itemCount||0))}),{name:P,children:$t,itemCount:Nt.length,originalName:rt}})};return n(2,m=gt.length),n(4,N=St.size),n(6,E=Object.keys(cn).length),n(5,R=0),(It=_t.children)==null||It.forEach(rt=>{var Nt;(Nt=rt.children)==null||Nt.forEach(P=>{P.children&&n(5,R+=P.children.length)})}),G(),console.log("Data processed, total items:",m),_t}function U(X){var gt,St,_t;if(n(7,w=X),w){if(!w.children||w.children.length===0){console.warn("Cannot zoom to node without children");return}if(console.log("Zooming to node:",w.data.name,"Original name:",w.data.originalName,"Is category:",w.data.isCategory),n(2,m=w.data.itemCount||0),w.data.isCategory)w.data.isCategory&&(n(5,R=((St=w.children)==null?void 0:St.length)||0),n(6,E=1));else{const It=((gt=w.children)==null?void 0:gt.filter(rt=>rt.data.isCategory))||[];n(6,E=It.length),n(5,R=0),It.forEach(rt=>{rt.children&&n(5,R+=rt.children.length)})}}else if(r.items&&r.items.length>0){A=K(r.items);const It=r.items.filter(Nt=>Nt.country&&Nt.country.trim()!=="");n(2,m=It.length);const rt=pn(It,Nt=>Nt.country);n(4,N=rt.size),n(6,E=Object.keys(cn).length),n(5,R=0),(_t=A.children)==null||_t.forEach(Nt=>{var P;(P=Nt.children)==null||P.forEach(F=>{F.children&&n(5,R+=F.children.length)})})}G(),B()}function B(){try{if(!C){console.error("Container element not found");return}if(w||(A=K(r.items)),!A.children||A.children.length===0){wt(C).select("svg").remove(),wt(C).append("div").attr("class","no-data").style("position","absolute").style("top","50%").style("left","50%").style("transform","translate(-50%, -50%)").style("text-align","center").style("color","var(--text-color-secondary)").text(d);return}wt(C).select("svg").remove(),wt(C).select(".no-data").remove();const X=C.getBoundingClientRect();D=X.width,M=X.height;const gt={top:10,right:10,bottom:10,left:10},St=D-gt.left-gt.right,_t=M-gt.top-gt.bottom,rt=wt(C).append("svg").attr("width",D).attr("height",M).append("g").attr("transform",`translate(${gt.left}, ${gt.top})`);if(w){const xt=rt.append("g").attr("class","zoom-out-button").attr("transform","translate(0, 0)").style("cursor","pointer").on("click",()=>U(null));xt.append("rect").attr("width",100).attr("height",20).attr("rx",4).attr("fill","var(--primary-color)").attr("opacity",.8),xt.append("text").attr("x",50).attr("y",14).attr("text-anchor","middle").attr("fill","white").attr("font-size","var(--font-size-sm)").text(c)}const Nt=tl().size([St,_t]).paddingOuter(4).paddingTop(20).paddingInner(2).round(!0);let P;if(w){const xt={name:w.data.name,children:w.data.children,originalName:w.data.originalName,isCategory:w.data.isCategory,categoryId:w.data.categoryId};P=_e(xt).sum(At=>At.value||0).sort((At,Rt)=>(Rt.value||0)-(At.value||0))}else P=_e(A).sum(xt=>xt.value||0).sort((xt,At)=>(At.value||0)-(xt.value||0));k=P;try{Nt(P)}catch(xt){console.error("Error applying treemap layout:",xt),n(7,w=null),A=K(r.items),P=_e(A).sum(At=>At.value||0).sort((At,Rt)=>(Rt.value||0)-(At.value||0)),k=P,Nt(P)}const F=De().domain(P.children?P.children.map(xt=>xt.data.originalName||xt.data.name):[P.data.originalName||P.data.name]).range(xn),j=De().domain(Object.keys(cn)).range(ap),$t=!w,Tt=w&&!w.data.isCategory,Et=w&&w.data.isCategory;if($t){const xt=P.children||[];rt.selectAll(".country").data(xt).enter().append("g").attr("class","country").each(function(Rt){const Ct=wt(this),yt=Rt.data.name,mt=Rt.data.originalName||yt;let Ht;Y.has(mt)?Ht=Y.get(mt)||F(mt):(Ht=F(mt),Y.set(mt,Ht));const fe=Rt.children||[],ee=Ct.selectAll(".category").data(fe).enter().append("g").attr("class","category").attr("transform",Lt=>{const Wt=Lt.x0||0,Vt=Lt.y0||0;return`translate(${Wt},${Vt})`});ee.append("rect").attr("width",Lt=>{const Wt=Lt.x0||0,Vt=Lt.x1||0;return Math.max(0,Vt-Wt)}).attr("height",Lt=>{const Wt=Lt.y0||0,Vt=Lt.y1||0;return Math.max(0,Vt-Wt)}).attr("fill",Lt=>{const Wt=Lt.data.categoryId||"other",Vt=oe(Ht),Re=`${mt}-${Wt}`;let se;if(Z.has(Re))se=Z.get(Re)||Vt.toString();else{const Qe=oe(j(Wt));se=oe(Vt.r*.7+Qe.r*.3,Vt.g*.7+Qe.g*.3,Vt.b*.7+Qe.b*.3).toString(),Z.set(Re,se)}return se}).attr("stroke","white").attr("stroke-width",1.5).style("opacity",.8).style("cursor","pointer").on("click",(Lt,Wt)=>{U(Rt)}).on("mouseover",function(Lt,Wt){pt(Lt,Wt)}).on("mousemove",function(Lt,Wt){pt(Lt,Wt)}).on("mouseout",function(){Mt()}),ee.append("text").attr("x",5).attr("y",15).attr("font-size","var(--font-size-xs)").attr("font-weight","bold").attr("fill","white").text(Lt=>Lt.x1-Lt.x0<100?Lt.data.name:`${Lt.data.name} (${Lt.data.itemCount||0})`).style("pointer-events","none").each(function(Lt){const Wt=wt(this),Vt=this.getComputedTextLength(),Re=Lt.x1-Lt.x0-10;if(Vt>Re){let se=Lt.data.name;Wt.text(se);let Qe=this.getComputedTextLength(),$r=!1;for(;Qe>Re&&se.length>3;)se=se.slice(0,-1),Wt.text(se),Qe=this.getComputedTextLength(),$r=!0;$r&&Wt.text(se+"..."),Wt.append("title").text(`${yt} > ${Lt.data.name} (${Lt.data.itemCount||0} ${a})`)}});let be=1/0,Oe=1/0,Ie=-1/0,Fe=-1/0;fe.forEach(Lt=>{const Wt=Lt.x0||0,Vt=Lt.y0||0,Re=Lt.x1||0,se=Lt.y1||0;be=Math.min(be,Wt),Oe=Math.min(Oe,Vt),Ie=Math.max(Ie,Re),Fe=Math.max(Fe,se)}),Ct.append("rect").attr("x",be).attr("y",Oe-20).attr("width",Ie-be).attr("height",20).attr("fill",Ht).attr("opacity",.9).style("cursor","pointer").on("click",Lt=>{U(Rt)}),Ct.append("text").attr("x",be+5).attr("y",Oe-6).attr("font-size","var(--font-size-sm)").attr("font-weight","bold").attr("fill","white").text(`${yt} (${Rt.data.itemCount||0} ${a})`).style("pointer-events","none")})}else if(Tt){const xt=rt.selectAll(".category").data(P.children||[]).enter().append("g").attr("class","category").attr("transform",Ct=>{const yt=Ct.x0||0,mt=Ct.y0||0;return`translate(${yt},${mt})`}),At=(w==null?void 0:w.data.originalName)||(w==null?void 0:w.data.name)||"",Rt=Y.get(At)||F(At);xt.append("rect").attr("width",Ct=>{const yt=Ct.x0||0,mt=Ct.x1||0;return Math.max(0,mt-yt)}).attr("height",Ct=>{const yt=Ct.y0||0,mt=Ct.y1||0;return Math.max(0,mt-yt)}).attr("fill",Ct=>{const yt=Ct.data.categoryId||"other",mt=`${At}-${yt}`;if(Z.has(mt))return Z.get(mt)||Rt;{const Ht=oe(Rt),fe=oe(j(yt)),be=oe(Ht.r*.7+fe.r*.3,Ht.g*.7+fe.g*.3,Ht.b*.7+fe.b*.3).toString();return Z.set(mt,be),be}}).attr("stroke","white").attr("stroke-width",1.5).style("opacity",.8).style("cursor","pointer").on("click",(Ct,yt)=>{U(yt)}).on("mouseover",function(Ct,yt){pt(Ct,yt)}).on("mousemove",function(Ct,yt){pt(Ct,yt)}).on("mouseout",function(){Mt()}),xt.append("text").attr("x",5).attr("y",15).attr("font-size","var(--font-size-sm)").attr("font-weight","bold").attr("fill","white").text(Ct=>`${Ct.data.name} (${Ct.data.itemCount||0} ${a})`).style("pointer-events","none").each(function(Ct){const yt=wt(this),mt=this.getComputedTextLength(),Ht=Ct.x1-Ct.x0-10;mt>Ht&&yt.text(Ct.data.name).append("title").text(`${Ct.data.name} (${Ct.data.itemCount||0} ${a})`)})}else if(Et&&w){const xt=rt.selectAll(".subcollection").data(P.children||[]).enter().append("g").attr("class","subcollection").attr("transform",yt=>{const mt=yt.x0||0,Ht=yt.y0||0;return`translate(${mt},${Ht})`}),At=w.data.categoryId||"other",Rt=w.parent;let Ct;if(Rt){const mt=`${Rt.data.originalName||Rt.data.name}-${At}`;Ct=Z.get(mt)||j(At)}else Ct=j(At);xt.append("rect").attr("width",yt=>{const mt=yt.x0||0,Ht=yt.x1||0;return Math.max(0,Ht-mt)}).attr("height",yt=>{const mt=yt.y0||0,Ht=yt.y1||0;return Math.max(0,Ht-mt)}).attr("fill",yt=>{const mt=oe(Ct);return oe(mt).brighter(.5).toString()}).attr("stroke","white").attr("stroke-width",.5).style("cursor","pointer").on("mouseover",function(yt,mt){wt(this).attr("stroke","var(--primary-color)").attr("stroke-width",2),pt(yt,mt)}).on("mousemove",function(yt,mt){pt(yt,mt)}).on("mouseout",function(){wt(this).attr("stroke","white").attr("stroke-width",.5),Mt()}),xt.append("text").attr("x",3).attr("y",13).attr("font-size","var(--font-size-xs)").attr("fill","var(--text-color-primary)").style("pointer-events","none").each(function(yt){const mt=wt(this),Ht=yt.x1-yt.x0,fe=yt.y1-yt.y0;if(Ht<30||fe<20)return;let ee=yt.data.name;const be=Ht-6,Oe=Rt?Rt.data.name:"",Ie=w?w.data.name:"";let Fe="";Oe&&Ie?Fe=`${Oe} > ${Ie} > ${yt.data.name}: ${yt.data.itemCount||yt.value||0} ${a}`:Ie?Fe=`${Ie} > ${yt.data.name}: ${yt.data.itemCount||yt.value||0} ${a}`:Fe=`${yt.data.name}: ${yt.data.itemCount||yt.value||0} ${a}`,mt.text(ee).append("title").text(Fe);const Lt=this;let Wt=Lt.getComputedTextLength(),Vt=!1;for(;Wt>be&&ee.length>3;)ee=ee.slice(0,-1),mt.text(ee),Wt=Lt.getComputedTextLength(),Vt=!0;Vt&&(mt.text(ee+"..."),mt.append("title").text(Fe))})}}catch(X){console.error("Error in updateVisualization:",X)}}function I(){b&&document.body.contains(b)&&document.body.removeChild(b);try{b=document.createElement("div"),b.style.position="absolute",b.style.backgroundColor="rgba(0, 0, 0, 0.8)",b.style.color="white",b.style.padding="8px 12px",b.style.borderRadius="4px",b.style.pointerEvents="none",b.style.display="none",b.style.fontSize="12px",b.style.zIndex="1000",b.style.boxShadow="0 2px 5px rgba(0,0,0,0.2)",b.style.maxWidth="250px",b.style.whiteSpace="nowrap",document&&document.body&&document.body.appendChild(b)}catch(X){console.error("Error creating tooltip:",X)}}function pt(X,gt){var St,_t;(!b||!document.body.contains(b))&&I();try{const It=gt.parent===k,rt=gt.data.isCategory===!0,Nt=!It&&!rt;if(It){const Tt=gt.data.name,Et=gt.data.itemCount||gt.value||0,xt=((St=gt.children)==null?void 0:St.length)||0,At=m>0?(Et/m*100).toFixed(1)+"%":"N/A";b.innerHTML=`
                    <div style="font-weight:bold;margin-bottom:4px;border-bottom:1px solid rgba(255,255,255,0.3);padding-bottom:2px;">
                        ${Tt}
                    </div>
                    <div style="display:grid;grid-template-columns:auto auto;gap:4px;">
                        <span>${a}:</span>
                        <span style="text-align:right;font-weight:bold">${Et}</span>
                        <span>${s}:</span>
                        <span style="text-align:right">${xt}</span>
                        <span>${i}:</span>
                        <span style="text-align:right">${At}</span>
                    </div>
                    <div style="margin-top:4px;font-style:italic;font-size:10px;">
                        ${l}
                    </div>
                `}else if(rt){const Tt=w&&!w.data.isCategory?w.data.name:"",Et=gt.data.name,xt=gt.data.itemCount||gt.value||0,At=((_t=gt.children)==null?void 0:_t.length)||0,Rt=m,Ct=w?w.data.itemCount:0,yt=Ct&&Ct>0?(xt/Ct*100).toFixed(1)+"%":"N/A",mt=Rt>0?(xt/Rt*100).toFixed(1)+"%":"N/A";let Ht=Tt?`${Tt} > ${Et}`:Et;b.innerHTML=`
                    <div style="font-weight:bold;margin-bottom:4px;border-bottom:1px solid rgba(255,255,255,0.3);padding-bottom:2px;">
                        ${Ht}
                    </div>
                    <div style="display:grid;grid-template-columns:auto auto;gap:4px;">
                        <span>${a}:</span>
                        <span style="text-align:right;font-weight:bold">${xt}</span>
                        <span>${u}:</span>
                        <span style="text-align:right">${At}</span>
                        ${Tt?`<span>${o}:</span>
                        <span style="text-align:right">${yt}</span>`:""}
                        <span>${i}:</span>
                        <span style="text-align:right">${mt}</span>
                    </div>
                    <div style="margin-top:4px;font-style:italic;font-size:10px;">
                        ${l}
                    </div>
                `}else{const Tt=w&&!w.data.isCategory?w.data.name:"",Et=w&&w.data.isCategory?w.data.name:gt.parent&&gt.parent.data.isCategory?gt.parent.data.name:"",xt=gt.data.name,At=gt.data.itemCount||gt.value||0,Rt=m,Ct=gt.parent&&gt.parent.data.itemCount||0,yt=w&&!w.data.isCategory&&w.data.itemCount||0,mt=Ct>0?(At/Ct*100).toFixed(1)+"%":"N/A",Ht=yt>0?(At/yt*100).toFixed(1)+"%":"N/A",fe=Rt>0?(At/Rt*100).toFixed(1)+"%":"N/A";let ee="";Tt&&Et?ee=`${Tt} > ${Et} > ${xt}`:Et?ee=`${Et} > ${xt}`:ee=xt,b.innerHTML=`
                    <div style="font-weight:bold;margin-bottom:4px;border-bottom:1px solid rgba(255,255,255,0.3);padding-bottom:2px;">
                        ${ee}
                    </div>
                    <div style="display:grid;grid-template-columns:auto auto;gap:4px;">
                        <span>${a}:</span>
                        <span style="text-align:right;font-weight:bold">${At}</span>
                        ${Et?`<span>% of ${Et}:</span>
                        <span style="text-align:right">${mt}</span>`:""}
                        ${Tt?`<span>${o}:</span>
                        <span style="text-align:right">${Ht}</span>`:""}
                        <span>${i}:</span>
                        <span style="text-align:right">${fe}</span>
                    </div>
                `}const P=250,F=150;let j=X.pageX+10,$t=X.pageY+10;j+P>window.innerWidth&&(j=X.pageX-P-10),$t+F>window.innerHeight&&($t=X.pageY-F-10),b.style.left=`${j}px`,b.style.top=`${$t}px`,b.style.display="block"}catch(It){console.error("Error showing tooltip:",It)}}function Mt(){try{b&&document.body.contains(b)&&(b.style.display="none")}catch(X){console.error("Error hiding tooltip:",X)}}Te(()=>{try{return Ve().then(()=>{if(!C){console.error("Container element not found in onMount");return}if(I(),r.items&&r.items.length>0){if(A=K(r.items),A.children&&A.children.length>0){const X=De().domain(A.children.map(gt=>gt.originalName||gt.name)).range(xn);A.children.forEach(gt=>{const St=gt.originalName||gt.name;Y.has(St)||Y.set(St,X(St))})}B()}else Kt.loadItems();tt=new ResizeObserver(()=>{C&&B()}),C?tt.observe(C):console.error("Container element not available for ResizeObserver")}),()=>{try{tt&&tt.disconnect(),C&&wt(C).selectAll("*").remove(),b&&document.body.contains(b)&&document.body.removeChild(b)}catch(X){console.error("Error during cleanup:",X)}}}catch(X){return console.error("Error in onMount:",X),()=>{}}});function dt(X){ke[X?"unshift":"push"](()=>{C=X,n(0,C)})}return t.$$.update=()=>{t.$$.dirty[0]&2&&console.log("Title HTML updated:",z),t.$$.dirty[0]&12&&r.items&&r.items.length>0&&!m&&(A=K(r.items)),t.$$.dirty[0]&9&&r.items&&C&&B()},G(),[C,z,m,r,N,R,E,w,l,u,s,d,h,g,y,v,T,q,et,Dt,ct,nt,V,bt,kt,ut,at,st,x,W,ft,$,dt]}class Kp extends pe{constructor(e){super(),he(this,e,Xp,qp,ce,{},null,[-1,-1])}}function $o(t,e,n){const r=t.slice();return r[42]=e[n],r}function Eo(t,e,n){const r=t.slice();return r[42]=e[n],r}function Lo(t,e){let n,r=e[42].label+"",i,o,a=e[13](e[42].count)+"",l,u,s;return{key:t,first:null,c(){n=S("option"),i=H(r),o=H(" ("),l=H(a),u=H(")"),n.__value=s=e[42].value,n.value=n.__value,this.first=n},m(c,d){Q(c,n,d),p(n,i),p(n,o),p(n,l),p(n,u)},p(c,d){e=c,d[0]&32&&r!==(r=e[42].label+"")&&ot(i,r),d[0]&32&&a!==(a=e[13](e[42].count)+"")&&ot(l,a),d[0]&32&&s!==(s=e[42].value)&&(n.__value=s,n.value=n.__value)},d(c){c&&J(n)}}}function Io(t,e){let n,r=e[42].label+"",i,o,a=e[13](e[42].count)+"",l,u,s;return{key:t,first:null,c(){n=S("option"),i=H(r),o=H(" ("),l=H(a),u=H(")"),n.__value=s=e[42].value,n.value=n.__value,this.first=n},m(c,d){Q(c,n,d),p(n,i),p(n,o),p(n,l),p(n,u)},p(c,d){e=c,d[0]&64&&r!==(r=e[42].label+"")&&ot(i,r),d[0]&64&&a!==(a=e[13](e[42].count)+"")&&ot(l,a),d[0]&64&&s!==(s=e[42].value)&&(n.__value=s,n.value=n.__value)},d(c){c&&J(n)}}}function Fo(t){let e,n=it("viz.showing_items",[t[13](t[7]),t[4].length.toString()])+"",r;return{c(){e=S("span"),r=H(n)},m(i,o){Q(i,e,o),p(e,r)},p(i,o){o[0]&144&&n!==(n=it("viz.showing_items",[i[13](i[7]),i[4].length.toString()])+"")&&ot(r,n)},d(i){i&&J(e)}}}function Zp(t){let e,n=t[1].error+"",r;return{c(){e=S("div"),r=H(n),_(e,"class","error svelte-1ci7ag1")},m(i,o){Q(i,e,o),p(e,r)},p(i,o){o[0]&2&&n!==(n=i[1].error+"")&&ot(r,n)},d(i){i&&J(e)}}}function Gp(t){let e;return{c(){e=S("div"),e.textContent=`${it("ui.loading")}`,_(e,"class","loading svelte-1ci7ag1")},m(n,r){Q(n,e,r)},p:Ft,d(n){n&&J(e)}}}function jp(t){let e,n,r,i,o,a,l,u=[],s=new Map,c,d,f,h,g,y,v,T=[],D=new Map,M,C,b,A,k,L,z,m,N,R,E=it("viz.total_items")+"",w,tt,Y,Z,q,et,Dt=it("viz.languages")+"",ct,nt,V,bt=t[4].length+"",kt,ut,at,st=t[5];const x=U=>U[42].value;for(let U=0;U<st.length;U+=1){let B=Eo(t,st,U),I=x(B);s.set(I,u[U]=Lo(I,B))}let W=t[6];const ft=U=>U[42].value;for(let U=0;U<W.length;U+=1){let B=$o(t,W,U),I=ft(B);D.set(I,T[U]=Io(I,B))}let $=t[4].length>0&&Fo(t);function O(U,B){if(U[1].loading)return Gp;if(U[1].error)return Zp}let G=O(t),K=G&&G(t);return{c(){e=S("div"),n=S("div"),r=S("label"),i=H(t[9]),o=H(":"),a=ht(),l=S("select");for(let U=0;U<u.length;U+=1)u[U].c();c=ht(),d=S("div"),f=S("label"),h=H(t[10]),g=H(":"),y=ht(),v=S("select");for(let U=0;U<T.length;U+=1)T[U].c();M=ht(),C=S("div"),$&&$.c(),b=ht(),A=S("div"),K&&K.c(),k=ht(),L=S("div"),z=S("div"),m=S("h3"),m.textContent=`${it("viz.summary")}`,N=ht(),R=S("p"),w=H(E),tt=H(": "),Y=S("strong"),Z=H(t[7]),q=ht(),et=S("p"),ct=H(Dt),nt=H(": "),V=S("strong"),kt=H(bt),_(r,"for","country-filter"),_(r,"class","svelte-1ci7ag1"),_(l,"id","country-filter"),_(l,"class","svelte-1ci7ag1"),t[2]===void 0&&Xe(()=>t[17].call(l)),_(n,"class","filter-group svelte-1ci7ag1"),_(f,"for","type-filter"),_(f,"class","svelte-1ci7ag1"),_(v,"id","type-filter"),_(v,"class","svelte-1ci7ag1"),t[3]===void 0&&Xe(()=>t[18].call(v)),_(d,"class","filter-group svelte-1ci7ag1"),_(C,"class","summary svelte-1ci7ag1"),_(e,"class","filters svelte-1ci7ag1"),_(A,"class","pie-container svelte-1ci7ag1"),_(m,"class","svelte-1ci7ag1"),_(R,"class","svelte-1ci7ag1"),_(et,"class","svelte-1ci7ag1"),_(z,"class","stat-summary svelte-1ci7ag1"),_(L,"class","stats svelte-1ci7ag1")},m(U,B){Q(U,e,B),p(e,n),p(n,r),p(r,i),p(r,o),p(n,a),p(n,l);for(let I=0;I<u.length;I+=1)u[I]&&u[I].m(l,null);He(l,t[2],!0),p(e,c),p(e,d),p(d,f),p(f,h),p(f,g),p(d,y),p(d,v);for(let I=0;I<T.length;I+=1)T[I]&&T[I].m(v,null);He(v,t[3],!0),p(e,M),p(e,C),$&&$.m(C,null),Q(U,b,B),Q(U,A,B),K&&K.m(A,null),t[19](A),Q(U,k,B),Q(U,L,B),p(L,z),p(z,m),p(z,N),p(z,R),p(R,w),p(R,tt),p(R,Y),p(Y,Z),p(z,q),p(z,et),p(et,ct),p(et,nt),p(et,V),p(V,kt),ut||(at=[Qt(l,"change",t[14]),Qt(l,"change",t[17]),Qt(v,"change",t[15]),Qt(v,"change",t[18])],ut=!0)},p(U,B){B[0]&512&&ot(i,U[9]),B[0]&8224&&(st=U[5],u=Li(u,B,x,1,U,st,s,l,Ei,Lo,null,Eo)),B[0]&36&&He(l,U[2]),B[0]&1024&&ot(h,U[10]),B[0]&8256&&(W=U[6],T=Li(T,B,ft,1,U,W,D,v,Ei,Io,null,$o)),B[0]&72&&He(v,U[3]),U[4].length>0?$?$.p(U,B):($=Fo(U),$.c(),$.m(C,null)):$&&($.d(1),$=null),G===(G=O(U))&&K?K.p(U,B):(K&&K.d(1),K=G&&G(U),K&&(K.c(),K.m(A,null))),B[0]&128&&ot(Z,U[7]),B[0]&16&&bt!==(bt=U[4].length+"")&&ot(kt,bt)},d(U){U&&J(e);for(let B=0;B<u.length;B+=1)u[B].d();for(let B=0;B<T.length;B+=1)T[B].d();$&&$.d(),U&&J(b),U&&J(A),K&&K.d(),t[19](null),U&&J(k),U&&J(L),ut=!1,le(at)}}}function Jp(t){let e,n,r;return n=new Tn({props:{title:"",translationKey:"",description:"",descriptionTranslationKey:"viz.language_distribution_description",titleHtml:t[8],$$slots:{default:[jp]},$$scope:{ctx:t}}}),{c(){e=S("div"),te(n.$$.fragment),_(e,"class","language-visualization-container svelte-1ci7ag1")},m(i,o){Q(i,e,o),Gt(n,e,null),r=!0},p(i,o){const a={};o[0]&256&&(a.titleHtml=i[8]),o[0]&1791|o[1]&65536&&(a.$$scope={dirty:o,ctx:i}),n.$set(a)},i(i){r||(Ot(n.$$.fragment,i),r=!0)},o(i){Yt(n.$$.fragment,i),r=!1},d(i){i&&J(e),jt(n)}}}function Qp(t,e,n){let r,i,o,a;vt(t,Kt,V=>n(1,r=V)),vt(t,Zt,V=>n(16,i=V));let l="all",u="all",s=[],c=[],d=[],f=0,h="en",g="",y=0,v=0,T,D,M;const C=De(xn);lt("viz.all_countries"),lt("viz.all_types");const b=lt("viz.filter_by_country");vt(t,b,V=>n(9,o=V));const A=lt("viz.filter_by_type");vt(t,A,V=>n(10,a=V)),lt("viz.no_data"),lt("viz.showing_items"),lt("viz.items"),lt("viz.percent_of_total");function k(V){return V.toLocaleString(h==="fr"?"fr-FR":"en-US")}function L(V){const bt=k(V);return it("viz.language_distribution_items",[bt])}function z(){f>0?n(8,g=L(f)):n(8,g=it("viz.language_distribution_title")),console.log("Language Distribution Title updated:",g)}Zt.subscribe(V=>{console.log("Language changed to:",V),h=V,z(),N(),M&&s.length>0&&Y(s),T&&Z()});function m(){if(!r.items||r.items.length===0)return;let V=r.items.filter(ut=>!(!ut.language||l!=="all"&&ut.country!==l||u!=="all"&&ut.type!==u));n(7,f=V.length),z(),console.log(`Processed ${f} items with language data`);const bt=Be(V,ut=>ut.length,ut=>ut.language||"Unknown");return Array.from(bt,([ut,at])=>({language:ut,count:at,percentage:at/f*100})).sort((ut,at)=>at.count-ut.count)}function N(){if(!r.items||r.items.length===0)return;const V=r.items.filter(st=>st.language),bt=Be(V,st=>st.length,st=>st.country||"Unknown"),kt=it("viz.all_countries"),ut=it("viz.all_types");n(5,c=[{value:"all",label:kt,count:V.length},...Array.from(bt,([st,x])=>{if(st==="Unknown")return null;const W=it(`country.${st}`)||st;return{value:st,label:W,count:x}}).filter(st=>st!==null).sort((st,x)=>x.count-st.count)]);const at=Be(V,st=>st.length,st=>st.type||"Unknown");n(6,d=[{value:"all",label:ut,count:V.length},...Array.from(at,([st,x])=>({value:st,label:st,count:x})).sort((st,x)=>x.count-st.count)])}function R(){D=document.createElement("div"),D.style.position="absolute",D.style.backgroundColor="rgba(0, 0, 0, 0.8)",D.style.color="white",D.style.padding="8px 12px",D.style.borderRadius="4px",D.style.pointerEvents="none",D.style.display="none",D.style.fontSize="12px",D.style.zIndex="1000",D.style.boxShadow="0 2px 5px rgba(0,0,0,0.2)",document&&document.body&&document.body.appendChild(D)}function E(V,bt){if(!D)return;const kt=bt.data,ut=it(`lang.${kt.language}`)||kt.language;D.innerHTML=`
            <div style="font-weight:bold;margin-bottom:4px;border-bottom:1px solid rgba(255,255,255,0.3);padding-bottom:2px;">
                ${ut}
            </div>
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:4px;">
                <span>${it("viz.items")}:</span><span style="text-align:right;font-weight:bold;">${k(kt.count)}</span>
                <span>${it("viz.percent_of_total")}:</span><span style="text-align:right;font-weight:bold;">${kt.percentage.toFixed(2)}%</span>
            </div>
        `;const at=200,st=100;let x=V.pageX+10,W=V.pageY+10;x+at>window.innerWidth&&(x=V.pageX-at-10),W+st>window.innerHeight&&(W=V.pageY-st-10),D.style.left=`${x}px`,D.style.top=`${W}px`,D.style.display="block"}function w(){D&&(D.style.display="none")}function tt(){M?M.innerHTML="":(M=document.createElement("div"),M.style.position="absolute",M.style.right="20px",M.style.top="20px",M.style.backgroundColor="rgba(255, 255, 255, 0.9)",M.style.padding="10px",M.style.borderRadius="4px",M.style.boxShadow="0 2px 4px rgba(0,0,0,0.1)",M.style.maxHeight="300px",M.style.overflowY="auto",M.style.color="var(--text-color-primary)",M.style.fontFamily="var(--font-family-primary)",M.style.fontSize="var(--font-size-sm)",T.appendChild(M))}function Y(V){M&&(M.innerHTML=`
            <div style="font-weight:bold;margin-bottom:8px;font-size:14px;color:var(--text-color-primary);">${it("viz.languages")} (${V.length})</div>
            <div style="display:grid;grid-template-columns:20px auto 40px;gap:4px;font-size:12px;">
                ${V.map((bt,kt)=>{const ut=it(`lang.${bt.language}`)||bt.language;return`
                        <div style="width:12px;height:12px;background-color:${C(bt.language)};border-radius:2px;margin-top:2px;"></div>
                        <div style="white-space:nowrap;overflow:hidden;text-overflow:ellipsis;color:var(--text-color-primary);">${ut}</div>
                        <div style="text-align:right;color:var(--text-color-secondary);">${k(bt.count)}</div>
                    `}).join("")}
            </div>
        `)}function Z(){if(!T)return;const V=m();if(n(4,s=V||[]),!V||V.length===0){wt(T).select("svg").remove();return}wt(T).select("svg").remove();const bt=T.getBoundingClientRect();y=bt.width,v=bt.height;const kt={top:20,right:20,bottom:20,left:20},ut=y-kt.left-kt.right,at=v-kt.top-kt.bottom,st=Math.min(ut,at)/2,x=wt(T).append("svg").attr("width",y).attr("height",v).append("g").attr("transform",`translate(${y/2}, ${v/2})`),W=bp().value(O=>O.count).sort(null),ft=vo().innerRadius(0).outerRadius(st),$=vo().innerRadius(0).outerRadius(st+10);x.selectAll("path").data(W(V)).enter().append("path").attr("d",ft).attr("fill",O=>C(O.data.language)).attr("stroke","white").attr("stroke-width",2).on("mouseenter",function(O,G){wt(this).transition().duration(200).attr("d",K=>$(K)),E(O,G)}).on("mousemove",function(O,G){E(O,G)}).on("mouseleave",function(O,G){wt(this).transition().duration(200).attr("d",K=>ft(K)),w()}),tt(),Y(V)}function q(V){const bt=V.target;n(2,l=bt.value),Z()}function et(V){const bt=V.target;n(3,u=bt.value),Z()}Te(async()=>{if(await Ve(),!T){console.error("Container element not found");return}R(),r.items&&r.items.length>0?(N(),Z()):Kt.loadItems();const V=new ResizeObserver(()=>{T&&Z()});return V.observe(T),()=>{V.disconnect(),D&&document.body.contains(D)&&document.body.removeChild(D),M&&M.parentNode&&M.parentNode.removeChild(M)}});function Dt(){l=Ni(this),n(2,l),n(5,c)}function ct(){u=Ni(this),n(3,u),n(6,d)}function nt(V){ke[V?"unshift":"push"](()=>{T=V,n(0,T)})}return t.$$.update=()=>{t.$$.dirty[0]&3&&r.items&&T&&(N(),Z()),t.$$.dirty[0]&65538&&i&&r.items&&r.items.length>0&&N()},z(),[T,r,l,u,s,c,d,f,g,o,a,b,A,k,q,et,i,Dt,ct,nt]}class tg extends pe{constructor(e){super(),he(this,e,Qp,Jp,ce,{},null,[-1,-1])}}function Ro(t,e,n){const r=t.slice();return r[20]=e[n],r}function eg(t){let e,n=t[1].error+"",r;return{c(){e=S("div"),r=H(n),_(e,"class","error svelte-1hlsoe")},m(i,o){Q(i,e,o),p(e,r)},p(i,o){o&2&&n!==(n=i[1].error+"")&&ot(r,n)},d(i){i&&J(e)}}}function ng(t){let e;return{c(){e=S("div"),e.textContent=`${it("ui.loading")}`,_(e,"class","loading svelte-1hlsoe")},m(n,r){Q(n,e,r)},p:Ft,d(n){n&&J(e)}}}function Ho(t){let e,n,r,i,o=it("viz.total_items")+"",a,l,u,s=t[5](t[3])+"",c,d,f,h=it("viz.number_of_categories")+"",g,y,v,T=t[5](t[2].length)+"",D,M,C,b,A,k,L=t[2].slice(0,5),z=[];for(let m=0;m<L.length;m+=1)z[m]=Uo(Ro(t,L,m));return{c(){e=S("div"),n=S("h3"),n.textContent=`${it("viz.summary")}`,r=ht(),i=S("p"),a=H(o),l=H(": "),u=S("strong"),c=H(s),d=ht(),f=S("p"),g=H(h),y=H(": "),v=S("strong"),D=H(T),M=ht(),C=S("div"),b=S("h3"),b.textContent=`${it("viz.top_categories")}`,A=ht(),k=S("ul");for(let m=0;m<z.length;m+=1)z[m].c();_(n,"class","svelte-1hlsoe"),_(e,"class","stat-summary svelte-1hlsoe"),_(b,"class","svelte-1hlsoe"),_(k,"class","svelte-1hlsoe"),_(C,"class","top-categories svelte-1hlsoe")},m(m,N){Q(m,e,N),p(e,n),p(e,r),p(e,i),p(i,a),p(i,l),p(i,u),p(u,c),p(e,d),p(e,f),p(f,g),p(f,y),p(f,v),p(v,D),Q(m,M,N),Q(m,C,N),p(C,b),p(C,A),p(C,k);for(let R=0;R<z.length;R+=1)z[R]&&z[R].m(k,null)},p(m,N){if(N&8&&s!==(s=m[5](m[3])+"")&&ot(c,s),N&4&&T!==(T=m[5](m[2].length)+"")&&ot(D,T),N&36){L=m[2].slice(0,5);let R;for(R=0;R<L.length;R+=1){const E=Ro(m,L,R);z[R]?z[R].p(E,N):(z[R]=Uo(E),z[R].c(),z[R].m(k,null))}for(;R<z.length;R+=1)z[R].d(1);z.length=L.length}},d(m){m&&J(e),m&&J(M),m&&J(C),mn(z,m)}}}function Uo(t){let e,n,r=t[20].category+"",i,o,a,l=t[5](t[20].count)+"",u,s,c=it("viz.items")+"",d,f,h=t[20].percentage.toFixed(1)+"",g,y,v;return{c(){e=S("li"),n=S("span"),i=H(r),o=ht(),a=S("span"),u=H(l),s=ht(),d=H(c),f=H(" ("),g=H(h),y=H("%)"),v=ht(),_(n,"class","category-name svelte-1hlsoe"),_(a,"class","category-count svelte-1hlsoe"),_(e,"class","svelte-1hlsoe")},m(T,D){Q(T,e,D),p(e,n),p(n,i),p(e,o),p(e,a),p(a,u),p(a,s),p(a,d),p(a,f),p(a,g),p(a,y),p(e,v)},p(T,D){D&4&&r!==(r=T[20].category+"")&&ot(i,r),D&4&&l!==(l=T[5](T[20].count)+"")&&ot(u,l),D&4&&h!==(h=T[20].percentage.toFixed(1)+"")&&ot(g,h)},d(T){T&&J(e)}}}function rg(t){let e,n,r;function i(u,s){if(u[1].loading)return ng;if(u[1].error)return eg}let o=i(t),a=o&&o(t),l=t[2].length>0&&Ho(t);return{c(){e=S("div"),a&&a.c(),n=ht(),r=S("div"),l&&l.c(),_(e,"class","chart-container svelte-1hlsoe"),_(r,"class","stats svelte-1hlsoe")},m(u,s){Q(u,e,s),a&&a.m(e,null),t[6](e),Q(u,n,s),Q(u,r,s),l&&l.m(r,null)},p(u,s){o===(o=i(u))&&a?a.p(u,s):(a&&a.d(1),a=o&&o(u),a&&(a.c(),a.m(e,null))),u[2].length>0?l?l.p(u,s):(l=Ho(u),l.c(),l.m(r,null)):l&&(l.d(1),l=null)},d(u){u&&J(e),a&&a.d(),t[6](null),u&&J(n),u&&J(r),l&&l.d()}}}function ig(t){let e,n,r;return n=new Tn({props:{title:"",translationKey:"",description:"This visualization shows the distribution of index items by category. The size of each bar represents the number of items in that category.",descriptionTranslationKey:og,titleHtml:t[4],$$slots:{default:[rg]},$$scope:{ctx:t}}}),{c(){e=S("div"),te(n.$$.fragment),_(e,"class","index-visualization-container svelte-1hlsoe")},m(i,o){Q(i,e,o),Gt(n,e,null),r=!0},p(i,[o]){const a={};o&16&&(a.titleHtml=i[4]),o&8388623&&(a.$$scope={dirty:o,ctx:i}),n.$set(a)},i(i){r||(Ot(n.$$.fragment,i),r=!0)},o(i){Yt(n.$$.fragment,i),r=!1},d(i){i&&J(e),jt(n)}}}const og="viz.index_distribution_description";function ag(t,e,n){let r;vt(t,Kt,k=>n(1,r=k));let i=[],o=0,a=0,l=0,u=0,s,c,d="en",f="";const h=De(xn);function g(k){return k.toLocaleString(d==="fr"?"fr-FR":"en-US")}function y(k){const L=g(k);return it("viz.index_distribution_items",[L])}function v(){o>0?n(4,f=y(o)):n(4,f=it("viz.index_distribution_title"))}Zt.subscribe(k=>{d=k,v(),r.items&&r.items.length>0&&s&&b()});function T(){if(!r.items||r.items.length===0)return[];const k=r.items.filter(N=>N.type==="Notice d'autorité");if(n(3,o=k.length),o===0)return[];const L=Be(k,N=>N.length,N=>N.item_set_title||it("viz.uncategorized")),m=Array.from(L,([N,R])=>{const E=`category.${N}`,w=it(E);return{category:w===E?N:w,originalCategory:N,count:R,percentage:R/o*100}}).sort((N,R)=>R.count-N.count);return a=on(m,N=>N.count)||0,v(),m}function D(){try{c&&document.body.contains(c)&&document.body.removeChild(c),c=document.createElement("div"),c.style.position="absolute",c.style.backgroundColor="rgba(0, 0, 0, 0.8)",c.style.color="white",c.style.padding="8px 12px",c.style.borderRadius="4px",c.style.pointerEvents="none",c.style.display="none",c.style.fontSize="12px",c.style.zIndex="1000",c.style.boxShadow="0 2px 5px rgba(0,0,0,0.2)",document&&document.body&&document.body.appendChild(c)}catch(k){console.error("Error creating tooltip:",k)}}function M(k,L){try{if((!c||!document.body.contains(c))&&D(),!c)return;c.innerHTML=`
                <div style="font-weight:bold;margin-bottom:4px;border-bottom:1px solid rgba(255,255,255,0.3);padding-bottom:2px;">
                    ${L.category}
                </div>
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:4px;">
                    <span>${it("viz.items")}:</span><span style="text-align:right;font-weight:bold;">${g(L.count)}</span>
                    <span>${it("viz.percent_of_total")}:</span><span style="text-align:right;font-weight:bold;">${L.percentage.toFixed(2)}%</span>
                </div>
            `;const z=200,m=100;let N=k.pageX+10,R=k.pageY+10;N+z>window.innerWidth&&(N=k.pageX-z-10),R+m>window.innerHeight&&(R=k.pageY-m-10),c.style.left=`${N}px`,c.style.top=`${R}px`,c.style.display="block"}catch(z){console.error("Error showing tooltip:",z)}}function C(){try{c&&document.body.contains(c)&&(c.style.display="none")}catch(k){console.error("Error hiding tooltip:",k)}}function b(){try{if(!s)return;const k=T();if(!k||k.length===0){wt(s).select("svg").remove(),wt(s).append("div").attr("class","no-data").style("position","absolute").style("top","50%").style("left","50%").style("transform","translate(-50%, -50%)").style("text-align","center").style("color","var(--text-color-secondary)").text(it("viz.no_data"));return}n(2,i=k),wt(s).select("svg").remove(),wt(s).select(".no-data").remove();const L=s.getBoundingClientRect();l=L.width,u=L.height-40;const z={top:20,right:30,bottom:120,left:60},m=l-z.left-z.right,N=u-z.top-z.bottom,E=wt(s).append("svg").attr("width",l).attr("height",u).attr("viewBox",`0 0 ${l} ${u}`).append("g").attr("transform",`translate(${z.left}, ${z.top})`),w=ki().domain(k.map(q=>q.category)).range([0,m]).padding(.2),tt=Pn().domain([0,a*1.1]).range([N,0]),Y=ur(w);E.append("g").attr("class","x-axis").attr("transform",`translate(0, ${N})`).call(Y).selectAll("text").attr("transform","rotate(-45)").style("text-anchor","end").attr("dx","-.8em").attr("dy",".15em").style("font-size","var(--font-size-xs)").style("fill","var(--text-color-primary)");const Z=cr(tt).ticks(5);E.append("g").attr("class","y-axis").call(Z).selectAll("text").style("font-size","var(--font-size-xs)").style("fill","var(--text-color-primary)"),E.append("text").attr("class","x-axis-label").attr("text-anchor","middle").attr("x",m/2).attr("y",N+z.bottom-10).style("font-size","var(--font-size-sm)").style("fill","var(--text-color-secondary)").text(it("viz.categories")),E.append("text").attr("class","y-axis-label").attr("text-anchor","middle").attr("transform","rotate(-90)").attr("x",-N/2).attr("y",-z.left+15).style("font-size","var(--font-size-sm)").style("fill","var(--text-color-secondary)").text(it("viz.number_of_items")),E.selectAll(".bar").data(k).enter().append("rect").attr("class","bar").attr("x",q=>w(q.category)||0).attr("y",q=>tt(q.count)).attr("width",w.bandwidth()).attr("height",q=>N-tt(q.count)).attr("fill",(q,et)=>h(q.category)).attr("rx",3).attr("ry",3).style("stroke","white").style("stroke-width",1).on("mouseenter",function(q,et){wt(this).transition().duration(200).attr("fill",oe(h(et.category)).brighter(.5).toString()),M(q,et)}).on("mousemove",function(q,et){M(q,et)}).on("mouseleave",function(q,et){wt(this).transition().duration(200).attr("fill",h(et.category)),C()}),E.selectAll(".bar-label").data(k).enter().append("text").attr("class","bar-label").attr("x",q=>(w(q.category)||0)+w.bandwidth()/2).attr("y",q=>tt(q.count)-5).attr("text-anchor","middle").style("font-size","var(--font-size-xs)").style("fill","var(--text-color-secondary)").text(q=>q.count)}catch(k){console.error("Error creating bar chart:",k)}}Te(()=>{let k;return(async()=>{try{if(await Ve(),!s){console.error("Container element not found");return}D(),r.items&&r.items.length>0?b():Kt.loadItems(),k=new ResizeObserver(()=>{s&&b()}),k.observe(s)}catch(z){console.error("Error in initialization:",z)}})(),()=>{try{k&&k.disconnect(),s&&wt(s).selectAll("*").remove(),c&&document.body.contains(c)&&document.body.removeChild(c)}catch(z){console.error("Error during cleanup:",z)}}});function A(k){ke[k?"unshift":"push"](()=>{s=k,n(0,s)})}return t.$$.update=()=>{t.$$.dirty&3&&r.items&&s&&b()},v(),[s,r,i,o,f,g,A]}class lg extends pe{constructor(e){super(),he(this,e,ag,ig,ce,{})}}function Oo(t,e,n){const r=t.slice();return r[52]=e[n],r}function Po(t,e,n){const r=t.slice();return r[55]=e[n],r}function Yo(t,e,n){const r=t.slice();return r[55]=e[n],r}function Wo(t){let e,n=t[55].label+"",r,i,o=t[27](t[55].count)+"",a,l,u;return{c(){e=S("option"),r=H(n),i=H(" ("),a=H(o),l=H(")"),e.__value=u=t[55].value,e.value=e.__value},m(s,c){Q(s,e,c),p(e,r),p(e,i),p(e,a),p(e,l)},p(s,c){c[0]&32&&n!==(n=s[55].label+"")&&ot(r,n),c[0]&32&&o!==(o=s[27](s[55].count)+"")&&ot(a,o),c[0]&32&&u!==(u=s[55].value)&&(e.__value=u,e.value=e.__value)},d(s){s&&J(e)}}}function Bo(t){let e,n=t[55].label+"",r,i,o=t[27](t[55].count)+"",a,l,u;return{c(){e=S("option"),r=H(n),i=H(" ("),a=H(o),l=H(")"),e.__value=u=t[55].value,e.value=e.__value},m(s,c){Q(s,e,c),p(e,r),p(e,i),p(e,a),p(e,l)},p(s,c){c[0]&64&&n!==(n=s[55].label+"")&&ot(r,n),c[0]&64&&o!==(o=s[27](s[55].count)+"")&&ot(a,o),c[0]&64&&u!==(u=s[55].value)&&(e.__value=u,e.value=e.__value)},d(s){s&&J(e)}}}function qo(t){let e,n=t[11].replace("{0}",t[27](t[7])).replace("{1}",t[4].length.toString())+"",r;return{c(){e=S("span"),r=H(n)},m(i,o){Q(i,e,o),p(e,r)},p(i,o){o[0]&2192&&n!==(n=i[11].replace("{0}",i[27](i[7])).replace("{1}",i[4].length.toString())+"")&&ot(r,n)},d(i){i&&J(e)}}}function sg(t){let e,n=t[3].error+"",r;return{c(){e=S("div"),r=H(n),_(e,"class","error svelte-1ftjyys")},m(i,o){Q(i,e,o),p(e,r)},p(i,o){o[0]&8&&n!==(n=i[3].error+"")&&ot(r,n)},d(i){i&&J(e)}}}function ug(t){let e;return{c(){e=S("div"),e.textContent=`${it("ui.loading")}`,_(e,"class","loading svelte-1ftjyys")},m(n,r){Q(n,e,r)},p:Ft,d(n){n&&J(e)}}}function Vo(t){var Dt,ct;let e,n,r,i,o,a,l,u,s=t[27](t[7])+"",c,d,f,h,g,y,v=(((Dt=t[4][0])==null?void 0:Dt.monthFormatted)||"")+"",T,D,M=(((ct=t[4][t[4].length-1])==null?void 0:ct.monthFormatted)||"")+"",C,b,A,k,L,z,m=t[27](Math.round(t[7]/(t[4].length||1)))+"",N,R,E,w,tt,Y,Z,q=[...t[4]].sort(Ko).slice(0,3),et=[];for(let nt=0;nt<q.length;nt+=1)et[nt]=Xo(Oo(t,q,nt));return{c(){e=S("div"),n=S("h3"),r=H(t[12]),i=ht(),o=S("p"),a=H(t[13]),l=H(": "),u=S("strong"),c=H(s),d=ht(),f=S("p"),h=H(t[14]),g=H(": "),y=S("strong"),T=H(v),D=H(" to "),C=H(M),b=ht(),A=S("p"),k=H(t[15]),L=H(": "),z=S("strong"),N=H(m),R=ht(),E=S("div"),w=S("h3"),tt=H(t[16]),Y=ht(),Z=S("ul");for(let nt=0;nt<et.length;nt+=1)et[nt].c();_(n,"class","svelte-1ftjyys"),_(e,"class","stat-summary svelte-1ftjyys"),_(w,"class","svelte-1ftjyys"),_(Z,"class","svelte-1ftjyys"),_(E,"class","peak-months svelte-1ftjyys")},m(nt,V){Q(nt,e,V),p(e,n),p(n,r),p(e,i),p(e,o),p(o,a),p(o,l),p(o,u),p(u,c),p(e,d),p(e,f),p(f,h),p(f,g),p(f,y),p(y,T),p(y,D),p(y,C),p(e,b),p(e,A),p(A,k),p(A,L),p(A,z),p(z,N),Q(nt,R,V),Q(nt,E,V),p(E,w),p(w,tt),p(E,Y),p(E,Z);for(let bt=0;bt<et.length;bt+=1)et[bt]&&et[bt].m(Z,null)},p(nt,V){var bt,kt;if(V[0]&4096&&ot(r,nt[12]),V[0]&8192&&ot(a,nt[13]),V[0]&128&&s!==(s=nt[27](nt[7])+"")&&ot(c,s),V[0]&16384&&ot(h,nt[14]),V[0]&16&&v!==(v=(((bt=nt[4][0])==null?void 0:bt.monthFormatted)||"")+"")&&ot(T,v),V[0]&16&&M!==(M=(((kt=nt[4][nt[4].length-1])==null?void 0:kt.monthFormatted)||"")+"")&&ot(C,M),V[0]&32768&&ot(k,nt[15]),V[0]&144&&m!==(m=nt[27](Math.round(nt[7]/(nt[4].length||1)))+"")&&ot(N,m),V[0]&65536&&ot(tt,nt[16]),V[0]&134348944){q=[...nt[4]].sort(Ko).slice(0,3);let ut;for(ut=0;ut<q.length;ut+=1){const at=Oo(nt,q,ut);et[ut]?et[ut].p(at,V):(et[ut]=Xo(at),et[ut].c(),et[ut].m(Z,null))}for(;ut<et.length;ut+=1)et[ut].d(1);et.length=q.length}},d(nt){nt&&J(e),nt&&J(R),nt&&J(E),mn(et,nt)}}}function Xo(t){let e,n,r=t[52].monthFormatted+"",i,o,a,l=t[27](t[52].count)+"",u,s,c,d,f=(t[52].count/(t[7]||1)*100).toFixed(1)+"",h,g,y;return{c(){e=S("li"),n=S("span"),i=H(r),o=ht(),a=S("span"),u=H(l),s=ht(),c=H(t[17]),d=H(" ("),h=H(f),g=H("%)"),y=ht(),_(n,"class","month-name svelte-1ftjyys"),_(a,"class","month-count svelte-1ftjyys"),_(e,"class","svelte-1ftjyys")},m(v,T){Q(v,e,T),p(e,n),p(n,i),p(e,o),p(e,a),p(a,u),p(a,s),p(a,c),p(a,d),p(a,h),p(a,g),p(e,y)},p(v,T){T[0]&16&&r!==(r=v[52].monthFormatted+"")&&ot(i,r),T[0]&16&&l!==(l=v[27](v[52].count)+"")&&ot(u,l),T[0]&131072&&ot(c,v[17]),T[0]&144&&f!==(f=(v[52].count/(v[7]||1)*100).toFixed(1)+"")&&ot(h,f)},d(v){v&&J(e)}}}function cg(t){let e,n,r,i,o,a,l,u,s,c,d,f,h,g,y,v,T,D,M,C,b,A,k=t[5],L=[];for(let Y=0;Y<k.length;Y+=1)L[Y]=Wo(Yo(t,k,Y));let z=t[6],m=[];for(let Y=0;Y<z.length;Y+=1)m[Y]=Bo(Po(t,z,Y));let N=t[4].length>0&&qo(t);function R(Y,Z){if(Y[3].loading)return ug;if(Y[3].error)return sg}let E=R(t),w=E&&E(t),tt=t[4].length>0&&Vo(t);return{c(){e=S("div"),n=S("div"),r=S("label"),i=H(t[9]),o=H(":"),a=ht(),l=S("select");for(let Y=0;Y<L.length;Y+=1)L[Y].c();u=ht(),s=S("div"),c=S("label"),d=H(t[10]),f=H(":"),h=ht(),g=S("select");for(let Y=0;Y<m.length;Y+=1)m[Y].c();y=ht(),v=S("div"),N&&N.c(),T=ht(),D=S("div"),w&&w.c(),M=ht(),C=S("div"),tt&&tt.c(),_(r,"for","country-filter"),_(r,"class","svelte-1ftjyys"),_(l,"id","country-filter"),_(l,"class","svelte-1ftjyys"),_(n,"class","filter-group svelte-1ftjyys"),_(c,"for","type-filter"),_(c,"class","svelte-1ftjyys"),_(g,"id","type-filter"),_(g,"class","svelte-1ftjyys"),_(s,"class","filter-group svelte-1ftjyys"),_(v,"class","summary svelte-1ftjyys"),_(e,"class","filters svelte-1ftjyys"),_(D,"class","chart-container svelte-1ftjyys"),_(C,"class","stats svelte-1ftjyys")},m(Y,Z){Q(Y,e,Z),p(e,n),p(n,r),p(r,i),p(r,o),p(n,a),p(n,l);for(let q=0;q<L.length;q+=1)L[q]&&L[q].m(l,null);He(l,t[0]),p(e,u),p(e,s),p(s,c),p(c,d),p(c,f),p(s,h),p(s,g);for(let q=0;q<m.length;q+=1)m[q]&&m[q].m(g,null);He(g,t[1]),p(e,y),p(e,v),N&&N.m(v,null),Q(Y,T,Z),Q(Y,D,Z),w&&w.m(D,null),t[31](D),Q(Y,M,Z),Q(Y,C,Z),tt&&tt.m(C,null),b||(A=[Qt(l,"change",t[28]),Qt(g,"change",t[29])],b=!0)},p(Y,Z){if(Z[0]&512&&ot(i,Y[9]),Z[0]&134217760){k=Y[5];let q;for(q=0;q<k.length;q+=1){const et=Yo(Y,k,q);L[q]?L[q].p(et,Z):(L[q]=Wo(et),L[q].c(),L[q].m(l,null))}for(;q<L.length;q+=1)L[q].d(1);L.length=k.length}if(Z[0]&33&&He(l,Y[0]),Z[0]&1024&&ot(d,Y[10]),Z[0]&134217792){z=Y[6];let q;for(q=0;q<z.length;q+=1){const et=Po(Y,z,q);m[q]?m[q].p(et,Z):(m[q]=Bo(et),m[q].c(),m[q].m(g,null))}for(;q<m.length;q+=1)m[q].d(1);m.length=z.length}Z[0]&66&&He(g,Y[1]),Y[4].length>0?N?N.p(Y,Z):(N=qo(Y),N.c(),N.m(v,null)):N&&(N.d(1),N=null),E===(E=R(Y))&&w?w.p(Y,Z):(w&&w.d(1),w=E&&E(Y),w&&(w.c(),w.m(D,null))),Y[4].length>0?tt?tt.p(Y,Z):(tt=Vo(Y),tt.c(),tt.m(C,null)):tt&&(tt.d(1),tt=null)},d(Y){Y&&J(e),mn(L,Y),mn(m,Y),N&&N.d(),Y&&J(T),Y&&J(D),w&&w.d(),t[31](null),Y&&J(M),Y&&J(C),tt&&tt.d(),b=!1,le(A)}}}function fg(t){let e,n,r;return n=new Tn({props:{title:"Timeline Distribution",titleHtml:t[8],descriptionTranslationKey:dg,$$slots:{default:[cg]},$$scope:{ctx:t}}}),{c(){e=S("div"),te(n.$$.fragment),_(e,"class","timeline-visualization-container svelte-1ftjyys")},m(i,o){Q(i,e,o),Gt(n,e,null),r=!0},p(i,o){const a={};o[0]&256&&(a.titleHtml=i[8]),o[0]&261887|o[1]&536870912&&(a.$$scope={dirty:o,ctx:i}),n.$set(a)},i(i){r||(Ot(n.$$.fragment,i),r=!0)},o(i){Yt(n.$$.fragment,i),r=!1},d(i){i&&J(e),jt(n)}}}const dg="viz.timeline_distribution_description",Ko=(t,e)=>e.count-t.count;function hg(t,e,n){let r,i,o,a,l,u,s,c,d,f,h;vt(t,Kt,O=>n(3,r=O)),vt(t,Zt,O=>n(30,i=O));let g="all",y="all",v=[],T=[],D=[],M=0,C="en",b="",A=0,k=0,L,z;const m=sn("%Y-%m"),N=sn("%b %Y"),R=lt("viz.filter_by_country");vt(t,R,O=>n(9,o=O));const E=lt("viz.filter_by_type");vt(t,E,O=>n(10,a=O)),lt("viz.no_data");const w=lt("viz.summary");vt(t,w,O=>n(12,u=O));const tt=lt("viz.total_items");vt(t,tt,O=>n(13,s=O));const Y=lt("viz.time_period");vt(t,Y,O=>n(14,c=O));const Z=lt("viz.avg_monthly_additions");vt(t,Z,O=>n(15,d=O));const q=lt("viz.peak_growth_months");vt(t,q,O=>n(16,f=O));const et=lt("viz.showing_items_over_months");vt(t,et,O=>n(11,l=O));const Dt=lt("viz.items");vt(t,Dt,O=>n(17,h=O)),lt("viz.timeline_distribution_items"),lt("viz.monthly_additions"),lt("viz.month");function ct(O){return O.toLocaleString(C==="fr"?"fr-FR":"en-US")}function nt(){if(M>0){const O=ct(M);return it("viz.timeline_distribution_items",[O])}else return it("viz.timeline_distribution_title")}function V(){console.log("[TimelineDistribution] Updating title with count:",M),n(8,b=nt())}Zt.subscribe(O=>{console.log("[TimelineDistribution] Language changed to:",O),C=O,kt(),L&&r.items&&r.items.length>0&&x()});function bt(){if(!r.items||r.items.length===0)return[];const O=new Date(2024,3,1);let G=0;const K=dt=>!(!dt.created_date||g!=="all"&&dt.country!==g||y!=="all"&&dt.type!==y);G=r.items.filter(dt=>K(dt)?new Date(dt.created_date)<O:!1).length;let B=r.items.filter(dt=>K(dt)?new Date(dt.created_date)>=O:!1);if(n(7,M=G+B.length),B.length===0)return[];const I=new Map;B.forEach(dt=>{const X=new Date(dt.created_date),gt=m(X);I.set(gt,(I.get(gt)||0)+1)});const pt=Array.from(I.entries()).map(([dt,X])=>{const[gt,St]=dt.split("-").map(Number),_t=new Date(gt,St-1,1);return{date:_t,month:dt,monthFormatted:N(_t),count:X,total:0,percentage:0}}).sort((dt,X)=>dt.date.getTime()-X.date.getTime());let Mt=G;return pt.forEach(dt=>{Mt+=dt.count,dt.total=Mt,dt.percentage=dt.count/B.length*100}),on(pt,dt=>dt.count),on(pt,dt=>dt.total),pt}function kt(){if(!r.items||r.items.length===0)return;const O=new Date(2024,3,1),G=r.items.filter(B=>B.created_date?new Date(B.created_date)>=O:!1),K=Be(G,B=>B.length,B=>B.country||"Unknown");n(5,T=[{value:"all",label:it("country.all"),count:G.length},...Array.from(K,([B,I])=>({value:B,label:it(`country.${B}`),count:I})).filter(B=>B.value!=="Unknown").sort((B,I)=>I.count-B.count)]);const U=Be(G,B=>B.length,B=>B.type||"Unknown");n(6,D=[{value:"all",label:it("type.all"),count:G.length},...Array.from(U,([B,I])=>({value:B,label:it(`type.${B}`),count:I})).filter(B=>B.value!=="Unknown").sort((B,I)=>I.count-B.count)])}function ut(){try{z&&document.body.contains(z)&&document.body.removeChild(z),z=document.createElement("div"),z.style.position="absolute",z.style.backgroundColor="rgba(0, 0, 0, 0.8)",z.style.color="white",z.style.padding="8px 12px",z.style.borderRadius="4px",z.style.pointerEvents="none",z.style.display="none",z.style.fontSize="12px",z.style.zIndex="1000",z.style.boxShadow="0 2px 5px rgba(0,0,0,0.2)",document&&document.body&&document.body.appendChild(z)}catch(O){console.error("Error creating tooltip:",O)}}function at(O,G,K){try{if((!z||!document.body.contains(z))&&ut(),!z)return;const U=G.date.toLocaleString("default",{month:"long"}),B=G.date.getFullYear();K==="monthly"?z.innerHTML=`
                    <div style="font-weight:bold;margin-bottom:4px;border-bottom:1px solid rgba(255,255,255,0.3);padding-bottom:2px;">
                        ${U} ${B}
                    </div>
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:4px;">
                        <span>New Items:</span><span style="text-align:right;font-weight:bold;">${G.count}</span>
                        <span>Percentage:</span><span style="text-align:right;font-weight:bold;">${G.percentage.toFixed(2)}%</span>
                    </div>
                `:z.innerHTML=`
                    <div style="font-weight:bold;margin-bottom:4px;border-bottom:1px solid rgba(255,255,255,0.3);padding-bottom:2px;">
                        ${U} ${B}
                    </div>
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:4px;">
                        <span>Total Items:</span><span style="text-align:right;font-weight:bold;">${G.total}</span>
                    </div>
                `;const I=200,pt=100;let Mt=O.pageX+10,dt=O.pageY+10;Mt+I>window.innerWidth&&(Mt=O.pageX-I-10),dt+pt>window.innerHeight&&(dt=O.pageY-pt-10),z.style.left=`${Mt}px`,z.style.top=`${dt}px`,z.style.display="block"}catch(U){console.error("Error showing tooltip:",U)}}function st(){try{z&&document.body.contains(z)&&(z.style.display="none")}catch(O){console.error("Error hiding tooltip:",O)}}function x(){if(!L){console.error("[TimelineDistribution] Container element not found in createTimeline");return}const O=bt();if(!O||O.length===0){wt(L).select("svg").remove(),wt(L).append("div").attr("class","no-data").style("position","absolute").style("top","50%").style("left","50%").style("transform","translate(-50%, -50%)").style("text-align","center").style("color","var(--text-color-secondary)").text("No timeline data available with the current filters");return}n(4,v=O),wt(L).select("svg").remove(),wt(L).select(".no-data").remove();const G=L.getBoundingClientRect();A=G.width,k=G.height-50;const K=wt(L).append("svg").attr("width",A).attr("height",k).attr("viewBox",`0 0 ${A} ${k}`),U={top:30,right:60,bottom:50,left:70},B=A-U.left-U.right,I=(k-U.top-U.bottom-50)/2,pt=op().domain(us(O,rt=>rt.date)).range([0,B]);K.append("line").attr("x1",U.left).attr("y1",U.top+I+25).attr("x2",A-U.right).attr("y2",U.top+I+25).attr("stroke","var(--divider-color)").attr("stroke-width",1).attr("stroke-dasharray","3,3");const Mt=K.append("g").attr("transform",`translate(${A-U.right}, ${U.top-10})`);Mt.append("line").attr("x1",-100).attr("y1",0).attr("x2",-80).attr("y2",0).attr("stroke","var(--primary-color)").attr("stroke-width",2).attr("marker-end","url(#circle)"),Mt.append("text").attr("x",-75).attr("y",4).attr("fill","var(--text-color-primary)").attr("font-size","var(--font-size-sm)").text(it("viz.monthly_additions")),Mt.append("line").attr("x1",-100).attr("y1",20).attr("x2",-80).attr("y2",20).attr("stroke","var(--secondary-color)").attr("stroke-width",2).attr("stroke-dasharray","4 2"),Mt.append("text").attr("x",-75).attr("y",24).attr("fill","var(--text-color-primary)").attr("font-size","var(--font-size-sm)").text(it("viz.total_items")),K.append("defs").append("marker").attr("id","circle").attr("viewBox","-5 -5 10 10").attr("refX",0).attr("refY",0).attr("markerWidth",5).attr("markerHeight",5).append("circle").attr("r",3).attr("fill","var(--primary-color)");const dt=K.append("g").attr("transform",`translate(${U.left}, ${U.top})`),X=Pn().domain([0,(on(O,rt=>rt.count)||0)*1.1]).range([I,0]);dt.append("g").attr("class","grid").selectAll("line").data(X.ticks(5)).enter().append("line").attr("x1",0).attr("x2",B).attr("y1",rt=>X(rt)).attr("y2",rt=>X(rt)).attr("stroke","var(--divider-color)").attr("stroke-width",.5),dt.append("g").attr("class","x-axis").attr("transform",`translate(0, ${I})`).call(ur(pt).ticks(Yn.every(1)).tickFormat(sn("%Y-%m"))).selectAll("text").style("font-size","var(--font-size-xs)").style("fill","var(--text-color-primary)").style("text-anchor","end").attr("dx","-.8em").attr("dy",".15em").attr("transform","rotate(-45)"),dt.append("g").attr("class","y-axis").call(cr(X).ticks(5)).selectAll("text").style("font-size","var(--font-size-xs)").style("fill","var(--text-color-primary)"),dt.append("text").attr("class","axis-label").attr("transform","rotate(-90)").attr("y",-55).attr("x",-I/2).attr("text-anchor","middle").style("font-size","var(--font-size-sm)").style("fill","var(--text-color-secondary)").text(it("viz.monthly_additions"));const gt=bo().x(rt=>pt(rt.date)).y(rt=>X(rt.count)).curve(To);dt.append("path").datum(O).attr("fill","none").attr("stroke","var(--primary-color)").attr("stroke-width",2).attr("d",gt),dt.selectAll(".dot-monthly").data(O).enter().append("circle").attr("class","dot-monthly").attr("cx",rt=>pt(rt.date)).attr("cy",rt=>X(rt.count)).attr("r",4).attr("fill","var(--primary-color)").attr("stroke","white").attr("stroke-width",1).on("mouseenter",function(rt,Nt){wt(this).transition().duration(200).attr("r",6),at(rt,Nt,"monthly")}).on("mousemove",function(rt,Nt){at(rt,Nt,"monthly")}).on("mouseleave",function(){wt(this).transition().duration(200).attr("r",4),st()});const St=K.append("g").attr("transform",`translate(${U.left}, ${U.top+I+50})`),_t=Pn().domain([0,(on(O,rt=>rt.total)||0)*1.1]).range([I,0]);St.append("g").attr("class","grid").selectAll("line").data(_t.ticks(5)).enter().append("line").attr("x1",0).attr("x2",B).attr("y1",rt=>_t(rt)).attr("y2",rt=>_t(rt)).attr("stroke","var(--divider-color)").attr("stroke-width",.5),St.append("g").attr("class","x-axis").attr("transform",`translate(0, ${I})`).call(ur(pt).ticks(Yn.every(1)).tickFormat(sn("%Y-%m"))).selectAll("text").style("font-size","var(--font-size-xs)").style("fill","var(--text-color-primary)").style("text-anchor","end").attr("dx","-.8em").attr("dy",".15em").attr("transform","rotate(-45)"),St.append("g").attr("class","y-axis").call(cr(_t).ticks(5)).selectAll("text").style("font-size","var(--font-size-xs)").style("fill","var(--text-color-primary)"),St.append("text").attr("class","axis-label").attr("transform","rotate(-90)").attr("y",-55).attr("x",-I/2).attr("text-anchor","middle").style("font-size","var(--font-size-sm)").style("fill","var(--text-color-secondary)").text(it("viz.total_items")),St.append("text").attr("class","axis-label").attr("text-anchor","middle").attr("x",B/2).attr("y",I+50).style("font-size","var(--font-size-sm)").style("fill","var(--text-color-secondary)").text(it("viz.month"));const It=bo().x(rt=>pt(rt.date)).y(rt=>_t(rt.total)).curve(To);St.append("path").datum(O).attr("fill","none").attr("stroke","var(--secondary-color)").attr("stroke-width",2).attr("stroke-dasharray","4 2").attr("d",It),St.selectAll(".dot-total").data(O).enter().append("circle").attr("class","dot-total").attr("cx",rt=>pt(rt.date)).attr("cy",rt=>_t(rt.total)).attr("r",4).attr("fill","var(--secondary-color)").attr("stroke","white").attr("stroke-width",1).on("mouseenter",function(rt,Nt){wt(this).transition().duration(200).attr("r",6),at(rt,Nt,"total")}).on("mousemove",function(rt,Nt){at(rt,Nt,"total")}).on("mouseleave",function(){wt(this).transition().duration(200).attr("r",4),st()})}function W(O){const G=O.target;n(0,g=G.value),x()}function ft(O){const G=O.target;n(1,y=G.value),x()}Te(async()=>{if(console.log("[TimelineDistribution] Component mounted"),await Ve(),ut(),(!r.items||r.items.length===0)&&(console.log("[TimelineDistribution] No items loaded, waiting for data"),await Kt.loadItems()),await Ve(),!L){console.error("[TimelineDistribution] Container element not found after waiting");return}console.log("[TimelineDistribution] Container found, generating visualization"),kt(),x();const O=new ResizeObserver(()=>{L&&x()});return O.observe(L),()=>{O.disconnect(),z&&document.body.contains(z)&&document.body.removeChild(z)}});function $(O){ke[O?"unshift":"push"](()=>{L=O,n(2,L)})}return t.$$.update=()=>{t.$$.dirty[0]&11&&r.items&&r.items.length>0&&(console.log("[TimelineDistribution] Items loaded, updating title"),n(7,M=r.items.filter(O=>!(g!=="all"&&O.country!==g||y!=="all"&&O.type!==y)).length),V()),t.$$.dirty[0]&1073741824&&V(),t.$$.dirty[0]&12&&r.items&&L&&(kt(),x())},[g,y,L,r,v,T,D,M,b,o,a,l,u,s,c,d,f,h,R,E,w,tt,Y,Z,q,et,Dt,ct,W,ft,i,$]}class pg extends pe{constructor(e){super(),he(this,e,hg,fg,ce,{},null,[-1,-1])}}function Zo(t,e,n){const r=t.slice();return r[51]=e[n],r}function Go(t){let e,n;return{c(){e=ne("svg"),n=ne("path"),_(n,"fill","currentColor"),_(n,"d","M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"),_(e,"viewBox","0 0 24 24"),_(e,"width","14"),_(e,"height","14")},m(r,i){Q(r,e,i),p(e,n)},d(r){r&&J(e)}}}function jo(t){let e,n,r,i,o=t[51].label+"",a,l,u,s=t[51].count+"",c,d,f,h,g,y=t[51].selected&&Go();function v(){return t[17](t[51])}function T(...D){return t[18](t[51],...D)}return{c(){e=S("div"),n=S("span"),y&&y.c(),r=ht(),i=S("span"),a=H(o),l=ht(),u=S("span"),c=H(s),d=ht(),_(n,"class","facet-checkbox svelte-9ogxkf"),_(i,"class","facet-label svelte-9ogxkf"),_(u,"class","facet-count svelte-9ogxkf"),_(e,"class","facet-option svelte-9ogxkf"),_(e,"role","checkbox"),_(e,"aria-checked",f=t[51].selected),_(e,"tabindex","0"),Ue(e,"selected",t[51].selected)},m(D,M){Q(D,e,M),p(e,n),y&&y.m(n,null),p(e,r),p(e,i),p(i,a),p(e,l),p(e,u),p(u,c),p(e,d),h||(g=[Qt(e,"click",v),Qt(e,"keydown",T)],h=!0)},p(D,M){t=D,t[51].selected?y||(y=Go(),y.c(),y.m(n,null)):y&&(y.d(1),y=null),M[0]&2&&o!==(o=t[51].label+"")&&ot(a,o),M[0]&2&&s!==(s=t[51].count+"")&&ot(c,s),M[0]&2&&f!==(f=t[51].selected)&&_(e,"aria-checked",f),M[0]&2&&Ue(e,"selected",t[51].selected)},d(D){D&&J(e),y&&y.d(),h=!1,le(g)}}}function gg(t){let e,n=t[5].error+"",r;return{c(){e=S("div"),r=H(n),_(e,"class","error svelte-9ogxkf")},m(i,o){Q(i,e,o),p(e,r)},p(i,o){o[0]&32&&n!==(n=i[5].error+"")&&ot(r,n)},d(i){i&&J(e)}}}function mg(t){let e;return{c(){e=S("div"),e.textContent=`${it("ui.loading")}`,_(e,"class","loading svelte-9ogxkf")},m(n,r){Q(n,e,r)},p:Ft,d(n){n&&J(e)}}}function yg(t){let e,n,r,i,o,a,l,u,s,c,d,f,h,g,y,v,T=t[3][0]+"",D,M,C,b=t[3][1]+"",A,k,L,z,m,N,R,E,w,tt,Y,Z,q,et,Dt,ct,nt=t[1],V=[];for(let at=0;at<nt.length;at+=1)V[at]=jo(Zo(t,nt,at));function bt(at,st){if(at[5].loading)return mg;if(at[5].error)return gg}let kt=bt(t),ut=kt&&kt(t);return{c(){e=S("div"),n=S("div"),r=S("div"),i=S("div"),o=S("h3"),a=H(t[6]),l=ht(),u=S("div");for(let at=0;at<V.length;at+=1)V[at].c();s=ht(),c=S("div"),d=S("h3"),f=H(t[7]),h=ht(),g=S("div"),y=S("div"),v=S("span"),D=H(T),M=ht(),C=S("span"),A=H(b),k=ht(),L=S("div"),z=S("input"),E=ht(),w=S("input"),q=ht(),et=S("div"),ut&&ut.c(),_(o,"class","svelte-9ogxkf"),_(u,"class","facet-options table-layout svelte-9ogxkf"),_(i,"class","facet-group svelte-9ogxkf"),_(r,"class","facets svelte-9ogxkf"),_(d,"class","svelte-9ogxkf"),_(y,"class","slider-labels svelte-9ogxkf"),_(z,"type","range"),_(z,"min",m=t[2][0]),_(z,"max",N=t[2][t[2].length-1]),z.value=R=t[3][0],_(z,"data-index","0"),_(z,"class","svelte-9ogxkf"),_(w,"type","range"),_(w,"min",tt=t[2][0]),_(w,"max",Y=t[2][t[2].length-1]),w.value=Z=t[3][1],_(w,"data-index","1"),_(w,"class","svelte-9ogxkf"),_(L,"class","slider-inputs svelte-9ogxkf"),_(g,"class","slider-container svelte-9ogxkf"),_(c,"class","year-range svelte-9ogxkf"),_(n,"class","controls-container svelte-9ogxkf"),_(et,"class","chart-container svelte-9ogxkf"),_(e,"class","type-distribution-container svelte-9ogxkf")},m(at,st){Q(at,e,st),p(e,n),p(n,r),p(r,i),p(i,o),p(o,a),p(i,l),p(i,u);for(let x=0;x<V.length;x+=1)V[x]&&V[x].m(u,null);p(n,s),p(n,c),p(c,d),p(d,f),p(c,h),p(c,g),p(g,y),p(y,v),p(v,D),p(y,M),p(y,C),p(C,A),p(g,k),p(g,L),p(L,z),p(L,E),p(L,w),p(e,q),p(e,et),ut&&ut.m(et,null),t[19](et),Dt||(ct=[Qt(z,"input",t[15]),Qt(w,"input",t[15])],Dt=!0)},p(at,st){if(st[0]&64&&ot(a,at[6]),st[0]&16386){nt=at[1];let x;for(x=0;x<nt.length;x+=1){const W=Zo(at,nt,x);V[x]?V[x].p(W,st):(V[x]=jo(W),V[x].c(),V[x].m(u,null))}for(;x<V.length;x+=1)V[x].d(1);V.length=nt.length}st[0]&128&&ot(f,at[7]),st[0]&8&&T!==(T=at[3][0]+"")&&ot(D,T),st[0]&8&&b!==(b=at[3][1]+"")&&ot(A,b),st[0]&4&&m!==(m=at[2][0])&&_(z,"min",m),st[0]&4&&N!==(N=at[2][at[2].length-1])&&_(z,"max",N),st[0]&8&&R!==(R=at[3][0])&&(z.value=R),st[0]&4&&tt!==(tt=at[2][0])&&_(w,"min",tt),st[0]&4&&Y!==(Y=at[2][at[2].length-1])&&_(w,"max",Y),st[0]&8&&Z!==(Z=at[3][1])&&(w.value=Z),kt===(kt=bt(at))&&ut?ut.p(at,st):(ut&&ut.d(1),ut=kt&&kt(at),ut&&(ut.c(),ut.m(et,null)))},d(at){at&&J(e),mn(V,at),ut&&ut.d(),t[19](null),Dt=!1,le(ct)}}}function _g(t){let e,n;return e=new Tn({props:{title:"",translationKey:"",description:"This visualization shows the distribution of items by type over time. You can filter by country and year range to explore how different types of items have been published over time.",descriptionTranslationKey:"viz.type_distribution_description",titleHtml:t[4],$$slots:{default:[yg]},$$scope:{ctx:t}}}),{c(){te(e.$$.fragment)},m(r,i){Gt(e,r,i),n=!0},p(r,i){const o={};i[0]&16&&(o.titleHtml=r[4]),i[0]&239|i[1]&8388608&&(o.$$scope={dirty:i,ctx:r}),e.$set(o)},i(r){n||(Ot(e.$$.fragment,r),n=!0)},o(r){Yt(e.$$.fragment,r),n=!1},d(r){jt(e,r)}}}const Me="TypeDistribution";function Qn(t){return t?/^\d{4}$/.test(t)?parseInt(t):/^\d{4}-\d{2}$/.test(t)||/^\d{4}-\d{2}-\d{2}$/.test(t)?parseInt(t.substring(0,4)):null:null}function vg(t,e,n){let r,i,o,a,l,u,s;vt(t,Kt,x=>n(5,r=x));let c=!1,d,f,h=null,g,y,v=0,T=0,D=[],M=[],C=[0,0],b=[],A=0,k=[];const L=lt("viz.no_data");vt(t,L,x=>n(33,l=x)),lt("viz.filter_by_country"),lt("viz.all_countries"),lt("viz.publication_year");const z=lt("viz.year");vt(t,z,x=>n(32,a=x));const m=lt("viz.number_of_items");vt(t,m,x=>n(31,o=x));const N=lt("viz.toggle_types");vt(t,N,x=>n(30,i=x)),lt("viz.toggled_type");const R=lt("viz.countries");vt(t,R,x=>n(6,u=x));const E=lt("viz.time_period");vt(t,E,x=>n(7,s=x)),lt("viz.summary"),lt("viz.showing_items_over_months"),lt("viz.types"),lt("viz.published_between");let w="";function tt(){if(A>0){const x=A.toLocaleString();n(4,w=it("viz.type_distribution_items",[x]))}else n(4,w=it("viz.type_distribution_title"));console.log("Type Distribution Title updated:",w)}function Y(){if(!c||!r.items||r.items.length===0)return[];const x=D.filter(G=>G.selected).map(G=>G.value),W=x.includes("all"),ft=r.items.filter(G=>{if(G.type==="Notice d'autorité")return!1;const K=Qn(G.publication_date);return!(!K||K<C[0]||K>C[1]||!G.country||G.country.trim()===""||G.country==="Unknown"||!W&&!x.includes(G.country))});A=ft.length,tt();const $=new Map;ft.forEach(G=>{const K=Qn(G.publication_date);if(!K)return;const U=G.type||"Unknown",B=`${K}-${U}`;$.has(B)?$.set(B,$.get(B)+1):$.set(B,1)});const O=[];return $.forEach((G,K)=>{const[U,B]=K.split("-");O.push({year:parseInt(U),type:B,count:G})}),O}function Z(){var G;if(!c||!r.items||r.items.length===0)return;const x=r.items.filter(K=>K.type!=="Notice d'autorité");let W=x;C[0]>0&&C[1]>0&&(W=x.filter(K=>{const U=Qn(K.publication_date);return U!==null&&U>=C[0]&&U<=C[1]}));const ft=W.map(K=>K.country||"Unknown").filter(K=>K.trim()!==""&&K!=="Unknown"),$=Be(ft,K=>K.length,K=>K),O=W.filter(K=>K.country&&K.country.trim()!==""&&K.country!=="Unknown").length;n(1,D=[{value:"all",label:it("country.all"),count:O,selected:((G=D.find(K=>K.value==="all"))==null?void 0:G.selected)??!0},...Array.from($,([K,U])=>{var B;return{value:K,label:it(`country.${K}`)||K,count:U,selected:((B=D.find(I=>I.value===K))==null?void 0:B.selected)??!1}})]),D.sort((K,U)=>K.value==="all"?-1:U.value==="all"?1:K.label.localeCompare(U.label))}function q(){if(!c||!r.items||r.items.length===0)return;const x=r.items.filter($=>$.type!=="Notice d'autorité").map($=>Qn($.publication_date)).filter($=>$!==null);if(x.length===0)return;const W=Math.min(...x),ft=Math.max(...x);n(2,M=Array.from({length:ft-W+1},($,O)=>W+O)),(C[0]===0||C[1]===0)&&n(3,C=[W,ft])}function et(x){c&&(x.value==="all"?D.forEach(W=>{W.selected=W.value==="all"}):(D.find(W=>W.value==="all").selected=!1,x.selected=!x.selected,D.some(W=>W.selected)||(D.find(W=>W.value==="all").selected=!0)),n(1,D=[...D]),bt())}function Dt(x){const W=x.target,ft=parseInt(W.dataset.index||"0"),$=parseInt(W.value);ft===0?n(3,C=[$,Math.max($,C[1])]):n(3,C=[Math.min($,C[0]),$]),Z(),bt()}function ct(){try{y&&document.body.contains(y)&&document.body.removeChild(y),y=document.createElement("div"),y.style.position="absolute",y.style.backgroundColor="rgba(0, 0, 0, 0.8)",y.style.color="white",y.style.padding="8px 12px",y.style.borderRadius="4px",y.style.pointerEvents="none",y.style.display="none",y.style.fontSize="12px",y.style.zIndex="1000",y.style.boxShadow="0 2px 5px rgba(0,0,0,0.2)",document&&document.body&&document.body.appendChild(y)}catch(x){console.error("Error creating tooltip:",x),y=null}}function nt(x,W,ft){try{if((!y||!document.body.contains(y))&&ct(),!y)return;const $=W.data.year,O=ft.map(pt=>{const Mt=pt.find(dt=>dt.data.year===$);return{type:pt.key,count:Mt?Mt[1]-Mt[0]:0}}).filter(pt=>pt.count>0),G=O.reduce((pt,Mt)=>pt+Mt.count,0);y.innerHTML=`
                <div style="font-weight:bold;margin-bottom:4px;border-bottom:1px solid rgba(255,255,255,0.3);padding-bottom:2px;">
                    Year: ${$}
                </div>
                <div style="display:grid;grid-template-columns:auto 1fr 1fr;gap:4px;">
                    <span style="font-weight:bold">Type</span>
                    <span style="text-align:right;font-weight:bold">Count</span>
                    <span style="text-align:right;font-weight:bold">%</span>
                    ${O.map(pt=>`
                        <span>${pt.type}</span>
                        <span style="text-align:right">${pt.count}</span>
                        <span style="text-align:right">${(pt.count/G*100).toFixed(1)}%</span>
                    `).join("")}
                    <span style="border-top:1px solid rgba(255,255,255,0.3);font-weight:bold;margin-top:2px;padding-top:2px;">Total</span>
                    <span style="border-top:1px solid rgba(255,255,255,0.3);text-align:right;font-weight:bold;margin-top:2px;padding-top:2px;">${G}</span>
                    <span></span>
                </div>
            `;const K=250,U=150;let B=x.pageX+10,I=x.pageY+10;B+K>window.innerWidth&&(B=x.pageX-K-10),I+U>window.innerHeight&&(I=x.pageY-U-10),y.style.left=`${B}px`,y.style.top=`${I}px`,y.style.display="block"}catch($){console.error("Error showing tooltip:",$)}}function V(){try{y&&document.body.contains(y)&&(y.style.display="none")}catch(x){console.error("Error hiding tooltip:",x)}}function bt(){if(!c||!g||!document.body.contains(g)){console.error("Cannot update visualization - component not mounted or container not found");return}try{if(b=Y(),b.length===0){wt(g).select("svg").remove(),wt(g).select(".no-data").remove(),wt(g).append("div").attr("class","no-data").style("position","absolute").style("top","50%").style("left","50%").style("transform","translate(-50%, -50%)").style("text-align","center").style("color","var(--text-color-secondary)").text(l);return}if(!c||!document.body.contains(g))return;wt(g).select("svg").remove(),wt(g).select(".no-data").remove();const x=g.getBoundingClientRect();if(v=x.width,T=x.height,!c||!document.body.contains(g))return;let W={top:20,right:30,bottom:120,left:60};const ft=v-W.left-W.right,$=Array.from(new Set(b.map(F=>F.type)));if($.sort((F,j)=>{const $t=it(`type.${F}`)!==`type.${F}`?it(`type.${F}`):F,Tt=it(`type.${j}`)!==`type.${j}`?it(`type.${j}`):j;return $t.localeCompare(Tt)}),!c||!document.body.contains(g))return;if(k.length===0)k=$.map(F=>({type:F,visible:!0}));else{const F=k.map(j=>j.type);$.forEach(j=>{F.includes(j)||k.push({type:j,visible:!0})})}const O=150,G=6,K=Math.min(Math.floor(ft/O)||1,G),U=25,B=Math.ceil($.length/K);W.bottom=Math.max(W.bottom,B*U+70);const I=T-W.top-W.bottom;if(!c||!document.body.contains(g))return;const pt=Array.from(pn(b.filter(F=>{var j;return((j=k.find($t=>$t.type===F.type))==null?void 0:j.visible)??!0}),F=>F.year),([F,j])=>{const $t={year:F};return j.forEach(Tt=>{$t[Tt.type]=Tt.count}),$t}).sort((F,j)=>F.year-j.year),Mt=$.filter(F=>{var j;return((j=k.find($t=>$t.type===F))==null?void 0:j.visible)??!0});if(!c||!document.body.contains(g))return;const dt=wt(g).append("svg").attr("width",v).attr("height",T),X=dt.append("g").attr("transform",`translate(${W.left}, ${W.top})`),gt=ki().domain(pt.map(F=>F.year.toString())).range([0,ft]).padding(.1),St=kp().keys(Mt).value((F,j)=>F[j]||0)(pt),_t=Pn().domain([0,on(St.length>0?St[St.length-1]:[],F=>F[1])||0]).range([I,0]);if(!c||!document.body.contains(g))return;const It=["Press Article","Journal Article","Book Chapter","Doctoral Thesis","type.Article d'encyclopédie","type.Mémoire de maitrise","Book","type.Compte rendu de livre","type.Rapport","type.Working paper","type.Mémoire de licence","Islamic Periodical","Document","type.Photographie","Blog Post","Scientific Communication","type.Enregistrement vidéo","Article de presse","Article de revue","Chapitre de livre","Thèse de doctorat","Article d'encyclopédie","Mémoire de maitrise","Livre","Compte rendu de livre","Rapport","Working paper","Mémoire de licence","Périodique islamique","Document","Photographie","Article de blog","Communication scientifique","Enregistrement vidéo"],rt=De().domain(It).range(xn);if(X.append("g").attr("transform",`translate(0, ${I})`).call(ur(gt).tickValues(pt.filter(F=>F.year%5===0).map(F=>F.year.toString())).tickSizeOuter(0)).selectAll("text").style("text-anchor","end").attr("dx","-.8em").attr("dy",".15em").attr("transform","rotate(-45)").style("font-size","var(--font-size-xs)").style("fill","var(--text-color-primary)"),!c||!document.body.contains(g)||(X.append("g").call(cr(_t).ticks(5)).selectAll("text").style("font-size","var(--font-size-xs)").style("fill","var(--text-color-primary)"),X.append("text").attr("text-anchor","middle").attr("x",ft/2).attr("y",I+40).attr("fill","var(--text-color-secondary)").style("font-size","var(--font-size-sm)").text(a),X.append("text").attr("text-anchor","middle").attr("transform","rotate(-90)").attr("x",-I/2).attr("y",-W.left+15).attr("fill","var(--text-color-secondary)").style("font-size","var(--font-size-sm)").text(o),!c||!document.body.contains(g))||(X.selectAll(".type-bars").data(St).enter().append("g").attr("class","type-bars").attr("fill",F=>rt(F.key)).selectAll("rect").data(F=>F).enter().append("rect").attr("x",F=>gt(F.data.year.toString())||0).attr("y",F=>_t(F[1])).attr("height",F=>_t(F[0])-_t(F[1])).attr("width",gt.bandwidth()).attr("stroke","white").attr("stroke-width",1).on("mouseenter",(F,j)=>{c&&nt(F,j,St)}).on("mousemove",(F,j)=>{c&&nt(F,j,St)}).on("mouseleave",()=>{c&&V()}),!c||!document.body.contains(g)))return;const Nt=dt.append("g").attr("class","legend").attr("transform",`translate(${W.left}, ${W.top+I+60})`);Nt.append("text").attr("x",0).attr("y",-15).attr("font-size","var(--font-size-xs)").attr("font-weight","normal").attr("fill","var(--text-color-secondary)").text(i);const P=Nt.append("g").attr("class","legend-items").attr("transform","translate(0, 5)");if(!c||!document.body.contains(g))return;$.forEach((F,j)=>{var yt;if(!c||!document.body.contains(g))return;const $t=((yt=k.find(mt=>mt.type===F))==null?void 0:yt.visible)??!0,Tt=Math.floor(j/K),Et=j%K,xt=P.append("g").attr("transform",`translate(${Et*O}, ${Tt*U})`).attr("class","legend-item").attr("role","button").style("cursor","pointer");xt.append("rect").attr("x",-5).attr("y",-5).attr("width",O-10).attr("height",15).attr("fill","transparent").attr("class","legend-hitbox"),xt.append("rect").attr("width",10).attr("height",10).attr("fill",rt(F)).attr("stroke",$t?"none":"#999").attr("stroke-width",$t?0:1).attr("opacity",$t?1:.5);const At=`type.${F}`;let Rt=F;try{const mt=it(At);mt!==At&&(Rt=mt),console.log(`Type: ${F}, Translation key: ${At}, Result: ${Rt}`)}catch(mt){console.error(`Error translating type ${F}:`,mt)}const Ct=xt.append("text").attr("x",15).attr("y",8).attr("font-size","var(--font-size-xs)").attr("fill","var(--text-color-secondary)").style("opacity",$t?1:.5).text(Rt);if(!$t){const mt=Ct.node();if(mt){const Ht=mt.getComputedTextLength();xt.append("line").attr("x1",15).attr("y1",8).attr("x2",15+Ht).attr("y2",8).attr("stroke","var(--text-color-secondary)").attr("stroke-width",1).attr("opacity",.7)}}xt.on("click",()=>{if(!c)return;console.log(`Clicked on type: ${F}`),wt(g).append("div").attr("class","debug-message").style("position","fixed").style("bottom","10px").style("left","10px").style("background","rgba(0,0,0,0.7)").style("color","white").style("padding","5px 10px").style("border-radius","4px").style("z-index",9999).text(`Toggled type: ${F}`).transition().duration(2e3).style("opacity",0).remove();const mt=k.findIndex(Ht=>Ht.type===F);mt>=0&&c&&(k[mt].visible=!k[mt].visible,k=[...k],Z(),bt())}).attr("tabindex","0").on("keydown",mt=>{if(c&&(mt.key==="Enter"||mt.key===" ")){mt.preventDefault();const Ht=k.findIndex(fe=>fe.type===F);Ht>=0&&c&&(k[Ht].visible=!k[Ht].visible,k=[...k],Z(),bt())}}),xt.on("mouseenter",function(){c&&(wt(this).select("text").style("font-weight","bold"),wt(this).select(".legend-hitbox").attr("fill","rgba(0,0,0,0.05)"))}).on("mouseleave",function(){c&&(wt(this).select("text").style("font-weight","normal"),wt(this).select(".legend-hitbox").attr("fill","transparent"))})})}catch(x){console.error("Error updating visualization:",x)}}function kt(x){!c||!g||!document.body.contains(g)||(zt(Me,"Items store changed",{itemCount:(x==null?void 0:x.length)||0}),c&&document.body.contains(g)&&(Z(),q(),bt(),tt()))}Te(()=>{n(16,c=!0),zt(Me,"Component mounted");let x=!0;return Ve().then(()=>{if(!x||!c||!g){console.error("Container element not found in onMount or component unmounted");return}ct(),d=Kt.subscribe(W=>{x&&c&&kt(W.items)}),f=Zt.subscribe(W=>{!x||!c||x&&c&&g&&document.body.contains(g)&&(Z(),tt(),bt())}),x&&c&&r.items&&r.items.length>0?(Z(),q(),bt()):x&&c&&Kt.loadItems(),h=new ResizeObserver(()=>{!x||!c||x&&c&&g&&document.body.contains(g)&&bt()}),h&&g&&h.observe(g)}),()=>{if(x=!1,n(16,c=!1),zt(Me,"Component cleanup started"),h){try{h.disconnect(),zt(Me,"Resize observer disconnected")}catch(W){console.error("Error disconnecting resize observer:",W)}h=null}try{y&&document.body.contains(y)&&(document.body.removeChild(y),zt(Me,"Tooltip removed")),y=null}catch(W){console.error("Error removing tooltip:",W)}d&&(d(),d=null,zt(Me,"Unsubscribed from items store")),f&&(f(),f=null,zt(Me,"Unsubscribed from language store")),zt(Me,"Component cleanup completed")}}),Bn(()=>{if(n(16,c=!1),d&&(d(),d=null),f&&(f(),f=null),h){try{h.disconnect()}catch(x){console.error("Error disconnecting resize observer:",x)}h=null}try{y&&document.body.contains(y)&&document.body.removeChild(y),y=null}catch(x){console.error("Error removing tooltip:",x)}zt(Me,"Component destroyed")});const ut=x=>et(x),at=(x,W)=>W.key==="Enter"&&et(x);function st(x){ke[x?"unshift":"push"](()=>{g=x,n(0,g)})}return t.$$.update=()=>{t.$$.dirty[0]&65536&&c&&tt()},[g,D,M,C,w,r,u,s,L,z,m,N,R,E,et,Dt,c,ut,at,st]}class bg extends pe{constructor(e){super(),he(this,e,vg,_g,ce,{},null,[-1,-1])}}function wg(t){let e,n=t[5].error+"",r;return{c(){e=S("div"),r=H(n),_(e,"class","error svelte-ptlys3")},m(i,o){Q(i,e,o),p(e,r)},p(i,o){o[0]&32&&n!==(n=i[5].error+"")&&ot(r,n)},d(i){i&&J(e)}}}function xg(t){let e;return{c(){e=S("div"),e.textContent=`${it("ui.loading")}`,_(e,"class","loading svelte-ptlys3")},m(n,r){Q(n,e,r)},p:Ft,d(n){n&&J(e)}}}function Jo(t){let e,n,r,i,o=t[26](Math.round(t[1]/t[2]))+"",a;return{c(){e=S("p"),n=H(t[6]),r=H(": "),i=S("strong"),a=H(o),_(e,"class","svelte-ptlys3")},m(l,u){Q(l,e,u),p(e,n),p(e,r),p(e,i),p(i,a)},p(l,u){u[0]&64&&ot(n,l[6]),u[0]&6&&o!==(o=l[26](Math.round(l[1]/l[2]))+"")&&ot(a,o)},d(l){l&&J(e)}}}function kg(t){let e,n;return{c(){e=S("p"),n=H(t[7]),_(e,"class","svelte-ptlys3")},m(r,i){Q(r,e,i),p(e,n)},p(r,i){i[0]&128&&ot(n,r[7])},d(r){r&&J(e)}}}function Tg(t){let e,n,r,i,o=t[3].data.name+"",a,l,u,s;return{c(){e=S("p"),n=H(t[11]),r=H(": "),i=S("strong"),a=H(o),l=ht(),u=S("p"),s=H(t[12]),_(e,"class","svelte-ptlys3"),_(u,"class","svelte-ptlys3")},m(c,d){Q(c,e,d),p(e,n),p(e,r),p(e,i),p(i,a),Q(c,l,d),Q(c,u,d),p(u,s)},p(c,d){d[0]&2048&&ot(n,c[11]),d[0]&8&&o!==(o=c[3].data.name+"")&&ot(a,o),d[0]&4096&&ot(s,c[12])},d(c){c&&J(e),c&&J(l),c&&J(u)}}}function Cg(t){let e,n,r,i,o,a,l,u,s,c,d,f=t[26](t[2])+"",h,g,y,v,T,D,M=t[26](t[1])+"",C,b,A;function k(w,tt){if(w[5].loading)return xg;if(w[5].error)return wg}let L=k(t),z=L&&L(t),m=t[2]>0&&Jo(t);function N(w,tt){return w[3]?Tg:kg}let R=N(t),E=R(t);return{c(){e=S("div"),z&&z.c(),n=ht(),r=S("div"),i=S("div"),o=S("h3"),a=H(t[8]),l=ht(),u=S("p"),s=H(t[9]),c=H(": "),d=S("strong"),h=H(f),g=ht(),y=S("p"),v=H(t[10]),T=H(": "),D=S("strong"),C=H(M),b=ht(),m&&m.c(),A=ht(),E.c(),_(e,"class","chart-container svelte-ptlys3"),_(o,"class","svelte-ptlys3"),_(u,"class","svelte-ptlys3"),_(y,"class","svelte-ptlys3"),_(i,"class","stat-summary svelte-ptlys3"),_(r,"class","stats svelte-ptlys3")},m(w,tt){Q(w,e,tt),z&&z.m(e,null),t[27](e),Q(w,n,tt),Q(w,r,tt),p(r,i),p(i,o),p(o,a),p(i,l),p(i,u),p(u,s),p(u,c),p(u,d),p(d,h),p(i,g),p(i,y),p(y,v),p(y,T),p(y,D),p(D,C),p(i,b),m&&m.m(i,null),p(i,A),E.m(i,null)},p(w,tt){L===(L=k(w))&&z?z.p(w,tt):(z&&z.d(1),z=L&&L(w),z&&(z.c(),z.m(e,null))),tt[0]&256&&ot(a,w[8]),tt[0]&512&&ot(s,w[9]),tt[0]&4&&f!==(f=w[26](w[2])+"")&&ot(h,f),tt[0]&1024&&ot(v,w[10]),tt[0]&2&&M!==(M=w[26](w[1])+"")&&ot(C,M),w[2]>0?m?m.p(w,tt):(m=Jo(w),m.c(),m.m(i,A)):m&&(m.d(1),m=null),R===(R=N(w))&&E?E.p(w,tt):(E.d(1),E=R(w),E&&(E.c(),E.m(i,null)))},d(w){w&&J(e),z&&z.d(),t[27](null),w&&J(n),w&&J(r),m&&m.d(),E.d()}}}function zg(t){let e,n,r;return n=new Tn({props:{title:"",translationKey:"",description:"This visualization shows the distribution of words across items by country and collection. The size of each block represents the word count in that country or collection.",descriptionTranslationKey:"viz.word_distribution_description",titleHtml:t[4],$$slots:{default:[Cg]},$$scope:{ctx:t}}}),{c(){e=S("div"),te(n.$$.fragment),_(e,"class","word-distribution-container svelte-ptlys3")},m(i,o){Q(i,e,o),Gt(n,e,null),r=!0},p(i,o){const a={};o[0]&16&&(a.titleHtml=i[4]),o[0]&8175|o[1]&33554432&&(a.$$scope={dirty:o,ctx:i}),n.$set(a)},i(i){r||(Ot(n.$$.fragment,i),r=!0)},o(i){Yt(n.$$.fragment,i),r=!1},d(i){i&&J(e),jt(n)}}}const Xt="WordDistribution";function Mg(t,e,n){let r,i,o,a,l,u,s,c,d,f,h,g,y,v;vt(t,Kt,I=>n(5,r=I));let T=!1,D,M,C,b=0,A=0,k=0,L=0,z={name:"root",children:[]},m=null,N="",R="en",E=new Map;const w=lt("viz.no_data");vt(t,w,I=>n(40,d=I)),lt("viz.word_distribution");const tt=lt("viz.total_words");vt(t,tt,I=>n(10,g=I));const Y=lt("viz.avg_words_per_item");vt(t,Y,I=>n(6,a=I));const Z=lt("viz.click_zoom_in");vt(t,Z,I=>n(7,s=I)),lt("viz.click_zoom_out"),lt("viz.unknown"),lt("viz.no_set");const q=lt("viz.back_to_all");vt(t,q,I=>n(39,c=I));const et=lt("viz.currently_viewing");vt(t,et,I=>n(11,y=I));const Dt=lt("viz.click_back_to_return");vt(t,Dt,I=>n(12,v=I));const ct=lt("viz.total_items_with_word_count");vt(t,ct,I=>n(9,h=I));const nt=lt("viz.summary");vt(t,nt,I=>n(8,f=I));const V=lt("viz.words");vt(t,V,I=>n(38,u=I));const bt=lt("viz.items");vt(t,bt,I=>n(37,l=I));const kt=lt("viz.percent_of_country");vt(t,kt,I=>n(36,o=I));const ut=lt("viz.percent_of_total");vt(t,ut,I=>n(35,i=I)),lt("viz.item_set_summary");function at(I){return I.toLocaleString(R==="fr"?"fr-FR":"en-US")}function st(){L>0?R==="en"?n(4,N=`Distribution of ${at(k)} ${u} by country and sub-collection`):n(4,N=`Répartition de ${at(k)} ${u} par pays et sous-collection`):n(4,N=it("viz.word_distribution"))}function x(){m&&(R==="en"?n(4,N=`${m.data.name}: ${at(m.data.wordCount||0)} ${u}`):n(4,N=`${m.data.name}: ${at(m.data.wordCount||0)} ${u}`))}Zt.subscribe(I=>{R=I,m?x():st(),M&&document.body.contains(M)&&$()});function W(){if(!r.items||r.items.length===0)return{name:"root",children:[]};const I=r.items.filter(dt=>!(dt.word_count===void 0||dt.word_count===0||!dt.country));n(2,L=I.length),n(1,k=I.reduce((dt,X)=>dt+(X.word_count||0),0)),st();const pt=pn(I,dt=>dt.country),Mt={name:"Word Distribution",children:[]};return pt.forEach((dt,X)=>{const gt=pn(dt,It=>It.item_set_title||"No Set");if(dt.reduce((It,rt)=>It+(rt.word_count||0),0)<=0)return;const _t={name:X,children:[],wordCount:0,itemCount:dt.length};gt.forEach((It,rt)=>{const Nt=It.reduce((F,j)=>F+(j.word_count||0),0);if(Nt<=0)return;const P={name:rt,value:Nt,wordCount:Nt,itemCount:It.length};_t.children.push(P),_t.wordCount!==void 0?_t.wordCount+=Nt:_t.wordCount=Nt}),_t.children.sort((It,rt)=>(rt.wordCount||0)-(It.wordCount||0)),Mt.children.push(_t)}),Mt.children.sort((dt,X)=>(X.wordCount||0)-(dt.wordCount||0)),Mt}function ft(I){if(n(3,m=I),m){if(!m.children||m.children.length===0){const pt={name:m.data.name,children:m.data.children||[],wordCount:m.data.wordCount,itemCount:m.data.itemCount};if(!pt.children||pt.children.length===0){console.warn("Cannot zoom to node without children");return}}n(2,L=m.data.itemCount||0),n(1,k=m.data.wordCount||0),x()}else{if(r.items&&r.items.length>0){const pt=r.items.filter(Mt=>!(Mt.word_count===void 0||Mt.word_count===0||!Mt.country));n(2,L=pt.length),n(1,k=pt.reduce((Mt,dt)=>Mt+(dt.word_count||0),0))}st()}$()}function $(){try{if(!M){console.error("Container element not found");return}if(m||(z=W()),!z.children||z.children.length===0){wt(M).select("svg").remove(),wt(M).append("div").attr("class","no-data").style("position","absolute").style("top","50%").style("left","50%").style("transform","translate(-50%, -50%)").style("text-align","center").style("color","var(--text-color-secondary)").text(d);return}wt(M).select("svg").remove(),wt(M).select(".no-data").remove();const I=M.getBoundingClientRect();b=I.width,A=I.height;const pt={top:10,right:10,bottom:10,left:10},Mt=b-pt.left-pt.right,dt=A-pt.top-pt.bottom,X=wt(M).append("svg").attr("width",b).attr("height",A),gt=X.append("g").attr("transform",`translate(${pt.left}, ${pt.top})`);if(m){const P=X.append("g").attr("class","zoom-out-button").attr("transform",`translate(${pt.left}, ${pt.top})`).style("cursor","pointer").on("click",()=>ft(null));P.append("rect").attr("width",100).attr("height",24).attr("rx",4).attr("fill","var(--primary-color)").attr("opacity",.8),P.append("text").attr("x",50).attr("y",16).attr("text-anchor","middle").attr("fill","white").attr("font-size","var(--font-size-sm)").text(c),x()}const St=tl().size([Mt,dt]).paddingOuter(3).paddingTop(16).paddingInner(1).round(!0);let _t;if(m)if(m.data.children&&m.data.children.length>0){const P={name:m.data.name,children:m.data.children};_t=_e(P).sum(F=>F.value||0).sort((F,j)=>(j.value||0)-(F.value||0))}else if(m.children&&m.children.length>0){const P=m.children.map(j=>({name:j.data.name,value:j.data.value||j.value,wordCount:j.data.wordCount,itemCount:j.data.itemCount})),F={name:m.data.name,children:P};_t=_e(F).sum(j=>j.value||0).sort((j,$t)=>($t.value||0)-(j.value||0))}else console.warn("Zoomed node has no valid children data, falling back to full hierarchy"),z=W(),_t=_e(z).sum(P=>P.value||0).sort((P,F)=>(F.value||0)-(P.value||0));else if(_t=_e(z).sum(P=>P.value||0).sort((P,F)=>(F.value||0)-(P.value||0)),_t.children){const F=(_t.value||0)*.001;_t.children=_t.children.filter(j=>(j.value||0)>F)}try{St(_t)}catch(P){console.error("Error applying treemap layout:",P),n(3,m=null),z=W(),_t=_e(z).sum(F=>F.value||0).sort((F,j)=>(j.value||0)-(F.value||0)),St(_t)}const It=De().domain(_t.children?_t.children.map(P=>P.data.name):[_t.data.name]).range(xn);m||_t.children&&_t.children.forEach(P=>{E.has(P.data.name)||E.set(P.data.name,It(P.data.name))});const rt=gt.selectAll(".country").data(m?[]:_t.children||[]).enter().append("g").attr("class","country").attr("transform",P=>{const F=P.x0||0,j=P.y0||0;return`translate(${F},${j})`});rt.append("rect").attr("width",P=>{const F=P.x0||0,j=P.x1||0;return Math.max(0,j-F)}).attr("height",P=>{const F=P.y0||0,j=P.y1||0;return Math.max(0,j-F)}).attr("fill",P=>E.get(P.data.name)||It(P.data.name)).attr("stroke","white").attr("stroke-width",2).style("opacity",.7).style("cursor","pointer").on("click",(P,F)=>{ft(F)}).attr("title",s).append("title").text(()=>s),rt.append("text").attr("x",5).attr("y",15).attr("font-size","var(--font-size-sm)").attr("font-weight","bold").attr("fill","white").text(P=>{var j;return P.x1-P.x0-10<150?P.data.name:`${P.data.name} (${((j=P.data.wordCount)==null?void 0:j.toLocaleString())||0} ${u})`}).style("pointer-events","none").each(function(P){var Tt;const F=wt(this),j=this.getComputedTextLength(),$t=P.x1-P.x0-10;if(j>$t){let Et=P.data.name;F.text(Et);let xt=this.getComputedTextLength(),At=!1;for(;xt>$t&&Et.length>3;)Et=Et.slice(0,-1),F.text(Et),xt=this.getComputedTextLength(),At=!0;At&&F.text(Et+"..."),F.append("title").text(`${P.data.name} (${((Tt=P.data.wordCount)==null?void 0:Tt.toLocaleString())||0} ${u})`)}});const Nt=gt.selectAll(".item-set").data(m?_t.children||[]:_t.leaves()).enter().append("g").attr("class","item-set").attr("transform",P=>{const F=P.x0||0,j=P.y0||0;return`translate(${F},${j})`});Nt.append("rect").attr("width",P=>{const F=P.x0||0,j=P.x1||0;return Math.max(0,j-F)}).attr("height",P=>{const F=P.y0||0,j=P.y1||0;return Math.max(0,j-F)}).attr("fill",P=>{var $t,Tt,Et,xt;const F=m?E.get(m.data.name)||It(m.data.name):E.get((Tt=($t=P.parent)==null?void 0:$t.data)==null?void 0:Tt.name)||It((xt=(Et=P.parent)==null?void 0:Et.data)==null?void 0:xt.name),j=oe(F);return oe(j).brighter(.7).toString()}).attr("stroke","white").attr("stroke-width",.5).style("cursor","pointer").on("mouseover",function(P,F){wt(this).attr("stroke","var(--primary-color)").attr("stroke-width",2),G(F,P)}).on("mousemove",function(P,F){G(F,P)}).on("mouseout",function(){wt(this).attr("stroke","white").attr("stroke-width",.5),K()}),Nt.append("text").attr("x",3).attr("y",13).attr("font-size","var(--font-size-xs)").attr("fill","var(--text-color-primary)").style("pointer-events","none").each(function(P){var yt,mt;const F=wt(this),j=P.x1-P.x0,$t=P.y1-P.y0;if(j<30||$t<20)return;let Tt=P.data.name;const Et=j-6,xt=m?m.data.name:P.parent?P.parent.data.name:"";F.text(Tt).append("title").text(`${xt} > ${P.data.name}: ${((yt=P.data.wordCount)==null?void 0:yt.toLocaleString())||0} ${u} (${P.data.itemCount} ${l})`);const At=this;let Rt=At.getComputedTextLength(),Ct=!1;for(;Rt>Et&&Tt.length>3;)Tt=Tt.slice(0,-1),F.text(Tt),Rt=At.getComputedTextLength(),Ct=!0;Ct&&(F.text(Tt+"..."),F.append("title").text(`${xt} > ${P.data.name}: ${((mt=P.data.wordCount)==null?void 0:mt.toLocaleString())||0} ${u} (${P.data.itemCount} ${l})`))})}catch(I){console.error("Error in updateVisualization:",I)}}function O(){try{C&&document.body.contains(C)&&document.body.removeChild(C),C=document.createElement("div"),C.style.position="absolute",C.style.backgroundColor="rgba(0, 0, 0, 0.8)",C.style.color="white",C.style.padding="8px 12px",C.style.borderRadius="4px",C.style.pointerEvents="none",C.style.display="none",C.style.fontSize="12px",C.style.zIndex="1000",C.style.boxShadow="0 2px 5px rgba(0,0,0,0.2)",document&&document.body&&document.body.appendChild(C)}catch(I){console.error("Error creating tooltip:",I)}}function G(I,pt){try{if((!C||!document.body.contains(C))&&(zt(Xt,"Tooltip element not found, creating new one"),O()),!pt){zt(Xt,"Event object is undefined in showTooltip");return}const Mt=I.parent?I.parent.data.name:I.data.name,dt=I.parent?I.data.name:"All",X=I.data.wordCount||0,gt=I.data.itemCount||0,St=gt>0?Math.round(X/gt):0,_t=m?m.data.wordCount:I.parent?I.parent.data.wordCount:0,It=_t&&_t>0?(X/_t*100).toFixed(1)+"%":"N/A",rt=k>0?(X/k*100).toFixed(1)+"%":"N/A";C.innerHTML=`
                <div style="font-weight:bold;margin-bottom:4px;border-bottom:1px solid rgba(255,255,255,0.3);padding-bottom:2px;">
                    ${Mt} > ${dt}
                </div>
                <div style="display:grid;grid-template-columns:auto auto;gap:4px;">
                    <span>${u}:</span>
                    <span style="text-align:right;font-weight:bold">${X.toLocaleString()}</span>
                    <span>${l}:</span>
                    <span style="text-align:right">${gt}</span>
                    <span>${a}:</span>
                    <span style="text-align:right">${St}</span>
                    <span>${o}:</span>
                    <span style="text-align:right">${It}</span>
                    <span>${i}:</span>
                    <span style="text-align:right">${rt}</span>
                </div>
            `;const Nt=200,P=120;let F=0,j=0;try{F=pt.pageX+10,j=pt.pageY+10,F+Nt>window.innerWidth&&(F=pt.pageX-Nt-10),j+P>window.innerHeight&&(j=pt.pageY-P-10),F=Math.max(0,F),j=Math.max(0,j)}catch($t){zt(Xt,"Error calculating tooltip position",$t),F=window.innerWidth/2-Nt/2,j=window.innerHeight/2-P/2}C.style.left=`${F}px`,C.style.top=`${j}px`,C.style.display="block",zt(Xt,"Tooltip shown",{country:Mt,itemSet:dt,position:{left:F,top:j}})}catch(Mt){console.error("Error showing tooltip:",Mt),zt(Xt,"Error showing tooltip",Mt)}}function K(){try{C&&document.body.contains(C)&&(C.style.display="none")}catch(I){console.error("Error hiding tooltip:",I)}}function U(I){!T||!M||(zt(Xt,"Items store changed",{itemCount:(I==null?void 0:I.length)||0}),document.body.contains(M)&&$())}Te(()=>{try{return T=!0,zt(Xt,"Component mounted"),(async()=>{if(await Ve(),!M){console.error("Container element not found in onMount");return}O(),D=Kt.subscribe(Mt=>{U(Mt.items)}),r.items&&r.items.length>0?$():Kt.loadItems(),new ResizeObserver(()=>{T&&M&&document.body.contains(M)&&$()}).observe(M)})(),()=>{try{T=!1,zt(Xt,"Component cleanup started"),M&&(wt(M).selectAll("*").remove(),zt(Xt,"D3 selections removed")),C&&document.body.contains(C)&&(document.body.removeChild(C),zt(Xt,"Tooltip removed")),D&&(D(),zt(Xt,"Unsubscribed from items store")),zt(Xt,"Component cleanup completed")}catch(pt){console.error("Error during cleanup:",pt)}}}catch(I){return console.error("Error in onMount:",I),()=>{}}}),Bn(()=>{if(T){T=!1,zt(Xt,"Component destroyed (backup cleanup)");try{D&&(D(),zt(Xt,"Unsubscribed from items store (backup)")),C&&document.body.contains(C)&&(document.body.removeChild(C),zt(Xt,"Tooltip removed (backup)"))}catch(I){console.error("Error during backup cleanup:",I)}}});function B(I){ke[I?"unshift":"push"](()=>{M=I,n(0,M)})}return[M,k,L,m,N,r,a,s,f,h,g,y,v,w,tt,Y,Z,q,et,Dt,ct,nt,V,bt,kt,ut,at,B]}class Ag extends pe{constructor(e){super(),he(this,e,Mg,zg,ce,{},null,[-1,-1])}}function Sg(t,e,n){const r=new URL(n||window.location.href);return r.searchParams.set("lang",t),r.searchParams.set("tab",e),r.toString()}function Ng(){if(typeof window>"u")return{lang:null,tab:null};const t=new URLSearchParams(window.location.search),e=t.get("lang"),n=t.get("tab");return{lang:e==="en"||e==="fr"?e:null,tab:n}}function Qo(t,e){if(typeof window>"u")return;const n=Sg(t,e);window.history.pushState({},"",n)}function ta(t,e,n){const r=t.slice();return r[18]=e[n],r}function ea(t){let e,n=t[18].translatedLabel+"",r,i,o,a,l;function u(){return t[7](t[18])}function s(...c){return t[8](t[18],...c)}return{c(){e=S("li"),r=H(n),i=ht(),_(e,"role","tab"),_(e,"tabindex","0"),_(e,"aria-selected",o=t[0]===t[18].id),_(e,"class","svelte-feuafn"),Ue(e,"active",t[0]===t[18].id)},m(c,d){Q(c,e,d),p(e,r),p(e,i),a||(l=[Qt(e,"click",u),Qt(e,"keydown",s)],a=!0)},p(c,d){t=c,d&2&&n!==(n=t[18].translatedLabel+"")&&ot(r,n),d&3&&o!==(o=t[0]===t[18].id)&&_(e,"aria-selected",o),d&3&&Ue(e,"active",t[0]===t[18].id)},d(c){c&&J(e),a=!1,le(l)}}}function Dg(t){let e,n;return e=new pg({}),{c(){te(e.$$.fragment)},m(r,i){Gt(e,r,i),n=!0},p:Ft,i(r){n||(Ot(e.$$.fragment,r),n=!0)},o(r){Yt(e.$$.fragment,r),n=!1},d(r){jt(e,r)}}}function $g(t){let e,n;return e=new lg({}),{c(){te(e.$$.fragment)},m(r,i){Gt(e,r,i),n=!0},p:Ft,i(r){n||(Ot(e.$$.fragment,r),n=!0)},o(r){Yt(e.$$.fragment,r),n=!1},d(r){jt(e,r)}}}function Eg(t){let e,n;return e=new tg({}),{c(){te(e.$$.fragment)},m(r,i){Gt(e,r,i),n=!0},p:Ft,i(r){n||(Ot(e.$$.fragment,r),n=!0)},o(r){Yt(e.$$.fragment,r),n=!1},d(r){jt(e,r)}}}function Lg(t){let e,n;return e=new Ag({}),{c(){te(e.$$.fragment)},m(r,i){Gt(e,r,i),n=!0},p:Ft,i(r){n||(Ot(e.$$.fragment,r),n=!0)},o(r){Yt(e.$$.fragment,r),n=!1},d(r){jt(e,r)}}}function Ig(t){let e,n;return e=new bg({}),{c(){te(e.$$.fragment)},m(r,i){Gt(e,r,i),n=!0},p:Ft,i(r){n||(Ot(e.$$.fragment,r),n=!0)},o(r){Yt(e.$$.fragment,r),n=!1},d(r){jt(e,r)}}}function Fg(t){let e,n;return e=new Kp({}),{c(){te(e.$$.fragment)},m(r,i){Gt(e,r,i),n=!0},p:Ft,i(r){n||(Ot(e.$$.fragment,r),n=!0)},o(r){Yt(e.$$.fragment,r),n=!1},d(r){jt(e,r)}}}function Rg(t){let e,n=t[2].error+"",r;return{c(){e=S("div"),r=H(n),_(e,"class","error svelte-feuafn")},m(i,o){Q(i,e,o),p(e,r)},p(i,o){o&4&&n!==(n=i[2].error+"")&&ot(r,n)},i:Ft,o:Ft,d(i){i&&J(e)}}}function Hg(t){let e;return{c(){e=S("div"),e.textContent=`${it("ui.loading")}`,_(e,"class","loading svelte-feuafn")},m(n,r){Q(n,e,r)},p:Ft,i:Ft,o:Ft,d(n){n&&J(e)}}}function Ug(t){let e,n,r,i,o,a,l,u,s,c,d,f,h,g,y,v,T,D,M;l=new Kl({}),s=new Pl({});let C=t[1],b=[];for(let m=0;m<C.length;m+=1)b[m]=ea(ta(t,C,m));const A=[Hg,Rg,Fg,Ig,Lg,Eg,$g,Dg],k=[];function L(m,N){return m[2].loading?0:m[2].error?1:m[0]==="countries"?2:m[0]==="types"?3:m[0]==="words"?4:m[0]==="languages"?5:m[0]==="categories"?6:m[0]==="timeline"?7:-1}~(y=L(t))&&(v=k[y]=A[y](t));let z=Zl;return{c(){e=S("main"),n=S("header"),r=S("div"),i=S("h1"),o=ht(),a=S("div"),te(l.$$.fragment),u=ht(),te(s.$$.fragment),c=ht(),d=S("nav"),f=S("ul");for(let m=0;m<b.length;m+=1)b[m].c();h=ht(),g=S("div"),v&&v.c(),T=ht(),D=fa(),_(i,"class","svelte-feuafn"),_(a,"class","header-controls svelte-feuafn"),_(r,"class","header-top svelte-feuafn"),_(f,"class","tabs svelte-feuafn"),_(n,"class","svelte-feuafn"),_(g,"class","content svelte-feuafn"),_(e,"class","svelte-feuafn")},m(m,N){Q(m,e,N),p(e,n),p(n,r),p(r,i),i.innerHTML=t[3],p(r,o),p(r,a),Gt(l,a,null),p(a,u),Gt(s,a,null),p(n,c),p(n,d),p(d,f);for(let R=0;R<b.length;R+=1)b[R]&&b[R].m(f,null);p(e,h),p(e,g),~y&&k[y].m(g,null),Q(m,T,N),Q(m,D,N),M=!0},p(m,N){if((!M||N&8)&&(i.innerHTML=m[3]),N&35){C=m[1];let E;for(E=0;E<C.length;E+=1){const w=ta(m,C,E);b[E]?b[E].p(w,N):(b[E]=ea(w),b[E].c(),b[E].m(f,null))}for(;E<b.length;E+=1)b[E].d(1);b.length=C.length}let R=y;y=L(m),y===R?~y&&k[y].p(m,N):(v&&(ci(),Yt(k[R],1,1,()=>{k[R]=null}),fi()),~y?(v=k[y],v?v.p(m,N):(v=k[y]=A[y](m),v.c()),Ot(v,1),v.m(g,null)):v=null)},i(m){M||(Ot(l.$$.fragment,m),Ot(s.$$.fragment,m),Ot(v),Ot(z),M=!0)},o(m){Yt(l.$$.fragment,m),Yt(s.$$.fragment,m),Yt(v),Yt(z),M=!1},d(m){m&&J(e),jt(l),jt(s),mn(b,m),~y&&k[y].d(),m&&J(T),m&&J(D)}}}function Og(t){let e,n;return e=new ns({props:{$$slots:{default:[Ug]},$$scope:{ctx:t}}}),{c(){te(e.$$.fragment)},m(r,i){Gt(e,r,i),n=!0},p(r,[i]){const o={};i&2097167&&(o.$$scope={dirty:i,ctx:r}),e.$set(o)},i(r){n||(Ot(e.$$.fragment,r),n=!0)},o(r){Yt(e.$$.fragment,r),n=!1},d(r){jt(e,r)}}}const re="App";function Pg(t,e,n){let r,i,o,a;vt(t,Zt,b=>n(6,i=b)),vt(t,Kt,b=>n(2,o=b));let l=!1,u=0,s=()=>{},c=0;const d=lt("app.title");vt(t,d,b=>n(3,a=b));let f="countries";const h=[{id:"countries",label:"tab.countries"},{id:"types",label:"tab.types"},{id:"words",label:"tab.words"},{id:"languages",label:"tab.languages"},{id:"categories",label:"tab.categories"},{id:"timeline",label:"tab.timeline"}];let g="",y="";function v(){if(typeof window>"u")return;const{lang:b,tab:A}=Ng();zt(re,`URL parameters: lang=${b}, tab=${A}`),b&&(Zt.setLanguage(b),zt(re,`Setting language from URL: ${b}`)),A&&h.some(k=>k.id===A)&&(n(0,f=A),zt(re,`Setting tab from URL: ${A}`))}function T(b){n(0,f=b),g&&Qo(g,b)}function D(b){var A;if(!l){zt(re,`Language change ignored (not mounted): ${b}`);return}y=g,g=b,Qo(b,f),n(1,r=h.map(k=>({...k,translatedLabel:it(k.label)}))),zt(re,`Language changed from ${y} to ${b}`,{isMounted:l,updateCount:u,subscriptionActive:!!s}),zt(re,"Current translations:",{title:it("app.title"),loading:it("ui.loading"),activeTab:it(((A=h.find(k=>k.id===f))==null?void 0:A.label)||"")})}ha(()=>{c++,zt(re,`Before update (render #${c})`,{isMounted:l,currentLanguage:g,activeTab:f})}),Te(()=>{try{l=!0,v(),zt(re,`Component mounted, initial language: ${i}`,{storeValue:i,activeTab:f}),g=i,n(1,r=h.map(b=>({...b,translatedLabel:it(b.label)})));try{s=Zt.subscribe(A=>{D(A)}),zt(re,"Successfully subscribed to language store")}catch(b){zt(re,`Error subscribing to language store: ${b}`)}(!o.items||o.items.length===0)&&Kt.loadItems()}catch(b){console.error("[App] Error in onMount:",b)}}),Bn(()=>{try{s&&s(),l=!1,zt(re,"Component unmounted")}catch(b){console.error("[App] Error in onDestroy:",b)}}),pa(()=>{u++,zt(re,`Component updated (${u})`,{isMounted:l,currentLanguage:g,storeValue:i,activeTab:f})});const M=b=>T(b.id),C=(b,A)=>A.key==="Enter"&&T(b.id);return t.$$.update=()=>{t.$$.dirty&64&&i&&n(1,r=h.map(b=>({...b,translatedLabel:it(b.label)})))},n(1,r=h.map(b=>({...b,translatedLabel:it(b.label)}))),[f,r,o,a,d,T,i,M,C]}class Yg extends pe{constructor(e){super(),he(this,e,Pg,Og,ce,{})}}new Yg({target:document.getElementById("app")});
