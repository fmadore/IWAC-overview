var qc=Object.defineProperty;var Yc=(t,e,n)=>e in t?qc(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Hr=(t,e,n)=>Yc(t,typeof e!="symbol"?e+"":e,n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();const Ho=!1;var so=Array.isArray,Gc=Array.prototype.indexOf,ua=Array.from,ol=Object.defineProperty,Qn=Object.getOwnPropertyDescriptor,al=Object.getOwnPropertyDescriptors,Kc=Object.prototype,Xc=Array.prototype,fa=Object.getPrototypeOf;function Zc(t){return typeof t=="function"}const Pe=()=>{};function Jc(t){return t()}function Fi(t){for(var e=0;e<t.length;e++)t[e]()}const Qe=2,sl=4,lo=8,co=16,Sn=32,di=64,Ri=128,Ze=256,Pi=512,be=1024,En=2048,ir=4096,Tn=8192,uo=16384,ll=32768,fo=65536,cl=1<<17,Qc=1<<19,ul=1<<20,$n=Symbol("$state"),jc=Symbol("legacy props"),tu=Symbol("");function fl(t){return t===this.v}function dl(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function da(t){return!dl(t,this.v)}function eu(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function nu(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function ru(t){throw new Error("https://svelte.dev/e/effect_orphan")}function iu(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function hl(t){throw new Error("https://svelte.dev/e/lifecycle_legacy_only")}function ou(t){throw new Error("https://svelte.dev/e/props_invalid_value")}function au(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function su(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function lu(){throw new Error("https://svelte.dev/e/state_unsafe_local_read")}function cu(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}let Mr=!1,uu=!1;function fu(){Mr=!0}const ha=1,ga=2,gl=4,du=8,hu=16,gu=1,mu=2,pu=4,vu=8,yu=16,_u=4,xu=1,bu=2,Le=Symbol();function Ar(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}let Ht=null;function Va(t){Ht=t}function wu(t,e){return Tu().set(t,e),e}function we(t,e=!1,n){Ht={p:Ht,c:null,e:null,m:!1,s:t,x:null,l:null},Mr&&!e&&(Ht.l={s:null,u:null,r1:[],r2:Ke(!1)})}function Te(t){const e=Ht;if(e!==null){t!==void 0&&(e.x=t);const a=e.e;if(a!==null){var n=jt,r=ee;e.e=null;try{for(var i=0;i<a.length;i++){var o=a[i];gn(o.effect),hn(o.reaction),Er(o.fn)}}finally{gn(n),hn(r)}}Ht=e.p,e.m=!0}return t||{}}function ho(){return!Mr||Ht!==null&&Ht.l===null}function Tu(t){return Ht===null&&Ar(),Ht.c??(Ht.c=new Map($u(Ht)||void 0))}function $u(t){let e=t.p;for(;e!==null;){const n=e.c;if(n!==null)return n;e=e.p}return null}function Ke(t,e){var n={f:0,v:t,reactions:null,equals:fl,rv:0,wv:0};return n}function go(t,e=!1){var r;const n=Ke(t);return e||(n.equals=da),Mr&&Ht!==null&&Ht.l!==null&&((r=Ht.l).s??(r.s=[])).push(n),n}function vt(t,e=!1){return Cu(go(t,e))}function Cu(t){return ee!==null&&!cn&&(ee.f&Qe)!==0&&(fn===null?Ru([t]):fn.push(t)),t}function Bo(t,e){return D(t,Oe(()=>d(t))),e}function D(t,e){return ee!==null&&!cn&&ho()&&(ee.f&(Qe|co))!==0&&(fn===null||!fn.includes(t))&&cu(),ti(t,e)}function ti(t,e){return t.equals(e)||(t.v,t.v=e,t.wv=El(),ml(t,En),ho()&&jt!==null&&(jt.f&be)!==0&&(jt.f&(Sn|di))===0&&(yn===null?Pu([t]):yn.push(t))),e}function ml(t,e){var n=t.reactions;if(n!==null)for(var r=ho(),i=n.length,o=0;o<i;o++){var a=n[o],s=a.f;(s&En)===0&&(!r&&a===jt||(rn(a,e),(s&(be|Ze))!==0&&((s&Qe)!==0?ml(a,ir):bo(a))))}}let pl=!1;function ur(t,e=null,n){if(typeof t!="object"||t===null||$n in t)return t;const r=fa(t);if(r!==Kc&&r!==Xc)return t;var i=new Map,o=so(t),a=Ke(0);o&&i.set("length",Ke(t.length));var s;return new Proxy(t,{defineProperty(h,c,l){(!("value"in l)||l.configurable===!1||l.enumerable===!1||l.writable===!1)&&au();var f=i.get(c);return f===void 0?(f=Ke(l.value),i.set(c,f)):D(f,ur(l.value,s)),!0},deleteProperty(h,c){var l=i.get(c);if(l===void 0)c in h&&i.set(c,Ke(Le));else{if(o&&typeof c=="string"){var f=i.get("length"),u=Number(c);Number.isInteger(u)&&u<f.v&&D(f,u)}D(l,Le),qa(a)}return!0},get(h,c,l){var m;if(c===$n)return t;var f=i.get(c),u=c in h;if(f===void 0&&(!u||(m=Qn(h,c))!=null&&m.writable)&&(f=Ke(ur(u?h[c]:Le,s)),i.set(c,f)),f!==void 0){var g=d(f);return g===Le?void 0:g}return Reflect.get(h,c,l)},getOwnPropertyDescriptor(h,c){var l=Reflect.getOwnPropertyDescriptor(h,c);if(l&&"value"in l){var f=i.get(c);f&&(l.value=d(f))}else if(l===void 0){var u=i.get(c),g=u==null?void 0:u.v;if(u!==void 0&&g!==Le)return{enumerable:!0,configurable:!0,value:g,writable:!0}}return l},has(h,c){var g;if(c===$n)return!0;var l=i.get(c),f=l!==void 0&&l.v!==Le||Reflect.has(h,c);if(l!==void 0||jt!==null&&(!f||(g=Qn(h,c))!=null&&g.writable)){l===void 0&&(l=Ke(f?ur(h[c],s):Le),i.set(c,l));var u=d(l);if(u===Le)return!1}return f},set(h,c,l,f){var k;var u=i.get(c),g=c in h;if(o&&c==="length")for(var m=l;m<u.v;m+=1){var v=i.get(m+"");v!==void 0?D(v,Le):m in h&&(v=Ke(Le),i.set(m+"",v))}u===void 0?(!g||(k=Qn(h,c))!=null&&k.writable)&&(u=Ke(void 0),D(u,ur(l,s)),i.set(c,u)):(g=u.v!==Le,D(u,ur(l,s)));var _=Reflect.getOwnPropertyDescriptor(h,c);if(_!=null&&_.set&&_.set.call(f,l),!g){if(o&&typeof c=="string"){var p=i.get("length"),$=Number(c);Number.isInteger($)&&$>=p.v&&D(p,$+1)}qa(a)}return!0},ownKeys(h){d(a);var c=Reflect.ownKeys(h).filter(u=>{var g=i.get(u);return g===void 0||g.v!==Le});for(var[l,f]of i)f.v!==Le&&!(l in h)&&c.push(l);return c},setPrototypeOf(){su()}})}function qa(t,e=1){D(t,t.v+e)}function Ya(t){return t!==null&&typeof t=="object"&&$n in t?t[$n]:t}function ku(t,e){return Object.is(Ya(t),Ya(e))}var Ga,vl,yl,_l;function zu(){if(Ga===void 0){Ga=window,vl=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype;yl=Qn(e,"firstChild").get,_l=Qn(e,"nextSibling").get,t.__click=void 0,t.__className="",t.__attributes=null,t.__styles=null,t.__e=void 0,Text.prototype.__t=void 0}}function ma(t=""){return document.createTextNode(t)}function tr(t){return yl.call(t)}function mo(t){return _l.call(t)}function N(t,e){return tr(t)}function Qt(t,e){{var n=tr(t);return n instanceof Comment&&n.data===""?mo(n):n}}function pt(t,e=1,n=!1){let r=t;for(;e--;)r=mo(r);return r}function Mu(t){t.textContent=""}function ei(t){var e=Qe|En,n=ee!==null&&(ee.f&Qe)!==0?ee:null;return jt===null||n!==null&&(n.f&Ze)!==0?e|=Ze:jt.f|=ul,{ctx:Ht,deps:null,effects:null,equals:fl,f:e,fn:t,reactions:null,rv:0,v:null,wv:0,parent:n??jt}}function re(t){const e=ei(t);return e.equals=da,e}function xl(t){var e=t.effects;if(e!==null){t.effects=null;for(var n=0;n<e.length;n+=1)Cn(e[n])}}function Au(t){for(var e=t.parent;e!==null;){if((e.f&Qe)===0)return e;e=e.parent}return null}function Su(t){var e,n=jt;gn(Au(t));try{xl(t),e=Nl(t)}finally{gn(n)}return e}function bl(t){var e=Su(t),n=(Rn||(t.f&Ze)!==0)&&t.deps!==null?ir:be;rn(t,n),t.equals(e)||(t.v=e,t.wv=El())}function wl(t){jt===null&&ee===null&&ru(),ee!==null&&(ee.f&Ze)!==0&&jt===null&&nu(),ya&&eu()}function Eu(t,e){var n=e.last;n===null?e.last=e.first=t:(n.next=t,t.prev=n,e.last=t)}function Sr(t,e,n,r=!0){var i=(t&di)!==0,o=jt,a={ctx:Ht,deps:null,nodes_start:null,nodes_end:null,f:t|En,first:null,fn:e,last:null,next:null,parent:i?null:o,prev:null,teardown:null,transitions:null,wv:0};if(n){var s=gr;try{Ka(!0),xo(a),a.f|=ll}catch(l){throw Cn(a),l}finally{Ka(s)}}else e!==null&&bo(a);var h=n&&a.deps===null&&a.first===null&&a.nodes_start===null&&a.teardown===null&&(a.f&(ul|Ri))===0;if(!h&&!i&&r&&(o!==null&&Eu(a,o),ee!==null&&(ee.f&Qe)!==0)){var c=ee;(c.effects??(c.effects=[])).push(a)}return a}function pa(t){const e=Sr(lo,null,!1);return rn(e,be),e.teardown=t,e}function Oo(t){wl();var e=jt!==null&&(jt.f&Sn)!==0&&Ht!==null&&!Ht.m;if(e){var n=Ht;(n.e??(n.e=[])).push({fn:t,effect:jt,reaction:ee})}else{var r=Er(t);return r}}function Iu(t){return wl(),po(t)}function Nu(t){const e=Sr(di,t,!0);return(n={})=>new Promise(r=>{n.outro?Ui(e,()=>{Cn(e),r(void 0)}):(Cn(e),r(void 0))})}function Er(t){return Sr(sl,t,!1)}function ge(t,e){var n=Ht,r={effect:null,ran:!1};n.l.r1.push(r),r.effect=po(()=>{t(),!r.ran&&(r.ran=!0,D(n.l.r2,!0),Oe(e))})}function hi(){var t=Ht;po(()=>{if(d(t.l.r2)){for(var e of t.l.r1){var n=e.effect;(n.f&be)!==0&&rn(n,ir),Ir(n)&&xo(n),e.ran=!1}t.l.r2.v=!1}})}function po(t){return Sr(lo,t,!0)}function kt(t,e=[],n=ei){const r=e.map(n);return vo(()=>t(...r.map(d)))}function vo(t,e=0){return Sr(lo|co|e,t,!0)}function xr(t,e=!0){return Sr(lo|Sn,t,!0,e)}function Tl(t){var e=t.teardown;if(e!==null){const n=ya,r=ee;Xa(!0),hn(null);try{e.call(null)}finally{Xa(n),hn(r)}}}function $l(t,e=!1){var n=t.first;for(t.first=t.last=null;n!==null;){var r=n.next;Cn(n,e),n=r}}function Lu(t){for(var e=t.first;e!==null;){var n=e.next;(e.f&Sn)===0&&Cn(e),e=n}}function Cn(t,e=!0){var n=!1;if((e||(t.f&Qc)!==0)&&t.nodes_start!==null){for(var r=t.nodes_start,i=t.nodes_end;r!==null;){var o=r===i?null:mo(r);r.remove(),r=o}n=!0}$l(t,e&&!n),Wi(t,0),rn(t,uo);var a=t.transitions;if(a!==null)for(const h of a)h.stop();Tl(t);var s=t.parent;s!==null&&s.first!==null&&Cl(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes_start=t.nodes_end=null}function Cl(t){var e=t.parent,n=t.prev,r=t.next;n!==null&&(n.next=r),r!==null&&(r.prev=n),e!==null&&(e.first===t&&(e.first=r),e.last===t&&(e.last=n))}function Ui(t,e){var n=[];va(t,n,!0),kl(n,()=>{Cn(t),e&&e()})}function kl(t,e){var n=t.length;if(n>0){var r=()=>--n||e();for(var i of t)i.out(r)}else e()}function va(t,e,n){if((t.f&Tn)===0){if(t.f^=Tn,t.transitions!==null)for(const a of t.transitions)(a.is_global||n)&&e.push(a);for(var r=t.first;r!==null;){var i=r.next,o=(r.f&fo)!==0||(r.f&Sn)!==0;va(r,e,o?n:!1),r=i}}}function Hi(t){zl(t,!0)}function zl(t,e){if((t.f&Tn)!==0){t.f^=Tn,(t.f&be)===0&&(t.f^=be),Ir(t)&&(rn(t,En),bo(t));for(var n=t.first;n!==null;){var r=n.next,i=(n.f&fo)!==0||(n.f&Sn)!==0;zl(n,i?e:!1),n=r}if(t.transitions!==null)for(const o of t.transitions)(o.is_global||e)&&o.in()}}let Bi=!1,Wo=[];function Ml(){Bi=!1;const t=Wo.slice();Wo=[],Fi(t)}function yo(t){Bi||(Bi=!0,queueMicrotask(Ml)),Wo.push(t)}function Du(){Bi&&Ml()}const Al=0,Fu=1;let zi=!1,Mi=Al,ni=!1,ri=null,gr=!1,ya=!1;function Ka(t){gr=t}function Xa(t){ya=t}let Zn=[],mr=0;let ee=null,cn=!1;function hn(t){ee=t}let jt=null;function gn(t){jt=t}let fn=null;function Ru(t){fn=t}let $e=null,Be=0,yn=null;function Pu(t){yn=t}let Sl=1,Oi=0,Rn=!1,Fn=null;function El(){return++Sl}function Ir(t){var f;var e=t.f;if((e&En)!==0)return!0;if((e&ir)!==0){var n=t.deps,r=(e&Ze)!==0;if(n!==null){var i,o,a=(e&Pi)!==0,s=r&&jt!==null&&!Rn,h=n.length;if(a||s){var c=t,l=c.parent;for(i=0;i<h;i++)o=n[i],(a||!((f=o==null?void 0:o.reactions)!=null&&f.includes(c)))&&(o.reactions??(o.reactions=[])).push(c);a&&(c.f^=Pi),s&&l!==null&&(l.f&Ze)===0&&(c.f^=Ze)}for(i=0;i<h;i++)if(o=n[i],Ir(o)&&bl(o),o.wv>t.wv)return!0}(!r||jt!==null&&!Rn)&&rn(t,be)}return!1}function Uu(t,e){for(var n=e;n!==null;){if((n.f&Ri)!==0)try{n.fn(t);return}catch{n.f^=Ri}n=n.parent}throw zi=!1,t}function Hu(t){return(t.f&uo)===0&&(t.parent===null||(t.parent.f&Ri)===0)}function _o(t,e,n,r){if(zi){if(n===null&&(zi=!1),Hu(e))throw t;return}n!==null&&(zi=!0);{Uu(t,e);return}}function Il(t,e,n=!0){var r=t.reactions;if(r!==null)for(var i=0;i<r.length;i++){var o=r[i];(o.f&Qe)!==0?Il(o,e,!1):e===o&&(n?rn(o,En):(o.f&be)!==0&&rn(o,ir),bo(o))}}function Nl(t){var g;var e=$e,n=Be,r=yn,i=ee,o=Rn,a=fn,s=Ht,h=cn,c=t.f;$e=null,Be=0,yn=null,ee=(c&(Sn|di))===0?t:null,Rn=(c&Ze)!==0&&(!gr||i===null||h),fn=null,Va(t.ctx),cn=!1,Oi++;try{var l=(0,t.fn)(),f=t.deps;if($e!==null){var u;if(Wi(t,Be),f!==null&&Be>0)for(f.length=Be+$e.length,u=0;u<$e.length;u++)f[Be+u]=$e[u];else t.deps=f=$e;if(!Rn)for(u=Be;u<f.length;u++)((g=f[u]).reactions??(g.reactions=[])).push(t)}else f!==null&&Be<f.length&&(Wi(t,Be),f.length=Be);if(ho()&&yn!==null&&!cn&&f!==null&&(t.f&(Qe|ir|En))===0)for(u=0;u<yn.length;u++)Il(yn[u],t);return i!==null&&Oi++,l}finally{$e=e,Be=n,yn=r,ee=i,Rn=o,fn=a,Va(s),cn=h}}function Bu(t,e){let n=e.reactions;if(n!==null){var r=Gc.call(n,t);if(r!==-1){var i=n.length-1;i===0?n=e.reactions=null:(n[r]=n[i],n.pop())}}n===null&&(e.f&Qe)!==0&&($e===null||!$e.includes(e))&&(rn(e,ir),(e.f&(Ze|Pi))===0&&(e.f^=Pi),xl(e),Wi(e,0))}function Wi(t,e){var n=t.deps;if(n!==null)for(var r=e;r<n.length;r++)Bu(t,n[r])}function xo(t){var e=t.f;if((e&uo)===0){rn(t,be);var n=jt,r=Ht;jt=t;try{(e&co)!==0?Lu(t):$l(t),Tl(t);var i=Nl(t);t.teardown=typeof i=="function"?i:null,t.wv=Sl;var o=t.deps,a;Ho&&uu&&t.f&En}catch(s){_o(s,t,n,r||t.ctx)}finally{jt=n}}}function Ll(){if(mr>1e3){mr=0;try{iu()}catch(t){if(ri!==null)_o(t,ri,null);else throw t}}mr++}function Dl(t){var e=t.length;if(e!==0){Ll();var n=gr;gr=!0;try{for(var r=0;r<e;r++){var i=t[r];(i.f&be)===0&&(i.f^=be);var o=Vu(i);Ou(o)}}finally{gr=n}}}function Ou(t){var e=t.length;if(e!==0)for(var n=0;n<e;n++){var r=t[n];if((r.f&(uo|Tn))===0)try{Ir(r)&&(xo(r),r.deps===null&&r.first===null&&r.nodes_start===null&&(r.teardown===null?Cl(r):r.fn=null))}catch(i){_o(i,r,null,r.ctx)}}}function Wu(){if(ni=!1,mr>1001)return;const t=Zn;Zn=[],Dl(t),ni||(mr=0,ri=null)}function bo(t){Mi===Al&&(ni||(ni=!0,queueMicrotask(Wu))),ri=t;for(var e=t;e.parent!==null;){e=e.parent;var n=e.f;if((n&(di|Sn))!==0){if((n&be)===0)return;e.f^=be}}Zn.push(e)}function Vu(t){var e=[],n=t.first;t:for(;n!==null;){var r=n.f,i=(r&Sn)!==0,o=i&&(r&be)!==0,a=n.next;if(!o&&(r&Tn)===0){if((r&sl)!==0)e.push(n);else if(i)n.f^=be;else{var s=ee;try{ee=n,Ir(n)&&xo(n)}catch(l){_o(l,n,null,n.ctx)}finally{ee=s}}var h=n.first;if(h!==null){n=h;continue}}if(a===null){let l=n.parent;for(;l!==null;){if(t===l)break t;var c=l.next;if(c!==null){n=c;continue t}l=l.parent}}n=a}return e}function Fl(t){var e=Mi,n=Zn;try{Ll();const i=[];Mi=Fu,Zn=i,ni=!1,Dl(n);var r=t==null?void 0:t();return Du(),(Zn.length>0||i.length>0)&&Fl(),mr=0,ri=null,r}finally{Mi=e,Zn=n}}async function kn(){await Promise.resolve(),Fl()}function d(t){var e=t.f,n=(e&Qe)!==0;if(Fn!==null&&Fn.add(t),ee!==null&&!cn){fn!==null&&fn.includes(t)&&lu();var r=ee.deps;t.rv<Oi&&(t.rv=Oi,$e===null&&r!==null&&r[Be]===t?Be++:$e===null?$e=[t]:(!Rn||!$e.includes(t))&&$e.push(t))}else if(n&&t.deps===null&&t.effects===null){var i=t,o=i.parent;o!==null&&(o.f&Ze)===0&&(i.f^=Ze)}return n&&(i=t,Ir(i)&&bl(i)),t.v}function qu(t){var e=Fn;Fn=new Set;var n=Fn,r;try{if(Oe(t),e!==null)for(r of Fn)e.add(r)}finally{Fn=e}return n}function Za(t){var e=qu(()=>Oe(t));for(var n of e)if((n.f&cl)!==0)for(const r of n.deps||[])(r.f&Qe)===0&&ti(r,r.v);else ti(n,n.v)}function Oe(t){var e=cn;try{return cn=!0,t()}finally{cn=e}}const Yu=-7169;function rn(t,e){t.f=t.f&Yu|e}function Fe(t){if(!(typeof t!="object"||!t||t instanceof EventTarget)){if($n in t)Vo(t);else if(!Array.isArray(t))for(let e in t){const n=t[e];typeof n=="object"&&n&&$n in n&&Vo(n)}}}function Vo(t,e=new Set){if(typeof t=="object"&&t!==null&&!(t instanceof EventTarget)&&!e.has(t)){e.add(t),t instanceof Date&&t.getTime();for(let r in t)try{Vo(t[r],e)}catch{}const n=fa(t);if(n!==Object.prototype&&n!==Array.prototype&&n!==Map.prototype&&n!==Set.prototype&&n!==Date.prototype){const r=al(n);for(let i in r){const o=r[i].get;if(o)try{o.call(t)}catch{}}}}}const Gu=["touchstart","touchmove"];function Ku(t){return Gu.includes(t)}let Ja=!1;function Xu(){Ja||(Ja=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{var e;if(!t.defaultPrevented)for(const n of t.target.elements)(e=n.__on_r)==null||e.call(n)})},{capture:!0}))}function _a(t){var e=ee,n=jt;hn(null),gn(null);try{return t()}finally{hn(e),gn(n)}}function Zu(t,e,n,r=n){t.addEventListener(e,()=>_a(n));const i=t.__on_r;i?t.__on_r=()=>{i(),r(!0)}:t.__on_r=()=>r(!0),Xu()}const Ju=new Set,Qa=new Set;function Qu(t,e,n,r={}){function i(o){if(r.capture||Kr.call(e,o),!o.cancelBubble)return _a(()=>n==null?void 0:n.call(this,o))}return t.startsWith("pointer")||t.startsWith("touch")||t==="wheel"?yo(()=>{e.addEventListener(t,i,r)}):e.addEventListener(t,i,r),i}function ye(t,e,n,r,i){var o={capture:r,passive:i},a=Qu(t,e,n,o);(e===document.body||e===window||e===document)&&pa(()=>{e.removeEventListener(t,a,o)})}function Kr(t){var $;var e=this,n=e.ownerDocument,r=t.type,i=(($=t.composedPath)==null?void 0:$.call(t))||[],o=i[0]||t.target,a=0,s=t.__root;if(s){var h=i.indexOf(s);if(h!==-1&&(e===document||e===window)){t.__root=e;return}var c=i.indexOf(e);if(c===-1)return;h<=c&&(a=h)}if(o=i[a]||t.target,o!==e){ol(t,"currentTarget",{configurable:!0,get(){return o||n}});var l=ee,f=jt;hn(null),gn(null);try{for(var u,g=[];o!==null;){var m=o.assignedSlot||o.parentNode||o.host||null;try{var v=o["__"+r];if(v!==void 0&&!o.disabled)if(so(v)){var[_,...p]=v;_.apply(o,[t,...p])}else v.call(o,t)}catch(k){u?g.push(k):u=k}if(t.cancelBubble||m===e||m===null)break;o=m}if(u){for(let k of g)queueMicrotask(()=>{throw k});throw u}}finally{t.__root=e,delete t.currentTarget,hn(l),gn(f)}}}function xa(t){var e=document.createElement("template");return e.innerHTML=t,e.content}function ii(t,e){var n=jt;n.nodes_start===null&&(n.nodes_start=t,n.nodes_end=e)}function yt(t,e){var n=(e&xu)!==0,r=(e&bu)!==0,i,o=!t.startsWith("<!>");return()=>{i===void 0&&(i=xa(o?t:"<!>"+t),n||(i=tr(i)));var a=r||vl?document.importNode(i,!0):i.cloneNode(!0);if(n){var s=tr(a),h=a.lastChild;ii(s,h)}else ii(a,a);return a}}function ba(t,e,n="svg"){var r=!t.startsWith("<!>"),i=`<${n}>${r?t:"<!>"+t}</${n}>`,o;return()=>{if(!o){var a=xa(i),s=tr(a);o=tr(s)}var h=o.cloneNode(!0);return ii(h,h),h}}function ae(){var t=document.createDocumentFragment(),e=document.createComment(""),n=ma();return t.append(e,n),ii(e,n),t}function et(t,e){t!==null&&t.before(e)}let qo=!0;function ut(t,e){var n=e==null?"":typeof e=="object"?e+"":e;n!==(t.__t??(t.__t=t.nodeValue))&&(t.__t=n,t.nodeValue=n+"")}function ju(t,e){return tf(t,e)}const sr=new Map;function tf(t,{target:e,anchor:n,props:r={},events:i,context:o,intro:a=!0}){zu();var s=new Set,h=f=>{for(var u=0;u<f.length;u++){var g=f[u];if(!s.has(g)){s.add(g);var m=Ku(g);e.addEventListener(g,Kr,{passive:m});var v=sr.get(g);v===void 0?(document.addEventListener(g,Kr,{passive:m}),sr.set(g,1)):sr.set(g,v+1)}}};h(ua(Ju)),Qa.add(h);var c=void 0,l=Nu(()=>{var f=n??e.appendChild(ma());return xr(()=>{if(o){we({});var u=Ht;u.c=o}i&&(r.$$events=i),qo=a,c=t(f,r)||{},qo=!0,o&&Te()}),()=>{var m;for(var u of s){e.removeEventListener(u,Kr);var g=sr.get(u);--g===0?(document.removeEventListener(u,Kr),sr.delete(u)):sr.set(u,g)}Qa.delete(h),f!==n&&((m=f.parentNode)==null||m.removeChild(f))}});return ef.set(c,l),c}let ef=new WeakMap;function Dt(t,e,n=!1){var r=t,i=null,o=null,a=Le,s=n?fo:0,h=!1;const c=(f,u=!0)=>{h=!0,l(u,f)},l=(f,u)=>{a!==(a=f)&&(a?(i?Hi(i):u&&(i=xr(()=>u(r))),o&&Ui(o,()=>{o=null})):(o?Hi(o):u&&(o=xr(()=>u(r))),i&&Ui(i,()=>{i=null})))};vo(()=>{h=!1,e(c),h||l(null,null)},s)}function pr(t,e){return e}function nf(t,e,n,r){for(var i=[],o=e.length,a=0;a<o;a++)va(e[a].e,i,!0);var s=o>0&&i.length===0&&n!==null;if(s){var h=n.parentNode;Mu(h),h.append(n),r.clear(),Dn(t,e[0].prev,e[o-1].next)}kl(i,()=>{for(var c=0;c<o;c++){var l=e[c];s||(r.delete(l.k),Dn(t,l.prev,l.next)),Cn(l.e,!s)}})}function Hn(t,e,n,r,i,o=null){var a=t,s={flags:e,items:new Map,first:null},h=(e&gl)!==0;if(h){var c=t;a=c.appendChild(ma())}var l=null,f=!1,u=re(()=>{var g=n();return so(g)?g:g==null?[]:ua(g)});vo(()=>{var g=d(u),m=g.length;f&&m===0||(f=m===0,rf(g,s,a,i,e,r,n),o!==null&&(m===0?l?Hi(l):l=xr(()=>o(a)):l!==null&&Ui(l,()=>{l=null})),d(u))})}function rf(t,e,n,r,i,o,a){var W,J,z,R;var s=(i&du)!==0,h=(i&(ha|ga))!==0,c=t.length,l=e.items,f=e.first,u=f,g,m=null,v,_=[],p=[],$,k,w,b;if(s)for(b=0;b<c;b+=1)$=t[b],k=o($,b),w=l.get(k),w!==void 0&&((W=w.a)==null||W.measure(),(v??(v=new Set)).add(w));for(b=0;b<c;b+=1){if($=t[b],k=o($,b),w=l.get(k),w===void 0){var y=u?u.e.nodes_start:n;m=af(y,e,m,m===null?e.first:m.next,$,k,b,r,i,a),l.set(k,m),_=[],p=[],u=m.next;continue}if(h&&of(w,$,b,i),(w.e.f&Tn)!==0&&(Hi(w.e),s&&((J=w.a)==null||J.unfix(),(v??(v=new Set)).delete(w))),w!==u){if(g!==void 0&&g.has(w)){if(_.length<p.length){var S=p[0],L;m=S.prev;var B=_[0],T=_[_.length-1];for(L=0;L<_.length;L+=1)ja(_[L],S,n);for(L=0;L<p.length;L+=1)g.delete(p[L]);Dn(e,B.prev,T.next),Dn(e,m,B),Dn(e,T,S),u=S,m=T,b-=1,_=[],p=[]}else g.delete(w),ja(w,u,n),Dn(e,w.prev,w.next),Dn(e,w,m===null?e.first:m.next),Dn(e,m,w),m=w;continue}for(_=[],p=[];u!==null&&u.k!==k;)(u.e.f&Tn)===0&&(g??(g=new Set)).add(u),p.push(u),u=u.next;if(u===null)continue;w=u}_.push(w),m=w,u=w.next}if(u!==null||g!==void 0){for(var E=g===void 0?[]:ua(g);u!==null;)(u.e.f&Tn)===0&&E.push(u),u=u.next;var I=E.length;if(I>0){var P=(i&gl)!==0&&c===0?n:null;if(s){for(b=0;b<I;b+=1)(z=E[b].a)==null||z.measure();for(b=0;b<I;b+=1)(R=E[b].a)==null||R.fix()}nf(e,E,P,l)}}s&&yo(()=>{var V;if(v!==void 0)for(w of v)(V=w.a)==null||V.apply()}),jt.first=e.first&&e.first.e,jt.last=m&&m.e}function of(t,e,n,r){(r&ha)!==0&&ti(t.v,e),(r&ga)!==0?ti(t.i,n):t.i=n}function af(t,e,n,r,i,o,a,s,h,c){var l=(h&ha)!==0,f=(h&hu)===0,u=l?f?go(i):Ke(i):i,g=(h&ga)===0?a:Ke(a),m={i:g,v:u,k:o,a:null,e:null,prev:n,next:r};try{return m.e=xr(()=>s(t,u,g,c),pl),m.e.prev=n&&n.e,m.e.next=r&&r.e,n===null?e.first=m:(n.next=m,n.e.next=m.e),r!==null&&(r.prev=m,r.e.prev=m.e),m}finally{}}function ja(t,e,n){for(var r=t.next?t.next.e.nodes_start:n,i=e?e.e.nodes_start:n,o=t.e.nodes_start;o!==r;){var a=mo(o);i.before(o),o=a}}function Dn(t,e,n){e===null?t.first=n:(e.next=n,e.e.next=n&&n.e),n!==null&&(n.prev=e,n.e.prev=e&&e.e)}function Rl(t,e,n,r,i){var o=t,a="",s;vo(()=>{a!==(a=e()??"")&&(s!==void 0&&(Cn(s),s=void 0),a!==""&&(s=xr(()=>{var h=a+"",c=xa(h);ii(tr(c),c.lastChild),o.before(c)})))})}function Pl(t,e,n,r,i){var s;var o=(s=e.$$slots)==null?void 0:s[n],a=!1;o===!0&&(o=e.children,a=!0),o===void 0?i!==null&&i(t):o(t,a?()=>r:r)}function ts(t,e){var n=t.__attributes??(t.__attributes={});n.value===(n.value=e??void 0)||t.value===e&&(e!==0||t.nodeName!=="PROGRESS")||(t.value=e??"")}function ve(t,e,n,r){var i=t.__attributes??(t.__attributes={});i[e]!==(i[e]=n)&&(e==="style"&&"__styles"in t&&(t.__styles={}),e==="loading"&&(t[tu]=n),n==null?t.removeAttribute(e):typeof n!="string"&&sf(t).includes(e)?t[e]=n:t.setAttribute(e,n))}var es=new Map;function sf(t){var e=es.get(t.nodeName);if(e)return e;es.set(t.nodeName,e=[]);for(var n,r=t,i=Element.prototype;i!==r;){n=al(r);for(var o in n)n[o].set&&e.push(o);r=fa(r)}return e}function wo(t,e,n){var r=t.__className,i=lf(e);(r!==i||pl)&&(e==null?t.removeAttribute("class"):t.className=i,t.__className=i)}function lf(t,e){return(t??"")+""}function cf(t,e,n){if(n){if(t.classList.contains(e))return;t.classList.add(e)}else{if(!t.classList.contains(e))return;t.classList.remove(e)}}const uf=()=>performance.now(),_n={tick:t=>requestAnimationFrame(t),now:()=>uf(),tasks:new Set};function Ul(){const t=_n.now();_n.tasks.forEach(e=>{e.c(t)||(_n.tasks.delete(e),e.f())}),_n.tasks.size!==0&&_n.tick(Ul)}function ff(t){let e;return _n.tasks.size===0&&_n.tick(Ul),{promise:new Promise(n=>{_n.tasks.add(e={c:t,f:n})}),abort(){_n.tasks.delete(e)}}}function yi(t,e){_a(()=>{t.dispatchEvent(new CustomEvent(e))})}function df(t){if(t==="float")return"cssFloat";if(t==="offset")return"cssOffset";if(t.startsWith("--"))return t;const e=t.split("-");return e.length===1?e[0]:e[0]+e.slice(1).map(n=>n[0].toUpperCase()+n.slice(1)).join("")}function ns(t){const e={},n=t.split(";");for(const r of n){const[i,o]=r.split(":");if(!i||o===void 0)break;const a=df(i.trim());e[a]=o.trim()}return e}const hf=t=>t;function gf(t,e,n,r){var i=(t&_u)!==0,o="both",a,s=e.inert,h=e.style.overflow,c,l;function f(){var _=ee,p=jt;hn(null),gn(null);try{return a??(a=n()(e,(r==null?void 0:r())??{},{direction:o}))}finally{hn(_),gn(p)}}var u={is_global:i,in(){e.inert=s,yi(e,"introstart"),c=Yo(e,f(),l,1,()=>{yi(e,"introend"),c==null||c.abort(),c=a=void 0,e.style.overflow=h})},out(_){e.inert=!0,yi(e,"outrostart"),l=Yo(e,f(),c,0,()=>{yi(e,"outroend"),_==null||_()})},stop:()=>{c==null||c.abort(),l==null||l.abort()}},g=jt;if((g.transitions??(g.transitions=[])).push(u),qo){var m=i;if(!m){for(var v=g.parent;v&&(v.f&fo)!==0;)for(;(v=v.parent)&&(v.f&co)===0;);m=!v||(v.f&ll)!==0}m&&Er(()=>{Oe(()=>u.in())})}}function Yo(t,e,n,r,i){var o=r===1;if(Zc(e)){var a,s=!1;return yo(()=>{if(!s){var _=e({direction:o?"in":"out"});a=Yo(t,_,n,r,i)}}),{abort:()=>{s=!0,a==null||a.abort()},deactivate:()=>a.deactivate(),reset:()=>a.reset(),t:()=>a.t()}}if(n==null||n.deactivate(),!(e!=null&&e.duration))return i(),{abort:Pe,deactivate:Pe,reset:Pe,t:()=>r};const{delay:h=0,css:c,tick:l,easing:f=hf}=e;var u=[];if(o&&n===void 0&&(l&&l(0,1),c)){var g=ns(c(0,1));u.push(g,g)}var m=()=>1-r,v=t.animate(u,{duration:h});return v.onfinish=()=>{var _=(n==null?void 0:n.t())??1-r;n==null||n.abort();var p=r-_,$=e.duration*Math.abs(p),k=[];if($>0){var w=!1;if(c)for(var b=Math.ceil($/16.666666666666668),y=0;y<=b;y+=1){var S=_+p*f(y/b),L=ns(c(S,1-S));k.push(L),w||(w=L.overflow==="hidden")}w&&(t.style.overflow="hidden"),m=()=>{var B=v.currentTime;return _+p*f(B/$)},l&&ff(()=>{if(v.playState!=="running")return!1;var B=m();return l(B,1-B),!0})}v=t.animate(k,{duration:$,fill:"forwards"}),v.onfinish=()=>{m=()=>r,l==null||l(r,1-r),i()}},{abort:()=>{v&&(v.cancel(),v.effect=null,v.onfinish=Pe)},deactivate:()=>{i=Pe},reset:()=>{r===0&&(l==null||l(1,0))},t:()=>m()}}function _i(t,e,n){var r=Qn(t,e);r&&r.set&&(t[e]=n,pa(()=>{t[e]=null}))}function oi(t,e,n){if(t.multiple)return mf(t,e);for(var r of t.options){var i=jr(r);if(ku(i,e)){r.selected=!0;return}}(!n||e!==void 0)&&(t.selectedIndex=-1)}function Go(t,e){let n=!0;Er(()=>{e&&oi(t,Oe(e),n),n=!1;var r=new MutationObserver(()=>{var i=t.__value;oi(t,i)});return r.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{r.disconnect()}})}function rs(t,e,n=e){var r=!0;Zu(t,"change",i=>{var o=i?"[selected]":":checked",a;if(t.multiple)a=[].map.call(t.querySelectorAll(o),jr);else{var s=t.querySelector(o)??t.querySelector("option:not([disabled])");a=s&&jr(s)}n(a)}),Er(()=>{var i=e();if(oi(t,i,r),r&&i===void 0){var o=t.querySelector(":checked");o!==null&&(i=jr(o),n(i))}t.__value=i,r=!1}),Go(t)}function mf(t,e){for(var n of t.options)n.selected=~e.indexOf(jr(n))}function jr(t){return"__value"in t?t.__value:t.value}function is(t,e){return t===e||(t==null?void 0:t[$n])===e}function We(t={},e,n,r){return Er(()=>{var i,o;return po(()=>{i=o,o=[],Oe(()=>{t!==n(...o)&&(e(t,...o),i&&is(n(...i),t)&&e(null,...i))})}),()=>{yo(()=>{o&&is(n(...o),t)&&e(null,...o)})}}),t}function ke(t=!1){const e=Ht,n=e.l.u;if(!n)return;let r=()=>Fe(e.s);if(t){let i=0,o={};const a=ei(()=>{let s=!1;const h=e.s;for(const c in h)h[c]!==o[c]&&(o[c]=h[c],s=!0);return s&&i++,i});r=()=>d(a)}n.b.length&&Iu(()=>{os(e,r),Fi(n.b)}),Oo(()=>{const i=Oe(()=>n.m.map(Jc));return()=>{for(const o of i)typeof o=="function"&&o()}}),n.a.length&&Oo(()=>{os(e,r),Fi(n.a)})}function os(t,e){if(t.l.s)for(const n of t.l.s)d(n);e()}function wa(t,e,n){if(t==null)return e(void 0),n&&n(void 0),Pe;const r=Oe(()=>t.subscribe(e,n));return r.unsubscribe?()=>r.unsubscribe():r}const lr=[];function pf(t,e){return{subscribe:Ta(t,e).subscribe}}function Ta(t,e=Pe){let n=null;const r=new Set;function i(s){if(dl(t,s)&&(t=s,n)){const h=!lr.length;for(const c of r)c[1](),lr.push(c,t);if(h){for(let c=0;c<lr.length;c+=2)lr[c][0](lr[c+1]);lr.length=0}}}function o(s){i(s(t))}function a(s,h=Pe){const c=[s,h];return r.add(c),r.size===1&&(n=e(i,o)||Pe),s(t),()=>{r.delete(c),r.size===0&&n&&(n(),n=null)}}return{set:i,update:o,subscribe:a}}function vf(t,e,n){const r=!Array.isArray(t),i=r?[t]:t;if(!i.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const o=e.length<2;return pf(n,(a,s)=>{let h=!1;const c=[];let l=0,f=Pe;const u=()=>{if(l)return;f();const m=e(r?c[0]:c,a,s);o?a(m):f=typeof m=="function"?m:Pe},g=i.map((m,v)=>wa(m,_=>{c[v]=_,l&=~(1<<v),h&&u()},()=>{l|=1<<v}));return h=!0,u(),function(){Fi(g),f(),h=!1}})}function Hl(t){let e;return wa(t,n=>e=n)(),e}let xi=!1,Ko=Symbol();function mt(t,e,n){const r=n[e]??(n[e]={store:null,source:go(void 0),unsubscribe:Pe});if(r.store!==t&&!(Ko in n))if(r.unsubscribe(),r.store=t??null,t==null)r.source.v=void 0,r.unsubscribe=Pe;else{var i=!0;r.unsubscribe=wa(t,o=>{i?r.source.v=o:D(r.source,o)}),i=!1}return t&&Ko in n?Hl(t):d(r.source)}function bi(t,e,n){let r=n[e];return r&&r.store!==t&&(r.unsubscribe(),r.unsubscribe=Pe),t}function je(){const t={};function e(){pa(()=>{for(var n in t)t[n].unsubscribe();ol(t,Ko,{enumerable:!1,value:!0})})}return[t,e]}function yf(t){var e=xi;try{return xi=!1,[t(),xi]}finally{xi=e}}function Kt(t,e,n,r){var S;var i=(n&gu)!==0,o=!Mr||(n&mu)!==0,a=(n&vu)!==0,s=(n&yu)!==0,h=!1,c;a?[c,h]=yf(()=>t[e]):c=t[e];var l=$n in t||jc in t,f=a&&(((S=Qn(t,e))==null?void 0:S.set)??(l&&e in t&&(L=>t[e]=L)))||void 0,u=r,g=!0,m=!1,v=()=>(m=!0,g&&(g=!1,s?u=Oe(r):u=r),u);c===void 0&&r!==void 0&&(f&&o&&ou(),c=v(),f&&f(c));var _;if(o)_=()=>{var L=t[e];return L===void 0?v():(g=!0,m=!1,L)};else{var p=(i?ei:re)(()=>t[e]);p.f|=cl,_=()=>{var L=d(p);return L!==void 0&&(u=void 0),L===void 0?u:L}}if((n&pu)===0)return _;if(f){var $=t.$$legacy;return function(L,B){return arguments.length>0?((!o||!B||$||h)&&f(B?_():L),L):_()}}var k=!1,w=!1,b=go(c),y=ei(()=>{var L=_(),B=d(b);return k?(k=!1,w=!0,B):(w=!1,b.v=L)});return i||(y.equals=da),function(L,B){if(Fn!==null&&(k=w,_(),d(b)),arguments.length>0){const T=B?d(y):o&&a?ur(L):L;return y.equals(T)||(k=!0,D(b,T),m&&u!==void 0&&(u=T),Oe(()=>d(y))),L}return d(y)}}function qe(t){Ht===null&&Ar(),Mr&&Ht.l!==null?$a(Ht).m.push(t):Oo(()=>{const e=Oe(t);if(typeof e=="function")return e})}function In(t){Ht===null&&Ar(),qe(()=>()=>Oe(t))}function _f(t,e,{bubbles:n=!1,cancelable:r=!1}={}){return new CustomEvent(t,{detail:e,bubbles:n,cancelable:r})}function Bl(){const t=Ht;return t===null&&Ar(),(e,n,r)=>{var o;const i=(o=t.s.$$events)==null?void 0:o[e];if(i){const a=so(i)?i.slice():[i],s=_f(e,n,r);for(const h of a)h.call(t.x,s);return!s.defaultPrevented}return!0}}function xf(t){Ht===null&&Ar(),Ht.l===null&&hl(),$a(Ht).b.push(t)}function bf(t){Ht===null&&Ar(),Ht.l===null&&hl(),$a(Ht).a.push(t)}function $a(t){var e=t.l;return e.u??(e.u={a:[],b:[],m:[]})}const wf="5";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(wf);fu();let Br=null;const{subscribe:Tf,set:$f,update:as}=Ta({items:[],loading:!1,error:null}),fe={subscribe:Tf,loadItems:async()=>Br||(as(t=>({...t,loading:!0,error:null})),Br=(async()=>{try{const e=await(await fetch("/IWAC-overview/items.json")).json();return $f({items:e,loading:!1,error:null}),e}catch(t){const e=t instanceof Error?t.message:"Failed to load items";throw as(n=>({...n,loading:!1,error:e})),t}finally{Br=null}})(),Br)},Ol={en:{"app.title":"<i>Islam West Africa Collection</i> Overview","tab.countries":"Country distribution","tab.languages":"Languages","tab.timeline":"Collection growth","tab.types":"Type distribution","tab.categories":"Index","tab.words":"Word count","ui.loading":"Loading database...","ui.select_visualization":"Select a visualization from the tabs above","ui.toggle_language":"Français","ui.show_description":"Show description","ui.hide_description":"Hide description","ui.no_visualization_content":"No visualization content available","ui.enter_fullscreen":"Enter fullscreen mode","ui.exit_fullscreen":"Exit fullscreen mode","ui.download_visualization":"Download visualization","viz.summary":"Summary","viz.total_items":"Total items","viz.number_of_categories":"Number of categories","viz.top_categories":"Top Categories","viz.filter_by_country":"Filter by Country","viz.filter_by_type":"Filter by Type","viz.showing_items":"Showing {0} items in {1} languages","viz.all_countries":"All Countries","viz.all_types":"All Types","viz.no_data":"No data available with the current filters","viz.distribution_items":"Distribution of {0} items by country and sub-collection","viz.language_distribution_title":"Language Distribution","viz.language_distribution_items":"Distribution of {0} items by language","viz.language_distribution_description":"This visualization shows the distribution of items by language. You can filter by country and item type to explore the language distribution across different segments of the collection.","viz.chart_type":"Chart Type","viz.pie_chart":"Switch to Pie Chart","viz.donut_chart":"Switch to Donut Chart","viz.items_added_since_april":"Added {0} items since April 2024","viz.items_added_since_april_title":"Growth since April 2024","viz.growth_since_april_title":"Growth Since April 2024","viz.growth_since_april":"Growth of {0} items since April 2024","viz.growth_since_april_description":"This visualization shows the growth of the database since April 2024. The blue line represents monthly additions, while the green dotted line shows the cumulative total. You can filter by country and item type to explore growth patterns.","viz.time_period":"Time period","viz.avg_monthly_additions":"Average monthly additions","viz.peak_growth_months":"Peak Growth Months","viz.showing_items_over_months":"Showing {0} items over {1} months","viz.months":"months","viz.monthly_additions":"Monthly Additions","viz.month":"Month","viz.new_items":"New Items","viz.percentage":"Percentage","viz.publication_year":"Publication Year","viz.year":"Year","viz.number_of_items":"Number of Items","viz.toggle_types":"Toggle Types","viz.toggle_languages":"Toggle Languages","viz.toggled_type":"Toggled type: {0}","viz.languages":"Languages","viz.country_distribution_title":"Country Distribution","viz.country_distribution_description":"This visualization shows the distribution of items by country and sub-collection. You can click on any country block to zoom in and see its sub-collections. The size of each block represents the number of items in that country or sub-collection.","viz.country.items":"Items","viz.country.percent_parent":"% of Parent","viz.country.percent_total":"% of Total","viz.country.click_zoom_in":"Click to zoom in","viz.country.click_zoom_out":"Click to zoom out","viz.country.unknown":"Unknown","viz.country.no_set":"No Set","viz.countries":"Countries","viz.sub_collections":"Sub-collections","viz.currently_viewing":"Currently viewing","viz.click_back_to_return":'Click the "Back to All" button to return to the full view',"viz.click_zoom_in":"Click on a country block to zoom in","viz.unknown":"Unknown","viz.no_set":"No Set","viz.word_distribution":"Word Distribution","viz.total_words":"Total Words","viz.avg_words_per_item":"Average words per Item","viz.back_to_all":"← Back to All","viz.total_items_with_word_count":"Total items with word count","viz.word_distribution_subtitle":"Word Distribution by Country and Item Set ({0} items, {1} words)","viz.word_distribution_description":"This visualization shows the distribution of words across items by country and collection. The size of each block represents the word count in that country or collection.","viz.words":"words","viz.items":"items","viz.percent_of_country":"% of country","viz.percent_of_total":"% of total","viz.item_set_summary":"Item Set Summary","lang.Français":"French","lang.Anglais":"English","lang.Haoussa":"Hausa","lang.Allemand":"German","lang.Arabe":"Arabic","lang.Italien":"Italian","lang.Dendi":"Dendi","lang.Slovène":"Slovenian","lang.Espagnol":"Spanish","country.all":"All Countries","country.Bénin":"Benin","country.Nigéria":"Nigeria","country.Côte d'Ivoire":"Côte d'Ivoire","country.Burkina Faso":"Burkina Faso","country.Togo":"Togo","country.Niger":"Niger","country.Unknown":"Unknown","type.Article de presse":"Press article","type.Notice d'autorité":"Authority record","type.Périodique islamique":"Islamic periodical","type.Unknown":"Unknown","type.Article de revue":"Journal article","type.Document":"Document","type.Article de blog":"Blog post","type.Chapitre de livre":"Book chapter","type.Livre":"Book","type.Thèse de doctorat":"Doctoral thesis","type.Communication scientifique":"Scientific communication","type.Article d'encyclopédie":"Encyclopedia article","type.Compte rendu de livre":"Book review","type.Enregistrement vidéo":"Video recording","type.Mémoire de licence":"Bachelor's thesis","type.Mémoire de maitrise":"Master's thesis","type.Photographie":"Photograph","type.Rapport":"Report","type.Working paper":"Working paper","type.all":"All types","viz.index_distribution_title":"Index Distribution","viz.index_distribution_items":"Distribution of {0} index items by category","viz.index_distribution_description":"This visualization shows the distribution of index items by category. The size of each bar represents the number of items in that category. Index items are authority records that serve as reference points in the database.","viz.categories":"Categories","viz.uncategorized":"Uncategorized","viz.type_distribution_title":"Type Distribution","viz.type_distribution_items":"Distribution of {0} items by type","viz.type_distribution_description":"This visualization shows the distribution of items by type over time. You can filter by country and year range to explore how different types of items have been published over time.","viz.types":"Types","viz.published_between":"published between {0} and {1}","viz.type":"Type","viz.count":"Count","viz.others":"Others","category.Events":"Events","category.Locations":"Locations","category.Organizations":"Organizations","category.Persons":"Persons","category.Topics":"Topics","category.Authority Files":"Authority files"},fr:{"app.title":"Aperçu de la <i>Collection Islam Afrique de l'Ouest</i>","tab.countries":"Répartition par pays","tab.languages":"Langues","tab.timeline":"Croissance collection","tab.types":"Répartition par type","tab.categories":"Index","tab.words":"Nombre de mots","ui.loading":"Chargement de la base de données...","ui.select_visualization":"Sélectionnez une visualisation dans les onglets ci-dessus","ui.toggle_language":"English","ui.show_description":"Afficher la description","ui.hide_description":"Masquer la description","ui.no_visualization_content":"Aucun contenu de visualisation disponible","ui.enter_fullscreen":"Passer en mode plein écran","ui.exit_fullscreen":"Quitter le mode plein écran","ui.download_visualization":"Télécharger la visualisation","viz.summary":"Résumé","viz.total_items":"Nombre total d'éléments","viz.number_of_categories":"Nombre de catégories","viz.top_categories":"Principales catégories","viz.filter_by_country":"Filtrer par pays","viz.filter_by_type":"Filtrer par type","viz.showing_items":"Affichage de {0} éléments dans {1} langues","viz.all_countries":"Tous les pays","viz.all_types":"Tous les types","viz.no_data":"Aucune donnée disponible avec les filtres actuels","viz.distribution_items":"Répartition de {0} éléments par pays et sous-collection","viz.language_distribution_title":"Répartition par langue","viz.language_distribution_items":"Répartition de {0} éléments par langue","viz.language_distribution_description":"Cette visualisation montre la répartition des éléments par langue. Vous pouvez filtrer par pays et par type d'élément pour explorer la répartition des langues dans différents segments de la collection.","viz.chart_type":"Type de graphique","viz.pie_chart":"Passer au graphique en secteurs","viz.donut_chart":"Passer au graphique en anneau","viz.items_added_since_april":"{0} éléments ajoutés depuis avril 2024","viz.items_added_since_april_title":"Croissance depuis avril 2024","viz.growth_since_april_title":"Croissance depuis avril 2024","viz.growth_since_april":"Croissance de {0} éléments depuis avril 2024","viz.growth_since_april_description":"Cette visualisation montre la croissance de la base de données depuis avril 2024. La ligne bleue représente les ajouts mensuels, tandis que la ligne pointillée verte montre le total cumulatif. Vous pouvez filtrer par pays et par type d'élément pour explorer les modèles de croissance.","viz.time_period":"Période","viz.avg_monthly_additions":"Ajouts mensuels moyens","viz.peak_growth_months":"Mois de croissance maximale","viz.showing_items_over_months":"Affichage de {0} éléments sur {1} mois","viz.months":"mois","viz.monthly_additions":"Ajouts mensuels","viz.month":"Mois","viz.new_items":"Nouveaux Éléments","viz.percentage":"Pourcentage","viz.publication_year":"Année de publication","viz.year":"Année","viz.number_of_items":"Nombre d'éléments","viz.toggle_types":"Basculer les types","viz.toggle_languages":"Basculer les langues","viz.toggled_type":"Type basculé : {0}","viz.languages":"Langues","viz.country_distribution_title":"Répartition par pays","viz.country_distribution_description":"Cette visualisation montre la répartition des éléments par pays et sous-collection. Vous pouvez cliquer sur n'importe quel bloc pays pour zoomer et voir ses sous-collections. La taille de chaque bloc représente le nombre d'éléments dans ce pays ou cette sous-collection.","viz.country.items":"Éléments","viz.country.percent_parent":"% du parent","viz.country.percent_total":"% du total","viz.country.click_zoom_in":"Cliquer pour zoomer","viz.country.click_zoom_out":"Cliquer pour dézoomer","viz.country.unknown":"Inconnu","viz.country.no_set":"Sans ensemble","viz.countries":"Pays","viz.sub_collections":"Sous-collections","viz.currently_viewing":"Affichage actuel","viz.click_back_to_return":'Cliquez sur le bouton "Retour à tous" pour revenir à la vue complète',"viz.click_zoom_in":"Cliquez sur un bloc pays pour zoomer","viz.unknown":"Inconnu","viz.no_set":"Sans ensemble","viz.word_distribution":"Répartition des mots","viz.total_words":"Nombre total de mots","viz.avg_words_per_item":"Moyenne de mots par élément","viz.back_to_all":"← Retour à tous","viz.total_items_with_word_count":"Total des éléments avec nombre de mots","viz.word_distribution_subtitle":"Répartition des mots par pays et ensemble d'éléments ({0} éléments, {1} mots)","viz.word_distribution_description":"Cette visualisation montre la répartition des mots dans les éléments par pays et collection. La taille de chaque bloc représente le nombre de mots dans ce pays ou cette collection.","viz.words":"mots","viz.items":"éléments","viz.percent_of_country":"% du pays","viz.percent_of_total":"% du total","viz.item_set_summary":"Résumé de l'ensemble d'éléments","lang.Français":"Français","lang.Anglais":"Anglais","lang.Haoussa":"Haoussa","lang.Allemand":"Allemand","lang.Arabe":"Arabe","lang.Italien":"Italien","lang.Dendi":"Dendi","lang.Slovène":"Slovène","lang.Espagnol":"Espagnol","country.all":"Tous les pays","country.Bénin":"Bénin","country.Nigéria":"Nigéria","country.Côte d'Ivoire":"Côte d'Ivoire","country.Burkina Faso":"Burkina Faso","country.Togo":"Togo","country.Niger":"Niger","country.Unknown":"Inconnu","type.Article de presse":"Article de presse","type.Notice d'autorité":"Notice d'autorité","type.Périodique islamique":"Périodique islamique","type.Unknown":"Inconnu","type.Article de revue":"Article de revue","type.Document":"Document","type.Article de blog":"Article de blog","type.Chapitre de livre":"Chapitre de livre","type.Livre":"Livre","type.Thèse de doctorat":"Thèse de doctorat","type.Communication scientifique":"Communication scientifique","type.Article d'encyclopédie":"Article d'encyclopédie","type.Compte rendu de livre":"Compte rendu de livre","type.Enregistrement vidéo":"Enregistrement vidéo","type.Mémoire de licence":"Mémoire de licence","type.Mémoire de maitrise":"Mémoire de maitrise","type.Photographie":"Photographie","type.Rapport":"Rapport","type.Working paper":"Working paper","type.all":"Tous les types","viz.index_distribution_title":"Répartition des index","viz.index_distribution_items":"Répartition de {0} éléments d'index par catégorie","viz.index_distribution_description":"Cette visualisation montre la répartition des éléments d'index par catégorie. La taille de chaque barre représente le nombre d'éléments dans cette catégorie. Les éléments d'index sont des notices d'autorité qui servent de points de référence dans la base de données.","viz.categories":"Catégories","viz.uncategorized":"Non catégorisé","viz.type_distribution_title":"Répartition par type","viz.type_distribution_items":"Répartition de {0} éléments par type","viz.type_distribution_description":"Cette visualisation montre la répartition des éléments par type au fil du temps. Vous pouvez filtrer par pays et par plage d'années pour explorer comment différents types d'éléments ont été publiés au fil du temps.","viz.types":"Types","viz.published_between":"publiés entre {0} et {1}","viz.type":"Type","viz.count":"Nombre","viz.others":"Autres","category.Events":"Événements","category.Locations":"Lieux","category.Organizations":"Organisations","category.Persons":"Personnes","category.Topics":"Sujets","category.Authority Files":"Notices d'autorité"}};function Cf(){const{subscribe:t,set:e,update:n}=Ta("en"),r=typeof window<"u"&&window.location.hostname==="localhost";return{subscribe:t,setLanguage:i=>{r&&console.log("[Translation] Language changed to:",i),e(i)},toggleLanguage:()=>n(i=>i==="en"?"fr":"en")}}const _e=Cf();function Wl(t,e){return e?t.replace(/{(\d+)}/g,(n,r)=>{const i=parseInt(r);return i<Object.keys(e).length?e[i].toString():n}):t}const at=(t,e)=>{var i;const n=Hl(_e),r=((i=Ol[n])==null?void 0:i[t])||t;return Wl(r,e)},tt=(t,e)=>vf(_e,n=>{var i;const r=((i=Ol[n])==null?void 0:i[t])||t;return Wl(r,e)});var kf=yt('<button class="btn btn-primary text-sm"> </button>');function zf(t,e){we(e,!1);const[n,r]=je(),i=()=>mt(o,"$toggleText",n),o=tt("ui.toggle_language");function a(){_e.toggleLanguage()}ke();var s=kf(),h=N(s);kt(()=>ut(h,i())),ye("click",s,a),et(t,s),Te(),r()}var Mf=ba('<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1laafbv"><path d="M8 3v3a2 2 0 0 1-2 2H3"></path><path d="M21 8h-3a2 2 0 0 1-2-2V3"></path><path d="M3 16h3a2 2 0 0 1 2 2v3"></path><path d="M16 21v-3a2 2 0 0 1 2-2h3"></path></svg>'),Af=ba('<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1laafbv"><path d="M8 3H5a2 2 0 0 0-2 2v3"></path><path d="M21 8V5a2 2 0 0 0-2-2h-3"></path><path d="M3 16v3a2 2 0 0 0 2 2h3"></path><path d="M16 21h3a2 2 0 0 0 2-2v-3"></path></svg>'),Sf=yt('<button class="btn btn-primary btn-icon"><!></button>');function Ef(t,e){we(e,!1);let n=vt(!1);function r(){document.fullscreenElement?document.exitFullscreen&&document.exitFullscreen():document.documentElement.requestFullscreen().catch(l=>{console.error(`Error attempting to enable fullscreen: ${l.message}`),i()&&console.warn('This application is in an iframe. Make sure the iframe has the "allowfullscreen" attribute.')})}function i(){try{return window.self!==window.top}catch{return!0}}function o(){D(n,!!document.fullscreenElement)}qe(()=>(document.addEventListener("fullscreenchange",o),()=>{document.removeEventListener("fullscreenchange",o)})),ke();var a=Sf(),s=N(a);{var h=l=>{var f=Mf();et(l,f)},c=l=>{var f=Af();et(l,f)};Dt(s,l=>{d(n)?l(h):l(c,!1)})}kt(l=>{ve(a,"title",l),ve(a,"aria-label",l)},[()=>d(n)?at("ui.exit_fullscreen"):at("ui.enter_fullscreen")],re),ye("click",a,r),et(t,a),Te()}var If=yt('<button class="btn btn-primary btn-icon"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1laafbv"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg></button>');function Nf(t,e){we(e,!1);function n(){var f,u,g,m;const l=document.querySelector(".visualization-content svg");if(!l){console.error("No SVG found to download");return}try{const v=l.cloneNode(!0),_=document.querySelector(".visualization-header h2");let p="";if(_&&(p=((f=_.textContent)==null?void 0:f.trim())||"",p||(p=((u=_.innerText)==null?void 0:u.trim())||""),p.includes("<")&&p.includes(">"))){const E=document.createElement("div");E.innerHTML=_.innerHTML,p=((g=E.textContent)==null?void 0:g.trim())||""}r(v),p&&o(v,p),s(v),h(v);const k=new XMLSerializer().serializeToString(v),w=new Blob([k],{type:"image/svg+xml;charset=utf-8"}),b=URL.createObjectURL(w),y=document.createElement("a");y.href=b;const S=document.querySelector(".tab-item.active"),L=S?(m=S.textContent)==null?void 0:m.trim():"visualization",T=`iwac-${a(p||L||"visualization")}`;y.download=`${T}.svg`,document.body.appendChild(y),y.click(),document.body.removeChild(y),URL.revokeObjectURL(b)}catch(v){console.error("Error downloading visualization:",v)}}function r(l){const f=Array.from(document.styleSheets),u=document.createElement("style");let g="";const m=getComputedStyle(document.documentElement),v=m.getPropertyValue("--font-family-base")||m.fontFamily||"'Arial', sans-serif";g+=`
            svg {
                font-family: ${v};
                font-size: ${m.fontSize||"14px"};
                line-height: ${m.lineHeight||"1.5"};
            }
        `;let _="";f.forEach(b=>{var y;try{const S=b.cssRules||b.rules;if(S)for(let L=0;L<S.length;L++){const B=S[L];if(B instanceof CSSStyleRule){const T=B.selectorText;T&&(T.includes("svg")||T.includes("g")||T.includes("path")||T.includes("rect")||T.includes("circle")||T.includes("text")||T.includes("line")||T.includes("polyline")||T.includes("polygon")||T.includes("axis")||T.includes("tick")||T.includes("label")||T.includes("legend")||T.includes("chart")||T.includes("bar")||T.includes("plot")||T.includes("point")||T.includes("marker")||T.includes("grid")||T.includes("visualization")||T.includes(".graph")||T.includes(".data")||T.includes(".series")||T.includes(".node")||T.includes(".link")||T.includes(".arc")||T.includes(".slice")||T.includes(".area")||T.includes(".line")||T.includes(".dot")||T.includes(".bubble")||T.includes(".tooltip")||T.includes(".domain")||T.includes(".tick")||/\b(vis|chart|graph|plot|axis|legend|tooltip)\b/i.test(T))&&(g+=B.cssText+`
`)}else if(B instanceof CSSFontFaceRule)_+=B.cssText+`
`;else if(B instanceof CSSImportRule)try{const T=(y=B.styleSheet)==null?void 0:y.cssRules;if(T)for(let E=0;E<T.length;E++)if(T[E]instanceof CSSStyleRule){const I=T[E].selectorText;I&&/\b(svg|g|path|rect|circle|text|line|axis|chart|graph|vis)\b/i.test(I)&&(g+=T[E].cssText+`
`)}else T[E]instanceof CSSFontFaceRule&&(_+=T[E].cssText+`
`)}catch(T){console.warn("Could not process imported stylesheet",T)}}}catch(S){console.warn("Could not access stylesheet rules",S)}});let p=`:root {
`;const $=getComputedStyle(document.documentElement);["--color-primary","--color-primary-dark","--color-primary-300","--color-text-light","--color-text-dark","--color-bg-page","--font-family-base","--font-size-base","--font-size-sm","--font-size-lg","--font-weight-normal","--font-weight-bold","--spacing-sm","--spacing-md","--spacing-lg","--color-text-primary","--color-border","--color-border-light"].forEach(b=>{const y=$.getPropertyValue(b);y&&(p+=`    ${b}: ${y};
`)}),f.forEach(b=>{try{const y=b.cssRules||b.rules;if(y){for(let S=0;S<y.length;S++)if(y[S]instanceof CSSStyleRule){const B=y[S].cssText.match(/var\(--[a-zA-Z0-9_-]+/g);B&&B.forEach(T=>{const E=T.substring(4);if(!p.includes(E)){const I=$.getPropertyValue(E);I&&(p+=`    ${E}: ${I};
`)}})}}}catch{}}),p+=`}
`;const w=_+p+g;if(u.textContent=w,l.firstChild?l.insertBefore(u,l.firstChild):l.appendChild(u),l.setAttribute("xmlns","http://www.w3.org/2000/svg"),l.setAttribute("version","1.1"),l.setAttribute("width",l.getAttribute("width")||"800"),l.setAttribute("height",l.getAttribute("height")||"600"),l.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),!l.style.backgroundColor){const b=m.getPropertyValue("--color-bg-page")||"#ffffff";l.style.backgroundColor=b}i(l)}function i(l){try{const f=l.querySelectorAll("text"),u=new Set;if(f.forEach(g=>{const m=g.getAttribute("font-family")||window.getComputedStyle(g).fontFamily;m&&m.split(",").forEach(v=>{const _=v.trim().replace(/['"]/g,"");_&&!_.includes("serif")&&!_.includes("sans")&&!_.includes("mono")&&!_.includes("Arial")&&!_.includes("Helvetica")&&u.add(_)})}),u.size>0){const g=Array.from(document.querySelectorAll("link")).filter(m=>{if(!m.href)return!1;try{const v=new URL(m.href);return v.protocol==="https:"&&(v.hostname==="fonts.googleapis.com"||v.hostname==="fonts.gstatic.com")}catch(v){return console.warn(`Invalid font URL detected: ${m.href}`,v),!1}});if(g.length>0){const m=document.createComment(` Embedded fonts: ${Array.from(u).join(", ")} `);l.insertBefore(m,l.firstChild),g.forEach(v=>{const _=document.createElementNS("http://www.w3.org/2000/svg","style");_.textContent=`@import url('${v.href}');`,l.insertBefore(_,l.firstChild)})}}}catch(f){console.warn("Could not embed web fonts:",f)}}function o(l,f){const u=document.createElementNS("http://www.w3.org/2000/svg","title");u.textContent=f,l.firstChild?l.insertBefore(u,l.firstChild):l.appendChild(u);const g=parseInt(l.getAttribute("width")||"800");parseInt(l.getAttribute("height")||"600");const m=document.createElementNS("http://www.w3.org/2000/svg","text");m.setAttribute("x",(g/2).toString()),m.setAttribute("y","24"),m.setAttribute("text-anchor","middle"),m.setAttribute("font-family","Arial, sans-serif"),m.setAttribute("font-size","16px"),m.setAttribute("font-weight","bold"),m.setAttribute("fill","var(--color-primary, #333)"),m.textContent=f,l.appendChild(m)}function a(l){let f=l.toLowerCase().replace(/[<>:"/\\|?*\x00-\x1F]/g,"-").replace(/\s+/g,"-").replace(/&/g,"and").replace(/--+/g,"-").replace(/^-+|-+$/g,"");return f.length>50&&(f=f.substring(0,50)),f.replace(/-+$/g,"")}function s(l){l.querySelectorAll("*");const f=getComputedStyle(document.documentElement),u=f.getPropertyValue("--font-family-base")||f.fontFamily||"'Arial', sans-serif";if(l.querySelectorAll("text").forEach(m=>{m.hasAttribute("font-family")||m.setAttribute("font-family",u.replace(/['"]/g,""));const v=m.getAttribute("fill");(!v||v==="none"||v==="transparent")&&m.setAttribute("fill",f.getPropertyValue("--color-text-primary")||"#333333"),m.hasAttribute("font-size")||m.setAttribute("font-size",f.getPropertyValue("--font-size-base")||"14px")}),l.querySelectorAll(".axis path, .axis line, .domain").forEach(m=>{m instanceof SVGElement&&(m.hasAttribute("stroke")||m.setAttribute("stroke",f.getPropertyValue("--color-border")||"#cccccc"))}),l.querySelectorAll(".grid line, .grid path, .tick line").forEach(m=>{m instanceof SVGElement&&(m.hasAttribute("stroke")||m.setAttribute("stroke",f.getPropertyValue("--color-border-light")||"#e5e5e5"))}),l.querySelectorAll(".bar, .line, .area, .point, .mark").forEach(m=>{m instanceof SVGElement&&!m.hasAttribute("fill")&&m.tagName.toLowerCase()!=="line"&&m.setAttribute("fill",f.getPropertyValue("--color-primary")||"#4299e1")}),!l.hasAttribute("viewBox")&&l.hasAttribute("width")&&l.hasAttribute("height")){const m=l.getAttribute("width")||"800",v=l.getAttribute("height")||"600";l.setAttribute("viewBox",`0 0 ${m} ${v}`)}l.style.backgroundColor||(l.style.backgroundColor=f.getPropertyValue("--color-bg-page")||"#ffffff")}function h(l){const f=parseInt(l.getAttribute("width")||"800"),u=parseInt(l.getAttribute("height")||"600"),g=getComputedStyle(document.documentElement),m=g.getPropertyValue("--color-bg-page")||g.getPropertyValue("--color-bg-primary")||"#ffffff",v=document.createElementNS("http://www.w3.org/2000/svg","rect");v.setAttribute("width",f.toString()),v.setAttribute("height",u.toString()),v.setAttribute("x","0"),v.setAttribute("y","0"),v.setAttribute("fill",m);const _=l.firstChild;_?l.insertBefore(v,_):l.appendChild(v),l.style.backgroundColor=m;const p=document.createComment(" Background rectangle added for proper rendering ");l.insertBefore(p,v)}ke();var c=If();kt(l=>{ve(c,"title",l),ve(c,"aria-label",l)},[()=>at("ui.download_visualization")],re),ye("click",c,n),et(t,c),Te()}function Lf(t,e){we(e,!1);const[n,r]=je(),i=()=>mt(_e,"$languageStore",n),o="TranslationContext";let a=!1,s=()=>{},h=i();wu("translationContext",{componentId:o,getLanguage:()=>h,languageStore:_e});function c(u){a&&(h=u)}qe(()=>{a=!0,s=_e.subscribe(u=>{c(u)})}),In(()=>{s&&s(),a=!1}),ke();var l=ae(),f=Qt(l);Pl(f,e,"default",{},null),et(t,l),Te(),r()}function Ai(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Df(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Ca(t){let e,n,r;t.length!==2?(e=Ai,n=(s,h)=>Ai(t(s),h),r=(s,h)=>t(s)-h):(e=t===Ai||t===Df?t:Ff,n=t,r=t);function i(s,h,c=0,l=s.length){if(c<l){if(e(h,h)!==0)return l;do{const f=c+l>>>1;n(s[f],h)<0?c=f+1:l=f}while(c<l)}return c}function o(s,h,c=0,l=s.length){if(c<l){if(e(h,h)!==0)return l;do{const f=c+l>>>1;n(s[f],h)<=0?c=f+1:l=f}while(c<l)}return c}function a(s,h,c=0,l=s.length){const f=i(s,h,c,l-1);return f>c&&r(s[f-1],h)>-r(s[f],h)?f-1:f}return{left:i,center:a,right:o}}function Ff(){return 0}function Rf(t){return t===null?NaN:+t}const Pf=Ca(Ai),Uf=Pf.right;Ca(Rf).center;function Hf(t,e){let n,r;if(e===void 0)for(const i of t)i!=null&&(n===void 0?i>=i&&(n=r=i):(n>i&&(n=i),r<i&&(r=i)));else{let i=-1;for(let o of t)(o=e(o,++i,t))!=null&&(n===void 0?o>=o&&(n=r=o):(n>o&&(n=o),r<o&&(r=o)))}return[n,r]}class vr extends Map{constructor(e,n=Wf){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),e!=null)for(const[r,i]of e)this.set(r,i)}get(e){return super.get(ss(this,e))}has(e){return super.has(ss(this,e))}set(e,n){return super.set(Bf(this,e),n)}delete(e){return super.delete(Of(this,e))}}function ss({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):n}function Bf({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):(t.set(r,n),n)}function Of({_intern:t,_key:e},n){const r=e(n);return t.has(r)&&(n=t.get(r),t.delete(r)),n}function Wf(t){return t!==null&&typeof t=="object"?t.valueOf():t}function Xo(t){return t}function ka(t,...e){return Vl(t,Xo,Xo,e)}function ls(t,e,...n){return Vl(t,Xo,e,n)}function Vl(t,e,n,r){return function i(o,a){if(a>=r.length)return n(o);const s=new vr,h=r[a++];let c=-1;for(const l of o){const f=h(l,++c,o),u=s.get(f);u?u.push(l):s.set(f,[l])}for(const[l,f]of s)s.set(l,i(f,a));return e(s)}(t,0)}const Vf=Math.sqrt(50),qf=Math.sqrt(10),Yf=Math.sqrt(2);function Vi(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),o=r/Math.pow(10,i),a=o>=Vf?10:o>=qf?5:o>=Yf?2:1;let s,h,c;return i<0?(c=Math.pow(10,-i)/a,s=Math.round(t*c),h=Math.round(e*c),s/c<t&&++s,h/c>e&&--h,c=-c):(c=Math.pow(10,i)*a,s=Math.round(t/c),h=Math.round(e/c),s*c<t&&++s,h*c>e&&--h),h<s&&.5<=n&&n<2?Vi(t,e,n*2):[s,h,c]}function Zo(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const r=e<t,[i,o,a]=r?Vi(e,t,n):Vi(t,e,n);if(!(o>=i))return[];const s=o-i+1,h=new Array(s);if(r)if(a<0)for(let c=0;c<s;++c)h[c]=(o-c)/-a;else for(let c=0;c<s;++c)h[c]=(o-c)*a;else if(a<0)for(let c=0;c<s;++c)h[c]=(i+c)/-a;else for(let c=0;c<s;++c)h[c]=(i+c)*a;return h}function Jo(t,e,n){return e=+e,t=+t,n=+n,Vi(t,e,n)[2]}function Qo(t,e,n){e=+e,t=+t,n=+n;const r=e<t,i=r?Jo(e,t,n):Jo(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}function br(t,e){let n;if(e===void 0)for(const r of t)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of t)(i=e(i,++r,t))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function Gf(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((e-t)/n))|0,o=new Array(i);++r<i;)o[r]=t+r*n;return o}function Kf(t){return t}var Si=1,Ei=2,jo=3,Xr=4,cs=1e-6;function Xf(t){return"translate("+t+",0)"}function Zf(t){return"translate(0,"+t+")"}function Jf(t){return e=>+t(e)}function Qf(t,e){return e=Math.max(0,t.bandwidth()-e*2)/2,t.round()&&(e=Math.round(e)),n=>+t(n)+e}function jf(){return!this.__axis}function To(t,e){var n=[],r=null,i=null,o=6,a=6,s=3,h=typeof window<"u"&&window.devicePixelRatio>1?0:.5,c=t===Si||t===Xr?-1:1,l=t===Xr||t===Ei?"x":"y",f=t===Si||t===jo?Xf:Zf;function u(g){var m=r??(e.ticks?e.ticks.apply(e,n):e.domain()),v=i??(e.tickFormat?e.tickFormat.apply(e,n):Kf),_=Math.max(o,0)+s,p=e.range(),$=+p[0]+h,k=+p[p.length-1]+h,w=(e.bandwidth?Qf:Jf)(e.copy(),h),b=g.selection?g.selection():g,y=b.selectAll(".domain").data([null]),S=b.selectAll(".tick").data(m,e).order(),L=S.exit(),B=S.enter().append("g").attr("class","tick"),T=S.select("line"),E=S.select("text");y=y.merge(y.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),S=S.merge(B),T=T.merge(B.append("line").attr("stroke","currentColor").attr(l+"2",c*o)),E=E.merge(B.append("text").attr("fill","currentColor").attr(l,c*_).attr("dy",t===Si?"0em":t===jo?"0.71em":"0.32em")),g!==b&&(y=y.transition(g),S=S.transition(g),T=T.transition(g),E=E.transition(g),L=L.transition(g).attr("opacity",cs).attr("transform",function(I){return isFinite(I=w(I))?f(I+h):this.getAttribute("transform")}),B.attr("opacity",cs).attr("transform",function(I){var P=this.parentNode.__axis;return f((P&&isFinite(P=P(I))?P:w(I))+h)})),L.remove(),y.attr("d",t===Xr||t===Ei?a?"M"+c*a+","+$+"H"+h+"V"+k+"H"+c*a:"M"+h+","+$+"V"+k:a?"M"+$+","+c*a+"V"+h+"H"+k+"V"+c*a:"M"+$+","+h+"H"+k),S.attr("opacity",1).attr("transform",function(I){return f(w(I)+h)}),T.attr(l+"2",c*o),E.attr(l,c*_).text(v),b.filter(jf).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===Ei?"start":t===Xr?"end":"middle"),b.each(function(){this.__axis=w})}return u.scale=function(g){return arguments.length?(e=g,u):e},u.ticks=function(){return n=Array.from(arguments),u},u.tickArguments=function(g){return arguments.length?(n=g==null?[]:Array.from(g),u):n.slice()},u.tickValues=function(g){return arguments.length?(r=g==null?null:Array.from(g),u):r&&r.slice()},u.tickFormat=function(g){return arguments.length?(i=g,u):i},u.tickSize=function(g){return arguments.length?(o=a=+g,u):o},u.tickSizeInner=function(g){return arguments.length?(o=+g,u):o},u.tickSizeOuter=function(g){return arguments.length?(a=+g,u):a},u.tickPadding=function(g){return arguments.length?(s=+g,u):s},u.offset=function(g){return arguments.length?(h=+g,u):h},u}function td(t){return To(Si,t)}function ed(t){return To(Ei,t)}function qi(t){return To(jo,t)}function Yi(t){return To(Xr,t)}var nd={value:()=>{}};function ql(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Ii(n)}function Ii(t){this._=t}function rd(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Ii.prototype=ql.prototype={constructor:Ii,on:function(t,e){var n=this._,r=rd(t+"",n),i,o=-1,a=r.length;if(arguments.length<2){for(;++o<a;)if((i=(t=r[o]).type)&&(i=id(n[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++o<a;)if(i=(t=r[o]).type)n[i]=us(n[i],t.name,e);else if(e==null)for(i in n)n[i]=us(n[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Ii(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,o;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=this._[t],r=0,i=o.length;r<i;++r)o[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(e,n)}};function id(t,e){for(var n=0,r=t.length,i;n<r;++n)if((i=t[n]).name===e)return i.value}function us(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=nd,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var ta="http://www.w3.org/1999/xhtml";const fs={svg:"http://www.w3.org/2000/svg",xhtml:ta,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function $o(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),fs.hasOwnProperty(e)?{space:fs[e],local:t}:t}function od(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===ta&&e.documentElement.namespaceURI===ta?e.createElement(t):e.createElementNS(n,t)}}function ad(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Yl(t){var e=$o(t);return(e.local?ad:od)(e)}function sd(){}function za(t){return t==null?sd:function(){return this.querySelector(t)}}function ld(t){typeof t!="function"&&(t=za(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o=e[i],a=o.length,s=r[i]=new Array(a),h,c,l=0;l<a;++l)(h=o[l])&&(c=t.call(h,h.__data__,l,o))&&("__data__"in h&&(c.__data__=h.__data__),s[l]=c);return new Ve(r,this._parents)}function cd(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function ud(){return[]}function Gl(t){return t==null?ud:function(){return this.querySelectorAll(t)}}function fd(t){return function(){return cd(t.apply(this,arguments))}}function dd(t){typeof t=="function"?t=fd(t):t=Gl(t);for(var e=this._groups,n=e.length,r=[],i=[],o=0;o<n;++o)for(var a=e[o],s=a.length,h,c=0;c<s;++c)(h=a[c])&&(r.push(t.call(h,h.__data__,c,a)),i.push(h));return new Ve(r,i)}function Kl(t){return function(){return this.matches(t)}}function Xl(t){return function(e){return e.matches(t)}}var hd=Array.prototype.find;function gd(t){return function(){return hd.call(this.children,t)}}function md(){return this.firstElementChild}function pd(t){return this.select(t==null?md:gd(typeof t=="function"?t:Xl(t)))}var vd=Array.prototype.filter;function yd(){return Array.from(this.children)}function _d(t){return function(){return vd.call(this.children,t)}}function xd(t){return this.selectAll(t==null?yd:_d(typeof t=="function"?t:Xl(t)))}function bd(t){typeof t!="function"&&(t=Kl(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o=e[i],a=o.length,s=r[i]=[],h,c=0;c<a;++c)(h=o[c])&&t.call(h,h.__data__,c,o)&&s.push(h);return new Ve(r,this._parents)}function Zl(t){return new Array(t.length)}function wd(){return new Ve(this._enter||this._groups.map(Zl),this._parents)}function Gi(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}Gi.prototype={constructor:Gi,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function Td(t){return function(){return t}}function $d(t,e,n,r,i,o){for(var a=0,s,h=e.length,c=o.length;a<c;++a)(s=e[a])?(s.__data__=o[a],r[a]=s):n[a]=new Gi(t,o[a]);for(;a<h;++a)(s=e[a])&&(i[a]=s)}function Cd(t,e,n,r,i,o,a){var s,h,c=new Map,l=e.length,f=o.length,u=new Array(l),g;for(s=0;s<l;++s)(h=e[s])&&(u[s]=g=a.call(h,h.__data__,s,e)+"",c.has(g)?i[s]=h:c.set(g,h));for(s=0;s<f;++s)g=a.call(t,o[s],s,o)+"",(h=c.get(g))?(r[s]=h,h.__data__=o[s],c.delete(g)):n[s]=new Gi(t,o[s]);for(s=0;s<l;++s)(h=e[s])&&c.get(u[s])===h&&(i[s]=h)}function kd(t){return t.__data__}function zd(t,e){if(!arguments.length)return Array.from(this,kd);var n=e?Cd:$d,r=this._parents,i=this._groups;typeof t!="function"&&(t=Td(t));for(var o=i.length,a=new Array(o),s=new Array(o),h=new Array(o),c=0;c<o;++c){var l=r[c],f=i[c],u=f.length,g=Md(t.call(l,l&&l.__data__,c,r)),m=g.length,v=s[c]=new Array(m),_=a[c]=new Array(m),p=h[c]=new Array(u);n(l,f,v,_,p,g,e);for(var $=0,k=0,w,b;$<m;++$)if(w=v[$]){for($>=k&&(k=$+1);!(b=_[k])&&++k<m;);w._next=b||null}}return a=new Ve(a,r),a._enter=s,a._exit=h,a}function Md(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Ad(){return new Ve(this._exit||this._groups.map(Zl),this._parents)}function Sd(t,e,n){var r=this.enter(),i=this,o=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),e!=null&&(i=e(i),i&&(i=i.selection())),n==null?o.remove():n(o),r&&i?r.merge(i).order():i}function Ed(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,o=r.length,a=Math.min(i,o),s=new Array(i),h=0;h<a;++h)for(var c=n[h],l=r[h],f=c.length,u=s[h]=new Array(f),g,m=0;m<f;++m)(g=c[m]||l[m])&&(u[m]=g);for(;h<i;++h)s[h]=n[h];return new Ve(s,this._parents)}function Id(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],i=r.length-1,o=r[i],a;--i>=0;)(a=r[i])&&(o&&a.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(a,o),o=a);return this}function Nd(t){t||(t=Ld);function e(f,u){return f&&u?t(f.__data__,u.__data__):!f-!u}for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var a=n[o],s=a.length,h=i[o]=new Array(s),c,l=0;l<s;++l)(c=a[l])&&(h[l]=c);h.sort(e)}return new Ve(i,this._parents).order()}function Ld(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Dd(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function Fd(){return Array.from(this)}function Rd(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null}function Pd(){let t=0;for(const e of this)++t;return t}function Ud(){return!this.node()}function Hd(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i=e[n],o=0,a=i.length,s;o<a;++o)(s=i[o])&&t.call(s,s.__data__,o,i);return this}function Bd(t){return function(){this.removeAttribute(t)}}function Od(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Wd(t,e){return function(){this.setAttribute(t,e)}}function Vd(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function qd(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function Yd(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function Gd(t,e){var n=$o(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?Od:Bd:typeof e=="function"?n.local?Yd:qd:n.local?Vd:Wd)(n,e))}function Jl(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Kd(t){return function(){this.style.removeProperty(t)}}function Xd(t,e,n){return function(){this.style.setProperty(t,e,n)}}function Zd(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function Jd(t,e,n){return arguments.length>1?this.each((e==null?Kd:typeof e=="function"?Zd:Xd)(t,e,n??"")):wr(this.node(),t)}function wr(t,e){return t.style.getPropertyValue(e)||Jl(t).getComputedStyle(t,null).getPropertyValue(e)}function Qd(t){return function(){delete this[t]}}function jd(t,e){return function(){this[t]=e}}function th(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function eh(t,e){return arguments.length>1?this.each((e==null?Qd:typeof e=="function"?th:jd)(t,e)):this.node()[t]}function Ql(t){return t.trim().split(/^|\s+/)}function Ma(t){return t.classList||new jl(t)}function jl(t){this._node=t,this._names=Ql(t.getAttribute("class")||"")}jl.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function tc(t,e){for(var n=Ma(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function ec(t,e){for(var n=Ma(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function nh(t){return function(){tc(this,t)}}function rh(t){return function(){ec(this,t)}}function ih(t,e){return function(){(e.apply(this,arguments)?tc:ec)(this,t)}}function oh(t,e){var n=Ql(t+"");if(arguments.length<2){for(var r=Ma(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof e=="function"?ih:e?nh:rh)(n,e))}function ah(){this.textContent=""}function sh(t){return function(){this.textContent=t}}function lh(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function ch(t){return arguments.length?this.each(t==null?ah:(typeof t=="function"?lh:sh)(t)):this.node().textContent}function uh(){this.innerHTML=""}function fh(t){return function(){this.innerHTML=t}}function dh(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function hh(t){return arguments.length?this.each(t==null?uh:(typeof t=="function"?dh:fh)(t)):this.node().innerHTML}function gh(){this.nextSibling&&this.parentNode.appendChild(this)}function mh(){return this.each(gh)}function ph(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function vh(){return this.each(ph)}function yh(t){var e=typeof t=="function"?t:Yl(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function _h(){return null}function xh(t,e){var n=typeof t=="function"?t:Yl(t),r=e==null?_h:typeof e=="function"?e:za(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function bh(){var t=this.parentNode;t&&t.removeChild(this)}function wh(){return this.each(bh)}function Th(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function $h(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Ch(t){return this.select(t?$h:Th)}function kh(t){return arguments.length?this.property("__data__",t):this.node().__data__}function zh(t){return function(e){t.call(this,e,this.__data__)}}function Mh(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function Ah(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,i=e.length,o;n<i;++n)o=e[n],(!t.type||o.type===t.type)&&o.name===t.name?this.removeEventListener(o.type,o.listener,o.options):e[++r]=o;++r?e.length=r:delete this.__on}}}function Sh(t,e,n){return function(){var r=this.__on,i,o=zh(e);if(r){for(var a=0,s=r.length;a<s;++a)if((i=r[a]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=o,i.options=n),i.value=e;return}}this.addEventListener(t.type,o,n),i={type:t.type,name:t.name,value:e,listener:o,options:n},r?r.push(i):this.__on=[i]}}function Eh(t,e,n){var r=Mh(t+""),i,o=r.length,a;if(arguments.length<2){var s=this.node().__on;if(s){for(var h=0,c=s.length,l;h<c;++h)for(i=0,l=s[h];i<o;++i)if((a=r[i]).type===l.type&&a.name===l.name)return l.value}return}for(s=e?Sh:Ah,i=0;i<o;++i)this.each(s(r[i],e,n));return this}function nc(t,e,n){var r=Jl(t),i=r.CustomEvent;typeof i=="function"?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function Ih(t,e){return function(){return nc(this,t,e)}}function Nh(t,e){return function(){return nc(this,t,e.apply(this,arguments))}}function Lh(t,e){return this.each((typeof e=="function"?Nh:Ih)(t,e))}function*Dh(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length,a;i<o;++i)(a=r[i])&&(yield a)}var rc=[null];function Ve(t,e){this._groups=t,this._parents=e}function Nr(){return new Ve([[document.documentElement]],rc)}function Fh(){return this}Ve.prototype=Nr.prototype={constructor:Ve,select:ld,selectAll:dd,selectChild:pd,selectChildren:xd,filter:bd,data:zd,enter:wd,exit:Ad,join:Sd,merge:Ed,selection:Fh,order:Id,sort:Nd,call:Dd,nodes:Fd,node:Rd,size:Pd,empty:Ud,each:Hd,attr:Gd,style:Jd,property:eh,classed:oh,text:ch,html:hh,raise:mh,lower:vh,append:yh,insert:xh,remove:wh,clone:Ch,datum:kh,on:Eh,dispatch:Lh,[Symbol.iterator]:Dh};function ft(t){return typeof t=="string"?new Ve([[document.querySelector(t)]],[document.documentElement]):new Ve([[t]],rc)}function Aa(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function ic(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function gi(){}var ai=.7,Ki=1/ai,yr="\\s*([+-]?\\d+)\\s*",si="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",dn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Rh=/^#([0-9a-f]{3,8})$/,Ph=new RegExp(`^rgb\\(${yr},${yr},${yr}\\)$`),Uh=new RegExp(`^rgb\\(${dn},${dn},${dn}\\)$`),Hh=new RegExp(`^rgba\\(${yr},${yr},${yr},${si}\\)$`),Bh=new RegExp(`^rgba\\(${dn},${dn},${dn},${si}\\)$`),Oh=new RegExp(`^hsl\\(${si},${dn},${dn}\\)$`),Wh=new RegExp(`^hsla\\(${si},${dn},${dn},${si}\\)$`),ds={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Aa(gi,er,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:hs,formatHex:hs,formatHex8:Vh,formatHsl:qh,formatRgb:gs,toString:gs});function hs(){return this.rgb().formatHex()}function Vh(){return this.rgb().formatHex8()}function qh(){return oc(this).formatHsl()}function gs(){return this.rgb().formatRgb()}function er(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Rh.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?ms(e):n===3?new Ue(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?wi(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?wi(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Ph.exec(t))?new Ue(e[1],e[2],e[3],1):(e=Uh.exec(t))?new Ue(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Hh.exec(t))?wi(e[1],e[2],e[3],e[4]):(e=Bh.exec(t))?wi(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Oh.exec(t))?ys(e[1],e[2]/100,e[3]/100,1):(e=Wh.exec(t))?ys(e[1],e[2]/100,e[3]/100,e[4]):ds.hasOwnProperty(t)?ms(ds[t]):t==="transparent"?new Ue(NaN,NaN,NaN,0):null}function ms(t){return new Ue(t>>16&255,t>>8&255,t&255,1)}function wi(t,e,n,r){return r<=0&&(t=e=n=NaN),new Ue(t,e,n,r)}function Yh(t){return t instanceof gi||(t=er(t)),t?(t=t.rgb(),new Ue(t.r,t.g,t.b,t.opacity)):new Ue}function Re(t,e,n,r){return arguments.length===1?Yh(t):new Ue(t,e,n,r??1)}function Ue(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}Aa(Ue,Re,ic(gi,{brighter(t){return t=t==null?Ki:Math.pow(Ki,t),new Ue(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?ai:Math.pow(ai,t),new Ue(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Ue(jn(this.r),jn(this.g),jn(this.b),Xi(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ps,formatHex:ps,formatHex8:Gh,formatRgb:vs,toString:vs}));function ps(){return`#${Jn(this.r)}${Jn(this.g)}${Jn(this.b)}`}function Gh(){return`#${Jn(this.r)}${Jn(this.g)}${Jn(this.b)}${Jn((isNaN(this.opacity)?1:this.opacity)*255)}`}function vs(){const t=Xi(this.opacity);return`${t===1?"rgb(":"rgba("}${jn(this.r)}, ${jn(this.g)}, ${jn(this.b)}${t===1?")":`, ${t})`}`}function Xi(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function jn(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Jn(t){return t=jn(t),(t<16?"0":"")+t.toString(16)}function ys(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new nn(t,e,n,r)}function oc(t){if(t instanceof nn)return new nn(t.h,t.s,t.l,t.opacity);if(t instanceof gi||(t=er(t)),!t)return new nn;if(t instanceof nn)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),a=NaN,s=o-i,h=(o+i)/2;return s?(e===o?a=(n-r)/s+(n<r)*6:n===o?a=(r-e)/s+2:a=(e-n)/s+4,s/=h<.5?o+i:2-o-i,a*=60):s=h>0&&h<1?0:a,new nn(a,s,h,t.opacity)}function Kh(t,e,n,r){return arguments.length===1?oc(t):new nn(t,e,n,r??1)}function nn(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}Aa(nn,Kh,ic(gi,{brighter(t){return t=t==null?Ki:Math.pow(Ki,t),new nn(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?ai:Math.pow(ai,t),new nn(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Ue(So(t>=240?t-240:t+120,i,r),So(t,i,r),So(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new nn(_s(this.h),Ti(this.s),Ti(this.l),Xi(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Xi(this.opacity);return`${t===1?"hsl(":"hsla("}${_s(this.h)}, ${Ti(this.s)*100}%, ${Ti(this.l)*100}%${t===1?")":`, ${t})`}`}}));function _s(t){return t=(t||0)%360,t<0?t+360:t}function Ti(t){return Math.max(0,Math.min(1,t||0))}function So(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}function Xh(t,e,n,r,i){var o=t*t,a=o*t;return((1-3*t+3*o-a)*e+(4-6*o+3*a)*n+(1+3*t+3*o-3*a)*r+a*i)/6}function Zh(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],o=t[r+1],a=r>0?t[r-1]:2*i-o,s=r<e-1?t[r+2]:2*o-i;return Xh((n-r/e)*e,a,i,o,s)}}const Sa=t=>()=>t;function Jh(t,e){return function(n){return t+n*e}}function Qh(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function jh(t){return(t=+t)==1?ac:function(e,n){return n-e?Qh(e,n,t):Sa(isNaN(e)?n:e)}}function ac(t,e){var n=e-t;return n?Jh(t,n):Sa(isNaN(t)?e:t)}const Zi=function t(e){var n=jh(e);function r(i,o){var a=n((i=Re(i)).r,(o=Re(o)).r),s=n(i.g,o.g),h=n(i.b,o.b),c=ac(i.opacity,o.opacity);return function(l){return i.r=a(l),i.g=s(l),i.b=h(l),i.opacity=c(l),i+""}}return r.gamma=t,r}(1);function tg(t){return function(e){var n=e.length,r=new Array(n),i=new Array(n),o=new Array(n),a,s;for(a=0;a<n;++a)s=Re(e[a]),r[a]=s.r||0,i[a]=s.g||0,o[a]=s.b||0;return r=t(r),i=t(i),o=t(o),s.opacity=1,function(h){return s.r=r(h),s.g=i(h),s.b=o(h),s+""}}}var eg=tg(Zh);function ng(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),i;return function(o){for(i=0;i<n;++i)r[i]=t[i]*(1-o)+e[i]*o;return r}}function rg(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function ig(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,i=new Array(r),o=new Array(n),a;for(a=0;a<r;++a)i[a]=Tr(t[a],e[a]);for(;a<n;++a)o[a]=e[a];return function(s){for(a=0;a<r;++a)o[a]=i[a](s);return o}}function og(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function en(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function ag(t,e){var n={},r={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?n[i]=Tr(t[i],e[i]):r[i]=e[i];return function(o){for(i in n)r[i]=n[i](o);return r}}var ea=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Eo=new RegExp(ea.source,"g");function sg(t){return function(){return t}}function lg(t){return function(e){return t(e)+""}}function sc(t,e){var n=ea.lastIndex=Eo.lastIndex=0,r,i,o,a=-1,s=[],h=[];for(t=t+"",e=e+"";(r=ea.exec(t))&&(i=Eo.exec(e));)(o=i.index)>n&&(o=e.slice(n,o),s[a]?s[a]+=o:s[++a]=o),(r=r[0])===(i=i[0])?s[a]?s[a]+=i:s[++a]=i:(s[++a]=null,h.push({i:a,x:en(r,i)})),n=Eo.lastIndex;return n<e.length&&(o=e.slice(n),s[a]?s[a]+=o:s[++a]=o),s.length<2?h[0]?lg(h[0].x):sg(e):(e=h.length,function(c){for(var l=0,f;l<e;++l)s[(f=h[l]).i]=f.x(c);return s.join("")})}function Tr(t,e){var n=typeof e,r;return e==null||n==="boolean"?Sa(e):(n==="number"?en:n==="string"?(r=er(e))?(e=r,Zi):sc:e instanceof er?Zi:e instanceof Date?og:rg(e)?ng:Array.isArray(e)?ig:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?ag:en)(t,e)}function lc(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var xs=180/Math.PI,na={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function cc(t,e,n,r,i,o){var a,s,h;return(a=Math.sqrt(t*t+e*e))&&(t/=a,e/=a),(h=t*n+e*r)&&(n-=t*h,r-=e*h),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,h/=s),t*r<e*n&&(t=-t,e=-e,h=-h,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(e,t)*xs,skewX:Math.atan(h)*xs,scaleX:a,scaleY:s}}var $i;function cg(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?na:cc(e.a,e.b,e.c,e.d,e.e,e.f)}function ug(t){return t==null||($i||($i=document.createElementNS("http://www.w3.org/2000/svg","g")),$i.setAttribute("transform",t),!(t=$i.transform.baseVal.consolidate()))?na:(t=t.matrix,cc(t.a,t.b,t.c,t.d,t.e,t.f))}function uc(t,e,n,r){function i(c){return c.length?c.pop()+" ":""}function o(c,l,f,u,g,m){if(c!==f||l!==u){var v=g.push("translate(",null,e,null,n);m.push({i:v-4,x:en(c,f)},{i:v-2,x:en(l,u)})}else(f||u)&&g.push("translate("+f+e+u+n)}function a(c,l,f,u){c!==l?(c-l>180?l+=360:l-c>180&&(c+=360),u.push({i:f.push(i(f)+"rotate(",null,r)-2,x:en(c,l)})):l&&f.push(i(f)+"rotate("+l+r)}function s(c,l,f,u){c!==l?u.push({i:f.push(i(f)+"skewX(",null,r)-2,x:en(c,l)}):l&&f.push(i(f)+"skewX("+l+r)}function h(c,l,f,u,g,m){if(c!==f||l!==u){var v=g.push(i(g)+"scale(",null,",",null,")");m.push({i:v-4,x:en(c,f)},{i:v-2,x:en(l,u)})}else(f!==1||u!==1)&&g.push(i(g)+"scale("+f+","+u+")")}return function(c,l){var f=[],u=[];return c=t(c),l=t(l),o(c.translateX,c.translateY,l.translateX,l.translateY,f,u),a(c.rotate,l.rotate,f,u),s(c.skewX,l.skewX,f,u),h(c.scaleX,c.scaleY,l.scaleX,l.scaleY,f,u),c=l=null,function(g){for(var m=-1,v=u.length,_;++m<v;)f[(_=u[m]).i]=_.x(g);return f.join("")}}}var fg=uc(cg,"px, ","px)","deg)"),dg=uc(ug,", ",")",")"),$r=0,Zr=0,Or=0,fc=1e3,Ji,Jr,Qi=0,nr=0,Co=0,li=typeof performance=="object"&&performance.now?performance:Date,dc=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Ea(){return nr||(dc(hg),nr=li.now()+Co)}function hg(){nr=0}function ji(){this._call=this._time=this._next=null}ji.prototype=hc.prototype={constructor:ji,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?Ea():+n)+(e==null?0:+e),!this._next&&Jr!==this&&(Jr?Jr._next=this:Ji=this,Jr=this),this._call=t,this._time=n,ra()},stop:function(){this._call&&(this._call=null,this._time=1/0,ra())}};function hc(t,e,n){var r=new ji;return r.restart(t,e,n),r}function gg(){Ea(),++$r;for(var t=Ji,e;t;)(e=nr-t._time)>=0&&t._call.call(void 0,e),t=t._next;--$r}function bs(){nr=(Qi=li.now())+Co,$r=Zr=0;try{gg()}finally{$r=0,pg(),nr=0}}function mg(){var t=li.now(),e=t-Qi;e>fc&&(Co-=e,Qi=t)}function pg(){for(var t,e=Ji,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:Ji=n);Jr=t,ra(r)}function ra(t){if(!$r){Zr&&(Zr=clearTimeout(Zr));var e=t-nr;e>24?(t<1/0&&(Zr=setTimeout(bs,t-li.now()-Co)),Or&&(Or=clearInterval(Or))):(Or||(Qi=li.now(),Or=setInterval(mg,fc)),$r=1,dc(bs))}}function ws(t,e,n){var r=new ji;return e=e==null?0:+e,r.restart(i=>{r.stop(),t(i+e)},e,n),r}var vg=ql("start","end","cancel","interrupt"),yg=[],gc=0,Ts=1,ia=2,Ni=3,$s=4,oa=5,Li=6;function ko(t,e,n,r,i,o){var a=t.__transition;if(!a)t.__transition={};else if(n in a)return;_g(t,n,{name:e,index:r,group:i,on:vg,tween:yg,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:gc})}function Ia(t,e){var n=an(t,e);if(n.state>gc)throw new Error("too late; already scheduled");return n}function mn(t,e){var n=an(t,e);if(n.state>Ni)throw new Error("too late; already running");return n}function an(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function _g(t,e,n){var r=t.__transition,i;r[e]=n,n.timer=hc(o,0,n.time);function o(c){n.state=Ts,n.timer.restart(a,n.delay,n.time),n.delay<=c&&a(c-n.delay)}function a(c){var l,f,u,g;if(n.state!==Ts)return h();for(l in r)if(g=r[l],g.name===n.name){if(g.state===Ni)return ws(a);g.state===$s?(g.state=Li,g.timer.stop(),g.on.call("interrupt",t,t.__data__,g.index,g.group),delete r[l]):+l<e&&(g.state=Li,g.timer.stop(),g.on.call("cancel",t,t.__data__,g.index,g.group),delete r[l])}if(ws(function(){n.state===Ni&&(n.state=$s,n.timer.restart(s,n.delay,n.time),s(c))}),n.state=ia,n.on.call("start",t,t.__data__,n.index,n.group),n.state===ia){for(n.state=Ni,i=new Array(u=n.tween.length),l=0,f=-1;l<u;++l)(g=n.tween[l].value.call(t,t.__data__,n.index,n.group))&&(i[++f]=g);i.length=f+1}}function s(c){for(var l=c<n.duration?n.ease.call(null,c/n.duration):(n.timer.restart(h),n.state=oa,1),f=-1,u=i.length;++f<u;)i[f].call(t,l);n.state===oa&&(n.on.call("end",t,t.__data__,n.index,n.group),h())}function h(){n.state=Li,n.timer.stop(),delete r[e];for(var c in r)return;delete t.__transition}}function xg(t,e){var n=t.__transition,r,i,o=!0,a;if(n){e=e==null?null:e+"";for(a in n){if((r=n[a]).name!==e){o=!1;continue}i=r.state>ia&&r.state<oa,r.state=Li,r.timer.stop(),r.on.call(i?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[a]}o&&delete t.__transition}}function bg(t){return this.each(function(){xg(this,t)})}function wg(t,e){var n,r;return function(){var i=mn(this,t),o=i.tween;if(o!==n){r=n=o;for(var a=0,s=r.length;a<s;++a)if(r[a].name===e){r=r.slice(),r.splice(a,1);break}}i.tween=r}}function Tg(t,e,n){var r,i;if(typeof n!="function")throw new Error;return function(){var o=mn(this,t),a=o.tween;if(a!==r){i=(r=a).slice();for(var s={name:e,value:n},h=0,c=i.length;h<c;++h)if(i[h].name===e){i[h]=s;break}h===c&&i.push(s)}o.tween=i}}function $g(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=an(this.node(),n).tween,i=0,o=r.length,a;i<o;++i)if((a=r[i]).name===t)return a.value;return null}return this.each((e==null?wg:Tg)(n,t,e))}function Na(t,e,n){var r=t._id;return t.each(function(){var i=mn(this,r);(i.value||(i.value={}))[e]=n.apply(this,arguments)}),function(i){return an(i,r).value[e]}}function mc(t,e){var n;return(typeof e=="number"?en:e instanceof er?Zi:(n=er(e))?(e=n,Zi):sc)(t,e)}function Cg(t){return function(){this.removeAttribute(t)}}function kg(t){return function(){this.removeAttributeNS(t.space,t.local)}}function zg(t,e,n){var r,i=n+"",o;return function(){var a=this.getAttribute(t);return a===i?null:a===r?o:o=e(r=a,n)}}function Mg(t,e,n){var r,i=n+"",o;return function(){var a=this.getAttributeNS(t.space,t.local);return a===i?null:a===r?o:o=e(r=a,n)}}function Ag(t,e,n){var r,i,o;return function(){var a,s=n(this),h;return s==null?void this.removeAttribute(t):(a=this.getAttribute(t),h=s+"",a===h?null:a===r&&h===i?o:(i=h,o=e(r=a,s)))}}function Sg(t,e,n){var r,i,o;return function(){var a,s=n(this),h;return s==null?void this.removeAttributeNS(t.space,t.local):(a=this.getAttributeNS(t.space,t.local),h=s+"",a===h?null:a===r&&h===i?o:(i=h,o=e(r=a,s)))}}function Eg(t,e){var n=$o(t),r=n==="transform"?dg:mc;return this.attrTween(t,typeof e=="function"?(n.local?Sg:Ag)(n,r,Na(this,"attr."+t,e)):e==null?(n.local?kg:Cg)(n):(n.local?Mg:zg)(n,r,e))}function Ig(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function Ng(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function Lg(t,e){var n,r;function i(){var o=e.apply(this,arguments);return o!==r&&(n=(r=o)&&Ng(t,o)),n}return i._value=e,i}function Dg(t,e){var n,r;function i(){var o=e.apply(this,arguments);return o!==r&&(n=(r=o)&&Ig(t,o)),n}return i._value=e,i}function Fg(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=$o(t);return this.tween(n,(r.local?Lg:Dg)(r,e))}function Rg(t,e){return function(){Ia(this,t).delay=+e.apply(this,arguments)}}function Pg(t,e){return e=+e,function(){Ia(this,t).delay=e}}function Ug(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Rg:Pg)(e,t)):an(this.node(),e).delay}function Hg(t,e){return function(){mn(this,t).duration=+e.apply(this,arguments)}}function Bg(t,e){return e=+e,function(){mn(this,t).duration=e}}function Og(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Hg:Bg)(e,t)):an(this.node(),e).duration}function Wg(t,e){if(typeof e!="function")throw new Error;return function(){mn(this,t).ease=e}}function Vg(t){var e=this._id;return arguments.length?this.each(Wg(e,t)):an(this.node(),e).ease}function qg(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;mn(this,t).ease=n}}function Yg(t){if(typeof t!="function")throw new Error;return this.each(qg(this._id,t))}function Gg(t){typeof t!="function"&&(t=Kl(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o=e[i],a=o.length,s=r[i]=[],h,c=0;c<a;++c)(h=o[c])&&t.call(h,h.__data__,c,o)&&s.push(h);return new zn(r,this._parents,this._name,this._id)}function Kg(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,o=Math.min(r,i),a=new Array(r),s=0;s<o;++s)for(var h=e[s],c=n[s],l=h.length,f=a[s]=new Array(l),u,g=0;g<l;++g)(u=h[g]||c[g])&&(f[g]=u);for(;s<r;++s)a[s]=e[s];return new zn(a,this._parents,this._name,this._id)}function Xg(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function Zg(t,e,n){var r,i,o=Xg(e)?Ia:mn;return function(){var a=o(this,t),s=a.on;s!==r&&(i=(r=s).copy()).on(e,n),a.on=i}}function Jg(t,e){var n=this._id;return arguments.length<2?an(this.node(),n).on.on(t):this.each(Zg(n,t,e))}function Qg(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function jg(){return this.on("end.remove",Qg(this._id))}function tm(t){var e=this._name,n=this._id;typeof t!="function"&&(t=za(t));for(var r=this._groups,i=r.length,o=new Array(i),a=0;a<i;++a)for(var s=r[a],h=s.length,c=o[a]=new Array(h),l,f,u=0;u<h;++u)(l=s[u])&&(f=t.call(l,l.__data__,u,s))&&("__data__"in l&&(f.__data__=l.__data__),c[u]=f,ko(c[u],e,n,u,c,an(l,n)));return new zn(o,this._parents,e,n)}function em(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Gl(t));for(var r=this._groups,i=r.length,o=[],a=[],s=0;s<i;++s)for(var h=r[s],c=h.length,l,f=0;f<c;++f)if(l=h[f]){for(var u=t.call(l,l.__data__,f,h),g,m=an(l,n),v=0,_=u.length;v<_;++v)(g=u[v])&&ko(g,e,n,v,u,m);o.push(u),a.push(l)}return new zn(o,a,e,n)}var nm=Nr.prototype.constructor;function rm(){return new nm(this._groups,this._parents)}function im(t,e){var n,r,i;return function(){var o=wr(this,t),a=(this.style.removeProperty(t),wr(this,t));return o===a?null:o===n&&a===r?i:i=e(n=o,r=a)}}function pc(t){return function(){this.style.removeProperty(t)}}function om(t,e,n){var r,i=n+"",o;return function(){var a=wr(this,t);return a===i?null:a===r?o:o=e(r=a,n)}}function am(t,e,n){var r,i,o;return function(){var a=wr(this,t),s=n(this),h=s+"";return s==null&&(h=s=(this.style.removeProperty(t),wr(this,t))),a===h?null:a===r&&h===i?o:(i=h,o=e(r=a,s))}}function sm(t,e){var n,r,i,o="style."+e,a="end."+o,s;return function(){var h=mn(this,t),c=h.on,l=h.value[o]==null?s||(s=pc(e)):void 0;(c!==n||i!==l)&&(r=(n=c).copy()).on(a,i=l),h.on=r}}function lm(t,e,n){var r=(t+="")=="transform"?fg:mc;return e==null?this.styleTween(t,im(t,r)).on("end.style."+t,pc(t)):typeof e=="function"?this.styleTween(t,am(t,r,Na(this,"style."+t,e))).each(sm(this._id,t)):this.styleTween(t,om(t,r,e),n).on("end.style."+t,null)}function cm(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function um(t,e,n){var r,i;function o(){var a=e.apply(this,arguments);return a!==i&&(r=(i=a)&&cm(t,a,n)),r}return o._value=e,o}function fm(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,um(t,e,n??""))}function dm(t){return function(){this.textContent=t}}function hm(t){return function(){var e=t(this);this.textContent=e??""}}function gm(t){return this.tween("text",typeof t=="function"?hm(Na(this,"text",t)):dm(t==null?"":t+""))}function mm(t){return function(e){this.textContent=t.call(this,e)}}function pm(t){var e,n;function r(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&mm(i)),e}return r._value=t,r}function vm(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,pm(t))}function ym(){for(var t=this._name,e=this._id,n=yc(),r=this._groups,i=r.length,o=0;o<i;++o)for(var a=r[o],s=a.length,h,c=0;c<s;++c)if(h=a[c]){var l=an(h,e);ko(h,t,n,c,a,{time:l.time+l.delay+l.duration,delay:0,duration:l.duration,ease:l.ease})}return new zn(r,this._parents,t,n)}function _m(){var t,e,n=this,r=n._id,i=n.size();return new Promise(function(o,a){var s={value:a},h={value:function(){--i===0&&o()}};n.each(function(){var c=mn(this,r),l=c.on;l!==t&&(e=(t=l).copy(),e._.cancel.push(s),e._.interrupt.push(s),e._.end.push(h)),c.on=e}),i===0&&o()})}var xm=0;function zn(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function vc(t){return Nr().transition(t)}function yc(){return++xm}var vn=Nr.prototype;zn.prototype=vc.prototype={constructor:zn,select:tm,selectAll:em,selectChild:vn.selectChild,selectChildren:vn.selectChildren,filter:Gg,merge:Kg,selection:rm,transition:ym,call:vn.call,nodes:vn.nodes,node:vn.node,size:vn.size,empty:vn.empty,each:vn.each,on:Jg,attr:Eg,attrTween:Fg,style:lm,styleTween:fm,text:gm,textTween:vm,remove:jg,tween:$g,delay:Ug,duration:Og,ease:Vg,easeVarying:Yg,end:_m,[Symbol.iterator]:vn[Symbol.iterator]};function _c(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var bm={time:null,delay:0,duration:250,ease:_c};function wm(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function Tm(t){var e,n;t instanceof zn?(e=t._id,t=t._name):(e=yc(),(n=bm).time=Ea(),t=t==null?null:t+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var a=r[o],s=a.length,h,c=0;c<s;++c)(h=a[c])&&ko(h,t,e,c,a,n||wm(h,e));return new zn(r,this._parents,t,e)}Nr.prototype.interrupt=bg;Nr.prototype.transition=Tm;const aa=Math.PI,sa=2*aa,Xn=1e-6,$m=sa-Xn;function xc(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function Cm(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return xc;const n=10**e;return function(r){this._+=r[0];for(let i=1,o=r.length;i<o;++i)this._+=Math.round(arguments[i]*n)/n+r[i]}}class km{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?xc:Cm(e)}moveTo(e,n){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,n){this._append`L${this._x1=+e},${this._y1=+n}`}quadraticCurveTo(e,n,r,i){this._append`Q${+e},${+n},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(e,n,r,i,o,a){this._append`C${+e},${+n},${+r},${+i},${this._x1=+o},${this._y1=+a}`}arcTo(e,n,r,i,o){if(e=+e,n=+n,r=+r,i=+i,o=+o,o<0)throw new Error(`negative radius: ${o}`);let a=this._x1,s=this._y1,h=r-e,c=i-n,l=a-e,f=s-n,u=l*l+f*f;if(this._x1===null)this._append`M${this._x1=e},${this._y1=n}`;else if(u>Xn)if(!(Math.abs(f*h-c*l)>Xn)||!o)this._append`L${this._x1=e},${this._y1=n}`;else{let g=r-a,m=i-s,v=h*h+c*c,_=g*g+m*m,p=Math.sqrt(v),$=Math.sqrt(u),k=o*Math.tan((aa-Math.acos((v+u-_)/(2*p*$)))/2),w=k/$,b=k/p;Math.abs(w-1)>Xn&&this._append`L${e+w*l},${n+w*f}`,this._append`A${o},${o},0,0,${+(f*g>l*m)},${this._x1=e+b*h},${this._y1=n+b*c}`}}arc(e,n,r,i,o,a){if(e=+e,n=+n,r=+r,a=!!a,r<0)throw new Error(`negative radius: ${r}`);let s=r*Math.cos(i),h=r*Math.sin(i),c=e+s,l=n+h,f=1^a,u=a?i-o:o-i;this._x1===null?this._append`M${c},${l}`:(Math.abs(this._x1-c)>Xn||Math.abs(this._y1-l)>Xn)&&this._append`L${c},${l}`,r&&(u<0&&(u=u%sa+sa),u>$m?this._append`A${r},${r},0,1,${f},${e-s},${n-h}A${r},${r},0,1,${f},${this._x1=c},${this._y1=l}`:u>Xn&&this._append`A${r},${r},0,${+(u>=aa)},${f},${this._x1=e+r*Math.cos(o)},${this._y1=n+r*Math.sin(o)}`)}rect(e,n,r,i){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}}function zm(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function to(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function Cr(t){return t=to(Math.abs(t)),t?t[1]:NaN}function Mm(t,e){return function(n,r){for(var i=n.length,o=[],a=0,s=t[0],h=0;i>0&&s>0&&(h+s+1>r&&(s=Math.max(1,r-h)),o.push(n.substring(i-=s,i+s)),!((h+=s+1)>r));)s=t[a=(a+1)%t.length];return o.reverse().join(e)}}function Am(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var Sm=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ci(t){if(!(e=Sm.exec(t)))throw new Error("invalid format: "+t);var e;return new La({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}ci.prototype=La.prototype;function La(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}La.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Em(t){t:for(var e=t.length,n=1,r=-1,i;n<e;++n)switch(t[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+t[n])break t;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(i+1):t}var bc;function Im(t,e){var n=to(t,e);if(!n)return t+"";var r=n[0],i=n[1],o=i-(bc=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+to(t,Math.max(0,e+o-1))[0]}function Cs(t,e){var n=to(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const ks={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:zm,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Cs(t*100,e),r:Cs,s:Im,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function zs(t){return t}var Ms=Array.prototype.map,As=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Nm(t){var e=t.grouping===void 0||t.thousands===void 0?zs:Mm(Ms.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",o=t.numerals===void 0?zs:Am(Ms.call(t.numerals,String)),a=t.percent===void 0?"%":t.percent+"",s=t.minus===void 0?"−":t.minus+"",h=t.nan===void 0?"NaN":t.nan+"";function c(f){f=ci(f);var u=f.fill,g=f.align,m=f.sign,v=f.symbol,_=f.zero,p=f.width,$=f.comma,k=f.precision,w=f.trim,b=f.type;b==="n"?($=!0,b="g"):ks[b]||(k===void 0&&(k=12),w=!0,b="g"),(_||u==="0"&&g==="=")&&(_=!0,u="0",g="=");var y=v==="$"?n:v==="#"&&/[boxX]/.test(b)?"0"+b.toLowerCase():"",S=v==="$"?r:/[%p]/.test(b)?a:"",L=ks[b],B=/[defgprs%]/.test(b);k=k===void 0?6:/[gprs]/.test(b)?Math.max(1,Math.min(21,k)):Math.max(0,Math.min(20,k));function T(E){var I=y,P=S,W,J,z;if(b==="c")P=L(E)+P,E="";else{E=+E;var R=E<0||1/E<0;if(E=isNaN(E)?h:L(Math.abs(E),k),w&&(E=Em(E)),R&&+E==0&&m!=="+"&&(R=!1),I=(R?m==="("?m:s:m==="-"||m==="("?"":m)+I,P=(b==="s"?As[8+bc/3]:"")+P+(R&&m==="("?")":""),B){for(W=-1,J=E.length;++W<J;)if(z=E.charCodeAt(W),48>z||z>57){P=(z===46?i+E.slice(W+1):E.slice(W))+P,E=E.slice(0,W);break}}}$&&!_&&(E=e(E,1/0));var V=I.length+E.length+P.length,st=V<p?new Array(p-V+1).join(u):"";switch($&&_&&(E=e(st+E,st.length?p-P.length:1/0),st=""),g){case"<":E=I+E+P+st;break;case"=":E=I+st+E+P;break;case"^":E=st.slice(0,V=st.length>>1)+I+E+P+st.slice(V);break;default:E=st+I+E+P;break}return o(E)}return T.toString=function(){return f+""},T}function l(f,u){var g=c((f=ci(f),f.type="f",f)),m=Math.max(-8,Math.min(8,Math.floor(Cr(u)/3)))*3,v=Math.pow(10,-m),_=As[8+m/3];return function(p){return g(v*p)+_}}return{format:c,formatPrefix:l}}var Ci,Da,wc;Lm({thousands:",",grouping:[3],currency:["$",""]});function Lm(t){return Ci=Nm(t),Da=Ci.format,wc=Ci.formatPrefix,Ci}function Dm(t){return Math.max(0,-Cr(Math.abs(t)))}function Fm(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Cr(e)/3)))*3-Cr(Math.abs(t)))}function Rm(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Cr(e)-Cr(t))+1}function Pm(t){var e=0,n=t.children,r=n&&n.length;if(!r)e=1;else for(;--r>=0;)e+=n[r].value;t.value=e}function Um(){return this.eachAfter(Pm)}function Hm(t,e){let n=-1;for(const r of this)t.call(e,r,++n,this);return this}function Bm(t,e){for(var n=this,r=[n],i,o,a=-1;n=r.pop();)if(t.call(e,n,++a,this),i=n.children)for(o=i.length-1;o>=0;--o)r.push(i[o]);return this}function Om(t,e){for(var n=this,r=[n],i=[],o,a,s,h=-1;n=r.pop();)if(i.push(n),o=n.children)for(a=0,s=o.length;a<s;++a)r.push(o[a]);for(;n=i.pop();)t.call(e,n,++h,this);return this}function Wm(t,e){let n=-1;for(const r of this)if(t.call(e,r,++n,this))return r}function Vm(t){return this.eachAfter(function(e){for(var n=+t(e.data)||0,r=e.children,i=r&&r.length;--i>=0;)n+=r[i].value;e.value=n})}function qm(t){return this.eachBefore(function(e){e.children&&e.children.sort(t)})}function Ym(t){for(var e=this,n=Gm(e,t),r=[e];e!==n;)e=e.parent,r.push(e);for(var i=r.length;t!==n;)r.splice(i,0,t),t=t.parent;return r}function Gm(t,e){if(t===e)return t;var n=t.ancestors(),r=e.ancestors(),i=null;for(t=n.pop(),e=r.pop();t===e;)i=t,t=n.pop(),e=r.pop();return i}function Km(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e}function Xm(){return Array.from(this)}function Zm(){var t=[];return this.eachBefore(function(e){e.children||t.push(e)}),t}function Jm(){var t=this,e=[];return t.each(function(n){n!==t&&e.push({source:n.parent,target:n})}),e}function*Qm(){var t=this,e,n=[t],r,i,o;do for(e=n.reverse(),n=[];t=e.pop();)if(yield t,r=t.children)for(i=0,o=r.length;i<o;++i)n.push(r[i]);while(n.length)}function un(t,e){t instanceof Map?(t=[void 0,t],e===void 0&&(e=ep)):e===void 0&&(e=tp);for(var n=new eo(t),r,i=[n],o,a,s,h;r=i.pop();)if((a=e(r.data))&&(h=(a=Array.from(a)).length))for(r.children=a,s=h-1;s>=0;--s)i.push(o=a[s]=new eo(a[s])),o.parent=r,o.depth=r.depth+1;return n.eachBefore(rp)}function jm(){return un(this).eachBefore(np)}function tp(t){return t.children}function ep(t){return Array.isArray(t)?t[1]:null}function np(t){t.data.value!==void 0&&(t.value=t.data.value),t.data=t.data.data}function rp(t){var e=0;do t.height=e;while((t=t.parent)&&t.height<++e)}function eo(t){this.data=t,this.depth=this.height=0,this.parent=null}eo.prototype=un.prototype={constructor:eo,count:Um,each:Hm,eachAfter:Om,eachBefore:Bm,find:Wm,sum:Vm,sort:qm,path:Ym,ancestors:Km,descendants:Xm,leaves:Zm,links:Jm,copy:jm,[Symbol.iterator]:Qm};function ip(t){if(typeof t!="function")throw new Error;return t}function Wr(){return 0}function Vr(t){return function(){return t}}function op(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)}function ap(t,e,n,r,i){for(var o=t.children,a,s=-1,h=o.length,c=t.value&&(r-e)/t.value;++s<h;)a=o[s],a.y0=n,a.y1=i,a.x0=e,a.x1=e+=a.value*c}function sp(t,e,n,r,i){for(var o=t.children,a,s=-1,h=o.length,c=t.value&&(i-n)/t.value;++s<h;)a=o[s],a.x0=e,a.x1=r,a.y0=n,a.y1=n+=a.value*c}var lp=(1+Math.sqrt(5))/2;function cp(t,e,n,r,i,o){for(var a=[],s=e.children,h,c,l=0,f=0,u=s.length,g,m,v=e.value,_,p,$,k,w,b,y;l<u;){g=i-n,m=o-r;do _=s[f++].value;while(!_&&f<u);for(p=$=_,b=Math.max(m/g,g/m)/(v*t),y=_*_*b,w=Math.max($/y,y/p);f<u;++f){if(_+=c=s[f].value,c<p&&(p=c),c>$&&($=c),y=_*_*b,k=Math.max($/y,y/p),k>w){_-=c;break}w=k}a.push(h={value:_,dice:g<m,children:s.slice(l,f)}),h.dice?ap(h,n,r,i,v?r+=m*_/v:o):sp(h,n,r,v?n+=g*_/v:i,o),v-=_,l=f}return a}const up=function t(e){function n(r,i,o,a,s){cp(e,r,i,o,a,s)}return n.ratio=function(r){return t((r=+r)>1?r:1)},n}(lp);function Tc(){var t=up,e=!1,n=1,r=1,i=[0],o=Wr,a=Wr,s=Wr,h=Wr,c=Wr;function l(u){return u.x0=u.y0=0,u.x1=n,u.y1=r,u.eachBefore(f),i=[0],e&&u.eachBefore(op),u}function f(u){var g=i[u.depth],m=u.x0+g,v=u.y0+g,_=u.x1-g,p=u.y1-g;_<m&&(m=_=(m+_)/2),p<v&&(v=p=(v+p)/2),u.x0=m,u.y0=v,u.x1=_,u.y1=p,u.children&&(g=i[u.depth+1]=o(u)/2,m+=c(u)-g,v+=a(u)-g,_-=s(u)-g,p-=h(u)-g,_<m&&(m=_=(m+_)/2),p<v&&(v=p=(v+p)/2),t(u,m,v,_,p))}return l.round=function(u){return arguments.length?(e=!!u,l):e},l.size=function(u){return arguments.length?(n=+u[0],r=+u[1],l):[n,r]},l.tile=function(u){return arguments.length?(t=ip(u),l):t},l.padding=function(u){return arguments.length?l.paddingInner(u).paddingOuter(u):l.paddingInner()},l.paddingInner=function(u){return arguments.length?(o=typeof u=="function"?u:Vr(+u),l):o},l.paddingOuter=function(u){return arguments.length?l.paddingTop(u).paddingRight(u).paddingBottom(u).paddingLeft(u):l.paddingTop()},l.paddingTop=function(u){return arguments.length?(a=typeof u=="function"?u:Vr(+u),l):a},l.paddingRight=function(u){return arguments.length?(s=typeof u=="function"?u:Vr(+u),l):s},l.paddingBottom=function(u){return arguments.length?(h=typeof u=="function"?u:Vr(+u),l):h},l.paddingLeft=function(u){return arguments.length?(c=typeof u=="function"?u:Vr(+u),l):c},l}function mi(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function fp(t,e){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof e=="function"?this.interpolator(e):this.range(e);break}}return this}const Ss=Symbol("implicit");function Ce(){var t=new vr,e=[],n=[],r=Ss;function i(o){let a=t.get(o);if(a===void 0){if(r!==Ss)return r;t.set(o,a=e.push(o)-1)}return n[a%n.length]}return i.domain=function(o){if(!arguments.length)return e.slice();e=[],t=new vr;for(const a of o)t.has(a)||t.set(a,e.push(a)-1);return i},i.range=function(o){return arguments.length?(n=Array.from(o),i):n.slice()},i.unknown=function(o){return arguments.length?(r=o,i):r},i.copy=function(){return Ce(e,n).unknown(r)},mi.apply(i,arguments),i}function Fa(){var t=Ce().unknown(void 0),e=t.domain,n=t.range,r=0,i=1,o,a,s=!1,h=0,c=0,l=.5;delete t.unknown;function f(){var u=e().length,g=i<r,m=g?i:r,v=g?r:i;o=(v-m)/Math.max(1,u-h+c*2),s&&(o=Math.floor(o)),m+=(v-m-o*(u-h))*l,a=o*(1-h),s&&(m=Math.round(m),a=Math.round(a));var _=Gf(u).map(function(p){return m+o*p});return n(g?_.reverse():_)}return t.domain=function(u){return arguments.length?(e(u),f()):e()},t.range=function(u){return arguments.length?([r,i]=u,r=+r,i=+i,f()):[r,i]},t.rangeRound=function(u){return[r,i]=u,r=+r,i=+i,s=!0,f()},t.bandwidth=function(){return a},t.step=function(){return o},t.round=function(u){return arguments.length?(s=!!u,f()):s},t.padding=function(u){return arguments.length?(h=Math.min(1,c=+u),f()):h},t.paddingInner=function(u){return arguments.length?(h=Math.min(1,u),f()):h},t.paddingOuter=function(u){return arguments.length?(c=+u,f()):c},t.align=function(u){return arguments.length?(l=Math.max(0,Math.min(1,u)),f()):l},t.copy=function(){return Fa(e(),[r,i]).round(s).paddingInner(h).paddingOuter(c).align(l)},mi.apply(f(),arguments)}function dp(t){return function(){return t}}function hp(t){return+t}var Es=[0,1];function Pn(t){return t}function la(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:dp(isNaN(e)?NaN:.5)}function gp(t,e){var n;return t>e&&(n=t,t=e,e=n),function(r){return Math.max(t,Math.min(e,r))}}function mp(t,e,n){var r=t[0],i=t[1],o=e[0],a=e[1];return i<r?(r=la(i,r),o=n(a,o)):(r=la(r,i),o=n(o,a)),function(s){return o(r(s))}}function pp(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),o=new Array(r),a=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<r;)i[a]=la(t[a],t[a+1]),o[a]=n(e[a],e[a+1]);return function(s){var h=Uf(t,s,1,r)-1;return o[h](i[h](s))}}function Ra(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function $c(){var t=Es,e=Es,n=Tr,r,i,o,a=Pn,s,h,c;function l(){var u=Math.min(t.length,e.length);return a!==Pn&&(a=gp(t[0],t[u-1])),s=u>2?pp:mp,h=c=null,f}function f(u){return u==null||isNaN(u=+u)?o:(h||(h=s(t.map(r),e,n)))(r(a(u)))}return f.invert=function(u){return a(i((c||(c=s(e,t.map(r),en)))(u)))},f.domain=function(u){return arguments.length?(t=Array.from(u,hp),l()):t.slice()},f.range=function(u){return arguments.length?(e=Array.from(u),l()):e.slice()},f.rangeRound=function(u){return e=Array.from(u),n=lc,l()},f.clamp=function(u){return arguments.length?(a=u?!0:Pn,l()):a!==Pn},f.interpolate=function(u){return arguments.length?(n=u,l()):n},f.unknown=function(u){return arguments.length?(o=u,f):o},function(u,g){return r=u,i=g,l()}}function Cc(){return $c()(Pn,Pn)}function vp(t,e,n,r){var i=Qo(t,e,n),o;switch(r=ci(r??",f"),r.type){case"s":{var a=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(o=Fm(i,a))&&(r.precision=o),wc(r,a)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(o=Rm(i,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=o-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(o=Dm(i))&&(r.precision=o-(r.type==="%")*2);break}}return Da(r)}function kc(t){var e=t.domain;return t.ticks=function(n){var r=e();return Zo(r[0],r[r.length-1],n??10)},t.tickFormat=function(n,r){var i=e();return vp(i[0],i[i.length-1],n??10,r)},t.nice=function(n){n==null&&(n=10);var r=e(),i=0,o=r.length-1,a=r[i],s=r[o],h,c,l=10;for(s<a&&(c=a,a=s,s=c,c=i,i=o,o=c);l-- >0;){if(c=Jo(a,s,n),c===h)return r[i]=a,r[o]=s,e(r);if(c>0)a=Math.floor(a/c)*c,s=Math.ceil(s/c)*c;else if(c<0)a=Math.ceil(a*c)/c,s=Math.floor(s*c)/c;else break;h=c}return t},t}function ui(){var t=Cc();return t.copy=function(){return Ra(t,ui())},mi.apply(t,arguments),kc(t)}function zc(t,e){t=t.slice();var n=0,r=t.length-1,i=t[n],o=t[r],a;return o<i&&(a=n,n=r,r=a,a=i,i=o,o=a),t[n]=e.floor(i),t[r]=e.ceil(o),t}function Is(t){return Math.log(t)}function Ns(t){return Math.exp(t)}function yp(t){return-Math.log(-t)}function _p(t){return-Math.exp(-t)}function xp(t){return isFinite(t)?+("1e"+t):t<0?0:t}function bp(t){return t===10?xp:t===Math.E?Math.exp:e=>Math.pow(t,e)}function wp(t){return t===Math.E?Math.log:t===10&&Math.log10||t===2&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}function Ls(t){return(e,n)=>-t(-e,n)}function Tp(t){const e=t(Is,Ns),n=e.domain;let r=10,i,o;function a(){return i=wp(r),o=bp(r),n()[0]<0?(i=Ls(i),o=Ls(o),t(yp,_p)):t(Is,Ns),e}return e.base=function(s){return arguments.length?(r=+s,a()):r},e.domain=function(s){return arguments.length?(n(s),a()):n()},e.ticks=s=>{const h=n();let c=h[0],l=h[h.length-1];const f=l<c;f&&([c,l]=[l,c]);let u=i(c),g=i(l),m,v;const _=s==null?10:+s;let p=[];if(!(r%1)&&g-u<_){if(u=Math.floor(u),g=Math.ceil(g),c>0){for(;u<=g;++u)for(m=1;m<r;++m)if(v=u<0?m/o(-u):m*o(u),!(v<c)){if(v>l)break;p.push(v)}}else for(;u<=g;++u)for(m=r-1;m>=1;--m)if(v=u>0?m/o(-u):m*o(u),!(v<c)){if(v>l)break;p.push(v)}p.length*2<_&&(p=Zo(c,l,_))}else p=Zo(u,g,Math.min(g-u,_)).map(o);return f?p.reverse():p},e.tickFormat=(s,h)=>{if(s==null&&(s=10),h==null&&(h=r===10?"s":","),typeof h!="function"&&(!(r%1)&&(h=ci(h)).precision==null&&(h.trim=!0),h=Da(h)),s===1/0)return h;const c=Math.max(1,r*s/e.ticks().length);return l=>{let f=l/o(Math.round(i(l)));return f*r<r-.5&&(f*=r),f<=c?h(l):""}},e.nice=()=>n(zc(n(),{floor:s=>o(Math.floor(i(s))),ceil:s=>o(Math.ceil(i(s)))})),e}function Mc(){const t=Tp($c()).domain([1,10]);return t.copy=()=>Ra(t,Mc()).base(t.base()),mi.apply(t,arguments),t}const Io=new Date,No=new Date;function de(t,e,n,r){function i(o){return t(o=arguments.length===0?new Date:new Date(+o)),o}return i.floor=o=>(t(o=new Date(+o)),o),i.ceil=o=>(t(o=new Date(o-1)),e(o,1),t(o),o),i.round=o=>{const a=i(o),s=i.ceil(o);return o-a<s-o?a:s},i.offset=(o,a)=>(e(o=new Date(+o),a==null?1:Math.floor(a)),o),i.range=(o,a,s)=>{const h=[];if(o=i.ceil(o),s=s==null?1:Math.floor(s),!(o<a)||!(s>0))return h;let c;do h.push(c=new Date(+o)),e(o,s),t(o);while(c<o&&o<a);return h},i.filter=o=>de(a=>{if(a>=a)for(;t(a),!o(a);)a.setTime(a-1)},(a,s)=>{if(a>=a)if(s<0)for(;++s<=0;)for(;e(a,-1),!o(a););else for(;--s>=0;)for(;e(a,1),!o(a););}),n&&(i.count=(o,a)=>(Io.setTime(+o),No.setTime(+a),t(Io),t(No),Math.floor(n(Io,No))),i.every=o=>(o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?i.filter(r?a=>r(a)%o===0:a=>i.count(0,a)%o===0):i)),i}const no=de(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);no.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?de(e=>{e.setTime(Math.floor(e/t)*t)},(e,n)=>{e.setTime(+e+n*t)},(e,n)=>(n-e)/t):no);no.range;const xn=1e3,Xe=xn*60,bn=Xe*60,Mn=bn*24,Pa=Mn*7,Ds=Mn*30,Lo=Mn*365,fr=de(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*xn)},(t,e)=>(e-t)/xn,t=>t.getUTCSeconds());fr.range;const Ua=de(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*xn)},(t,e)=>{t.setTime(+t+e*Xe)},(t,e)=>(e-t)/Xe,t=>t.getMinutes());Ua.range;const $p=de(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*Xe)},(t,e)=>(e-t)/Xe,t=>t.getUTCMinutes());$p.range;const Ha=de(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*xn-t.getMinutes()*Xe)},(t,e)=>{t.setTime(+t+e*bn)},(t,e)=>(e-t)/bn,t=>t.getHours());Ha.range;const Cp=de(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*bn)},(t,e)=>(e-t)/bn,t=>t.getUTCHours());Cp.range;const pi=de(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Xe)/Mn,t=>t.getDate()-1);pi.range;const Ba=de(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/Mn,t=>t.getUTCDate()-1);Ba.range;const kp=de(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/Mn,t=>Math.floor(t/Mn));kp.range;function or(t){return de(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,n)=>{e.setDate(e.getDate()+n*7)},(e,n)=>(n-e-(n.getTimezoneOffset()-e.getTimezoneOffset())*Xe)/Pa)}const zo=or(0),ro=or(1),zp=or(2),Mp=or(3),kr=or(4),Ap=or(5),Sp=or(6);zo.range;ro.range;zp.range;Mp.range;kr.range;Ap.range;Sp.range;function ar(t){return de(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCDate(e.getUTCDate()+n*7)},(e,n)=>(n-e)/Pa)}const Ac=ar(0),io=ar(1),Ep=ar(2),Ip=ar(3),zr=ar(4),Np=ar(5),Lp=ar(6);Ac.range;io.range;Ep.range;Ip.range;zr.range;Np.range;Lp.range;const Oa=de(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12,t=>t.getMonth());Oa.range;const Dp=de(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());Dp.range;const An=de(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());An.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:de(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,n)=>{e.setFullYear(e.getFullYear()+n*t)});An.range;const rr=de(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());rr.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:de(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCFullYear(e.getUTCFullYear()+n*t)});rr.range;function Fp(t,e,n,r,i,o){const a=[[fr,1,xn],[fr,5,5*xn],[fr,15,15*xn],[fr,30,30*xn],[o,1,Xe],[o,5,5*Xe],[o,15,15*Xe],[o,30,30*Xe],[i,1,bn],[i,3,3*bn],[i,6,6*bn],[i,12,12*bn],[r,1,Mn],[r,2,2*Mn],[n,1,Pa],[e,1,Ds],[e,3,3*Ds],[t,1,Lo]];function s(c,l,f){const u=l<c;u&&([c,l]=[l,c]);const g=f&&typeof f.range=="function"?f:h(c,l,f),m=g?g.range(c,+l+1):[];return u?m.reverse():m}function h(c,l,f){const u=Math.abs(l-c)/f,g=Ca(([,,_])=>_).right(a,u);if(g===a.length)return t.every(Qo(c/Lo,l/Lo,f));if(g===0)return no.every(Math.max(Qo(c,l,f),1));const[m,v]=a[u/a[g-1][2]<a[g][2]/u?g-1:g];return m.every(v)}return[s,h]}const[Rp,Pp]=Fp(An,Oa,zo,pi,Ha,Ua);function Do(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Fo(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function qr(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function Up(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,o=t.days,a=t.shortDays,s=t.months,h=t.shortMonths,c=Yr(i),l=Gr(i),f=Yr(o),u=Gr(o),g=Yr(a),m=Gr(a),v=Yr(s),_=Gr(s),p=Yr(h),$=Gr(h),k={a:R,A:V,b:st,B:O,c:null,d:Bs,e:Bs,f:lv,g:yv,G:xv,H:ov,I:av,j:sv,L:Sc,m:cv,M:uv,p:U,q:Q,Q:Vs,s:qs,S:fv,u:dv,U:hv,V:gv,w:mv,W:pv,x:null,X:null,y:vv,Y:_v,Z:bv,"%":Ws},w={a:G,A:q,b:X,B:lt,c:null,d:Os,e:Os,f:Cv,g:Dv,G:Rv,H:wv,I:Tv,j:$v,L:Ic,m:kv,M:zv,p:rt,q:K,Q:Vs,s:qs,S:Mv,u:Av,U:Sv,V:Ev,w:Iv,W:Nv,x:null,X:null,y:Lv,Y:Fv,Z:Pv,"%":Ws},b={a:T,A:E,b:I,B:P,c:W,d:Us,e:Us,f:ev,g:Ps,G:Rs,H:Hs,I:Hs,j:Jp,L:tv,m:Zp,M:Qp,p:B,q:Xp,Q:rv,s:iv,S:jp,u:Vp,U:qp,V:Yp,w:Wp,W:Gp,x:J,X:z,y:Ps,Y:Rs,Z:Kp,"%":nv};k.x=y(n,k),k.X=y(r,k),k.c=y(e,k),w.x=y(n,w),w.X=y(r,w),w.c=y(e,w);function y(C,F){return function(M){var x=[],A=-1,H=0,j=C.length,dt,ot,Z;for(M instanceof Date||(M=new Date(+M));++A<j;)C.charCodeAt(A)===37&&(x.push(C.slice(H,A)),(ot=Fs[dt=C.charAt(++A)])!=null?dt=C.charAt(++A):ot=dt==="e"?" ":"0",(Z=F[dt])&&(dt=Z(M,ot)),x.push(dt),H=A+1);return x.push(C.slice(H,A)),x.join("")}}function S(C,F){return function(M){var x=qr(1900,void 0,1),A=L(x,C,M+="",0),H,j;if(A!=M.length)return null;if("Q"in x)return new Date(x.Q);if("s"in x)return new Date(x.s*1e3+("L"in x?x.L:0));if(F&&!("Z"in x)&&(x.Z=0),"p"in x&&(x.H=x.H%12+x.p*12),x.m===void 0&&(x.m="q"in x?x.q:0),"V"in x){if(x.V<1||x.V>53)return null;"w"in x||(x.w=1),"Z"in x?(H=Fo(qr(x.y,0,1)),j=H.getUTCDay(),H=j>4||j===0?io.ceil(H):io(H),H=Ba.offset(H,(x.V-1)*7),x.y=H.getUTCFullYear(),x.m=H.getUTCMonth(),x.d=H.getUTCDate()+(x.w+6)%7):(H=Do(qr(x.y,0,1)),j=H.getDay(),H=j>4||j===0?ro.ceil(H):ro(H),H=pi.offset(H,(x.V-1)*7),x.y=H.getFullYear(),x.m=H.getMonth(),x.d=H.getDate()+(x.w+6)%7)}else("W"in x||"U"in x)&&("w"in x||(x.w="u"in x?x.u%7:"W"in x?1:0),j="Z"in x?Fo(qr(x.y,0,1)).getUTCDay():Do(qr(x.y,0,1)).getDay(),x.m=0,x.d="W"in x?(x.w+6)%7+x.W*7-(j+5)%7:x.w+x.U*7-(j+6)%7);return"Z"in x?(x.H+=x.Z/100|0,x.M+=x.Z%100,Fo(x)):Do(x)}}function L(C,F,M,x){for(var A=0,H=F.length,j=M.length,dt,ot;A<H;){if(x>=j)return-1;if(dt=F.charCodeAt(A++),dt===37){if(dt=F.charAt(A++),ot=b[dt in Fs?F.charAt(A++):dt],!ot||(x=ot(C,M,x))<0)return-1}else if(dt!=M.charCodeAt(x++))return-1}return x}function B(C,F,M){var x=c.exec(F.slice(M));return x?(C.p=l.get(x[0].toLowerCase()),M+x[0].length):-1}function T(C,F,M){var x=g.exec(F.slice(M));return x?(C.w=m.get(x[0].toLowerCase()),M+x[0].length):-1}function E(C,F,M){var x=f.exec(F.slice(M));return x?(C.w=u.get(x[0].toLowerCase()),M+x[0].length):-1}function I(C,F,M){var x=p.exec(F.slice(M));return x?(C.m=$.get(x[0].toLowerCase()),M+x[0].length):-1}function P(C,F,M){var x=v.exec(F.slice(M));return x?(C.m=_.get(x[0].toLowerCase()),M+x[0].length):-1}function W(C,F,M){return L(C,e,F,M)}function J(C,F,M){return L(C,n,F,M)}function z(C,F,M){return L(C,r,F,M)}function R(C){return a[C.getDay()]}function V(C){return o[C.getDay()]}function st(C){return h[C.getMonth()]}function O(C){return s[C.getMonth()]}function U(C){return i[+(C.getHours()>=12)]}function Q(C){return 1+~~(C.getMonth()/3)}function G(C){return a[C.getUTCDay()]}function q(C){return o[C.getUTCDay()]}function X(C){return h[C.getUTCMonth()]}function lt(C){return s[C.getUTCMonth()]}function rt(C){return i[+(C.getUTCHours()>=12)]}function K(C){return 1+~~(C.getUTCMonth()/3)}return{format:function(C){var F=y(C+="",k);return F.toString=function(){return C},F},parse:function(C){var F=S(C+="",!1);return F.toString=function(){return C},F},utcFormat:function(C){var F=y(C+="",w);return F.toString=function(){return C},F},utcParse:function(C){var F=S(C+="",!0);return F.toString=function(){return C},F}}}var Fs={"-":"",_:" ",0:"0"},me=/^\s*\d+/,Hp=/^%/,Bp=/[\\^$*+?|[\]().{}]/g;function Xt(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(e)+i:i)}function Op(t){return t.replace(Bp,"\\$&")}function Yr(t){return new RegExp("^(?:"+t.map(Op).join("|")+")","i")}function Gr(t){return new Map(t.map((e,n)=>[e.toLowerCase(),n]))}function Wp(t,e,n){var r=me.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function Vp(t,e,n){var r=me.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function qp(t,e,n){var r=me.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function Yp(t,e,n){var r=me.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function Gp(t,e,n){var r=me.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function Rs(t,e,n){var r=me.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function Ps(t,e,n){var r=me.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function Kp(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Xp(t,e,n){var r=me.exec(e.slice(n,n+1));return r?(t.q=r[0]*3-3,n+r[0].length):-1}function Zp(t,e,n){var r=me.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function Us(t,e,n){var r=me.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function Jp(t,e,n){var r=me.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function Hs(t,e,n){var r=me.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function Qp(t,e,n){var r=me.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function jp(t,e,n){var r=me.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function tv(t,e,n){var r=me.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function ev(t,e,n){var r=me.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function nv(t,e,n){var r=Hp.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function rv(t,e,n){var r=me.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function iv(t,e,n){var r=me.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function Bs(t,e){return Xt(t.getDate(),e,2)}function ov(t,e){return Xt(t.getHours(),e,2)}function av(t,e){return Xt(t.getHours()%12||12,e,2)}function sv(t,e){return Xt(1+pi.count(An(t),t),e,3)}function Sc(t,e){return Xt(t.getMilliseconds(),e,3)}function lv(t,e){return Sc(t,e)+"000"}function cv(t,e){return Xt(t.getMonth()+1,e,2)}function uv(t,e){return Xt(t.getMinutes(),e,2)}function fv(t,e){return Xt(t.getSeconds(),e,2)}function dv(t){var e=t.getDay();return e===0?7:e}function hv(t,e){return Xt(zo.count(An(t)-1,t),e,2)}function Ec(t){var e=t.getDay();return e>=4||e===0?kr(t):kr.ceil(t)}function gv(t,e){return t=Ec(t),Xt(kr.count(An(t),t)+(An(t).getDay()===4),e,2)}function mv(t){return t.getDay()}function pv(t,e){return Xt(ro.count(An(t)-1,t),e,2)}function vv(t,e){return Xt(t.getFullYear()%100,e,2)}function yv(t,e){return t=Ec(t),Xt(t.getFullYear()%100,e,2)}function _v(t,e){return Xt(t.getFullYear()%1e4,e,4)}function xv(t,e){var n=t.getDay();return t=n>=4||n===0?kr(t):kr.ceil(t),Xt(t.getFullYear()%1e4,e,4)}function bv(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Xt(e/60|0,"0",2)+Xt(e%60,"0",2)}function Os(t,e){return Xt(t.getUTCDate(),e,2)}function wv(t,e){return Xt(t.getUTCHours(),e,2)}function Tv(t,e){return Xt(t.getUTCHours()%12||12,e,2)}function $v(t,e){return Xt(1+Ba.count(rr(t),t),e,3)}function Ic(t,e){return Xt(t.getUTCMilliseconds(),e,3)}function Cv(t,e){return Ic(t,e)+"000"}function kv(t,e){return Xt(t.getUTCMonth()+1,e,2)}function zv(t,e){return Xt(t.getUTCMinutes(),e,2)}function Mv(t,e){return Xt(t.getUTCSeconds(),e,2)}function Av(t){var e=t.getUTCDay();return e===0?7:e}function Sv(t,e){return Xt(Ac.count(rr(t)-1,t),e,2)}function Nc(t){var e=t.getUTCDay();return e>=4||e===0?zr(t):zr.ceil(t)}function Ev(t,e){return t=Nc(t),Xt(zr.count(rr(t),t)+(rr(t).getUTCDay()===4),e,2)}function Iv(t){return t.getUTCDay()}function Nv(t,e){return Xt(io.count(rr(t)-1,t),e,2)}function Lv(t,e){return Xt(t.getUTCFullYear()%100,e,2)}function Dv(t,e){return t=Nc(t),Xt(t.getUTCFullYear()%100,e,2)}function Fv(t,e){return Xt(t.getUTCFullYear()%1e4,e,4)}function Rv(t,e){var n=t.getUTCDay();return t=n>=4||n===0?zr(t):zr.ceil(t),Xt(t.getUTCFullYear()%1e4,e,4)}function Pv(){return"+0000"}function Ws(){return"%"}function Vs(t){return+t}function qs(t){return Math.floor(+t/1e3)}var cr,Un;Uv({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Uv(t){return cr=Up(t),Un=cr.format,cr.parse,cr.utcFormat,cr.utcParse,cr}function Hv(t){return new Date(t)}function Bv(t){return t instanceof Date?+t:+new Date(+t)}function Lc(t,e,n,r,i,o,a,s,h,c){var l=Cc(),f=l.invert,u=l.domain,g=c(".%L"),m=c(":%S"),v=c("%I:%M"),_=c("%I %p"),p=c("%a %d"),$=c("%b %d"),k=c("%B"),w=c("%Y");function b(y){return(h(y)<y?g:s(y)<y?m:a(y)<y?v:o(y)<y?_:r(y)<y?i(y)<y?p:$:n(y)<y?k:w)(y)}return l.invert=function(y){return new Date(f(y))},l.domain=function(y){return arguments.length?u(Array.from(y,Bv)):u().map(Hv)},l.ticks=function(y){var S=u();return t(S[0],S[S.length-1],y??10)},l.tickFormat=function(y,S){return S==null?b:c(S)},l.nice=function(y){var S=u();return(!y||typeof y.range!="function")&&(y=e(S[0],S[S.length-1],y??10)),y?u(zc(S,y)):l},l.copy=function(){return Ra(l,Lc(t,e,n,r,i,o,a,s,h,c))},l}function Dc(){return mi.apply(Lc(Rp,Pp,An,Oa,zo,pi,Ha,Ua,fr,Un).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Ov(){var t=0,e=1,n,r,i,o,a=Pn,s=!1,h;function c(f){return f==null||isNaN(f=+f)?h:a(i===0?.5:(f=(o(f)-n)*i,s?Math.max(0,Math.min(1,f)):f))}c.domain=function(f){return arguments.length?([t,e]=f,n=o(t=+t),r=o(e=+e),i=n===r?0:1/(r-n),c):[t,e]},c.clamp=function(f){return arguments.length?(s=!!f,c):s},c.interpolator=function(f){return arguments.length?(a=f,c):a};function l(f){return function(u){var g,m;return arguments.length?([g,m]=u,a=f(g,m),c):[a(0),a(1)]}}return c.range=l(Tr),c.rangeRound=l(lc),c.unknown=function(f){return arguments.length?(h=f,c):h},function(f){return o=f,n=f(t),r=f(e),i=n===r?0:1/(r-n),c}}function Wv(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function ca(){var t=kc(Ov()(Pn));return t.copy=function(){return Wv(t,ca())},fp.apply(t,arguments)}function Mo(t){for(var e=t.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+t.slice(r*6,++r*6);return n}const on=Mo("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),Vv=Mo("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),Fc=t=>eg(t[t.length-1]);var qv=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(Mo);const Yv=Fc(qv);var Gv=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(Mo);const Kv=Fc(Gv);function ie(t){return function(){return t}}const Ys=Math.abs,xe=Math.atan2,Kn=Math.cos,Xv=Math.max,Ro=Math.min,ln=Math.sin,dr=Math.sqrt,De=1e-12,fi=Math.PI,oo=fi/2,Di=2*fi;function Zv(t){return t>1?0:t<-1?fi:Math.acos(t)}function Gs(t){return t>=1?oo:t<=-1?-oo:Math.asin(t)}function Rc(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(n==null)e=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);e=r}return t},()=>new km(e)}function Jv(t){return t.innerRadius}function Qv(t){return t.outerRadius}function jv(t){return t.startAngle}function t0(t){return t.endAngle}function e0(t){return t&&t.padAngle}function n0(t,e,n,r,i,o,a,s){var h=n-t,c=r-e,l=a-i,f=s-o,u=f*h-l*c;if(!(u*u<De))return u=(l*(e-o)-f*(t-i))/u,[t+u*h,e+u*c]}function ki(t,e,n,r,i,o,a){var s=t-n,h=e-r,c=(a?o:-o)/dr(s*s+h*h),l=c*h,f=-c*s,u=t+l,g=e+f,m=n+l,v=r+f,_=(u+m)/2,p=(g+v)/2,$=m-u,k=v-g,w=$*$+k*k,b=i-o,y=u*v-m*g,S=(k<0?-1:1)*dr(Xv(0,b*b*w-y*y)),L=(y*k-$*S)/w,B=(-y*$-k*S)/w,T=(y*k+$*S)/w,E=(-y*$+k*S)/w,I=L-_,P=B-p,W=T-_,J=E-p;return I*I+P*P>W*W+J*J&&(L=T,B=E),{cx:L,cy:B,x01:-l,y01:-f,x11:L*(i/b-1),y11:B*(i/b-1)}}function Po(){var t=Jv,e=Qv,n=ie(0),r=null,i=jv,o=t0,a=e0,s=null,h=Rc(c);function c(){var l,f,u=+t.apply(this,arguments),g=+e.apply(this,arguments),m=i.apply(this,arguments)-oo,v=o.apply(this,arguments)-oo,_=Ys(v-m),p=v>m;if(s||(s=l=h()),g<u&&(f=g,g=u,u=f),!(g>De))s.moveTo(0,0);else if(_>Di-De)s.moveTo(g*Kn(m),g*ln(m)),s.arc(0,0,g,m,v,!p),u>De&&(s.moveTo(u*Kn(v),u*ln(v)),s.arc(0,0,u,v,m,p));else{var $=m,k=v,w=m,b=v,y=_,S=_,L=a.apply(this,arguments)/2,B=L>De&&(r?+r.apply(this,arguments):dr(u*u+g*g)),T=Ro(Ys(g-u)/2,+n.apply(this,arguments)),E=T,I=T,P,W;if(B>De){var J=Gs(B/u*ln(L)),z=Gs(B/g*ln(L));(y-=J*2)>De?(J*=p?1:-1,w+=J,b-=J):(y=0,w=b=(m+v)/2),(S-=z*2)>De?(z*=p?1:-1,$+=z,k-=z):(S=0,$=k=(m+v)/2)}var R=g*Kn($),V=g*ln($),st=u*Kn(b),O=u*ln(b);if(T>De){var U=g*Kn(k),Q=g*ln(k),G=u*Kn(w),q=u*ln(w),X;if(_<fi)if(X=n0(R,V,G,q,U,Q,st,O)){var lt=R-X[0],rt=V-X[1],K=U-X[0],C=Q-X[1],F=1/ln(Zv((lt*K+rt*C)/(dr(lt*lt+rt*rt)*dr(K*K+C*C)))/2),M=dr(X[0]*X[0]+X[1]*X[1]);E=Ro(T,(u-M)/(F-1)),I=Ro(T,(g-M)/(F+1))}else E=I=0}S>De?I>De?(P=ki(G,q,R,V,g,I,p),W=ki(U,Q,st,O,g,I,p),s.moveTo(P.cx+P.x01,P.cy+P.y01),I<T?s.arc(P.cx,P.cy,I,xe(P.y01,P.x01),xe(W.y01,W.x01),!p):(s.arc(P.cx,P.cy,I,xe(P.y01,P.x01),xe(P.y11,P.x11),!p),s.arc(0,0,g,xe(P.cy+P.y11,P.cx+P.x11),xe(W.cy+W.y11,W.cx+W.x11),!p),s.arc(W.cx,W.cy,I,xe(W.y11,W.x11),xe(W.y01,W.x01),!p))):(s.moveTo(R,V),s.arc(0,0,g,$,k,!p)):s.moveTo(R,V),!(u>De)||!(y>De)?s.lineTo(st,O):E>De?(P=ki(st,O,U,Q,u,-E,p),W=ki(R,V,G,q,u,-E,p),s.lineTo(P.cx+P.x01,P.cy+P.y01),E<T?s.arc(P.cx,P.cy,E,xe(P.y01,P.x01),xe(W.y01,W.x01),!p):(s.arc(P.cx,P.cy,E,xe(P.y01,P.x01),xe(P.y11,P.x11),!p),s.arc(0,0,u,xe(P.cy+P.y11,P.cx+P.x11),xe(W.cy+W.y11,W.cx+W.x11),p),s.arc(W.cx,W.cy,E,xe(W.y11,W.x11),xe(W.y01,W.x01),!p))):s.arc(0,0,u,b,w,p)}if(s.closePath(),l)return s=null,l+""||null}return c.centroid=function(){var l=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,f=(+i.apply(this,arguments)+ +o.apply(this,arguments))/2-fi/2;return[Kn(f)*l,ln(f)*l]},c.innerRadius=function(l){return arguments.length?(t=typeof l=="function"?l:ie(+l),c):t},c.outerRadius=function(l){return arguments.length?(e=typeof l=="function"?l:ie(+l),c):e},c.cornerRadius=function(l){return arguments.length?(n=typeof l=="function"?l:ie(+l),c):n},c.padRadius=function(l){return arguments.length?(r=l==null?null:typeof l=="function"?l:ie(+l),c):r},c.startAngle=function(l){return arguments.length?(i=typeof l=="function"?l:ie(+l),c):i},c.endAngle=function(l){return arguments.length?(o=typeof l=="function"?l:ie(+l),c):o},c.padAngle=function(l){return arguments.length?(a=typeof l=="function"?l:ie(+l),c):a},c.context=function(l){return arguments.length?(s=l??null,c):s},c}function Wa(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Pc(t){this._context=t}Pc.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function r0(t){return new Pc(t)}function i0(t){return t[0]}function o0(t){return t[1]}function Ks(t,e){var n=ie(!0),r=null,i=r0,o=null,a=Rc(s);t=typeof t=="function"?t:t===void 0?i0:ie(t),e=typeof e=="function"?e:e===void 0?o0:ie(e);function s(h){var c,l=(h=Wa(h)).length,f,u=!1,g;for(r==null&&(o=i(g=a())),c=0;c<=l;++c)!(c<l&&n(f=h[c],c,h))===u&&((u=!u)?o.lineStart():o.lineEnd()),u&&o.point(+t(f,c,h),+e(f,c,h));if(g)return o=null,g+""||null}return s.x=function(h){return arguments.length?(t=typeof h=="function"?h:ie(+h),s):t},s.y=function(h){return arguments.length?(e=typeof h=="function"?h:ie(+h),s):e},s.defined=function(h){return arguments.length?(n=typeof h=="function"?h:ie(!!h),s):n},s.curve=function(h){return arguments.length?(i=h,r!=null&&(o=i(r)),s):i},s.context=function(h){return arguments.length?(h==null?r=o=null:o=i(r=h),s):r},s}function a0(t,e){return e<t?-1:e>t?1:e>=t?0:NaN}function s0(t){return t}function l0(){var t=s0,e=a0,n=null,r=ie(0),i=ie(Di),o=ie(0);function a(s){var h,c=(s=Wa(s)).length,l,f,u=0,g=new Array(c),m=new Array(c),v=+r.apply(this,arguments),_=Math.min(Di,Math.max(-Di,i.apply(this,arguments)-v)),p,$=Math.min(Math.abs(_)/c,o.apply(this,arguments)),k=$*(_<0?-1:1),w;for(h=0;h<c;++h)(w=m[g[h]=h]=+t(s[h],h,s))>0&&(u+=w);for(e!=null?g.sort(function(b,y){return e(m[b],m[y])}):n!=null&&g.sort(function(b,y){return n(s[b],s[y])}),h=0,f=u?(_-c*k)/u:0;h<c;++h,v=p)l=g[h],w=m[l],p=v+(w>0?w*f:0)+k,m[l]={data:s[l],index:h,value:w,startAngle:v,endAngle:p,padAngle:$};return m}return a.value=function(s){return arguments.length?(t=typeof s=="function"?s:ie(+s),a):t},a.sortValues=function(s){return arguments.length?(e=s,n=null,a):e},a.sort=function(s){return arguments.length?(n=s,e=null,a):n},a.startAngle=function(s){return arguments.length?(r=typeof s=="function"?s:ie(+s),a):r},a.endAngle=function(s){return arguments.length?(i=typeof s=="function"?s:ie(+s),a):i},a.padAngle=function(s){return arguments.length?(o=typeof s=="function"?s:ie(+s),a):o},a}function Xs(t){return t<0?-1:1}function Zs(t,e,n){var r=t._x1-t._x0,i=e-t._x1,o=(t._y1-t._y0)/(r||i<0&&-0),a=(n-t._y1)/(i||r<0&&-0),s=(o*i+a*r)/(r+i);return(Xs(o)+Xs(a))*Math.min(Math.abs(o),Math.abs(a),.5*Math.abs(s))||0}function Js(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function Uo(t,e,n){var r=t._x0,i=t._y0,o=t._x1,a=t._y1,s=(o-r)/3;t._context.bezierCurveTo(r+s,i+s*e,o-s,a-s*n,o,a)}function ao(t){this._context=t}ao.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Uo(this,this._t0,Js(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,Uo(this,Js(this,n=Zs(this,t,e)),n);break;default:Uo(this,this._t0,n=Zs(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}};Object.create(ao.prototype).point=function(t,e){ao.prototype.point.call(this,e,t)};function Qs(t){return new ao(t)}function js(t,e){if((a=t.length)>1)for(var n=1,r,i,o=t[e[0]],a,s=o.length;n<a;++n)for(i=o,o=t[e[n]],r=0;r<s;++r)o[r][1]+=o[r][0]=isNaN(i[r][1])?i[r][0]:i[r][1]}function tl(t){for(var e=t.length,n=new Array(e);--e>=0;)n[e]=e;return n}function c0(t,e){return t[e]}function u0(t){const e=[];return e.key=t,e}function f0(){var t=ie([]),e=tl,n=js,r=c0;function i(o){var a=Array.from(t.apply(this,arguments),u0),s,h=a.length,c=-1,l;for(const f of o)for(s=0,++c;s<h;++s)(a[s][c]=[0,+r(f,a[s].key,c,o)]).data=f;for(s=0,l=Wa(e(a));s<h;++s)a[l[s]].index=s;return n(a,l),a}return i.keys=function(o){return arguments.length?(t=typeof o=="function"?o:ie(Array.from(o)),i):t},i.value=function(o){return arguments.length?(r=typeof o=="function"?o:ie(+o),i):r},i.order=function(o){return arguments.length?(e=o==null?tl:typeof o=="function"?o:ie(Array.from(o)),i):e},i.offset=function(o){return arguments.length?(n=o??js,i):n},i}function Qr(t,e,n){this.k=t,this.x=e,this.y=n}Qr.prototype={constructor:Qr,scale:function(t){return t===1?this:new Qr(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new Qr(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};Qr.prototype;function d0(t){const e=t-1;return e*e*e+1}function h0(t,{delay:e=0,duration:n=400,easing:r=d0,axis:i="y"}={}){const o=getComputedStyle(t),a=+o.opacity,s=i==="y"?"height":"width",h=parseFloat(o[s]),c=i==="y"?["top","bottom"]:["left","right"],l=c.map(p=>`${p[0].toUpperCase()}${p.slice(1)}`),f=parseFloat(o[`padding${l[0]}`]),u=parseFloat(o[`padding${l[1]}`]),g=parseFloat(o[`margin${l[0]}`]),m=parseFloat(o[`margin${l[1]}`]),v=parseFloat(o[`border${l[0]}Width`]),_=parseFloat(o[`border${l[1]}Width`]);return{delay:e,duration:n,easing:r,css:p=>`overflow: hidden;opacity: ${Math.min(p*20,1)*a};${s}: ${p*h}px;padding-${c[0]}: ${p*f}px;padding-${c[1]}: ${p*u}px;margin-${c[0]}: ${p*g}px;margin-${c[1]}: ${p*m}px;border-${c[0]}-width: ${p*v}px;border-${c[1]}-width: ${p*_}px;min-${s}: 0`}}var g0=yt('<button class="p-xs flex items-center justify-center rounded-full cursor-pointer bg-card border border-solid border-light info-button svelte-dipw5r" type="button"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-primary"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg> <span class="sr-only"> </span></button>'),m0=yt('<div class="absolute top-100 left-0 right-0 bg-card rounded p-md mt-xs border border-solid border-default shadow-lg z-popover description svelte-dipw5r" role="region"><p class="m-0 text-secondary text-sm"> </p></div>'),p0=yt('<div><div class="flex items-center gap-sm pb-sm bg-page relative z-above title-container"><h2 class="m-0 text-lg text-primary flex-1"><!></h2> <!></div> <!></div>');function v0(t,e){we(e,!1);const[n,r]=je(),i=()=>mt(d(h),"$hideInfoText",n),o=()=>mt(d(c),"$showInfoText",n),a=()=>mt(d(l),"$visualizationDescriptionText",n),s=()=>mt(d(f),"$descriptionText",n),h=vt(),c=vt(),l=vt(),f=vt();let u=Kt(e,"title",8,""),g=Kt(e,"description",8,""),m=Kt(e,"descriptionTranslationKey",8,""),v=Kt(e,"showDescription",12,!1),_=Kt(e,"descriptionId",8),p=Kt(e,"className",8,""),$=vt(),k=vt();function w(W){W.stopPropagation(),W.preventDefault(),v(!v())}function b(W){if(!v())return;const J=W.target,z=d($)&&!d($).contains(J),R=d(k)&&!d(k).contains(J);z&&R&&v(!1)}qe(()=>{document.addEventListener("click",b)}),In(()=>{document.removeEventListener("click",b)}),ge(()=>tt,()=>{bi(D(h,tt("ui.hide_info")),"$hideInfoText",n)}),ge(()=>tt,()=>{bi(D(c,tt("ui.show_info")),"$showInfoText",n)}),ge(()=>tt,()=>{bi(D(l,tt("ui.visualization_description")),"$visualizationDescriptionText",n)}),ge(()=>(Fe(m()),tt),()=>{bi(D(f,m()?tt(m()):void 0),"$descriptionText",n)}),hi(),ke();var y=p0(),S=N(y),L=N(S),B=N(L);Rl(B,u);var T=pt(L,2);{var E=W=>{var J=g0(),z=pt(N(J),2),R=N(z);We(J,V=>D($,V),()=>d($)),kt(()=>{ve(J,"aria-expanded",v()),ve(J,"aria-controls",_()),ut(R,v()?i():o())}),ye("click",J,w),et(W,J)};Dt(T,W=>{(g()||m())&&W(E)})}var I=pt(S,2);{var P=W=>{var J=m0(),z=N(J),R=N(z);We(J,V=>D(k,V),()=>d(k)),kt(()=>{ve(J,"id",_()),ve(J,"aria-label",a()),ut(R,m()?s():g())}),gf(3,J,()=>h0,()=>({duration:150,easing:V=>V})),et(W,J)};Dt(I,W=>{v()&&(g()||m())&&W(P)})}kt(()=>wo(y,`mb-md relative visualization-header ${p()??""} svelte-dipw5r`)),et(t,y),Te(),r()}function Ao(t={}){const{backgroundColor:e="rgba(0, 0, 0, 0.8)",color:n="white",padding:r="8px 12px",borderRadius:i="4px",fontSize:o="12px",zIndex:a="1000",boxShadow:s="0 2px 5px rgba(0,0,0,0.2)",defaultWidth:h=200,defaultHeight:c=100,offset:l=10}=t;let f=null;function u(){try{f&&document.body.contains(f)&&document.body.removeChild(f),f=document.createElement("div"),f.style.position="absolute",f.style.backgroundColor=e,f.style.color=n,f.style.padding=r,f.style.borderRadius=i,f.style.pointerEvents="none",f.style.display="none",f.style.fontSize=o,f.style.zIndex=a,f.style.boxShadow=s,t.maxWidth&&(f.style.maxWidth=t.maxWidth),t.whiteSpace&&(f.style.whiteSpace=t.whiteSpace),document&&document.body&&document.body.appendChild(f)}catch(p){console.error("Error creating tooltip:",p),f=null}}function g(p,$,k=h,w=c){try{if((!f||!document.body.contains(f))&&u(),!f)return;f.innerHTML=$;const b=m(p,k,w);f.style.left=`${b.left}px`,f.style.top=`${b.top}px`,f.style.display="block"}catch(b){console.error("Error showing tooltip:",b)}}function m(p,$=h,k=c){try{let w=p.pageX+l,b=p.pageY+l;return w+$>window.innerWidth&&(w=p.pageX-$-l),b+k>window.innerHeight&&(b=p.pageY-k-l),{left:w,top:b}}catch(w){return console.error("Error calculating tooltip position:",w),{left:window.innerWidth/2-$/2,top:window.innerHeight/2-k/2}}}function v(){try{f&&document.body.contains(f)&&(f.style.display="none")}catch(p){console.error("Error hiding tooltip:",p)}}function _(p){try{f&&document.body.contains(f)&&(f.innerHTML=p)}catch($){console.error("Error updating tooltip content:",$)}}return qe(()=>{u()}),In(()=>{f&&document.body.contains(f)&&document.body.removeChild(f)}),{showTooltip:g,hideTooltip:v,updateTooltipContent:_,calculatePosition:m,getTooltipElement:()=>f}}function wn(t,e){const n=t?`<div class="font-bold mb-xs pb-xs border-b border-white border-opacity-30">
            ${t}
        </div>`:"",r=e.map(i=>`<span>${i.label}:</span><span class="text-right font-bold">${i.value}</span>`).join("");return`
        ${n}
        <div class="grid grid-cols-2 gap-xs">
            ${r}
        </div>
    `}var y0=yt('<div class="text-center text-secondary"> </div>'),_0=yt('<div class="text-center text-error" role="alert"> </div>'),x0=yt('<div class="text-center text-secondary"> </div>'),b0=yt('<div class="empty-visualization svelte-hwelso" aria-live="polite"><!></div>'),w0=yt('<div role="region"><!> <div class="w-full flex-1 flex flex-col relative z-base visualization-content" role="presentation"><!></div></div>');function Lr(t,e){we(e,!1);const[n,r]=je(),i=()=>mt(fe,"$itemsStore",n),o=vt(),a=vt(),s=vt(),h=vt(),c=vt();let l=Kt(e,"title",8,""),f=Kt(e,"translationKey",8,""),u=Kt(e,"titleHtml",8,""),g=Kt(e,"description",8,""),m=Kt(e,"descriptionTranslationKey",8,""),v=Kt(e,"showDescription",12,!1),_=Kt(e,"ariaLabel",8,"");const p=`viz-desc-${Math.random().toString(36).slice(2,11)}`;let $=Kt(e,"enableResizeObserver",8,!0),k=vt(),w;const b=Bl();let y=Kt(e,"theme",8,"default"),S=Kt(e,"customBackground",8,""),L=Kt(e,"customTextColor",8,""),B=Kt(e,"minHeight",8,"400px"),T=Kt(e,"padding",8,"var(--spacing-md)"),E=Kt(e,"className",8,""),I=Kt(e,"enableTooltip",8,!0),P=Kt(e,"tooltipBackgroundColor",8,"rgba(0, 0, 0, 0.8)"),W=Kt(e,"tooltipTextColor",8,"white"),J=Kt(e,"tooltipMaxWidth",8,"250px");const z=I()?Ao({backgroundColor:P(),color:W(),maxWidth:J()}):null;function R(X,lt,rt,K){I()&&z&&z.showTooltip(X,lt,rt,K)}function V(){I()&&z&&z.hideTooltip()}function st(X){I()&&z&&z.updateTooltipContent(X)}qe(()=>{$()&&d(k)&&(w=new ResizeObserver(X=>{const lt=X[0];if(lt){const{width:rt,height:K}=lt.contentRect;b("resize",{width:rt,height:K})}}),w.observe(d(k)))}),In(()=>{w&&d(k)&&(w.unobserve(d(k)),w.disconnect())}),ge(()=>(Fe(B()),Fe(T()),Fe(S()),Fe(L())),()=>{D(o,`
        min-height: ${B()};
        padding: ${T()};
        ${S()?`background: ${S()};`:""}
        ${L()?`color: ${L()};`:""}
    `)}),ge(()=>(Fe(u()),Fe(f()),Fe(l())),()=>{D(a,u()||(f()?at(f()):l()))}),ge(()=>(Fe(m()),Fe(g())),()=>{D(s,m()?at(m()):g())}),ge(()=>(Fe(_()),d(a)),()=>{D(h,_()||d(a))}),ge(()=>(Fe(g()),Fe(m())),()=>{D(c,!!(g()||m()))}),hi(),ke();var O=w0(),U=N(O);v0(U,{get title(){return d(a)},get description(){return g()},get descriptionTranslationKey(){return m()},descriptionId:p,className:"z-above",get showDescription(){return v()},set showDescription(X){v(X)},$$legacy:!0});var Q=pt(U,2),G=N(Q);Pl(G,e,"default",{},X=>{var lt=b0(),rt=N(lt);{var K=F=>{var M=y0(),x=N(M);kt(A=>ut(x,A),[()=>at("ui.loading")],re),et(F,M)},C=F=>{var M=ae(),x=Qt(M);{var A=j=>{var dt=_0(),ot=N(dt);kt(()=>ut(ot,i().error)),et(j,dt)},H=j=>{var dt=x0(),ot=N(dt);kt(Z=>ut(ot,Z),[()=>at("ui.no_visualization_content")],re),et(j,dt)};Dt(x,j=>{i().error?j(A):j(H,!1)},!0)}et(F,M)};Dt(rt,F=>{i().loading?F(K):F(C,!1)})}kt(()=>ve(lt,"style",d(o))),et(X,lt)}),We(Q,X=>D(k,X),()=>d(k)),kt(()=>{wo(O,`w-full flex flex-col relative visualization-wrapper ${y()??""} ${E()??""} svelte-hwelso`),ve(O,"aria-label",d(h)),ve(O,"aria-describedby",d(c)?p:void 0)}),et(t,O),_i(e,"showTooltip",R),_i(e,"hideTooltip",V),_i(e,"updateTooltipContent",st),_i(e,"createGridTooltipContent",wn);var q=Te({showTooltip:R,hideTooltip:V,updateTooltipContent:st,createGridTooltipContent:wn});return r(),q}const hr={news_article:{id:"news_article",nameEn:"News article",nameFr:"Article de presse",description:"Newspaper and magazine articles"},islamic_periodical:{id:"islamic_periodical",nameEn:"Islamic periodical",nameFr:"Périodique islamique",description:"Islamic magazines and periodicals"},documents:{id:"documents",nameEn:"Documents",nameFr:"Documents divers",description:"Various documents"},photographs:{id:"photographs",nameEn:"Photographs",nameFr:"Photographies",description:"Photographs and images"},video_recording:{id:"video_recording",nameEn:"Video recording",nameFr:"Enregistrement vidéo",description:"Video recordings and footage"},references:{id:"references",nameEn:"References",nameFr:"Références",description:"Reference materials"},other:{id:"other",nameEn:"Other",nameFr:"Autre",description:"Uncategorized items"}},T0={"24h au Bénin":"news_article","Agence Bénin Presse":"news_article",Banouto:"news_article","Bénin Intelligent":"news_article","Boulevard des Infos":"news_article","Daho-Express":"news_article",Ehuzu:"news_article",Fraternité:"news_article","L'Evénement Précis":"news_article","La Nation":"news_article","La Nouvelle Tribune":"news_article","Le Matinal":"news_article","Les Pharaons":"news_article","Matin Libre":"news_article","Burkina 24":"news_article","Carrefour africain":"news_article",FasoZine:"news_article","L'Evénement":"news_article","L'Observateur":"news_article","L'Observateur Paalga":"news_article","Le Pays":"news_article","LeFaso.net":"news_article",Mutations:"news_article","San Finna":"news_article",Sidwaya:"news_article","Agence Ivoirienne de Presse":"news_article","Fraternité Hebdo":"news_article","Fraternité Matin":"news_article","Ivoire Dimanche":"news_article","L'Alternative":"news_article","L'Intelligent d'Abidjan":"news_article","La Voie":"news_article","Le Jour":"news_article","Le Jour Plus":"news_article","Le Nouvel Horizon":"news_article","Le Patriote":"news_article","Notre Temps":"news_article","Notre Voie":"news_article","Le Sahel":"news_article","Agence Togolaise de Presse":"news_article","Atopani Express":"news_article","Courrier du Golfe":"news_article","Forum Hebdo":"news_article","La Lettre de Tchaoudjo":"news_article","La Nouvelle Marche":"news_article","Le Démocrate":"news_article","L'éveil du Peuple":"news_article","Togo-Presse":"news_article",ASSALAM:"islamic_periodical","Islam Hebdo":"islamic_periodical","Al Mawadda":"islamic_periodical","An-Nasr Trimestriel":"islamic_periodical","An-Nasr Vendredi":"islamic_periodical","L'Appel":"islamic_periodical","L'Autre Regard":"islamic_periodical","La Preuve":"islamic_periodical","Le CERFIste":"islamic_periodical","Le vrai visage de l'islam":"islamic_periodical","AJMCI Infos":"islamic_periodical","Al Minbar":"islamic_periodical","Al Muwassat Info":"islamic_periodical","Al-Azan":"islamic_periodical",Alif:"islamic_periodical","Allahou Akbar":"islamic_periodical","Bulletin d'information du CNI":"islamic_periodical","Islam Info":"islamic_periodical","Les Échos de l'AEEMCI":"islamic_periodical","Plume Libre":"islamic_periodical","Al Maoulid Info":"islamic_periodical","Al Maoulid Magazine":"islamic_periodical","Al Maoulid Magazine (arabe)":"islamic_periodical","Le Pacific":"islamic_periodical","Le Rendez-Vous":"islamic_periodical","Documents divers (Burkina Faso)":"documents","Documents divers (Bénin)":"documents","Documents divers (Côte d'Ivoire)":"documents","Documents divers (Niger)":"documents","Documents divers (Togo)":"documents","Photographies (Burkina Faso)":"photographs","Photographies (Bénin)":"photographs","Photographies (Côte d'Ivoire)":"photographs","Photographies (Niger)":"photographs","Photographies (Togo)":"photographs","Collection de sermons islamiques sur vidéo":"video_recording","Références (Bénin)":"references","Références (Burkina Faso)":"references","Références (Côte d'Ivoire)":"references","Références (Niger)":"references","Références (Nigéria)":"references","Références (Togo)":"references"};function el(t,e){const n=hr[t]||hr.other;return e==="fr"?n.nameFr:n.nameEn}function Dr(t){const{container:e,onResize:n,debounce:r=!0,debounceDelay:i=100}=t;let o=0,a=0,s=null,h=null;function c(){if(!e)return;const f=e.getBoundingClientRect(),u=Math.abs(o-f.width)>1,g=Math.abs(a-f.height)>1;if(!u&&!g)return;o=f.width;const m=window.getComputedStyle(e);m.height!=="auto"&&!m.height.includes("%")||(a=f.height),r?(h!==null&&window.clearTimeout(h),h=window.setTimeout(()=>{n()},i)):n()}e&&(c(),s=new ResizeObserver(()=>{c()}),s.observe(e));function l(){s&&(s.disconnect(),s=null),h!==null&&(window.clearTimeout(h),h=null)}return{width:o,height:a,dimensions:{width:o,height:a},updateDimensions:c,cleanup:l}}function Je(t={}){const{filterMissingValues:e=!0,requiredFields:n=[],filterFn:r,calculatePercentages:i=!0,sortByCount:o=!0,sortDescending:a=!0}=t;function s(f){if(!f||f.length===0)return[];let u=[...f];return r&&(u=u.filter(r)),e&&n.length>0&&(u=u.filter(g=>n.every(m=>g[m]!==void 0&&g[m]!==null&&g[m]!==""))),u}function h(f,u,g){const m=s(f),v=g||m.length,_=ls(m,$=>$.length,u),p=Array.from(_,([$,k])=>{const w={key:$,count:k,originalKey:$};return i&&(w.percentage=k/v*100),w});return o&&p.sort(($,k)=>a?k.count-$.count:$.count-k.count),p}function c(f,u,g){const m=s(f),v=g||m.length,_=ka(m,...u);function p($,k=0){return Array.from($,([w,b])=>{const y={name:w,originalName:w,value:b instanceof vr?0:b.length,itemCount:b instanceof vr?0:b.length};return i&&(y.percentage=y.value/v*100),b instanceof vr&&(y.children=p(b,k+1),y.value=y.children.reduce((S,L)=>S+L.value,0),y.itemCount=y.value),y})}return{name:"root",children:p(_)}}function l(f,u,g={}){try{const m=s(f),{startDate:v,endDate:_,includeCumulative:p=!0,initialTotal:$=0}=g;console.log("[useDataProcessing] Processing time data for",m.length,"items"),console.log("[useDataProcessing] Date range:",{startDate:v,endDate:_}),$>0&&console.log("[useDataProcessing] Using initial total of",$);const k=m.filter(y=>{try{const S=y[u];if(!S)return!1;const L=new Date(S),B=!isNaN(L.getTime()),T=!v||L>=v,E=!_||L<=_;return B&&T&&E}catch{return console.warn("[useDataProcessing] Error parsing date for item:",y),!1}});if(console.log("[useDataProcessing] Valid items after date filtering:",k.length),k.length>0)console.log("[useDataProcessing] Sample dates:",k.slice(0,3).map(y=>y[u]));else return console.warn("[useDataProcessing] No valid items with dates in the specified range"),[];const w=ls(k,y=>y.length,y=>{try{const S=new Date(y[u]);return`${S.getFullYear()}-${String(S.getMonth()+1).padStart(2,"0")}`}catch(S){return console.error("[useDataProcessing] Error formatting date for grouping:",S),"unknown"}});w.has("unknown")&&(console.warn("[useDataProcessing] Removing unknown date entries"),w.delete("unknown"));const b=Array.from(w,([y,S])=>{try{const[L,B]=y.split("-"),T=new Date(parseInt(L),parseInt(B)-1);return{date:T,month:y,monthFormatted:T.toLocaleDateString(void 0,{month:"short",year:"numeric"}),count:S,total:0,percentage:S/k.length*100}}catch(L){return console.error("[useDataProcessing] Error parsing month data:",L),null}}).filter(y=>y!==null).sort((y,S)=>y.date.getTime()-S.date.getTime());if(b.length>1){const y=[],S=b[0].date,L=b[b.length-1].date;let B=new Date(S);for(;B<=L;){const T=B.getFullYear(),E=B.getMonth(),I=`${T}-${String(E+1).padStart(2,"0")}`,P=b.find(W=>W.month===I);P?y.push(P):y.push({date:new Date(T,E),month:I,monthFormatted:new Date(T,E).toLocaleDateString(void 0,{month:"short",year:"numeric"}),count:0,total:0,percentage:0}),B.setMonth(B.getMonth()+1)}y.length>b.length&&(console.log("[useDataProcessing] Filled in missing months:",y.length-b.length),b.length=0,b.push(...y))}if(p){let y=$;b.forEach(S=>{y+=S.count,S.total=y})}return console.log("[useDataProcessing] Processed timeline data:",b.length,"data points"),b}catch(m){return console.error("[useDataProcessing] Error processing time data:",m),[]}}return{filterItems:s,groupAndCount:h,groupHierarchically:c,processTimeData:l}}var $0=yt('<span class="mx-xs opacity-50"> </span>'),C0=yt('<!> <span tabindex="0" role="link"> </span>',1),k0=yt('<nav class="breadcrumb-navigation flex items-center text-sm svelte-lpaxl5"></nav>');function z0(t,e){we(e,!1);let n=Kt(e,"items",24,()=>[]),r=Kt(e,"separator",8,"/"),i=Kt(e,"activeItemClass",8,"text-primary font-medium"),o=Kt(e,"navItemClass",8,"hover:text-primary transition-colors cursor-pointer");const a=Bl();function s(c){a("navigate",{id:c})}ke();var h=k0();Hn(h,5,n,pr,(c,l,f)=>{var u=C0(),g=Qt(u);{var m=p=>{var $=$0(),k=N($);kt(()=>ut(k,r())),et(p,$)};Dt(g,p=>{f>0&&p(m)})}var v=pt(g,2),_=N(v);kt(()=>{wo(v,`${`${o()} ${f===n().length-1?i():""}`??""} svelte-lpaxl5`),ut(_,d(l).label)}),ye("click",v,()=>s(d(l).id)),ye("keypress",v,p=>p.key==="Enter"&&s(d(l).id)),et(c,u)}),et(t,h),Te()}var M0=yt('<div class="loading absolute inset-center text-secondary svelte-ams09e"> </div>'),A0=yt('<div class="error absolute inset-center text-error svelte-ams09e"> </div>'),S0=yt('<div class="no-data absolute inset-center text-secondary svelte-ams09e"> </div>'),E0=yt('<div class="loading absolute inset-center text-secondary svelte-ams09e">Initializing visualization...</div>'),I0=yt('<div class="breadcrumb-wrapper absolute top-0 left-0 right-0 bg-white bg-opacity-90 p-xs z-10 shadow-sm svelte-ams09e" style="height: 30px;"><div class="px-sm py-xs svelte-ams09e"><!></div></div>'),N0=yt('<p class="text-sm text-secondary mb-xs svelte-ams09e"> <strong class="font-medium svelte-ams09e"> </strong></p>'),L0=yt('<p class="text-sm text-secondary mb-xs svelte-ams09e"> <strong class="font-medium svelte-ams09e"> </strong></p>'),D0=yt('<p class="text-sm text-secondary mb-xs svelte-ams09e"> </p>'),F0=yt('<div class="chart-container relative flex-1 min-h-450 bg-card rounded p-md overflow-hidden svelte-ams09e"><!></div> <div class="stats bg-card shadow rounded p-md svelte-ams09e"><div class="stat-summary svelte-ams09e"><h3 class="text-primary font-medium border-b pb-xs mb-sm svelte-ams09e"> </h3> <p class="text-sm text-secondary mb-xs svelte-ams09e"> <strong class="font-medium svelte-ams09e"> </strong></p> <!> <p class="text-sm text-secondary mb-xs svelte-ams09e"> <strong class="font-medium svelte-ams09e"> </strong></p> <p class="text-sm text-secondary mb-xs svelte-ams09e"> <strong class="font-medium svelte-ams09e"> </strong></p> <!></div></div>',1),R0=yt('<div class="flex flex-col gap-sm w-full h-full country-distribution-container svelte-ams09e"><!></div>');function P0(t,e){we(e,!1);const[n,r]=je(),i=()=>mt(fe,"$itemsStore",n),o=()=>mt(Q,"$noSetText",n),a=()=>mt(R,"$noDataText",n),s=()=>mt(V,"$itemsText",n),h=()=>mt(lt,"$categoriesText",n),c=()=>mt(O,"$percentTotalText",n),l=()=>mt(U,"$clickZoomInText",n),f=()=>mt(rt,"$subCollectionsText",n),u=()=>mt(st,"$percentParentText",n),g=()=>mt(G,"$summaryText",n),m=()=>mt(q,"$totalItemsText",n),v=()=>mt(X,"$countriesText",n),_=()=>mt(K,"$currentlyViewingText",n);let p=vt(),$={name:"root",children:[]},k=null,w="en",b=vt(""),y=vt(0),S=vt(0),L=vt(0),B=vt(0),T=[],E=null,I=vt(null),P=new Map,W=vt([{id:null,label:at("viz.all_countries")}]),J=new Map,z=new Map;const R=tt("viz.no_data"),V=tt("viz.items"),st=tt("viz.percent_of_country"),O=tt("viz.percent_of_total"),U=tt("viz.click_zoom_in");tt("viz.back_to_all"),tt("viz.all_countries"),tt("viz.unknown");const Q=tt("viz.no_set"),G=tt("viz.summary"),q=tt("viz.total_items"),X=tt("viz.countries"),lt=tt("viz.categories"),rt=tt("viz.sub_collections"),K=tt("viz.currently_viewing");tt("viz.click_back_to_return");let C=vt(),F,M=0,x=0,A;const{groupHierarchically:H}=Je({filterMissingValues:!0,requiredFields:["country"],calculatePercentages:!0,sortByCount:!0,sortDescending:!0});function j(ht){return ht.toLocaleString(w==="fr"?"fr-FR":"en-US")}function dt(){if(!(!d(ot)||d(Z)))try{if(d(y)>0){const ht=j(d(y));D(b,at("viz.distribution_items",{0:ht}))}else D(b,at("viz.country_distribution_title"))}catch(ht){console.error("Error updating title HTML:",ht),D(b,"Country Distribution")}}let ot=vt(!1),Z=vt(!1),nt;function At(){d(ot)&&(nt=fe.subscribe(ht=>{d(ot)&&document.body.contains(d(p))&&(console.log("ItemsStore updated, handling change"),ht.items&&ht.items.length>0&&Yt())}))}qe(()=>(D(ot,!0),D(Z,!1),console.log("CountryDistribution component mounted"),(async()=>{try{if(await kn(),d(Z)||!d(ot)){console.log("Component unmounted after tick, aborting initialization");return}if(!d(p)){console.error("Container element not found in onMount");return}if(console.log("Container is ready, initializing visualization"),F=Dr({container:d(p),onResize:()=>{if(d(ot)&&d(p)&&document.body.contains(d(p))){const{width:ht,height:_t}=F.dimensions;M=ht,x=_t,console.log(`Resizing to ${M}x${x}`),M>0&&x>0&&Yt()}},debounceDelay:50}),A=_e.subscribe(ht=>{var _t;if(!(!d(ot)||!document.body.contains(d(p)))&&(console.log("Language changed to:",ht),w=ht,d(W)&&d(W).length>0&&Bo(W,d(W)[0].label=at("viz.all_countries")),dt(),i().items&&i().items.length>0)){const $t=d(I),Ct=$t==null?void 0:$t.data.originalName;if(D(I,null),$=Wt(i().items),$t&&Ct){const Ot=(_t=un($).children)==null?void 0:_t.find(Bt=>Bt.data.originalName===Ct);if(Ot){Ft(Ot);return}}d(ot)&&d(p)&&document.body.contains(d(p))&&Yt()}}),At(),i().items&&i().items.length>0){if(console.log("Processing initial data"),d(Z)||!d(ot)){console.log("Component unmounted before processing data, aborting");return}if($=Wt(i().items),$.children&&$.children.length>0){const $t=Ce().domain($.children.map(Ct=>Ct.originalName||Ct.name)).range(on);$.children.forEach(Ct=>{const Rt=Ct.originalName||Ct.name;J.has(Rt)||J.set(Rt,$t(Rt))})}const{width:ht,height:_t}=F.dimensions;if(M=ht,x=_t,P=new Map,await kn(),d(Z)||!d(ot)){console.log("Component unmounted after second tick, aborting visualization");return}d(ot)&&d(p)&&document.body.contains(d(p))&&(console.log("Updating visualization after initialization"),Yt())}else{if(d(Z)||!d(ot)){console.log("Component unmounted before loading items, aborting");return}console.log("Loading items from store"),fe.loadItems()}}catch(ht){console.error("Error during initialization:",ht)}})(),()=>{try{console.log("CountryDistribution component unmounting"),D(ot,!1),D(Z,!0),F&&F.cleanup(),A&&A(),nt&&nt(),d(p)&&ft(d(p)).selectAll("*").remove(),k=null,D(I,null),E=null,T=[],P.clear(),console.log("CountryDistribution cleanup complete")}catch(ht){console.error("Error during cleanup:",ht)}}));function Wt(ht){if(d(Z))return console.log("Component unmounted during data processing, aborting"),{name:"root",children:[]};const _t=H(ht,[Ct=>Ct.country||"",Ct=>Ct.item_set_title||o()]),$t={name:"root",children:_t.children.map(Ct=>{const Rt=at(`country.${Ct.name}`)||Ct.name,Ot=new Map;Object.values(hr).forEach(Mt=>{Ot.set(Mt.id,{name:el(Mt.id,w),children:[],itemCount:0,originalName:Mt.id,categoryId:Mt.id,isCategory:!0})}),Ct.children&&Ct.children.forEach(Mt=>{const Et=T0[Mt.name]||"other",Y=Ot.get(Et);Y!=null&&Y.children&&(Y.children.push({name:Mt.name,value:Mt.value,itemCount:Mt.value,originalName:Mt.name,categoryId:Et}),Y.itemCount=(Y.itemCount||0)+Mt.value)});const Bt=Array.from(Ot.values()).filter(Mt=>Mt.children&&Mt.children.length>0).sort((Mt,Et)=>(Et.itemCount||0)-(Mt.itemCount||0));return Bt.forEach(Mt=>{Mt.children&&Mt.children.sort((Et,Y)=>(Y.itemCount||0)-(Et.itemCount||0))}),{name:Rt,children:Bt,itemCount:Ct.value,originalName:Ct.name}})};return D(y,_t.children.reduce((Ct,Rt)=>Ct+Rt.value,0)),D(S,_t.children.length),D(B,Object.keys(hr).length),D(L,0),$t.children&&$t.children.forEach(Ct=>{Ct.children&&Ct.children.forEach(Rt=>{Rt.children&&D(L,d(L)+Rt.children.length)})}),dt(),$t}function Ft(ht){var _t,$t,Ct;if(D(I,ht),d(I)){d(I).data.isCategory;const Rt=d(I).data.isCategory;if(D(W,[{id:null,label:at("viz.all_countries")}]),Rt){const Ot=d(I).parent;Ot&&(d(W).push({id:Ot.data.originalName||null,label:Ot.data.name}),console.log("Added country to breadcrumb:",Ot.data.name,"with ID:",Ot.data.originalName))}if(Rt&&d(I).data.categoryId){const Ot=d(I).data.categoryId,Bt=el(Ot,w);d(W).push({id:d(I).data.categoryId||null,label:Bt}),console.log("Added category to breadcrumb:",Bt,"with ID:",d(I).data.categoryId)}else d(W).push({id:d(I).data.originalName||null,label:d(I).data.name}),console.log("Added item to breadcrumb:",d(I).data.name,"with ID:",d(I).data.originalName);if(!d(I).children||d(I).children.length===0){console.warn("Cannot zoom to node without children");return}if(console.log("Zooming to node:",d(I).data.name,"Original name:",d(I).data.originalName,"Is category:",d(I).data.isCategory),D(y,d(I).data.itemCount||0),d(I).data.isCategory)d(I).data.isCategory&&(D(L,(($t=d(I).children)==null?void 0:$t.length)||0),D(B,1));else{const Ot=((_t=d(I).children)==null?void 0:_t.filter(Bt=>Bt.data.isCategory))||[];D(B,Ot.length),D(L,0),Ot.forEach(Bt=>{Bt.children&&D(L,d(L)+Bt.children.length)})}}else if(D(W,[{id:null,label:at("viz.all_countries")}]),i().items&&i().items.length>0){$=Wt(i().items);const Rt=i().items.filter(Bt=>Bt.country&&Bt.country.trim()!=="");D(y,Rt.length);const Ot=ka(Rt,Bt=>Bt.country);D(S,Ot.size),D(B,Object.keys(hr).length),D(L,0),(Ct=$.children)==null||Ct.forEach(Bt=>{var Mt;(Mt=Bt.children)==null||Mt.forEach(Et=>{Et.children&&D(L,d(L)+Et.children.length)})})}dt(),Yt()}function le(ht){const{id:_t}=ht.detail;if(!d(ot)||d(Z)||!document.body.contains(d(p))){console.log("Component not mounted, ignoring breadcrumb click");return}if(console.log("Breadcrumb navigation requested for ID:",_t),_t===null){console.log("Navigating to root view"),Ft(null);return}if(P&&P.has(_t)){const $t=P.get(_t);console.log("Found country node in map:",$t==null?void 0:$t.data.name),Ft($t||null);return}if(k&&P)for(const $t of P.values()){if(!$t.children)continue;const Ct=$t.children.find(Rt=>Rt.data.categoryId===_t||Rt.data.originalName===_t||Rt.data.name===_t);if(Ct){console.log("Found category node:",Ct.data.name,"in country:",$t.data.name),Ft(Ct);return}}console.log("Could not find a node matching ID:",_t)}function Yt(){var ht,_t;try{if(!d(ot)||d(Z)){console.log("Component unmounted, skipping visualization update");return}if(!d(p)){console.error("Container element not found");return}const $t={top:30,right:10,bottom:10,left:10};if(d(I)||($=Wt(i().items)),!$.children||$.children.length===0){ft(d(p)).select("svg").remove(),ft(d(p)).append("div").attr("class","no-data absolute inset-center text-secondary").text(a());return}ft(d(p)).select("svg").remove(),ft(d(p)).select(".no-data").remove();const Ct=d(p).getBoundingClientRect(),Rt=Ct.width-$t.left-$t.right,Ot=Ct.height-$t.top-$t.bottom,Mt=ft(d(p)).append("svg").attr("width","100%").attr("height","100%").attr("viewBox",`0 0 ${Ct.width} ${Ct.height}`).attr("preserveAspectRatio","xMidYMid meet").append("g").attr("transform",`translate(${$t.left}, ${$t.top})`),Et=Tc().size([Rt,Ot]).paddingOuter(4).paddingTop(20).paddingInner(2).round(!0);let Y;if(d(I)){const It={name:d(I).data.name,children:d(I).data.children,originalName:d(I).data.originalName,isCategory:d(I).data.isCategory,categoryId:d(I).data.categoryId};Y=un(It).sum(Pt=>Pt.value||0).sort((Pt,Zt)=>(Zt.value||0)-(Pt.value||0))}else Y=un($).sum(It=>It.value||0).sort((It,Pt)=>(Pt.value||0)-(It.value||0)),P.clear(),Y.children&&Y.children.forEach(It=>{const Pt=It.data.originalName||It.data.name;P.set(Pt,It)});k=Y;try{Et(Y)}catch(It){console.error("Error applying treemap layout:",It),D(I,null),$=Wt(i().items),Y=un($).sum(Pt=>Pt.value||0).sort((Pt,Zt)=>(Zt.value||0)-(Pt.value||0)),k=Y,Et(Y)}const it=Ce().domain(Y.children?Y.children.map(It=>It.data.originalName||It.data.name):[Y.data.originalName||Y.data.name]).range(on),xt=Ce().domain(Object.keys(hr)).range(Vv),bt=!d(I),gt=d(I)&&!d(I).data.isCategory,Ut=d(I)&&d(I).data.isCategory;if(bt){const It=Y.children||[];Mt.selectAll(".country").data(It).enter().append("g").attr("class","country").each(function(Zt){const St=ft(this),wt=Zt.data.name,Nt=Zt.data.originalName||wt;let Gt;J.has(Nt)?Gt=J.get(Nt)||it(Nt):(Gt=it(Nt),J.set(Nt,Gt));const ze=Zt.children||[],Me=St.selectAll(".category").data(ze).enter().append("g").attr("class","category").attr("transform",Tt=>{const Lt=Tt.x0||0,Vt=Tt.y0||0;return`translate(${Lt},${Vt})`});Me.append("rect").attr("width",Tt=>{const Lt=Tt.x0||0,Vt=Tt.x1||0;return Math.max(0,Vt-Lt)}).attr("height",Tt=>{const Lt=Tt.y0||0,Vt=Tt.y1||0;return Math.max(0,Vt-Lt)}).attr("fill",Tt=>{const Lt=Tt.data.categoryId||"other",Vt=Re(Gt),he=`${Nt}-${Lt}`;let oe;if(z.has(he))oe=z.get(he)||Vt.toString();else{const pe=Re(xt(Lt));oe=Re(Vt.r*.7+pe.r*.3,Vt.g*.7+pe.g*.3,Vt.b*.7+pe.b*.3).toString(),z.set(he,oe)}return oe}).attr("stroke","white").attr("stroke-width",1.5).attr("opacity",.8).attr("class","cursor-pointer").on("click",(Tt,Lt)=>{Ft(Zt)}).on("mouseover",function(Tt,Lt){te(Tt,Lt)}).on("mousemove",function(Tt,Lt){te(Tt,Lt)}).on("mouseout",function(){d(C).hideTooltip()}),Me.append("text").attr("x",5).attr("y",15).attr("font-size","var(--font-size-xs)").attr("font-weight","bold").attr("fill","white").attr("class","pointer-events-none").text(Tt=>Tt.x1-Tt.x0<100?Tt.data.name:`${Tt.data.name} (${Tt.data.itemCount||0})`).each(function(Tt){const Lt=ft(this),Vt=this.getComputedTextLength(),he=Tt.x1-Tt.x0-10;if(Vt>he){let oe=Tt.data.name;Lt.text(oe);let pe=this.getComputedTextLength(),qt=!1;for(;pe>he&&oe.length>3;)oe=oe.slice(0,-1),Lt.text(oe),pe=this.getComputedTextLength(),qt=!0;qt&&Lt.text(oe+"..."),Lt.append("title").text(`${wt} > ${Tt.data.name} (${Tt.data.itemCount||0} ${s()})`)}});let Ae=1/0,tn=1/0,Se=-1/0,Ye=-1/0;ze.forEach(Tt=>{const Lt=Tt.x0||0,Vt=Tt.y0||0,he=Tt.x1||0,oe=Tt.y1||0;Ae=Math.min(Ae,Lt),tn=Math.min(tn,Vt),Se=Math.max(Se,he),Ye=Math.max(Ye,oe)}),St.append("rect").attr("x",Ae).attr("y",tn-20).attr("width",Se-Ae).attr("height",20).attr("fill",Gt).attr("opacity",.9).attr("class","cursor-pointer").on("click",Tt=>{Ft(Zt)}),St.append("text").attr("x",Ae+5).attr("y",tn-6).attr("font-size","var(--font-size-sm)").attr("font-weight","bold").attr("fill","white").attr("class","pointer-events-none").text(`${wt} (${Zt.data.itemCount||0} ${s()})`)})}else if(gt){const It=Mt.selectAll(".category").data(Y.children||[]).enter().append("g").attr("class","category").attr("transform",St=>{const wt=St.x0||0,Nt=St.y0||0;return`translate(${wt},${Nt})`}),Pt=((ht=d(I))==null?void 0:ht.data.originalName)||((_t=d(I))==null?void 0:_t.data.name)||"",Zt=J.get(Pt)||it(Pt);It.append("rect").attr("width",St=>{const wt=St.x0||0,Nt=St.x1||0;return Math.max(0,Nt-wt)}).attr("height",St=>{const wt=St.y0||0,Nt=St.y1||0;return Math.max(0,Nt-wt)}).attr("fill",St=>{const wt=St.data.categoryId||"other",Nt=`${Pt}-${wt}`;if(z.has(Nt))return z.get(Nt)||Zt;{const Gt=Re(Zt),ze=Re(xt(wt)),Ae=Re(Gt.r*.7+ze.r*.3,Gt.g*.7+ze.g*.3,Gt.b*.7+ze.b*.3).toString();return z.set(Nt,Ae),Ae}}).attr("stroke","white").attr("stroke-width",1.5).attr("opacity",.8).attr("class","cursor-pointer").on("click",(St,wt)=>{Ft(wt)}).on("mouseover",function(St,wt){te(St,wt)}).on("mousemove",function(St,wt){te(St,wt)}).on("mouseout",function(){d(C).hideTooltip()}),It.append("text").attr("x",5).attr("y",15).attr("font-size","var(--font-size-sm)").attr("font-weight","bold").attr("fill","white").attr("class","pointer-events-none").text(St=>`${St.data.name} (${St.data.itemCount||0} ${s()})`).each(function(St){const wt=ft(this),Nt=this.getComputedTextLength(),Gt=St.x1-St.x0-10;Nt>Gt&&wt.text(St.data.name).append("title").text(`${St.data.name} (${St.data.itemCount||0} ${s()})`)})}else if(Ut&&d(I)){const It=Mt.selectAll(".subcollection").data(Y.children||[]).enter().append("g").attr("class","subcollection").attr("transform",wt=>{const Nt=wt.x0||0,Gt=wt.y0||0;return`translate(${Nt},${Gt})`}),Pt=d(I).data.categoryId||"other",Zt=d(I).parent;let St;if(Zt){const Nt=`${Zt.data.originalName||Zt.data.name}-${Pt}`;St=z.get(Nt)||xt(Pt)}else St=xt(Pt);It.append("rect").attr("width",wt=>{const Nt=wt.x0||0,Gt=wt.x1||0;return Math.max(0,Gt-Nt)}).attr("height",wt=>{const Nt=wt.y0||0,Gt=wt.y1||0;return Math.max(0,Gt-Nt)}).attr("fill",wt=>{const Nt=Re(St);return Re(Nt).brighter(.5).toString()}).attr("stroke","white").attr("stroke-width",.5).attr("class","cursor-pointer").on("mouseover",function(wt,Nt){ft(this).attr("stroke","var(--color-primary)").attr("stroke-width",2),te(wt,Nt)}).on("mousemove",function(wt,Nt){te(wt,Nt)}).on("mouseout",function(){ft(this).attr("stroke","white").attr("stroke-width",.5),d(C).hideTooltip()}),It.append("text").attr("x",3).attr("y",13).attr("font-size","var(--font-size-xs)").attr("fill","var(--color-text-primary)").attr("class","pointer-events-none").each(function(wt){const Nt=ft(this),Gt=wt.x1-wt.x0,ze=wt.y1-wt.y0;if(Gt<30||ze<20)return;let Me=wt.data.name;const Ae=Gt-6,tn=Zt?Zt.data.name:"",Se=d(I)?d(I).data.name:"";let Ye="";tn&&Se?Ye=`${tn} > ${Se} > ${wt.data.name}: ${wt.data.itemCount||wt.value||0} ${s()}`:Se?Ye=`${Se} > ${wt.data.name}: ${wt.data.itemCount||wt.value||0} ${s()}`:Ye=`${wt.data.name}: ${wt.data.itemCount||wt.value||0} ${s()}`,Nt.text(Me).append("title").text(Ye);const Tt=this;let Lt=Tt.getComputedTextLength(),Vt=!1;for(;Lt>Ae&&Me.length>3;)Me=Me.slice(0,-1),Nt.text(Me),Lt=Tt.getComputedTextLength(),Vt=!0;Vt&&(Nt.text(Me+"..."),Nt.append("title").text(Ye))})}}catch($t){console.error("Error in updateVisualization:",$t)}}function te(ht,_t){var $t,Ct;try{if(!d(C))return;const Rt=_t.parent===k,Ot=_t.data.isCategory===!0,Bt=!Rt&&!Ot;if(Rt){const Mt=_t.data.name,Et=_t.data.itemCount||_t.value||0,Y=(($t=_t.children)==null?void 0:$t.length)||0,it=d(y)>0?(Et/d(y)*100).toFixed(1)+"%":"N/A",xt=`
                    <div class="font-bold mb-xs pb-xs border-b border-white border-opacity-30">
                        ${Mt}
                    </div>
                    <div class="grid grid-cols-2 gap-xs">
                        <span>${s()}:</span>
                        <span class="text-right font-medium">${Et}</span>
                        <span>${h()}:</span>
                        <span class="text-right">${Y}</span>
                        <span>${c()}:</span>
                        <span class="text-right">${it}</span>
                    </div>
                    <div class="mt-xs italic text-xs">
                        ${l()}
                    </div>
                `;d(C).showTooltip(ht,xt,250,150)}else if(Ot){const Mt=_t.data.name,Et=_t.data.itemCount||_t.value||0,Y=((Ct=_t.children)==null?void 0:Ct.length)||0,it=_t.parent,xt=it?it.data.name:"",bt=it&&(it.data.itemCount||it.value)||0,gt=bt>0?(Et/bt*100).toFixed(1)+"%":"N/A",Ut=d(y)>0?(Et/d(y)*100).toFixed(1)+"%":"N/A",It=`
                    <div class="font-bold mb-xs pb-xs border-b border-white border-opacity-30">
                        ${xt} > ${Mt}
                    </div>
                    <div class="grid grid-cols-2 gap-xs">
                        <span>${s()}:</span>
                        <span class="text-right font-medium">${Et}</span>
                        <span>${f()}:</span>
                        <span class="text-right">${Y}</span>
                        <span>${u()}:</span>
                        <span class="text-right">${gt}</span>
                        <span>${c()}:</span>
                        <span class="text-right">${Ut}</span>
                    </div>
                    <div class="mt-xs italic text-xs">
                        ${l()}
                    </div>
                `;d(C).showTooltip(ht,It,250,150)}else{const Mt=_t.data.name,Et=_t.data.itemCount||_t.value||0,Y=_t.parent,it=Y==null?void 0:Y.parent,xt=Y?Y.data.name:"",bt=it?it.data.name:"",gt=Y&&(Y.data.itemCount||Y.value)||0,Ut=it&&(it.data.itemCount||it.value)||0,It=gt>0?(Et/gt*100).toFixed(1)+"%":"N/A",Pt=Ut>0?(Et/Ut*100).toFixed(1)+"%":"N/A",Zt=d(y)>0?(Et/d(y)*100).toFixed(1)+"%":"N/A";let St=Mt;xt&&bt?St=`${bt} > ${xt} > ${Mt}`:xt?St=`${xt} > ${Mt}`:bt&&(St=`${bt} > ${Mt}`);const wt=xt||null,Nt=bt||null,Gt=`
                    <div class="font-bold mb-xs pb-xs border-b border-white border-opacity-30">
                        ${St}
                    </div>
                    <div class="grid grid-cols-2 gap-xs">
                        <span>${s()}:</span>
                        <span class="text-right font-medium">${Et}</span>
                        ${wt?`<span>% of ${wt}:</span>
                        <span class="text-right">${It}</span>`:""}
                        ${Nt?`<span>${u()}:</span>
                        <span class="text-right">${Pt}</span>`:""}
                        <span>${c()}:</span>
                        <span class="text-right">${Zt}</span>
                    </div>
                `;d(C).showTooltip(ht,Gt,250,150)}}catch(Rt){console.error("Error showing tooltip:",Rt)}}ke();var ct=R0(),zt=N(ct);We(Lr(zt,{get titleHtml(){return d(b)},descriptionTranslationKey:"viz.country_distribution_description",theme:"default",className:"country-distribution",children:(ht,_t)=>{var $t=F0(),Ct=Qt($t),Rt=N(Ct);{var Ot=Tt=>{var Lt=M0(),Vt=N(Lt);kt(he=>ut(Vt,he),[()=>at("ui.loading")],re),et(Tt,Lt)},Bt=Tt=>{var Lt=ae(),Vt=Qt(Lt);{var he=pe=>{var qt=A0(),Jt=N(qt);kt(()=>ut(Jt,i().error)),et(pe,qt)},oe=pe=>{var qt=ae(),Jt=Qt(qt);{var se=Ie=>{var ce=S0(),Ge=N(ce);kt(()=>ut(Ge,a())),et(Ie,ce)},Ee=Ie=>{var ce=ae(),Ge=Qt(ce);{var Bn=He=>{var Ne=E0();et(He,Ne)},On=He=>{var Ne=ae(),pn=Qt(Ne);{var Wn=Vn=>{var qn=I0(),sn=N(qn),Nn=N(sn);{var Fr=Ln=>{z0(Ln,{get items(){return d(W)},separator:"/",navItemClass:"text-sm hover:text-primary transition-colors cursor-pointer font-medium",activeItemClass:"text-primary font-bold",$$events:{navigate:le}})};Dt(Nn,Ln=>{d(W)&&d(W).length&&Ln(Fr)})}et(Vn,qn)};Dt(pn,Vn=>{d(ot)&&!d(Z)&&Vn(Wn)},!0)}et(He,Ne)};Dt(Ge,He=>{d(p)?He(On,!1):He(Bn)},!0)}et(Ie,ce)};Dt(Jt,Ie=>{!i().items||i().items.length===0?Ie(se):Ie(Ee,!1)},!0)}et(pe,qt)};Dt(Vt,pe=>{i().error?pe(he):pe(oe,!1)},!0)}et(Tt,Lt)};Dt(Rt,Tt=>{i().loading?Tt(Ot):Tt(Bt,!1)})}We(Ct,Tt=>D(p,Tt),()=>d(p));var Mt=pt(Ct,2),Et=N(Mt),Y=N(Et),it=N(Y),xt=pt(Y,2),bt=N(xt),gt=pt(bt),Ut=N(gt),It=pt(xt,2);{var Pt=Tt=>{var Lt=N0(),Vt=N(Lt),he=pt(Vt),oe=N(he);kt(pe=>{ut(Vt,`${v()??""}: `),ut(oe,pe)},[()=>j(d(S))],re),et(Tt,Lt)};Dt(It,Tt=>{d(I)||Tt(Pt)})}var Zt=pt(It,2),St=N(Zt),wt=pt(St),Nt=N(wt),Gt=pt(Zt,2),ze=N(Gt),Me=pt(ze),Ae=N(Me),tn=pt(Gt,2);{var Se=Tt=>{var Lt=L0(),Vt=N(Lt),he=pt(Vt),oe=N(he);kt(()=>{ut(Vt,`${_()??""}: `),ut(oe,d(I).data.name)}),et(Tt,Lt)},Ye=Tt=>{var Lt=D0(),Vt=N(Lt);kt(()=>ut(Vt,l())),et(Tt,Lt)};Dt(tn,Tt=>{d(I)?Tt(Se):Tt(Ye,!1)})}kt((Tt,Lt,Vt)=>{ut(it,g()),ut(bt,`${m()??""}: `),ut(Ut,Tt),ut(St,`${h()??""}: `),ut(Nt,Lt),ut(ze,`${f()??""}: `),ut(Ae,Vt)},[()=>j(d(y)),()=>j(d(B)),()=>j(d(L))],re),et(ht,$t)},$$slots:{default:!0},$$legacy:!0}),ht=>D(C,ht),()=>d(C)),et(t,ct),Te(),r()}function Uc(t){const{container:e,title:n,titleTranslationKey:r,items:i=[],type:o="html",orientation:a="vertical",position:s="right",customPosition:h,maxItems:c=10,showValues:l=!0,className:f="",valueFormatter:u=z=>z.toLocaleString(),translateKeys:g={itemPrefix:"",othersLabel:"viz.others",countLabel:"viz.items"},responsive:m=!0,breakpoint:v=768,interactive:_=!1,onItemClick:p=()=>{},customProperties:$}=t;let k=n,w=null,b=[...i],y=null;function S(){if(!(e instanceof HTMLElement))return console.error("Container must be an HTMLElement for HTML legend"),null;if(w instanceof HTMLElement)w.innerHTML="";else{w=document.createElement("div");const q=m&&window.innerWidth<v;w.className=`legend ${q?"legend-mobile":"legend-desktop"} ${f}`.trim(),s==="custom"&&h?(w.style.position="absolute",w.style.left=`${h.x}px`,w.style.top=`${h.y}px`):w.classList.add(`legend-${s}`),e.appendChild(w)}const z=m&&window.innerWidth<v;let R="";if(r){const q=tt(r);typeof q=="string"?R=q:q.subscribe(X=>{R=X})()}else k&&(R=k);let V=[...b],st=null;if(c>0&&V.length>c){const q=V.slice(0,c),X=V.slice(c);st={key:"others",label:at(g.othersLabel||"viz.others"),color:"#999999",value:X.reduce((lt,rt)=>lt+(rt.value||0),0)},V=q}const O=R?`<div class="legend-heading${z?"-mobile":""}">${R}</div>`:"",U=z?"legend-grid-mobile":"legend-grid",Q=V.map(q=>{let X=q.label||q.key;if(g.itemPrefix){const F=`${g.itemPrefix}${q.key}`,M=at(F);M!==F&&(X=M)}const lt=z?"legend-color-mobile":"legend-color",rt=z?"legend-label-mobile":"legend-label",K=z?"legend-value-mobile":"legend-value",C=q.visible===!1?"opacity: 0.5; text-decoration: line-through;":"";return`
        <div class="${lt}" data-color="${q.color}" style="${C}"></div>
        <div class="${rt}" style="${C}">${X}</div>
        ${l&&q.value!==void 0?`<div class="${K}" style="${C}">${u(q.value)}</div>`:""}
      `}).join(""),G=st?`
      <div class="${z?"legend-color-mobile":"legend-color"}" data-color="${st.color}"></div>
      <div class="${z?"legend-label-mobile":"legend-label"}">${st.label}</div>
      ${l&&st.value!==void 0?`<div class="${z?"legend-value-mobile":"legend-value"}">${u(st.value)}</div>`:""}
    `:"";return w.innerHTML=`
      ${O}
      <div class="${U}">
        ${Q}
        ${G}
      </div>
    `,w.querySelectorAll("[data-color]").forEach(q=>{q.style.backgroundColor=q.dataset.color||""}),_&&w.querySelectorAll(`.${z?"legend-label-mobile":"legend-label"}`).forEach((X,lt)=>{lt<V.length&&(X.classList.add("cursor-pointer"),X.addEventListener("click",()=>p(V[lt],lt)))}),w}function L(){let z;e instanceof HTMLElement?z=ft(e):z=e,z.selectAll(`.legend${f?`.${f}`:""}`).remove();let R=10,V=10;if(s==="custom"&&h)R=h.x,V=h.y;else if(s==="right"){const lt=z.node();lt&&(R=lt.getBoundingClientRect().width-120)}else if(s==="bottom"){const lt=z.node();lt&&(V=lt.getBoundingClientRect().height-50)}const st=z.append("g").attr("class",`legend legend-${a} ${f}`.trim()).attr("transform",`translate(${R}, ${V})`);if(k||r){let lt="";if(r){const rt=tt(r);typeof rt=="string"?lt=rt:rt.subscribe(K=>{lt=K})()}else k&&(lt=k);st.append("text").attr("class","legend-title").attr("x",0).attr("y",-10).attr("font-size","var(--font-size-xs)").attr("fill","var(--color-text-secondary)").text(lt)}const O=a==="horizontal",U=20,Q=20,G=5,q=5,X=c>0&&b.length>c?b.slice(0,c):b;if(X.forEach((lt,rt)=>{const K=O?rt*(U+G*3+60):0,C=O?0:rt*(Q+G);let F=lt.label||lt.key;if(g.itemPrefix){const A=`${g.itemPrefix}${lt.key}`,H=at(A);H!==A&&(F=H)}const M=st.append("g").attr("class","legend-item").attr("transform",`translate(${K}, ${C})`);M.append("rect").attr("width",U).attr("height",Q).attr("fill",lt.color).attr("stroke",lt.visible===!1?"#999":"none").attr("stroke-width",lt.visible===!1?1:0).attr("opacity",lt.visible===!1?.5:1);const x=M.append("text").attr("x",U+q).attr("y",Q/2).attr("dy","0.35em").attr("fill","var(--color-text-primary)").attr("font-size","var(--font-size-sm)").text(F);if(l&&lt.value!==void 0){const A=O?U+q+T(x)+5:U+q,H=O?Q/2:Q/2+15;M.append("text").attr("x",A).attr("y",H).attr("dy","0.35em").attr("fill","var(--color-text-secondary)").attr("font-size","var(--font-size-xs)").text(u(lt.value))}if(_&&(M.attr("class","legend-item cursor-pointer").attr("role","button").style("cursor","pointer").on("click",()=>p(lt,rt)),lt.visible===!1)){const A=x.node();if(A){const H=A.getComputedTextLength();M.append("line").attr("x1",U+q).attr("y1",Q/2).attr("x2",U+q+H).attr("y2",Q/2).attr("stroke","var(--color-text-primary)").attr("stroke-width",1)}}}),c>0&&b.length>c){const rt=b.slice(c).reduce((x,A)=>x+(A.value||0),0),K=O?X.length*(U+G*3+60):0,C=O?0:X.length*(Q+G),F=st.append("g").attr("class","legend-item").attr("transform",`translate(${K}, ${C})`);F.append("rect").attr("width",U).attr("height",Q).attr("fill","#999999");const M=at(g.othersLabel||"viz.others");F.append("text").attr("x",U+q).attr("y",Q/2).attr("dy","0.35em").attr("fill","var(--color-text-primary)").attr("font-size","var(--font-size-sm)").text(M),l&&F.append("text").attr("x",O?U+q+M.length*8+5:U+q).attr("y",O?Q/2:Q/2+15).attr("dy","0.35em").attr("fill","var(--color-text-secondary)").attr("font-size","var(--font-size-xs)").text(u(rt))}return w=st,st}function B(){let z;e instanceof HTMLElement?z=ft(e):z=e,z.selectAll(`.legend${f?`.${f}`:""}`).remove();let R=10,V=10;if(s==="custom"&&h)R=h.x,V=h.y;else if(s==="right"){const G=z.node();G&&(R=G.getBoundingClientRect().width-120)}const st=z.append("g").attr("class",`legend legend-${a} ${f}`.trim()).attr("transform",`translate(${R}, ${V})`);if(k||r){let G="";if(r){const q=tt(r);typeof q=="string"?G=q:q.subscribe(X=>{G=X})()}else k&&(G=k);st.append("text").attr("class","legend-title").attr("x",0).attr("y",-10).attr("font-size","var(--font-size-xs)").attr("fill","var(--color-text-secondary)").text(G)}const O=20,U=20,Q=5;return b.forEach((G,q)=>{var K,C;const X=q*U;let lt=G.label||G.key;if(g.itemPrefix){const F=`${g.itemPrefix}${G.key}`,M=at(F);M!==F&&(lt=M)}const rt=st.append("g").attr("class","legend-item").attr("transform",`translate(0, ${X})`);if(rt.append("line").attr("x1",0).attr("y1",0).attr("x2",O).attr("y2",0).attr("stroke",G.color).attr("stroke-width",2).attr("stroke-dasharray",((K=G.customProperties)==null?void 0:K.dashArray)||"none"),(C=G.customProperties)!=null&&C.marker&&rt.append("circle").attr("cx",O).attr("cy",0).attr("r",3).attr("fill",G.color),rt.append("text").attr("x",O+Q+5).attr("y",0).attr("dy","0.35em").attr("fill","var(--color-text-primary)").attr("font-size","var(--font-size-sm)").attr("class","legend-item-label").text(lt),_&&(rt.attr("class","legend-item cursor-pointer").attr("role","button").style("cursor","pointer").on("click",()=>p(G,q)),G.visible===!1)){const F=lt.length*6;rt.append("line").attr("x1",O+Q+5).attr("y1",0).attr("x2",O+Q+5+F).attr("y2",0).attr("stroke","var(--color-text-primary)").attr("stroke-width",1)}}),w=st,st}function T(z){const R=z.node();return R?R.getComputedTextLength():0}function E(){var z;o==="html"?S():o==="svg"&&(((z=t.customProperties)==null?void 0:z.lineChart)===!0?B():L()),m&&!y&&(y=()=>{const R=w instanceof HTMLElement&&w.classList.contains("legend-mobile"),V=window.innerWidth<v;R!==V&&E()},window.addEventListener("resize",y))}function I(z,R){b=[...z],R!==void 0&&(k=R),E()}function P(z,R){b=b.map(st=>st.key===z?{...st,visible:R}:st),E()}function W(){return w}function J(){y&&(window.removeEventListener("resize",y),y=null),w instanceof HTMLElement&&w.parentNode&&w.parentNode.removeChild(w),e&&o==="svg"&&(e instanceof HTMLElement?ft(e).selectAll(`.legend${f?`.${f}`:""}`).remove():e.selectAll(`.legend${f?`.${f}`:""}`).remove()),w=null}return{render:E,update:I,updateVisibility:P,getLegendElement:W,cleanup:J}}const U0={top:20,right:30,bottom:40,left:50};function H0(t){const{container:e,width:n=e.clientWidth,height:r=e.clientHeight,margin:i=U0,className:o="d3-visualization",responsive:a=!0}=t;ft(e).select("svg").remove();const s=ft(e).append("svg").attr("width",n).attr("height",r).attr("class",o);a&&s.attr("viewBox",`0 0 ${n} ${r}`).attr("preserveAspectRatio","xMidYMid meet");const h=s.append("g").attr("transform",`translate(${i.left}, ${i.top})`);return{svg:s,chart:h,width:n,height:r,margin:i,chartWidth:n-i.left-i.right,chartHeight:r-i.top-i.bottom}}function B0(t){const{type:e,domain:n,range:r,padding:i=.1,nice:o=!0}=t;let a;switch(e){case"linear":a=ui().domain(n).range(r);break;case"log":a=Mc().domain(n).range(r);break;case"time":a=Dc().domain(n).range(r);break;case"ordinal":a=Ce().domain(n).range(r);break;case"band":a=Fa().domain(n).range(r).padding(i);break;default:throw new Error(`Unsupported scale type: ${e}`)}return o&&["linear","time","log"].includes(e)&&a.nice(),a}function O0(t){const{type:e,scale:n,position:r=e==="x"?"bottom":"left",ticks:i,tickFormat:o,tickSize:a,tickPadding:s,rotate:h}=t;let c;if(r==="bottom")c=qi(n);else if(r==="top")c=td(n);else if(r==="left")c=Yi(n);else if(r==="right")c=ed(n);else throw new Error(`Unsupported axis position: ${r}`);return i!==void 0&&c.ticks(i),o!==void 0&&c.tickFormat(o),a!==void 0&&c.tickSize(a),s!==void 0&&c.tickPadding(s),{axis:c,rotate:h}}function W0(t,e){const{axis:n,rotate:r}=e;t.call(n),r&&t.selectAll("text").style("text-anchor",r<0?"end":r>0?"start":"middle").attr("dx",r<0?"-0.8em":r>0?"0.8em":"0").attr("dy",r!==0?"0.15em":"0.71em").attr("transform",`rotate(${r})`)}function V0(t,e="categorical"){if(e==="categorical")return Ce().domain(t).range(on);if(e==="sequential")return ca(Kv).domain([0,t.length-1]);if(e==="diverging")return ca(Yv).domain([0,t.length-1]);throw new Error(`Unsupported color range type: ${e}`)}function q0(t,e,n="chart-title"){t.append("text").attr("class",n).attr("x",t.attr("width")?parseInt(t.attr("width"))/2:0).attr("y",20).attr("text-anchor","middle").text(e)}function Y0(t,e,n={}){const{position:r={x:10,y:10},orientation:i="horizontal",itemWidth:o=20,itemHeight:a=20,itemMargin:s=5,className:h="legend",width:c=300}=n,l=t.append("g").attr("class",h).attr("transform",`translate(${r.x}, ${r.y})`),f=i==="horizontal"?"legend-horizontal":"legend-vertical";l.classed(f,!0);const u=i==="horizontal",g=l.append("g").attr("class","legend-items");if(h.includes("multi-row-legend")){const _=Math.floor(((c||300)-r.x-20)/(o+s*4)),p=Math.max(3,_);e.forEach(($,k)=>{const w=Math.floor(k/p),y=k%p*(o+s*4),S=w*(a+s*2),L=g.append("g").attr("class","legend-item").attr("transform",`translate(${y}, ${S})`);L.append("rect").attr("class","legend-item-swatch").attr("width",o).attr("height",a).attr("fill",$.color),L.append("text").attr("class","legend-item-label").attr("x",o+s).attr("y",a/2).attr("dy","0.35em").text($.key)})}else e.forEach((v,_)=>{const p=u?_*(o+s*3):0,$=u?0:_*(a+s),k=g.append("g").attr("class","legend-item").attr("transform",`translate(${p}, ${$})`);k.append("rect").attr("class","legend-item-swatch").attr("width",o).attr("height",a).attr("fill",v.color),k.append("text").attr("class","legend-item-label").attr("x",o+s).attr("y",a/2).attr("dy","0.35em").text(v.key)});return l}function nl(t,e){return"ticks"in t&&typeof t.ticks=="function"?t.ticks(e):"domain"in t&&typeof t.domain=="function"?t.domain():[]}function G0(t,e){const{width:n,height:r,xScale:i,yScale:o,xTicks:a=10,yTicks:s=10,className:h="grid"}=e,c=t.append("g").attr("class",h);if(i){const l=nl(i,a);c.append("g").attr("class","grid-x").selectAll("line").data(l).enter().append("line").attr("x1",f=>i(f)).attr("x2",f=>i(f)).attr("y1",0).attr("y2",r).attr("stroke","#e0e0e0").attr("stroke-dasharray","3,3")}if(o){const l=nl(o,s);c.append("g").attr("class","grid-y").selectAll("line").data(l).enter().append("line").attr("x1",0).attr("x2",n).attr("y1",f=>o(f)).attr("y2",f=>o(f)).attr("stroke","#e0e0e0").attr("stroke-dasharray","3,3")}return c}function K0(t=500,e=_c){return vc().duration(t).ease(e)}function X0(t){const e=parseInt(t.attr("width")),n=parseInt(t.attr("height"));t.attr("viewBox",`0 0 ${e} ${n}`).attr("preserveAspectRatio","xMidYMid meet").attr("width","100%").attr("height","100%")}function Z0(t,e="No data available",n="absolute inset-center text-secondary z-50"){ft(t).select("svg").remove(),ft(t).selectAll(`.${n.split(" ")[0]}`).remove(),ft(t).append("div").attr("class",n).text(e)}function J0(t="visualization-tooltip",e={}){return ft(`.${t}`).remove(),ft("body").append("div").attr("class",t).style("position","absolute").style("pointer-events","none").style("opacity",0).style("background",e.background||"rgba(0, 0, 0, 0.8)").style("color",e.color||"white").style("padding",e.padding||"8px 12px").style("border-radius",e.borderRadius||"4px").style("font-size",e.fontSize||"12px").style("z-index",e.zIndex||"1000").style("box-shadow",e.boxShadow||"0 2px 5px rgba(0,0,0,0.2)")}const ue={createSVG:H0,createScale:B0,createAxis:O0,renderAxis:W0,createColorScale:V0,addTitle:q0,createLegend:Y0,addGrid:G0,createTransition:K0,makeResponsive:X0,handleNoData:Z0,createTooltipContainer:J0},Q0={margin:{top:20,right:20,bottom:20,left:20},innerRadius:0,responsive:!0,colorScheme:on,animationDuration:500,hoverEffectEnabled:!0,hoverRadiusIncrease:10,showLegend:!0,legendPosition:"right",showLabels:!1,labelMinAngle:15,sortValues:!1,sortDescending:!0};function j0(t,e){const n={...Q0,...e},{container:r,width:i=r.clientWidth,height:o=r.clientHeight,margin:a={top:20,right:20,bottom:20,left:20},innerRadius:s=0,responsive:h=!0,animationDuration:c=500,hoverEffectEnabled:l=!0,hoverRadiusIncrease:f=10,showLabels:u=!1,labelMinAngle:g=15,sortValues:m=!1,sortDescending:v=!0}=n;ft(r).select("svg").remove();let _=[...t];m&&_.sort((z,R)=>v?R.value-z.value:z.value-R.value);const{svg:p,chartWidth:$,chartHeight:k}=ue.createSVG({container:r,width:i,height:o,margin:a,responsive:h}),b=Math.min($,k)/2*.9,y=l0().value(z=>z.value);m||y.sort(null);const S=Po().innerRadius(s*b).outerRadius(b),L=Po().innerRadius(s*b).outerRadius(b+f),B=Po().innerRadius(b*.7).outerRadius(b*.7);let T;if(typeof n.colorScheme=="function")T=n.colorScheme;else{const z=Ce().domain(_.map(R=>R.key)).range(n.colorScheme||on);T=R=>z(R)}const E=p.append("g").attr("transform",`translate(${i/2}, ${o/2})`),I=y(_),P=E.selectAll("path").data(I).enter().append("path").attr("class","pie-segment cursor-pointer").attr("d",S).attr("fill",z=>T(z.data.key)).attr("stroke","white").attr("stroke-width",2);if(l&&P.on("mouseenter",function(z,R){ft(this).transition().duration(200).attr("d",L),n.onMouseEnter&&n.onMouseEnter(z,R)}).on("mousemove",function(z,R){n.onMouseMove&&n.onMouseMove(z,R)}).on("mouseleave",function(z,R){ft(this).transition().duration(200).attr("d",S),n.onMouseLeave&&n.onMouseLeave(z,R)}),u&&E.selectAll("text").data(I).enter().append("text").attr("transform",z=>(z.endAngle-z.startAngle)*(180/Math.PI)>=g?`translate(${B.centroid(z)})`:"").attr("dy","0.35em").attr("text-anchor","middle").text(z=>z.data.key).style("font-size","12px").style("fill","var(--color-text-primary, #333)").style("opacity",z=>(z.endAngle-z.startAngle)*(180/Math.PI)>=g?1:0),n.showLegend){_.map(rt=>({key:rt.key,color:T(rt.key),value:rt.value,percentage:rt.percentage}));const z=i<768,R=z?{width:$,height:100}:{width:180,height:k};z?E.attr("transform",`translate(${i/2}, ${(o-R.height)/2})`):n.legendPosition==="right"&&E.attr("transform",`translate(${(i-R.width)/2}, ${o/2})`);const V=z?a.left:i-R.width,st=z?o-R.height:a.top+20,O=p.append("g").attr("class","legend").attr("transform",`translate(${V}, ${st})`);n.legendTitle&&O.append("text").attr("class","legend-title").attr("x",0).attr("y",z?0:-5).attr("font-size","14px").attr("font-weight","bold").attr("fill","var(--color-text-primary, #333)").text(n.legendTitle);const U=15,Q=z?20:25,G=5,q=z?6:12;let X=z?Math.floor($/120):1;if(X=Math.max(1,X),_.slice(0,q).forEach((rt,K)=>{var j;const C=Math.floor(K/X),F=K%X,M=z?F*($/X):0,x=(z?20:0)+C*Q,A=O.append("g").attr("class","legend-item").attr("transform",`translate(${M}, ${x})`);A.append("rect").attr("width",U).attr("height",U).attr("fill",T(rt.key)).attr("stroke","var(--color-border, #e2e8f0)").attr("stroke-width",.5).attr("rx",2);const H=rt.label||rt.key;if(A.append("text").attr("x",U+G).attr("y",U/2).attr("dy","0.35em").attr("fill","var(--color-text-primary, #333)").attr("font-size","12px").attr("font-family","var(--font-family-base, sans-serif)").text(H),rt.value!==void 0){const dt=z?rt.value.toLocaleString():`${rt.value.toLocaleString()} (${(j=rt.percentage)==null?void 0:j.toFixed(1)}%)`;z?A.append("text").attr("x",U+G+H.length*7+10).attr("y",U/2).attr("dy","0.35em").attr("text-anchor","start").attr("fill","var(--color-text-secondary, #666)").attr("font-size","11px").attr("font-family","var(--font-family-base, sans-serif)").text(`(${rt.value.toLocaleString()})`):A.append("text").attr("x",U+G).attr("y",U/2+14).attr("fill","var(--color-text-secondary, #666)").attr("font-size","11px").attr("font-family","var(--font-family-base, sans-serif)").text(dt)}}),_.length>q){const rt=_.length-q,K=Math.floor(q/X),C=q%X,F=z?C*($/X):0,M=(z?20:0)+K*Q;O.append("text").attr("x",F+(z?0:U+G)).attr("y",M+(z?0:U/2)).attr("fill","var(--color-text-secondary, #666)").attr("font-size","11px").attr("font-style","italic").attr("font-family","var(--font-family-base, sans-serif)").text(`+${rt} more...`)}}return{svg:p,pieGroup:E,update:z=>{let R=[...z];if(m&&R.sort((O,U)=>v?U.value-O.value:O.value-U.value),typeof n.colorScheme!="function"){const O=Ce().domain(R.map(U=>U.key)).range(n.colorScheme||on);T=U=>O(U)}const V=y(R),st=E.selectAll("path").data(V);if(st.exit().transition().duration(c).attrTween("d",function(O){const U=O,Q=U.endAngle,G={...U,startAngle:Q,endAngle:Q},q=Tr(U,G);return function(X){return S(q(X))}}).remove(),st.enter().append("path").attr("class","pie-segment cursor-pointer").attr("fill",O=>T(O.data.key)).attr("stroke","white").attr("stroke-width",2).attr("d",S).style("opacity",0).transition().duration(c).style("opacity",1),st.transition().duration(c).attrTween("d",function(O){const Q=this.__data__,G=Tr(Q,O);return function(q){return S(G(q))}}).attr("fill",O=>T(O.data.key)),l&&E.selectAll("path").on("mouseenter",function(O,U){ft(this).transition().duration(200).attr("d",L),n.onMouseEnter&&n.onMouseEnter(O,U)}).on("mousemove",function(O,U){n.onMouseMove&&n.onMouseMove(O,U)}).on("mouseleave",function(O,U){ft(this).transition().duration(200).attr("d",S),n.onMouseLeave&&n.onMouseLeave(O,U)}),u){const O=E.selectAll("text").data(V);O.exit().remove(),O.enter().append("text").attr("dy","0.35em").attr("text-anchor","middle").style("font-size","12px").style("fill","var(--color-text-primary, #333)").merge(O).transition().duration(c).attr("transform",U=>(U.endAngle-U.startAngle)*(180/Math.PI)>=g?`translate(${B.centroid(U)})`:"").text(U=>U.data.key).style("opacity",U=>(U.endAngle-U.startAngle)*(180/Math.PI)>=g?1:0)}if(n.showLegend){p.select(".legend").remove();const O=i<768,U=O?{width:$,height:100}:{width:180,height:k};O?E.attr("transform",`translate(${i/2}, ${(o-U.height)/2})`):n.legendPosition==="right"&&E.attr("transform",`translate(${(i-U.width)/2}, ${o/2})`);const Q=O?a.left:i-U.width,G=O?o-U.height:a.top+20,q=p.append("g").attr("class","legend").attr("transform",`translate(${Q}, ${G})`);n.legendTitle&&q.append("text").attr("class","legend-title").attr("x",0).attr("y",O?0:-5).attr("font-size","14px").attr("font-weight","bold").attr("fill","var(--color-text-primary, #333)").text(n.legendTitle);const X=15,lt=O?20:25,rt=5,K=O?6:12;let C=O?Math.floor($/120):1;if(C=Math.max(1,C),R.slice(0,K).forEach((M,x)=>{var nt;const A=Math.floor(x/C),H=x%C,j=O?H*($/C):0,dt=(O?20:0)+A*lt,ot=q.append("g").attr("class","legend-item").attr("transform",`translate(${j}, ${dt})`);ot.append("rect").attr("width",X).attr("height",X).attr("fill",T(M.key)).attr("stroke","var(--color-border, #e2e8f0)").attr("stroke-width",.5).attr("rx",2);const Z=M.label||M.key;if(ot.append("text").attr("x",X+rt).attr("y",X/2).attr("dy","0.35em").attr("fill","var(--color-text-primary, #333)").attr("font-size","12px").attr("font-family","var(--font-family-base, sans-serif)").text(Z),M.value!==void 0){const At=O?M.value.toLocaleString():`${M.value.toLocaleString()} (${(nt=M.percentage)==null?void 0:nt.toFixed(1)}%)`;O?ot.append("text").attr("x",X+rt+Z.length*7+10).attr("y",X/2).attr("dy","0.35em").attr("text-anchor","start").attr("fill","var(--color-text-secondary, #666)").attr("font-size","11px").attr("font-family","var(--font-family-base, sans-serif)").text(`(${M.value.toLocaleString()})`):ot.append("text").attr("x",X+rt).attr("y",X/2+14).attr("fill","var(--color-text-secondary, #666)").attr("font-size","11px").attr("font-family","var(--font-family-base, sans-serif)").text(At)}}),R.length>K){const M=R.length-K,x=Math.floor(K/C),A=K%C,H=O?A*($/C):0,j=(O?20:0)+x*lt;q.append("text").attr("x",H+(O?0:X+rt)).attr("y",j+(O?0:X/2)).attr("fill","var(--color-text-secondary, #666)").attr("font-size","11px").attr("font-style","italic").attr("font-family","var(--font-family-base, sans-serif)").text(`+${M} more...`)}}},destroy:()=>{r&&ft(r).select("svg").remove()}}}function ty(t,e){return j0(t,{...e,innerRadius:e.innerRadius===void 0?.5:e.innerRadius})}var ey=yt("<option> </option>"),ny=yt("<option> </option>"),ry=yt("<span> </span>"),iy=yt('<div class="absolute inset-center text-secondary"> </div>'),oy=yt('<div class="absolute inset-center text-error"> </div>'),ay=yt('<div class="flex flex-wrap gap-md p-md bg-card rounded-t border-b border-solid border-default filters svelte-1chk83o"><div class="flex flex-col gap-xs filter-group svelte-1chk83o"><label for="country-filter" class="text-xs font-bold text-secondary"> </label> <select id="country-filter" class="p-xs px-sm rounded-sm border border-solid border-default bg-card text-primary"></select></div> <div class="flex flex-col gap-xs filter-group svelte-1chk83o"><label for="type-filter" class="text-xs font-bold text-secondary"> </label> <select id="type-filter" class="p-xs px-sm rounded-sm border border-solid border-default bg-card text-primary"></select></div> <div class="flex flex-col gap-xs filter-group svelte-1chk83o"><label for="chart-type" class="text-xs font-bold text-secondary"> </label> <div class="flex items-center"><button class="p-xs px-sm rounded-sm border border-solid border-default bg-card text-primary hover:bg-hover"> </button></div></div> <div class="ml-auto flex items-end text-sm text-secondary summary svelte-1chk83o"><!></div></div> <div class="chart-container svelte-1chk83o"><!></div>',1),sy=yt('<div class="w-full h-full flex flex-col language-visualization-container"><!></div>');function ly(t,e){we(e,!1);const[n,r]=je(),i=()=>mt(fe,"$itemsStore",n),o=()=>mt(O,"$toggleLanguagesText",n),a=()=>mt(_e,"$languageStore",n),s=()=>mt(V,"$filterByCountryText",n),h=()=>mt(st,"$filterByTypeText",n);let c=vt("all"),l=vt("all"),f=vt(!0),u=vt([]),g=vt([]),m=vt([]),v=vt(0),_="en",p=vt(""),$=[],k=0,w=0,b=vt(),y=null,S=vt(),L;const{groupAndCount:B}=Je({filterMissingValues:!0,requiredFields:["language"],filterFn:A=>!(d(c)!=="all"&&A.country!==d(c)||d(l)!=="all"&&A.type!==d(l)),calculatePercentages:!0,sortByCount:!0,sortDescending:!0}),T=Je({filterMissingValues:!0,requiredFields:["language","country"],filterFn:A=>d(l)==="all"||A.type===d(l)}),E=Je({filterMissingValues:!0,requiredFields:["language","type"],filterFn:A=>d(c)==="all"||A.country===d(c)});let I,P,W=vt(!1);const J=Ce(on);let z=new Map;function R(A){if(z.has(A))return z.get(A);const H=J(A);return z.set(A,H),H}tt("viz.all_countries"),tt("viz.all_types");const V=tt("viz.filter_by_country"),st=tt("viz.filter_by_type");tt("viz.no_data");const O=tt("viz.toggle_languages");tt("viz.showing_items",{0:U(d(v)),1:U(d(u).length)}),tt("viz.items"),tt("viz.percent_of_total");function U(A){return A.toLocaleString(_==="fr"?"fr-FR":"en-US")}function Q(A){const H=U(A);return at("viz.language_distribution_items",{0:H})}function G(){d(v)>0?D(p,Q(d(v))):D(p,at("viz.language_distribution_title"))}qe(()=>(D(W,!0),(async()=>{try{if(await kn(),!d(b)){console.error("Container element not found in onMount");return}if(L=Dr({container:d(b),onResize:()=>{if(d(W)&&d(b)){const{width:A,height:H}=L.dimensions;k=A,w=H,rt()}}}),I=_e.subscribe(A=>{d(W)&&(_=A,d(b)&&(G(),i().items&&i().items.length>0&&rt()))}),i().items&&i().items.length>0){const{width:A,height:H}=L.dimensions;k=A,w=H,await kn(),d(b)&&rt()}else fe.loadItems()}catch(A){console.error("Error during initialization:",A)}})(),()=>{try{D(W,!1),L&&L.cleanup(),I&&I(),P&&(P.cleanup(),P=null),y&&(y.destroy(),y=null),d(b)&&ft(d(b)).selectAll("*").remove()}catch(A){console.error("Error during cleanup:",A)}})),In(()=>{try{D(W,!1),L&&L.cleanup(),I&&I(),P&&(P.cleanup(),P=null),d(b)&&ft(d(b)).selectAll("*").remove()}catch(A){console.error("Error during cleanup:",A)}});function q(){if(!i().items||i().items.length===0)return;const H=B(i().items,j=>j.language||"Unknown").map(j=>({language:j.key,count:j.count,percentage:j.percentage||0}));return H.forEach(j=>{z.has(j.language)||z.set(j.language,J(j.language))}),D(v,H.reduce((j,dt)=>j+dt.count,0)),G(),H}function X(){if(!i().items||i().items.length===0)return;const A=at("viz.all_countries"),H=at("viz.all_types"),j=T.filterItems(i().items),dt=E.filterItems(i().items),ot=T.groupAndCount(j,nt=>nt.country||"Unknown");D(g,[{value:"all",label:A,count:j.length},...ot.filter(nt=>nt.key!=="Unknown").map(nt=>{const At=at(`country.${nt.key}`)||nt.key;return{value:nt.key,label:At,count:nt.count}}).sort((nt,At)=>At.count-nt.count)]);const Z=E.groupAndCount(dt,nt=>nt.type||"Unknown");D(m,[{value:"all",label:H,count:dt.length},...Z.map(nt=>({value:nt.key,label:nt.key,count:nt.count})).sort((nt,At)=>At.count-nt.count)])}function lt(A,H){var Z;if(!d(S))return;const j=H.data,dt=at(`lang.${j.key}`)||j.key,ot=wn(dt,[{label:at("viz.items"),value:U(j.value)},{label:at("viz.percent_of_total"),value:`${((Z=j.percentage)==null?void 0:Z.toFixed(2))||0}%`}]);d(S).showTooltip(A,ot)}function rt(){if(!d(b))return;const A=q();if(D(u,A||[]),!A||A.length===0){y&&(y.destroy(),y=null),P&&(P.cleanup(),P=null),ue.handleNoData(d(b),at("viz.no_data"));return}if($.length===0)$=A.map(Z=>({language:Z.language,visible:!0}));else{const Z=$.map(nt=>nt.language);A.forEach(nt=>{Z.includes(nt.language)||$.push({language:nt.language,visible:!0})})}const H=A.filter(Z=>{const nt=$.find(At=>At.language===Z.language);return(nt==null?void 0:nt.visible)??!0}).map(Z=>({key:Z.language,label:at(`lang.${Z.language}`)||Z.language,value:Z.count,percentage:Z.percentage}));if(H.length===0){y&&(y.destroy(),y=null),P&&(P.cleanup(),P=null),ue.handleNoData(d(b),at("viz.no_data"));return}y&&(y.destroy(),y=null),P&&(P.cleanup(),P=null);const j=d(b).getBoundingClientRect();k=j.width,w=j.height;const dt=k<768,ot=dt?{top:10,right:10,bottom:50,left:10}:{top:20,right:20,bottom:20,left:20};if(y=ty(H,{container:d(b),width:k,height:w,margin:ot,innerRadius:d(f)?.5:0,responsive:!0,colorScheme:Z=>R(Z),hoverEffectEnabled:!0,hoverRadiusIncrease:dt?5:10,showLegend:!1,showLabels:!1,sortValues:!0,sortDescending:!0,onMouseEnter:lt,onMouseMove:lt,onMouseLeave:()=>d(S).hideTooltip()}),y){const Z=A.map(Ft=>{var Yt;const le=((Yt=$.find(te=>te.language===Ft.language))==null?void 0:Yt.visible)??!0;return{key:Ft.language,label:at(`lang.${Ft.language}`)||Ft.language,color:R(Ft.language),value:Ft.count,visible:le,customProperties:{language:Ft.language}}});P=Uc({container:d(b),title:o(),items:Z,type:"html",position:"bottom",orientation:"horizontal",className:"multi-row-legend",showValues:!0,valueFormatter:Ft=>U(Ft),translateKeys:{itemPrefix:"lang."},responsive:!0,breakpoint:768,interactive:!0,onItemClick:Ft=>{const le=$.findIndex(Yt=>{var te;return Yt.language===((te=Ft.customProperties)==null?void 0:te.language)});le>=0&&($[le].visible=!$[le].visible,$=[...$],rt())}}),P.render();const At=Math.ceil(A.length/5)*22+30,Wt=ft(d(b)).select("svg");Wt.empty()||Wt.attr("height",w+At+30)}}function K(A){const H=A.target;D(c,H.value),X(),rt()}function C(A){const H=A.target;D(l,H.value),X(),rt()}function F(){D(f,!d(f)),rt()}ge(()=>{},()=>{G()}),ge(()=>(d(W),i(),d(b)),()=>{d(W)&&i().items&&d(b)&&rt()}),ge(()=>(a(),d(c),d(l),i()),()=>{(a()||d(c)||d(l))&&i().items&&i().items.length>0&&X()}),hi(),ke();var M=sy(),x=N(M);We(Lr(x,{get titleHtml(){return d(p)},descriptionTranslationKey:"viz.language_distribution_description",theme:"default",className:"language-visualization",children:(A,H)=>{var j=ay(),dt=Qt(j),ot=N(dt),Z=N(ot),nt=N(Z),At=pt(Z,2);kt(()=>{d(c),Za(()=>{d(g)})}),Hn(At,5,()=>d(g),it=>it.value,(it,xt)=>{var bt=ey(),gt={},Ut=N(bt);kt(It=>{gt!==(gt=d(xt).value)&&(bt.value=(bt.__value=d(xt).value)==null?"":d(xt).value),ut(Ut,`${d(xt).label??""} (${It??""})`)},[()=>U(d(xt).count)],re),et(it,bt)});var Wt=pt(ot,2),Ft=N(Wt),le=N(Ft),Yt=pt(Ft,2);kt(()=>{d(l),Za(()=>{d(m)})}),Hn(Yt,5,()=>d(m),it=>it.value,(it,xt)=>{var bt=ny(),gt={},Ut=N(bt);kt(It=>{gt!==(gt=d(xt).value)&&(bt.value=(bt.__value=d(xt).value)==null?"":d(xt).value),ut(Ut,`${d(xt).label??""} (${It??""})`)},[()=>U(d(xt).count)],re),et(it,bt)});var te=pt(Wt,2),ct=N(te),zt=N(ct),ht=pt(ct,2),_t=N(ht),$t=N(_t),Ct=pt(te,2),Rt=N(Ct);{var Ot=it=>{var xt=ry(),bt=N(xt);kt(gt=>ut(bt,gt),[()=>at("viz.showing_items",{0:U(d(v)),1:d(u).length.toString()})],re),et(it,xt)};Dt(Rt,it=>{d(u).length>0&&it(Ot)})}var Bt=pt(dt,2),Mt=N(Bt);{var Et=it=>{var xt=iy(),bt=N(xt);kt(gt=>ut(bt,gt),[()=>at("ui.loading")],re),et(it,xt)},Y=it=>{var xt=ae(),bt=Qt(xt);{var gt=Ut=>{var It=oy(),Pt=N(It);kt(()=>ut(Pt,i().error)),et(Ut,It)};Dt(bt,Ut=>{i().error&&Ut(gt)},!0)}et(it,xt)};Dt(Mt,it=>{i().loading?it(Et):it(Y,!1)})}We(Bt,it=>D(b,it),()=>d(b)),kt((it,xt)=>{ut(nt,`${s()??""}:`),ut(le,`${h()??""}:`),ut(zt,`${it??""}:`),ut($t,xt)},[()=>at("viz.chart_type"),()=>d(f)?at("viz.pie_chart"):at("viz.donut_chart")],re),ye("change",At,K),rs(At,()=>d(c),it=>D(c,it)),ye("change",Yt,C),rs(Yt,()=>d(l),it=>D(l,it)),ye("click",_t,F),et(A,j)},$$slots:{default:!0},$$legacy:!0}),A=>D(S,A),()=>d(S)),et(t,M),Te(),r()}function cy(t){const{container:e,width:n=e.clientWidth,height:r=e.clientHeight,data:i,keyField:o="key",valueField:a="value",className:s="bar-chart",barPadding:h=.2,barCornerRadius:c=3,barStroke:l="white",barStrokeWidth:f=1,margin:u={top:20,right:30,bottom:60,left:50},responsive:g=!0,isMobile:m=!1,showXAxis:v=!0,showYAxis:_=!0,xAxisLabel:p,yAxisLabel:$,xAxisRotation:k=-45,xAxisTickFormat:w,yAxisTickFormat:b,xAxisTicks:y,yAxisTicks:S=5,showValueLabels:L=!0,valueLabelMinHeight:B=15,valueFormatter:T=K=>K.toString(),enableInteraction:E=!0,highlightColor:I,onBarMouseEnter:P,onBarMouseMove:W,onBarMouseLeave:J,onBarClick:z}=t;let R;t.barColors?Array.isArray(t.barColors)?R=Ce().domain(i.map(K=>K[t.keyField||"key"])).range(t.barColors):R=t.barColors:R=Ce(on);const V=br(i,K=>K[a])||0,{svg:st,chart:O,chartWidth:U,chartHeight:Q}=ue.createSVG({container:e,width:n,height:r,margin:u,className:s,responsive:g}),G=ue.createScale({type:"band",domain:i.map(K=>K[o]),range:[0,U],padding:m?Math.min(h,.1):h}),q=ue.createScale({type:"linear",domain:[0,V*1.1],range:[Q,0]});if(v){const K=ue.createAxis({type:"x",scale:G,position:"bottom",tickFormat:w,ticks:y,rotate:k});O.append("g").attr("class","x-axis").attr("transform",`translate(0, ${Q})`).call(C=>ue.renderAxis(C,K)).selectAll("text").attr("font-size",m?"8px":"var(--font-size-xs)").attr("fill","var(--color-text-primary)"),p&&O.append("text").attr("class","x-axis-label").attr("text-anchor","middle").attr("x",U/2).attr("y",Q+(m?u.bottom*.6:u.bottom*.7)).text(p)}if(_){const K=ue.createAxis({type:"y",scale:q,position:"left",tickFormat:b,ticks:m?Math.min(S,3):S});O.append("g").attr("class","y-axis").call(C=>ue.renderAxis(C,K)).selectAll("text").attr("font-size",m?"8px":"var(--font-size-xs)").attr("fill","var(--color-text-primary)"),$&&O.append("text").attr("class","y-axis-label").attr("text-anchor","middle").attr("transform","rotate(-90)").attr("x",-Q/2).attr("y",m?-u.left+12:-u.left+15).text($)}const X=O.selectAll(".bar").data(i).enter().append("rect").attr("class","bar").attr("x",K=>G(K[o])||0).attr("y",K=>q(K[a])).attr("width",G.bandwidth()).attr("height",K=>Math.max(0,Q-q(K[a]))).attr("fill",K=>R(K.originalKey||K[o])).attr("rx",m?Math.min(c,2):c).attr("ry",m?Math.min(c,2):c).attr("stroke",l).attr("stroke-width",m?f/2:f);E&&X.classed("cursor-pointer",!0).on("mouseenter",function(K,C){const F=this;if(I)ft(F).transition().duration(200).attr("fill",I);else{const M=R(C.originalKey||C[o]);ft(F).transition().duration(200).attr("fill",Re(M).brighter(.5).toString())}P&&P(K,C,F)}).on("mousemove",function(K,C){W&&W(K,C,this)}).on("mouseleave",function(K,C){const F=this;ft(F).transition().duration(200).attr("fill",R(C.originalKey||C[o])),J&&J(K,C,F)}).on("click",function(K,C){z&&z(K,C,this)}),L&&O.selectAll(".bar-label").data(i).enter().append("text").attr("class","bar-label").attr("x",K=>(G(K[o])||0)+G.bandwidth()/2).attr("y",K=>q(K[a])-5).attr("text-anchor","middle").attr("font-size",m?"8px":"var(--font-size-xs)").attr("fill","var(--color-text-secondary)").attr("display",K=>Q-q(K[a])<B&&m?"none":"block").text(K=>T(K[a]));function lt(K){G.domain(K.map(x=>x[o]));const C=br(K,x=>x[a])||0;if(q.domain([0,C*1.1]),v){const x=O.select(".x-axis"),A=ue.createAxis({type:"x",scale:G,position:"bottom",tickFormat:w,ticks:y,rotate:k});x.transition().duration(500).call(H=>ue.renderAxis(H,A))}if(_){const x=O.select(".y-axis"),A=ue.createAxis({type:"y",scale:q,position:"left",tickFormat:b,ticks:m?Math.min(S,3):S});x.transition().duration(500).call(H=>ue.renderAxis(H,A))}const F=O.selectAll(".bar").data(K);F.exit().transition().duration(300).attr("y",Q).attr("height",0).remove();const M=F.enter().append("rect").attr("class","bar").attr("x",x=>G(x[o])||0).attr("y",Q).attr("width",G.bandwidth()).attr("height",0).attr("fill",x=>R(x.originalKey||x[o])).attr("rx",m?Math.min(c,2):c).attr("ry",m?Math.min(c,2):c).attr("stroke",l).attr("stroke-width",m?f/2:f);if(E&&M.classed("cursor-pointer",!0).on("mouseenter",function(x,A){const H=this;if(I)ft(H).transition().duration(200).attr("fill",I);else{const j=R(A.originalKey||A[o]);ft(H).transition().duration(200).attr("fill",Re(j).brighter(.5).toString())}P&&P(x,A,H)}).on("mousemove",function(x,A){W&&W(x,A,this)}).on("mouseleave",function(x,A){const H=this;ft(H).transition().duration(200).attr("fill",R(A.originalKey||A[o])),J&&J(x,A,H)}).on("click",function(x,A){z&&z(x,A,this)}),F.transition().duration(500).attr("x",x=>G(x[o])||0).attr("y",x=>q(x[a])).attr("width",G.bandwidth()).attr("height",x=>Math.max(0,Q-q(x[a]))).attr("fill",x=>R(x.originalKey||x[o])),M.transition().duration(500).attr("y",x=>q(x[a])).attr("height",x=>Math.max(0,Q-q(x[a]))),L){const x=O.selectAll(".bar-label").data(K);x.exit().remove(),x.enter().append("text").attr("class","bar-label").attr("x",A=>(G(A[o])||0)+G.bandwidth()/2).attr("y",A=>q(A[a])-5).attr("text-anchor","middle").attr("font-size",m?"8px":"var(--font-size-xs)").attr("fill","var(--color-text-secondary)").attr("opacity",0).text(A=>T(A[a])).attr("display",A=>Q-q(A[a])<B&&m?"none":"block").transition().duration(500).attr("opacity",1),x.transition().duration(500).attr("x",A=>(G(A[o])||0)+G.bandwidth()/2).attr("y",A=>q(A[a])-5).text(A=>T(A[a])).attr("display",A=>Q-q(A[a])<B&&m?"none":"block")}}function rt(){st&&(st.selectAll("*").remove(),st.remove())}return{svg:st,chart:O,xScale:G,yScale:q,chartWidth:U,chartHeight:Q,update:lt,destroy:rt}}var uy=yt('<div class="absolute inset-center text-secondary loading"> </div>'),fy=yt('<div class="absolute inset-center text-error error"> </div>'),dy=yt('<div class="relative bg-card rounded p-md overflow-hidden min-h-400 w-full chart-container"><!></div>'),hy=yt('<div class="w-full index-visualization-container"><!></div>');function gy(t,e){we(e,!1);const[n,r]=je(),i=()=>mt(fe,"$itemsStore",n),o={Évènements:"Events",Associations:"Organizations",Individus:"Persons",Emplacements:"Locations",Sujets:"Topics","Notices d'autorité":"Authority Files"};function a(J){return o[J]||J}let s=[],h=0,c=!1,l=vt(),f="en",u=vt(""),g=0,m=0,v=null,_=null,p=vt(),$=null;const{groupAndCount:k}=Je({filterMissingValues:!0,requiredFields:["type"],filterFn:J=>J.type==="Notice d'autorité",calculatePercentages:!0,sortByCount:!0,sortDescending:!0}),w="viz.index_distribution_description",b=Ce(on);function y(J){return J.toLocaleString(f==="fr"?"fr-FR":"en-US")}function S(J){const z=y(J);return at("viz.index_distribution_items",{0:z})}function L(){c&&(h>0?D(u,S(h)):D(u,at("viz.index_distribution_title")))}let B=null;qe(async()=>{try{if(c=!0,await kn(),!d(l)){console.error("Container element not found in onMount");return}const J=d(l).getBoundingClientRect();g=J.width||100,m=J.height||400,$=Dr({container:d(l),onResize:()=>{c&&d(l)&&$&&(g=$.width,T())},debounce:!0,debounceDelay:200}),B=_e.subscribe(z=>{c&&(f=z,d(l)&&(L(),i().items&&i().items.length>0&&T()))}),_=fe.subscribe(z=>{c&&d(l)&&z.items&&z.items.length>0&&T()}),i().items&&i().items.length>0?T():fe.loadItems()}catch(J){console.error("Error during initialization:",J)}});function T(){if(!(!c||!d(l)))try{g=d(l).getBoundingClientRect().width,m=500;const z=E();if(!z||z.length===0){ue.handleNoData(d(l),at("viz.no_data"));return}s=z;const R=g<768;v&&(v.destroy(),v=null);const V=z.map(U=>({key:U.category,value:U.count,originalKey:U.originalCategory,percentage:U.percentage})),st=z.length>5,O={top:20,right:30,bottom:120,left:60};v=cy({container:d(l),width:g,height:m,data:V,margin:O,className:"index-distribution-chart",isMobile:R,barColors:b,barPadding:.2,barCornerRadius:3,xAxisLabel:at("viz.categories"),yAxisLabel:at("viz.number_of_items"),xAxisRotation:-45,xAxisTicks:Math.max(3,Math.floor(g/120)),yAxisTicks:R?3:5,xAxisTickFormat:U=>U.length>15?U.substring(0,12)+"...":U,valueFormatter:y,onBarMouseEnter:(U,Q)=>{if(!c)return;const G=s.find(q=>q.category===Q.key);G&&I(U,G)},onBarMouseMove:(U,Q)=>{if(!c)return;const G=s.find(q=>q.category===Q.key);G&&I(U,G)},onBarMouseLeave:()=>{c&&d(p)&&d(p).hideTooltip()}})}catch(J){console.error("Error creating bar chart:",J)}}function E(){if(!i().items||i().items.length===0)return[];console.log(`Processing ${i().items.length} items`);const J=i().items.filter(V=>V.type==="Notice d'autorité");if(console.log(`Found ${J.length} items of type "Notice d'autorité"`),J.length===0)return[];const z=k(J,V=>V.item_set_title||at("viz.uncategorized"));console.log(`Grouped into ${z.length} categories`);const R=z.map(V=>{const O=`category.${a(V.key)}`,U=at(O);return{category:U!==O?U:V.key,originalCategory:V.key,count:V.count,percentage:V.percentage||0}});return h=z.reduce((V,st)=>V+st.count,0),br(R,V=>V.count),L(),R}function I(J,z){if(!c||!d(p))return;const R=d(p).createGridTooltipContent(z.category,[{label:at("viz.items"),value:y(z.count)},{label:at("viz.percent_of_total"),value:`${z.percentage.toFixed(2)}%`}]);d(p).showTooltip(J,R)}In(()=>{try{c=!1,v&&(v.destroy(),v=null),$&&($.cleanup(),$=null),B&&(B(),B=null),_&&(_(),_=null),d(l)&&ft(d(l)).selectAll("*").remove()}catch(J){console.error("Error during cleanup:",J)}}),ke();var P=hy(),W=N(P);We(Lr(W,{get titleHtml(){return d(u)},descriptionTranslationKey:w,theme:"default",className:"index-visualization",children:(J,z)=>{var R=dy(),V=N(R);{var st=U=>{var Q=uy(),G=N(Q);kt(q=>ut(G,q),[()=>at("ui.loading")],re),et(U,Q)},O=U=>{var Q=ae(),G=Qt(Q);{var q=X=>{var lt=fy(),rt=N(lt);kt(()=>ut(rt,i().error)),et(X,lt)};Dt(G,X=>{i().error&&X(q)},!0)}et(U,Q)};Dt(V,U=>{i().loading?U(st):U(O,!1)})}We(R,U=>D(l,U),()=>d(l)),et(J,R)},$$slots:{default:!0},$$legacy:!0}),J=>D(p,J),()=>d(p)),et(t,P),Te(),r()}class rl{constructor(e){Hr(this,"options");Hr(this,"tooltipCallbacks",null);Hr(this,"monthFormat",Un("%Y-%m"));Hr(this,"displayFormat",Un("%b %Y"));this.options={...e,isMobile:e.width<768,isExtraSmall:e.width<480}}setTooltipCallbacks(e){this.tooltipCallbacks=e}render(e){try{const{container:n,width:r,height:i,isMobile:o,isExtraSmall:a,currentLang:s="en"}=this.options;if(console.log("[TimelineChart] Rendering with dimensions:",{width:r,height:i}),console.log("[TimelineChart] Container element:",n),console.log("[TimelineChart] Data points to render:",e.length),!e||e.length===0){console.warn("[TimelineChart] No timeline data available"),ft(n).selectAll("*").remove(),ft(n).append("div").attr("class","absolute inset-center text-secondary").text("No timeline data available with the current filters");return}if(!n){console.error("[TimelineChart] Container element is null or undefined");return}let h=r,c=i;(!h||h<=0)&&(console.warn("[TimelineChart] Invalid width, using minimum width of 300px"),h=300),(!c||c<=0)&&(console.warn("[TimelineChart] Invalid height, using minimum height of 500px"),c=500),console.log("[TimelineChart] Using dimensions:",{width:h,height:c}),ft(n).selectAll("*").remove();const l={top:o?20:40,right:o?15:30,bottom:o?70:80,left:o?40:60},f=ft(n).append("svg").attr("width",h).attr("height",c).attr("viewBox",`0 0 ${h} ${c}`).attr("class","timeline-chart"),u=h-l.left-l.right,m=(c-l.top-l.bottom-(o?30:50))/2,v=Dc().domain(Hf(e,_=>_.date)).range([0,u]);f.append("line").attr("x1",l.left).attr("y1",l.top+m+(o?15:25)).attr("x2",h-l.right).attr("y2",l.top+m+(o?15:25)).attr("stroke","var(--color-border-default)").attr("stroke-width",1).attr("stroke-dasharray","3,3"),this.addLegend(f,l,a,h),f.append("defs").append("marker").attr("id","circle").attr("viewBox","-5 -5 10 10").attr("refX",0).attr("refY",0).attr("markerWidth",5).attr("markerHeight",5).append("circle").attr("r",3).attr("fill","var(--color-primary)"),this.renderMonthlyChart(f,e,l,u,m,v,o),this.renderTotalChart(f,e,l,u,m,v,o),console.log("[TimelineChart] Successfully rendered timeline chart")}catch(n){console.error("[TimelineChart] Error rendering timeline chart:",n);try{this.options.container&&(ft(this.options.container).selectAll("*").remove(),ft(this.options.container).append("div").attr("class","absolute inset-center text-error p-md").text("Error rendering timeline chart. Please check console for details."))}catch(r){console.error("[TimelineChart] Error showing error message:",r)}}}addLegend(e,n,r,i){if(r)return;const{translations:o}=this.options,a=e.append("g").attr("transform",`translate(${i-n.right}, ${n.top-10})`);a.append("line").attr("x1",-100).attr("y1",0).attr("x2",-80).attr("y2",0).attr("stroke","var(--color-primary)").attr("stroke-width",2).attr("marker-end","url(#circle)"),a.append("text").attr("x",-75).attr("y",4).attr("class","text-xs text-secondary").text((o==null?void 0:o.monthlyAdditions)||"Monthly Additions"),a.append("line").attr("x1",-100).attr("y1",20).attr("x2",-80).attr("y2",20).attr("stroke","var(--color-secondary)").attr("stroke-width",2).attr("stroke-dasharray","4 2"),a.append("text").attr("x",-75).attr("y",24).attr("class","text-xs text-secondary").text((o==null?void 0:o.totalItems)||"Total Items")}renderMonthlyChart(e,n,r,i,o,a,s){const{translations:h,currentLang:c="en"}=this.options,l=e.append("g").attr("transform",`translate(${r.left}, ${r.top})`),f=ui().domain([0,(br(n,_=>_.count)||0)*1.1]).range([o,0]);l.append("g").attr("class","grid").selectAll("line").data(f.ticks(s?3:5)).enter().append("line").attr("x1",0).attr("x2",i).attr("y1",_=>f(_)).attr("y2",_=>f(_)).attr("stroke","var(--color-border-default)").attr("stroke-width",.5);const u=Math.max(2,Math.floor(i/(s?60:80))),g=qi(a).ticks(u).tickFormat(_=>{const p=_;return c==="fr"?p.toLocaleDateString("fr-FR",{month:"short",year:"2-digit"}):Un("%b '%y")(p)});l.append("g").attr("class","x-axis").attr("transform",`translate(0, ${o})`).call(g).selectAll("text").attr("class","text-xs text-primary").attr("text-anchor","end").attr("dx","-.8em").attr("dy",".15em").attr("transform",`rotate(${s?-45:-30})`);const m=Yi(f).ticks(s?3:5);l.append("g").attr("class","y-axis").call(m).selectAll("text").attr("class","text-xs text-primary"),s||l.append("text").attr("class","text-xs text-secondary").attr("transform","rotate(-90)").attr("y",-50).attr("x",-o/2).attr("text-anchor","middle").text((h==null?void 0:h.monthlyAdditions)||"Monthly Additions");const v=Ks().x(_=>a(_.date)).y(_=>f(_.count)).curve(Qs);l.append("path").datum(n).attr("fill","none").attr("stroke","var(--color-primary)").attr("stroke-width",s?1.5:2).attr("d",v),this.addMonthlyDots(l,n,a,f,s)}addMonthlyDots(e,n,r,i,o){const{formatNumber:a,translations:s,currentLang:h="en"}=this.options;if(!this.tooltipCallbacks)return;const{showTooltip:c,hideTooltip:l}=this.tooltipCallbacks;e.selectAll(".dot-monthly").data(o?n.filter((f,u)=>u%2===0):n).enter().append("circle").attr("class","dot-monthly cursor-pointer").attr("cx",f=>r(f.date)).attr("cy",f=>i(f.count)).attr("r",o?3:4).attr("fill","var(--color-primary)").attr("stroke","white").attr("stroke-width",1).on("mouseenter",function(f,u){ft(this).transition().duration(200).attr("r",o?5:6);const g=u.date.toLocaleString(h==="fr"?"fr-FR":"en-US",{month:"long"}),m=u.date.getFullYear(),v=wn(`${g} ${m}`,[{label:(s==null?void 0:s.newItems)||"New Items",value:a?a(u.count):u.count.toString()},{label:(s==null?void 0:s.percentage)||"Percentage",value:`${u.percentage.toFixed(2)}%`}]);c(f,v)}).on("mousemove",function(f,u){const g=u.date.toLocaleString(h==="fr"?"fr-FR":"en-US",{month:"long"}),m=u.date.getFullYear(),v=wn(`${g} ${m}`,[{label:(s==null?void 0:s.newItems)||"New Items",value:a?a(u.count):u.count.toString()},{label:(s==null?void 0:s.percentage)||"Percentage",value:`${u.percentage.toFixed(2)}%`}]);c(f,v)}).on("mouseleave",function(){ft(this).transition().duration(200).attr("r",o?3:4),l()})}renderTotalChart(e,n,r,i,o,a,s){const{translations:h,currentLang:c="en"}=this.options,l=e.append("g").attr("transform",`translate(${r.left}, ${r.top+o+(s?30:50)})`),f=ui().domain([0,(br(n,_=>_.total)||0)*1.1]).range([o,0]);l.append("g").attr("class","grid").selectAll("line").data(f.ticks(s?3:5)).enter().append("line").attr("x1",0).attr("x2",i).attr("y1",_=>f(_)).attr("y2",_=>f(_)).attr("stroke","var(--color-border-default)").attr("stroke-width",.5);const u=Math.max(2,Math.floor(i/(s?60:80))),g=qi(a).ticks(u).tickFormat(_=>{const p=_;return c==="fr"?p.toLocaleDateString("fr-FR",{month:"short",year:"2-digit"}):Un("%b '%y")(p)});l.append("g").attr("class","x-axis").attr("transform",`translate(0, ${o})`).call(g).selectAll("text").attr("class","text-xs text-primary").attr("text-anchor","end").attr("dx","-.8em").attr("dy",".15em").attr("transform",`rotate(${s?-45:-30})`);const m=Yi(f).ticks(s?3:5);l.append("g").attr("class","y-axis").call(m).selectAll("text").attr("class","text-xs text-primary"),s||(l.append("text").attr("class","text-xs text-secondary").attr("transform","rotate(-90)").attr("y",-50).attr("x",-o/2).attr("text-anchor","middle").text((h==null?void 0:h.totalItems)||"Total Items"),l.append("text").attr("class","text-xs text-secondary").attr("text-anchor","middle").attr("x",i/2).attr("y",o+45).text((h==null?void 0:h.month)||"Month"));const v=Ks().x(_=>a(_.date)).y(_=>f(_.total)).curve(Qs);l.append("path").datum(n).attr("fill","none").attr("stroke","var(--color-secondary)").attr("stroke-width",s?1.5:2).attr("stroke-dasharray","4 2").attr("d",v),this.addTotalDots(l,n,a,f,s)}addTotalDots(e,n,r,i,o){const{formatNumber:a,translations:s,currentLang:h="en"}=this.options;if(!this.tooltipCallbacks)return;const{showTooltip:c,hideTooltip:l}=this.tooltipCallbacks;e.selectAll(".dot-total").data(o?n.filter((f,u)=>u%2===0):n).enter().append("circle").attr("class","dot-total cursor-pointer").attr("cx",f=>r(f.date)).attr("cy",f=>i(f.total)).attr("r",o?3:4).attr("fill","var(--color-secondary)").attr("stroke","white").attr("stroke-width",1).on("mouseenter",function(f,u){ft(this).transition().duration(200).attr("r",o?5:6);const g=u.date.toLocaleString(h==="fr"?"fr-FR":"en-US",{month:"long"}),m=u.date.getFullYear(),v=wn(`${g} ${m}`,[{label:(s==null?void 0:s.totalItems)||"Total Items",value:a?a(u.total):u.total.toString()}]);c(f,v)}).on("mousemove",function(f,u){const g=u.date.toLocaleString(h==="fr"?"fr-FR":"en-US",{month:"long"}),m=u.date.getFullYear(),v=wn(`${g} ${m}`,[{label:(s==null?void 0:s.totalItems)||"Total Items",value:a?a(u.total):u.total.toString()}]);c(f,v)}).on("mouseleave",function(){ft(this).transition().duration(200).attr("r",o?3:4),l()})}}var my=yt("<option> </option>"),py=yt("<option> </option>"),vy=yt("<span> </span>"),yy=yt('<div class="absolute inset-center text-error">Store not available</div>'),_y=yt('<div class="absolute inset-center text-secondary"><div class="loading-spinner mr-sm svelte-1dm70g2"></div> <span> </span></div>'),xy=yt('<div class="absolute inset-center text-error"> </div>'),by=yt('<div class="absolute inset-center text-secondary"><div class="loading-spinner mr-sm svelte-1dm70g2"></div> <span>Initializing visualization...</span></div>'),wy=yt('<div class="absolute inset-center text-secondary"> </div>'),Ty=yt('<li class="flex justify-between mb-xs text-sm"><span class="text-primary"> </span> <span class="text-secondary font-medium"> </span></li>'),$y=yt('<div class="p-md stat-summary"><h3 class="mt-0 mb-sm text-md text-primary border-b border-solid border-default pb-xs"> </h3> <p class="text-sm mb-xs"> <strong class="font-medium"> </strong></p> <p class="text-sm mb-xs"> <strong class="font-medium"> </strong></p> <p class="text-sm"> <strong class="font-medium"> </strong></p></div> <div class="p-md peak-months"><h3 class="mt-0 mb-sm text-md text-primary border-b border-solid border-default pb-xs"> </h3> <ul class="list-style-none p-0 m-0"></ul></div>',1),Cy=yt('<div class="p-md col-span-2 text-center text-secondary"> </div>'),ky=yt('<div class="flex flex-wrap gap-md p-md bg-card rounded-t border-b border-solid border-default filters svelte-1dm70g2"><div class="flex flex-col gap-xs filter-group svelte-1dm70g2"><label for="country-filter" class="text-xs font-bold text-secondary"> </label> <select id="country-filter" class="p-xs px-sm rounded-sm border border-solid border-default bg-card text-primary text-sm"></select></div> <div class="flex flex-col gap-xs filter-group svelte-1dm70g2"><label for="type-filter" class="text-xs font-bold text-secondary"> </label> <select id="type-filter" class="p-xs px-sm rounded-sm border border-solid border-default bg-card text-primary text-sm"></select></div> <div class="ml-auto self-end text-sm text-secondary summary svelte-1dm70g2"><!></div></div> <div class="flex-1 relative min-h-500 bg-card rounded-b p-md chart-container overflow-hidden svelte-1dm70g2" style="height: 500px;"><!></div> <div class="grid grid-cols-2 gap-md p-md bg-card rounded shadow mt-md stats svelte-1dm70g2"><!></div>',1),zy=yt('<div class="w-full h-full flex flex-col gap-md"><!></div>');function My(t,e){we(e,!1);const[n,r]=je(),i=()=>mt(_e,"$languageStore",n),o=()=>mt(fe,"$itemsStore",n),a=()=>mt(At,"$monthlyAdditionsText",n),s=()=>mt(H,"$totalItemsText",n),h=()=>mt(Ft,"$newItemsText",n),c=()=>mt(le,"$percentageText",n),l=()=>mt(Wt,"$monthText",n),f=()=>mt(F,"$filterByCountryText",n),u=()=>mt(M,"$filterByTypeText",n),g=()=>mt(Z,"$showingItemsOverMonthsText",n),m=()=>mt(x,"$noDataText",n),v=()=>mt(A,"$summaryText",n),_=()=>mt(j,"$timePeriodText",n),p=()=>mt(dt,"$avgMonthlyAdditionsText",n),$=()=>mt(ot,"$peakGrowthMonthsText",n),k=()=>mt(nt,"$itemsText",n),w="viz.growth_since_april_description";let b=vt("all"),y=vt("all"),S=vt([]),L=vt([]),B=vt([]),T=vt(0),E=0,I=0,P=0,W="en",J=vt(""),z=vt(0),R=vt(0),V=vt(),st;const{showTooltip:O,hideTooltip:U}=Ao({defaultWidth:200,defaultHeight:100});let Q=vt();const{filterItems:G,processTimeData:q}=Je({filterMissingValues:!0,requiredFields:["created_date"],calculatePercentages:!0,sortByCount:!0,sortDescending:!0,filterFn:Y=>!(Y.type==="Notice d'autorité"||d(b)!=="all"&&Y.country!==d(b)||d(y)!=="all"&&Y.type!==d(y))}),X=Je({filterMissingValues:!0,requiredFields:["created_date"],filterFn:Y=>{if(Y.type==="Notice d'autorité"||!Y.created_date)return!1;const it=new Date(Y.created_date);return isNaN(it.getTime())||it<new Date(2024,3,1)?!1:d(y)==="all"||Y.type===d(y)}}),lt=Je({filterMissingValues:!0,requiredFields:["created_date"],filterFn:Y=>{if(Y.type==="Notice d'autorité"||!Y.created_date)return!1;const it=new Date(Y.created_date);return isNaN(it.getTime())||it<new Date(2024,3,1)?!1:d(b)==="all"||Y.country===d(b)}});let rt,K=vt(!1),C=vt(!1);Un("%Y-%m"),Un("%b %Y");const F=tt("viz.filter_by_country"),M=tt("viz.filter_by_type"),x=tt("viz.no_data"),A=tt("viz.summary"),H=tt("viz.total_items"),j=tt("viz.time_period"),dt=tt("viz.avg_monthly_additions"),ot=tt("viz.peak_growth_months"),Z=tt("viz.showing_items_over_months"),nt=tt("viz.items");tt("viz.timeline_distribution_items");const At=tt("viz.monthly_additions"),Wt=tt("viz.month");tt("viz.growth_since_april");const Ft=tt("viz.new_items"),le=tt("viz.percentage");function Yt(Y){return Y.toLocaleString(W==="fr"?"fr-FR":"en-US")}function te(){if(E>0){const Y=Yt(E);return at("viz.items_added_since_april",{0:Y})}else return at("viz.items_added_since_april_title")}function ct(){console.log("[TimelineDistribution] Updating title with count:",d(T)),D(J,te())}let zt=null;function ht(){zt&&clearTimeout(zt),zt=setTimeout(()=>{$t(),zt=null},250)}qe(()=>(D(K,!0),console.log("[TimelineDistribution] Component mounted"),(async()=>{var Y;try{if(await kn(),!d(V)){console.error("[TimelineDistribution] Container element not found in onMount");return}console.log("[TimelineDistribution] Container element found:",d(V)),D(Q,Dr({container:d(V),onResize:()=>{if(d(K)&&d(C)&&d(V)){const{width:bt,height:gt}=d(Q).dimensions,Ut=Math.abs(d(z)-bt)>5,It=Math.abs(d(R)-gt)>5;(Ut||It)&&(console.log("[TimelineDistribution] Size changed, updating visualization",{newWidth:bt,newHeight:gt}),D(z,bt),D(R,gt),ht())}}}));const{width:it,height:xt}=d(Q).dimensions;if(D(z,it),D(R,xt||500),console.log("[TimelineDistribution] Initial dimensions:",{width:d(z),height:d(R)}),rt=_e.subscribe(bt=>{d(K)&&(console.log("[TimelineDistribution] Language changed to:",bt),W=bt,ct(),d(C)&&d(V)&&ht())}),!o().items||o().items.length===0){console.log("[TimelineDistribution] No items loaded, loading items");try{await fe.loadItems(),console.log("[TimelineDistribution] Items loaded:",(Y=o().items)==null?void 0:Y.length)}catch(bt){console.error("[TimelineDistribution] Error loading items:",bt)}}else console.log("[TimelineDistribution] Items already loaded:",o().items.length);Bt(),D(C,!0),await kn(),d(V)?(_t(),$t(),console.log("[TimelineDistribution] Visualization initialized")):console.error("[TimelineDistribution] Container not available after initialization")}catch(it){console.error("[TimelineDistribution] Error during initialization:",it)}})(),()=>{try{console.log("[TimelineDistribution] Component unmounting, cleaning up"),D(K,!1),D(C,!1),d(Q)&&d(Q).cleanup(),rt&&rt(),zt&&(clearTimeout(zt),zt=null),d(V)&&ft(d(V)).selectAll("*").remove()}catch(Y){console.error("[TimelineDistribution] Error during cleanup:",Y)}}));function _t(){try{console.log("[TimelineDistribution] Initializing timeline chart with dimensions:",{width:d(z),height:d(R)}),console.log("[TimelineDistribution] Container element:",d(V)),ft(d(V)).selectAll("*").remove(),st=new rl({container:d(V),width:d(z),height:d(R),formatNumber:Yt,currentLang:W,translations:{monthlyAdditions:a(),totalItems:s(),newItems:h(),percentage:c(),month:l()}}),st.setTooltipCallbacks({showTooltip:O,hideTooltip:U}),console.log("[TimelineDistribution] Timeline chart initialized")}catch(Y){console.error("[TimelineDistribution] Error initializing timeline chart:",Y)}}function $t(){try{if(!d(V)||!d(K)||!d(C)){console.error("[TimelineDistribution] Cannot update visualization - component not ready",{container:!!d(V),isMounted:d(K),isInitialized:d(C)});return}console.log("[TimelineDistribution] Updating visualization with dimensions:",{width:d(z),height:d(R)}),d(R)<=0&&(D(R,500),console.log("[TimelineDistribution] Using fallback height of 500px"));const Y=Ot();if(!Y||Y.length===0){console.warn("[TimelineDistribution] No timeline data available with current filters"),ft(d(V)).selectAll("*").remove(),ft(d(V)).append("div").attr("class","absolute inset-center text-secondary").text("No timeline data available with the current filters");return}D(S,Y),console.log("[TimelineDistribution] Timeline data updated with",d(S).length,"data points"),ft(d(V)).selectAll("*").remove(),st=new rl({container:d(V),width:d(z),height:d(R),formatNumber:Yt,currentLang:W,translations:{monthlyAdditions:a(),totalItems:s(),newItems:h(),percentage:c(),month:l()}}),st.setTooltipCallbacks({showTooltip:O,hideTooltip:U}),st.render(Y),console.log("[TimelineDistribution] Chart rendered with",Y.length,"data points"),ct()}catch(Y){if(console.error("[TimelineDistribution] Error updating visualization:",Y),d(V))try{ft(d(V)).selectAll("*").remove(),ft(d(V)).append("div").attr("class","absolute inset-center text-error").text("Error rendering timeline visualization")}catch(it){console.error("[TimelineDistribution] Error showing error message:",it)}}}function Ct(Y){const it=Y.target;D(b,it.value),Bt(),ht()}function Rt(Y){const it=Y.target;D(y,it.value),Bt(),ht()}function Ot(){var Y;if(!o().items||o().items.length===0)return console.warn("[TimelineDistribution] No items available for timeline data"),[];console.log("[TimelineDistribution] Processing data with filters:",{country:d(b),type:d(y)}),console.log("[TimelineDistribution] Total items before filtering:",o().items.length);try{const it=new Date(2024,3,1),xt=8874;o().items.length>0&&console.log("[TimelineDistribution] Sample created_date values:",o().items.slice(0,5).map(Ut=>Ut.created_date));const bt=G(o().items);console.log("[TimelineDistribution] Items after filtering:",bt.length);const gt=q(bt,"created_date",{startDate:it,includeCumulative:!0,initialTotal:xt});return console.log("[TimelineDistribution] Processed timeline data length:",gt.length),gt.length>0&&console.log("[TimelineDistribution] First and last data points:",gt[0],gt[gt.length-1]),gt.length===0?(console.warn("[TimelineDistribution] No timeline data generated after processing"),[]):(D(T,((Y=gt[gt.length-1])==null?void 0:Y.total)||xt),E=d(T)-xt,I=Math.max(...gt.map(Ut=>Ut.count)),P=Math.max(...gt.map(Ut=>Ut.total)),gt)}catch(it){return console.error("[TimelineDistribution] Error processing timeline data:",it),[]}}function Bt(){if(!o().items||o().items.length===0)return;console.log("[TimelineDistribution] Generating facet options with filters:",{country:d(b),type:d(y)});const Y=X.filterItems(o().items),it=lt.filterItems(o().items);console.log("[TimelineDistribution] Items for country facets:",Y.length),console.log("[TimelineDistribution] Items for type facets:",it.length);const xt=X.groupAndCount(Y,gt=>gt.country||"Unknown",Y.length);D(L,[{value:"all",label:at("country.all"),count:Y.length},...xt.filter(gt=>gt.key!=="Unknown").map(gt=>({value:gt.key,label:at(`country.${gt.key}`),count:gt.count})).sort((gt,Ut)=>Ut.count-gt.count)]);const bt=lt.groupAndCount(it,gt=>gt.type||"Unknown",it.length);D(B,[{value:"all",label:at("type.all"),count:it.length},...bt.filter(gt=>gt.key!=="Unknown"&&gt.count>0).map(gt=>({value:gt.key,label:at(`type.${gt.key}`),count:gt.count})).sort((gt,Ut)=>Ut.count-gt.count)]),console.log("[TimelineDistribution] Updated facet options:",{countryOptions:d(L).length,typeOptions:d(B).length})}ge(()=>i(),()=>{i(),ct()}),ge(()=>(d(K),d(C),o(),d(V),d(Q),d(z),d(R)),()=>{d(K)&&d(C)&&o().items&&d(V)&&d(Q)&&(d(z)!==d(Q).dimensions.width||d(R)!==d(Q).dimensions.height)&&(D(z,d(Q).dimensions.width),D(R,d(Q).dimensions.height),$t())}),ge(()=>(d(K),i(),o()),()=>{d(K)&&i()&&o().items&&o().items.length>0&&Bt()}),ge(()=>(d(C),d(b),d(y)),()=>{d(C)&&(d(b)||d(y))&&ht()}),hi(),ke();var Mt=zy(),Et=N(Mt);Lr(Et,{title:"Growth of the Database",get titleHtml(){return d(J)},descriptionTranslationKey:w,theme:"default",className:"timeline-visualization",children:(Y,it)=>{var xt=ky(),bt=Qt(xt),gt=N(bt),Ut=N(gt),It=N(Ut),Pt=pt(Ut,2);Go(Pt,()=>d(b));var Zt;Hn(Pt,5,()=>d(L),pr,(qt,Jt)=>{var se=my(),Ee={},Ie=N(se);kt(ce=>{Ee!==(Ee=d(Jt).value)&&(se.value=(se.__value=d(Jt).value)==null?"":d(Jt).value),ut(Ie,`${d(Jt).label??""} (${ce??""})`)},[()=>Yt(d(Jt).count)],re),et(qt,se)});var St=pt(gt,2),wt=N(St),Nt=N(wt),Gt=pt(wt,2);Go(Gt,()=>d(y));var ze;Hn(Gt,5,()=>d(B),pr,(qt,Jt)=>{var se=py(),Ee={},Ie=N(se);kt(ce=>{Ee!==(Ee=d(Jt).value)&&(se.value=(se.__value=d(Jt).value)==null?"":d(Jt).value),ut(Ie,`${d(Jt).label??""} (${ce??""})`)},[()=>Yt(d(Jt).count)],re),et(qt,se)});var Me=pt(St,2),Ae=N(Me);{var tn=qt=>{var Jt=vy(),se=N(Jt);kt(Ee=>ut(se,Ee),[()=>g().replace("{0}",Yt(d(T))).replace("{1}",d(S).length.toString())],re),et(qt,Jt)};Dt(Ae,qt=>{d(S)&&d(S).length>0&&qt(tn)})}var Se=pt(bt,2),Ye=N(Se);{var Tt=qt=>{var Jt=yy();et(qt,Jt)},Lt=qt=>{var Jt=ae(),se=Qt(Jt);{var Ee=ce=>{var Ge=_y(),Bn=pt(N(Ge),2),On=N(Bn);kt(He=>ut(On,He),[()=>at("ui.loading")],re),et(ce,Ge)},Ie=ce=>{var Ge=ae(),Bn=Qt(Ge);{var On=Ne=>{var pn=xy(),Wn=N(pn);kt(()=>ut(Wn,o().error)),et(Ne,pn)},He=Ne=>{var pn=ae(),Wn=Qt(pn);{var Vn=sn=>{var Nn=by();et(sn,Nn)},qn=sn=>{var Nn=ae(),Fr=Qt(Nn);{var Ln=Rr=>{var vi=wy(),Yn=N(vi);kt(()=>ut(Yn,m())),et(Rr,vi)};Dt(Fr,Rr=>{(!d(S)||d(S).length===0)&&Rr(Ln)},!0)}et(sn,Nn)};Dt(Wn,sn=>{d(C)?sn(qn,!1):sn(Vn)},!0)}et(Ne,pn)};Dt(Bn,Ne=>{o().error?Ne(On):Ne(He,!1)},!0)}et(ce,Ge)};Dt(se,ce=>{o().loading?ce(Ee):ce(Ie,!1)},!0)}et(qt,Jt)};Dt(Ye,qt=>{o()?qt(Lt,!1):qt(Tt)})}We(Se,qt=>D(V,qt),()=>d(V));var Vt=pt(Se,2),he=N(Vt);{var oe=qt=>{var Jt=$y(),se=Qt(Jt),Ee=N(se),Ie=N(Ee),ce=pt(Ee,2),Ge=N(ce),Bn=pt(Ge),On=N(Bn),He=pt(ce,2),Ne=N(He),pn=pt(Ne),Wn=N(pn),Vn=pt(He,2),qn=N(Vn),sn=pt(qn),Nn=N(sn),Fr=pt(se,2),Ln=N(Fr),Rr=N(Ln),vi=pt(Ln,2);Hn(vi,5,()=>[...d(S)].sort((Yn,Gn)=>Gn.count-Yn.count).slice(0,3),pr,(Yn,Gn)=>{var Pr=Ty(),Ur=N(Pr),Hc=N(Ur),Bc=pt(Ur,2),Oc=N(Bc);kt((Wc,Vc)=>{ut(Hc,d(Gn).monthFormatted),ut(Oc,`${Wc??""} ${k()??""} (${Vc??""}%)`)},[()=>Yt(d(Gn).count),()=>(d(Gn).count/(d(T)||1)*100).toFixed(1)],re),et(Yn,Pr)}),kt((Yn,Gn)=>{var Pr,Ur;ut(Ie,v()),ut(Ge,`${s()??""}: `),ut(On,Yn),ut(Ne,`${_()??""}: `),ut(Wn,`${((Pr=d(S)[0])==null?void 0:Pr.monthFormatted)||""} to ${((Ur=d(S)[d(S).length-1])==null?void 0:Ur.monthFormatted)||""}`),ut(qn,`${p()??""}: `),ut(Nn,Gn),ut(Rr,$())},[()=>Yt(d(T)),()=>Yt(Math.round(d(T)/(d(S).length||1)))],re),et(qt,Jt)},pe=qt=>{var Jt=Cy(),se=N(Jt);kt(()=>ut(se,m())),et(qt,Jt)};Dt(he,qt=>{d(S)&&d(S).length>0?qt(oe):qt(pe,!1)})}kt(()=>{ut(It,`${f()??""}:`),Zt!==(Zt=d(b))&&(Pt.value=(Pt.__value=d(b))==null?"":d(b),oi(Pt,d(b))),ut(Nt,`${u()??""}:`),ze!==(ze=d(y))&&(Gt.value=(Gt.__value=d(y))==null?"":d(y),oi(Gt,d(y)))}),ye("change",Pt,Ct),ye("change",Gt,Rt),et(Y,xt)},$$slots:{default:!0}}),et(t,Mt),Te(),r()}const _r=[],Ay=1e3;function Sy(){return new Date().toISOString()}function ne(t,e,n){const i={timestamp:Sy(),component:t,action:e,details:n};_r.push(i),_r.length>Ay&&_r.shift()}const Ey=new Set,Iy={};function Ny(){console.group("IWAC Debug Logs"),_r.forEach(t=>{console.groupCollapsed(`${t.timestamp} - ${t.component} - ${t.action}`),console.log("Component:",t.component),console.log("Action:",t.action),t.details&&console.log("Details:",t.details),console.groupEnd()}),console.groupEnd()}function Ly(){return JSON.stringify(_r,null,2)}typeof window<"u"&&(window.__IWAC_DEBUG={logs:_r,dumpLogs:Ny,exportLogs:Ly,mountedComponents:()=>Array.from(Ey),hierarchy:Iy});var Dy=ba('<svg viewBox="0 0 24 24" width="14" height="14"><path fill="currentColor" d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"></path></svg>'),Fy=yt('<div class="facet-option svelte-1uu7ity" role="checkbox" tabindex="0"><span class="facet-checkbox svelte-1uu7ity"><!></span> <span class="facet-label svelte-1uu7ity"> </span> <span class="facet-count svelte-1uu7ity"> </span></div>'),Ry=yt('<div class="absolute inset-center text-secondary z-50"> </div>'),Py=yt('<div class="absolute inset-center text-error z-50"> </div>'),Uy=yt('<div class="type-distribution-container svelte-1uu7ity"><div class="controls-container svelte-1uu7ity"><div class="facets svelte-1uu7ity"><div class="facet-group svelte-1uu7ity"><h3 class="svelte-1uu7ity"> </h3> <div class="facet-options table-layout svelte-1uu7ity"></div></div></div> <div class="year-range svelte-1uu7ity"><h3 class="svelte-1uu7ity"> </h3> <div class="slider-container svelte-1uu7ity"><div class="slider-labels svelte-1uu7ity"><span> </span> <span> </span></div> <div class="slider-inputs svelte-1uu7ity"><input type="range" data-index="0" class="svelte-1uu7ity"> <input type="range" data-index="1" class="svelte-1uu7ity"></div></div></div></div> <div class="chart-container svelte-1uu7ity"><!></div></div>');function Hy(t,e){we(e,!1);const[n,r]=je(),i=()=>mt(fe,"$itemsStore",n),o=()=>mt(W,"$noDataText",n),a=()=>mt(J,"$yearText",n),s=()=>mt(z,"$numberOfItemsText",n),h=()=>mt(R,"$toggleTypesText",n),c=()=>mt(V,"$countriesText",n),l=()=>mt(st,"$yearRangeText",n),f="TypeDistribution";let u=!1,g,m,v="en",_,p=vt(),$=0,k=0,w=vt([]),b=vt([]),y=vt([0,0]),S=[],L=0,B=[];const{showTooltip:T,hideTooltip:E}=Ao({defaultWidth:250,defaultHeight:150});let I;const{groupHierarchically:P}=Je({filterMissingValues:!0,requiredFields:["publication_date","type"],calculatePercentages:!0,sortByCount:!0,sortDescending:!0}),W=tt("viz.no_data");tt("viz.filter_by_country"),tt("viz.all_countries"),tt("viz.publication_year");const J=tt("viz.year"),z=tt("viz.number_of_items"),R=tt("viz.toggle_types");tt("viz.toggled_type");const V=tt("viz.countries"),st=tt("viz.time_period");tt("viz.summary"),tt("viz.showing_items_over_months"),tt("viz.types"),tt("viz.published_between");let O=vt("");function U(M){return M.toLocaleString(v==="fr"?"fr-FR":"en-US")}function Q(){if(L>0){const M=L.toLocaleString();D(O,at("viz.type_distribution_items",{0:M}))}else D(O,at("viz.type_distribution_title"));console.log("Type Distribution Title updated:",d(O))}function G(M){return M?/^\d{4}$/.test(M)?parseInt(M):/^\d{4}-\d{2}$/.test(M)||/^\d{4}-\d{2}-\d{2}$/.test(M)?parseInt(M.substring(0,4)):null:null}function q(){var Z;if(!u||!i().items||i().items.length===0)return[];const M=d(w).filter(nt=>nt.selected).map(nt=>nt.value),x=M.includes("all"),A=nt=>{if(nt.type==="Notice d'autorité")return!1;const At=G(nt.publication_date);return!(!At||At<d(y)[0]||At>d(y)[1]||!nt.country||nt.country.trim()===""||nt.country==="Unknown"||!x&&!M.includes(nt.country))},{filterItems:H}=Je({filterMissingValues:!0,requiredFields:["publication_date","type"],filterFn:A}),j=H(i().items);L=j.length,Q();const dt=P(j,[nt=>{var At;return((At=G(nt.publication_date))==null?void 0:At.toString())||"Unknown"},nt=>nt.type||"Unknown"]),ot=[];return(Z=dt.children)==null||Z.forEach(nt=>{var Wt;const At=parseInt(nt.name);(Wt=nt.children)==null||Wt.forEach(Ft=>{ot.push({year:At,type:Ft.name,count:Ft.value})})}),ot}function X(){var ot;if(!u||!i().items||i().items.length===0)return;const M=Z=>{if(Z.type==="Notice d'autorité")return!1;const nt=G(Z.publication_date);return nt!==null&&nt>=d(y)[0]&&nt<=d(y)[1]},{filterItems:x,groupAndCount:A}=Je({filterMissingValues:!0,requiredFields:["publication_date"],filterFn:M}),H=x(i().items),j=A(H,Z=>Z.country||"Unknown"),dt=H.filter(Z=>Z.country&&Z.country.trim()!==""&&Z.country!=="Unknown").length;D(w,[{value:"all",label:at("country.all"),count:dt,selected:((ot=d(w).find(Z=>Z.value==="all"))==null?void 0:ot.selected)??!0},...j.filter(Z=>Z.key!=="Unknown").map(Z=>{var nt;return{value:Z.key,label:at(`country.${Z.key}`)||Z.key,count:Z.count,selected:((nt=d(w).find(At=>At.value===Z.key))==null?void 0:nt.selected)??!1}})]),d(w).sort((Z,nt)=>Z.value==="all"?-1:nt.value==="all"?1:Z.label.localeCompare(nt.label))}function lt(){if(!u||!i().items||i().items.length===0)return;const M=i().items.filter(H=>H.type!=="Notice d'autorité").map(H=>G(H.publication_date)).filter(H=>H!==null);if(M.length===0)return;const x=Math.min(...M),A=Math.max(...M);D(b,Array.from({length:A-x+1},(H,j)=>x+j)),(d(y)[0]===0||d(y)[1]===0)&&D(y,[x,A])}function rt(M){u&&(M.value==="all"?d(w).forEach(x=>{x.selected=x.value==="all"}):(d(w).find(x=>x.value==="all").selected=!1,M.selected=!M.selected,d(w).some(x=>x.selected)||(d(w).find(x=>x.value==="all").selected=!0)),D(w,[...d(w)]),C())}function K(M){const x=M.target,A=parseInt(x.dataset.index||"0"),H=parseInt(x.value);A===0?D(y,[H,Math.max(H,d(y)[1])]):D(y,[Math.min(H,d(y)[0]),H]),X(),C()}function C(){if(!u||!d(p)||!document.body.contains(d(p))){console.error("Cannot update visualization - component not mounted or container not found");return}try{if(S=q(),ft(d(p)).select("svg").remove(),ft(d(p)).selectAll(".absolute.inset-center").remove(),_&&(_.cleanup(),_=null),S.length===0){ft(d(p)).append("div").attr("class","absolute inset-center text-secondary z-50").text(o());return}if(!u||!document.body.contains(d(p)))return;const M=d(p).getBoundingClientRect();if($=M.width,k=Math.max(400,M.height-100),!u||!document.body.contains(d(p)))return;const x=Array.from(new Set(S.map(ct=>ct.type))),A={top:20,right:30,bottom:70,left:60},H=$-A.left-A.right;if(x.sort((ct,zt)=>{const ht=at(`type.${ct}`)!==`type.${ct}`?at(`type.${ct}`):ct,_t=at(`type.${zt}`)!==`type.${zt}`?at(`type.${zt}`):zt;return ht.localeCompare(_t)}),!u||!document.body.contains(d(p)))return;if(B.length===0)B=x.map(ct=>({type:ct,visible:!0}));else{const ct=B.map(zt=>zt.type);x.forEach(zt=>{ct.includes(zt)||B.push({type:zt,visible:!0})})}const j=x.filter(ct=>{var zt;return((zt=B.find(ht=>ht.type===ct))==null?void 0:zt.visible)??!0}),dt=k-A.top-A.bottom;if(!u||!document.body.contains(d(p)))return;if(j.length===0){ft(d(p)).selectAll(".absolute.inset-center").remove(),ft(d(p)).append("div").attr("class","absolute inset-center text-secondary z-50").text(o());return}const ot=ft(d(p)).append("svg").attr("width",$).attr("height",k),Z=ot.append("g").attr("transform",`translate(${A.left}, ${A.top})`),nt=Array.from(ka(S.filter(ct=>{var zt;return((zt=B.find(ht=>ht.type===ct.type))==null?void 0:zt.visible)??!0}),ct=>ct.year),([ct,zt])=>{const ht={year:ct};return zt.forEach(_t=>{ht[_t.type]=_t.count}),ht}).sort((ct,zt)=>ct.year-zt.year);if(nt.length===0){ft(d(p)).selectAll(".absolute.inset-center").remove(),ft(d(p)).append("div").attr("class","absolute inset-center text-secondary z-50").text(o());return}const At=Fa().domain(nt.map(ct=>ct.year.toString())).range([0,H]).padding(.1),Wt=f0().keys(j).value((ct,zt)=>ct[zt]||0)(nt),Ft=ui().domain([0,br(Wt.length>0?Wt[Wt.length-1]:[],ct=>ct[1])||0]).range([dt,0]);if(!u||!document.body.contains(d(p)))return;const le=["Press Article","Journal Article","Book Chapter","Doctoral Thesis","type.Article d'encyclopédie","type.Mémoire de maitrise","Book","type.Compte rendu de livre","type.Rapport","type.Working paper","type.Mémoire de licence","Islamic Periodical","Document","type.Photographie","Blog Post","Scientific Communication","type.Enregistrement vidéo","Article de presse","Article de revue","Chapitre de livre","Thèse de doctorat","Article d'encyclopédie","Mémoire de maitrise","Livre","Compte rendu de livre","Rapport","Working paper","Mémoire de licence","Périodique islamique","Document","Photographie","Article de blog","Communication scientifique","Enregistrement vidéo"],Yt=Ce().domain(le).range(on);if(Z.append("g").attr("transform",`translate(0, ${dt})`).call(qi(At).tickValues(nt.filter(ct=>ct.year%5===0).map(ct=>ct.year.toString())).tickSizeOuter(0)).selectAll("text").attr("text-anchor","end").attr("dx","-.8em").attr("dy",".15em").attr("transform","rotate(-45)").attr("class","text-xs text-primary"),!u||!document.body.contains(d(p))||(Z.append("g").call(Yi(Ft).ticks(5)).selectAll("text").attr("class","text-xs text-primary"),Z.append("text").attr("text-anchor","middle").attr("x",H/2).attr("y",dt+40).attr("fill","var(--color-text-secondary)").attr("class","text-sm text-secondary").text(a()),Z.append("text").attr("text-anchor","middle").attr("transform","rotate(-90)").attr("x",-dt/2).attr("y",-A.left+15).attr("fill","var(--color-text-secondary)").attr("class","text-sm text-secondary").text(s()),!u||!document.body.contains(d(p)))||(Z.selectAll(".type-bars").data(Wt).enter().append("g").attr("class","type-bars").attr("fill",ct=>Yt(ct.key)).selectAll("rect").data(ct=>ct).enter().append("rect").attr("x",ct=>At(ct.data.year.toString())||0).attr("y",ct=>Ft(ct[1])).attr("height",ct=>Ft(ct[0])-Ft(ct[1])).attr("width",At.bandwidth()).attr("stroke","white").attr("stroke-width",1).on("mouseenter",(ct,zt)=>{if(u){const ht=F(zt,Wt);T(ct,ht)}}).on("mousemove",(ct,zt)=>{if(u){const ht=F(zt,Wt);T(ct,ht)}}).on("mouseleave",()=>{u&&E()}),!u||!document.body.contains(d(p))))return;const te=x.map(ct=>{const zt=S.filter(ht=>ht.type===ct).reduce((ht,_t)=>ht+_t.count,0);return{type:ct,count:zt}}).sort((ct,zt)=>zt.count-ct.count);_=Uc({container:d(p),title:h(),items:te.map(ct=>{var zt;return{key:ct.type,label:at(`type.${ct.type}`)!==`type.${ct.type}`?at(`type.${ct.type}`):ct.type,color:Yt(ct.type),value:ct.count,visible:((zt=B.find(ht=>ht.type===ct.type))==null?void 0:zt.visible)??!0,customProperties:{type:ct.type}}}),type:"html",position:"bottom",orientation:"horizontal",className:"multi-row-legend",showValues:!0,valueFormatter:ct=>U(ct),translateKeys:{itemPrefix:"type."},responsive:!0,breakpoint:768,interactive:!0,onItemClick:ct=>{if(!u)return;const zt=B.findIndex(ht=>{var _t;return ht.type===((_t=ct.customProperties)==null?void 0:_t.type)});zt>=0&&(B[zt].visible=!B[zt].visible,B=[...B],C())}}),_.render(),ot.attr("height",k)}catch(M){console.error("Error updating visualization:",M)}}function F(M,x){const A=M.data.year,H=x.map(ot=>{const Z=ot.find(nt=>nt.data.year===A);return{type:ot.key,count:Z?Z[1]-Z[0]:0}}).filter(ot=>ot.count>0),j=H.reduce((ot,Z)=>ot+Z.count,0),dt=[{label:at("viz.type"),value:at("viz.count")+" / %"}];return H.forEach(ot=>{const Z=`type.${ot.type}`;let nt=ot.type;const At=at(Z);At!==Z&&(nt=At),dt.push({label:nt,value:`${U(ot.count)} (${(ot.count/j*100).toFixed(1)}%)`})}),dt.push({label:at("viz.total_items"),value:U(j)}),wn(`${at("viz.year")}: ${A}`,dt)}qe(()=>(u=!0,(async()=>{try{if(await kn(),!d(p)){console.error("Container element not found in onMount");return}I=Dr({container:d(p),onResize:()=>{if(u&&d(p)){const{width:M,height:x}=I.dimensions;$=M,k=x,C()}}}),m=_e.subscribe(M=>{u&&(v=M,d(p)&&(Q(),console.log("Language changed to",M,"- updating legend with",h()),i().items&&i().items.length>0&&(_&&(_.cleanup(),_=null),X(),C())))}),g=fe.subscribe(M=>{u&&M!=null&&M.items&&M.items.length>0&&(lt(),X(),Q(),d(p)&&C())}),i().items&&i().items.length>0?(lt(),X(),Q(),C()):fe.loadItems()}catch(M){console.error("Error during initialization:",M)}})(),()=>{u=!1,I&&I.cleanup(),g&&(g(),g=null),m&&(m(),m=null),_&&(_.cleanup(),_=null),d(p)&&ft(d(p)).selectAll("*").remove()})),In(()=>{u=!1,g&&(g(),g=null),m&&(m(),m=null),_&&(_.cleanup(),_=null),ne(f,"Component destroyed")}),ke(),Lr(t,{title:"",translationKey:"",description:"This visualization shows the distribution of items by type over time. You can filter by country and year range to explore how different types of items have been published over time.",descriptionTranslationKey:"viz.type_distribution_description",get titleHtml(){return d(O)},className:"word-visualization-compact-header",children:(M,x)=>{var A=Uy(),H=N(A),j=N(H),dt=N(j),ot=N(dt),Z=N(ot),nt=pt(ot,2);Hn(nt,5,()=>d(w),pr,(Et,Y)=>{var it=Fy(),xt=N(it),bt=N(xt);{var gt=St=>{var wt=Dy();et(St,wt)};Dt(bt,St=>{d(Y).selected&&St(gt)})}var Ut=pt(xt,2),It=N(Ut),Pt=pt(Ut,2),Zt=N(Pt);kt(()=>{ve(it,"aria-checked",d(Y).selected),cf(it,"selected",d(Y).selected),ut(It,d(Y).label),ut(Zt,d(Y).count)}),ye("click",it,()=>rt(d(Y))),ye("keydown",it,St=>St.key==="Enter"&&rt(d(Y))),et(Et,it)});var At=pt(j,2),Wt=N(At),Ft=N(Wt),le=pt(Wt,2),Yt=N(le),te=N(Yt),ct=N(te),zt=pt(te,2),ht=N(zt),_t=pt(Yt,2),$t=N(_t),Ct=pt($t,2),Rt=pt(H,2),Ot=N(Rt);{var Bt=Et=>{var Y=Ry(),it=N(Y);kt(xt=>ut(it,xt),[()=>at("ui.loading")],re),et(Et,Y)},Mt=Et=>{var Y=ae(),it=Qt(Y);{var xt=bt=>{var gt=Py(),Ut=N(gt);kt(()=>ut(Ut,i().error)),et(bt,gt)};Dt(it,bt=>{i().error&&bt(xt)},!0)}et(Et,Y)};Dt(Ot,Et=>{i().loading?Et(Bt):Et(Mt,!1)})}We(Rt,Et=>D(p,Et),()=>d(p)),kt(()=>{ut(Z,c()),ut(Ft,l()),ut(ct,d(y)[0]),ut(ht,d(y)[1]),ve($t,"min",d(b)[0]),ve($t,"max",d(b)[d(b).length-1]),ts($t,d(y)[0]),ve(Ct,"min",d(b)[0]),ve(Ct,"max",d(b)[d(b).length-1]),ts(Ct,d(y)[1])}),ye("input",$t,K),ye("input",Ct,K),et(M,A)},$$slots:{default:!0}}),Te(),r()}var By=yt('<p class="my-xs text-sm text-secondary"> <strong class="font-medium"> </strong></p>'),Oy=yt('<p class="my-xs text-sm text-secondary"> <strong class="font-medium"> </strong></p> <p class="my-xs text-sm text-secondary"> </p>',1),Wy=yt('<p class="my-xs text-sm text-secondary"> </p>'),Vy=yt('<div class="p-md bg-card rounded shadow mt-md"><div><h3 class="mt-0 mb-sm text-primary text-md font-medium border-b border-solid border-default pb-xs"> </h3> <p class="my-xs text-sm text-secondary"> <strong class="font-medium"> </strong></p> <p class="my-xs text-sm text-secondary"> <strong class="font-medium"> </strong></p> <!> <!></div></div>');function qy(t,e){we(e,!1);const[n,r]=je(),i=()=>mt(v,"$summaryText",n),o=()=>mt(_,"$totalItemsWithWordCountText",n),a=()=>mt(p,"$totalWordsText",n),s=()=>mt($,"$avgWordsPerItemText",n),h=()=>mt(k,"$currentlyViewingText",n),c=()=>mt(w,"$clickBackText",n),l=()=>mt(b,"$clickZoomInText",n);let f=Kt(e,"totalItems",8),u=Kt(e,"totalWordCount",8),g=Kt(e,"zoomedNode",8),m=Kt(e,"formatNumber",8);const v=tt("viz.summary"),_=tt("viz.total_items_with_word_count"),p=tt("viz.total_words"),$=tt("viz.avg_words_per_item"),k=tt("viz.currently_viewing"),w=tt("viz.click_back_to_return"),b=tt("viz.click_zoom_in");ke();var y=Vy(),S=N(y),L=N(S),B=N(L),T=pt(L,2),E=N(T),I=pt(E),P=N(I),W=pt(T,2),J=N(W),z=pt(J),R=N(z),V=pt(W,2);{var st=G=>{var q=By(),X=N(q),lt=pt(X),rt=N(lt);kt(K=>{ut(X,`${s()??""}: `),ut(rt,K)},[()=>m()(Math.round(u()/f()))],re),et(G,q)};Dt(V,G=>{f()>0&&G(st)})}var O=pt(V,2);{var U=G=>{var q=Oy(),X=Qt(q),lt=N(X),rt=pt(lt),K=N(rt),C=pt(X,2),F=N(C);kt(()=>{ut(lt,`${h()??""}: `),ut(K,g().data.name),ut(F,c())}),et(G,q)},Q=G=>{var q=Wy(),X=N(q);kt(()=>ut(X,l())),et(G,q)};Dt(O,G=>{g()?G(U):G(Q,!1)})}kt((G,q)=>{ut(B,i()),ut(E,`${o()??""}: `),ut(P,G),ut(J,`${a()??""}: `),ut(R,q)},[()=>m()(f()),()=>m()(u())],re),et(t,y),Te(),r()}class Yy{static createTreemap(e,n){try{const{container:r,width:i=r.clientWidth,height:o=Math.min(r.clientHeight,500),margin:a={top:10,right:10,bottom:10,left:10},padding:s={outer:3,top:16,inner:1},tooltipCallback:h,hideTooltipCallback:c,zoomCallback:l,currentZoomedNode:f=null,minSizeThreshold:u=.001,useBreadcrumbs:g=!1,rootName:m="All",labelOptions:v={parentLabel:{fontSize:"var(--font-size-sm)",fontWeight:"bold",color:"white"},childLabel:{fontSize:"var(--font-size-xs)",color:"var(--color-text-primary)",minWidth:30,minHeight:20}}}=n;if(ft(r).select("svg").remove(),ft(r).select(".absolute").remove(),!e.children||e.children.length===0)return ue.handleNoData(r),{svg:null,chart:null};r.style.height=`${o}px`,r.style.maxHeight=`${o}px`,r.style.overflow="hidden";const _={...a};f&&g&&(_.top+=30);const{svg:p,chart:$,chartWidth:k,chartHeight:w}=ue.createSVG({container:r,width:i,height:o,margin:_,responsive:!1});p.attr("height",o).attr("viewBox",`0 0 ${i} ${o}`).style("height",`${o}px`).style("max-height",`${o}px`).style("overflow","hidden").on("mouseout",B=>{var T;B.relatedTarget&&!((T=p.node())!=null&&T.contains(B.relatedTarget))&&c&&c()}),f&&(g?this.addBreadcrumbNavigation(p,a,f,m,l):this.addZoomOutButton(p,a,l));const b=Tc().size([k,w]).paddingOuter(s.outer||3).paddingTop(s.top||16).paddingInner(s.inner||1).round(!0);let y;if(f)y=this.prepareZoomedHierarchy(f);else if(y=un(e).sum(B=>B.value||0).sort((B,T)=>(T.value||0)-(B.value||0)),y.children&&u>0){const T=(y.value||0)*u;y.children=y.children.filter(E=>(E.value||0)>T)}try{b(y)}catch(B){return console.error("Error applying treemap layout:",B),ue.handleNoData(r,"Error rendering treemap"),{svg:null,chart:null}}const S=this.createColorScale(y,n);let L;return f&&n.colorMap&&(L=n.colorMap.get(f.data.name)),f?this.renderLeafNodes($,y.children||[],S,h,v,L,c):(this.renderParentNodes($,y.children||[],S,l,v),this.renderLeafNodes($,y.leaves(),S,h,v,void 0,c)),{svg:p,chart:$}}catch(r){return console.error("Error creating treemap:",r),ue.handleNoData(n.container,"Error creating treemap"),{svg:null,chart:null}}}static prepareZoomedHierarchy(e){if(e.data.children&&e.data.children.length>0){const n={name:e.data.name,children:e.data.children};return un(n).sum(r=>r.value||0).sort((r,i)=>(i.value||0)-(r.value||0))}else if(e.children&&e.children.length>0){const n=e.children.map(i=>({name:i.data.name,value:i.data.value||i.value,wordCount:i.data.wordCount,itemCount:i.data.itemCount})),r={name:e.data.name,children:n};return un(r).sum(i=>i.value||0).sort((i,o)=>(o.value||0)-(i.value||0))}else return console.warn("Zoomed node has no valid children data"),un({name:"Empty",children:[]}).sum(n=>n.value||0)}static createColorScale(e,n){if(n.colors)return n.colors;const r=Ce().domain(e.children?e.children.map(i=>i.data.name):[e.data.name]).range(on);return n.colorMap&&e.children&&e.children.forEach(i=>{n.colorMap&&!n.colorMap.has(i.data.name)&&n.colorMap.set(i.data.name,r(i.data.name))}),r}static addZoomOutButton(e,n,r){if(!r)return;const i=e.append("g").attr("class","zoom-out-button cursor-pointer").attr("transform",`translate(${n.left}, ${n.top})`).on("click",()=>r(null));i.append("rect").attr("width",100).attr("height",24).attr("rx",4).attr("fill","var(--primary-color)").attr("opacity",.8),i.append("text").attr("x",50).attr("y",16).attr("text-anchor","middle").attr("fill","white").attr("font-size","var(--font-size-sm)").text("Back to All")}static addBreadcrumbNavigation(e,n,r,i,o){var f,u;if(!o)return;const a=30,s=((f=e.node())==null?void 0:f.getBoundingClientRect().width)||300;e.append("rect").attr("x",0).attr("y",0).attr("width",s).attr("height",a).attr("fill","white").attr("opacity",.9);const h=e.append("g").attr("class","breadcrumb-navigation").attr("transform",`translate(${n.left+10}, ${n.top+10})`),l=((u=h.append("text").attr("x",0).attr("y",5).attr("font-size","var(--font-size-sm)").attr("fill","var(--primary-color)").attr("class","cursor-pointer").text(i).on("click",()=>o(null)).node())==null?void 0:u.getComputedTextLength())||20;h.append("line").attr("x1",0).attr("y1",22).attr("x2",l).attr("y2",22).attr("stroke","var(--primary-color)").attr("stroke-width",1),h.append("text").attr("x",l+8).attr("y",5).attr("font-size","var(--font-size-sm)").attr("fill","var(--color-text-secondary)").text("/"),h.append("text").attr("x",l+20).attr("y",5).attr("font-size","var(--font-size-sm)").attr("font-weight","bold").attr("fill","var(--color-text-primary)").text(r.data.name)}static renderParentNodes(e,n,r,i,o){var s,h,c;const a=e.selectAll(".parent-node").data(n).enter().append("g").attr("class","parent-node").attr("transform",l=>{const f=l.x0||0,u=l.y0||0;return`translate(${f},${u})`});a.append("rect").attr("width",l=>{const f=l.x0||0,u=l.x1||0;return Math.max(0,u-f)}).attr("height",l=>{const f=l.y0||0,u=l.y1||0;return Math.max(0,u-f)}).attr("fill",l=>r(l.data.name)).attr("stroke","white").attr("stroke-width",2).attr("opacity",.7).attr("class","cursor-pointer").on("click",(l,f)=>{i&&i(f)}),a.append("text").attr("x",5).attr("y",15).attr("font-size",((s=o==null?void 0:o.parentLabel)==null?void 0:s.fontSize)||"var(--font-size-sm)").attr("font-weight",((h=o==null?void 0:o.parentLabel)==null?void 0:h.fontWeight)||"bold").attr("fill",((c=o==null?void 0:o.parentLabel)==null?void 0:c.color)||"white").text(l=>{var u;return l.x1-l.x0-10<150?l.data.name:`${l.data.name} (${((u=l.data.wordCount)==null?void 0:u.toLocaleString())||0})`}).attr("pointer-events","none").each(function(l){var m;const f=ft(this),u=this.getComputedTextLength(),g=l.x1-l.x0-10;if(u>g){let v=l.data.name;f.text(v);let _=this.getComputedTextLength(),p=!1;for(;_>g&&v.length>3;)v=v.slice(0,-1),f.text(v),_=this.getComputedTextLength(),p=!0;p&&f.text(v+"..."),f.append("title").text(`${l.data.name} (${((m=l.data.wordCount)==null?void 0:m.toLocaleString())||0})`)}})}static renderLeafNodes(e,n,r,i,o,a,s){var c,l;const h=e.selectAll(".leaf-node").data(n).enter().append("g").attr("class","leaf-node").attr("transform",f=>{const u=f.x0||0,g=f.y0||0;return`translate(${u},${g})`});h.append("rect").attr("width",f=>{const u=f.x0||0,g=f.x1||0;return Math.max(0,g-u)}).attr("height",f=>{const u=f.y0||0,g=f.y1||0;return Math.max(0,g-u)}).attr("fill",f=>a||(f.parent?r(f.parent.data.name):r(f.data.name))).attr("stroke","white").attr("stroke-width",.5).attr("class","cursor-pointer").on("mouseover",function(f,u){ft(this).attr("stroke","var(--primary-color)").attr("stroke-width",2),i&&i(f,u)}).on("mousemove",function(f,u){i&&i(f,u)}).on("mouseout",function(){ft(this).attr("stroke","white").attr("stroke-width",.5),s&&s()}),h.append("text").attr("x",3).attr("y",13).attr("font-size",((c=o==null?void 0:o.childLabel)==null?void 0:c.fontSize)||"var(--font-size-xs)").attr("fill",((l=o==null?void 0:o.childLabel)==null?void 0:l.color)||"var(--color-text-primary)").attr("pointer-events","none").each(function(f){var S,L,B,T;const u=ft(this),g=f.x1-f.x0,m=f.y1-f.y0,v=((S=o==null?void 0:o.childLabel)==null?void 0:S.minWidth)||30,_=((L=o==null?void 0:o.childLabel)==null?void 0:L.minHeight)||20;if(g<v||m<_)return;let p=f.data.name;const $=g-6,k=f.parent?f.parent.data.name:"";u.text(p).append("title").text(`${k} > ${f.data.name}: ${((B=f.data.wordCount)==null?void 0:B.toLocaleString())||0} (${f.data.itemCount||0} items)`);const w=this;let b=w.getComputedTextLength(),y=!1;for(;b>$&&p.length>3;)p=p.slice(0,-1),u.text(p),b=w.getComputedTextLength(),y=!0;y&&(u.text(p+"..."),u.append("title").text(`${k} > ${f.data.name}: ${((T=f.data.wordCount)==null?void 0:T.toLocaleString())||0} (${f.data.itemCount||0} items)`))})}}function Gy(t){if(!t||t.length===0)return{name:"root",children:[]};const e=t.filter(i=>i.word_count!==void 0&&i.word_count>0&&i.country),n=new Map;e.forEach(i=>{const o=i.country||"Unknown",a=i.item_set_title||"No Set",s=i.word_count||0;n.has(o)||n.set(o,{words:0,items:0,sets:new Map});const h=n.get(o);h.words+=s,h.items+=1,h.sets.has(a)||h.sets.set(a,{words:0,items:0});const c=h.sets.get(a);c.words+=s,c.items+=1});const r={name:"Word Distribution",children:Array.from(n.entries()).map(([i,o])=>({name:i,wordCount:o.words,itemCount:o.items,children:Array.from(o.sets.entries()).map(([a,s])=>({name:a,value:s.words,wordCount:s.words,itemCount:s.items}))}))};return r.children&&(r.children.sort((i,o)=>(o.wordCount||0)-(i.wordCount||0)),r.children.forEach(i=>{i.children&&i.children.sort((o,a)=>(a.wordCount||0)-(o.wordCount||0))})),r}var Ky=yt('<div class="absolute inset-center text-secondary"> </div>'),Xy=yt('<div class="absolute inset-center text-error"> </div>'),Zy=yt('<div class="flex-1 min-h-500 relative overflow-hidden bg-card rounded shadow" style="height: 500px; max-height: 500px;"><!></div> <!>',1),Jy=yt('<div class="w-full h-full flex flex-col gap-md"><!></div>');function Qy(t,e){we(e,!1);const[n,r]=je(),i=()=>mt(W,"$wordsText",n),o=()=>mt(fe,"$itemsStore",n),a=()=>mt(J,"$itemsText",n),s=()=>mt(P,"$avgWordsPerItemText",n),h=()=>mt(z,"$percentOfCountryText",n),c=()=>mt(R,"$percentOfTotalText",n),l=()=>mt(I,"$noDataText",n),f="WordDistributionRefactored";let u=!1,g,m=vt(),v=0,_=0,p=vt(0),$=vt(0),k={name:"root",children:[]},w=vt(null),b=0,y=vt(""),S="en",L=new Map;const{showTooltip:B,hideTooltip:T}=Ao({maxWidth:"250px"});let E;const I=tt("viz.no_data");tt("viz.word_distribution"),tt("viz.total_words");const P=tt("viz.avg_words_per_item");tt("viz.click_zoom_in"),tt("viz.click_zoom_out"),tt("viz.unknown"),tt("viz.no_set"),tt("viz.back_to_all"),tt("viz.total_items_with_word_count");const W=tt("viz.words"),J=tt("viz.items"),z=tt("viz.percent_of_country"),R=tt("viz.percent_of_total");tt("viz.item_set_summary");const{filterItems:V}=Je({filterMissingValues:!0,requiredFields:["word_count","country"],filterFn:C=>!!(C.word_count!==void 0&&C.word_count>0&&C.country)});function st(C){return C.toLocaleString(S==="fr"?"fr-FR":"en-US")}function O(){d($)>0?S==="en"?D(y,`Distribution of ${st(d(p))} ${i()} by country and sub-collection`):D(y,`Répartition de ${st(d(p))} ${i()} par pays et sous-collection`):D(y,at("viz.word_distribution"))}function U(){d(w)&&(S==="en"?D(y,`${d(w).data.name}: ${st(d(w).data.wordCount||0)} ${i()}`):D(y,`${d(w).data.name}: ${st(d(w).data.wordCount||0)} ${i()}`))}function Q(){var F,M;if(!o().items||o().items.length===0)return D($,0),D(p,0),O(),{name:"root",children:[]};const C=Gy(o().items);return D($,((F=C.children)==null?void 0:F.reduce((x,A)=>x+(A.itemCount||0),0))||0),D(p,((M=C.children)==null?void 0:M.reduce((x,A)=>x+(A.wordCount||0),0))||0),b=d(p),O(),C}function G(C){if(D(w,C),d(w))D($,d(w).data.itemCount||0),D(p,d(w).data.wordCount||0),U();else{if(o().items&&o().items.length>0){const F=V(o().items);D($,F.length),D(p,F.reduce((M,x)=>M+(x.word_count||0),0))}O()}X()}function q(C,F){try{if(!C){ne(f,"Event object is undefined in handleShowTooltip");return}const M=F.parent?F.parent.data.name:F.data.name,x=F.parent?F.data.name:"All",A=F.data.wordCount||0,H=F.data.itemCount||0,j=H>0?Math.round(A/H):0,dt=d(w)?d(w).data.wordCount:F.parent?F.parent.data.wordCount:0,ot=dt&&dt>0?(A/dt*100).toFixed(1)+"%":"N/A",Z=b>0?(A/b*100).toFixed(1)+"%":"N/A",nt=wn(`${M} > ${x}`,[{label:i(),value:A.toLocaleString()},{label:a(),value:H},{label:s(),value:j},{label:h(),value:ot},{label:c(),value:Z}]);B(C,nt,250,150),ne(f,"Tooltip shown",{country:M,itemSet:x})}catch(M){console.error("Error showing tooltip:",M),ne(f,"Error showing tooltip",M)}}function X(C=k){try{if(!d(m)){console.error("Container element not found");return}if(!C.children||C.children.length===0){ft(d(m)).select("svg").remove(),ft(d(m)).append("div").attr("class","absolute inset-center text-secondary").text(l());return}Yy.createTreemap(C,{container:d(m),height:500,colorMap:L,tooltipCallback:q,hideTooltipCallback:T,zoomCallback:G,currentZoomedNode:d(w),useBreadcrumbs:!0,rootName:S==="en"?"All":"Tous",labelOptions:{parentLabel:{fontSize:"var(--font-size-sm)",fontWeight:"bold",color:"white"},childLabel:{fontSize:"var(--font-size-xs)",color:"var(--color-text-primary)",minWidth:30,minHeight:20}}})}catch(F){console.error("Error in updateVisualization:",F)}}function lt(C){!u||!d(m)||(ne(f,"Items store changed",{itemCount:(C==null?void 0:C.length)||0}),document.body.contains(d(m))&&(d(w)||(k=Q(),X(k))))}qe(()=>{try{u=!0,ne(f,"Component mounted");const F=(async()=>{if(await kn(),!d(m))return console.error("Container element not found in onMount"),()=>{};E=Dr({container:d(m),onResize:()=>{if(u&&d(m)){const{width:x}=E.dimensions;v=x,_=500,X()}},debounce:!0,debounceDelay:300}),v=d(m).clientWidth,_=Math.min(d(m).clientHeight,500);const M=_e.subscribe(x=>{u&&(S=x,d(w)?U():O(),d(m)&&document.body.contains(d(m))&&X())});return g=fe.subscribe(x=>{lt(x.items)}),o().items&&o().items.length>0?(k=Q(),X(k)):fe.loadItems(),()=>{try{u=!1,ne(f,"Component cleanup started"),d(m)&&(ft(d(m)).selectAll("*").remove(),ne(f,"D3 selections removed")),E&&(E.cleanup(),ne(f,"Resize hook cleaned up")),g&&(g(),ne(f,"Unsubscribed from items store")),M&&(M(),ne(f,"Unsubscribed from language store")),ne(f,"Component cleanup completed")}catch(x){console.error("Error during cleanup:",x)}}})();return()=>{F.then(M=>M())}}catch(C){return console.error("Error in onMount:",C),()=>{}}}),In(()=>{if(u){u=!1,ne(f,"Component destroyed (backup cleanup)");try{E&&(E.cleanup(),ne(f,"Resize hook cleaned up (backup)")),g&&(g(),ne(f,"Unsubscribed from items store (backup)"))}catch(C){console.error("Error during backup cleanup:",C)}}}),ke();var rt=Jy(),K=N(rt);Lr(K,{title:"",translationKey:"",description:"This visualization shows the distribution of words across items by country and collection. The size of each block represents the word count in that country or collection.",descriptionTranslationKey:"viz.word_distribution_description",get titleHtml(){return d(y)},className:"word-visualization-compact-header",children:(C,F)=>{var M=Zy(),x=Qt(M),A=N(x);{var H=ot=>{var Z=Ky(),nt=N(Z);kt(At=>ut(nt,At),[()=>at("ui.loading")],re),et(ot,Z)},j=ot=>{var Z=ae(),nt=Qt(Z);{var At=Wt=>{var Ft=Xy(),le=N(Ft);kt(()=>ut(le,o().error)),et(Wt,Ft)};Dt(nt,Wt=>{o().error&&Wt(At)},!0)}et(ot,Z)};Dt(A,ot=>{o().loading?ot(H):ot(j,!1)})}We(x,ot=>D(m,ot),()=>d(m));var dt=pt(x,2);qy(dt,{get totalItems(){return d($)},get totalWordCount(){return d(p)},get zoomedNode(){return d(w)},formatNumber:st}),et(C,M)},$$slots:{default:!0}}),et(t,rt),Te(),r()}function jy(t,e,n){const r=new URL(window.location.href);return r.searchParams.set("lang",t),r.searchParams.set("tab",e),r.toString()}function t_(){if(typeof window>"u")return{lang:null,tab:null};const t=new URLSearchParams(window.location.search),e=t.get("lang"),n=t.get("tab");return{lang:e==="en"||e==="fr"?e:null,tab:n}}function il(t,e){if(typeof window>"u")return;const n=jy(t,e);window.history.pushState({},"",n)}var e_=yt('<li role="tab" tabindex="0"> </li>'),n_=yt('<div class="flex justify-center items-center font-lg loading-container svelte-1w47g2g"> </div>'),r_=yt('<div class="flex justify-center items-center font-lg text-error loading-container svelte-1w47g2g"> </div>'),i_=yt('<main class="container mx-auto p-md"><header class="mb-lg"><div class="flex justify-between items-center mb-md"><h1 class="m-0 text-xl text-primary"><!></h1> <div class="flex gap-md items-center"><!> <!> <!></div></div> <nav><ul class="flex p-0 m-0 border-b list-style-none app-tabs tabs-container svelte-1w47g2g"><div class="tab-scroll-left-indicator"></div> <div class="tab-scroll-indicator"></div> <!></ul></nav></header> <div class="bg-card rounded shadow p-md content-container svelte-1w47g2g"><!></div></main> <!>',1);function o_(t,e){we(e,!1);const[n,r]=je(),i=()=>mt(_e,"$languageStore",n),o=()=>mt(fe,"$itemsStore",n),a=()=>mt(m,"$appTitle",n),s=vt(),h="App";let c=vt(!1),l=0,f=()=>{},u=0,g=vt();const m=tt("app.title");let v=vt("countries");const _=[{id:"countries",label:"tab.countries"},{id:"types",label:"tab.types"},{id:"words",label:"tab.words"},{id:"languages",label:"tab.languages"},{id:"categories",label:"tab.categories"},{id:"timeline",label:"tab.timeline"}];let p="",$="";function k(){if(typeof window>"u")return;const{lang:T,tab:E}=t_();ne(h,`URL parameters: lang=${T}, tab=${E}`),T&&(_e.setLanguage(T),ne(h,`Setting language from URL: ${T}`)),E&&_.some(I=>I.id===E)&&(D(v,E),ne(h,`Setting tab from URL: ${E}`))}function w(){if(!d(g))return;d(g).scrollWidth>d(g).clientWidth?d(g).classList.add("tab-scroll-active"):d(g).classList.remove("tab-scroll-active")}function b(){if(!d(g))return;const T=d(g).querySelector(".tab-item.active");if(!T)return;const E=d(g).getBoundingClientRect(),I=T.getBoundingClientRect(),P=I.right<=E.right,W=I.left>=E.left;if(P){if(!W)try{T.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})}catch{Bo(g,d(g).scrollLeft+=I.left-E.left-16)}}else try{T.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})}catch{Bo(g,d(g).scrollLeft+=I.right-E.right+16)}}function y(T){D(v,T),p&&il(p,T),setTimeout(()=>{b()},50)}function S(T){var E;if(!d(c)){ne(h,`Language change ignored (not mounted): ${T}`);return}$=p,p=T,il(T,d(v)),D(s,_.map(I=>({...I,translatedLabel:at(I.label)}))),ne(h,`Language changed from ${$} to ${T}`,{isMounted:d(c),updateCount:l,subscriptionActive:!!f}),ne(h,"Current translations:",{title:at("app.title"),loading:at("ui.loading"),activeTab:at(((E=_.find(I=>I.id===d(v)))==null?void 0:E.label)||"")}),setTimeout(()=>{w(),b()},100)}xf(()=>{u++,ne(h,`Before update (render #${u})`,{isMounted:d(c),currentLanguage:p,activeTab:d(v)})}),qe(()=>{try{D(c,!0),k(),ne(h,`Component mounted, initial language: ${i()}`,{storeValue:i(),activeTab:d(v)}),p=i(),D(s,_.map(T=>({...T,translatedLabel:at(T.label)})));try{f=_e.subscribe(E=>{S(E)}),ne(h,"Successfully subscribed to language store")}catch(T){ne(h,`Error subscribing to language store: ${T}`)}if((!o().items||o().items.length===0)&&fe.loadItems(),d(g)){if(w(),navigator.userAgent.toLowerCase().indexOf("firefox")>-1){const T=document.createElement("style");T.textContent=".tabs-container { scrollbar-width: none; }",T.setAttribute("data-firefox-scrollbar","true"),document.head.appendChild(T)}d(g).addEventListener("scroll",L),d(g).dispatchEvent(new Event("scroll")),window.addEventListener("resize",B),setTimeout(()=>{b()},100)}}catch(T){console.error("[App] Error in onMount:",T)}}),In(()=>{try{if(f&&f(),D(c,!1),ne(h,"Component unmounted"),d(g)){d(g).removeEventListener("scroll",L);const T=document.querySelector("style[data-firefox-scrollbar]");T&&T.remove()}window.removeEventListener("resize",B)}catch(T){console.error("[App] Error in onDestroy:",T)}}),bf(()=>{l++,ne(h,`Component updated (${l})`,{isMounted:d(c),currentLanguage:p,storeValue:i(),activeTab:d(v)}),setTimeout(()=>{w()},50)});function L(){if(!d(g))return;const T=d(g).scrollLeft+d(g).clientWidth>=d(g).scrollWidth-5,E=d(g).scrollLeft<=5;T?d(g).classList.remove("tab-scroll-active"):d(g).classList.add("tab-scroll-active"),E?d(g).classList.remove("tab-scroll-not-at-start"):d(g).classList.add("tab-scroll-not-at-start")}function B(){w(),b()}ge(()=>at,()=>{D(s,_.map(T=>({...T,translatedLabel:at(T.label)})))}),ge(()=>(i(),d(c),at),()=>{i()&&d(c)&&D(s,_.map(T=>({...T,translatedLabel:at(T.label)})))}),hi(),ke(),Lf(t,{children:(T,E)=>{var I=i_(),P=Qt(I),W=N(P),J=N(W),z=N(J),R=N(z);Rl(R,a);var V=pt(z,2),st=N(V);Nf(st,{});var O=pt(st,2);Ef(O,{});var U=pt(O,2);zf(U,{});var Q=pt(J,2),G=N(Q),q=pt(N(G),4);Hn(q,1,()=>d(s),pr,(F,M)=>{var x=e_(),A=N(x);kt(()=>{wo(x,`py-sm px-md cursor-pointer transition tab-item tab-flexible tabs-mobile ${(d(v)===d(M).id?"active":"")??""} svelte-1w47g2g`),ve(x,"aria-selected",d(v)===d(M).id),ut(A,d(M).translatedLabel)}),ye("click",x,()=>y(d(M).id)),ye("keydown",x,H=>H.key==="Enter"&&y(d(M).id)),et(F,x)}),We(G,F=>D(g,F),()=>d(g));var X=pt(W,2),lt=N(X);{var rt=F=>{var M=n_(),x=N(M);kt(A=>ut(x,A),[()=>at("ui.loading")],re),et(F,M)},K=F=>{var M=ae(),x=Qt(M);{var A=j=>{var dt=r_(),ot=N(dt);kt(()=>ut(ot,o().error)),et(j,dt)},H=j=>{var dt=ae(),ot=Qt(dt);{var Z=At=>{P0(At,{})},nt=At=>{var Wt=ae(),Ft=Qt(Wt);{var le=te=>{Hy(te,{})},Yt=te=>{var ct=ae(),zt=Qt(ct);{var ht=$t=>{Qy($t,{})},_t=$t=>{var Ct=ae(),Rt=Qt(Ct);{var Ot=Mt=>{ly(Mt,{})},Bt=Mt=>{var Et=ae(),Y=Qt(Et);{var it=bt=>{gy(bt,{})},xt=bt=>{var gt=ae(),Ut=Qt(gt);{var It=Pt=>{My(Pt,{})};Dt(Ut,Pt=>{d(v)==="timeline"&&Pt(It)},!0)}et(bt,gt)};Dt(Y,bt=>{d(v)==="categories"?bt(it):bt(xt,!1)},!0)}et(Mt,Et)};Dt(Rt,Mt=>{d(v)==="languages"?Mt(Ot):Mt(Bt,!1)},!0)}et($t,Ct)};Dt(zt,$t=>{d(v)==="words"?$t(ht):$t(_t,!1)},!0)}et(te,ct)};Dt(Ft,te=>{d(v)==="types"?te(le):te(Yt,!1)},!0)}et(At,Wt)};Dt(ot,At=>{d(v)==="countries"?At(Z):At(nt,!1)})}et(j,dt)};Dt(x,j=>{o().error?j(A):j(H,!1)},!0)}et(F,M)};Dt(lt,F=>{o().loading?F(rt):F(K,!1)})}var C=pt(P,2);Dt(C,F=>{}),et(T,I)},$$slots:{default:!0}}),Te(),r()}ju(o_,{target:document.getElementById("app")});
