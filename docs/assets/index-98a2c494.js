(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();function Tt(){}const ql=t=>t;function Vl(t,e){for(const n in e)t[n]=e[n];return t}function Fo(t){return t()}function ci(){return Object.create(null)}function Ht(t){t.forEach(Fo)}function or(t){return typeof t=="function"}function qt(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function Xl(t){return Object.keys(t).length===0}function Yr(t,...e){if(t==null)return Tt;const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function jl(t){let e;return Yr(t,n=>e=n)(),e}function mt(t,e,n){t.$$.on_destroy.push(Yr(e,n))}function Ho(t,e,n,r){if(t){const i=Ro(t,e,n,r);return t[0](i)}}function Ro(t,e,n,r){return t[1]&&r?Vl(n.ctx.slice(),t[1](r(e))):n.ctx}function Oo(t,e,n,r){if(t[2]&&r){const i=t[2](r(n));if(e.dirty===void 0)return i;if(typeof i=="object"){const o=[],l=Math.max(e.dirty.length,i.length);for(let a=0;a<l;a+=1)o[a]=e.dirty[a]|i[a];return o}return e.dirty|i}return e.dirty}function Yo(t,e,n,r,i,o){if(i){const l=Ro(e,n,r,o);t.p(l,i)}}function Wo(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let r=0;r<n;r++)e[r]=-1;return e}return-1}const Po=typeof window<"u";let Kl=Po?()=>window.performance.now():()=>Date.now(),Wr=Po?t=>requestAnimationFrame(t):Tt;const Re=new Set;function Bo(t){Re.forEach(e=>{e.c(t)||(Re.delete(e),e.f())}),Re.size!==0&&Wr(Bo)}function Zl(t){let e;return Re.size===0&&Wr(Bo),{promise:new Promise(n=>{Re.add(e={c:t,f:n})}),abort(){Re.delete(e)}}}function p(t,e){t.appendChild(e)}function qo(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function Gl(t){const e=M("style");return Ql(qo(t),e),e.sheet}function Ql(t,e){return p(t.head||t,e),e.sheet}function Q(t,e,n){t.insertBefore(e,n||null)}function Z(t){t.parentNode&&t.parentNode.removeChild(t)}function Be(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function M(t){return document.createElement(t)}function dn(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function H(t){return document.createTextNode(t)}function ht(){return H(" ")}function Vo(){return H("")}function Lt(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function T(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function Jl(t){return Array.from(t.childNodes)}function tt(t,e){e=""+e,t.data!==e&&(t.data=e)}function pe(t,e,n){for(let r=0;r<t.options.length;r+=1){const i=t.options[r];if(i.__value===e){i.selected=!0;return}}(!n||e!==void 0)&&(t.selectedIndex=-1)}function fi(t){const e=t.querySelector(":checked");return e&&e.__value}function ge(t,e,n){t.classList[n?"add":"remove"](e)}function ta(t,e,{bubbles:n=!1,cancelable:r=!1}={}){const i=document.createEvent("CustomEvent");return i.initCustomEvent(t,n,r,e),i}class ea{constructor(e=!1){this.is_svg=!1,this.is_svg=e,this.e=this.n=null}c(e){this.h(e)}m(e,n,r=null){this.e||(this.is_svg?this.e=dn(n.nodeName):this.e=M(n.nodeType===11?"TEMPLATE":n.nodeName),this.t=n.tagName!=="TEMPLATE"?n:n.content,this.c(e)),this.i(r)}h(e){this.e.innerHTML=e,this.n=Array.from(this.e.nodeName==="TEMPLATE"?this.e.content.childNodes:this.e.childNodes)}i(e){for(let n=0;n<this.n.length;n+=1)Q(this.t,this.n[n],e)}p(e){this.d(),this.h(e),this.i(this.a)}d(){this.n.forEach(Z)}}const Rn=new Map;let On=0;function na(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}function ra(t,e){const n={stylesheet:Gl(e),rules:{}};return Rn.set(t,n),n}function di(t,e,n,r,i,o,l,a=0){const c=16.666/r;let s=`{
`;for(let b=0;b<=1;b+=c){const C=e+(n-e)*o(b);s+=b*100+`%{${l(C,1-C)}}
`}const u=s+`100% {${l(n,1-n)}}
}`,d=`__svelte_${na(u)}_${a}`,f=qo(t),{stylesheet:h,rules:g}=Rn.get(f)||ra(f,t);g[d]||(g[d]=!0,h.insertRule(`@keyframes ${d} ${u}`,h.cssRules.length));const k=t.style.animation||"";return t.style.animation=`${k?`${k}, `:""}${d} ${r}ms linear ${i}ms 1 both`,On+=1,d}function ia(t,e){const n=(t.style.animation||"").split(", "),r=n.filter(e?o=>o.indexOf(e)<0:o=>o.indexOf("__svelte")===-1),i=n.length-r.length;i&&(t.style.animation=r.join(", "),On-=i,On||oa())}function oa(){Wr(()=>{On||(Rn.forEach(t=>{const{ownerNode:e}=t.stylesheet;e&&Z(e)}),Rn.clear())})}let hn;function fn(t){hn=t}function bn(){if(!hn)throw new Error("Function called outside component initialization");return hn}function Xo(t){bn().$$.before_update.push(t)}function ye(t){bn().$$.on_mount.push(t)}function jo(t){bn().$$.after_update.push(t)}function lr(t){bn().$$.on_destroy.push(t)}function la(t,e){return bn().$$.context.set(t,e),e}const Ee=[],ce=[];let Oe=[];const Cr=[],Ko=Promise.resolve();let zr=!1;function Zo(){zr||(zr=!0,Ko.then(Go))}function xe(){return Zo(),Ko}function ke(t){Oe.push(t)}function aa(t){Cr.push(t)}const dr=new Set;let $e=0;function Go(){if($e!==0)return;const t=hn;do{try{for(;$e<Ee.length;){const e=Ee[$e];$e++,fn(e),sa(e.$$)}}catch(e){throw Ee.length=0,$e=0,e}for(fn(null),Ee.length=0,$e=0;ce.length;)ce.pop()();for(let e=0;e<Oe.length;e+=1){const n=Oe[e];dr.has(n)||(dr.add(n),n())}Oe.length=0}while(Ee.length);for(;Cr.length;)Cr.pop()();zr=!1,dr.clear(),fn(t)}function sa(t){if(t.fragment!==null){t.update(),Ht(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(ke)}}function ua(t){const e=[],n=[];Oe.forEach(r=>t.indexOf(r)===-1?e.push(r):n.push(r)),n.forEach(r=>r()),Oe=e}let Je;function ca(){return Je||(Je=Promise.resolve(),Je.then(()=>{Je=null})),Je}function hr(t,e,n){t.dispatchEvent(ta(`${e?"intro":"outro"}${n}`))}const En=new Set;let ae;function Pr(){ae={r:0,c:[],p:ae}}function Br(){ae.r||Ht(ae.c),ae=ae.p}function At(t,e){t&&t.i&&(En.delete(t),t.i(e))}function St(t,e,n,r){if(t&&t.o){if(En.has(t))return;En.add(t),ae.c.push(()=>{En.delete(t),r&&(n&&t.d(1),r())}),t.o(e)}else r&&r()}const fa={duration:0};function hi(t,e,n,r){const i={direction:"both"};let o=e(t,n,i),l=r?0:1,a=null,c=null,s=null;function u(){s&&ia(t,s)}function d(h,g){const k=h.b-l;return g*=Math.abs(k),{a:l,b:h.b,d:k,duration:g,start:h.start,end:h.start+g,group:h.group}}function f(h){const{delay:g=0,duration:k=300,easing:b=ql,tick:C=Tt,css:w}=o||fa,y={start:Kl()+g,b:h};h||(y.group=ae,ae.r+=1),a||c?c=y:(w&&(u(),s=di(t,l,h,k,g,b,w)),h&&C(0,1),a=d(y,k),ke(()=>hr(t,h,"start")),Zl(m=>{if(c&&m>c.start&&(a=d(c,k),c=null,hr(t,a.b,"start"),w&&(u(),s=di(t,l,a.b,a.duration,0,b,o.css))),a){if(m>=a.end)C(l=a.b,1-l),hr(t,a.b,"end"),c||(a.b?u():--a.group.r||Ht(a.group.c)),a=null;else if(m>=a.start){const N=m-a.start;l=a.a+a.d*b(N/a.duration),C(l,1-l)}}return!!(a||c)}))}return{run(h){or(o)?ca().then(()=>{o=o(i),f(h)}):f(h)},end(){u(),a=c=null}}}function pi(t,e){t.d(1),e.delete(t.key)}function gi(t,e,n,r,i,o,l,a,c,s,u,d){let f=t.length,h=o.length,g=f;const k={};for(;g--;)k[t[g].key]=g;const b=[],C=new Map,w=new Map,y=[];for(g=h;g--;){const x=d(i,o,g),L=n(x);let S=l.get(L);S?r&&y.push(()=>S.p(x,e)):(S=s(L,x),S.c()),C.set(L,b[g]=S),L in k&&w.set(L,Math.abs(g-k[L]))}const m=new Set,N=new Set;function z(x){At(x,1),x.m(a,u),l.set(x.key,x),u=x.first,h--}for(;f&&h;){const x=b[h-1],L=t[f-1],S=x.key,$=L.key;x===L?(u=x.first,f--,h--):C.has($)?!l.has(S)||m.has(S)?z(x):N.has($)?f--:w.get(S)>w.get($)?(N.add(S),z(x)):(m.add($),f--):(c(L,l),f--)}for(;f--;){const x=t[f];C.has(x.key)||c(x,l)}for(;h;)z(b[h-1]);return Ht(y),b}function da(t,e,n){const r=t.$$.props[e];r!==void 0&&(t.$$.bound[r]=n,n(t.$$.ctx[r]))}function Vt(t){t&&t.c()}function Wt(t,e,n,r){const{fragment:i,after_update:o}=t.$$;i&&i.m(e,n),r||ke(()=>{const l=t.$$.on_mount.map(Fo).filter(or);t.$$.on_destroy?t.$$.on_destroy.push(...l):Ht(l),t.$$.on_mount=[]}),o.forEach(ke)}function Pt(t,e){const n=t.$$;n.fragment!==null&&(ua(n.after_update),Ht(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function ha(t,e){t.$$.dirty[0]===-1&&(Ee.push(t),Zo(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Gt(t,e,n,r,i,o,l,a=[-1]){const c=hn;fn(t);const s=t.$$={fragment:null,ctx:[],props:o,update:Tt,not_equal:i,bound:ci(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(c?c.$$.context:[])),callbacks:ci(),dirty:a,skip_bound:!1,root:e.target||c.$$.root};l&&l(s.root);let u=!1;if(s.ctx=n?n(t,e.props||{},(d,f,...h)=>{const g=h.length?h[0]:f;return s.ctx&&i(s.ctx[d],s.ctx[d]=g)&&(!s.skip_bound&&s.bound[d]&&s.bound[d](g),u&&ha(t,d)),f}):[],s.update(),u=!0,Ht(s.before_update),s.fragment=r?r(s.ctx):!1,e.target){if(e.hydrate){const d=Jl(e.target);s.fragment&&s.fragment.l(d),d.forEach(Z)}else s.fragment&&s.fragment.c();e.intro&&At(t.$$.fragment),Wt(t,e.target,e.anchor,e.customElement),Go()}fn(c)}class Qt{$destroy(){Pt(this,1),this.$destroy=Tt}$on(e,n){if(!or(n))return Tt;const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(n),()=>{const i=r.indexOf(n);i!==-1&&r.splice(i,1)}}$set(e){this.$$set&&!Xl(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const De=[];function pa(t,e){return{subscribe:qr(t,e).subscribe}}function qr(t,e=Tt){let n;const r=new Set;function i(a){if(qt(t,a)&&(t=a,n)){const c=!De.length;for(const s of r)s[1](),De.push(s,t);if(c){for(let s=0;s<De.length;s+=2)De[s][0](De[s+1]);De.length=0}}}function o(a){i(a(t))}function l(a,c=Tt){const s=[a,c];return r.add(s),r.size===1&&(n=e(i)||Tt),a(t),()=>{r.delete(s),r.size===0&&n&&(n(),n=null)}}return{set:i,update:o,subscribe:l}}function ga(t,e,n){const r=!Array.isArray(t),i=r?[t]:t,o=e.length<2;return pa(n,l=>{let a=!1;const c=[];let s=0,u=Tt;const d=()=>{if(s)return;u();const h=e(r?c[0]:c,l);o?l(h):u=or(h)?h:Tt},f=i.map((h,g)=>Yr(h,k=>{c[g]=k,s&=~(1<<g),a&&d()},()=>{s|=1<<g}));return a=!0,d(),function(){Ht(f),u(),a=!1}})}const ma=()=>{const{subscribe:t,set:e,update:n}=qr({items:[],loading:!1,error:null});return{subscribe:t,loadItems:async()=>{n(r=>({...r,loading:!0,error:null}));try{const o=await(await fetch("/IWAC-overview/items.json")).json();e({items:o,loading:!1,error:null})}catch(r){n(i=>({...i,loading:!1,error:r instanceof Error?r.message:"Failed to load items"}))}}}},Et=ma(),Qo={en:{"app.title":"IWAC Database Overview","tab.countries":"Country Distribution","tab.languages":"Languages","tab.timeline":"Timeline","tab.types":"Type Distribution","tab.categories":"Index Categories","tab.words":"Word Distribution","ui.loading":"Loading database...","ui.select_visualization":"Select a visualization from the tabs above","ui.toggle_language":"Changer en français","ui.show_description":"Show description","ui.hide_description":"Hide description","ui.no_visualization_content":"No visualization content available","viz.summary":"Summary","viz.total_items":"Total items","viz.number_of_categories":"Number of categories","viz.top_categories":"Top Categories","viz.filter_by_country":"Filter by Country","viz.filter_by_type":"Filter by Type","viz.showing_items":"Showing {0} items in {1} languages","viz.all_countries":"All Countries","viz.all_types":"All Types","viz.no_data":"No data available with the current filters","viz.distribution_items":"Distribution of {0} items by country and sub-collection","viz.language_distribution_title":"Language Distribution","viz.language_distribution_items":"Distribution of {0} items by language","viz.language_distribution_description":"This visualization shows the distribution of items by language. You can filter by country and item type to explore the language distribution across different segments of the collection.","viz.timeline_distribution_title":"Timeline Distribution","viz.timeline_distribution_items":"Growth timeline of {0} items over time","viz.timeline_distribution_description":"This visualization shows the growth of the database over time. The blue line represents monthly additions, while the green dotted line shows the cumulative total. You can filter by country and item type to explore growth patterns across different segments of the collection.","viz.time_period":"Time period","viz.avg_monthly_additions":"Average monthly additions","viz.peak_growth_months":"Peak Growth Months","viz.showing_items_over_months":"Showing {0} items over {1} months","viz.months":"months","viz.monthly_additions":"Monthly Additions","viz.month":"Month","viz.publication_year":"Publication Year","viz.number_of_items":"Number of Items","viz.toggle_types":"Toggle Types","viz.toggled_type":"Toggled type: {0}","viz.languages":"Languages","viz.country_distribution_title":"Country Distribution","viz.country_distribution_description":"This visualization shows the distribution of items by country and sub-collection. You can click on any country block to zoom in and see its sub-collections. The size of each block represents the number of items in that country or sub-collection.","viz.country.items":"Items","viz.country.percent_parent":"% of Parent","viz.country.percent_total":"% of Total","viz.country.click_zoom_in":"Click to zoom in","viz.country.click_zoom_out":"Click to zoom out","viz.country.unknown":"Unknown","viz.country.no_set":"No Set","viz.countries":"Countries","viz.sub_collections":"Sub-collections","viz.currently_viewing":"Currently viewing","viz.click_back_to_return":'Click the "Back to All" button to return to the full view',"viz.click_zoom_in":"Click on a country block to zoom in","viz.unknown":"Unknown","viz.no_set":"No Set","viz.word_distribution":"Word Distribution","viz.total_words":"Total Words","viz.avg_words_per_item":"Average Words per Item","viz.back_to_all":"← Back to All","viz.total_items_with_word_count":"Total items with word count","viz.word_distribution_subtitle":"Word Distribution by Country and Item Set ({0} items, {1} words)","viz.words":"words","viz.items":"items","viz.percent_of_country":"% of country","viz.percent_of_total":"% of total","viz.item_set_summary":"Item Set Summary","lang.Français":"French","lang.Anglais":"English","lang.Haoussa":"Hausa","lang.Allemand":"German","lang.Arabe":"Arabic","lang.Italien":"Italian","lang.Dendi":"Dendi","lang.Slovène":"Slovenian","lang.Espagnol":"Spanish","country.all":"All Countries","country.Bénin":"Benin","country.Nigéria":"Nigeria","country.Côte d'Ivoire":"Côte d'Ivoire","country.Burkina Faso":"Burkina Faso","country.Togo":"Togo","country.Niger":"Niger","country.Unknown":"Unknown","type.Article de presse":"Press Article","type.Notice d'autorité":"Authority Record","type.Périodique islamique":"Islamic Periodical","type.Unknown":"Unknown","type.Article de revue":"Journal Article","type.Document":"Document","type.Article de blog":"Blog Post","type.Chapitre de livre":"Book Chapter","type.Livre":"Book","type.Thèse de doctorat":"Doctoral Thesis","type.Communication scientifique":"Scientific Communication","type.all":"All Types"},fr:{"app.title":"Aperçu de la base de données IWAC","tab.countries":"Répartition par pays","tab.languages":"Langues","tab.timeline":"Chronologie","tab.types":"Répartition par type","tab.categories":"Catégories d'index","tab.words":"Répartition des mots","ui.loading":"Chargement de la base de données...","ui.select_visualization":"Sélectionnez une visualisation dans les onglets ci-dessus","ui.toggle_language":"Switch to English","ui.show_description":"Afficher la description","ui.hide_description":"Masquer la description","ui.no_visualization_content":"Aucun contenu de visualisation disponible","viz.summary":"Résumé","viz.total_items":"Nombre total d'éléments","viz.number_of_categories":"Nombre de catégories","viz.top_categories":"Principales catégories","viz.filter_by_country":"Filtrer par pays","viz.filter_by_type":"Filtrer par type","viz.showing_items":"Affichage de {0} éléments dans {1} langues","viz.all_countries":"Tous les pays","viz.all_types":"Tous les types","viz.no_data":"Aucune donnée disponible avec les filtres actuels","viz.distribution_items":"Répartition de {0} éléments par pays et sous-collection","viz.language_distribution_title":"Répartition par langue","viz.language_distribution_items":"Répartition de {0} éléments par langue","viz.language_distribution_description":"Cette visualisation montre la répartition des éléments par langue. Vous pouvez filtrer par pays et par type d'élément pour explorer la répartition des langues dans différents segments de la collection.","viz.timeline_distribution_title":"Chronologie","viz.timeline_distribution_items":"Chronologie de croissance de {0} éléments au fil du temps","viz.timeline_distribution_description":"Cette visualisation montre la croissance de la base de données au fil du temps. La ligne bleue représente les ajouts mensuels, tandis que la ligne pointillée verte montre le total cumulatif. Vous pouvez filtrer par pays et par type d'élément pour explorer les modèles de croissance dans différents segments de la collection.","viz.time_period":"Période","viz.avg_monthly_additions":"Ajouts mensuels moyens","viz.peak_growth_months":"Mois de croissance maximale","viz.showing_items_over_months":"Affichage de {0} éléments sur {1} mois","viz.months":"mois","viz.monthly_additions":"Ajouts mensuels","viz.month":"Mois","viz.publication_year":"Année de publication","viz.number_of_items":"Nombre d'éléments","viz.toggle_types":"Basculer les types","viz.toggled_type":"Type basculé : {0}","viz.languages":"Langues","viz.country_distribution_title":"Répartition par pays","viz.country_distribution_description":"Cette visualisation montre la répartition des éléments par pays et sous-collection. Vous pouvez cliquer sur n'importe quel bloc pays pour zoomer et voir ses sous-collections. La taille de chaque bloc représente le nombre d'éléments dans ce pays ou cette sous-collection.","viz.country.items":"Éléments","viz.country.percent_parent":"% du parent","viz.country.percent_total":"% du total","viz.country.click_zoom_in":"Cliquer pour zoomer","viz.country.click_zoom_out":"Cliquer pour dézoomer","viz.country.unknown":"Inconnu","viz.country.no_set":"Sans ensemble","viz.countries":"Pays","viz.sub_collections":"Sous-collections","viz.currently_viewing":"Affichage actuel","viz.click_back_to_return":'Cliquez sur le bouton "Retour à tous" pour revenir à la vue complète',"viz.click_zoom_in":"Cliquez sur un bloc pays pour zoomer","viz.unknown":"Inconnu","viz.no_set":"Sans ensemble","viz.word_distribution":"Répartition des mots","viz.total_words":"Nombre total de mots","viz.avg_words_per_item":"Moyenne de mots par élément","viz.back_to_all":"← Retour à tous","viz.total_items_with_word_count":"Total des éléments avec nombre de mots","viz.word_distribution_subtitle":"Répartition des mots par pays et ensemble d'éléments ({0} éléments, {1} mots)","viz.words":"mots","viz.items":"éléments","viz.percent_of_country":"% du pays","viz.percent_of_total":"% du total","viz.item_set_summary":"Résumé de l'ensemble d'éléments","lang.Français":"Français","lang.Anglais":"Anglais","lang.Haoussa":"Haoussa","lang.Allemand":"Allemand","lang.Arabe":"Arabe","lang.Italien":"Italien","lang.Dendi":"Dendi","lang.Slovène":"Slovène","lang.Espagnol":"Espagnol","country.all":"Tous les pays","country.Bénin":"Bénin","country.Nigéria":"Nigéria","country.Côte d'Ivoire":"Côte d'Ivoire","country.Burkina Faso":"Burkina Faso","country.Togo":"Togo","country.Niger":"Niger","country.Unknown":"Inconnu","type.Article de presse":"Article de presse","type.Notice d'autorité":"Notice d'autorité","type.Périodique islamique":"Périodique islamique","type.Unknown":"Inconnu","type.Article de revue":"Article de revue","type.Document":"Document","type.Article de blog":"Article de blog","type.Chapitre de livre":"Chapitre de livre","type.Livre":"Livre","type.Thèse de doctorat":"Thèse de doctorat","type.Communication scientifique":"Communication scientifique","type.all":"Tous les types"}};function ya(){const{subscribe:t,set:e,update:n}=qr("en");return{subscribe:t,setLanguage:r=>{console.log("[TranslationStore] Setting language to:",r),e(r)},toggleLanguage:()=>n(r=>{const i=r==="en"?"fr":"en";return console.log("[TranslationStore] Toggling language from",r,"to",i),i})}}const Ot=ya();function Jo(t,e=[]){console.log("[TranslationStore] Processing translation:",{text:t,replacements:e});const n=t.replace(/{(\d+)}/g,(r,i)=>{const o=parseInt(i);return o<e.length?e[o]:r});return console.log("[TranslationStore] Processed result:",n),n}function _t(t,e=[]){var i;const n=jl(Ot);console.log("[TranslationStore] t() translation lookup:",{key:t,currentLang:n,replacements:e});const r=((i=Qo[n])==null?void 0:i[t])||t;return Jo(r,e)}function pt(t,e=[]){return console.log("[TranslationStore] Creating reactive translation for key:",t),ga(Ot,n=>{var i;console.log("[TranslationStore] Reactive translation update:",{key:t,language:n});const r=((i=Qo[n])==null?void 0:i[t])||t;return Jo(r,e)})}function va(t){let e,n,r,i;return{c(){e=M("button"),n=H(t[0]),T(e,"class","language-toggle svelte-u9ii1h")},m(o,l){Q(o,e,l),p(e,n),r||(i=Lt(e,"click",t[2]),r=!0)},p(o,[l]){l&1&&tt(n,o[0])},i:Tt,o:Tt,d(o){o&&Z(e),r=!1,i()}}}function _a(t,e,n){let r,i;mt(t,Ot,a=>n(3,i=a));const o=pt("ui.toggle_language");mt(t,o,a=>n(0,r=a));function l(){console.log("[LanguageToggle] Button clicked, current language:",i),Ot.toggleLanguage(),console.log("[LanguageToggle] Toggle text is:",r)}return[r,o,l]}class ba extends Qt{constructor(e){super(),Gt(this,e,_a,va,qt,{})}}const wa=!1,Ye=[],xa=1e3;function ka(){return new Date().toISOString()}function wt(t,e,n){const i={timestamp:ka(),component:t,action:e,details:n};Ye.push(i),Ye.length>xa&&Ye.shift()}const Ta=new Set,Ca={};function tl(){console.group("IWAC Debug Logs"),Ye.forEach(t=>{console.groupCollapsed(`${t.timestamp} - ${t.component} - ${t.action}`),console.log("Component:",t.component),console.log("Action:",t.action),t.details&&console.log("Details:",t.details),console.groupEnd()}),console.groupEnd()}function el(){return JSON.stringify(Ye,null,2)}typeof window<"u"&&(window.__IWAC_DEBUG={logs:Ye,dumpLogs:tl,exportLogs:el,mountedComponents:()=>Array.from(Ta),hierarchy:Ca});function za(t){let e;const n=t[1].default,r=Ho(n,t,t[0],null);return{c(){r&&r.c()},m(i,o){r&&r.m(i,o),e=!0},p(i,[o]){r&&r.p&&(!e||o&1)&&Yo(r,n,i,i[0],e?Oo(n,i[0],o,null):Wo(i[0]),null)},i(i){e||(At(r,i),e=!0)},o(i){St(r,i),e=!1},d(i){r&&r.d(i)}}}const Xt="TranslationContext";function Ma(t,e,n){let r;mt(t,Ot,f=>n(7,r=f));let{$$slots:i={},$$scope:o}=e,l=!1,a,c=0,s=r,u="";la("translationContext",{componentId:Xt,getLanguage:()=>s});function d(f){if(!l){wt(Xt,`Language change ignored (not mounted): ${f}`);return}u=s,s=f,wt(Xt,`Language changed from ${u} to ${f}`,{isMounted:l,updateCount:c,subscriptionActive:!!a})}return Xo(()=>{wt(Xt,"Before update",{isMounted:l,currentLanguage:s,updateCount:c})}),ye(()=>{l=!0,wt(Xt,`Component mounted, initial language: ${r}`,{storeValue:r,currentLanguage:s});try{a=Ot.subscribe(f=>{d(f)}),wt(Xt,"Subscribed to language store")}catch(f){wt(Xt,"Error subscribing to language store",f)}typeof window<"u"&&(window.__TRANSLATION_DEBUG={dumpLogs:tl,exportLogs:el,currentLanguage:()=>s,isMounted:()=>l})}),lr(()=>{if(wt(Xt,"Component being destroyed",{isMounted:l,currentLanguage:s,hasUnsubscribe:!!a}),l=!1,a)try{a(),wt(Xt,"Unsubscribed from language store"),a=void 0}catch(f){wt(Xt,"Error unsubscribing from language store",f)}}),jo(()=>{c++,wt(Xt,`Component updated (${c})`,{isMounted:l,currentLanguage:s,storeValue:r})}),t.$$set=f=>{"$$scope"in f&&n(0,o=f.$$scope)},[o,i]}class Aa extends Qt{constructor(e){super(),Gt(this,e,Ma,za,qt,{})}}function In(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Sa(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Vr(t){let e,n,r;t.length!==2?(e=In,n=(a,c)=>In(t(a),c),r=(a,c)=>t(a)-c):(e=t===In||t===Sa?t:$a,n=t,r=t);function i(a,c,s=0,u=a.length){if(s<u){if(e(c,c)!==0)return u;do{const d=s+u>>>1;n(a[d],c)<0?s=d+1:u=d}while(s<u)}return s}function o(a,c,s=0,u=a.length){if(s<u){if(e(c,c)!==0)return u;do{const d=s+u>>>1;n(a[d],c)<=0?s=d+1:u=d}while(s<u)}return s}function l(a,c,s=0,u=a.length){const d=i(a,c,s,u-1);return d>s&&r(a[d-1],c)>-r(a[d],c)?d-1:d}return{left:i,center:l,right:o}}function $a(){return 0}function Da(t){return t===null?NaN:+t}const Na=Vr(In),Ea=Na.right;Vr(Da).center;const Ia=Ea;function La(t,e){let n,r;if(e===void 0)for(const i of t)i!=null&&(n===void 0?i>=i&&(n=r=i):(n>i&&(n=i),r<i&&(r=i)));else{let i=-1;for(let o of t)(o=e(o,++i,t))!=null&&(n===void 0?o>=o&&(n=r=o):(n>o&&(n=o),r<o&&(r=o)))}return[n,r]}class Mr extends Map{constructor(e,n=Ha){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),e!=null)for(const[r,i]of e)this.set(r,i)}get(e){return super.get(mi(this,e))}has(e){return super.has(mi(this,e))}set(e,n){return super.set(Ua(this,e),n)}delete(e){return super.delete(Fa(this,e))}}function mi({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):n}function Ua({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):(t.set(r,n),n)}function Fa({_intern:t,_key:e},n){const r=e(n);return t.has(r)&&(n=t.get(r),t.delete(r)),n}function Ha(t){return t!==null&&typeof t=="object"?t.valueOf():t}function Ar(t){return t}function qe(t,...e){return nl(t,Ar,Ar,e)}function We(t,e,...n){return nl(t,Ar,e,n)}function nl(t,e,n,r){return function i(o,l){if(l>=r.length)return n(o);const a=new Mr,c=r[l++];let s=-1;for(const u of o){const d=c(u,++s,o),f=a.get(d);f?f.push(u):a.set(d,[u])}for(const[u,d]of a)a.set(u,i(d,l));return e(a)}(t,0)}const Ra=Math.sqrt(50),Oa=Math.sqrt(10),Ya=Math.sqrt(2);function Yn(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),o=r/Math.pow(10,i),l=o>=Ra?10:o>=Oa?5:o>=Ya?2:1;let a,c,s;return i<0?(s=Math.pow(10,-i)/l,a=Math.round(t*s),c=Math.round(e*s),a/s<t&&++a,c/s>e&&--c,s=-s):(s=Math.pow(10,i)*l,a=Math.round(t/s),c=Math.round(e/s),a*s<t&&++a,c*s>e&&--c),c<a&&.5<=n&&n<2?Yn(t,e,n*2):[a,c,s]}function Wa(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const r=e<t,[i,o,l]=r?Yn(e,t,n):Yn(t,e,n);if(!(o>=i))return[];const a=o-i+1,c=new Array(a);if(r)if(l<0)for(let s=0;s<a;++s)c[s]=(o-s)/-l;else for(let s=0;s<a;++s)c[s]=(o-s)*l;else if(l<0)for(let s=0;s<a;++s)c[s]=(i+s)/-l;else for(let s=0;s<a;++s)c[s]=(i+s)*l;return c}function Sr(t,e,n){return e=+e,t=+t,n=+n,Yn(t,e,n)[2]}function $r(t,e,n){e=+e,t=+t,n=+n;const r=e<t,i=r?Sr(e,t,n):Sr(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}function Ie(t,e){let n;if(e===void 0)for(const r of t)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of t)(i=e(i,++r,t))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function Pa(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((e-t)/n))|0,o=new Array(i);++r<i;)o[r]=t+r*n;return o}function Ba(t){return t}var pr=1,gr=2,Dr=3,an=4,yi=1e-6;function qa(t){return"translate("+t+",0)"}function Va(t){return"translate(0,"+t+")"}function Xa(t){return e=>+t(e)}function ja(t,e){return e=Math.max(0,t.bandwidth()-e*2)/2,t.round()&&(e=Math.round(e)),n=>+t(n)+e}function Ka(){return!this.__axis}function rl(t,e){var n=[],r=null,i=null,o=6,l=6,a=3,c=typeof window<"u"&&window.devicePixelRatio>1?0:.5,s=t===pr||t===an?-1:1,u=t===an||t===gr?"x":"y",d=t===pr||t===Dr?qa:Va;function f(h){var g=r??(e.ticks?e.ticks.apply(e,n):e.domain()),k=i??(e.tickFormat?e.tickFormat.apply(e,n):Ba),b=Math.max(o,0)+a,C=e.range(),w=+C[0]+c,y=+C[C.length-1]+c,m=(e.bandwidth?ja:Xa)(e.copy(),c),N=h.selection?h.selection():h,z=N.selectAll(".domain").data([null]),x=N.selectAll(".tick").data(g,e).order(),L=x.exit(),S=x.enter().append("g").attr("class","tick"),$=x.select("line"),P=x.select("text");z=z.merge(z.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),x=x.merge(S),$=$.merge(S.append("line").attr("stroke","currentColor").attr(u+"2",s*o)),P=P.merge(S.append("text").attr("fill","currentColor").attr(u,s*b).attr("dy",t===pr?"0em":t===Dr?"0.71em":"0.32em")),h!==N&&(z=z.transition(h),x=x.transition(h),$=$.transition(h),P=P.transition(h),L=L.transition(h).attr("opacity",yi).attr("transform",function(W){return isFinite(W=m(W))?d(W+c):this.getAttribute("transform")}),S.attr("opacity",yi).attr("transform",function(W){var D=this.parentNode.__axis;return d((D&&isFinite(D=D(W))?D:m(W))+c)})),L.remove(),z.attr("d",t===an||t===gr?l?"M"+s*l+","+w+"H"+c+"V"+y+"H"+s*l:"M"+c+","+w+"V"+y:l?"M"+w+","+s*l+"V"+c+"H"+y+"V"+s*l:"M"+w+","+c+"H"+y),x.attr("opacity",1).attr("transform",function(W){return d(m(W)+c)}),$.attr(u+"2",s*o),P.attr(u,s*b).text(k),N.filter(Ka).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===gr?"start":t===an?"end":"middle"),N.each(function(){this.__axis=m})}return f.scale=function(h){return arguments.length?(e=h,f):e},f.ticks=function(){return n=Array.from(arguments),f},f.tickArguments=function(h){return arguments.length?(n=h==null?[]:Array.from(h),f):n.slice()},f.tickValues=function(h){return arguments.length?(r=h==null?null:Array.from(h),f):r&&r.slice()},f.tickFormat=function(h){return arguments.length?(i=h,f):i},f.tickSize=function(h){return arguments.length?(o=l=+h,f):o},f.tickSizeInner=function(h){return arguments.length?(o=+h,f):o},f.tickSizeOuter=function(h){return arguments.length?(l=+h,f):l},f.tickPadding=function(h){return arguments.length?(a=+h,f):a},f.offset=function(h){return arguments.length?(c=+h,f):c},f}function Wn(t){return rl(Dr,t)}function Pn(t){return rl(an,t)}var Za={value:()=>{}};function il(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Ln(n)}function Ln(t){this._=t}function Ga(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Ln.prototype=il.prototype={constructor:Ln,on:function(t,e){var n=this._,r=Ga(t+"",n),i,o=-1,l=r.length;if(arguments.length<2){for(;++o<l;)if((i=(t=r[o]).type)&&(i=Qa(n[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++o<l;)if(i=(t=r[o]).type)n[i]=vi(n[i],t.name,e);else if(e==null)for(i in n)n[i]=vi(n[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Ln(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,o;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=this._[t],r=0,i=o.length;r<i;++r)o[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(e,n)}};function Qa(t,e){for(var n=0,r=t.length,i;n<r;++n)if((i=t[n]).name===e)return i.value}function vi(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=Za,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var Nr="http://www.w3.org/1999/xhtml";const _i={svg:"http://www.w3.org/2000/svg",xhtml:Nr,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function ar(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),_i.hasOwnProperty(e)?{space:_i[e],local:t}:t}function Ja(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Nr&&e.documentElement.namespaceURI===Nr?e.createElement(t):e.createElementNS(n,t)}}function ts(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function ol(t){var e=ar(t);return(e.local?ts:Ja)(e)}function es(){}function Xr(t){return t==null?es:function(){return this.querySelector(t)}}function ns(t){typeof t!="function"&&(t=Xr(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o=e[i],l=o.length,a=r[i]=new Array(l),c,s,u=0;u<l;++u)(c=o[u])&&(s=t.call(c,c.__data__,u,o))&&("__data__"in c&&(s.__data__=c.__data__),a[u]=s);return new Yt(r,this._parents)}function rs(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function is(){return[]}function ll(t){return t==null?is:function(){return this.querySelectorAll(t)}}function os(t){return function(){return rs(t.apply(this,arguments))}}function ls(t){typeof t=="function"?t=os(t):t=ll(t);for(var e=this._groups,n=e.length,r=[],i=[],o=0;o<n;++o)for(var l=e[o],a=l.length,c,s=0;s<a;++s)(c=l[s])&&(r.push(t.call(c,c.__data__,s,l)),i.push(c));return new Yt(r,i)}function al(t){return function(){return this.matches(t)}}function sl(t){return function(e){return e.matches(t)}}var as=Array.prototype.find;function ss(t){return function(){return as.call(this.children,t)}}function us(){return this.firstElementChild}function cs(t){return this.select(t==null?us:ss(typeof t=="function"?t:sl(t)))}var fs=Array.prototype.filter;function ds(){return Array.from(this.children)}function hs(t){return function(){return fs.call(this.children,t)}}function ps(t){return this.selectAll(t==null?ds:hs(typeof t=="function"?t:sl(t)))}function gs(t){typeof t!="function"&&(t=al(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o=e[i],l=o.length,a=r[i]=[],c,s=0;s<l;++s)(c=o[s])&&t.call(c,c.__data__,s,o)&&a.push(c);return new Yt(r,this._parents)}function ul(t){return new Array(t.length)}function ms(){return new Yt(this._enter||this._groups.map(ul),this._parents)}function Bn(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}Bn.prototype={constructor:Bn,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function ys(t){return function(){return t}}function vs(t,e,n,r,i,o){for(var l=0,a,c=e.length,s=o.length;l<s;++l)(a=e[l])?(a.__data__=o[l],r[l]=a):n[l]=new Bn(t,o[l]);for(;l<c;++l)(a=e[l])&&(i[l]=a)}function _s(t,e,n,r,i,o,l){var a,c,s=new Map,u=e.length,d=o.length,f=new Array(u),h;for(a=0;a<u;++a)(c=e[a])&&(f[a]=h=l.call(c,c.__data__,a,e)+"",s.has(h)?i[a]=c:s.set(h,c));for(a=0;a<d;++a)h=l.call(t,o[a],a,o)+"",(c=s.get(h))?(r[a]=c,c.__data__=o[a],s.delete(h)):n[a]=new Bn(t,o[a]);for(a=0;a<u;++a)(c=e[a])&&s.get(f[a])===c&&(i[a]=c)}function bs(t){return t.__data__}function ws(t,e){if(!arguments.length)return Array.from(this,bs);var n=e?_s:vs,r=this._parents,i=this._groups;typeof t!="function"&&(t=ys(t));for(var o=i.length,l=new Array(o),a=new Array(o),c=new Array(o),s=0;s<o;++s){var u=r[s],d=i[s],f=d.length,h=xs(t.call(u,u&&u.__data__,s,r)),g=h.length,k=a[s]=new Array(g),b=l[s]=new Array(g),C=c[s]=new Array(f);n(u,d,k,b,C,h,e);for(var w=0,y=0,m,N;w<g;++w)if(m=k[w]){for(w>=y&&(y=w+1);!(N=b[y])&&++y<g;);m._next=N||null}}return l=new Yt(l,r),l._enter=a,l._exit=c,l}function xs(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function ks(){return new Yt(this._exit||this._groups.map(ul),this._parents)}function Ts(t,e,n){var r=this.enter(),i=this,o=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),e!=null&&(i=e(i),i&&(i=i.selection())),n==null?o.remove():n(o),r&&i?r.merge(i).order():i}function Cs(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,o=r.length,l=Math.min(i,o),a=new Array(i),c=0;c<l;++c)for(var s=n[c],u=r[c],d=s.length,f=a[c]=new Array(d),h,g=0;g<d;++g)(h=s[g]||u[g])&&(f[g]=h);for(;c<i;++c)a[c]=n[c];return new Yt(a,this._parents)}function zs(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],i=r.length-1,o=r[i],l;--i>=0;)(l=r[i])&&(o&&l.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(l,o),o=l);return this}function Ms(t){t||(t=As);function e(d,f){return d&&f?t(d.__data__,f.__data__):!d-!f}for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var l=n[o],a=l.length,c=i[o]=new Array(a),s,u=0;u<a;++u)(s=l[u])&&(c[u]=s);c.sort(e)}return new Yt(i,this._parents).order()}function As(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Ss(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function $s(){return Array.from(this)}function Ds(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length;i<o;++i){var l=r[i];if(l)return l}return null}function Ns(){let t=0;for(const e of this)++t;return t}function Es(){return!this.node()}function Is(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i=e[n],o=0,l=i.length,a;o<l;++o)(a=i[o])&&t.call(a,a.__data__,o,i);return this}function Ls(t){return function(){this.removeAttribute(t)}}function Us(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Fs(t,e){return function(){this.setAttribute(t,e)}}function Hs(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Rs(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function Os(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function Ys(t,e){var n=ar(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?Us:Ls:typeof e=="function"?n.local?Os:Rs:n.local?Hs:Fs)(n,e))}function cl(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Ws(t){return function(){this.style.removeProperty(t)}}function Ps(t,e,n){return function(){this.style.setProperty(t,e,n)}}function Bs(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function qs(t,e,n){return arguments.length>1?this.each((e==null?Ws:typeof e=="function"?Bs:Ps)(t,e,n??"")):Ve(this.node(),t)}function Ve(t,e){return t.style.getPropertyValue(e)||cl(t).getComputedStyle(t,null).getPropertyValue(e)}function Vs(t){return function(){delete this[t]}}function Xs(t,e){return function(){this[t]=e}}function js(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function Ks(t,e){return arguments.length>1?this.each((e==null?Vs:typeof e=="function"?js:Xs)(t,e)):this.node()[t]}function fl(t){return t.trim().split(/^|\s+/)}function jr(t){return t.classList||new dl(t)}function dl(t){this._node=t,this._names=fl(t.getAttribute("class")||"")}dl.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function hl(t,e){for(var n=jr(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function pl(t,e){for(var n=jr(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function Zs(t){return function(){hl(this,t)}}function Gs(t){return function(){pl(this,t)}}function Qs(t,e){return function(){(e.apply(this,arguments)?hl:pl)(this,t)}}function Js(t,e){var n=fl(t+"");if(arguments.length<2){for(var r=jr(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof e=="function"?Qs:e?Zs:Gs)(n,e))}function tu(){this.textContent=""}function eu(t){return function(){this.textContent=t}}function nu(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function ru(t){return arguments.length?this.each(t==null?tu:(typeof t=="function"?nu:eu)(t)):this.node().textContent}function iu(){this.innerHTML=""}function ou(t){return function(){this.innerHTML=t}}function lu(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function au(t){return arguments.length?this.each(t==null?iu:(typeof t=="function"?lu:ou)(t)):this.node().innerHTML}function su(){this.nextSibling&&this.parentNode.appendChild(this)}function uu(){return this.each(su)}function cu(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function fu(){return this.each(cu)}function du(t){var e=typeof t=="function"?t:ol(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function hu(){return null}function pu(t,e){var n=typeof t=="function"?t:ol(t),r=e==null?hu:typeof e=="function"?e:Xr(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function gu(){var t=this.parentNode;t&&t.removeChild(this)}function mu(){return this.each(gu)}function yu(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function vu(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function _u(t){return this.select(t?vu:yu)}function bu(t){return arguments.length?this.property("__data__",t):this.node().__data__}function wu(t){return function(e){t.call(this,e,this.__data__)}}function xu(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function ku(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,i=e.length,o;n<i;++n)o=e[n],(!t.type||o.type===t.type)&&o.name===t.name?this.removeEventListener(o.type,o.listener,o.options):e[++r]=o;++r?e.length=r:delete this.__on}}}function Tu(t,e,n){return function(){var r=this.__on,i,o=wu(e);if(r){for(var l=0,a=r.length;l<a;++l)if((i=r[l]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=o,i.options=n),i.value=e;return}}this.addEventListener(t.type,o,n),i={type:t.type,name:t.name,value:e,listener:o,options:n},r?r.push(i):this.__on=[i]}}function Cu(t,e,n){var r=xu(t+""),i,o=r.length,l;if(arguments.length<2){var a=this.node().__on;if(a){for(var c=0,s=a.length,u;c<s;++c)for(i=0,u=a[c];i<o;++i)if((l=r[i]).type===u.type&&l.name===u.name)return u.value}return}for(a=e?Tu:ku,i=0;i<o;++i)this.each(a(r[i],e,n));return this}function gl(t,e,n){var r=cl(t),i=r.CustomEvent;typeof i=="function"?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function zu(t,e){return function(){return gl(this,t,e)}}function Mu(t,e){return function(){return gl(this,t,e.apply(this,arguments))}}function Au(t,e){return this.each((typeof e=="function"?Mu:zu)(t,e))}function*Su(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length,l;i<o;++i)(l=r[i])&&(yield l)}var ml=[null];function Yt(t,e){this._groups=t,this._parents=e}function wn(){return new Yt([[document.documentElement]],ml)}function $u(){return this}Yt.prototype=wn.prototype={constructor:Yt,select:ns,selectAll:ls,selectChild:cs,selectChildren:ps,filter:gs,data:ws,enter:ms,exit:ks,join:Ts,merge:Cs,selection:$u,order:zs,sort:Ms,call:Ss,nodes:$s,node:Ds,size:Ns,empty:Es,each:Is,attr:Ys,style:qs,property:Ks,classed:Js,text:ru,html:au,raise:uu,lower:fu,append:du,insert:pu,remove:mu,clone:_u,datum:bu,on:Cu,dispatch:Au,[Symbol.iterator]:Su};function vt(t){return typeof t=="string"?new Yt([[document.querySelector(t)]],[document.documentElement]):new Yt([[t]],ml)}function Kr(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function yl(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function xn(){}var pn=.7,qn=1/pn,Pe="\\s*([+-]?\\d+)\\s*",gn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",re="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Du=/^#([0-9a-f]{3,8})$/,Nu=new RegExp(`^rgb\\(${Pe},${Pe},${Pe}\\)$`),Eu=new RegExp(`^rgb\\(${re},${re},${re}\\)$`),Iu=new RegExp(`^rgba\\(${Pe},${Pe},${Pe},${gn}\\)$`),Lu=new RegExp(`^rgba\\(${re},${re},${re},${gn}\\)$`),Uu=new RegExp(`^hsl\\(${gn},${re},${re}\\)$`),Fu=new RegExp(`^hsla\\(${gn},${re},${re},${gn}\\)$`),bi={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Kr(xn,Te,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:wi,formatHex:wi,formatHex8:Hu,formatHsl:Ru,formatRgb:xi,toString:xi});function wi(){return this.rgb().formatHex()}function Hu(){return this.rgb().formatHex8()}function Ru(){return vl(this).formatHsl()}function xi(){return this.rgb().formatRgb()}function Te(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Du.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?ki(e):n===3?new Ft(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?Mn(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?Mn(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Nu.exec(t))?new Ft(e[1],e[2],e[3],1):(e=Eu.exec(t))?new Ft(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Iu.exec(t))?Mn(e[1],e[2],e[3],e[4]):(e=Lu.exec(t))?Mn(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Uu.exec(t))?zi(e[1],e[2]/100,e[3]/100,1):(e=Fu.exec(t))?zi(e[1],e[2]/100,e[3]/100,e[4]):bi.hasOwnProperty(t)?ki(bi[t]):t==="transparent"?new Ft(NaN,NaN,NaN,0):null}function ki(t){return new Ft(t>>16&255,t>>8&255,t&255,1)}function Mn(t,e,n,r){return r<=0&&(t=e=n=NaN),new Ft(t,e,n,r)}function Ou(t){return t instanceof xn||(t=Te(t)),t?(t=t.rgb(),new Ft(t.r,t.g,t.b,t.opacity)):new Ft}function me(t,e,n,r){return arguments.length===1?Ou(t):new Ft(t,e,n,r??1)}function Ft(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}Kr(Ft,me,yl(xn,{brighter(t){return t=t==null?qn:Math.pow(qn,t),new Ft(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?pn:Math.pow(pn,t),new Ft(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Ft(we(this.r),we(this.g),we(this.b),Vn(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ti,formatHex:Ti,formatHex8:Yu,formatRgb:Ci,toString:Ci}));function Ti(){return`#${be(this.r)}${be(this.g)}${be(this.b)}`}function Yu(){return`#${be(this.r)}${be(this.g)}${be(this.b)}${be((isNaN(this.opacity)?1:this.opacity)*255)}`}function Ci(){const t=Vn(this.opacity);return`${t===1?"rgb(":"rgba("}${we(this.r)}, ${we(this.g)}, ${we(this.b)}${t===1?")":`, ${t})`}`}function Vn(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function we(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function be(t){return t=we(t),(t<16?"0":"")+t.toString(16)}function zi(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Zt(t,e,n,r)}function vl(t){if(t instanceof Zt)return new Zt(t.h,t.s,t.l,t.opacity);if(t instanceof xn||(t=Te(t)),!t)return new Zt;if(t instanceof Zt)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),l=NaN,a=o-i,c=(o+i)/2;return a?(e===o?l=(n-r)/a+(n<r)*6:n===o?l=(r-e)/a+2:l=(e-n)/a+4,a/=c<.5?o+i:2-o-i,l*=60):a=c>0&&c<1?0:l,new Zt(l,a,c,t.opacity)}function Wu(t,e,n,r){return arguments.length===1?vl(t):new Zt(t,e,n,r??1)}function Zt(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}Kr(Zt,Wu,yl(xn,{brighter(t){return t=t==null?qn:Math.pow(qn,t),new Zt(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?pn:Math.pow(pn,t),new Zt(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Ft(mr(t>=240?t-240:t+120,i,r),mr(t,i,r),mr(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new Zt(Mi(this.h),An(this.s),An(this.l),Vn(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Vn(this.opacity);return`${t===1?"hsl(":"hsla("}${Mi(this.h)}, ${An(this.s)*100}%, ${An(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Mi(t){return t=(t||0)%360,t<0?t+360:t}function An(t){return Math.max(0,Math.min(1,t||0))}function mr(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const Zr=t=>()=>t;function Pu(t,e){return function(n){return t+n*e}}function Bu(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function qu(t){return(t=+t)==1?_l:function(e,n){return n-e?Bu(e,n,t):Zr(isNaN(e)?n:e)}}function _l(t,e){var n=e-t;return n?Pu(t,n):Zr(isNaN(t)?e:t)}const Xn=function t(e){var n=qu(e);function r(i,o){var l=n((i=me(i)).r,(o=me(o)).r),a=n(i.g,o.g),c=n(i.b,o.b),s=_l(i.opacity,o.opacity);return function(u){return i.r=l(u),i.g=a(u),i.b=c(u),i.opacity=s(u),i+""}}return r.gamma=t,r}(1);function Vu(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),i;return function(o){for(i=0;i<n;++i)r[i]=t[i]*(1-o)+e[i]*o;return r}}function Xu(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function ju(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,i=new Array(r),o=new Array(n),l;for(l=0;l<r;++l)i[l]=Gr(t[l],e[l]);for(;l<n;++l)o[l]=e[l];return function(a){for(l=0;l<r;++l)o[l]=i[l](a);return o}}function Ku(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function Kt(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function Zu(t,e){var n={},r={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?n[i]=Gr(t[i],e[i]):r[i]=e[i];return function(o){for(i in n)r[i]=n[i](o);return r}}var Er=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,yr=new RegExp(Er.source,"g");function Gu(t){return function(){return t}}function Qu(t){return function(e){return t(e)+""}}function bl(t,e){var n=Er.lastIndex=yr.lastIndex=0,r,i,o,l=-1,a=[],c=[];for(t=t+"",e=e+"";(r=Er.exec(t))&&(i=yr.exec(e));)(o=i.index)>n&&(o=e.slice(n,o),a[l]?a[l]+=o:a[++l]=o),(r=r[0])===(i=i[0])?a[l]?a[l]+=i:a[++l]=i:(a[++l]=null,c.push({i:l,x:Kt(r,i)})),n=yr.lastIndex;return n<e.length&&(o=e.slice(n),a[l]?a[l]+=o:a[++l]=o),a.length<2?c[0]?Qu(c[0].x):Gu(e):(e=c.length,function(s){for(var u=0,d;u<e;++u)a[(d=c[u]).i]=d.x(s);return a.join("")})}function Gr(t,e){var n=typeof e,r;return e==null||n==="boolean"?Zr(e):(n==="number"?Kt:n==="string"?(r=Te(e))?(e=r,Xn):bl:e instanceof Te?Xn:e instanceof Date?Ku:Xu(e)?Vu:Array.isArray(e)?ju:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?Zu:Kt)(t,e)}function Ju(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var Ai=180/Math.PI,Ir={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function wl(t,e,n,r,i,o){var l,a,c;return(l=Math.sqrt(t*t+e*e))&&(t/=l,e/=l),(c=t*n+e*r)&&(n-=t*c,r-=e*c),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,c/=a),t*r<e*n&&(t=-t,e=-e,c=-c,l=-l),{translateX:i,translateY:o,rotate:Math.atan2(e,t)*Ai,skewX:Math.atan(c)*Ai,scaleX:l,scaleY:a}}var Sn;function tc(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Ir:wl(e.a,e.b,e.c,e.d,e.e,e.f)}function ec(t){return t==null||(Sn||(Sn=document.createElementNS("http://www.w3.org/2000/svg","g")),Sn.setAttribute("transform",t),!(t=Sn.transform.baseVal.consolidate()))?Ir:(t=t.matrix,wl(t.a,t.b,t.c,t.d,t.e,t.f))}function xl(t,e,n,r){function i(s){return s.length?s.pop()+" ":""}function o(s,u,d,f,h,g){if(s!==d||u!==f){var k=h.push("translate(",null,e,null,n);g.push({i:k-4,x:Kt(s,d)},{i:k-2,x:Kt(u,f)})}else(d||f)&&h.push("translate("+d+e+f+n)}function l(s,u,d,f){s!==u?(s-u>180?u+=360:u-s>180&&(s+=360),f.push({i:d.push(i(d)+"rotate(",null,r)-2,x:Kt(s,u)})):u&&d.push(i(d)+"rotate("+u+r)}function a(s,u,d,f){s!==u?f.push({i:d.push(i(d)+"skewX(",null,r)-2,x:Kt(s,u)}):u&&d.push(i(d)+"skewX("+u+r)}function c(s,u,d,f,h,g){if(s!==d||u!==f){var k=h.push(i(h)+"scale(",null,",",null,")");g.push({i:k-4,x:Kt(s,d)},{i:k-2,x:Kt(u,f)})}else(d!==1||f!==1)&&h.push(i(h)+"scale("+d+","+f+")")}return function(s,u){var d=[],f=[];return s=t(s),u=t(u),o(s.translateX,s.translateY,u.translateX,u.translateY,d,f),l(s.rotate,u.rotate,d,f),a(s.skewX,u.skewX,d,f),c(s.scaleX,s.scaleY,u.scaleX,u.scaleY,d,f),s=u=null,function(h){for(var g=-1,k=f.length,b;++g<k;)d[(b=f[g]).i]=b.x(h);return d.join("")}}}var nc=xl(tc,"px, ","px)","deg)"),rc=xl(ec,", ",")",")"),Xe=0,sn=0,tn=0,kl=1e3,jn,un,Kn=0,Ce=0,sr=0,mn=typeof performance=="object"&&performance.now?performance:Date,Tl=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Qr(){return Ce||(Tl(ic),Ce=mn.now()+sr)}function ic(){Ce=0}function Zn(){this._call=this._time=this._next=null}Zn.prototype=Cl.prototype={constructor:Zn,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?Qr():+n)+(e==null?0:+e),!this._next&&un!==this&&(un?un._next=this:jn=this,un=this),this._call=t,this._time=n,Lr()},stop:function(){this._call&&(this._call=null,this._time=1/0,Lr())}};function Cl(t,e,n){var r=new Zn;return r.restart(t,e,n),r}function oc(){Qr(),++Xe;for(var t=jn,e;t;)(e=Ce-t._time)>=0&&t._call.call(void 0,e),t=t._next;--Xe}function Si(){Ce=(Kn=mn.now())+sr,Xe=sn=0;try{oc()}finally{Xe=0,ac(),Ce=0}}function lc(){var t=mn.now(),e=t-Kn;e>kl&&(sr-=e,Kn=t)}function ac(){for(var t,e=jn,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:jn=n);un=t,Lr(r)}function Lr(t){if(!Xe){sn&&(sn=clearTimeout(sn));var e=t-Ce;e>24?(t<1/0&&(sn=setTimeout(Si,t-mn.now()-sr)),tn&&(tn=clearInterval(tn))):(tn||(Kn=mn.now(),tn=setInterval(lc,kl)),Xe=1,Tl(Si))}}function $i(t,e,n){var r=new Zn;return e=e==null?0:+e,r.restart(i=>{r.stop(),t(i+e)},e,n),r}var sc=il("start","end","cancel","interrupt"),uc=[],zl=0,Di=1,Ur=2,Un=3,Ni=4,Fr=5,Fn=6;function ur(t,e,n,r,i,o){var l=t.__transition;if(!l)t.__transition={};else if(n in l)return;cc(t,n,{name:e,index:r,group:i,on:sc,tween:uc,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:zl})}function Jr(t,e){var n=Jt(t,e);if(n.state>zl)throw new Error("too late; already scheduled");return n}function ie(t,e){var n=Jt(t,e);if(n.state>Un)throw new Error("too late; already running");return n}function Jt(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function cc(t,e,n){var r=t.__transition,i;r[e]=n,n.timer=Cl(o,0,n.time);function o(s){n.state=Di,n.timer.restart(l,n.delay,n.time),n.delay<=s&&l(s-n.delay)}function l(s){var u,d,f,h;if(n.state!==Di)return c();for(u in r)if(h=r[u],h.name===n.name){if(h.state===Un)return $i(l);h.state===Ni?(h.state=Fn,h.timer.stop(),h.on.call("interrupt",t,t.__data__,h.index,h.group),delete r[u]):+u<e&&(h.state=Fn,h.timer.stop(),h.on.call("cancel",t,t.__data__,h.index,h.group),delete r[u])}if($i(function(){n.state===Un&&(n.state=Ni,n.timer.restart(a,n.delay,n.time),a(s))}),n.state=Ur,n.on.call("start",t,t.__data__,n.index,n.group),n.state===Ur){for(n.state=Un,i=new Array(f=n.tween.length),u=0,d=-1;u<f;++u)(h=n.tween[u].value.call(t,t.__data__,n.index,n.group))&&(i[++d]=h);i.length=d+1}}function a(s){for(var u=s<n.duration?n.ease.call(null,s/n.duration):(n.timer.restart(c),n.state=Fr,1),d=-1,f=i.length;++d<f;)i[d].call(t,u);n.state===Fr&&(n.on.call("end",t,t.__data__,n.index,n.group),c())}function c(){n.state=Fn,n.timer.stop(),delete r[e];for(var s in r)return;delete t.__transition}}function fc(t,e){var n=t.__transition,r,i,o=!0,l;if(n){e=e==null?null:e+"";for(l in n){if((r=n[l]).name!==e){o=!1;continue}i=r.state>Ur&&r.state<Fr,r.state=Fn,r.timer.stop(),r.on.call(i?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[l]}o&&delete t.__transition}}function dc(t){return this.each(function(){fc(this,t)})}function hc(t,e){var n,r;return function(){var i=ie(this,t),o=i.tween;if(o!==n){r=n=o;for(var l=0,a=r.length;l<a;++l)if(r[l].name===e){r=r.slice(),r.splice(l,1);break}}i.tween=r}}function pc(t,e,n){var r,i;if(typeof n!="function")throw new Error;return function(){var o=ie(this,t),l=o.tween;if(l!==r){i=(r=l).slice();for(var a={name:e,value:n},c=0,s=i.length;c<s;++c)if(i[c].name===e){i[c]=a;break}c===s&&i.push(a)}o.tween=i}}function gc(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=Jt(this.node(),n).tween,i=0,o=r.length,l;i<o;++i)if((l=r[i]).name===t)return l.value;return null}return this.each((e==null?hc:pc)(n,t,e))}function ti(t,e,n){var r=t._id;return t.each(function(){var i=ie(this,r);(i.value||(i.value={}))[e]=n.apply(this,arguments)}),function(i){return Jt(i,r).value[e]}}function Ml(t,e){var n;return(typeof e=="number"?Kt:e instanceof Te?Xn:(n=Te(e))?(e=n,Xn):bl)(t,e)}function mc(t){return function(){this.removeAttribute(t)}}function yc(t){return function(){this.removeAttributeNS(t.space,t.local)}}function vc(t,e,n){var r,i=n+"",o;return function(){var l=this.getAttribute(t);return l===i?null:l===r?o:o=e(r=l,n)}}function _c(t,e,n){var r,i=n+"",o;return function(){var l=this.getAttributeNS(t.space,t.local);return l===i?null:l===r?o:o=e(r=l,n)}}function bc(t,e,n){var r,i,o;return function(){var l,a=n(this),c;return a==null?void this.removeAttribute(t):(l=this.getAttribute(t),c=a+"",l===c?null:l===r&&c===i?o:(i=c,o=e(r=l,a)))}}function wc(t,e,n){var r,i,o;return function(){var l,a=n(this),c;return a==null?void this.removeAttributeNS(t.space,t.local):(l=this.getAttributeNS(t.space,t.local),c=a+"",l===c?null:l===r&&c===i?o:(i=c,o=e(r=l,a)))}}function xc(t,e){var n=ar(t),r=n==="transform"?rc:Ml;return this.attrTween(t,typeof e=="function"?(n.local?wc:bc)(n,r,ti(this,"attr."+t,e)):e==null?(n.local?yc:mc)(n):(n.local?_c:vc)(n,r,e))}function kc(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function Tc(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function Cc(t,e){var n,r;function i(){var o=e.apply(this,arguments);return o!==r&&(n=(r=o)&&Tc(t,o)),n}return i._value=e,i}function zc(t,e){var n,r;function i(){var o=e.apply(this,arguments);return o!==r&&(n=(r=o)&&kc(t,o)),n}return i._value=e,i}function Mc(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=ar(t);return this.tween(n,(r.local?Cc:zc)(r,e))}function Ac(t,e){return function(){Jr(this,t).delay=+e.apply(this,arguments)}}function Sc(t,e){return e=+e,function(){Jr(this,t).delay=e}}function $c(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Ac:Sc)(e,t)):Jt(this.node(),e).delay}function Dc(t,e){return function(){ie(this,t).duration=+e.apply(this,arguments)}}function Nc(t,e){return e=+e,function(){ie(this,t).duration=e}}function Ec(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Dc:Nc)(e,t)):Jt(this.node(),e).duration}function Ic(t,e){if(typeof e!="function")throw new Error;return function(){ie(this,t).ease=e}}function Lc(t){var e=this._id;return arguments.length?this.each(Ic(e,t)):Jt(this.node(),e).ease}function Uc(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;ie(this,t).ease=n}}function Fc(t){if(typeof t!="function")throw new Error;return this.each(Uc(this._id,t))}function Hc(t){typeof t!="function"&&(t=al(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o=e[i],l=o.length,a=r[i]=[],c,s=0;s<l;++s)(c=o[s])&&t.call(c,c.__data__,s,o)&&a.push(c);return new fe(r,this._parents,this._name,this._id)}function Rc(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,o=Math.min(r,i),l=new Array(r),a=0;a<o;++a)for(var c=e[a],s=n[a],u=c.length,d=l[a]=new Array(u),f,h=0;h<u;++h)(f=c[h]||s[h])&&(d[h]=f);for(;a<r;++a)l[a]=e[a];return new fe(l,this._parents,this._name,this._id)}function Oc(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function Yc(t,e,n){var r,i,o=Oc(e)?Jr:ie;return function(){var l=o(this,t),a=l.on;a!==r&&(i=(r=a).copy()).on(e,n),l.on=i}}function Wc(t,e){var n=this._id;return arguments.length<2?Jt(this.node(),n).on.on(t):this.each(Yc(n,t,e))}function Pc(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function Bc(){return this.on("end.remove",Pc(this._id))}function qc(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Xr(t));for(var r=this._groups,i=r.length,o=new Array(i),l=0;l<i;++l)for(var a=r[l],c=a.length,s=o[l]=new Array(c),u,d,f=0;f<c;++f)(u=a[f])&&(d=t.call(u,u.__data__,f,a))&&("__data__"in u&&(d.__data__=u.__data__),s[f]=d,ur(s[f],e,n,f,s,Jt(u,n)));return new fe(o,this._parents,e,n)}function Vc(t){var e=this._name,n=this._id;typeof t!="function"&&(t=ll(t));for(var r=this._groups,i=r.length,o=[],l=[],a=0;a<i;++a)for(var c=r[a],s=c.length,u,d=0;d<s;++d)if(u=c[d]){for(var f=t.call(u,u.__data__,d,c),h,g=Jt(u,n),k=0,b=f.length;k<b;++k)(h=f[k])&&ur(h,e,n,k,f,g);o.push(f),l.push(u)}return new fe(o,l,e,n)}var Xc=wn.prototype.constructor;function jc(){return new Xc(this._groups,this._parents)}function Kc(t,e){var n,r,i;return function(){var o=Ve(this,t),l=(this.style.removeProperty(t),Ve(this,t));return o===l?null:o===n&&l===r?i:i=e(n=o,r=l)}}function Al(t){return function(){this.style.removeProperty(t)}}function Zc(t,e,n){var r,i=n+"",o;return function(){var l=Ve(this,t);return l===i?null:l===r?o:o=e(r=l,n)}}function Gc(t,e,n){var r,i,o;return function(){var l=Ve(this,t),a=n(this),c=a+"";return a==null&&(c=a=(this.style.removeProperty(t),Ve(this,t))),l===c?null:l===r&&c===i?o:(i=c,o=e(r=l,a))}}function Qc(t,e){var n,r,i,o="style."+e,l="end."+o,a;return function(){var c=ie(this,t),s=c.on,u=c.value[o]==null?a||(a=Al(e)):void 0;(s!==n||i!==u)&&(r=(n=s).copy()).on(l,i=u),c.on=r}}function Jc(t,e,n){var r=(t+="")=="transform"?nc:Ml;return e==null?this.styleTween(t,Kc(t,r)).on("end.style."+t,Al(t)):typeof e=="function"?this.styleTween(t,Gc(t,r,ti(this,"style."+t,e))).each(Qc(this._id,t)):this.styleTween(t,Zc(t,r,e),n).on("end.style."+t,null)}function tf(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function ef(t,e,n){var r,i;function o(){var l=e.apply(this,arguments);return l!==i&&(r=(i=l)&&tf(t,l,n)),r}return o._value=e,o}function nf(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,ef(t,e,n??""))}function rf(t){return function(){this.textContent=t}}function of(t){return function(){var e=t(this);this.textContent=e??""}}function lf(t){return this.tween("text",typeof t=="function"?of(ti(this,"text",t)):rf(t==null?"":t+""))}function af(t){return function(e){this.textContent=t.call(this,e)}}function sf(t){var e,n;function r(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&af(i)),e}return r._value=t,r}function uf(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,sf(t))}function cf(){for(var t=this._name,e=this._id,n=Sl(),r=this._groups,i=r.length,o=0;o<i;++o)for(var l=r[o],a=l.length,c,s=0;s<a;++s)if(c=l[s]){var u=Jt(c,e);ur(c,t,n,s,l,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new fe(r,this._parents,t,n)}function ff(){var t,e,n=this,r=n._id,i=n.size();return new Promise(function(o,l){var a={value:l},c={value:function(){--i===0&&o()}};n.each(function(){var s=ie(this,r),u=s.on;u!==t&&(e=(t=u).copy(),e._.cancel.push(a),e._.interrupt.push(a),e._.end.push(c)),s.on=e}),i===0&&o()})}var df=0;function fe(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function Sl(){return++df}var oe=wn.prototype;fe.prototype={constructor:fe,select:qc,selectAll:Vc,selectChild:oe.selectChild,selectChildren:oe.selectChildren,filter:Hc,merge:Rc,selection:jc,transition:cf,call:oe.call,nodes:oe.nodes,node:oe.node,size:oe.size,empty:oe.empty,each:oe.each,on:Wc,attr:xc,attrTween:Mc,style:Jc,styleTween:nf,text:lf,textTween:uf,remove:Bc,tween:gc,delay:$c,duration:Ec,ease:Lc,easeVarying:Fc,end:ff,[Symbol.iterator]:oe[Symbol.iterator]};function hf(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var pf={time:null,delay:0,duration:250,ease:hf};function gf(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function mf(t){var e,n;t instanceof fe?(e=t._id,t=t._name):(e=Sl(),(n=pf).time=Qr(),t=t==null?null:t+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var l=r[o],a=l.length,c,s=0;s<a;++s)(c=l[s])&&ur(c,t,e,s,l,n||gf(c,e));return new fe(r,this._parents,t,e)}wn.prototype.interrupt=dc;wn.prototype.transition=mf;const Hr=Math.PI,Rr=2*Hr,_e=1e-6,yf=Rr-_e;function $l(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function vf(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return $l;const n=10**e;return function(r){this._+=r[0];for(let i=1,o=r.length;i<o;++i)this._+=Math.round(arguments[i]*n)/n+r[i]}}class _f{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?$l:vf(e)}moveTo(e,n){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,n){this._append`L${this._x1=+e},${this._y1=+n}`}quadraticCurveTo(e,n,r,i){this._append`Q${+e},${+n},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(e,n,r,i,o,l){this._append`C${+e},${+n},${+r},${+i},${this._x1=+o},${this._y1=+l}`}arcTo(e,n,r,i,o){if(e=+e,n=+n,r=+r,i=+i,o=+o,o<0)throw new Error(`negative radius: ${o}`);let l=this._x1,a=this._y1,c=r-e,s=i-n,u=l-e,d=a-n,f=u*u+d*d;if(this._x1===null)this._append`M${this._x1=e},${this._y1=n}`;else if(f>_e)if(!(Math.abs(d*c-s*u)>_e)||!o)this._append`L${this._x1=e},${this._y1=n}`;else{let h=r-l,g=i-a,k=c*c+s*s,b=h*h+g*g,C=Math.sqrt(k),w=Math.sqrt(f),y=o*Math.tan((Hr-Math.acos((k+f-b)/(2*C*w)))/2),m=y/w,N=y/C;Math.abs(m-1)>_e&&this._append`L${e+m*u},${n+m*d}`,this._append`A${o},${o},0,0,${+(d*h>u*g)},${this._x1=e+N*c},${this._y1=n+N*s}`}}arc(e,n,r,i,o,l){if(e=+e,n=+n,r=+r,l=!!l,r<0)throw new Error(`negative radius: ${r}`);let a=r*Math.cos(i),c=r*Math.sin(i),s=e+a,u=n+c,d=1^l,f=l?i-o:o-i;this._x1===null?this._append`M${s},${u}`:(Math.abs(this._x1-s)>_e||Math.abs(this._y1-u)>_e)&&this._append`L${s},${u}`,r&&(f<0&&(f=f%Rr+Rr),f>yf?this._append`A${r},${r},0,1,${d},${e-a},${n-c}A${r},${r},0,1,${d},${this._x1=s},${this._y1=u}`:f>_e&&this._append`A${r},${r},0,${+(f>=Hr)},${d},${this._x1=e+r*Math.cos(o)},${this._y1=n+r*Math.sin(o)}`)}rect(e,n,r,i){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}}function bf(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function Gn(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function je(t){return t=Gn(Math.abs(t)),t?t[1]:NaN}function wf(t,e){return function(n,r){for(var i=n.length,o=[],l=0,a=t[0],c=0;i>0&&a>0&&(c+a+1>r&&(a=Math.max(1,r-c)),o.push(n.substring(i-=a,i+a)),!((c+=a+1)>r));)a=t[l=(l+1)%t.length];return o.reverse().join(e)}}function xf(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var kf=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Qn(t){if(!(e=kf.exec(t)))throw new Error("invalid format: "+t);var e;return new ei({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}Qn.prototype=ei.prototype;function ei(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}ei.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Tf(t){t:for(var e=t.length,n=1,r=-1,i;n<e;++n)switch(t[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+t[n])break t;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(i+1):t}var Dl;function Cf(t,e){var n=Gn(t,e);if(!n)return t+"";var r=n[0],i=n[1],o=i-(Dl=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,l=r.length;return o===l?r:o>l?r+new Array(o-l+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+Gn(t,Math.max(0,e+o-1))[0]}function Ei(t,e){var n=Gn(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const Ii={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:bf,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Ei(t*100,e),r:Ei,s:Cf,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Li(t){return t}var Ui=Array.prototype.map,Fi=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function zf(t){var e=t.grouping===void 0||t.thousands===void 0?Li:wf(Ui.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",o=t.numerals===void 0?Li:xf(Ui.call(t.numerals,String)),l=t.percent===void 0?"%":t.percent+"",a=t.minus===void 0?"−":t.minus+"",c=t.nan===void 0?"NaN":t.nan+"";function s(d){d=Qn(d);var f=d.fill,h=d.align,g=d.sign,k=d.symbol,b=d.zero,C=d.width,w=d.comma,y=d.precision,m=d.trim,N=d.type;N==="n"?(w=!0,N="g"):Ii[N]||(y===void 0&&(y=12),m=!0,N="g"),(b||f==="0"&&h==="=")&&(b=!0,f="0",h="=");var z=k==="$"?n:k==="#"&&/[boxX]/.test(N)?"0"+N.toLowerCase():"",x=k==="$"?r:/[%p]/.test(N)?l:"",L=Ii[N],S=/[defgprs%]/.test(N);y=y===void 0?6:/[gprs]/.test(N)?Math.max(1,Math.min(21,y)):Math.max(0,Math.min(20,y));function $(P){var W=z,D=x,R,et,I;if(N==="c")D=L(P)+D,P="";else{P=+P;var j=P<0||1/P<0;if(P=isNaN(P)?c:L(Math.abs(P),y),m&&(P=Tf(P)),j&&+P==0&&g!=="+"&&(j=!1),W=(j?g==="("?g:a:g==="-"||g==="("?"":g)+W,D=(N==="s"?Fi[8+Dl/3]:"")+D+(j&&g==="("?")":""),S){for(R=-1,et=P.length;++R<et;)if(I=P.charCodeAt(R),48>I||I>57){D=(I===46?i+P.slice(R+1):P.slice(R))+D,P=P.slice(0,R);break}}}w&&!b&&(P=e(P,1/0));var nt=W.length+P.length+D.length,ct=nt<C?new Array(C-nt+1).join(f):"";switch(w&&b&&(P=e(ct+P,ct.length?C-D.length:1/0),ct=""),h){case"<":P=W+P+D+ct;break;case"=":P=W+ct+P+D;break;case"^":P=ct.slice(0,nt=ct.length>>1)+W+P+D+ct.slice(nt);break;default:P=ct+W+P+D;break}return o(P)}return $.toString=function(){return d+""},$}function u(d,f){var h=s((d=Qn(d),d.type="f",d)),g=Math.max(-8,Math.min(8,Math.floor(je(f)/3)))*3,k=Math.pow(10,-g),b=Fi[8+g/3];return function(C){return h(k*C)+b}}return{format:s,formatPrefix:u}}var $n,Nl,El;Mf({thousands:",",grouping:[3],currency:["$",""]});function Mf(t){return $n=zf(t),Nl=$n.format,El=$n.formatPrefix,$n}function Af(t){return Math.max(0,-je(Math.abs(t)))}function Sf(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(je(e)/3)))*3-je(Math.abs(t)))}function $f(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,je(e)-je(t))+1}function Df(t){var e=0,n=t.children,r=n&&n.length;if(!r)e=1;else for(;--r>=0;)e+=n[r].value;t.value=e}function Nf(){return this.eachAfter(Df)}function Ef(t,e){let n=-1;for(const r of this)t.call(e,r,++n,this);return this}function If(t,e){for(var n=this,r=[n],i,o,l=-1;n=r.pop();)if(t.call(e,n,++l,this),i=n.children)for(o=i.length-1;o>=0;--o)r.push(i[o]);return this}function Lf(t,e){for(var n=this,r=[n],i=[],o,l,a,c=-1;n=r.pop();)if(i.push(n),o=n.children)for(l=0,a=o.length;l<a;++l)r.push(o[l]);for(;n=i.pop();)t.call(e,n,++c,this);return this}function Uf(t,e){let n=-1;for(const r of this)if(t.call(e,r,++n,this))return r}function Ff(t){return this.eachAfter(function(e){for(var n=+t(e.data)||0,r=e.children,i=r&&r.length;--i>=0;)n+=r[i].value;e.value=n})}function Hf(t){return this.eachBefore(function(e){e.children&&e.children.sort(t)})}function Rf(t){for(var e=this,n=Of(e,t),r=[e];e!==n;)e=e.parent,r.push(e);for(var i=r.length;t!==n;)r.splice(i,0,t),t=t.parent;return r}function Of(t,e){if(t===e)return t;var n=t.ancestors(),r=e.ancestors(),i=null;for(t=n.pop(),e=r.pop();t===e;)i=t,t=n.pop(),e=r.pop();return i}function Yf(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e}function Wf(){return Array.from(this)}function Pf(){var t=[];return this.eachBefore(function(e){e.children||t.push(e)}),t}function Bf(){var t=this,e=[];return t.each(function(n){n!==t&&e.push({source:n.parent,target:n})}),e}function*qf(){var t=this,e,n=[t],r,i,o;do for(e=n.reverse(),n=[];t=e.pop();)if(yield t,r=t.children)for(i=0,o=r.length;i<o;++i)n.push(r[i]);while(n.length)}function ne(t,e){t instanceof Map?(t=[void 0,t],e===void 0&&(e=jf)):e===void 0&&(e=Xf);for(var n=new Jn(t),r,i=[n],o,l,a,c;r=i.pop();)if((l=e(r.data))&&(c=(l=Array.from(l)).length))for(r.children=l,a=c-1;a>=0;--a)i.push(o=l[a]=new Jn(l[a])),o.parent=r,o.depth=r.depth+1;return n.eachBefore(Zf)}function Vf(){return ne(this).eachBefore(Kf)}function Xf(t){return t.children}function jf(t){return Array.isArray(t)?t[1]:null}function Kf(t){t.data.value!==void 0&&(t.value=t.data.value),t.data=t.data.data}function Zf(t){var e=0;do t.height=e;while((t=t.parent)&&t.height<++e)}function Jn(t){this.data=t,this.depth=this.height=0,this.parent=null}Jn.prototype=ne.prototype={constructor:Jn,count:Nf,each:Ef,eachAfter:Lf,eachBefore:If,find:Uf,sum:Ff,sort:Hf,path:Rf,ancestors:Yf,descendants:Wf,leaves:Pf,links:Bf,copy:Vf,[Symbol.iterator]:qf};function Gf(t){if(typeof t!="function")throw new Error;return t}function en(){return 0}function nn(t){return function(){return t}}function Qf(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)}function Jf(t,e,n,r,i){for(var o=t.children,l,a=-1,c=o.length,s=t.value&&(r-e)/t.value;++a<c;)l=o[a],l.y0=n,l.y1=i,l.x0=e,l.x1=e+=l.value*s}function td(t,e,n,r,i){for(var o=t.children,l,a=-1,c=o.length,s=t.value&&(i-n)/t.value;++a<c;)l=o[a],l.x0=e,l.x1=r,l.y0=n,l.y1=n+=l.value*s}var ed=(1+Math.sqrt(5))/2;function nd(t,e,n,r,i,o){for(var l=[],a=e.children,c,s,u=0,d=0,f=a.length,h,g,k=e.value,b,C,w,y,m,N,z;u<f;){h=i-n,g=o-r;do b=a[d++].value;while(!b&&d<f);for(C=w=b,N=Math.max(g/h,h/g)/(k*t),z=b*b*N,m=Math.max(w/z,z/C);d<f;++d){if(b+=s=a[d].value,s<C&&(C=s),s>w&&(w=s),z=b*b*N,y=Math.max(w/z,z/C),y>m){b-=s;break}m=y}l.push(c={value:b,dice:h<g,children:a.slice(u,d)}),c.dice?Jf(c,n,r,i,k?r+=g*b/k:o):td(c,n,r,k?n+=h*b/k:i,o),k-=b,u=d}return l}const rd=function t(e){function n(r,i,o,l,a){nd(e,r,i,o,l,a)}return n.ratio=function(r){return t((r=+r)>1?r:1)},n}(ed);function Il(){var t=rd,e=!1,n=1,r=1,i=[0],o=en,l=en,a=en,c=en,s=en;function u(f){return f.x0=f.y0=0,f.x1=n,f.y1=r,f.eachBefore(d),i=[0],e&&f.eachBefore(Qf),f}function d(f){var h=i[f.depth],g=f.x0+h,k=f.y0+h,b=f.x1-h,C=f.y1-h;b<g&&(g=b=(g+b)/2),C<k&&(k=C=(k+C)/2),f.x0=g,f.y0=k,f.x1=b,f.y1=C,f.children&&(h=i[f.depth+1]=o(f)/2,g+=s(f)-h,k+=l(f)-h,b-=a(f)-h,C-=c(f)-h,b<g&&(g=b=(g+b)/2),C<k&&(k=C=(k+C)/2),t(f,g,k,b,C))}return u.round=function(f){return arguments.length?(e=!!f,u):e},u.size=function(f){return arguments.length?(n=+f[0],r=+f[1],u):[n,r]},u.tile=function(f){return arguments.length?(t=Gf(f),u):t},u.padding=function(f){return arguments.length?u.paddingInner(f).paddingOuter(f):u.paddingInner()},u.paddingInner=function(f){return arguments.length?(o=typeof f=="function"?f:nn(+f),u):o},u.paddingOuter=function(f){return arguments.length?u.paddingTop(f).paddingRight(f).paddingBottom(f).paddingLeft(f):u.paddingTop()},u.paddingTop=function(f){return arguments.length?(l=typeof f=="function"?f:nn(+f),u):l},u.paddingRight=function(f){return arguments.length?(a=typeof f=="function"?f:nn(+f),u):a},u.paddingBottom=function(f){return arguments.length?(c=typeof f=="function"?f:nn(+f),u):c},u.paddingLeft=function(f){return arguments.length?(s=typeof f=="function"?f:nn(+f),u):s},u}function cr(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}const Hi=Symbol("implicit");function Me(){var t=new Mr,e=[],n=[],r=Hi;function i(o){let l=t.get(o);if(l===void 0){if(r!==Hi)return r;t.set(o,l=e.push(o)-1)}return n[l%n.length]}return i.domain=function(o){if(!arguments.length)return e.slice();e=[],t=new Mr;for(const l of o)t.has(l)||t.set(l,e.push(l)-1);return i},i.range=function(o){return arguments.length?(n=Array.from(o),i):n.slice()},i.unknown=function(o){return arguments.length?(r=o,i):r},i.copy=function(){return Me(e,n).unknown(r)},cr.apply(i,arguments),i}function ni(){var t=Me().unknown(void 0),e=t.domain,n=t.range,r=0,i=1,o,l,a=!1,c=0,s=0,u=.5;delete t.unknown;function d(){var f=e().length,h=i<r,g=h?i:r,k=h?r:i;o=(k-g)/Math.max(1,f-c+s*2),a&&(o=Math.floor(o)),g+=(k-g-o*(f-c))*u,l=o*(1-c),a&&(g=Math.round(g),l=Math.round(l));var b=Pa(f).map(function(C){return g+o*C});return n(h?b.reverse():b)}return t.domain=function(f){return arguments.length?(e(f),d()):e()},t.range=function(f){return arguments.length?([r,i]=f,r=+r,i=+i,d()):[r,i]},t.rangeRound=function(f){return[r,i]=f,r=+r,i=+i,a=!0,d()},t.bandwidth=function(){return l},t.step=function(){return o},t.round=function(f){return arguments.length?(a=!!f,d()):a},t.padding=function(f){return arguments.length?(c=Math.min(1,s=+f),d()):c},t.paddingInner=function(f){return arguments.length?(c=Math.min(1,f),d()):c},t.paddingOuter=function(f){return arguments.length?(s=+f,d()):s},t.align=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),d()):u},t.copy=function(){return ni(e(),[r,i]).round(a).paddingInner(c).paddingOuter(s).align(u)},cr.apply(d(),arguments)}function id(t){return function(){return t}}function od(t){return+t}var Ri=[0,1];function Le(t){return t}function Or(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:id(isNaN(e)?NaN:.5)}function ld(t,e){var n;return t>e&&(n=t,t=e,e=n),function(r){return Math.max(t,Math.min(e,r))}}function ad(t,e,n){var r=t[0],i=t[1],o=e[0],l=e[1];return i<r?(r=Or(i,r),o=n(l,o)):(r=Or(r,i),o=n(o,l)),function(a){return o(r(a))}}function sd(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),o=new Array(r),l=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++l<r;)i[l]=Or(t[l],t[l+1]),o[l]=n(e[l],e[l+1]);return function(a){var c=Ia(t,a,1,r)-1;return o[c](i[c](a))}}function Ll(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function ud(){var t=Ri,e=Ri,n=Gr,r,i,o,l=Le,a,c,s;function u(){var f=Math.min(t.length,e.length);return l!==Le&&(l=ld(t[0],t[f-1])),a=f>2?sd:ad,c=s=null,d}function d(f){return f==null||isNaN(f=+f)?o:(c||(c=a(t.map(r),e,n)))(r(l(f)))}return d.invert=function(f){return l(i((s||(s=a(e,t.map(r),Kt)))(f)))},d.domain=function(f){return arguments.length?(t=Array.from(f,od),u()):t.slice()},d.range=function(f){return arguments.length?(e=Array.from(f),u()):e.slice()},d.rangeRound=function(f){return e=Array.from(f),n=Ju,u()},d.clamp=function(f){return arguments.length?(l=f?!0:Le,u()):l!==Le},d.interpolate=function(f){return arguments.length?(n=f,u()):n},d.unknown=function(f){return arguments.length?(o=f,d):o},function(f,h){return r=f,i=h,u()}}function Ul(){return ud()(Le,Le)}function cd(t,e,n,r){var i=$r(t,e,n),o;switch(r=Qn(r??",f"),r.type){case"s":{var l=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(o=Sf(i,l))&&(r.precision=o),El(r,l)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(o=$f(i,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=o-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(o=Af(i))&&(r.precision=o-(r.type==="%")*2);break}}return Nl(r)}function fd(t){var e=t.domain;return t.ticks=function(n){var r=e();return Wa(r[0],r[r.length-1],n??10)},t.tickFormat=function(n,r){var i=e();return cd(i[0],i[i.length-1],n??10,r)},t.nice=function(n){n==null&&(n=10);var r=e(),i=0,o=r.length-1,l=r[i],a=r[o],c,s,u=10;for(a<l&&(s=l,l=a,a=s,s=i,i=o,o=s);u-- >0;){if(s=Sr(l,a,n),s===c)return r[i]=l,r[o]=a,e(r);if(s>0)l=Math.floor(l/s)*s,a=Math.ceil(a/s)*s;else if(s<0)l=Math.ceil(l*s)/s,a=Math.floor(a*s)/s;else break;c=s}return t},t}function yn(){var t=Ul();return t.copy=function(){return Ll(t,yn())},cr.apply(t,arguments),fd(t)}function dd(t,e){t=t.slice();var n=0,r=t.length-1,i=t[n],o=t[r],l;return o<i&&(l=n,n=r,r=l,l=i,i=o,o=l),t[n]=e.floor(i),t[r]=e.ceil(o),t}const vr=new Date,_r=new Date;function $t(t,e,n,r){function i(o){return t(o=arguments.length===0?new Date:new Date(+o)),o}return i.floor=o=>(t(o=new Date(+o)),o),i.ceil=o=>(t(o=new Date(o-1)),e(o,1),t(o),o),i.round=o=>{const l=i(o),a=i.ceil(o);return o-l<a-o?l:a},i.offset=(o,l)=>(e(o=new Date(+o),l==null?1:Math.floor(l)),o),i.range=(o,l,a)=>{const c=[];if(o=i.ceil(o),a=a==null?1:Math.floor(a),!(o<l)||!(a>0))return c;let s;do c.push(s=new Date(+o)),e(o,a),t(o);while(s<o&&o<l);return c},i.filter=o=>$t(l=>{if(l>=l)for(;t(l),!o(l);)l.setTime(l-1)},(l,a)=>{if(l>=l)if(a<0)for(;++a<=0;)for(;e(l,-1),!o(l););else for(;--a>=0;)for(;e(l,1),!o(l););}),n&&(i.count=(o,l)=>(vr.setTime(+o),_r.setTime(+l),t(vr),t(_r),Math.floor(n(vr,_r))),i.every=o=>(o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?i.filter(r?l=>r(l)%o===0:l=>i.count(0,l)%o===0):i)),i}const tr=$t(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);tr.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?$t(e=>{e.setTime(Math.floor(e/t)*t)},(e,n)=>{e.setTime(+e+n*t)},(e,n)=>(n-e)/t):tr);tr.range;const se=1e3,Bt=se*60,ue=Bt*60,de=ue*24,ri=de*7,Oi=de*30,br=de*365,Ue=$t(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*se)},(t,e)=>(e-t)/se,t=>t.getUTCSeconds());Ue.range;const ii=$t(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*se)},(t,e)=>{t.setTime(+t+e*Bt)},(t,e)=>(e-t)/Bt,t=>t.getMinutes());ii.range;const hd=$t(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*Bt)},(t,e)=>(e-t)/Bt,t=>t.getUTCMinutes());hd.range;const oi=$t(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*se-t.getMinutes()*Bt)},(t,e)=>{t.setTime(+t+e*ue)},(t,e)=>(e-t)/ue,t=>t.getHours());oi.range;const pd=$t(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*ue)},(t,e)=>(e-t)/ue,t=>t.getUTCHours());pd.range;const kn=$t(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Bt)/de,t=>t.getDate()-1);kn.range;const li=$t(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/de,t=>t.getUTCDate()-1);li.range;const gd=$t(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/de,t=>Math.floor(t/de));gd.range;function Ae(t){return $t(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,n)=>{e.setDate(e.getDate()+n*7)},(e,n)=>(n-e-(n.getTimezoneOffset()-e.getTimezoneOffset())*Bt)/ri)}const fr=Ae(0),er=Ae(1),md=Ae(2),yd=Ae(3),Ke=Ae(4),vd=Ae(5),_d=Ae(6);fr.range;er.range;md.range;yd.range;Ke.range;vd.range;_d.range;function Se(t){return $t(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCDate(e.getUTCDate()+n*7)},(e,n)=>(n-e)/ri)}const Fl=Se(0),nr=Se(1),bd=Se(2),wd=Se(3),Ze=Se(4),xd=Se(5),kd=Se(6);Fl.range;nr.range;bd.range;wd.range;Ze.range;xd.range;kd.range;const vn=$t(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12,t=>t.getMonth());vn.range;const Td=$t(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());Td.range;const he=$t(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());he.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:$t(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,n)=>{e.setFullYear(e.getFullYear()+n*t)});he.range;const ze=$t(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());ze.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:$t(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCFullYear(e.getUTCFullYear()+n*t)});ze.range;function Cd(t,e,n,r,i,o){const l=[[Ue,1,se],[Ue,5,5*se],[Ue,15,15*se],[Ue,30,30*se],[o,1,Bt],[o,5,5*Bt],[o,15,15*Bt],[o,30,30*Bt],[i,1,ue],[i,3,3*ue],[i,6,6*ue],[i,12,12*ue],[r,1,de],[r,2,2*de],[n,1,ri],[e,1,Oi],[e,3,3*Oi],[t,1,br]];function a(s,u,d){const f=u<s;f&&([s,u]=[u,s]);const h=d&&typeof d.range=="function"?d:c(s,u,d),g=h?h.range(s,+u+1):[];return f?g.reverse():g}function c(s,u,d){const f=Math.abs(u-s)/d,h=Vr(([,,b])=>b).right(l,f);if(h===l.length)return t.every($r(s/br,u/br,d));if(h===0)return tr.every(Math.max($r(s,u,d),1));const[g,k]=l[f/l[h-1][2]<l[h][2]/f?h-1:h];return g.every(k)}return[a,c]}const[zd,Md]=Cd(he,vn,fr,kn,oi,ii);function wr(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function xr(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function rn(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function Ad(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,o=t.days,l=t.shortDays,a=t.months,c=t.shortMonths,s=on(i),u=ln(i),d=on(o),f=ln(o),h=on(l),g=ln(l),k=on(a),b=ln(a),C=on(c),w=ln(c),y={a:j,A:nt,b:ct,B:Ct,c:null,d:Vi,e:Vi,f:Gd,g:ah,G:uh,H:jd,I:Kd,j:Zd,L:Hl,m:Qd,M:Jd,p:G,q:V,Q:Ki,s:Zi,S:th,u:eh,U:nh,V:rh,w:ih,W:oh,x:null,X:null,y:lh,Y:sh,Z:ch,"%":ji},m={a:F,A:K,b:lt,B:at,c:null,d:Xi,e:Xi,f:ph,g:Th,G:zh,H:fh,I:dh,j:hh,L:Ol,m:gh,M:mh,p:bt,q:st,Q:Ki,s:Zi,S:yh,u:vh,U:_h,V:bh,w:wh,W:xh,x:null,X:null,y:kh,Y:Ch,Z:Mh,"%":ji},N={a:$,A:P,b:W,B:D,c:R,d:Bi,e:Bi,f:Bd,g:Pi,G:Wi,H:qi,I:qi,j:Od,L:Pd,m:Rd,M:Yd,p:S,q:Hd,Q:Vd,s:Xd,S:Wd,u:Ed,U:Id,V:Ld,w:Nd,W:Ud,x:et,X:I,y:Pi,Y:Wi,Z:Fd,"%":qd};y.x=z(n,y),y.X=z(r,y),y.c=z(e,y),m.x=z(n,m),m.X=z(r,m),m.c=z(e,m);function z(B,it){return function(ot){var v=[],E=-1,X=0,rt=B.length,_,U,Y;for(ot instanceof Date||(ot=new Date(+ot));++E<rt;)B.charCodeAt(E)===37&&(v.push(B.slice(X,E)),(U=Yi[_=B.charAt(++E)])!=null?_=B.charAt(++E):U=_==="e"?" ":"0",(Y=it[_])&&(_=Y(ot,U)),v.push(_),X=E+1);return v.push(B.slice(X,E)),v.join("")}}function x(B,it){return function(ot){var v=rn(1900,void 0,1),E=L(v,B,ot+="",0),X,rt;if(E!=ot.length)return null;if("Q"in v)return new Date(v.Q);if("s"in v)return new Date(v.s*1e3+("L"in v?v.L:0));if(it&&!("Z"in v)&&(v.Z=0),"p"in v&&(v.H=v.H%12+v.p*12),v.m===void 0&&(v.m="q"in v?v.q:0),"V"in v){if(v.V<1||v.V>53)return null;"w"in v||(v.w=1),"Z"in v?(X=xr(rn(v.y,0,1)),rt=X.getUTCDay(),X=rt>4||rt===0?nr.ceil(X):nr(X),X=li.offset(X,(v.V-1)*7),v.y=X.getUTCFullYear(),v.m=X.getUTCMonth(),v.d=X.getUTCDate()+(v.w+6)%7):(X=wr(rn(v.y,0,1)),rt=X.getDay(),X=rt>4||rt===0?er.ceil(X):er(X),X=kn.offset(X,(v.V-1)*7),v.y=X.getFullYear(),v.m=X.getMonth(),v.d=X.getDate()+(v.w+6)%7)}else("W"in v||"U"in v)&&("w"in v||(v.w="u"in v?v.u%7:"W"in v?1:0),rt="Z"in v?xr(rn(v.y,0,1)).getUTCDay():wr(rn(v.y,0,1)).getDay(),v.m=0,v.d="W"in v?(v.w+6)%7+v.W*7-(rt+5)%7:v.w+v.U*7-(rt+6)%7);return"Z"in v?(v.H+=v.Z/100|0,v.M+=v.Z%100,xr(v)):wr(v)}}function L(B,it,ot,v){for(var E=0,X=it.length,rt=ot.length,_,U;E<X;){if(v>=rt)return-1;if(_=it.charCodeAt(E++),_===37){if(_=it.charAt(E++),U=N[_ in Yi?it.charAt(E++):_],!U||(v=U(B,ot,v))<0)return-1}else if(_!=ot.charCodeAt(v++))return-1}return v}function S(B,it,ot){var v=s.exec(it.slice(ot));return v?(B.p=u.get(v[0].toLowerCase()),ot+v[0].length):-1}function $(B,it,ot){var v=h.exec(it.slice(ot));return v?(B.w=g.get(v[0].toLowerCase()),ot+v[0].length):-1}function P(B,it,ot){var v=d.exec(it.slice(ot));return v?(B.w=f.get(v[0].toLowerCase()),ot+v[0].length):-1}function W(B,it,ot){var v=C.exec(it.slice(ot));return v?(B.m=w.get(v[0].toLowerCase()),ot+v[0].length):-1}function D(B,it,ot){var v=k.exec(it.slice(ot));return v?(B.m=b.get(v[0].toLowerCase()),ot+v[0].length):-1}function R(B,it,ot){return L(B,e,it,ot)}function et(B,it,ot){return L(B,n,it,ot)}function I(B,it,ot){return L(B,r,it,ot)}function j(B){return l[B.getDay()]}function nt(B){return o[B.getDay()]}function ct(B){return c[B.getMonth()]}function Ct(B){return a[B.getMonth()]}function G(B){return i[+(B.getHours()>=12)]}function V(B){return 1+~~(B.getMonth()/3)}function F(B){return l[B.getUTCDay()]}function K(B){return o[B.getUTCDay()]}function lt(B){return c[B.getUTCMonth()]}function at(B){return a[B.getUTCMonth()]}function bt(B){return i[+(B.getUTCHours()>=12)]}function st(B){return 1+~~(B.getUTCMonth()/3)}return{format:function(B){var it=z(B+="",y);return it.toString=function(){return B},it},parse:function(B){var it=x(B+="",!1);return it.toString=function(){return B},it},utcFormat:function(B){var it=z(B+="",m);return it.toString=function(){return B},it},utcParse:function(B){var it=x(B+="",!0);return it.toString=function(){return B},it}}}var Yi={"-":"",_:" ",0:"0"},Nt=/^\s*\d+/,Sd=/^%/,$d=/[\\^$*+?|[\]().{}]/g;function zt(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(e)+i:i)}function Dd(t){return t.replace($d,"\\$&")}function on(t){return new RegExp("^(?:"+t.map(Dd).join("|")+")","i")}function ln(t){return new Map(t.map((e,n)=>[e.toLowerCase(),n]))}function Nd(t,e,n){var r=Nt.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function Ed(t,e,n){var r=Nt.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function Id(t,e,n){var r=Nt.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function Ld(t,e,n){var r=Nt.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function Ud(t,e,n){var r=Nt.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function Wi(t,e,n){var r=Nt.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function Pi(t,e,n){var r=Nt.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function Fd(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Hd(t,e,n){var r=Nt.exec(e.slice(n,n+1));return r?(t.q=r[0]*3-3,n+r[0].length):-1}function Rd(t,e,n){var r=Nt.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function Bi(t,e,n){var r=Nt.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function Od(t,e,n){var r=Nt.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function qi(t,e,n){var r=Nt.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function Yd(t,e,n){var r=Nt.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function Wd(t,e,n){var r=Nt.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function Pd(t,e,n){var r=Nt.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function Bd(t,e,n){var r=Nt.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function qd(t,e,n){var r=Sd.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function Vd(t,e,n){var r=Nt.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function Xd(t,e,n){var r=Nt.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function Vi(t,e){return zt(t.getDate(),e,2)}function jd(t,e){return zt(t.getHours(),e,2)}function Kd(t,e){return zt(t.getHours()%12||12,e,2)}function Zd(t,e){return zt(1+kn.count(he(t),t),e,3)}function Hl(t,e){return zt(t.getMilliseconds(),e,3)}function Gd(t,e){return Hl(t,e)+"000"}function Qd(t,e){return zt(t.getMonth()+1,e,2)}function Jd(t,e){return zt(t.getMinutes(),e,2)}function th(t,e){return zt(t.getSeconds(),e,2)}function eh(t){var e=t.getDay();return e===0?7:e}function nh(t,e){return zt(fr.count(he(t)-1,t),e,2)}function Rl(t){var e=t.getDay();return e>=4||e===0?Ke(t):Ke.ceil(t)}function rh(t,e){return t=Rl(t),zt(Ke.count(he(t),t)+(he(t).getDay()===4),e,2)}function ih(t){return t.getDay()}function oh(t,e){return zt(er.count(he(t)-1,t),e,2)}function lh(t,e){return zt(t.getFullYear()%100,e,2)}function ah(t,e){return t=Rl(t),zt(t.getFullYear()%100,e,2)}function sh(t,e){return zt(t.getFullYear()%1e4,e,4)}function uh(t,e){var n=t.getDay();return t=n>=4||n===0?Ke(t):Ke.ceil(t),zt(t.getFullYear()%1e4,e,4)}function ch(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+zt(e/60|0,"0",2)+zt(e%60,"0",2)}function Xi(t,e){return zt(t.getUTCDate(),e,2)}function fh(t,e){return zt(t.getUTCHours(),e,2)}function dh(t,e){return zt(t.getUTCHours()%12||12,e,2)}function hh(t,e){return zt(1+li.count(ze(t),t),e,3)}function Ol(t,e){return zt(t.getUTCMilliseconds(),e,3)}function ph(t,e){return Ol(t,e)+"000"}function gh(t,e){return zt(t.getUTCMonth()+1,e,2)}function mh(t,e){return zt(t.getUTCMinutes(),e,2)}function yh(t,e){return zt(t.getUTCSeconds(),e,2)}function vh(t){var e=t.getUTCDay();return e===0?7:e}function _h(t,e){return zt(Fl.count(ze(t)-1,t),e,2)}function Yl(t){var e=t.getUTCDay();return e>=4||e===0?Ze(t):Ze.ceil(t)}function bh(t,e){return t=Yl(t),zt(Ze.count(ze(t),t)+(ze(t).getUTCDay()===4),e,2)}function wh(t){return t.getUTCDay()}function xh(t,e){return zt(nr.count(ze(t)-1,t),e,2)}function kh(t,e){return zt(t.getUTCFullYear()%100,e,2)}function Th(t,e){return t=Yl(t),zt(t.getUTCFullYear()%100,e,2)}function Ch(t,e){return zt(t.getUTCFullYear()%1e4,e,4)}function zh(t,e){var n=t.getUTCDay();return t=n>=4||n===0?Ze(t):Ze.ceil(t),zt(t.getUTCFullYear()%1e4,e,4)}function Mh(){return"+0000"}function ji(){return"%"}function Ki(t){return+t}function Zi(t){return Math.floor(+t/1e3)}var Ne,Fe;Ah({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Ah(t){return Ne=Ad(t),Fe=Ne.format,Ne.parse,Ne.utcFormat,Ne.utcParse,Ne}function Sh(t){return new Date(t)}function $h(t){return t instanceof Date?+t:+new Date(+t)}function Wl(t,e,n,r,i,o,l,a,c,s){var u=Ul(),d=u.invert,f=u.domain,h=s(".%L"),g=s(":%S"),k=s("%I:%M"),b=s("%I %p"),C=s("%a %d"),w=s("%b %d"),y=s("%B"),m=s("%Y");function N(z){return(c(z)<z?h:a(z)<z?g:l(z)<z?k:o(z)<z?b:r(z)<z?i(z)<z?C:w:n(z)<z?y:m)(z)}return u.invert=function(z){return new Date(d(z))},u.domain=function(z){return arguments.length?f(Array.from(z,$h)):f().map(Sh)},u.ticks=function(z){var x=f();return t(x[0],x[x.length-1],z??10)},u.tickFormat=function(z,x){return x==null?N:s(x)},u.nice=function(z){var x=f();return(!z||typeof z.range!="function")&&(z=e(x[0],x[x.length-1],z??10)),z?f(dd(x,z)):u},u.copy=function(){return Ll(u,Wl(t,e,n,r,i,o,l,a,c,s))},u}function Dh(){return cr.apply(Wl(zd,Md,he,vn,fr,kn,oi,ii,Ue,Fe).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Nh(t){for(var e=t.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+t.slice(r*6,++r*6);return n}const Tn=Nh("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf");function Mt(t){return function(){return t}}const Gi=Math.abs,It=Math.atan2,ve=Math.cos,Eh=Math.max,kr=Math.min,ee=Math.sin,He=Math.sqrt,Ut=1e-12,_n=Math.PI,rr=_n/2,Hn=2*_n;function Ih(t){return t>1?0:t<-1?_n:Math.acos(t)}function Qi(t){return t>=1?rr:t<=-1?-rr:Math.asin(t)}function Pl(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(n==null)e=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);e=r}return t},()=>new _f(e)}function Lh(t){return t.innerRadius}function Uh(t){return t.outerRadius}function Fh(t){return t.startAngle}function Hh(t){return t.endAngle}function Rh(t){return t&&t.padAngle}function Oh(t,e,n,r,i,o,l,a){var c=n-t,s=r-e,u=l-i,d=a-o,f=d*c-u*s;if(!(f*f<Ut))return f=(u*(e-o)-d*(t-i))/f,[t+f*c,e+f*s]}function Dn(t,e,n,r,i,o,l){var a=t-n,c=e-r,s=(l?o:-o)/He(a*a+c*c),u=s*c,d=-s*a,f=t+u,h=e+d,g=n+u,k=r+d,b=(f+g)/2,C=(h+k)/2,w=g-f,y=k-h,m=w*w+y*y,N=i-o,z=f*k-g*h,x=(y<0?-1:1)*He(Eh(0,N*N*m-z*z)),L=(z*y-w*x)/m,S=(-z*w-y*x)/m,$=(z*y+w*x)/m,P=(-z*w+y*x)/m,W=L-b,D=S-C,R=$-b,et=P-C;return W*W+D*D>R*R+et*et&&(L=$,S=P),{cx:L,cy:S,x01:-u,y01:-d,x11:L*(i/N-1),y11:S*(i/N-1)}}function Ji(){var t=Lh,e=Uh,n=Mt(0),r=null,i=Fh,o=Hh,l=Rh,a=null,c=Pl(s);function s(){var u,d,f=+t.apply(this,arguments),h=+e.apply(this,arguments),g=i.apply(this,arguments)-rr,k=o.apply(this,arguments)-rr,b=Gi(k-g),C=k>g;if(a||(a=u=c()),h<f&&(d=h,h=f,f=d),!(h>Ut))a.moveTo(0,0);else if(b>Hn-Ut)a.moveTo(h*ve(g),h*ee(g)),a.arc(0,0,h,g,k,!C),f>Ut&&(a.moveTo(f*ve(k),f*ee(k)),a.arc(0,0,f,k,g,C));else{var w=g,y=k,m=g,N=k,z=b,x=b,L=l.apply(this,arguments)/2,S=L>Ut&&(r?+r.apply(this,arguments):He(f*f+h*h)),$=kr(Gi(h-f)/2,+n.apply(this,arguments)),P=$,W=$,D,R;if(S>Ut){var et=Qi(S/f*ee(L)),I=Qi(S/h*ee(L));(z-=et*2)>Ut?(et*=C?1:-1,m+=et,N-=et):(z=0,m=N=(g+k)/2),(x-=I*2)>Ut?(I*=C?1:-1,w+=I,y-=I):(x=0,w=y=(g+k)/2)}var j=h*ve(w),nt=h*ee(w),ct=f*ve(N),Ct=f*ee(N);if($>Ut){var G=h*ve(y),V=h*ee(y),F=f*ve(m),K=f*ee(m),lt;if(b<_n)if(lt=Oh(j,nt,F,K,G,V,ct,Ct)){var at=j-lt[0],bt=nt-lt[1],st=G-lt[0],B=V-lt[1],it=1/ee(Ih((at*st+bt*B)/(He(at*at+bt*bt)*He(st*st+B*B)))/2),ot=He(lt[0]*lt[0]+lt[1]*lt[1]);P=kr($,(f-ot)/(it-1)),W=kr($,(h-ot)/(it+1))}else P=W=0}x>Ut?W>Ut?(D=Dn(F,K,j,nt,h,W,C),R=Dn(G,V,ct,Ct,h,W,C),a.moveTo(D.cx+D.x01,D.cy+D.y01),W<$?a.arc(D.cx,D.cy,W,It(D.y01,D.x01),It(R.y01,R.x01),!C):(a.arc(D.cx,D.cy,W,It(D.y01,D.x01),It(D.y11,D.x11),!C),a.arc(0,0,h,It(D.cy+D.y11,D.cx+D.x11),It(R.cy+R.y11,R.cx+R.x11),!C),a.arc(R.cx,R.cy,W,It(R.y11,R.x11),It(R.y01,R.x01),!C))):(a.moveTo(j,nt),a.arc(0,0,h,w,y,!C)):a.moveTo(j,nt),!(f>Ut)||!(z>Ut)?a.lineTo(ct,Ct):P>Ut?(D=Dn(ct,Ct,G,V,f,-P,C),R=Dn(j,nt,F,K,f,-P,C),a.lineTo(D.cx+D.x01,D.cy+D.y01),P<$?a.arc(D.cx,D.cy,P,It(D.y01,D.x01),It(R.y01,R.x01),!C):(a.arc(D.cx,D.cy,P,It(D.y01,D.x01),It(D.y11,D.x11),!C),a.arc(0,0,f,It(D.cy+D.y11,D.cx+D.x11),It(R.cy+R.y11,R.cx+R.x11),C),a.arc(R.cx,R.cy,P,It(R.y11,R.x11),It(R.y01,R.x01),!C))):a.arc(0,0,f,N,m,C)}if(a.closePath(),u)return a=null,u+""||null}return s.centroid=function(){var u=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,d=(+i.apply(this,arguments)+ +o.apply(this,arguments))/2-_n/2;return[ve(d)*u,ee(d)*u]},s.innerRadius=function(u){return arguments.length?(t=typeof u=="function"?u:Mt(+u),s):t},s.outerRadius=function(u){return arguments.length?(e=typeof u=="function"?u:Mt(+u),s):e},s.cornerRadius=function(u){return arguments.length?(n=typeof u=="function"?u:Mt(+u),s):n},s.padRadius=function(u){return arguments.length?(r=u==null?null:typeof u=="function"?u:Mt(+u),s):r},s.startAngle=function(u){return arguments.length?(i=typeof u=="function"?u:Mt(+u),s):i},s.endAngle=function(u){return arguments.length?(o=typeof u=="function"?u:Mt(+u),s):o},s.padAngle=function(u){return arguments.length?(l=typeof u=="function"?u:Mt(+u),s):l},s.context=function(u){return arguments.length?(a=u??null,s):a},s}function ai(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Bl(t){this._context=t}Bl.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function Yh(t){return new Bl(t)}function Wh(t){return t[0]}function Ph(t){return t[1]}function to(t,e){var n=Mt(!0),r=null,i=Yh,o=null,l=Pl(a);t=typeof t=="function"?t:t===void 0?Wh:Mt(t),e=typeof e=="function"?e:e===void 0?Ph:Mt(e);function a(c){var s,u=(c=ai(c)).length,d,f=!1,h;for(r==null&&(o=i(h=l())),s=0;s<=u;++s)!(s<u&&n(d=c[s],s,c))===f&&((f=!f)?o.lineStart():o.lineEnd()),f&&o.point(+t(d,s,c),+e(d,s,c));if(h)return o=null,h+""||null}return a.x=function(c){return arguments.length?(t=typeof c=="function"?c:Mt(+c),a):t},a.y=function(c){return arguments.length?(e=typeof c=="function"?c:Mt(+c),a):e},a.defined=function(c){return arguments.length?(n=typeof c=="function"?c:Mt(!!c),a):n},a.curve=function(c){return arguments.length?(i=c,r!=null&&(o=i(r)),a):i},a.context=function(c){return arguments.length?(c==null?r=o=null:o=i(r=c),a):r},a}function Bh(t,e){return e<t?-1:e>t?1:e>=t?0:NaN}function qh(t){return t}function Vh(){var t=qh,e=Bh,n=null,r=Mt(0),i=Mt(Hn),o=Mt(0);function l(a){var c,s=(a=ai(a)).length,u,d,f=0,h=new Array(s),g=new Array(s),k=+r.apply(this,arguments),b=Math.min(Hn,Math.max(-Hn,i.apply(this,arguments)-k)),C,w=Math.min(Math.abs(b)/s,o.apply(this,arguments)),y=w*(b<0?-1:1),m;for(c=0;c<s;++c)(m=g[h[c]=c]=+t(a[c],c,a))>0&&(f+=m);for(e!=null?h.sort(function(N,z){return e(g[N],g[z])}):n!=null&&h.sort(function(N,z){return n(a[N],a[z])}),c=0,d=f?(b-s*y)/f:0;c<s;++c,k=C)u=h[c],m=g[u],C=k+(m>0?m*d:0)+y,g[u]={data:a[u],index:c,value:m,startAngle:k,endAngle:C,padAngle:w};return g}return l.value=function(a){return arguments.length?(t=typeof a=="function"?a:Mt(+a),l):t},l.sortValues=function(a){return arguments.length?(e=a,n=null,l):e},l.sort=function(a){return arguments.length?(n=a,e=null,l):n},l.startAngle=function(a){return arguments.length?(r=typeof a=="function"?a:Mt(+a),l):r},l.endAngle=function(a){return arguments.length?(i=typeof a=="function"?a:Mt(+a),l):i},l.padAngle=function(a){return arguments.length?(o=typeof a=="function"?a:Mt(+a),l):o},l}function eo(t){return t<0?-1:1}function no(t,e,n){var r=t._x1-t._x0,i=e-t._x1,o=(t._y1-t._y0)/(r||i<0&&-0),l=(n-t._y1)/(i||r<0&&-0),a=(o*i+l*r)/(r+i);return(eo(o)+eo(l))*Math.min(Math.abs(o),Math.abs(l),.5*Math.abs(a))||0}function ro(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function Tr(t,e,n){var r=t._x0,i=t._y0,o=t._x1,l=t._y1,a=(o-r)/3;t._context.bezierCurveTo(r+a,i+a*e,o-a,l-a*n,o,l)}function ir(t){this._context=t}ir.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Tr(this,this._t0,ro(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,Tr(this,ro(this,n=no(this,t,e)),n);break;default:Tr(this,this._t0,n=no(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}};Object.create(ir.prototype).point=function(t,e){ir.prototype.point.call(this,e,t)};function io(t){return new ir(t)}function oo(t,e){if((l=t.length)>1)for(var n=1,r,i,o=t[e[0]],l,a=o.length;n<l;++n)for(i=o,o=t[e[n]],r=0;r<a;++r)o[r][1]+=o[r][0]=isNaN(i[r][1])?i[r][0]:i[r][1]}function lo(t){for(var e=t.length,n=new Array(e);--e>=0;)n[e]=e;return n}function Xh(t,e){return t[e]}function jh(t){const e=[];return e.key=t,e}function Kh(){var t=Mt([]),e=lo,n=oo,r=Xh;function i(o){var l=Array.from(t.apply(this,arguments),jh),a,c=l.length,s=-1,u;for(const d of o)for(a=0,++s;a<c;++a)(l[a][s]=[0,+r(d,l[a].key,s,o)]).data=d;for(a=0,u=ai(e(l));a<c;++a)l[u[a]].index=a;return n(l,u),l}return i.keys=function(o){return arguments.length?(t=typeof o=="function"?o:Mt(Array.from(o)),i):t},i.value=function(o){return arguments.length?(r=typeof o=="function"?o:Mt(+o),i):r},i.order=function(o){return arguments.length?(e=o==null?lo:typeof o=="function"?o:Mt(Array.from(o)),i):e},i.offset=function(o){return arguments.length?(n=o??oo,i):n},i}function cn(t,e,n){this.k=t,this.x=e,this.y=n}cn.prototype={constructor:cn,scale:function(t){return t===1?this:new cn(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new cn(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};cn.prototype;function Zh(t){const e=t-1;return e*e*e+1}function ao(t,{delay:e=0,duration:n=400,easing:r=Zh,axis:i="y"}={}){const o=getComputedStyle(t),l=+o.opacity,a=i==="y"?"height":"width",c=parseFloat(o[a]),s=i==="y"?["top","bottom"]:["left","right"],u=s.map(C=>`${C[0].toUpperCase()}${C.slice(1)}`),d=parseFloat(o[`padding${u[0]}`]),f=parseFloat(o[`padding${u[1]}`]),h=parseFloat(o[`margin${u[0]}`]),g=parseFloat(o[`margin${u[1]}`]),k=parseFloat(o[`border${u[0]}Width`]),b=parseFloat(o[`border${u[1]}Width`]);return{delay:e,duration:n,easing:r,css:C=>`overflow: hidden;opacity: ${Math.min(C*20,1)*l};${a}: ${C*c}px;padding-${s[0]}: ${C*d}px;padding-${s[1]}: ${C*f}px;margin-${s[0]}: ${C*h}px;margin-${s[1]}: ${C*g}px;border-${s[0]}-width: ${C*k}px;border-${s[1]}-width: ${C*b}px;`}}function Gh(t){let e;return{c(){e=H(t[7])},m(n,r){Q(n,e,r)},p(n,r){r&128&&tt(e,n[7])},d(n){n&&Z(e)}}}function Qh(t){let e,n;return{c(){e=new ea(!1),n=Vo(),e.a=n},m(r,i){e.m(t[5],r,i),Q(r,n,i)},p(r,i){i&32&&e.p(r[5])},d(r){r&&Z(n),r&&e.d()}}}function so(t){let e,n,r=(t[0]?_t("ui.hide_description"):_t("ui.show_description"))+"",i,o,l,a,c,s;return{c(){e=M("button"),n=M("span"),i=H(r),o=ht(),l=dn("svg"),a=dn("path"),T(n,"class","sr-only svelte-1o4uev"),T(a,"d","M5 7.5L10 12.5L15 7.5"),T(a,"stroke","currentColor"),T(a,"stroke-width","2"),T(a,"stroke-linecap","round"),T(a,"stroke-linejoin","round"),T(l,"class","accordion-icon svelte-1o4uev"),T(l,"width","20"),T(l,"height","20"),T(l,"viewBox","0 0 20 20"),T(l,"fill","none"),T(l,"xmlns","http://www.w3.org/2000/svg"),ge(l,"open",t[0]),T(e,"class","accordion-toggle svelte-1o4uev"),T(e,"aria-expanded",t[0]),T(e,"aria-controls","description-panel")},m(u,d){Q(u,e,d),p(e,n),p(n,i),p(e,o),p(e,l),p(l,a),c||(s=[Lt(e,"click",t[8]),Lt(e,"keydown",t[9])],c=!0)},p(u,d){d&1&&r!==(r=(u[0]?_t("ui.hide_description"):_t("ui.show_description"))+"")&&tt(i,r),d&1&&ge(l,"open",u[0]),d&1&&T(e,"aria-expanded",u[0])},d(u){u&&Z(e),c=!1,Ht(s)}}}function uo(t){let e,n,r=t[0]&&co(t);return{c(){e=M("div"),r&&r.c(),T(e,"class","description-panel-wrapper svelte-1o4uev")},m(i,o){Q(i,e,o),r&&r.m(e,null),n=!0},p(i,o){i[0]?r?(r.p(i,o),o&1&&At(r,1)):(r=co(i),r.c(),At(r,1),r.m(e,null)):r&&(Pr(),St(r,1,1,()=>{r=null}),Br())},i(i){n||(At(r),n=!0)},o(i){St(r),n=!1},d(i){i&&Z(e),r&&r.d()}}}function co(t){let e,n,r,i,o;return{c(){e=M("div"),n=M("p"),r=H(t[6]),T(n,"class","svelte-1o4uev"),T(e,"id","description-panel"),T(e,"class","description-panel svelte-1o4uev")},m(l,a){Q(l,e,a),p(e,n),p(n,r),o=!0},p(l,a){(!o||a&64)&&tt(r,l[6])},i(l){o||(ke(()=>{o&&(i||(i=hi(e,ao,{duration:300},!0)),i.run(1))}),o=!0)},o(l){i||(i=hi(e,ao,{duration:300},!1)),i.run(0),o=!1},d(l){l&&Z(e),l&&i&&i.end()}}}function Jh(t){let e,n,r,i,o,l;function a(f,h){if(f[5])return Qh;if(f[2]||f[1])return Gh}let c=a(t),s=c&&c(t),u=(t[3]||t[4])&&so(t),d=(t[3]||t[4])&&uo(t);return{c(){e=M("div"),n=M("div"),r=M("h2"),s&&s.c(),i=ht(),u&&u.c(),o=ht(),d&&d.c(),T(r,"class","visualization-title svelte-1o4uev"),T(n,"class","title-container svelte-1o4uev"),T(e,"class","visualization-header svelte-1o4uev"),ge(e,"has-description",t[0])},m(f,h){Q(f,e,h),p(e,n),p(n,r),s&&s.m(r,null),p(n,i),u&&u.m(n,null),p(e,o),d&&d.m(e,null),l=!0},p(f,[h]){c===(c=a(f))&&s?s.p(f,h):(s&&s.d(1),s=c&&c(f),s&&(s.c(),s.m(r,null))),f[3]||f[4]?u?u.p(f,h):(u=so(f),u.c(),u.m(n,null)):u&&(u.d(1),u=null),f[3]||f[4]?d?(d.p(f,h),h&24&&At(d,1)):(d=uo(f),d.c(),At(d,1),d.m(e,null)):d&&(Pr(),St(d,1,1,()=>{d=null}),Br()),(!l||h&1)&&ge(e,"has-description",f[0])},i(f){l||(At(d),l=!0)},o(f){St(d),l=!1},d(f){f&&Z(e),s&&s.d(),u&&u.d(),d&&d.d()}}}function tp(t,e,n){let r,i,{title:o}=e,{translationKey:l=""}=e,{description:a=""}=e,{showDescription:c=!1}=e,{descriptionTranslationKey:s=""}=e,{titleHtml:u=""}=e;function d(){n(0,c=!c)}const f=h=>h.key==="Enter"&&d();return t.$$set=h=>{"title"in h&&n(1,o=h.title),"translationKey"in h&&n(2,l=h.translationKey),"description"in h&&n(3,a=h.description),"showDescription"in h&&n(0,c=h.showDescription),"descriptionTranslationKey"in h&&n(4,s=h.descriptionTranslationKey),"titleHtml"in h&&n(5,u=h.titleHtml)},t.$$.update=()=>{t.$$.dirty&6&&n(7,r=l?_t(l):o),t.$$.dirty&24&&n(6,i=s?_t(s):a)},[c,o,l,a,s,u,i,r,d,f]}class ep extends Qt{constructor(e){super(),Gt(this,e,tp,Jh,qt,{title:1,translationKey:2,description:3,showDescription:0,descriptionTranslationKey:4,titleHtml:5})}}function np(t){let e;return{c(){e=M("div"),e.textContent=`${_t("ui.no_visualization_content")}`,T(e,"class","no-content svelte-1jo3qap")},m(n,r){Q(n,e,r)},p:Tt,d(n){n&&Z(e)}}}function rp(t){let e,n=t[6].error+"",r;return{c(){e=M("div"),r=H(n),T(e,"class","error svelte-1jo3qap")},m(i,o){Q(i,e,o),p(e,r)},p(i,o){o&64&&n!==(n=i[6].error+"")&&tt(r,n)},d(i){i&&Z(e)}}}function ip(t){let e;return{c(){e=M("div"),e.textContent=`${_t("ui.loading")}`,T(e,"class","loading svelte-1jo3qap")},m(n,r){Q(n,e,r)},p:Tt,d(n){n&&Z(e)}}}function op(t){let e;function n(o,l){return o[6].loading?ip:o[6].error?rp:np}let r=n(t),i=r(t);return{c(){e=M("div"),i.c(),T(e,"class","empty-visualization svelte-1jo3qap")},m(o,l){Q(o,e,l),i.m(e,null)},p(o,l){r===(r=n(o))&&i?i.p(o,l):(i.d(1),i=r(o),i&&(i.c(),i.m(e,null)))},d(o){o&&Z(e),i.d()}}}function lp(t){let e,n,r,i,o,l;function a(f){t[9](f)}let c={title:t[1],translationKey:t[2],description:t[3],descriptionTranslationKey:t[4],titleHtml:t[5]};t[0]!==void 0&&(c.showDescription=t[0]),n=new ep({props:c}),ce.push(()=>da(n,"showDescription",a));const s=t[8].default,u=Ho(s,t,t[7],null),d=u||op(t);return{c(){e=M("div"),Vt(n.$$.fragment),i=ht(),o=M("div"),d&&d.c(),T(o,"class","visualization-content svelte-1jo3qap"),T(e,"class","visualization-wrapper svelte-1jo3qap")},m(f,h){Q(f,e,h),Wt(n,e,null),p(e,i),p(e,o),d&&d.m(o,null),l=!0},p(f,[h]){const g={};h&2&&(g.title=f[1]),h&4&&(g.translationKey=f[2]),h&8&&(g.description=f[3]),h&16&&(g.descriptionTranslationKey=f[4]),h&32&&(g.titleHtml=f[5]),!r&&h&1&&(r=!0,g.showDescription=f[0],aa(()=>r=!1)),n.$set(g),u?u.p&&(!l||h&128)&&Yo(u,s,f,f[7],l?Oo(s,f[7],h,null):Wo(f[7]),null):d&&d.p&&(!l||h&64)&&d.p(f,l?h:-1)},i(f){l||(At(n.$$.fragment,f),At(d,f),l=!0)},o(f){St(n.$$.fragment,f),St(d,f),l=!1},d(f){f&&Z(e),Pt(n),d&&d.d(f)}}}function ap(t,e,n){let r;mt(t,Et,h=>n(6,r=h));let{$$slots:i={},$$scope:o}=e,{title:l}=e,{translationKey:a=""}=e,{description:c=""}=e,{descriptionTranslationKey:s=""}=e,{showDescription:u=!1}=e,{titleHtml:d=""}=e;function f(h){u=h,n(0,u)}return t.$$set=h=>{"title"in h&&n(1,l=h.title),"translationKey"in h&&n(2,a=h.translationKey),"description"in h&&n(3,c=h.description),"descriptionTranslationKey"in h&&n(4,s=h.descriptionTranslationKey),"showDescription"in h&&n(0,u=h.showDescription),"titleHtml"in h&&n(5,d=h.titleHtml),"$$scope"in h&&n(7,o=h.$$scope)},[u,l,a,c,s,d,r,o,i,f]}class si extends Qt{constructor(e){super(),Gt(this,e,ap,lp,qt,{title:1,translationKey:2,description:3,descriptionTranslationKey:4,showDescription:0,titleHtml:5})}}function sp(t){let e;return{c(){e=M("div"),e.textContent="Initializing visualization...",T(e,"class","loading svelte-63tjyd")},m(n,r){Q(n,e,r)},p:Tt,d(n){n&&Z(e)}}}function up(t){let e,n;return{c(){e=M("div"),n=H(t[9]),T(e,"class","no-data svelte-63tjyd")},m(r,i){Q(r,e,i),p(e,n)},p(r,i){i[0]&512&&tt(n,r[9])},d(r){r&&Z(e)}}}function cp(t){let e,n=t[3].error+"",r;return{c(){e=M("div"),r=H(n),T(e,"class","error svelte-63tjyd")},m(i,o){Q(i,e,o),p(e,r)},p(i,o){o[0]&8&&n!==(n=i[3].error+"")&&tt(r,n)},d(i){i&&Z(e)}}}function fp(t){let e;return{c(){e=M("div"),e.textContent=`${_t("ui.loading")}`,T(e,"class","loading svelte-63tjyd")},m(n,r){Q(n,e,r)},p:Tt,d(n){n&&Z(e)}}}function dp(t){let e,n;return{c(){e=M("p"),n=H(t[7]),T(e,"class","svelte-63tjyd")},m(r,i){Q(r,e,i),p(e,n)},p(r,i){i[0]&128&&tt(n,r[7])},d(r){r&&Z(e)}}}function hp(t){let e,n,r,i,o=t[6].data.name+"",l,a,c,s;return{c(){e=M("p"),n=H(t[13]),r=H(": "),i=M("strong"),l=H(o),a=ht(),c=M("p"),s=H(t[14]),T(e,"class","svelte-63tjyd"),T(c,"class","svelte-63tjyd")},m(u,d){Q(u,e,d),p(e,n),p(e,r),p(e,i),p(i,l),Q(u,a,d),Q(u,c,d),p(c,s)},p(u,d){d[0]&8192&&tt(n,u[13]),d[0]&64&&o!==(o=u[6].data.name+"")&&tt(l,o),d[0]&16384&&tt(s,u[14])},d(u){u&&Z(e),u&&Z(a),u&&Z(c)}}}function pp(t){let e,n,r,i,o,l,a,c,s,u,d,f,h,g,k,b,C,w,y,m,N,z,x,L,S;function $(I,j){if(I[3].loading)return fp;if(I[3].error)return cp;if(!I[3].items||I[3].items.length===0)return up;if(!I[0])return sp}let P=$(t),W=P&&P(t);function D(I,j){return I[6]?hp:dp}let R=D(t),et=R(t);return{c(){e=M("div"),W&&W.c(),n=ht(),r=M("div"),i=M("div"),o=M("h3"),l=H(t[10]),a=ht(),c=M("p"),s=H(t[11]),u=H(": "),d=M("strong"),f=H(t[2]),h=ht(),g=M("p"),k=H(t[12]),b=H(": "),C=M("strong"),w=H(t[4]),y=ht(),m=M("p"),N=H(t[8]),z=H(": "),x=M("strong"),L=H(t[5]),S=ht(),et.c(),T(e,"class","chart-container svelte-63tjyd"),T(o,"class","svelte-63tjyd"),T(c,"class","svelte-63tjyd"),T(g,"class","svelte-63tjyd"),T(m,"class","svelte-63tjyd"),T(i,"class","stat-summary svelte-63tjyd"),T(r,"class","stats svelte-63tjyd")},m(I,j){Q(I,e,j),W&&W.m(e,null),t[28](e),Q(I,n,j),Q(I,r,j),p(r,i),p(i,o),p(o,l),p(i,a),p(i,c),p(c,s),p(c,u),p(c,d),p(d,f),p(i,h),p(i,g),p(g,k),p(g,b),p(g,C),p(C,w),p(i,y),p(i,m),p(m,N),p(m,z),p(m,x),p(x,L),p(i,S),et.m(i,null)},p(I,j){P===(P=$(I))&&W?W.p(I,j):(W&&W.d(1),W=P&&P(I),W&&(W.c(),W.m(e,null))),j[0]&1024&&tt(l,I[10]),j[0]&2048&&tt(s,I[11]),j[0]&4&&tt(f,I[2]),j[0]&4096&&tt(k,I[12]),j[0]&16&&tt(w,I[4]),j[0]&256&&tt(N,I[8]),j[0]&32&&tt(L,I[5]),R===(R=D(I))&&et?et.p(I,j):(et.d(1),et=R(I),et&&(et.c(),et.m(i,null)))},d(I){I&&Z(e),W&&W.d(),t[28](null),I&&Z(n),I&&Z(r),et.d()}}}function gp(t){let e,n,r;return n=new si({props:{title:"",translationKey:"",description:"This visualization shows the distribution of items by country and sub-collection. You can click on any country block to zoom in and see its sub-collections. The size of each block represents the number of items in that country or sub-collection.",descriptionTranslationKey:mp,titleHtml:t[1],$$slots:{default:[pp]},$$scope:{ctx:t}}}),{c(){e=M("div"),Vt(n.$$.fragment),T(e,"class","country-distribution-container svelte-63tjyd")},m(i,o){Q(i,e,o),Wt(n,e,null),r=!0},p(i,o){const l={};o[0]&2&&(l.titleHtml=i[1]),o[0]&32765|o[1]&1048576&&(l.$$scope={dirty:o,ctx:i}),n.$set(l)},i(i){r||(At(n.$$.fragment,i),r=!0)},o(i){St(n.$$.fragment,i),r=!1},d(i){i&&Z(e),Pt(n)}}}const mp="viz.country_distribution_description";function yp(t,e,n){let r,i,o,l,a,c,s,u,d,f,h,g,k,b;mt(t,Et,_=>n(3,r=_));let C=0,w=0,y,m,N={name:"root",children:[]},z=null,x="en",L="",S=0,$=0,P=0,W=null;const D=pt("viz.no_data");mt(t,D,_=>n(9,u=_));const R=pt("viz.items");mt(t,R,_=>n(37,l=_));const et=pt("viz.percent_of_country");mt(t,et,_=>n(36,o=_));const I=pt("viz.percent_of_total");mt(t,I,_=>n(35,i=_));const j=pt("viz.click_zoom_in");mt(t,j,_=>n(7,a=_));const nt=pt("viz.back_to_all");mt(t,nt,_=>n(38,s=_)),pt("viz.unknown");const ct=pt("viz.no_set");mt(t,ct,_=>n(39,d=_));const Ct=pt("viz.summary");mt(t,Ct,_=>n(10,f=_));const G=pt("viz.total_items");mt(t,G,_=>n(11,h=_));const V=pt("viz.countries");mt(t,V,_=>n(12,g=_));const F=pt("viz.sub_collections");mt(t,F,_=>n(8,c=_));const K=pt("viz.currently_viewing");mt(t,K,_=>n(13,k=_));const lt=pt("viz.click_back_to_return");mt(t,lt,_=>n(14,b=_));function at(_){return _.toLocaleString(x==="fr"?"fr-FR":"en-US")}function bt(_){const U=at(_);return _t("viz.distribution_items",[U])}function st(){S>0?n(1,L=bt(S)):n(1,L=_t("viz.country_distribution_title")),console.log("Title HTML updated:",L)}Ot.subscribe(_=>{console.log("Language changed to:",_),x=_,st()});function B(_){var yt;const U=_.filter(O=>O.country&&O.country.trim()!==""),Y=qe(U,O=>O.country),J={name:"root",children:Array.from(Y,([O,gt])=>{const ft=Array.from(qe(gt,xt=>xt.item_set_title||d),([xt,q])=>({name:xt,value:q.length,itemCount:q.length}));return{name:O,children:ft,itemCount:gt.length}})};return n(2,S=U.length),n(4,$=Y.size),n(5,P=((yt=J.children)==null?void 0:yt.reduce((O,gt)=>{var ft;return O+(((ft=gt.children)==null?void 0:ft.length)||0)},0))||0),st(),console.log("Data processed, total items:",S),J}function it(_){if(n(6,W=_),W&&(!W.children||W.children.length===0)){console.warn("Cannot zoom to node without children");return}ot()}function ot(){try{if(!y){console.error("Container element not found");return}if(W||(N=B(r.items)),!N.children||N.children.length===0){vt(y).select("svg").remove(),vt(y).append("div").attr("class","no-data").style("position","absolute").style("top","50%").style("left","50%").style("transform","translate(-50%, -50%)").style("text-align","center").style("color","var(--text-color-secondary)").text(u);return}vt(y).select("svg").remove(),vt(y).select(".no-data").remove();const _=y.getBoundingClientRect();C=_.width,w=_.height;const U={top:40,right:10,bottom:10,left:10},Y=C-U.left-U.right,J=w-U.top-U.bottom,O=vt(y).append("svg").attr("width",C).attr("height",w).append("g").attr("transform",`translate(${U.left}, ${U.top})`);if(W){const A=O.append("g").attr("class","zoom-out-button").attr("transform","translate(0, -10)").style("cursor","pointer").on("click",()=>it(null));A.append("rect").attr("width",100).attr("height",24).attr("rx",4).attr("fill","var(--primary-color)").attr("opacity",.8),A.append("text").attr("x",50).attr("y",16).attr("text-anchor","middle").attr("fill","white").attr("font-size","var(--font-size-sm)").text(s)}const gt=Il().size([Y,J]).paddingOuter(4).paddingTop(20).paddingInner(1).round(!0);let ft;if(W){const A={name:W.data.name,children:W.data.children};ft=ne(A).sum(dt=>dt.value||0).sort((dt,kt)=>(kt.value||0)-(dt.value||0))}else ft=ne(N).sum(A=>A.value||0).sort((A,dt)=>(dt.value||0)-(A.value||0));z=ft;try{gt(ft)}catch(A){console.error("Error applying treemap layout:",A),n(6,W=null),N=B(r.items),ft=ne(N).sum(dt=>dt.value||0).sort((dt,kt)=>(kt.value||0)-(dt.value||0)),z=ft,gt(ft)}const xt=Me().domain(ft.children?ft.children.map(A=>A.data.name):[ft.data.name]).range(Tn),q=O.selectAll(".country").data(W?[]:ft.children||[]).enter().append("g").attr("class","country").attr("transform",A=>{const dt=A.x0||0,kt=A.y0||0;return`translate(${dt},${kt})`});q.append("rect").attr("width",A=>{const dt=A.x0||0,kt=A.x1||0;return Math.max(0,kt-dt)}).attr("height",A=>{const dt=A.y0||0,kt=A.y1||0;return Math.max(0,kt-dt)}).attr("fill",A=>xt(A.data.name)).attr("stroke","white").attr("stroke-width",2).style("opacity",.7).style("cursor","pointer").on("click",(A,dt)=>{it(dt)}).on("mouseover",function(A,dt){E(A,dt)}).on("mousemove",function(A,dt){E(A,dt)}).on("mouseout",function(){X()}).attr("title",a).append("title").text(()=>a),q.append("text").attr("x",5).attr("y",15).attr("font-size","var(--font-size-sm)").attr("font-weight","bold").attr("fill","white").text(A=>`${A.data.name} (${A.data.itemCount||0} ${l})`).style("pointer-events","none").each(function(A){const dt=vt(this),kt=this.getComputedTextLength(),te=A.x1-A.x0-10;kt>te&&dt.text(A.data.name).append("title").text(`${A.data.name} (${A.data.itemCount||0} ${l})`)});const ut=O.selectAll(".item-set").data(W?ft.children||[]:ft.leaves()).enter().append("g").attr("class","item-set").attr("transform",A=>{const dt=A.x0||0,kt=A.y0||0;return`translate(${dt},${kt})`});ut.append("rect").attr("width",A=>{const dt=A.x0||0,kt=A.x1||0;return Math.max(0,kt-dt)}).attr("height",A=>{const dt=A.y0||0,kt=A.y1||0;return Math.max(0,kt-dt)}).attr("fill",A=>{var te,Rt;const dt=xt(W?W.data.name:((Rt=(te=A.parent)==null?void 0:te.data)==null?void 0:Rt.name)||"Unknown"),kt=me(dt);return me(kt).brighter(.7).toString()}).attr("stroke","white").attr("stroke-width",.5).style("cursor","pointer").on("mouseover",function(A,dt){vt(this).attr("stroke","var(--primary-color)").attr("stroke-width",2),E(A,dt)}).on("mousemove",function(A,dt){E(A,dt)}).on("mouseout",function(){vt(this).attr("stroke","white").attr("stroke-width",.5),X()}),ut.append("text").attr("x",3).attr("y",13).attr("font-size","var(--font-size-xs)").attr("fill","var(--text-color-primary)").style("pointer-events","none").each(function(A){const dt=vt(this),kt=A.x1-A.x0,te=A.y1-A.y0;if(kt<30||te<20)return;let Rt=A.data.name;const Cn=kt-6,zn=W?W.data.name:A.parent?A.parent.data.name:"";dt.text(Rt).append("title").text(`${zn} > ${A.data.name}: ${A.data.itemCount||A.value||0} ${l}`);const Ge=this;let Qe=Ge.getComputedTextLength(),ui=!1;for(;Qe>Cn&&Rt.length>3;)Rt=Rt.slice(0,-1),dt.text(Rt),Qe=Ge.getComputedTextLength(),ui=!0;ui&&dt.text(Rt+"...")})}catch(_){console.error("Error in updateVisualization:",_)}}function v(){m&&document.body.contains(m)&&document.body.removeChild(m);try{m=document.createElement("div"),m.style.position="absolute",m.style.backgroundColor="rgba(0, 0, 0, 0.8)",m.style.color="white",m.style.padding="8px 12px",m.style.borderRadius="4px",m.style.pointerEvents="none",m.style.display="none",m.style.fontSize="12px",m.style.zIndex="1000",m.style.boxShadow="0 2px 5px rgba(0,0,0,0.2)",m.style.maxWidth="250px",m.style.whiteSpace="nowrap",document&&document.body&&document.body.appendChild(m)}catch(_){console.error("Error creating tooltip:",_)}}function E(_,U){var Y;(!m||!document.body.contains(m))&&v();try{const J=U.parent===z,yt=!J;if(J){const q=U.data.name,ut=U.data.itemCount||U.value||0,A=((Y=U.children)==null?void 0:Y.length)||0,dt=S>0?(ut/S*100).toFixed(1)+"%":"N/A";m.innerHTML=`
                    <div style="font-weight:bold;margin-bottom:4px;border-bottom:1px solid rgba(255,255,255,0.3);padding-bottom:2px;">
                        ${q}
                    </div>
                    <div style="display:grid;grid-template-columns:auto auto;gap:4px;">
                        <span>${l}:</span>
                        <span style="text-align:right;font-weight:bold">${ut}</span>
                        <span>${c}:</span>
                        <span style="text-align:right">${A}</span>
                        <span>${i}:</span>
                        <span style="text-align:right">${dt}</span>
                    </div>
                    <div style="margin-top:4px;font-style:italic;font-size:10px;">
                        ${a}
                    </div>
                `}else{const q=W?W.data.name:U.parent?U.parent.data.name:"",ut=U.data.name,A=U.data.itemCount||U.value||0,dt=S,kt=W?W.data.itemCount:U.parent?U.parent.data.itemCount:0,te=kt&&kt>0?(A/kt*100).toFixed(1)+"%":"N/A",Rt=dt>0?(A/dt*100).toFixed(1)+"%":"N/A";m.innerHTML=`
                    <div style="font-weight:bold;margin-bottom:4px;border-bottom:1px solid rgba(255,255,255,0.3);padding-bottom:2px;">
                        ${q} > ${ut}
                    </div>
                    <div style="display:grid;grid-template-columns:auto auto;gap:4px;">
                        <span>${l}:</span>
                        <span style="text-align:right;font-weight:bold">${A}</span>
                        <span>${o}:</span>
                        <span style="text-align:right">${te}</span>
                        <span>${i}:</span>
                        <span style="text-align:right">${Rt}</span>
                    </div>
                `}const O=250,gt=120;let ft=_.pageX+10,xt=_.pageY+10;ft+O>window.innerWidth&&(ft=_.pageX-O-10),xt+gt>window.innerHeight&&(xt=_.pageY-gt-10),m.style.left=`${ft}px`,m.style.top=`${xt}px`,m.style.display="block"}catch(J){console.error("Error showing tooltip:",J)}}function X(){try{m&&document.body.contains(m)&&(m.style.display="none")}catch(_){console.error("Error hiding tooltip:",_)}}ye(async()=>{try{if(await xe(),!y){console.error("Container element not found in onMount");return}v(),r.items&&r.items.length>0?(N=B(r.items),ot()):Et.loadItems();const _=new ResizeObserver(()=>{y&&ot()});return y?_.observe(y):console.error("Container element not available for ResizeObserver"),()=>{try{_&&_.disconnect(),y&&vt(y).selectAll("*").remove(),m&&document.body.contains(m)&&document.body.removeChild(m)}catch(U){console.error("Error during cleanup:",U)}}}catch(_){console.error("Error in onMount:",_)}});function rt(_){ce[_?"unshift":"push"](()=>{y=_,n(0,y)})}return t.$$.update=()=>{t.$$.dirty[0]&2&&console.log("Title HTML updated:",L),t.$$.dirty[0]&12&&r.items&&r.items.length>0&&!S&&(N=B(r.items)),t.$$.dirty[0]&9&&r.items&&y&&ot()},st(),[y,L,S,r,$,P,W,a,c,u,f,h,g,k,b,D,R,et,I,j,nt,ct,Ct,G,V,F,K,lt,rt]}class vp extends Qt{constructor(e){super(),Gt(this,e,yp,gp,qt,{},null,[-1,-1])}}function fo(t,e,n){const r=t.slice();return r[42]=e[n],r}function ho(t,e,n){const r=t.slice();return r[42]=e[n],r}function po(t,e){let n,r=e[42].label+"",i,o,l=e[13](e[42].count)+"",a,c,s;return{key:t,first:null,c(){n=M("option"),i=H(r),o=H(" ("),a=H(l),c=H(")"),n.__value=s=e[42].value,n.value=n.__value,this.first=n},m(u,d){Q(u,n,d),p(n,i),p(n,o),p(n,a),p(n,c)},p(u,d){e=u,d[0]&32&&r!==(r=e[42].label+"")&&tt(i,r),d[0]&32&&l!==(l=e[13](e[42].count)+"")&&tt(a,l),d[0]&32&&s!==(s=e[42].value)&&(n.__value=s,n.value=n.__value)},d(u){u&&Z(n)}}}function go(t,e){let n,r=e[42].label+"",i,o,l=e[13](e[42].count)+"",a,c,s;return{key:t,first:null,c(){n=M("option"),i=H(r),o=H(" ("),a=H(l),c=H(")"),n.__value=s=e[42].value,n.value=n.__value,this.first=n},m(u,d){Q(u,n,d),p(n,i),p(n,o),p(n,a),p(n,c)},p(u,d){e=u,d[0]&64&&r!==(r=e[42].label+"")&&tt(i,r),d[0]&64&&l!==(l=e[13](e[42].count)+"")&&tt(a,l),d[0]&64&&s!==(s=e[42].value)&&(n.__value=s,n.value=n.__value)},d(u){u&&Z(n)}}}function mo(t){let e,n=_t("viz.showing_items",[t[13](t[7]),t[4].length.toString()])+"",r;return{c(){e=M("span"),r=H(n)},m(i,o){Q(i,e,o),p(e,r)},p(i,o){o[0]&144&&n!==(n=_t("viz.showing_items",[i[13](i[7]),i[4].length.toString()])+"")&&tt(r,n)},d(i){i&&Z(e)}}}function _p(t){let e,n=t[1].error+"",r;return{c(){e=M("div"),r=H(n),T(e,"class","error svelte-1ci7ag1")},m(i,o){Q(i,e,o),p(e,r)},p(i,o){o[0]&2&&n!==(n=i[1].error+"")&&tt(r,n)},d(i){i&&Z(e)}}}function bp(t){let e;return{c(){e=M("div"),e.textContent=`${_t("ui.loading")}`,T(e,"class","loading svelte-1ci7ag1")},m(n,r){Q(n,e,r)},p:Tt,d(n){n&&Z(e)}}}function wp(t){let e,n,r,i,o,l,a,c=[],s=new Map,u,d,f,h,g,k,b,C=[],w=new Map,y,m,N,z,x,L,S,$,P,W,D=_t("viz.total_items")+"",R,et,I,j,nt,ct,Ct=_t("viz.languages")+"",G,V,F,K=t[4].length+"",lt,at,bt,st=t[5];const B=_=>_[42].value;for(let _=0;_<st.length;_+=1){let U=ho(t,st,_),Y=B(U);s.set(Y,c[_]=po(Y,U))}let it=t[6];const ot=_=>_[42].value;for(let _=0;_<it.length;_+=1){let U=fo(t,it,_),Y=ot(U);w.set(Y,C[_]=go(Y,U))}let v=t[4].length>0&&mo(t);function E(_,U){if(_[1].loading)return bp;if(_[1].error)return _p}let X=E(t),rt=X&&X(t);return{c(){e=M("div"),n=M("div"),r=M("label"),i=H(t[9]),o=H(":"),l=ht(),a=M("select");for(let _=0;_<c.length;_+=1)c[_].c();u=ht(),d=M("div"),f=M("label"),h=H(t[10]),g=H(":"),k=ht(),b=M("select");for(let _=0;_<C.length;_+=1)C[_].c();y=ht(),m=M("div"),v&&v.c(),N=ht(),z=M("div"),rt&&rt.c(),x=ht(),L=M("div"),S=M("div"),$=M("h3"),$.textContent=`${_t("viz.summary")}`,P=ht(),W=M("p"),R=H(D),et=H(": "),I=M("strong"),j=H(t[7]),nt=ht(),ct=M("p"),G=H(Ct),V=H(": "),F=M("strong"),lt=H(K),T(r,"for","country-filter"),T(r,"class","svelte-1ci7ag1"),T(a,"id","country-filter"),T(a,"class","svelte-1ci7ag1"),t[2]===void 0&&ke(()=>t[17].call(a)),T(n,"class","filter-group svelte-1ci7ag1"),T(f,"for","type-filter"),T(f,"class","svelte-1ci7ag1"),T(b,"id","type-filter"),T(b,"class","svelte-1ci7ag1"),t[3]===void 0&&ke(()=>t[18].call(b)),T(d,"class","filter-group svelte-1ci7ag1"),T(m,"class","summary svelte-1ci7ag1"),T(e,"class","filters svelte-1ci7ag1"),T(z,"class","pie-container svelte-1ci7ag1"),T($,"class","svelte-1ci7ag1"),T(W,"class","svelte-1ci7ag1"),T(ct,"class","svelte-1ci7ag1"),T(S,"class","stat-summary svelte-1ci7ag1"),T(L,"class","stats svelte-1ci7ag1")},m(_,U){Q(_,e,U),p(e,n),p(n,r),p(r,i),p(r,o),p(n,l),p(n,a);for(let Y=0;Y<c.length;Y+=1)c[Y]&&c[Y].m(a,null);pe(a,t[2],!0),p(e,u),p(e,d),p(d,f),p(f,h),p(f,g),p(d,k),p(d,b);for(let Y=0;Y<C.length;Y+=1)C[Y]&&C[Y].m(b,null);pe(b,t[3],!0),p(e,y),p(e,m),v&&v.m(m,null),Q(_,N,U),Q(_,z,U),rt&&rt.m(z,null),t[19](z),Q(_,x,U),Q(_,L,U),p(L,S),p(S,$),p(S,P),p(S,W),p(W,R),p(W,et),p(W,I),p(I,j),p(S,nt),p(S,ct),p(ct,G),p(ct,V),p(ct,F),p(F,lt),at||(bt=[Lt(a,"change",t[14]),Lt(a,"change",t[17]),Lt(b,"change",t[15]),Lt(b,"change",t[18])],at=!0)},p(_,U){U[0]&512&&tt(i,_[9]),U[0]&8224&&(st=_[5],c=gi(c,U,B,1,_,st,s,a,pi,po,null,ho)),U[0]&36&&pe(a,_[2]),U[0]&1024&&tt(h,_[10]),U[0]&8256&&(it=_[6],C=gi(C,U,ot,1,_,it,w,b,pi,go,null,fo)),U[0]&72&&pe(b,_[3]),_[4].length>0?v?v.p(_,U):(v=mo(_),v.c(),v.m(m,null)):v&&(v.d(1),v=null),X===(X=E(_))&&rt?rt.p(_,U):(rt&&rt.d(1),rt=X&&X(_),rt&&(rt.c(),rt.m(z,null))),U[0]&128&&tt(j,_[7]),U[0]&16&&K!==(K=_[4].length+"")&&tt(lt,K)},d(_){_&&Z(e);for(let U=0;U<c.length;U+=1)c[U].d();for(let U=0;U<C.length;U+=1)C[U].d();v&&v.d(),_&&Z(N),_&&Z(z),rt&&rt.d(),t[19](null),_&&Z(x),_&&Z(L),at=!1,Ht(bt)}}}function xp(t){let e,n,r;return n=new si({props:{title:"",translationKey:"",description:"",descriptionTranslationKey:"viz.language_distribution_description",titleHtml:t[8],$$slots:{default:[wp]},$$scope:{ctx:t}}}),{c(){e=M("div"),Vt(n.$$.fragment),T(e,"class","language-visualization-container svelte-1ci7ag1")},m(i,o){Q(i,e,o),Wt(n,e,null),r=!0},p(i,o){const l={};o[0]&256&&(l.titleHtml=i[8]),o[0]&1791|o[1]&65536&&(l.$$scope={dirty:o,ctx:i}),n.$set(l)},i(i){r||(At(n.$$.fragment,i),r=!0)},o(i){St(n.$$.fragment,i),r=!1},d(i){i&&Z(e),Pt(n)}}}function kp(t,e,n){let r,i,o,l;mt(t,Et,F=>n(1,r=F)),mt(t,Ot,F=>n(16,i=F));let a="all",c="all",s=[],u=[],d=[],f=0,h="en",g="",k=0,b=0,C,w,y;const m=Me(Tn);pt("viz.all_countries"),pt("viz.all_types");const N=pt("viz.filter_by_country");mt(t,N,F=>n(9,o=F));const z=pt("viz.filter_by_type");mt(t,z,F=>n(10,l=F)),pt("viz.no_data"),pt("viz.showing_items"),pt("viz.items"),pt("viz.percent_of_total");function x(F){return F.toLocaleString(h==="fr"?"fr-FR":"en-US")}function L(F){const K=x(F);return _t("viz.language_distribution_items",[K])}function S(){f>0?n(8,g=L(f)):n(8,g=_t("viz.language_distribution_title")),console.log("Language Distribution Title updated:",g)}Ot.subscribe(F=>{console.log("Language changed to:",F),h=F,S(),P(),y&&s.length>0&&I(s),C&&j()});function $(){if(!r.items||r.items.length===0)return;let F=r.items.filter(at=>!(!at.language||a!=="all"&&at.country!==a||c!=="all"&&at.type!==c));n(7,f=F.length),S(),console.log(`Processed ${f} items with language data`);const K=We(F,at=>at.length,at=>at.language||"Unknown");return Array.from(K,([at,bt])=>({language:at,count:bt,percentage:bt/f*100})).sort((at,bt)=>bt.count-at.count)}function P(){if(!r.items||r.items.length===0)return;const F=r.items.filter(st=>st.language),K=We(F,st=>st.length,st=>st.country||"Unknown"),lt=_t("viz.all_countries"),at=_t("viz.all_types");n(5,u=[{value:"all",label:lt,count:F.length},...Array.from(K,([st,B])=>{if(st==="Unknown")return null;const it=_t(`country.${st}`)||st;return{value:st,label:it,count:B}}).filter(st=>st!==null).sort((st,B)=>B.count-st.count)]);const bt=We(F,st=>st.length,st=>st.type||"Unknown");n(6,d=[{value:"all",label:at,count:F.length},...Array.from(bt,([st,B])=>({value:st,label:st,count:B})).sort((st,B)=>B.count-st.count)])}function W(){w=document.createElement("div"),w.style.position="absolute",w.style.backgroundColor="rgba(0, 0, 0, 0.8)",w.style.color="white",w.style.padding="8px 12px",w.style.borderRadius="4px",w.style.pointerEvents="none",w.style.display="none",w.style.fontSize="12px",w.style.zIndex="1000",w.style.boxShadow="0 2px 5px rgba(0,0,0,0.2)",document&&document.body&&document.body.appendChild(w)}function D(F,K){if(!w)return;const lt=K.data,at=_t(`lang.${lt.language}`)||lt.language;w.innerHTML=`
            <div style="font-weight:bold;margin-bottom:4px;border-bottom:1px solid rgba(255,255,255,0.3);padding-bottom:2px;">
                ${at}
            </div>
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:4px;">
                <span>${_t("viz.items")}:</span><span style="text-align:right;font-weight:bold;">${x(lt.count)}</span>
                <span>${_t("viz.percent_of_total")}:</span><span style="text-align:right;font-weight:bold;">${lt.percentage.toFixed(2)}%</span>
            </div>
        `;const bt=200,st=100;let B=F.pageX+10,it=F.pageY+10;B+bt>window.innerWidth&&(B=F.pageX-bt-10),it+st>window.innerHeight&&(it=F.pageY-st-10),w.style.left=`${B}px`,w.style.top=`${it}px`,w.style.display="block"}function R(){w&&(w.style.display="none")}function et(){y?y.innerHTML="":(y=document.createElement("div"),y.style.position="absolute",y.style.right="20px",y.style.top="20px",y.style.backgroundColor="rgba(255, 255, 255, 0.9)",y.style.padding="10px",y.style.borderRadius="4px",y.style.boxShadow="0 2px 4px rgba(0,0,0,0.1)",y.style.maxHeight="300px",y.style.overflowY="auto",y.style.color="var(--text-color-primary)",y.style.fontFamily="var(--font-family-primary)",y.style.fontSize="var(--font-size-sm)",C.appendChild(y))}function I(F){y&&(y.innerHTML=`
            <div style="font-weight:bold;margin-bottom:8px;font-size:14px;color:var(--text-color-primary);">${_t("viz.languages")} (${F.length})</div>
            <div style="display:grid;grid-template-columns:20px auto 40px;gap:4px;font-size:12px;">
                ${F.map((K,lt)=>{const at=_t(`lang.${K.language}`)||K.language;return`
                        <div style="width:12px;height:12px;background-color:${m(K.language)};border-radius:2px;margin-top:2px;"></div>
                        <div style="white-space:nowrap;overflow:hidden;text-overflow:ellipsis;color:var(--text-color-primary);">${at}</div>
                        <div style="text-align:right;color:var(--text-color-secondary);">${x(K.count)}</div>
                    `}).join("")}
            </div>
        `)}function j(){if(!C)return;const F=$();if(n(4,s=F||[]),!F||F.length===0){vt(C).select("svg").remove();return}vt(C).select("svg").remove();const K=C.getBoundingClientRect();k=K.width,b=K.height;const lt={top:20,right:20,bottom:20,left:20},at=k-lt.left-lt.right,bt=b-lt.top-lt.bottom,st=Math.min(at,bt)/2,B=vt(C).append("svg").attr("width",k).attr("height",b).append("g").attr("transform",`translate(${k/2}, ${b/2})`),it=Vh().value(E=>E.count).sort(null),ot=Ji().innerRadius(0).outerRadius(st),v=Ji().innerRadius(0).outerRadius(st+10);B.selectAll("path").data(it(F)).enter().append("path").attr("d",ot).attr("fill",E=>m(E.data.language)).attr("stroke","white").attr("stroke-width",2).on("mouseenter",function(E,X){vt(this).transition().duration(200).attr("d",rt=>v(rt)),D(E,X)}).on("mousemove",function(E,X){D(E,X)}).on("mouseleave",function(E,X){vt(this).transition().duration(200).attr("d",rt=>ot(rt)),R()}),et(),I(F)}function nt(F){const K=F.target;n(2,a=K.value),j()}function ct(F){const K=F.target;n(3,c=K.value),j()}ye(async()=>{if(await xe(),!C){console.error("Container element not found");return}W(),r.items&&r.items.length>0?(P(),j()):Et.loadItems();const F=new ResizeObserver(()=>{C&&j()});return F.observe(C),()=>{F.disconnect(),w&&document.body.contains(w)&&document.body.removeChild(w),y&&y.parentNode&&y.parentNode.removeChild(y)}});function Ct(){a=fi(this),n(2,a),n(5,u)}function G(){c=fi(this),n(3,c),n(6,d)}function V(F){ce[F?"unshift":"push"](()=>{C=F,n(0,C)})}return t.$$.update=()=>{t.$$.dirty[0]&3&&r.items&&C&&(P(),j()),t.$$.dirty[0]&65538&&i&&r.items&&r.items.length>0&&P()},S(),[C,r,a,c,s,u,d,f,g,o,l,N,z,x,nt,ct,i,Ct,G,V]}class Tp extends Qt{constructor(e){super(),Gt(this,e,kp,xp,qt,{},null,[-1,-1])}}function yo(t,e,n){const r=t.slice();return r[15]=e[n],r}function Cp(t){let e,n=t[1].error+"",r;return{c(){e=M("div"),r=H(n),T(e,"class","error svelte-18pj101")},m(i,o){Q(i,e,o),p(e,r)},p(i,o){o&2&&n!==(n=i[1].error+"")&&tt(r,n)},d(i){i&&Z(e)}}}function zp(t){let e;return{c(){e=M("div"),e.textContent="Loading...",T(e,"class","loading svelte-18pj101")},m(n,r){Q(n,e,r)},p:Tt,d(n){n&&Z(e)}}}function vo(t){let e,n,r,i,o,l,a,c,s,u,d,f=t[2].length+"",h,g,k,b,C,w,y=t[2].slice(0,5),m=[];for(let N=0;N<y.length;N+=1)m[N]=_o(yo(t,y,N));return{c(){e=M("div"),n=M("h3"),n.textContent="Summary",r=ht(),i=M("p"),o=H("Total index items: "),l=M("strong"),a=H(t[3]),c=ht(),s=M("p"),u=H("Number of categories: "),d=M("strong"),h=H(f),g=ht(),k=M("div"),b=M("h3"),b.textContent="Top Categories",C=ht(),w=M("ul");for(let N=0;N<m.length;N+=1)m[N].c();T(n,"class","svelte-18pj101"),T(e,"class","stat-summary svelte-18pj101"),T(b,"class","svelte-18pj101"),T(w,"class","svelte-18pj101"),T(k,"class","top-categories svelte-18pj101")},m(N,z){Q(N,e,z),p(e,n),p(e,r),p(e,i),p(i,o),p(i,l),p(l,a),p(e,c),p(e,s),p(s,u),p(s,d),p(d,h),Q(N,g,z),Q(N,k,z),p(k,b),p(k,C),p(k,w);for(let x=0;x<m.length;x+=1)m[x]&&m[x].m(w,null)},p(N,z){if(z&8&&tt(a,N[3]),z&4&&f!==(f=N[2].length+"")&&tt(h,f),z&4){y=N[2].slice(0,5);let x;for(x=0;x<y.length;x+=1){const L=yo(N,y,x);m[x]?m[x].p(L,z):(m[x]=_o(L),m[x].c(),m[x].m(w,null))}for(;x<m.length;x+=1)m[x].d(1);m.length=y.length}},d(N){N&&Z(e),N&&Z(g),N&&Z(k),Be(m,N)}}}function _o(t){let e,n,r=t[15].category+"",i,o,l,a=t[15].count+"",c,s,u=t[15].percentage.toFixed(1)+"",d,f,h;return{c(){e=M("li"),n=M("span"),i=H(r),o=ht(),l=M("span"),c=H(a),s=H(" items ("),d=H(u),f=H("%)"),h=ht(),T(n,"class","category-name svelte-18pj101"),T(l,"class","category-count svelte-18pj101"),T(e,"class","svelte-18pj101")},m(g,k){Q(g,e,k),p(e,n),p(n,i),p(e,o),p(e,l),p(l,c),p(l,s),p(l,d),p(l,f),p(e,h)},p(g,k){k&4&&r!==(r=g[15].category+"")&&tt(i,r),k&4&&a!==(a=g[15].count+"")&&tt(c,a),k&4&&u!==(u=g[15].percentage.toFixed(1)+"")&&tt(d,u)},d(g){g&&Z(e)}}}function Mp(t){let e,n,r,i;function o(s,u){if(s[1].loading)return zp;if(s[1].error)return Cp}let l=o(t),a=l&&l(t),c=t[2].length>0&&vo(t);return{c(){e=M("div"),n=M("div"),a&&a.c(),r=ht(),i=M("div"),c&&c.c(),T(n,"class","chart-container svelte-18pj101"),T(i,"class","stats svelte-18pj101"),T(e,"class","index-visualization-container svelte-18pj101")},m(s,u){Q(s,e,u),p(e,n),a&&a.m(n,null),t[4](n),p(e,r),p(e,i),c&&c.m(i,null)},p(s,[u]){l===(l=o(s))&&a?a.p(s,u):(a&&a.d(1),a=l&&l(s),a&&(a.c(),a.m(n,null))),s[2].length>0?c?c.p(s,u):(c=vo(s),c.c(),c.m(i,null)):c&&(c.d(1),c=null)},i:Tt,o:Tt,d(s){s&&Z(e),a&&a.d(),t[4](null),c&&c.d()}}}function Ap(t,e,n){let r;mt(t,Et,w=>n(1,r=w));let i=[],o=0,l=0,a=0,c=0,s,u;const d=Me(Tn);function f(){if(!r.items||r.items.length===0)return[];const w=r.items.filter(z=>z.type==="Notice d'autorité");if(n(3,o=w.length),o===0)return[];const y=We(w,z=>z.length,z=>z.item_set_title||"Uncategorized"),N=Array.from(y,([z,x])=>({category:z,count:x,percentage:x/o*100})).sort((z,x)=>x.count-z.count);return l=Ie(N,z=>z.count)||0,N}function h(){try{u&&document.body.contains(u)&&document.body.removeChild(u),u=document.createElement("div"),u.style.position="absolute",u.style.backgroundColor="rgba(0, 0, 0, 0.8)",u.style.color="white",u.style.padding="8px 12px",u.style.borderRadius="4px",u.style.pointerEvents="none",u.style.display="none",u.style.fontSize="12px",u.style.zIndex="1000",u.style.boxShadow="0 2px 5px rgba(0,0,0,0.2)",document&&document.body&&document.body.appendChild(u)}catch(w){console.error("Error creating tooltip:",w)}}function g(w,y){try{if((!u||!document.body.contains(u))&&h(),!u)return;u.innerHTML=`
                <div style="font-weight:bold;margin-bottom:4px;border-bottom:1px solid rgba(255,255,255,0.3);padding-bottom:2px;">
                    ${y.category}
                </div>
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:4px;">
                    <span>Count:</span><span style="text-align:right;font-weight:bold;">${y.count}</span>
                    <span>Percentage:</span><span style="text-align:right;font-weight:bold;">${y.percentage.toFixed(2)}%</span>
                </div>
            `;const m=200,N=100;let z=w.pageX+10,x=w.pageY+10;z+m>window.innerWidth&&(z=w.pageX-m-10),x+N>window.innerHeight&&(x=w.pageY-N-10),u.style.left=`${z}px`,u.style.top=`${x}px`,u.style.display="block"}catch(m){console.error("Error showing tooltip:",m)}}function k(){try{u&&document.body.contains(u)&&(u.style.display="none")}catch(w){console.error("Error hiding tooltip:",w)}}function b(){try{if(!s)return;const w=f();if(!w||w.length===0){vt(s).select("svg").remove(),vt(s).append("div").attr("class","no-data").style("position","absolute").style("top","50%").style("left","50%").style("transform","translate(-50%, -50%)").style("text-align","center").style("color","var(--text-color-secondary)").text("No index items available");return}n(2,i=w),vt(s).select("svg").remove(),vt(s).select(".no-data").remove();const y=s.getBoundingClientRect();a=y.width,c=y.height-40;const m={top:60,right:30,bottom:120,left:60},N=a-m.left-m.right,z=c-m.top-m.bottom,x=vt(s).append("svg").attr("width",a).attr("height",c).attr("viewBox",`0 0 ${a} ${c}`),L=x.append("g").attr("transform",`translate(${m.left}, ${m.top})`),S=ni().domain(w.map(D=>D.category)).range([0,N]).padding(.2),$=yn().domain([0,l*1.1]).range([z,0]),P=Wn(S);L.append("g").attr("class","x-axis").attr("transform",`translate(0, ${z})`).call(P).selectAll("text").attr("transform","rotate(-45)").style("text-anchor","end").attr("dx","-.8em").attr("dy",".15em").style("font-size","var(--font-size-xs)").style("fill","var(--text-color-primary)");const W=Pn($).ticks(5);L.append("g").attr("class","y-axis").call(W).selectAll("text").style("font-size","var(--font-size-xs)").style("fill","var(--text-color-primary)"),L.append("text").attr("class","x-axis-label").attr("text-anchor","middle").attr("x",N/2).attr("y",z+m.bottom-10).style("font-size","var(--font-size-sm)").style("fill","var(--text-color-secondary)").text("Categories"),L.append("text").attr("class","y-axis-label").attr("text-anchor","middle").attr("transform","rotate(-90)").attr("x",-z/2).attr("y",-m.left+15).style("font-size","var(--font-size-sm)").style("fill","var(--text-color-secondary)").text("Number of Items"),L.selectAll(".bar").data(w).enter().append("rect").attr("class","bar").attr("x",D=>S(D.category)||0).attr("y",D=>$(D.count)).attr("width",S.bandwidth()).attr("height",D=>z-$(D.count)).attr("fill",(D,R)=>d(D.category)).attr("rx",3).attr("ry",3).style("stroke","white").style("stroke-width",1).on("mouseenter",function(D,R){vt(this).transition().duration(200).attr("fill",me(d(R.category)).brighter(.5).toString()),g(D,R)}).on("mousemove",function(D,R){g(D,R)}).on("mouseleave",function(D,R){vt(this).transition().duration(200).attr("fill",d(R.category)),k()}),L.selectAll(".bar-label").data(w).enter().append("text").attr("class","bar-label").attr("x",D=>(S(D.category)||0)+S.bandwidth()/2).attr("y",D=>$(D.count)-5).attr("text-anchor","middle").style("font-size","var(--font-size-xs)").style("fill","var(--text-color-secondary)").text(D=>D.count),x.append("text").attr("text-anchor","middle").attr("x",a/2).attr("y",30).attr("font-size","var(--font-size-lg)").attr("font-weight","bold").attr("fill","var(--text-color-primary)").text(`Index Distribution by Category (${o} items)`)}catch(w){console.error("Error creating bar chart:",w)}}ye(async()=>{try{if(await xe(),!s){console.error("Container element not found");return}h(),r.items&&r.items.length>0?b():Et.loadItems();const w=new ResizeObserver(()=>{s&&b()});return w.observe(s),()=>{try{w&&w.disconnect(),s&&vt(s).selectAll("*").remove(),u&&document.body.contains(u)&&document.body.removeChild(u)}catch(y){console.error("Error during cleanup:",y)}}}catch(w){console.error("Error in onMount:",w)}});function C(w){ce[w?"unshift":"push"](()=>{s=w,n(0,s)})}return t.$$.update=()=>{t.$$.dirty&3&&r.items&&s&&b()},[s,r,i,o,C]}class Sp extends Qt{constructor(e){super(),Gt(this,e,Ap,Mp,qt,{})}}function bo(t,e,n){const r=t.slice();return r[52]=e[n],r}function wo(t,e,n){const r=t.slice();return r[55]=e[n],r}function xo(t,e,n){const r=t.slice();return r[55]=e[n],r}function ko(t){let e,n=t[55].label+"",r,i,o=t[27](t[55].count)+"",l,a,c;return{c(){e=M("option"),r=H(n),i=H(" ("),l=H(o),a=H(")"),e.__value=c=t[55].value,e.value=e.__value},m(s,u){Q(s,e,u),p(e,r),p(e,i),p(e,l),p(e,a)},p(s,u){u[0]&32&&n!==(n=s[55].label+"")&&tt(r,n),u[0]&32&&o!==(o=s[27](s[55].count)+"")&&tt(l,o),u[0]&32&&c!==(c=s[55].value)&&(e.__value=c,e.value=e.__value)},d(s){s&&Z(e)}}}function To(t){let e,n=t[55].label+"",r,i,o=t[27](t[55].count)+"",l,a,c;return{c(){e=M("option"),r=H(n),i=H(" ("),l=H(o),a=H(")"),e.__value=c=t[55].value,e.value=e.__value},m(s,u){Q(s,e,u),p(e,r),p(e,i),p(e,l),p(e,a)},p(s,u){u[0]&64&&n!==(n=s[55].label+"")&&tt(r,n),u[0]&64&&o!==(o=s[27](s[55].count)+"")&&tt(l,o),u[0]&64&&c!==(c=s[55].value)&&(e.__value=c,e.value=e.__value)},d(s){s&&Z(e)}}}function Co(t){let e,n=t[11].replace("{0}",t[27](t[7])).replace("{1}",t[4].length.toString())+"",r;return{c(){e=M("span"),r=H(n)},m(i,o){Q(i,e,o),p(e,r)},p(i,o){o[0]&2192&&n!==(n=i[11].replace("{0}",i[27](i[7])).replace("{1}",i[4].length.toString())+"")&&tt(r,n)},d(i){i&&Z(e)}}}function $p(t){let e,n=t[3].error+"",r;return{c(){e=M("div"),r=H(n),T(e,"class","error svelte-1ftjyys")},m(i,o){Q(i,e,o),p(e,r)},p(i,o){o[0]&8&&n!==(n=i[3].error+"")&&tt(r,n)},d(i){i&&Z(e)}}}function Dp(t){let e;return{c(){e=M("div"),e.textContent=`${_t("ui.loading")}`,T(e,"class","loading svelte-1ftjyys")},m(n,r){Q(n,e,r)},p:Tt,d(n){n&&Z(e)}}}function zo(t){var Ct,G;let e,n,r,i,o,l,a,c,s=t[27](t[7])+"",u,d,f,h,g,k,b=(((Ct=t[4][0])==null?void 0:Ct.monthFormatted)||"")+"",C,w,y=(((G=t[4][t[4].length-1])==null?void 0:G.monthFormatted)||"")+"",m,N,z,x,L,S,$=t[27](Math.round(t[7]/(t[4].length||1)))+"",P,W,D,R,et,I,j,nt=[...t[4]].sort(Ao).slice(0,3),ct=[];for(let V=0;V<nt.length;V+=1)ct[V]=Mo(bo(t,nt,V));return{c(){e=M("div"),n=M("h3"),r=H(t[12]),i=ht(),o=M("p"),l=H(t[13]),a=H(": "),c=M("strong"),u=H(s),d=ht(),f=M("p"),h=H(t[14]),g=H(": "),k=M("strong"),C=H(b),w=H(" to "),m=H(y),N=ht(),z=M("p"),x=H(t[15]),L=H(": "),S=M("strong"),P=H($),W=ht(),D=M("div"),R=M("h3"),et=H(t[16]),I=ht(),j=M("ul");for(let V=0;V<ct.length;V+=1)ct[V].c();T(n,"class","svelte-1ftjyys"),T(e,"class","stat-summary svelte-1ftjyys"),T(R,"class","svelte-1ftjyys"),T(j,"class","svelte-1ftjyys"),T(D,"class","peak-months svelte-1ftjyys")},m(V,F){Q(V,e,F),p(e,n),p(n,r),p(e,i),p(e,o),p(o,l),p(o,a),p(o,c),p(c,u),p(e,d),p(e,f),p(f,h),p(f,g),p(f,k),p(k,C),p(k,w),p(k,m),p(e,N),p(e,z),p(z,x),p(z,L),p(z,S),p(S,P),Q(V,W,F),Q(V,D,F),p(D,R),p(R,et),p(D,I),p(D,j);for(let K=0;K<ct.length;K+=1)ct[K]&&ct[K].m(j,null)},p(V,F){var K,lt;if(F[0]&4096&&tt(r,V[12]),F[0]&8192&&tt(l,V[13]),F[0]&128&&s!==(s=V[27](V[7])+"")&&tt(u,s),F[0]&16384&&tt(h,V[14]),F[0]&16&&b!==(b=(((K=V[4][0])==null?void 0:K.monthFormatted)||"")+"")&&tt(C,b),F[0]&16&&y!==(y=(((lt=V[4][V[4].length-1])==null?void 0:lt.monthFormatted)||"")+"")&&tt(m,y),F[0]&32768&&tt(x,V[15]),F[0]&144&&$!==($=V[27](Math.round(V[7]/(V[4].length||1)))+"")&&tt(P,$),F[0]&65536&&tt(et,V[16]),F[0]&134348944){nt=[...V[4]].sort(Ao).slice(0,3);let at;for(at=0;at<nt.length;at+=1){const bt=bo(V,nt,at);ct[at]?ct[at].p(bt,F):(ct[at]=Mo(bt),ct[at].c(),ct[at].m(j,null))}for(;at<ct.length;at+=1)ct[at].d(1);ct.length=nt.length}},d(V){V&&Z(e),V&&Z(W),V&&Z(D),Be(ct,V)}}}function Mo(t){let e,n,r=t[52].monthFormatted+"",i,o,l,a=t[27](t[52].count)+"",c,s,u,d,f=(t[52].count/(t[7]||1)*100).toFixed(1)+"",h,g,k;return{c(){e=M("li"),n=M("span"),i=H(r),o=ht(),l=M("span"),c=H(a),s=ht(),u=H(t[17]),d=H(" ("),h=H(f),g=H("%)"),k=ht(),T(n,"class","month-name svelte-1ftjyys"),T(l,"class","month-count svelte-1ftjyys"),T(e,"class","svelte-1ftjyys")},m(b,C){Q(b,e,C),p(e,n),p(n,i),p(e,o),p(e,l),p(l,c),p(l,s),p(l,u),p(l,d),p(l,h),p(l,g),p(e,k)},p(b,C){C[0]&16&&r!==(r=b[52].monthFormatted+"")&&tt(i,r),C[0]&16&&a!==(a=b[27](b[52].count)+"")&&tt(c,a),C[0]&131072&&tt(u,b[17]),C[0]&144&&f!==(f=(b[52].count/(b[7]||1)*100).toFixed(1)+"")&&tt(h,f)},d(b){b&&Z(e)}}}function Np(t){let e,n,r,i,o,l,a,c,s,u,d,f,h,g,k,b,C,w,y,m,N,z,x=t[5],L=[];for(let I=0;I<x.length;I+=1)L[I]=ko(xo(t,x,I));let S=t[6],$=[];for(let I=0;I<S.length;I+=1)$[I]=To(wo(t,S,I));let P=t[4].length>0&&Co(t);function W(I,j){if(I[3].loading)return Dp;if(I[3].error)return $p}let D=W(t),R=D&&D(t),et=t[4].length>0&&zo(t);return{c(){e=M("div"),n=M("div"),r=M("label"),i=H(t[9]),o=H(":"),l=ht(),a=M("select");for(let I=0;I<L.length;I+=1)L[I].c();c=ht(),s=M("div"),u=M("label"),d=H(t[10]),f=H(":"),h=ht(),g=M("select");for(let I=0;I<$.length;I+=1)$[I].c();k=ht(),b=M("div"),P&&P.c(),C=ht(),w=M("div"),R&&R.c(),y=ht(),m=M("div"),et&&et.c(),T(r,"for","country-filter"),T(r,"class","svelte-1ftjyys"),T(a,"id","country-filter"),T(a,"class","svelte-1ftjyys"),T(n,"class","filter-group svelte-1ftjyys"),T(u,"for","type-filter"),T(u,"class","svelte-1ftjyys"),T(g,"id","type-filter"),T(g,"class","svelte-1ftjyys"),T(s,"class","filter-group svelte-1ftjyys"),T(b,"class","summary svelte-1ftjyys"),T(e,"class","filters svelte-1ftjyys"),T(w,"class","chart-container svelte-1ftjyys"),T(m,"class","stats svelte-1ftjyys")},m(I,j){Q(I,e,j),p(e,n),p(n,r),p(r,i),p(r,o),p(n,l),p(n,a);for(let nt=0;nt<L.length;nt+=1)L[nt]&&L[nt].m(a,null);pe(a,t[0]),p(e,c),p(e,s),p(s,u),p(u,d),p(u,f),p(s,h),p(s,g);for(let nt=0;nt<$.length;nt+=1)$[nt]&&$[nt].m(g,null);pe(g,t[1]),p(e,k),p(e,b),P&&P.m(b,null),Q(I,C,j),Q(I,w,j),R&&R.m(w,null),t[31](w),Q(I,y,j),Q(I,m,j),et&&et.m(m,null),N||(z=[Lt(a,"change",t[28]),Lt(g,"change",t[29])],N=!0)},p(I,j){if(j[0]&512&&tt(i,I[9]),j[0]&134217760){x=I[5];let nt;for(nt=0;nt<x.length;nt+=1){const ct=xo(I,x,nt);L[nt]?L[nt].p(ct,j):(L[nt]=ko(ct),L[nt].c(),L[nt].m(a,null))}for(;nt<L.length;nt+=1)L[nt].d(1);L.length=x.length}if(j[0]&33&&pe(a,I[0]),j[0]&1024&&tt(d,I[10]),j[0]&134217792){S=I[6];let nt;for(nt=0;nt<S.length;nt+=1){const ct=wo(I,S,nt);$[nt]?$[nt].p(ct,j):($[nt]=To(ct),$[nt].c(),$[nt].m(g,null))}for(;nt<$.length;nt+=1)$[nt].d(1);$.length=S.length}j[0]&66&&pe(g,I[1]),I[4].length>0?P?P.p(I,j):(P=Co(I),P.c(),P.m(b,null)):P&&(P.d(1),P=null),D===(D=W(I))&&R?R.p(I,j):(R&&R.d(1),R=D&&D(I),R&&(R.c(),R.m(w,null))),I[4].length>0?et?et.p(I,j):(et=zo(I),et.c(),et.m(m,null)):et&&(et.d(1),et=null)},d(I){I&&Z(e),Be(L,I),Be($,I),P&&P.d(),I&&Z(C),I&&Z(w),R&&R.d(),t[31](null),I&&Z(y),I&&Z(m),et&&et.d(),N=!1,Ht(z)}}}function Ep(t){let e,n,r;return n=new si({props:{title:"Timeline Distribution",titleHtml:t[8],descriptionTranslationKey:Ip,$$slots:{default:[Np]},$$scope:{ctx:t}}}),{c(){e=M("div"),Vt(n.$$.fragment),T(e,"class","timeline-visualization-container svelte-1ftjyys")},m(i,o){Q(i,e,o),Wt(n,e,null),r=!0},p(i,o){const l={};o[0]&256&&(l.titleHtml=i[8]),o[0]&261887|o[1]&536870912&&(l.$$scope={dirty:o,ctx:i}),n.$set(l)},i(i){r||(At(n.$$.fragment,i),r=!0)},o(i){St(n.$$.fragment,i),r=!1},d(i){i&&Z(e),Pt(n)}}}const Ip="viz.timeline_distribution_description",Ao=(t,e)=>e.count-t.count;function Lp(t,e,n){let r,i,o,l,a,c,s,u,d,f,h;mt(t,Et,E=>n(3,r=E)),mt(t,Ot,E=>n(30,i=E));let g="all",k="all",b=[],C=[],w=[],y=0,m="en",N="",z=0,x=0,L,S;const $=Fe("%Y-%m"),P=Fe("%b %Y"),W=pt("viz.filter_by_country");mt(t,W,E=>n(9,o=E));const D=pt("viz.filter_by_type");mt(t,D,E=>n(10,l=E)),pt("viz.no_data");const R=pt("viz.summary");mt(t,R,E=>n(12,c=E));const et=pt("viz.total_items");mt(t,et,E=>n(13,s=E));const I=pt("viz.time_period");mt(t,I,E=>n(14,u=E));const j=pt("viz.avg_monthly_additions");mt(t,j,E=>n(15,d=E));const nt=pt("viz.peak_growth_months");mt(t,nt,E=>n(16,f=E));const ct=pt("viz.showing_items_over_months");mt(t,ct,E=>n(11,a=E));const Ct=pt("viz.items");mt(t,Ct,E=>n(17,h=E)),pt("viz.timeline_distribution_items"),pt("viz.monthly_additions"),pt("viz.month");function G(E){return E.toLocaleString(m==="fr"?"fr-FR":"en-US")}function V(){if(y>0){const E=G(y);return _t("viz.timeline_distribution_items",[E])}else return _t("viz.timeline_distribution_title")}function F(){console.log("[TimelineDistribution] Updating title with count:",y),n(8,N=V())}Ot.subscribe(E=>{console.log("[TimelineDistribution] Language changed to:",E),m=E,lt(),L&&B()});function K(){if(!r.items||r.items.length===0)return[];const E=new Date(2024,3,1);let X=0;const rt=O=>!(!O.created_date||g!=="all"&&O.country!==g||k!=="all"&&O.type!==k);X=r.items.filter(O=>rt(O)?new Date(O.created_date)<E:!1).length;let U=r.items.filter(O=>rt(O)?new Date(O.created_date)>=E:!1);if(n(7,y=X+U.length),U.length===0)return[];const Y=new Map;U.forEach(O=>{const gt=new Date(O.created_date),ft=$(gt);Y.set(ft,(Y.get(ft)||0)+1)});const J=Array.from(Y.entries()).map(([O,gt])=>{const[ft,xt]=O.split("-").map(Number),q=new Date(ft,xt-1,1);return{date:q,month:O,monthFormatted:P(q),count:gt,total:0,percentage:0}}).sort((O,gt)=>O.date.getTime()-gt.date.getTime());let yt=X;return J.forEach(O=>{yt+=O.count,O.total=yt,O.percentage=O.count/U.length*100}),Ie(J,O=>O.count),Ie(J,O=>O.total),J}function lt(){if(!r.items||r.items.length===0)return;const E=new Date(2024,3,1),X=r.items.filter(U=>U.created_date?new Date(U.created_date)>=E:!1),rt=We(X,U=>U.length,U=>U.country||"Unknown");n(5,C=[{value:"all",label:_t("country.all"),count:X.length},...Array.from(rt,([U,Y])=>({value:U,label:_t(`country.${U}`),count:Y})).filter(U=>U.value!=="Unknown").sort((U,Y)=>Y.count-U.count)]);const _=We(X,U=>U.length,U=>U.type||"Unknown");n(6,w=[{value:"all",label:_t("type.all"),count:X.length},...Array.from(_,([U,Y])=>({value:U,label:_t(`type.${U}`),count:Y})).filter(U=>U.value!=="Unknown").sort((U,Y)=>Y.count-U.count)])}function at(){try{S&&document.body.contains(S)&&document.body.removeChild(S),S=document.createElement("div"),S.style.position="absolute",S.style.backgroundColor="rgba(0, 0, 0, 0.8)",S.style.color="white",S.style.padding="8px 12px",S.style.borderRadius="4px",S.style.pointerEvents="none",S.style.display="none",S.style.fontSize="12px",S.style.zIndex="1000",S.style.boxShadow="0 2px 5px rgba(0,0,0,0.2)",document&&document.body&&document.body.appendChild(S)}catch(E){console.error("Error creating tooltip:",E)}}function bt(E,X,rt){try{if((!S||!document.body.contains(S))&&at(),!S)return;const _=X.date.toLocaleString("default",{month:"long"}),U=X.date.getFullYear();rt==="monthly"?S.innerHTML=`
                    <div style="font-weight:bold;margin-bottom:4px;border-bottom:1px solid rgba(255,255,255,0.3);padding-bottom:2px;">
                        ${_} ${U}
                    </div>
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:4px;">
                        <span>New Items:</span><span style="text-align:right;font-weight:bold;">${X.count}</span>
                        <span>Percentage:</span><span style="text-align:right;font-weight:bold;">${X.percentage.toFixed(2)}%</span>
                    </div>
                `:S.innerHTML=`
                    <div style="font-weight:bold;margin-bottom:4px;border-bottom:1px solid rgba(255,255,255,0.3);padding-bottom:2px;">
                        ${_} ${U}
                    </div>
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:4px;">
                        <span>Total Items:</span><span style="text-align:right;font-weight:bold;">${X.total}</span>
                    </div>
                `;const Y=200,J=100;let yt=E.pageX+10,O=E.pageY+10;yt+Y>window.innerWidth&&(yt=E.pageX-Y-10),O+J>window.innerHeight&&(O=E.pageY-J-10),S.style.left=`${yt}px`,S.style.top=`${O}px`,S.style.display="block"}catch(_){console.error("Error showing tooltip:",_)}}function st(){try{S&&document.body.contains(S)&&(S.style.display="none")}catch(E){console.error("Error hiding tooltip:",E)}}function B(){if(!L){console.error("[TimelineDistribution] Container element not found in createTimeline");return}const E=K();if(!E||E.length===0){vt(L).select("svg").remove(),vt(L).append("div").attr("class","no-data").style("position","absolute").style("top","50%").style("left","50%").style("transform","translate(-50%, -50%)").style("text-align","center").style("color","var(--text-color-secondary)").text("No timeline data available with the current filters");return}n(4,b=E),vt(L).select("svg").remove(),vt(L).select(".no-data").remove();const X=L.getBoundingClientRect();z=X.width,x=X.height-50;const rt=vt(L).append("svg").attr("width",z).attr("height",x).attr("viewBox",`0 0 ${z} ${x}`),_={top:30,right:60,bottom:50,left:70},U=z-_.left-_.right,Y=(x-_.top-_.bottom-50)/2,J=Dh().domain(La(E,A=>A.date)).range([0,U]);rt.append("line").attr("x1",_.left).attr("y1",_.top+Y+25).attr("x2",z-_.right).attr("y2",_.top+Y+25).attr("stroke","var(--divider-color)").attr("stroke-width",1).attr("stroke-dasharray","3,3");const yt=rt.append("g").attr("transform",`translate(${z-_.right}, ${_.top-10})`);yt.append("line").attr("x1",-100).attr("y1",0).attr("x2",-80).attr("y2",0).attr("stroke","var(--primary-color)").attr("stroke-width",2).attr("marker-end","url(#circle)"),yt.append("text").attr("x",-75).attr("y",4).attr("fill","var(--text-color-primary)").attr("font-size","var(--font-size-sm)").text(_t("viz.monthly_additions")),yt.append("line").attr("x1",-100).attr("y1",20).attr("x2",-80).attr("y2",20).attr("stroke","var(--secondary-color)").attr("stroke-width",2).attr("stroke-dasharray","4 2"),yt.append("text").attr("x",-75).attr("y",24).attr("fill","var(--text-color-primary)").attr("font-size","var(--font-size-sm)").text(_t("viz.total_items")),rt.append("defs").append("marker").attr("id","circle").attr("viewBox","-5 -5 10 10").attr("refX",0).attr("refY",0).attr("markerWidth",5).attr("markerHeight",5).append("circle").attr("r",3).attr("fill","var(--primary-color)");const O=rt.append("g").attr("transform",`translate(${_.left}, ${_.top})`),gt=yn().domain([0,(Ie(E,A=>A.count)||0)*1.1]).range([Y,0]);O.append("g").attr("class","grid").selectAll("line").data(gt.ticks(5)).enter().append("line").attr("x1",0).attr("x2",U).attr("y1",A=>gt(A)).attr("y2",A=>gt(A)).attr("stroke","var(--divider-color)").attr("stroke-width",.5),O.append("g").attr("class","x-axis").attr("transform",`translate(0, ${Y})`).call(Wn(J).ticks(vn.every(1)).tickFormat(Fe("%Y-%m"))).selectAll("text").style("font-size","var(--font-size-xs)").style("fill","var(--text-color-primary)").style("text-anchor","end").attr("dx","-.8em").attr("dy",".15em").attr("transform","rotate(-45)"),O.append("g").attr("class","y-axis").call(Pn(gt).ticks(5)).selectAll("text").style("font-size","var(--font-size-xs)").style("fill","var(--text-color-primary)"),O.append("text").attr("class","axis-label").attr("transform","rotate(-90)").attr("y",-55).attr("x",-Y/2).attr("text-anchor","middle").style("font-size","var(--font-size-sm)").style("fill","var(--text-color-secondary)").text(_t("viz.monthly_additions"));const ft=to().x(A=>J(A.date)).y(A=>gt(A.count)).curve(io);O.append("path").datum(E).attr("fill","none").attr("stroke","var(--primary-color)").attr("stroke-width",2).attr("d",ft),O.selectAll(".dot-monthly").data(E).enter().append("circle").attr("class","dot-monthly").attr("cx",A=>J(A.date)).attr("cy",A=>gt(A.count)).attr("r",4).attr("fill","var(--primary-color)").attr("stroke","white").attr("stroke-width",1).on("mouseenter",function(A,dt){vt(this).transition().duration(200).attr("r",6),bt(A,dt,"monthly")}).on("mousemove",function(A,dt){bt(A,dt,"monthly")}).on("mouseleave",function(){vt(this).transition().duration(200).attr("r",4),st()});const xt=rt.append("g").attr("transform",`translate(${_.left}, ${_.top+Y+50})`),q=yn().domain([0,(Ie(E,A=>A.total)||0)*1.1]).range([Y,0]);xt.append("g").attr("class","grid").selectAll("line").data(q.ticks(5)).enter().append("line").attr("x1",0).attr("x2",U).attr("y1",A=>q(A)).attr("y2",A=>q(A)).attr("stroke","var(--divider-color)").attr("stroke-width",.5),xt.append("g").attr("class","x-axis").attr("transform",`translate(0, ${Y})`).call(Wn(J).ticks(vn.every(1)).tickFormat(Fe("%Y-%m"))).selectAll("text").style("font-size","var(--font-size-xs)").style("fill","var(--text-color-primary)").style("text-anchor","end").attr("dx","-.8em").attr("dy",".15em").attr("transform","rotate(-45)"),xt.append("g").attr("class","y-axis").call(Pn(q).ticks(5)).selectAll("text").style("font-size","var(--font-size-xs)").style("fill","var(--text-color-primary)"),xt.append("text").attr("class","axis-label").attr("transform","rotate(-90)").attr("y",-55).attr("x",-Y/2).attr("text-anchor","middle").style("font-size","var(--font-size-sm)").style("fill","var(--text-color-secondary)").text(_t("viz.total_items")),xt.append("text").attr("class","axis-label").attr("text-anchor","middle").attr("x",U/2).attr("y",Y+50).style("font-size","var(--font-size-sm)").style("fill","var(--text-color-secondary)").text(_t("viz.month"));const ut=to().x(A=>J(A.date)).y(A=>q(A.total)).curve(io);xt.append("path").datum(E).attr("fill","none").attr("stroke","var(--secondary-color)").attr("stroke-width",2).attr("stroke-dasharray","4 2").attr("d",ut),xt.selectAll(".dot-total").data(E).enter().append("circle").attr("class","dot-total").attr("cx",A=>J(A.date)).attr("cy",A=>q(A.total)).attr("r",4).attr("fill","var(--secondary-color)").attr("stroke","white").attr("stroke-width",1).on("mouseenter",function(A,dt){vt(this).transition().duration(200).attr("r",6),bt(A,dt,"total")}).on("mousemove",function(A,dt){bt(A,dt,"total")}).on("mouseleave",function(){vt(this).transition().duration(200).attr("r",4),st()})}function it(E){const X=E.target;n(0,g=X.value),B()}function ot(E){const X=E.target;n(1,k=X.value),B()}ye(async()=>{if(console.log("[TimelineDistribution] Component mounted"),await xe(),at(),(!r.items||r.items.length===0)&&(console.log("[TimelineDistribution] No items loaded, waiting for data"),await Et.loadItems()),await xe(),!L){console.error("[TimelineDistribution] Container element not found after waiting");return}console.log("[TimelineDistribution] Container found, generating visualization"),lt(),B();const E=new ResizeObserver(()=>{L&&B()});return E.observe(L),()=>{E.disconnect(),S&&document.body.contains(S)&&document.body.removeChild(S)}});function v(E){ce[E?"unshift":"push"](()=>{L=E,n(2,L)})}return t.$$.update=()=>{t.$$.dirty[0]&11&&r.items&&r.items.length>0&&(console.log("[TimelineDistribution] Items loaded, updating title"),n(7,y=r.items.filter(E=>!(g!=="all"&&E.country!==g||k!=="all"&&E.type!==k)).length),F()),t.$$.dirty[0]&1073741824&&F(),t.$$.dirty[0]&12&&r.items&&L&&(lt(),B())},[g,k,L,r,b,C,w,y,N,o,l,a,c,s,u,d,f,h,W,D,R,et,I,j,nt,ct,Ct,G,it,ot,i,v]}class Up extends Qt{constructor(e){super(),Gt(this,e,Lp,Ep,qt,{},null,[-1,-1])}}function So(t,e,n){const r=t.slice();return r[37]=e[n],r}function $o(t){let e,n;return{c(){e=dn("svg"),n=dn("path"),T(n,"fill","currentColor"),T(n,"d","M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"),T(e,"viewBox","0 0 24 24"),T(e,"width","14"),T(e,"height","14")},m(r,i){Q(r,e,i),p(e,n)},d(r){r&&Z(e)}}}function Do(t){let e,n,r,i,o=t[37].label+"",l,a,c,s=t[37].count+"",u,d,f,h,g,k=t[37].selected&&$o();function b(){return t[13](t[37])}function C(...w){return t[14](t[37],...w)}return{c(){e=M("div"),n=M("span"),k&&k.c(),r=ht(),i=M("span"),l=H(o),a=ht(),c=M("span"),u=H(s),d=ht(),T(n,"class","facet-checkbox svelte-1w69s2v"),T(i,"class","facet-label svelte-1w69s2v"),T(c,"class","facet-count svelte-1w69s2v"),T(e,"class","facet-option svelte-1w69s2v"),T(e,"role","checkbox"),T(e,"aria-checked",f=t[37].selected),T(e,"tabindex","0"),ge(e,"selected",t[37].selected)},m(w,y){Q(w,e,y),p(e,n),k&&k.m(n,null),p(e,r),p(e,i),p(i,l),p(e,a),p(e,c),p(c,u),p(e,d),h||(g=[Lt(e,"click",b),Lt(e,"keydown",C)],h=!0)},p(w,y){t=w,t[37].selected?k||(k=$o(),k.c(),k.m(n,null)):k&&(k.d(1),k=null),y[0]&2&&o!==(o=t[37].label+"")&&tt(l,o),y[0]&2&&s!==(s=t[37].count+"")&&tt(u,s),y[0]&2&&f!==(f=t[37].selected)&&T(e,"aria-checked",f),y[0]&2&&ge(e,"selected",t[37].selected)},d(w){w&&Z(e),k&&k.d(),h=!1,Ht(g)}}}function Fp(t){let e,n=t[6].error+"",r;return{c(){e=M("div"),r=H(n),T(e,"class","error svelte-1w69s2v")},m(i,o){Q(i,e,o),p(e,r)},p(i,o){o[0]&64&&n!==(n=i[6].error+"")&&tt(r,n)},d(i){i&&Z(e)}}}function Hp(t){let e;return{c(){e=M("div"),e.textContent=`${_t("ui.loading")}`,T(e,"class","loading svelte-1w69s2v")},m(n,r){Q(n,e,r)},p:Tt,d(n){n&&Z(e)}}}function No(t){let e,n,r=Array.from(new Set(t[4].map(Eo))).join(", ")+"",i;return{c(){e=M("p"),n=H(`Types: \r
                    `),i=H(r),T(e,"class","svelte-1w69s2v")},m(o,l){Q(o,e,l),p(e,n),p(e,i)},p(o,l){l[0]&16&&r!==(r=Array.from(new Set(o[4].map(Eo))).join(", ")+"")&&tt(i,r)},d(o){o&&Z(e)}}}function Rp(t){let e,n,r,i,o,l,a,c,s,u,d,f,h,g,k=t[3][0]+"",b,C,w,y=t[3][1]+"",m,N,z,x,L,S,$,P,W,D,R,et,I,j,nt,ct,Ct,G,V,F,K,lt,at,bt=t[3][0]+"",st,B,it=t[3][1]+"",ot,v,E,X,rt=t[1],_=[];for(let O=0;O<rt.length;O+=1)_[O]=Do(So(t,rt,O));function U(O,gt){if(O[6].loading)return Hp;if(O[6].error)return Fp}let Y=U(t),J=Y&&Y(t),yt=t[4].length>0&&No(t);return{c(){e=M("div"),n=M("div"),r=M("div"),i=M("div"),o=M("h3"),o.textContent="Countries",l=ht(),a=M("div");for(let O=0;O<_.length;O+=1)_[O].c();c=ht(),s=M("div"),u=M("h3"),u.textContent="Year Range",d=ht(),f=M("div"),h=M("div"),g=M("span"),b=H(k),C=ht(),w=M("span"),m=H(y),N=ht(),z=M("div"),x=M("input"),P=ht(),W=M("input"),I=ht(),j=M("div"),J&&J.c(),nt=ht(),ct=M("div"),Ct=M("div"),G=M("h3"),G.textContent="Summary",V=ht(),F=M("p"),K=H("Showing "),lt=H(t[5]),at=H(" items published between "),st=H(bt),B=H(" and "),ot=H(it),v=ht(),yt&&yt.c(),T(o,"class","svelte-1w69s2v"),T(a,"class","facet-options svelte-1w69s2v"),T(i,"class","facet-group"),T(r,"class","facets svelte-1w69s2v"),T(u,"class","svelte-1w69s2v"),T(h,"class","slider-labels svelte-1w69s2v"),T(x,"type","range"),T(x,"min",L=t[2][0]),T(x,"max",S=t[2][t[2].length-1]),x.value=$=t[3][0],T(x,"data-index","0"),T(x,"class","svelte-1w69s2v"),T(W,"type","range"),T(W,"min",D=t[2][0]),T(W,"max",R=t[2][t[2].length-1]),W.value=et=t[3][1],T(W,"data-index","1"),T(W,"class","svelte-1w69s2v"),T(z,"class","slider-inputs svelte-1w69s2v"),T(f,"class","slider-container svelte-1w69s2v"),T(s,"class","year-range svelte-1w69s2v"),T(n,"class","controls svelte-1w69s2v"),T(j,"class","chart-container svelte-1w69s2v"),T(G,"class","svelte-1w69s2v"),T(F,"class","svelte-1w69s2v"),T(Ct,"class","stat-summary svelte-1w69s2v"),T(ct,"class","stats svelte-1w69s2v"),T(e,"class","type-distribution-container svelte-1w69s2v")},m(O,gt){Q(O,e,gt),p(e,n),p(n,r),p(r,i),p(i,o),p(i,l),p(i,a);for(let ft=0;ft<_.length;ft+=1)_[ft]&&_[ft].m(a,null);p(n,c),p(n,s),p(s,u),p(s,d),p(s,f),p(f,h),p(h,g),p(g,b),p(h,C),p(h,w),p(w,m),p(f,N),p(f,z),p(z,x),p(z,P),p(z,W),p(e,I),p(e,j),J&&J.m(j,null),t[15](j),p(e,nt),p(e,ct),p(ct,Ct),p(Ct,G),p(Ct,V),p(Ct,F),p(F,K),p(F,lt),p(F,at),p(F,st),p(F,B),p(F,ot),p(Ct,v),yt&&yt.m(Ct,null),E||(X=[Lt(x,"input",t[12]),Lt(W,"input",t[12])],E=!0)},p(O,gt){if(gt[0]&2050){rt=O[1];let ft;for(ft=0;ft<rt.length;ft+=1){const xt=So(O,rt,ft);_[ft]?_[ft].p(xt,gt):(_[ft]=Do(xt),_[ft].c(),_[ft].m(a,null))}for(;ft<_.length;ft+=1)_[ft].d(1);_.length=rt.length}gt[0]&8&&k!==(k=O[3][0]+"")&&tt(b,k),gt[0]&8&&y!==(y=O[3][1]+"")&&tt(m,y),gt[0]&4&&L!==(L=O[2][0])&&T(x,"min",L),gt[0]&4&&S!==(S=O[2][O[2].length-1])&&T(x,"max",S),gt[0]&8&&$!==($=O[3][0])&&(x.value=$),gt[0]&4&&D!==(D=O[2][0])&&T(W,"min",D),gt[0]&4&&R!==(R=O[2][O[2].length-1])&&T(W,"max",R),gt[0]&8&&et!==(et=O[3][1])&&(W.value=et),Y===(Y=U(O))&&J?J.p(O,gt):(J&&J.d(1),J=Y&&Y(O),J&&(J.c(),J.m(j,null))),gt[0]&32&&tt(lt,O[5]),gt[0]&8&&bt!==(bt=O[3][0]+"")&&tt(st,bt),gt[0]&8&&it!==(it=O[3][1]+"")&&tt(ot,it),O[4].length>0?yt?yt.p(O,gt):(yt=No(O),yt.c(),yt.m(Ct,null)):yt&&(yt.d(1),yt=null)},i:Tt,o:Tt,d(O){O&&Z(e),Be(_,O),J&&J.d(),t[15](null),yt&&yt.d(),E=!1,Ht(X)}}}const le="TypeDistribution";function Nn(t){return t?/^\d{4}$/.test(t)?parseInt(t):/^\d{4}-\d{2}$/.test(t)||/^\d{4}-\d{2}-\d{2}$/.test(t)?parseInt(t.substring(0,4)):null:null}const Eo=t=>t.type;function Op(t,e,n){let r,i,o,l,a;mt(t,Et,G=>n(6,r=G));let c=!1,s,u,d,f=0,h=0,g=[],k=[],b=[0,0],C=[],w=0,y=[];const m=pt("viz.no_data");mt(t,m,G=>n(25,a=G)),pt("viz.filter_by_country"),pt("viz.all_countries");const N=pt("viz.publication_year");mt(t,N,G=>n(24,l=G));const z=pt("viz.number_of_items");mt(t,z,G=>n(23,o=G));const x=pt("viz.toggle_types");mt(t,x,G=>n(22,i=G)),pt("viz.toggled_type");function L(){if(!r.items||r.items.length===0)return[];const G=g.filter(lt=>lt.selected).map(lt=>lt.value),V=r.items.filter(lt=>{if(lt.type==="Notice d'autorité")return!1;const at=Nn(lt.publication_date);return!(!at||at<b[0]||at>b[1]||G.length>0&&!G.includes(lt.country))});n(5,w=V.length);const F=new Map;V.forEach(lt=>{const at=Nn(lt.publication_date);if(!at)return;const bt=lt.type||"Unknown",st=`${at}-${bt}`;F.has(st)?F.set(st,F.get(st)+1):F.set(st,1)});const K=[];return F.forEach((lt,at)=>{const[bt,st]=at.split("-");K.push({year:parseInt(bt),type:st,count:lt})}),K}function S(){if(!r.items||r.items.length===0)return;const G=r.items.filter(F=>Nn(F.publication_date)!==null&&F.type!=="Notice d'autorité"),V=qe(G,F=>F.country||"Unknown");n(1,g=Array.from(V,([F,K])=>({value:F,label:F,count:K.length,selected:!1})).filter(F=>F.value!=="Unknown").sort((F,K)=>K.count-F.count))}function $(){if(!r.items||r.items.length===0)return;const G=r.items.filter(K=>K.type!=="Notice d'autorité").map(K=>Nn(K.publication_date)).filter(K=>K!==null);if(G.length===0)return;const V=Math.min(...G),F=Math.max(...G);n(2,k=Array.from({length:F-V+1},(K,lt)=>V+lt)),n(3,b=[V,F])}function P(G){G.selected=!G.selected,n(1,g=[...g]),I()}function W(G){const V=G.target,F=parseInt(V.dataset.index||"0"),K=parseInt(V.value);F===0?n(3,b=[K,Math.max(K,b[1])]):n(3,b=[Math.min(K,b[0]),K]),I()}function D(){try{d&&document.body.contains(d)&&document.body.removeChild(d),d=document.createElement("div"),d.style.position="absolute",d.style.backgroundColor="rgba(0, 0, 0, 0.8)",d.style.color="white",d.style.padding="8px 12px",d.style.borderRadius="4px",d.style.pointerEvents="none",d.style.display="none",d.style.fontSize="12px",d.style.zIndex="1000",d.style.boxShadow="0 2px 5px rgba(0,0,0,0.2)",document&&document.body&&document.body.appendChild(d)}catch(G){console.error("Error creating tooltip:",G)}}function R(G,V,F){try{if((!d||!document.body.contains(d))&&D(),!d)return;const K=V.data.year,lt=F.map(ot=>{const v=ot.find(E=>E.data.year===K);return{type:ot.key,count:v?v[1]-v[0]:0}}).filter(ot=>ot.count>0),at=lt.reduce((ot,v)=>ot+v.count,0);d.innerHTML=`
                <div style="font-weight:bold;margin-bottom:4px;border-bottom:1px solid rgba(255,255,255,0.3);padding-bottom:2px;">
                    Year: ${K}
                </div>
                <div style="display:grid;grid-template-columns:auto 1fr 1fr;gap:4px;">
                    <span style="font-weight:bold">Type</span>
                    <span style="text-align:right;font-weight:bold">Count</span>
                    <span style="text-align:right;font-weight:bold">%</span>
                    ${lt.map(ot=>`
                        <span>${ot.type}</span>
                        <span style="text-align:right">${ot.count}</span>
                        <span style="text-align:right">${(ot.count/at*100).toFixed(1)}%</span>
                    `).join("")}
                    <span style="border-top:1px solid rgba(255,255,255,0.3);font-weight:bold;margin-top:2px;padding-top:2px;">Total</span>
                    <span style="border-top:1px solid rgba(255,255,255,0.3);text-align:right;font-weight:bold;margin-top:2px;padding-top:2px;">${at}</span>
                    <span></span>
                </div>
            `;const bt=250,st=150;let B=G.pageX+10,it=G.pageY+10;B+bt>window.innerWidth&&(B=G.pageX-bt-10),it+st>window.innerHeight&&(it=G.pageY-st-10),d.style.left=`${B}px`,d.style.top=`${it}px`,d.style.display="block"}catch(K){console.error("Error showing tooltip:",K)}}function et(){try{d&&document.body.contains(d)&&(d.style.display="none")}catch(G){console.error("Error hiding tooltip:",G)}}function I(){if(!u){console.error("Container element not found in updateVisualization");return}if(n(4,C=L()),C.length===0){vt(u).select("svg").remove(),vt(u).select(".no-data").remove(),vt(u).append("div").attr("class","no-data").style("position","absolute").style("top","50%").style("left","50%").style("transform","translate(-50%, -50%)").style("text-align","center").style("color","var(--text-color-secondary)").text(a);return}vt(u).select("svg").remove(),vt(u).select(".no-data").remove();const G=u.getBoundingClientRect();f=G.width,h=G.height;const V={top:40,right:60,bottom:120,left:60},F=f-V.left-V.right,K=h-V.top-V.bottom,lt=Array.from(new Set(C.map(Y=>Y.type)));if(y.length===0)y=lt.map(Y=>({type:Y,visible:!0}));else{const Y=y.map(J=>J.type);lt.forEach(J=>{Y.includes(J)||y.push({type:J,visible:!0})})}const at=Array.from(qe(C.filter(Y=>{var J;return((J=y.find(yt=>yt.type===Y.type))==null?void 0:J.visible)??!0}),Y=>Y.year),([Y,J])=>{const yt={year:Y};return J.forEach(O=>{yt[O.type]=O.count}),yt}).sort((Y,J)=>Y.year-J.year),bt=lt.filter(Y=>{var J;return((J=y.find(yt=>yt.type===Y))==null?void 0:J.visible)??!0}),st=vt(u).append("svg").attr("width",f).attr("height",h),B=st.append("g").attr("transform",`translate(${V.left}, ${V.top})`),it=ni().domain(at.map(Y=>Y.year.toString())).range([0,F]).padding(.1),ot=Kh().keys(bt).value((Y,J)=>Y[J]||0)(at),v=yn().domain([0,Ie(ot.length>0?ot[ot.length-1]:[],Y=>Y[1])||0]).range([K,0]),E=Me().domain(lt).range(Tn);B.append("g").attr("transform",`translate(0, ${K})`).call(Wn(it).tickSizeOuter(0)).selectAll("text").style("text-anchor","middle").attr("dy","0.8em").style("font-size","var(--font-size-xs)").style("fill","var(--text-color-primary)"),B.append("g").call(Pn(v).ticks(5)).selectAll("text").style("font-size","var(--font-size-xs)").style("fill","var(--text-color-primary)"),B.append("text").attr("text-anchor","middle").attr("x",F/2).attr("y",K+V.bottom-10).attr("fill","var(--text-color-secondary)").style("font-size","var(--font-size-sm)").text(l),B.append("text").attr("text-anchor","middle").attr("transform","rotate(-90)").attr("x",-K/2).attr("y",-V.left+15).attr("fill","var(--text-color-secondary)").style("font-size","var(--font-size-sm)").text(o),B.selectAll(".type-bars").data(ot).enter().append("g").attr("class","type-bars").attr("fill",Y=>E(Y.key)).selectAll("rect").data(Y=>Y).enter().append("rect").attr("x",Y=>it(Y.data.year.toString())||0).attr("y",Y=>v(Y[1])).attr("height",Y=>v(Y[0])-v(Y[1])).attr("width",it.bandwidth()).attr("stroke","white").attr("stroke-width",1).on("mouseenter",(Y,J)=>{R(Y,J,ot)}).on("mousemove",(Y,J)=>{R(Y,J,ot)}).on("mouseleave",()=>{et()}),st.append("text").attr("x",f/2).attr("y",20).attr("text-anchor","middle").attr("font-size","var(--font-size-lg)").attr("font-weight","bold").attr("fill","var(--text-color-primary)").text(`Item Types by Publication Year (${w} items)`);const X=150,rt=Math.floor(F/X),_=25,U=st.append("g").attr("class","legend").attr("transform",`translate(${V.left}, ${V.top+K+40})`);U.append("text").attr("x",0).attr("y",-10).attr("font-size","var(--font-size-sm)").attr("font-weight","bold").attr("fill","var(--text-color-primary)").text(i),lt.forEach((Y,J)=>{var q;const yt=((q=y.find(ut=>ut.type===Y))==null?void 0:q.visible)??!0,O=Math.floor(J/rt),gt=J%rt,ft=U.append("g").attr("transform",`translate(${gt*X}, ${O*_})`).attr("class","legend-item").attr("role","button").style("cursor","pointer");ft.append("rect").attr("x",-5).attr("y",-5).attr("width",X-10).attr("height",20).attr("fill","transparent").attr("class","legend-hitbox"),ft.append("rect").attr("width",14).attr("height",14).attr("fill",E(Y)).attr("stroke",yt?"none":"#999").attr("stroke-width",yt?0:1).attr("opacity",yt?1:.5);const xt=ft.append("text").attr("x",24).attr("y",12).attr("font-size","var(--font-size-sm)").attr("fill","var(--text-color-primary)").style("opacity",yt?1:.5).text(Y);if(!yt){const ut=xt.node();if(ut){const A=ut.getComputedTextLength();ft.append("line").attr("x1",24).attr("y1",12).attr("x2",24+A).attr("y2",12).attr("stroke","var(--text-color-primary)").attr("stroke-width",1).attr("opacity",.7)}}ft.on("click",()=>{console.log(`Clicked on type: ${Y}`),vt(u).append("div").attr("class","debug-message").style("position","fixed").style("bottom","10px").style("left","10px").style("background","rgba(0,0,0,0.7)").style("color","white").style("padding","5px 10px").style("border-radius","4px").style("z-index",9999).text(`Toggled type: ${Y}`).transition().duration(2e3).style("opacity",0).remove();const ut=y.findIndex(A=>A.type===Y);ut>=0&&(y[ut].visible=!y[ut].visible,y=[...y],I())}).attr("tabindex","0").on("keydown",ut=>{if(ut.key==="Enter"||ut.key===" "){ut.preventDefault();const A=y.findIndex(dt=>dt.type===Y);A>=0&&(y[A].visible=!y[A].visible,y=[...y],I())}}),ft.on("mouseenter",function(){vt(this).select("text").style("font-weight","bold"),vt(this).select(".legend-hitbox").attr("fill","rgba(0,0,0,0.05)")}).on("mouseleave",function(){vt(this).select("text").style("font-weight","normal"),vt(this).select(".legend-hitbox").attr("fill","transparent")})})}function j(G){!c||!u||(wt(le,"Items store changed",{itemCount:(G==null?void 0:G.length)||0}),document.body.contains(u)&&(S(),$(),I()))}ye(async()=>{if(c=!0,wt(le,"Component mounted"),await xe(),!u){console.error("Container element not found in onMount");return}D(),s=Et.subscribe(V=>{j(V.items)}),r.items&&r.items.length>0?(S(),$(),I()):Et.loadItems();const G=new ResizeObserver(()=>{c&&u&&document.body.contains(u)&&I()});return G.observe(u),()=>{c=!1,wt(le,"Component cleanup started");try{G.disconnect(),wt(le,"Resize observer disconnected")}catch(V){console.error("Error disconnecting resize observer:",V)}try{d&&document.body.contains(d)&&(document.body.removeChild(d),wt(le,"Tooltip removed"))}catch(V){console.error("Error removing tooltip:",V)}s&&(s(),wt(le,"Unsubscribed from items store")),wt(le,"Component cleanup completed")}}),lr(()=>{c&&(c=!1,wt(le,"Component destroyed (backup cleanup)"),s&&(s(),wt(le,"Unsubscribed from items store (backup)")))});const nt=G=>P(G),ct=(G,V)=>V.key==="Enter"&&P(G);function Ct(G){ce[G?"unshift":"push"](()=>{u=G,n(0,u)})}return[u,g,k,b,C,w,r,m,N,z,x,P,W,nt,ct,Ct]}class Yp extends Qt{constructor(e){super(),Gt(this,e,Op,Rp,qt,{},null,[-1,-1])}}function Wp(t){let e,n=t[4].error+"",r;return{c(){e=M("div"),r=H(n),T(e,"class","error svelte-dvynwo")},m(i,o){Q(i,e,o),p(e,r)},p(i,o){o[0]&16&&n!==(n=i[4].error+"")&&tt(r,n)},d(i){i&&Z(e)}}}function Pp(t){let e;return{c(){e=M("div"),e.textContent=`${_t("ui.loading")}`,T(e,"class","loading svelte-dvynwo")},m(n,r){Q(n,e,r)},p:Tt,d(n){n&&Z(e)}}}function Io(t){let e,n,r,i,o=Math.round(t[1]/t[2]).toLocaleString()+"",l;return{c(){e=M("p"),n=H(t[5]),r=H(": "),i=M("strong"),l=H(o),T(e,"class","svelte-dvynwo")},m(a,c){Q(a,e,c),p(e,n),p(e,r),p(e,i),p(i,l)},p(a,c){c[0]&32&&tt(n,a[5]),c[0]&6&&o!==(o=Math.round(a[1]/a[2]).toLocaleString()+"")&&tt(l,o)},d(a){a&&Z(e)}}}function Bp(t){let e,n;return{c(){e=M("p"),n=H(t[6]),T(e,"class","svelte-dvynwo")},m(r,i){Q(r,e,i),p(e,n)},p(r,i){i[0]&64&&tt(n,r[6])},d(r){r&&Z(e)}}}function qp(t){let e,n,r,i,o=t[3].data.name+"",l,a,c,s;return{c(){e=M("p"),n=H(t[10]),r=H(": "),i=M("strong"),l=H(o),a=ht(),c=M("p"),s=H(t[11]),T(e,"class","svelte-dvynwo"),T(c,"class","svelte-dvynwo")},m(u,d){Q(u,e,d),p(e,n),p(e,r),p(e,i),p(i,l),Q(u,a,d),Q(u,c,d),p(c,s)},p(u,d){d[0]&1024&&tt(n,u[10]),d[0]&8&&o!==(o=u[3].data.name+"")&&tt(l,o),d[0]&2048&&tt(s,u[11])},d(u){u&&Z(e),u&&Z(a),u&&Z(c)}}}function Vp(t){let e,n,r,i,o,l,a,c,s,u,d,f,h,g,k,b,C,w,y=t[1].toLocaleString()+"",m,N,z;function x(R,et){if(R[4].loading)return Pp;if(R[4].error)return Wp}let L=x(t),S=L&&L(t),$=t[2]>0&&Io(t);function P(R,et){return R[3]?qp:Bp}let W=P(t),D=W(t);return{c(){e=M("div"),n=M("div"),S&&S.c(),r=ht(),i=M("div"),o=M("div"),l=M("h3"),a=H(t[7]),c=ht(),s=M("p"),u=H(t[8]),d=H(": "),f=M("strong"),h=H(t[2]),g=ht(),k=M("p"),b=H(t[9]),C=H(": "),w=M("strong"),m=H(y),N=ht(),$&&$.c(),z=ht(),D.c(),T(n,"class","chart-container svelte-dvynwo"),T(l,"class","svelte-dvynwo"),T(s,"class","svelte-dvynwo"),T(k,"class","svelte-dvynwo"),T(o,"class","stat-summary svelte-dvynwo"),T(i,"class","stats svelte-dvynwo"),T(e,"class","word-distribution-container svelte-dvynwo")},m(R,et){Q(R,e,et),p(e,n),S&&S.m(n,null),t[25](n),p(e,r),p(e,i),p(i,o),p(o,l),p(l,a),p(o,c),p(o,s),p(s,u),p(s,d),p(s,f),p(f,h),p(o,g),p(o,k),p(k,b),p(k,C),p(k,w),p(w,m),p(o,N),$&&$.m(o,null),p(o,z),D.m(o,null)},p(R,et){L===(L=x(R))&&S?S.p(R,et):(S&&S.d(1),S=L&&L(R),S&&(S.c(),S.m(n,null))),et[0]&128&&tt(a,R[7]),et[0]&256&&tt(u,R[8]),et[0]&4&&tt(h,R[2]),et[0]&512&&tt(b,R[9]),et[0]&2&&y!==(y=R[1].toLocaleString()+"")&&tt(m,y),R[2]>0?$?$.p(R,et):($=Io(R),$.c(),$.m(o,z)):$&&($.d(1),$=null),W===(W=P(R))&&D?D.p(R,et):(D.d(1),D=W(R),D&&(D.c(),D.m(o,null)))},i:Tt,o:Tt,d(R){R&&Z(e),S&&S.d(),t[25](null),$&&$.d(),D.d()}}}const Dt="WordDistribution";function Xp(t,e,n){let r,i,o,l,a,c,s,u,d,f,h,g,k,b;mt(t,Et,v=>n(4,r=v));let C=!1,w,y,m,N=0,z=0,x=0,L=0,S={name:"root",children:[]},$=null;const P=pt("viz.no_data");mt(t,P,v=>n(37,d=v)),pt("viz.word_distribution");const W=pt("viz.total_words");mt(t,W,v=>n(9,g=v));const D=pt("viz.avg_words_per_item");mt(t,D,v=>n(5,l=v));const R=pt("viz.click_zoom_in");mt(t,R,v=>n(6,s=v)),pt("viz.click_zoom_out"),pt("viz.unknown"),pt("viz.no_set");const et=pt("viz.back_to_all");mt(t,et,v=>n(36,u=v));const I=pt("viz.currently_viewing");mt(t,I,v=>n(10,k=v));const j=pt("viz.click_back_to_return");mt(t,j,v=>n(11,b=v));const nt=pt("viz.total_items_with_word_count");mt(t,nt,v=>n(8,h=v));const ct=pt("viz.summary");mt(t,ct,v=>n(7,f=v));const Ct=pt("viz.words");mt(t,Ct,v=>n(35,c=v));const G=pt("viz.items");mt(t,G,v=>n(34,a=v));const V=pt("viz.percent_of_country");mt(t,V,v=>n(33,o=v));const F=pt("viz.percent_of_total");mt(t,F,v=>n(32,i=v)),pt("viz.item_set_summary");function K(){if(!r.items||r.items.length===0)return{name:"root",children:[]};const v=r.items.filter(rt=>rt.word_count!==void 0);n(2,L=v.length),n(1,x=v.reduce((rt,_)=>rt+(_.word_count||0),0));const E=qe(v,rt=>rt.country||"Unknown"),X={name:"Word Distribution",children:[]};return E.forEach((rt,_)=>{const U=qe(rt,J=>J.item_set_title||"No Set"),Y={name:_,children:[],wordCount:0,itemCount:rt.length};U.forEach((J,yt)=>{const O=J.reduce((ft,xt)=>ft+(xt.word_count||0),0),gt={name:yt,value:O,wordCount:O,itemCount:J.length};Y.children.push(gt),Y.wordCount!==void 0?Y.wordCount+=O:Y.wordCount=O}),Y.children.sort((J,yt)=>(yt.wordCount||0)-(J.wordCount||0)),X.children.push(Y)}),X.children.sort((rt,_)=>(_.wordCount||0)-(rt.wordCount||0)),X}function lt(v){if(n(3,$=v),$&&(!$.children||$.children.length===0)){const E={name:$.data.name,children:$.data.children||[],wordCount:$.data.wordCount,itemCount:$.data.itemCount};if(!E.children||E.children.length===0){console.warn("Cannot zoom to node without children");return}}at()}function at(){var v;try{if(!y){console.error("Container element not found");return}if($||(S=K()),!S.children||S.children.length===0){vt(y).select("svg").remove(),vt(y).append("div").attr("class","no-data").style("position","absolute").style("top","50%").style("left","50%").style("transform","translate(-50%, -50%)").style("text-align","center").style("color","var(--text-color-secondary)").text(d);return}vt(y).select("svg").remove(),vt(y).select(".no-data").remove();const E=y.getBoundingClientRect();N=E.width,z=E.height;const X={top:40,right:10,bottom:10,left:10},rt=N-X.left-X.right,_=z-X.top-X.bottom,U=vt(y).append("svg").attr("width",N).attr("height",z),Y=$?`${$.data.name}: ${((v=$.data.wordCount)==null?void 0:v.toLocaleString())||0} ${c} (${$.data.itemCount} ${a})`:_t("viz.word_distribution_subtitle",[L.toString(),x.toLocaleString()]);U.append("text").attr("x",N/2).attr("y",20).attr("text-anchor","middle").attr("font-size","var(--font-size-lg)").attr("font-weight","bold").attr("fill","var(--text-color-primary)").text(Y);const J=U.append("g").attr("transform",`translate(${X.left}, ${X.top})`);if($){const q=U.append("g").attr("class","zoom-out-button").attr("transform",`translate(${X.left}, ${X.top-30})`).style("cursor","pointer").on("click",()=>lt(null));q.append("rect").attr("width",100).attr("height",24).attr("rx",4).attr("fill","var(--primary-color)").attr("opacity",.8),q.append("text").attr("x",50).attr("y",16).attr("text-anchor","middle").attr("fill","white").attr("font-size","var(--font-size-sm)").text(u)}const yt=Il().size([rt,_]).paddingOuter(4).paddingTop(20).paddingInner(1).round(!0);let O;if($)if($.data.children&&$.data.children.length>0){const q={name:$.data.name,children:$.data.children};O=ne(q).sum(ut=>ut.value||0).sort((ut,A)=>(A.value||0)-(ut.value||0))}else if($.children&&$.children.length>0){const q=$.children.map(A=>({name:A.data.name,value:A.data.value||A.value,wordCount:A.data.wordCount,itemCount:A.data.itemCount})),ut={name:$.data.name,children:q};O=ne(ut).sum(A=>A.value||0).sort((A,dt)=>(dt.value||0)-(A.value||0))}else console.warn("Zoomed node has no valid children data, falling back to full hierarchy"),S=K(),O=ne(S).sum(q=>q.value||0).sort((q,ut)=>(ut.value||0)-(q.value||0));else O=ne(S).sum(q=>q.value||0).sort((q,ut)=>(ut.value||0)-(q.value||0));try{yt(O)}catch(q){console.error("Error applying treemap layout:",q),n(3,$=null),S=K(),O=ne(S).sum(ut=>ut.value||0).sort((ut,A)=>(A.value||0)-(ut.value||0)),yt(O)}const gt=Me().domain(O.children?O.children.map(q=>q.data.name):[O.data.name]).range(Tn),ft=J.selectAll(".country").data($?[]:O.children||[]).enter().append("g").attr("class","country").attr("transform",q=>{const ut=q.x0||0,A=q.y0||0;return`translate(${ut},${A})`});ft.append("rect").attr("width",q=>{const ut=q.x0||0,A=q.x1||0;return Math.max(0,A-ut)}).attr("height",q=>{const ut=q.y0||0,A=q.y1||0;return Math.max(0,A-ut)}).attr("fill",q=>gt(q.data.name)).attr("stroke","white").attr("stroke-width",2).style("opacity",.7).style("cursor","pointer").on("click",(q,ut)=>{lt(ut)}).attr("title",s).append("title").text(()=>s),ft.append("text").attr("x",5).attr("y",15).attr("font-size","var(--font-size-sm)").attr("font-weight","bold").attr("fill","white").text(q=>{var ut;return`${q.data.name} (${((ut=q.data.wordCount)==null?void 0:ut.toLocaleString())||0} ${c})`}).style("pointer-events","none").each(function(q){var kt;const ut=vt(this),A=this.getComputedTextLength(),dt=q.x1-q.x0-10;A>dt&&ut.text(q.data.name).append("title").text(`${q.data.name} (${((kt=q.data.wordCount)==null?void 0:kt.toLocaleString())||0} ${c})`)});const xt=J.selectAll(".item-set").data($?O.children||[]:O.leaves()).enter().append("g").attr("class","item-set").attr("transform",q=>{const ut=q.x0||0,A=q.y0||0;return`translate(${ut},${A})`});xt.append("rect").attr("width",q=>{const ut=q.x0||0,A=q.x1||0;return Math.max(0,A-ut)}).attr("height",q=>{const ut=q.y0||0,A=q.y1||0;return Math.max(0,A-ut)}).attr("fill",q=>{var dt,kt;const ut=gt($?$.data.name:((kt=(dt=q.parent)==null?void 0:dt.data)==null?void 0:kt.name)||"Unknown"),A=me(ut);return me(A).brighter(.7).toString()}).attr("stroke","white").attr("stroke-width",.5).style("cursor","pointer").on("mouseover",function(q,ut){vt(this).attr("stroke","var(--primary-color)").attr("stroke-width",2),st(ut,q)}).on("mousemove",function(q,ut){st(ut,q)}).on("mouseout",function(){vt(this).attr("stroke","white").attr("stroke-width",.5),B()}),xt.append("text").attr("x",3).attr("y",13).attr("font-size","var(--font-size-xs)").attr("fill","var(--text-color-primary)").style("pointer-events","none").each(function(q){var Qe;const ut=vt(this),A=q.x1-q.x0,dt=q.y1-q.y0;if(A<30||dt<20)return;let kt=q.data.name;const te=A-6,Rt=$?$.data.name:q.parent?q.parent.data.name:"";ut.text(kt).append("title").text(`${Rt} > ${q.data.name}: ${((Qe=q.data.wordCount)==null?void 0:Qe.toLocaleString())||0} ${c} (${q.data.itemCount} ${a})`);const Cn=this;let zn=Cn.getComputedTextLength(),Ge=!1;for(;zn>te&&kt.length>3;)kt=kt.slice(0,-1),ut.text(kt),zn=Cn.getComputedTextLength(),Ge=!0;Ge&&ut.text(kt+"...")})}catch(E){console.error("Error in updateVisualization:",E)}}function bt(){try{m&&document.body.contains(m)&&document.body.removeChild(m),m=document.createElement("div"),m.style.position="absolute",m.style.backgroundColor="rgba(0, 0, 0, 0.8)",m.style.color="white",m.style.padding="8px 12px",m.style.borderRadius="4px",m.style.pointerEvents="none",m.style.display="none",m.style.fontSize="12px",m.style.zIndex="1000",m.style.boxShadow="0 2px 5px rgba(0,0,0,0.2)",document&&document.body&&document.body.appendChild(m)}catch(v){console.error("Error creating tooltip:",v)}}function st(v,E){try{if((!m||!document.body.contains(m))&&(wt(Dt,"Tooltip element not found, creating new one"),bt()),!E){wt(Dt,"Event object is undefined in showTooltip");return}const X=v.parent?v.parent.data.name:v.data.name,rt=v.parent?v.data.name:"All",_=v.data.wordCount||0,U=v.data.itemCount||0,Y=U>0?Math.round(_/U):0,J=$?$.data.wordCount:v.parent?v.parent.data.wordCount:0,yt=J&&J>0?(_/J*100).toFixed(1)+"%":"N/A",O=x>0?(_/x*100).toFixed(1)+"%":"N/A";m.innerHTML=`
                <div style="font-weight:bold;margin-bottom:4px;border-bottom:1px solid rgba(255,255,255,0.3);padding-bottom:2px;">
                    ${X} > ${rt}
                </div>
                <div style="display:grid;grid-template-columns:auto auto;gap:4px;">
                    <span>${c}:</span>
                    <span style="text-align:right;font-weight:bold">${_.toLocaleString()}</span>
                    <span>${a}:</span>
                    <span style="text-align:right">${U}</span>
                    <span>${l}:</span>
                    <span style="text-align:right">${Y}</span>
                    <span>${o}:</span>
                    <span style="text-align:right">${yt}</span>
                    <span>${i}:</span>
                    <span style="text-align:right">${O}</span>
                </div>
            `;const gt=200,ft=120;let xt=0,q=0;try{xt=E.pageX+10,q=E.pageY+10,xt+gt>window.innerWidth&&(xt=E.pageX-gt-10),q+ft>window.innerHeight&&(q=E.pageY-ft-10),xt=Math.max(0,xt),q=Math.max(0,q)}catch(ut){wt(Dt,"Error calculating tooltip position",ut),xt=window.innerWidth/2-gt/2,q=window.innerHeight/2-ft/2}m.style.left=`${xt}px`,m.style.top=`${q}px`,m.style.display="block",wt(Dt,"Tooltip shown",{country:X,itemSet:rt,position:{left:xt,top:q}})}catch(X){console.error("Error showing tooltip:",X),wt(Dt,"Error showing tooltip",X)}}function B(){try{m&&document.body.contains(m)&&(m.style.display="none")}catch(v){console.error("Error hiding tooltip:",v)}}function it(v){!C||!y||(wt(Dt,"Items store changed",{itemCount:(v==null?void 0:v.length)||0}),document.body.contains(y)&&at())}ye(async()=>{try{if(C=!0,wt(Dt,"Component mounted"),await xe(),!y){console.error("Container element not found in onMount");return}bt(),w=Et.subscribe(E=>{it(E.items)}),r.items&&r.items.length>0?at():Et.loadItems();const v=new ResizeObserver(()=>{C&&y&&document.body.contains(y)&&at()});return v.observe(y),()=>{try{C=!1,wt(Dt,"Component cleanup started"),v&&(v.disconnect(),wt(Dt,"Resize observer disconnected")),y&&(vt(y).selectAll("*").remove(),wt(Dt,"D3 selections removed")),m&&document.body.contains(m)&&(document.body.removeChild(m),wt(Dt,"Tooltip removed")),w&&(w(),wt(Dt,"Unsubscribed from items store")),wt(Dt,"Component cleanup completed")}catch(E){console.error("Error during cleanup:",E)}}}catch(v){console.error("Error in onMount:",v)}}),lr(()=>{if(C){C=!1,wt(Dt,"Component destroyed (backup cleanup)");try{w&&(w(),wt(Dt,"Unsubscribed from items store (backup)")),m&&document.body.contains(m)&&(document.body.removeChild(m),wt(Dt,"Tooltip removed (backup)"))}catch(v){console.error("Error during backup cleanup:",v)}}});function ot(v){ce[v?"unshift":"push"](()=>{y=v,n(0,y)})}return[y,x,L,$,r,l,s,f,h,g,k,b,P,W,D,R,et,I,j,nt,ct,Ct,G,V,F,ot]}class jp extends Qt{constructor(e){super(),Gt(this,e,Xp,Vp,qt,{},null,[-1,-1])}}function Lo(t,e,n){const r=t.slice();return r[13]=e[n],r}function Uo(t){let e,n=_t(t[13].label)+"",r,i,o,l,a;function c(){return t[3](t[13])}function s(...u){return t[4](t[13],...u)}return{c(){e=M("li"),r=H(n),i=ht(),T(e,"role","tab"),T(e,"tabindex","0"),T(e,"aria-selected",o=t[0]===t[13].id),T(e,"class","svelte-s68afz"),ge(e,"active",t[0]===t[13].id)},m(u,d){Q(u,e,d),p(e,r),p(e,i),l||(a=[Lt(e,"click",c),Lt(e,"keydown",s)],l=!0)},p(u,d){t=u,d&1&&o!==(o=t[0]===t[13].id)&&T(e,"aria-selected",o),d&5&&ge(e,"active",t[0]===t[13].id)},d(u){u&&Z(e),l=!1,Ht(a)}}}function Kp(t){let e,n;return e=new jp({}),{c(){Vt(e.$$.fragment)},m(r,i){Wt(e,r,i),n=!0},p:Tt,i(r){n||(At(e.$$.fragment,r),n=!0)},o(r){St(e.$$.fragment,r),n=!1},d(r){Pt(e,r)}}}function Zp(t){let e,n;return e=new Sp({}),{c(){Vt(e.$$.fragment)},m(r,i){Wt(e,r,i),n=!0},p:Tt,i(r){n||(At(e.$$.fragment,r),n=!0)},o(r){St(e.$$.fragment,r),n=!1},d(r){Pt(e,r)}}}function Gp(t){let e,n;return e=new Yp({}),{c(){Vt(e.$$.fragment)},m(r,i){Wt(e,r,i),n=!0},p:Tt,i(r){n||(At(e.$$.fragment,r),n=!0)},o(r){St(e.$$.fragment,r),n=!1},d(r){Pt(e,r)}}}function Qp(t){let e,n;return e=new Up({}),{c(){Vt(e.$$.fragment)},m(r,i){Wt(e,r,i),n=!0},p:Tt,i(r){n||(At(e.$$.fragment,r),n=!0)},o(r){St(e.$$.fragment,r),n=!1},d(r){Pt(e,r)}}}function Jp(t){let e,n;return e=new Tp({}),{c(){Vt(e.$$.fragment)},m(r,i){Wt(e,r,i),n=!0},p:Tt,i(r){n||(At(e.$$.fragment,r),n=!0)},o(r){St(e.$$.fragment,r),n=!1},d(r){Pt(e,r)}}}function tg(t){let e,n;return e=new vp({}),{c(){Vt(e.$$.fragment)},m(r,i){Wt(e,r,i),n=!0},p:Tt,i(r){n||(At(e.$$.fragment,r),n=!0)},o(r){St(e.$$.fragment,r),n=!1},d(r){Pt(e,r)}}}function eg(t){let e,n=t[1].error+"",r;return{c(){e=M("div"),r=H(n),T(e,"class","error svelte-s68afz")},m(i,o){Q(i,e,o),p(e,r)},p(i,o){o&2&&n!==(n=i[1].error+"")&&tt(r,n)},i:Tt,o:Tt,d(i){i&&Z(e)}}}function ng(t){let e;return{c(){e=M("div"),e.textContent=`${_t("ui.loading")}`,T(e,"class","loading svelte-s68afz")},m(n,r){Q(n,e,r)},p:Tt,i:Tt,o:Tt,d(n){n&&Z(e)}}}function rg(t){let e,n,r,i,o,l,a,c,s,u,d,f,h,g,k,b;l=new ba({});let C=t[2],w=[];for(let x=0;x<C.length;x+=1)w[x]=Uo(Lo(t,C,x));const y=[ng,eg,tg,Jp,Qp,Gp,Zp,Kp],m=[];function N(x,L){return x[1].loading?0:x[1].error?1:x[0]==="countries"?2:x[0]==="languages"?3:x[0]==="timeline"?4:x[0]==="types"?5:x[0]==="categories"?6:x[0]==="words"?7:-1}~(f=N(t))&&(h=m[f]=y[f](t));let z=wa;return{c(){e=M("main"),n=M("header"),r=M("div"),i=M("h1"),i.textContent=`${_t("app.title")}`,o=ht(),Vt(l.$$.fragment),a=ht(),c=M("nav"),s=M("ul");for(let x=0;x<w.length;x+=1)w[x].c();u=ht(),d=M("div"),h&&h.c(),g=ht(),k=Vo(),T(i,"class","svelte-s68afz"),T(r,"class","header-top svelte-s68afz"),T(s,"class","tabs svelte-s68afz"),T(n,"class","svelte-s68afz"),T(d,"class","content svelte-s68afz"),T(e,"class","svelte-s68afz")},m(x,L){Q(x,e,L),p(e,n),p(n,r),p(r,i),p(r,o),Wt(l,r,null),p(n,a),p(n,c),p(c,s);for(let S=0;S<w.length;S+=1)w[S]&&w[S].m(s,null);p(e,u),p(e,d),~f&&m[f].m(d,null),Q(x,g,L),Q(x,k,L),b=!0},p(x,L){if(L&5){C=x[2];let $;for($=0;$<C.length;$+=1){const P=Lo(x,C,$);w[$]?w[$].p(P,L):(w[$]=Uo(P),w[$].c(),w[$].m(s,null))}for(;$<w.length;$+=1)w[$].d(1);w.length=C.length}let S=f;f=N(x),f===S?~f&&m[f].p(x,L):(h&&(Pr(),St(m[S],1,1,()=>{m[S]=null}),Br()),~f?(h=m[f],h?h.p(x,L):(h=m[f]=y[f](x),h.c()),At(h,1),h.m(d,null)):h=null)},i(x){b||(At(l.$$.fragment,x),At(h),At(z),b=!0)},o(x){St(l.$$.fragment,x),St(h),St(z),b=!1},d(x){x&&Z(e),Pt(l),Be(w,x),~f&&m[f].d(),x&&Z(g),x&&Z(k)}}}function ig(t){let e,n;return e=new Aa({props:{$$slots:{default:[rg]},$$scope:{ctx:t}}}),{c(){Vt(e.$$.fragment)},m(r,i){Wt(e,r,i),n=!0},p(r,[i]){const o={};i&65539&&(o.$$scope={dirty:i,ctx:r}),e.$set(o)},i(r){n||(At(e.$$.fragment,r),n=!0)},o(r){St(e.$$.fragment,r),n=!1},d(r){Pt(e,r)}}}const jt="App";function og(t,e,n){let r,i;mt(t,Ot,b=>n(11,r=b)),mt(t,Et,b=>n(1,i=b));let o=!1,l,a=0,c=0,s="countries";const u=[{id:"countries",label:"tab.countries"},{id:"languages",label:"tab.languages"},{id:"timeline",label:"tab.timeline"},{id:"types",label:"tab.types"},{id:"categories",label:"tab.categories"},{id:"words",label:"tab.words"}];let d="",f="";function h(b){var C;if(!o){wt(jt,`Language change ignored (not mounted): ${b}`);return}f=d,d=b,wt(jt,`Language changed from ${f} to ${b}`,{isMounted:o,updateCount:a,subscriptionActive:!!l}),wt(jt,"Current translations:",{title:_t("app.title"),loading:_t("ui.loading"),activeTab:_t(((C=u.find(w=>w.id===s))==null?void 0:C.label)||"")})}return Xo(()=>{c++,wt(jt,`Before update (render #${c})`,{isMounted:o,currentLanguage:d,activeTab:s})}),ye(()=>{o=!0,wt(jt,`Component mounted, initial language: ${r}`,{storeValue:r,activeTab:s}),d=r;try{l=Ot.subscribe(b=>{h(b)}),wt(jt,"Subscribed to language store")}catch(b){wt(jt,"Error subscribing to language store",b)}Et.loadItems()}),lr(()=>{if(wt(jt,"Component being destroyed",{isMounted:o,currentLanguage:d,hasUnsubscribe:!!l}),o=!1,l)try{l(),wt(jt,"Unsubscribed from language store"),l=void 0}catch(b){wt(jt,"Error unsubscribing from language store",b)}}),jo(()=>{a++,wt(jt,`Component updated (${a})`,{isMounted:o,currentLanguage:d,storeValue:r,activeTab:s})}),[s,i,u,b=>n(0,s=b.id),(b,C)=>C.key==="Enter"&&n(0,s=b.id)]}class lg extends Qt{constructor(e){super(),Gt(this,e,og,ig,qt,{})}}new lg({target:document.getElementById("app")});
