var qc=Object.defineProperty;var Yc=(t,e,n)=>e in t?qc(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Hr=(t,e,n)=>Yc(t,typeof e!="symbol"?e+"":e,n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();const Ho=!1;var so=Array.isArray,Gc=Array.prototype.indexOf,ua=Array.from,ol=Object.defineProperty,Qn=Object.getOwnPropertyDescriptor,al=Object.getOwnPropertyDescriptors,Kc=Object.prototype,Xc=Array.prototype,fa=Object.getPrototypeOf;function Zc(t){return typeof t=="function"}const Re=()=>{};function Jc(t){return t()}function Fi(t){for(var e=0;e<t.length;e++)t[e]()}const Qe=2,sl=4,lo=8,co=16,Sn=32,di=64,Ri=128,Je=256,Pi=512,Te=1024,En=2048,ir=4096,Tn=8192,uo=16384,ll=32768,fo=65536,cl=1<<17,Qc=1<<19,ul=1<<20,$n=Symbol("$state"),jc=Symbol("legacy props"),tu=Symbol("");function fl(t){return t===this.v}function dl(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function da(t){return!dl(t,this.v)}function eu(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function nu(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function ru(t){throw new Error("https://svelte.dev/e/effect_orphan")}function iu(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function hl(t){throw new Error("https://svelte.dev/e/lifecycle_legacy_only")}function ou(t){throw new Error("https://svelte.dev/e/props_invalid_value")}function au(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function su(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function lu(){throw new Error("https://svelte.dev/e/state_unsafe_local_read")}function cu(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}let Mr=!1,uu=!1;function fu(){Mr=!0}const ha=1,ga=2,gl=4,du=8,hu=16,gu=1,pu=2,mu=4,vu=8,yu=16,_u=4,xu=1,bu=2,Le=Symbol();function Ar(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}let Yt=null;function Wa(t){Yt=t}function wu(t,e){return Tu().set(t,e),e}function ke(t,e=!1,n){Yt={p:Yt,c:null,e:null,m:!1,s:t,x:null,l:null},Mr&&!e&&(Yt.l={s:null,u:null,r1:[],r2:Xe(!1)})}function ze(t){const e=Yt;if(e!==null){t!==void 0&&(e.x=t);const a=e.e;if(a!==null){var n=te,r=ne;e.e=null;try{for(var i=0;i<a.length;i++){var o=a[i];gn(o.effect),hn(o.reaction),Er(o.fn)}}finally{gn(n),hn(r)}}Yt=e.p,e.m=!0}return t||{}}function ho(){return!Mr||Yt!==null&&Yt.l===null}function Tu(t){return Yt===null&&Ar(),Yt.c??(Yt.c=new Map($u(Yt)||void 0))}function $u(t){let e=t.p;for(;e!==null;){const n=e.c;if(n!==null)return n;e=e.p}return null}function Xe(t,e){var n={f:0,v:t,reactions:null,equals:fl,rv:0,wv:0};return n}function go(t,e=!1){var r;const n=Xe(t);return e||(n.equals=da),Mr&&Yt!==null&&Yt.l!==null&&((r=Yt.l).s??(r.s=[])).push(n),n}function bt(t,e=!1){return Cu(go(t,e))}function Cu(t){return ne!==null&&!cn&&(ne.f&Qe)!==0&&(fn===null?Ru([t]):fn.push(t)),t}function Bo(t,e){return D(t,Ve(()=>f(t))),e}function D(t,e){return ne!==null&&!cn&&ho()&&(ne.f&(Qe|co))!==0&&(fn===null||!fn.includes(t))&&cu(),ti(t,e)}function ti(t,e){return t.equals(e)||(t.v,t.v=e,t.wv=El(),pl(t,En),ho()&&te!==null&&(te.f&Te)!==0&&(te.f&(Sn|di))===0&&(yn===null?Pu([t]):yn.push(t))),e}function pl(t,e){var n=t.reactions;if(n!==null)for(var r=ho(),i=n.length,o=0;o<i;o++){var a=n[o],s=a.f;(s&En)===0&&(!r&&a===te||(nn(a,e),(s&(Te|Je))!==0&&((s&Qe)!==0?pl(a,ir):bo(a))))}}let ml=!1;function ur(t,e=null,n){if(typeof t!="object"||t===null||$n in t)return t;const r=fa(t);if(r!==Kc&&r!==Xc)return t;var i=new Map,o=so(t),a=Xe(0);o&&i.set("length",Xe(t.length));var s;return new Proxy(t,{defineProperty(d,c,l){(!("value"in l)||l.configurable===!1||l.enumerable===!1||l.writable===!1)&&au();var h=i.get(c);return h===void 0?(h=Xe(l.value),i.set(c,h)):D(h,ur(l.value,s)),!0},deleteProperty(d,c){var l=i.get(c);if(l===void 0)c in d&&i.set(c,Xe(Le));else{if(o&&typeof c=="string"){var h=i.get("length"),u=Number(c);Number.isInteger(u)&&u<h.v&&D(h,u)}D(l,Le),qa(a)}return!0},get(d,c,l){var p;if(c===$n)return t;var h=i.get(c),u=c in d;if(h===void 0&&(!u||(p=Qn(d,c))!=null&&p.writable)&&(h=Xe(ur(u?d[c]:Le,s)),i.set(c,h)),h!==void 0){var g=f(h);return g===Le?void 0:g}return Reflect.get(d,c,l)},getOwnPropertyDescriptor(d,c){var l=Reflect.getOwnPropertyDescriptor(d,c);if(l&&"value"in l){var h=i.get(c);h&&(l.value=f(h))}else if(l===void 0){var u=i.get(c),g=u==null?void 0:u.v;if(u!==void 0&&g!==Le)return{enumerable:!0,configurable:!0,value:g,writable:!0}}return l},has(d,c){var g;if(c===$n)return!0;var l=i.get(c),h=l!==void 0&&l.v!==Le||Reflect.has(d,c);if(l!==void 0||te!==null&&(!h||(g=Qn(d,c))!=null&&g.writable)){l===void 0&&(l=Xe(h?ur(d[c],s):Le),i.set(c,l));var u=f(l);if(u===Le)return!1}return h},set(d,c,l,h){var C;var u=i.get(c),g=c in d;if(o&&c==="length")for(var p=l;p<u.v;p+=1){var v=i.get(p+"");v!==void 0?D(v,Le):p in d&&(v=Xe(Le),i.set(p+"",v))}u===void 0?(!g||(C=Qn(d,c))!=null&&C.writable)&&(u=Xe(void 0),D(u,ur(l,s)),i.set(c,u)):(g=u.v!==Le,D(u,ur(l,s)));var y=Reflect.getOwnPropertyDescriptor(d,c);if(y!=null&&y.set&&y.set.call(h,l),!g){if(o&&typeof c=="string"){var m=i.get("length"),$=Number(c);Number.isInteger($)&&$>=m.v&&D(m,$+1)}qa(a)}return!0},ownKeys(d){f(a);var c=Reflect.ownKeys(d).filter(u=>{var g=i.get(u);return g===void 0||g.v!==Le});for(var[l,h]of i)h.v!==Le&&!(l in d)&&c.push(l);return c},setPrototypeOf(){su()}})}function qa(t,e=1){D(t,t.v+e)}function Ya(t){return t!==null&&typeof t=="object"&&$n in t?t[$n]:t}function ku(t,e){return Object.is(Ya(t),Ya(e))}var Ga,vl,yl,_l;function zu(){if(Ga===void 0){Ga=window,vl=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype;yl=Qn(e,"firstChild").get,_l=Qn(e,"nextSibling").get,t.__click=void 0,t.__className="",t.__attributes=null,t.__styles=null,t.__e=void 0,Text.prototype.__t=void 0}}function pa(t=""){return document.createTextNode(t)}function tr(t){return yl.call(t)}function po(t){return _l.call(t)}function L(t,e){return tr(t)}function jt(t,e){{var n=tr(t);return n instanceof Comment&&n.data===""?po(n):n}}function _t(t,e=1,n=!1){let r=t;for(;e--;)r=po(r);return r}function Mu(t){t.textContent=""}function ei(t){var e=Qe|En,n=ne!==null&&(ne.f&Qe)!==0?ne:null;return te===null||n!==null&&(n.f&Je)!==0?e|=Je:te.f|=ul,{ctx:Yt,deps:null,effects:null,equals:fl,f:e,fn:t,reactions:null,rv:0,v:null,wv:0,parent:n??te}}function ie(t){const e=ei(t);return e.equals=da,e}function xl(t){var e=t.effects;if(e!==null){t.effects=null;for(var n=0;n<e.length;n+=1)Cn(e[n])}}function Au(t){for(var e=t.parent;e!==null;){if((e.f&Qe)===0)return e;e=e.parent}return null}function Su(t){var e,n=te;gn(Au(t));try{xl(t),e=Ll(t)}finally{gn(n)}return e}function bl(t){var e=Su(t),n=(Rn||(t.f&Je)!==0)&&t.deps!==null?ir:Te;nn(t,n),t.equals(e)||(t.v=e,t.wv=El())}function wl(t){te===null&&ne===null&&ru(),ne!==null&&(ne.f&Je)!==0&&te===null&&nu(),ya&&eu()}function Eu(t,e){var n=e.last;n===null?e.last=e.first=t:(n.next=t,t.prev=n,e.last=t)}function Sr(t,e,n,r=!0){var i=(t&di)!==0,o=te,a={ctx:Yt,deps:null,nodes_start:null,nodes_end:null,f:t|En,first:null,fn:e,last:null,next:null,parent:i?null:o,prev:null,teardown:null,transitions:null,wv:0};if(n){var s=gr;try{Ka(!0),xo(a),a.f|=ll}catch(l){throw Cn(a),l}finally{Ka(s)}}else e!==null&&bo(a);var d=n&&a.deps===null&&a.first===null&&a.nodes_start===null&&a.teardown===null&&(a.f&(ul|Ri))===0;if(!d&&!i&&r&&(o!==null&&Eu(a,o),ne!==null&&(ne.f&Qe)!==0)){var c=ne;(c.effects??(c.effects=[])).push(a)}return a}function ma(t){const e=Sr(lo,null,!1);return nn(e,Te),e.teardown=t,e}function Oo(t){wl();var e=te!==null&&(te.f&Sn)!==0&&Yt!==null&&!Yt.m;if(e){var n=Yt;(n.e??(n.e=[])).push({fn:t,effect:te,reaction:ne})}else{var r=Er(t);return r}}function Iu(t){return wl(),mo(t)}function Lu(t){const e=Sr(di,t,!0);return(n={})=>new Promise(r=>{n.outro?Ui(e,()=>{Cn(e),r(void 0)}):(Cn(e),r(void 0))})}function Er(t){return Sr(sl,t,!1)}function pe(t,e){var n=Yt,r={effect:null,ran:!1};n.l.r1.push(r),r.effect=mo(()=>{t(),!r.ran&&(r.ran=!0,D(n.l.r2,!0),Ve(e))})}function hi(){var t=Yt;mo(()=>{if(f(t.l.r2)){for(var e of t.l.r1){var n=e.effect;(n.f&Te)!==0&&nn(n,ir),Ir(n)&&xo(n),e.ran=!1}t.l.r2.v=!1}})}function mo(t){return Sr(lo,t,!0)}function It(t,e=[],n=ei){const r=e.map(n);return vo(()=>t(...r.map(f)))}function vo(t,e=0){return Sr(lo|co|e,t,!0)}function xr(t,e=!0){return Sr(lo|Sn,t,!0,e)}function Tl(t){var e=t.teardown;if(e!==null){const n=ya,r=ne;Xa(!0),hn(null);try{e.call(null)}finally{Xa(n),hn(r)}}}function $l(t,e=!1){var n=t.first;for(t.first=t.last=null;n!==null;){var r=n.next;Cn(n,e),n=r}}function Nu(t){for(var e=t.first;e!==null;){var n=e.next;(e.f&Sn)===0&&Cn(e),e=n}}function Cn(t,e=!0){var n=!1;if((e||(t.f&Qc)!==0)&&t.nodes_start!==null){for(var r=t.nodes_start,i=t.nodes_end;r!==null;){var o=r===i?null:po(r);r.remove(),r=o}n=!0}$l(t,e&&!n),Vi(t,0),nn(t,uo);var a=t.transitions;if(a!==null)for(const d of a)d.stop();Tl(t);var s=t.parent;s!==null&&s.first!==null&&Cl(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes_start=t.nodes_end=null}function Cl(t){var e=t.parent,n=t.prev,r=t.next;n!==null&&(n.next=r),r!==null&&(r.prev=n),e!==null&&(e.first===t&&(e.first=r),e.last===t&&(e.last=n))}function Ui(t,e){var n=[];va(t,n,!0),kl(n,()=>{Cn(t),e&&e()})}function kl(t,e){var n=t.length;if(n>0){var r=()=>--n||e();for(var i of t)i.out(r)}else e()}function va(t,e,n){if((t.f&Tn)===0){if(t.f^=Tn,t.transitions!==null)for(const a of t.transitions)(a.is_global||n)&&e.push(a);for(var r=t.first;r!==null;){var i=r.next,o=(r.f&fo)!==0||(r.f&Sn)!==0;va(r,e,o?n:!1),r=i}}}function Hi(t){zl(t,!0)}function zl(t,e){if((t.f&Tn)!==0){t.f^=Tn,(t.f&Te)===0&&(t.f^=Te),Ir(t)&&(nn(t,En),bo(t));for(var n=t.first;n!==null;){var r=n.next,i=(n.f&fo)!==0||(n.f&Sn)!==0;zl(n,i?e:!1),n=r}if(t.transitions!==null)for(const o of t.transitions)(o.is_global||e)&&o.in()}}let Bi=!1,Vo=[];function Ml(){Bi=!1;const t=Vo.slice();Vo=[],Fi(t)}function yo(t){Bi||(Bi=!0,queueMicrotask(Ml)),Vo.push(t)}function Du(){Bi&&Ml()}const Al=0,Fu=1;let zi=!1,Mi=Al,ni=!1,ri=null,gr=!1,ya=!1;function Ka(t){gr=t}function Xa(t){ya=t}let Zn=[],pr=0;let ne=null,cn=!1;function hn(t){ne=t}let te=null;function gn(t){te=t}let fn=null;function Ru(t){fn=t}let $e=null,Be=0,yn=null;function Pu(t){yn=t}let Sl=1,Oi=0,Rn=!1,Fn=null;function El(){return++Sl}function Ir(t){var h;var e=t.f;if((e&En)!==0)return!0;if((e&ir)!==0){var n=t.deps,r=(e&Je)!==0;if(n!==null){var i,o,a=(e&Pi)!==0,s=r&&te!==null&&!Rn,d=n.length;if(a||s){var c=t,l=c.parent;for(i=0;i<d;i++)o=n[i],(a||!((h=o==null?void 0:o.reactions)!=null&&h.includes(c)))&&(o.reactions??(o.reactions=[])).push(c);a&&(c.f^=Pi),s&&l!==null&&(l.f&Je)===0&&(c.f^=Je)}for(i=0;i<d;i++)if(o=n[i],Ir(o)&&bl(o),o.wv>t.wv)return!0}(!r||te!==null&&!Rn)&&nn(t,Te)}return!1}function Uu(t,e){for(var n=e;n!==null;){if((n.f&Ri)!==0)try{n.fn(t);return}catch{n.f^=Ri}n=n.parent}throw zi=!1,t}function Hu(t){return(t.f&uo)===0&&(t.parent===null||(t.parent.f&Ri)===0)}function _o(t,e,n,r){if(zi){if(n===null&&(zi=!1),Hu(e))throw t;return}n!==null&&(zi=!0);{Uu(t,e);return}}function Il(t,e,n=!0){var r=t.reactions;if(r!==null)for(var i=0;i<r.length;i++){var o=r[i];(o.f&Qe)!==0?Il(o,e,!1):e===o&&(n?nn(o,En):(o.f&Te)!==0&&nn(o,ir),bo(o))}}function Ll(t){var g;var e=$e,n=Be,r=yn,i=ne,o=Rn,a=fn,s=Yt,d=cn,c=t.f;$e=null,Be=0,yn=null,ne=(c&(Sn|di))===0?t:null,Rn=(c&Je)!==0&&(!gr||i===null||d),fn=null,Wa(t.ctx),cn=!1,Oi++;try{var l=(0,t.fn)(),h=t.deps;if($e!==null){var u;if(Vi(t,Be),h!==null&&Be>0)for(h.length=Be+$e.length,u=0;u<$e.length;u++)h[Be+u]=$e[u];else t.deps=h=$e;if(!Rn)for(u=Be;u<h.length;u++)((g=h[u]).reactions??(g.reactions=[])).push(t)}else h!==null&&Be<h.length&&(Vi(t,Be),h.length=Be);if(ho()&&yn!==null&&!cn&&h!==null&&(t.f&(Qe|ir|En))===0)for(u=0;u<yn.length;u++)Il(yn[u],t);return i!==null&&Oi++,l}finally{$e=e,Be=n,yn=r,ne=i,Rn=o,fn=a,Wa(s),cn=d}}function Bu(t,e){let n=e.reactions;if(n!==null){var r=Gc.call(n,t);if(r!==-1){var i=n.length-1;i===0?n=e.reactions=null:(n[r]=n[i],n.pop())}}n===null&&(e.f&Qe)!==0&&($e===null||!$e.includes(e))&&(nn(e,ir),(e.f&(Je|Pi))===0&&(e.f^=Pi),xl(e),Vi(e,0))}function Vi(t,e){var n=t.deps;if(n!==null)for(var r=e;r<n.length;r++)Bu(t,n[r])}function xo(t){var e=t.f;if((e&uo)===0){nn(t,Te);var n=te,r=Yt;te=t;try{(e&co)!==0?Nu(t):$l(t),Tl(t);var i=Ll(t);t.teardown=typeof i=="function"?i:null,t.wv=Sl;var o=t.deps,a;Ho&&uu&&t.f&En}catch(s){_o(s,t,n,r||t.ctx)}finally{te=n}}}function Nl(){if(pr>1e3){pr=0;try{iu()}catch(t){if(ri!==null)_o(t,ri,null);else throw t}}pr++}function Dl(t){var e=t.length;if(e!==0){Nl();var n=gr;gr=!0;try{for(var r=0;r<e;r++){var i=t[r];(i.f&Te)===0&&(i.f^=Te);var o=Wu(i);Ou(o)}}finally{gr=n}}}function Ou(t){var e=t.length;if(e!==0)for(var n=0;n<e;n++){var r=t[n];if((r.f&(uo|Tn))===0)try{Ir(r)&&(xo(r),r.deps===null&&r.first===null&&r.nodes_start===null&&(r.teardown===null?Cl(r):r.fn=null))}catch(i){_o(i,r,null,r.ctx)}}}function Vu(){if(ni=!1,pr>1001)return;const t=Zn;Zn=[],Dl(t),ni||(pr=0,ri=null)}function bo(t){Mi===Al&&(ni||(ni=!0,queueMicrotask(Vu))),ri=t;for(var e=t;e.parent!==null;){e=e.parent;var n=e.f;if((n&(di|Sn))!==0){if((n&Te)===0)return;e.f^=Te}}Zn.push(e)}function Wu(t){var e=[],n=t.first;t:for(;n!==null;){var r=n.f,i=(r&Sn)!==0,o=i&&(r&Te)!==0,a=n.next;if(!o&&(r&Tn)===0){if((r&sl)!==0)e.push(n);else if(i)n.f^=Te;else{var s=ne;try{ne=n,Ir(n)&&xo(n)}catch(l){_o(l,n,null,n.ctx)}finally{ne=s}}var d=n.first;if(d!==null){n=d;continue}}if(a===null){let l=n.parent;for(;l!==null;){if(t===l)break t;var c=l.next;if(c!==null){n=c;continue t}l=l.parent}}n=a}return e}function Fl(t){var e=Mi,n=Zn;try{Nl();const i=[];Mi=Fu,Zn=i,ni=!1,Dl(n);var r=t==null?void 0:t();return Du(),(Zn.length>0||i.length>0)&&Fl(),pr=0,ri=null,r}finally{Mi=e,Zn=n}}async function kn(){await Promise.resolve(),Fl()}function f(t){var e=t.f,n=(e&Qe)!==0;if(Fn!==null&&Fn.add(t),ne!==null&&!cn){fn!==null&&fn.includes(t)&&lu();var r=ne.deps;t.rv<Oi&&(t.rv=Oi,$e===null&&r!==null&&r[Be]===t?Be++:$e===null?$e=[t]:(!Rn||!$e.includes(t))&&$e.push(t))}else if(n&&t.deps===null&&t.effects===null){var i=t,o=i.parent;o!==null&&(o.f&Je)===0&&(i.f^=Je)}return n&&(i=t,Ir(i)&&bl(i)),t.v}function qu(t){var e=Fn;Fn=new Set;var n=Fn,r;try{if(Ve(t),e!==null)for(r of Fn)e.add(r)}finally{Fn=e}return n}function Za(t){var e=qu(()=>Ve(t));for(var n of e)if((n.f&cl)!==0)for(const r of n.deps||[])(r.f&Qe)===0&&ti(r,r.v);else ti(n,n.v)}function Ve(t){var e=cn;try{return cn=!0,t()}finally{cn=e}}const Yu=-7169;function nn(t,e){t.f=t.f&Yu|e}function De(t){if(!(typeof t!="object"||!t||t instanceof EventTarget)){if($n in t)Wo(t);else if(!Array.isArray(t))for(let e in t){const n=t[e];typeof n=="object"&&n&&$n in n&&Wo(n)}}}function Wo(t,e=new Set){if(typeof t=="object"&&t!==null&&!(t instanceof EventTarget)&&!e.has(t)){e.add(t),t instanceof Date&&t.getTime();for(let r in t)try{Wo(t[r],e)}catch{}const n=fa(t);if(n!==Object.prototype&&n!==Array.prototype&&n!==Map.prototype&&n!==Set.prototype&&n!==Date.prototype){const r=al(n);for(let i in r){const o=r[i].get;if(o)try{o.call(t)}catch{}}}}}const Gu=["touchstart","touchmove"];function Ku(t){return Gu.includes(t)}let Ja=!1;function Xu(){Ja||(Ja=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{var e;if(!t.defaultPrevented)for(const n of t.target.elements)(e=n.__on_r)==null||e.call(n)})},{capture:!0}))}function _a(t){var e=ne,n=te;hn(null),gn(null);try{return t()}finally{hn(e),gn(n)}}function Zu(t,e,n,r=n){t.addEventListener(e,()=>_a(n));const i=t.__on_r;i?t.__on_r=()=>{i(),r(!0)}:t.__on_r=()=>r(!0),Xu()}const Ju=new Set,Qa=new Set;function Qu(t,e,n,r={}){function i(o){if(r.capture||Kr.call(e,o),!o.cancelBubble)return _a(()=>n==null?void 0:n.call(this,o))}return t.startsWith("pointer")||t.startsWith("touch")||t==="wheel"?yo(()=>{e.addEventListener(t,i,r)}):e.addEventListener(t,i,r),i}function _e(t,e,n,r,i){var o={capture:r,passive:i},a=Qu(t,e,n,o);(e===document.body||e===window||e===document)&&ma(()=>{e.removeEventListener(t,a,o)})}function Kr(t){var $;var e=this,n=e.ownerDocument,r=t.type,i=(($=t.composedPath)==null?void 0:$.call(t))||[],o=i[0]||t.target,a=0,s=t.__root;if(s){var d=i.indexOf(s);if(d!==-1&&(e===document||e===window)){t.__root=e;return}var c=i.indexOf(e);if(c===-1)return;d<=c&&(a=d)}if(o=i[a]||t.target,o!==e){ol(t,"currentTarget",{configurable:!0,get(){return o||n}});var l=ne,h=te;hn(null),gn(null);try{for(var u,g=[];o!==null;){var p=o.assignedSlot||o.parentNode||o.host||null;try{var v=o["__"+r];if(v!==void 0&&!o.disabled)if(so(v)){var[y,...m]=v;y.apply(o,[t,...m])}else v.call(o,t)}catch(C){u?g.push(C):u=C}if(t.cancelBubble||p===e||p===null)break;o=p}if(u){for(let C of g)queueMicrotask(()=>{throw C});throw u}}finally{t.__root=e,delete t.currentTarget,hn(l),gn(h)}}}function xa(t){var e=document.createElement("template");return e.innerHTML=t,e.content}function ii(t,e){var n=te;n.nodes_start===null&&(n.nodes_start=t,n.nodes_end=e)}function $t(t,e){var n=(e&xu)!==0,r=(e&bu)!==0,i,o=!t.startsWith("<!>");return()=>{i===void 0&&(i=xa(o?t:"<!>"+t),n||(i=tr(i)));var a=r||vl?document.importNode(i,!0):i.cloneNode(!0);if(n){var s=tr(a),d=a.lastChild;ii(s,d)}else ii(a,a);return a}}function ba(t,e,n="svg"){var r=!t.startsWith("<!>"),i=`<${n}>${r?t:"<!>"+t}</${n}>`,o;return()=>{if(!o){var a=xa(i),s=tr(a);o=tr(s)}var d=o.cloneNode(!0);return ii(d,d),d}}function se(){var t=document.createDocumentFragment(),e=document.createComment(""),n=pa();return t.append(e,n),ii(e,n),t}function nt(t,e){t!==null&&t.before(e)}let qo=!0;function lt(t,e){var n=e==null?"":typeof e=="object"?e+"":e;n!==(t.__t??(t.__t=t.nodeValue))&&(t.__t=n,t.nodeValue=n+"")}function ju(t,e){return tf(t,e)}const sr=new Map;function tf(t,{target:e,anchor:n,props:r={},events:i,context:o,intro:a=!0}){zu();var s=new Set,d=h=>{for(var u=0;u<h.length;u++){var g=h[u];if(!s.has(g)){s.add(g);var p=Ku(g);e.addEventListener(g,Kr,{passive:p});var v=sr.get(g);v===void 0?(document.addEventListener(g,Kr,{passive:p}),sr.set(g,1)):sr.set(g,v+1)}}};d(ua(Ju)),Qa.add(d);var c=void 0,l=Lu(()=>{var h=n??e.appendChild(pa());return xr(()=>{if(o){ke({});var u=Yt;u.c=o}i&&(r.$$events=i),qo=a,c=t(h,r)||{},qo=!0,o&&ze()}),()=>{var p;for(var u of s){e.removeEventListener(u,Kr);var g=sr.get(u);--g===0?(document.removeEventListener(u,Kr),sr.delete(u)):sr.set(u,g)}Qa.delete(d),h!==n&&((p=h.parentNode)==null||p.removeChild(h))}});return ef.set(c,l),c}let ef=new WeakMap;function Ot(t,e,n=!1){var r=t,i=null,o=null,a=Le,s=n?fo:0,d=!1;const c=(h,u=!0)=>{d=!0,l(u,h)},l=(h,u)=>{a!==(a=h)&&(a?(i?Hi(i):u&&(i=xr(()=>u(r))),o&&Ui(o,()=>{o=null})):(o?Hi(o):u&&(o=xr(()=>u(r))),i&&Ui(i,()=>{i=null})))};vo(()=>{d=!1,e(c),d||l(null,null)},s)}function mr(t,e){return e}function nf(t,e,n,r){for(var i=[],o=e.length,a=0;a<o;a++)va(e[a].e,i,!0);var s=o>0&&i.length===0&&n!==null;if(s){var d=n.parentNode;Mu(d),d.append(n),r.clear(),Dn(t,e[0].prev,e[o-1].next)}kl(i,()=>{for(var c=0;c<o;c++){var l=e[c];s||(r.delete(l.k),Dn(t,l.prev,l.next)),Cn(l.e,!s)}})}function Hn(t,e,n,r,i,o=null){var a=t,s={flags:e,items:new Map,first:null},d=(e&gl)!==0;if(d){var c=t;a=c.appendChild(pa())}var l=null,h=!1,u=ie(()=>{var g=n();return so(g)?g:g==null?[]:ua(g)});vo(()=>{var g=f(u),p=g.length;h&&p===0||(h=p===0,rf(g,s,a,i,e,r,n),o!==null&&(p===0?l?Hi(l):l=xr(()=>o(a)):l!==null&&Ui(l,()=>{l=null})),f(u))})}function rf(t,e,n,r,i,o,a){var W,X,k,F;var s=(i&du)!==0,d=(i&(ha|ga))!==0,c=t.length,l=e.items,h=e.first,u=h,g,p=null,v,y=[],m=[],$,C,T,x;if(s)for(x=0;x<c;x+=1)$=t[x],C=o($,x),T=l.get(C),T!==void 0&&((W=T.a)==null||W.measure(),(v??(v=new Set)).add(T));for(x=0;x<c;x+=1){if($=t[x],C=o($,x),T=l.get(C),T===void 0){var _=u?u.e.nodes_start:n;p=af(_,e,p,p===null?e.first:p.next,$,C,x,r,i,a),l.set(C,p),y=[],m=[],u=p.next;continue}if(d&&of(T,$,x,i),(T.e.f&Tn)!==0&&(Hi(T.e),s&&((X=T.a)==null||X.unfix(),(v??(v=new Set)).delete(T))),T!==u){if(g!==void 0&&g.has(T)){if(y.length<m.length){var z=m[0],N;p=z.prev;var U=y[0],b=y[y.length-1];for(N=0;N<y.length;N+=1)ja(y[N],z,n);for(N=0;N<m.length;N+=1)g.delete(m[N]);Dn(e,U.prev,b.next),Dn(e,p,U),Dn(e,b,z),u=z,p=b,x-=1,y=[],m=[]}else g.delete(T),ja(T,u,n),Dn(e,T.prev,T.next),Dn(e,T,p===null?e.first:p.next),Dn(e,p,T),p=T;continue}for(y=[],m=[];u!==null&&u.k!==C;)(u.e.f&Tn)===0&&(g??(g=new Set)).add(u),m.push(u),u=u.next;if(u===null)continue;T=u}y.push(T),p=T,u=T.next}if(u!==null||g!==void 0){for(var I=g===void 0?[]:ua(g);u!==null;)(u.e.f&Tn)===0&&I.push(u),u=u.next;var S=I.length;if(S>0){var R=(i&gl)!==0&&c===0?n:null;if(s){for(x=0;x<S;x+=1)(k=I[x].a)==null||k.measure();for(x=0;x<S;x+=1)(F=I[x].a)==null||F.fix()}nf(e,I,R,l)}}s&&yo(()=>{var q;if(v!==void 0)for(T of v)(q=T.a)==null||q.apply()}),te.first=e.first&&e.first.e,te.last=p&&p.e}function of(t,e,n,r){(r&ha)!==0&&ti(t.v,e),(r&ga)!==0?ti(t.i,n):t.i=n}function af(t,e,n,r,i,o,a,s,d,c){var l=(d&ha)!==0,h=(d&hu)===0,u=l?h?go(i):Xe(i):i,g=(d&ga)===0?a:Xe(a),p={i:g,v:u,k:o,a:null,e:null,prev:n,next:r};try{return p.e=xr(()=>s(t,u,g,c),ml),p.e.prev=n&&n.e,p.e.next=r&&r.e,n===null?e.first=p:(n.next=p,n.e.next=p.e),r!==null&&(r.prev=p,r.e.prev=p.e),p}finally{}}function ja(t,e,n){for(var r=t.next?t.next.e.nodes_start:n,i=e?e.e.nodes_start:n,o=t.e.nodes_start;o!==r;){var a=po(o);i.before(o),o=a}}function Dn(t,e,n){e===null?t.first=n:(e.next=n,e.e.next=n&&n.e),n!==null&&(n.prev=e,n.e.prev=e&&e.e)}function Rl(t,e,n,r,i){var o=t,a="",s;vo(()=>{a!==(a=e()??"")&&(s!==void 0&&(Cn(s),s=void 0),a!==""&&(s=xr(()=>{var d=a+"",c=xa(d);ii(tr(c),c.lastChild),o.before(c)})))})}function Pl(t,e,n,r,i){var s;var o=(s=e.$$slots)==null?void 0:s[n],a=!1;o===!0&&(o=e.children,a=!0),o===void 0?i!==null&&i(t):o(t,a?()=>r:r)}function ts(t,e){var n=t.__attributes??(t.__attributes={});n.value===(n.value=e??void 0)||t.value===e&&(e!==0||t.nodeName!=="PROGRESS")||(t.value=e??"")}function ye(t,e,n,r){var i=t.__attributes??(t.__attributes={});i[e]!==(i[e]=n)&&(e==="style"&&"__styles"in t&&(t.__styles={}),e==="loading"&&(t[tu]=n),n==null?t.removeAttribute(e):typeof n!="string"&&sf(t).includes(e)?t[e]=n:t.setAttribute(e,n))}var es=new Map;function sf(t){var e=es.get(t.nodeName);if(e)return e;es.set(t.nodeName,e=[]);for(var n,r=t,i=Element.prototype;i!==r;){n=al(r);for(var o in n)n[o].set&&e.push(o);r=fa(r)}return e}function wo(t,e,n){var r=t.__className,i=lf(e);(r!==i||ml)&&(e==null?t.removeAttribute("class"):t.className=i,t.__className=i)}function lf(t,e){return(t??"")+""}function cf(t,e,n){if(n){if(t.classList.contains(e))return;t.classList.add(e)}else{if(!t.classList.contains(e))return;t.classList.remove(e)}}const uf=()=>performance.now(),_n={tick:t=>requestAnimationFrame(t),now:()=>uf(),tasks:new Set};function Ul(){const t=_n.now();_n.tasks.forEach(e=>{e.c(t)||(_n.tasks.delete(e),e.f())}),_n.tasks.size!==0&&_n.tick(Ul)}function ff(t){let e;return _n.tasks.size===0&&_n.tick(Ul),{promise:new Promise(n=>{_n.tasks.add(e={c:t,f:n})}),abort(){_n.tasks.delete(e)}}}function yi(t,e){_a(()=>{t.dispatchEvent(new CustomEvent(e))})}function df(t){if(t==="float")return"cssFloat";if(t==="offset")return"cssOffset";if(t.startsWith("--"))return t;const e=t.split("-");return e.length===1?e[0]:e[0]+e.slice(1).map(n=>n[0].toUpperCase()+n.slice(1)).join("")}function ns(t){const e={},n=t.split(";");for(const r of n){const[i,o]=r.split(":");if(!i||o===void 0)break;const a=df(i.trim());e[a]=o.trim()}return e}const hf=t=>t;function gf(t,e,n,r){var i=(t&_u)!==0,o="both",a,s=e.inert,d=e.style.overflow,c,l;function h(){var y=ne,m=te;hn(null),gn(null);try{return a??(a=n()(e,(r==null?void 0:r())??{},{direction:o}))}finally{hn(y),gn(m)}}var u={is_global:i,in(){e.inert=s,yi(e,"introstart"),c=Yo(e,h(),l,1,()=>{yi(e,"introend"),c==null||c.abort(),c=a=void 0,e.style.overflow=d})},out(y){e.inert=!0,yi(e,"outrostart"),l=Yo(e,h(),c,0,()=>{yi(e,"outroend"),y==null||y()})},stop:()=>{c==null||c.abort(),l==null||l.abort()}},g=te;if((g.transitions??(g.transitions=[])).push(u),qo){var p=i;if(!p){for(var v=g.parent;v&&(v.f&fo)!==0;)for(;(v=v.parent)&&(v.f&co)===0;);p=!v||(v.f&ll)!==0}p&&Er(()=>{Ve(()=>u.in())})}}function Yo(t,e,n,r,i){var o=r===1;if(Zc(e)){var a,s=!1;return yo(()=>{if(!s){var y=e({direction:o?"in":"out"});a=Yo(t,y,n,r,i)}}),{abort:()=>{s=!0,a==null||a.abort()},deactivate:()=>a.deactivate(),reset:()=>a.reset(),t:()=>a.t()}}if(n==null||n.deactivate(),!(e!=null&&e.duration))return i(),{abort:Re,deactivate:Re,reset:Re,t:()=>r};const{delay:d=0,css:c,tick:l,easing:h=hf}=e;var u=[];if(o&&n===void 0&&(l&&l(0,1),c)){var g=ns(c(0,1));u.push(g,g)}var p=()=>1-r,v=t.animate(u,{duration:d});return v.onfinish=()=>{var y=(n==null?void 0:n.t())??1-r;n==null||n.abort();var m=r-y,$=e.duration*Math.abs(m),C=[];if($>0){var T=!1;if(c)for(var x=Math.ceil($/16.666666666666668),_=0;_<=x;_+=1){var z=y+m*h(_/x),N=ns(c(z,1-z));C.push(N),T||(T=N.overflow==="hidden")}T&&(t.style.overflow="hidden"),p=()=>{var U=v.currentTime;return y+m*h(U/$)},l&&ff(()=>{if(v.playState!=="running")return!1;var U=p();return l(U,1-U),!0})}v=t.animate(C,{duration:$,fill:"forwards"}),v.onfinish=()=>{p=()=>r,l==null||l(r,1-r),i()}},{abort:()=>{v&&(v.cancel(),v.effect=null,v.onfinish=Re)},deactivate:()=>{i=Re},reset:()=>{r===0&&(l==null||l(1,0))},t:()=>p()}}function _i(t,e,n){var r=Qn(t,e);r&&r.set&&(t[e]=n,ma(()=>{t[e]=null}))}function oi(t,e,n){if(t.multiple)return pf(t,e);for(var r of t.options){var i=jr(r);if(ku(i,e)){r.selected=!0;return}}(!n||e!==void 0)&&(t.selectedIndex=-1)}function Go(t,e){let n=!0;Er(()=>{e&&oi(t,Ve(e),n),n=!1;var r=new MutationObserver(()=>{var i=t.__value;oi(t,i)});return r.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{r.disconnect()}})}function rs(t,e,n=e){var r=!0;Zu(t,"change",i=>{var o=i?"[selected]":":checked",a;if(t.multiple)a=[].map.call(t.querySelectorAll(o),jr);else{var s=t.querySelector(o)??t.querySelector("option:not([disabled])");a=s&&jr(s)}n(a)}),Er(()=>{var i=e();if(oi(t,i,r),r&&i===void 0){var o=t.querySelector(":checked");o!==null&&(i=jr(o),n(i))}t.__value=i,r=!1}),Go(t)}function pf(t,e){for(var n of t.options)n.selected=~e.indexOf(jr(n))}function jr(t){return"__value"in t?t.__value:t.value}function is(t,e){return t===e||(t==null?void 0:t[$n])===e}function We(t={},e,n,r){return Er(()=>{var i,o;return mo(()=>{i=o,o=[],Ve(()=>{t!==n(...o)&&(e(t,...o),i&&is(n(...i),t)&&e(null,...i))})}),()=>{yo(()=>{o&&is(n(...o),t)&&e(null,...o)})}}),t}function Ue(t=!1){const e=Yt,n=e.l.u;if(!n)return;let r=()=>De(e.s);if(t){let i=0,o={};const a=ei(()=>{let s=!1;const d=e.s;for(const c in d)d[c]!==o[c]&&(o[c]=d[c],s=!0);return s&&i++,i});r=()=>f(a)}n.b.length&&Iu(()=>{os(e,r),Fi(n.b)}),Oo(()=>{const i=Ve(()=>n.m.map(Jc));return()=>{for(const o of i)typeof o=="function"&&o()}}),n.a.length&&Oo(()=>{os(e,r),Fi(n.a)})}function os(t,e){if(t.l.s)for(const n of t.l.s)f(n);e()}function wa(t,e,n){if(t==null)return e(void 0),n&&n(void 0),Re;const r=Ve(()=>t.subscribe(e,n));return r.unsubscribe?()=>r.unsubscribe():r}const lr=[];function mf(t,e){return{subscribe:Ta(t,e).subscribe}}function Ta(t,e=Re){let n=null;const r=new Set;function i(s){if(dl(t,s)&&(t=s,n)){const d=!lr.length;for(const c of r)c[1](),lr.push(c,t);if(d){for(let c=0;c<lr.length;c+=2)lr[c][0](lr[c+1]);lr.length=0}}}function o(s){i(s(t))}function a(s,d=Re){const c=[s,d];return r.add(c),r.size===1&&(n=e(i,o)||Re),s(t),()=>{r.delete(c),r.size===0&&n&&(n(),n=null)}}return{set:i,update:o,subscribe:a}}function vf(t,e,n){const r=!Array.isArray(t),i=r?[t]:t;if(!i.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const o=e.length<2;return mf(n,(a,s)=>{let d=!1;const c=[];let l=0,h=Re;const u=()=>{if(l)return;h();const p=e(r?c[0]:c,a,s);o?a(p):h=typeof p=="function"?p:Re},g=i.map((p,v)=>wa(p,y=>{c[v]=y,l&=~(1<<v),d&&u()},()=>{l|=1<<v}));return d=!0,u(),function(){Fi(g),h(),d=!1}})}function Hl(t){let e;return wa(t,n=>e=n)(),e}let xi=!1,Ko=Symbol();function xt(t,e,n){const r=n[e]??(n[e]={store:null,source:go(void 0),unsubscribe:Re});if(r.store!==t&&!(Ko in n))if(r.unsubscribe(),r.store=t??null,t==null)r.source.v=void 0,r.unsubscribe=Re;else{var i=!0;r.unsubscribe=wa(t,o=>{i?r.source.v=o:D(r.source,o)}),i=!1}return t&&Ko in n?Hl(t):f(r.source)}function bi(t,e,n){let r=n[e];return r&&r.store!==t&&(r.unsubscribe(),r.unsubscribe=Re),t}function on(){const t={};function e(){ma(()=>{for(var n in t)t[n].unsubscribe();ol(t,Ko,{enumerable:!1,value:!0})})}return[t,e]}function yf(t){var e=xi;try{return xi=!1,[t(),xi]}finally{xi=e}}function ee(t,e,n,r){var z;var i=(n&gu)!==0,o=!Mr||(n&pu)!==0,a=(n&vu)!==0,s=(n&yu)!==0,d=!1,c;a?[c,d]=yf(()=>t[e]):c=t[e];var l=$n in t||jc in t,h=a&&(((z=Qn(t,e))==null?void 0:z.set)??(l&&e in t&&(N=>t[e]=N)))||void 0,u=r,g=!0,p=!1,v=()=>(p=!0,g&&(g=!1,s?u=Ve(r):u=r),u);c===void 0&&r!==void 0&&(h&&o&&ou(),c=v(),h&&h(c));var y;if(o)y=()=>{var N=t[e];return N===void 0?v():(g=!0,p=!1,N)};else{var m=(i?ei:ie)(()=>t[e]);m.f|=cl,y=()=>{var N=f(m);return N!==void 0&&(u=void 0),N===void 0?u:N}}if((n&mu)===0)return y;if(h){var $=t.$$legacy;return function(N,U){return arguments.length>0?((!o||!U||$||d)&&h(U?y():N),N):y()}}var C=!1,T=!1,x=go(c),_=ei(()=>{var N=y(),U=f(x);return C?(C=!1,T=!0,U):(T=!1,x.v=N)});return i||(_.equals=da),function(N,U){if(Fn!==null&&(C=T,y(),f(x)),arguments.length>0){const b=U?f(_):o&&a?ur(N):N;return _.equals(b)||(C=!0,D(x,b),p&&u!==void 0&&(u=b),Ve(()=>f(_))),N}return f(_)}}function Ye(t){Yt===null&&Ar(),Mr&&Yt.l!==null?$a(Yt).m.push(t):Oo(()=>{const e=Ve(t);if(typeof e=="function")return e})}function In(t){Yt===null&&Ar(),Ye(()=>()=>Ve(t))}function _f(t,e,{bubbles:n=!1,cancelable:r=!1}={}){return new CustomEvent(t,{detail:e,bubbles:n,cancelable:r})}function Bl(){const t=Yt;return t===null&&Ar(),(e,n,r)=>{var o;const i=(o=t.s.$$events)==null?void 0:o[e];if(i){const a=so(i)?i.slice():[i],s=_f(e,n,r);for(const d of a)d.call(t.x,s);return!s.defaultPrevented}return!0}}function xf(t){Yt===null&&Ar(),Yt.l===null&&hl(),$a(Yt).b.push(t)}function bf(t){Yt===null&&Ar(),Yt.l===null&&hl(),$a(Yt).a.push(t)}function $a(t){var e=t.l;return e.u??(e.u={a:[],b:[],m:[]})}const wf="5";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(wf);fu();let Br=null;const{subscribe:Tf,set:$f,update:as}=Ta({items:[],loading:!1,error:null}),fe={subscribe:Tf,loadItems:async()=>Br||(as(t=>({...t,loading:!0,error:null})),Br=(async()=>{try{const e=await(await fetch("/IWAC-overview/items.json")).json();return $f({items:e,loading:!1,error:null}),e}catch(t){const e=t instanceof Error?t.message:"Failed to load items";throw as(n=>({...n,loading:!1,error:e})),t}finally{Br=null}})(),Br)},Ol={en:{"app.title":"<i>Islam West Africa Collection</i> Overview","tab.countries":"Country distribution","tab.languages":"Languages","tab.timeline":"Collection growth","tab.types":"Type distribution","tab.categories":"Index","tab.words":"Word count","ui.loading":"Loading database...","ui.select_visualization":"Select a visualization from the tabs above","ui.toggle_language":"Français","ui.show_description":"Show description","ui.hide_description":"Hide description","ui.no_visualization_content":"No visualization content available","ui.enter_fullscreen":"Enter fullscreen mode","ui.exit_fullscreen":"Exit fullscreen mode","ui.download_visualization":"Download visualization","viz.summary":"Summary","viz.total_items":"Total items","viz.number_of_categories":"Number of categories","viz.top_categories":"Top Categories","viz.filter_by_country":"Filter by Country","viz.filter_by_type":"Filter by Type","viz.showing_items":"Showing {0} items in {1} languages","viz.all_countries":"All Countries","viz.all_types":"All Types","viz.no_data":"No data available with the current filters","viz.distribution_items":"Distribution of {0} items by country and sub-collection","viz.language_distribution_title":"Language Distribution","viz.language_distribution_items":"Distribution of {0} items by language","viz.language_distribution_description":"This visualization shows the distribution of items by language. You can filter by country and item type to explore the language distribution across different segments of the collection.","viz.chart_type":"Chart Type","viz.pie_chart":"Switch to Pie Chart","viz.donut_chart":"Switch to Donut Chart","viz.items_added_since_april":"Added {0} items since April 2024","viz.items_added_since_april_title":"Growth since April 2024","viz.growth_since_april_title":"Growth Since April 2024","viz.growth_since_april":"Growth of {0} items since April 2024","viz.growth_since_april_description":"This visualization shows the growth of the database since April 2024. The blue line represents monthly additions, while the green dotted line shows the cumulative total. You can filter by country and item type to explore growth patterns.","viz.time_period":"Time period","viz.avg_monthly_additions":"Average monthly additions","viz.peak_growth_months":"Peak Growth Months","viz.showing_items_over_months":"Showing {0} items over {1} months","viz.months":"months","viz.monthly_additions":"Monthly Additions","viz.month":"Month","viz.new_items":"New Items","viz.percentage":"Percentage","viz.publication_year":"Publication Year","viz.year":"Year","viz.number_of_items":"Number of Items","viz.toggle_types":"Toggle Types","viz.toggle_languages":"Toggle Languages","viz.toggled_type":"Toggled type: {0}","viz.languages":"Languages","viz.country_distribution_title":"Country Distribution","viz.country_distribution_description":"This visualization shows the distribution of items by country and sub-collection. You can click on any country block to zoom in and see its sub-collections. The size of each block represents the number of items in that country or sub-collection.","viz.country.items":"Items","viz.country.percent_parent":"% of Parent","viz.country.percent_total":"% of Total","viz.country.click_zoom_in":"Click to zoom in","viz.country.click_zoom_out":"Click to zoom out","viz.country.unknown":"Unknown","viz.country.no_set":"No Set","viz.countries":"Countries","viz.sub_collections":"Sub-collections","viz.currently_viewing":"Currently viewing","viz.click_back_to_return":'Click the "Back to All" button to return to the full view',"viz.click_zoom_in":"Click on a country block to zoom in","viz.unknown":"Unknown","viz.no_set":"No Set","viz.word_distribution":"Word Distribution","viz.total_words":"Total Words","viz.avg_words_per_item":"Average words per Item","viz.back_to_all":"← Back to All","viz.total_items_with_word_count":"Total items with word count","viz.word_distribution_subtitle":"Word Distribution by Country and Item Set ({0} items, {1} words)","viz.word_distribution_description":"This visualization shows the distribution of words across items by country and collection. The size of each block represents the word count in that country or collection.","viz.words":"words","viz.items":"items","viz.percent_of_country":"% of country","viz.percent_of_total":"% of total","viz.item_set_summary":"Item Set Summary","lang.Français":"French","lang.Anglais":"English","lang.Haoussa":"Hausa","lang.Allemand":"German","lang.Arabe":"Arabic","lang.Italien":"Italian","lang.Dendi":"Dendi","lang.Slovène":"Slovenian","lang.Espagnol":"Spanish","country.all":"All Countries","country.Bénin":"Benin","country.Nigéria":"Nigeria","country.Côte d'Ivoire":"Côte d'Ivoire","country.Burkina Faso":"Burkina Faso","country.Togo":"Togo","country.Niger":"Niger","country.Unknown":"Unknown","type.Article de presse":"Press article","type.Notice d'autorité":"Authority record","type.Périodique islamique":"Islamic periodical","type.Unknown":"Unknown","type.Article de revue":"Journal article","type.Document":"Document","type.Article de blog":"Blog post","type.Chapitre de livre":"Book chapter","type.Livre":"Book","type.Thèse de doctorat":"Doctoral thesis","type.Communication scientifique":"Scientific communication","type.Article d'encyclopédie":"Encyclopedia article","type.Compte rendu de livre":"Book review","type.Enregistrement vidéo":"Video recording","type.Mémoire de licence":"Bachelor's thesis","type.Mémoire de maitrise":"Master's thesis","type.Photographie":"Photograph","type.Rapport":"Report","type.Working paper":"Working paper","type.all":"All types","viz.index_distribution_title":"Index Distribution","viz.index_distribution_items":"Distribution of {0} index items by category","viz.index_distribution_description":"This visualization shows the distribution of index items by category. The size of each bar represents the number of items in that category. Index items are authority records that serve as reference points in the database.","viz.categories":"Categories","viz.uncategorized":"Uncategorized","viz.type_distribution_title":"Type Distribution","viz.type_distribution_items":"Distribution of {0} items by type","viz.type_distribution_description":"This visualization shows the distribution of items by type over time. You can filter by country and year range to explore how different types of items have been published over time.","viz.types":"Types","viz.published_between":"published between {0} and {1}","viz.type":"Type","viz.count":"Count","viz.others":"Others","category.Events":"Events","category.Locations":"Locations","category.Organizations":"Organizations","category.Persons":"Persons","category.Topics":"Topics","category.Authority Files":"Authority files"},fr:{"app.title":"Aperçu de la <i>Collection Islam Afrique de l'Ouest</i>","tab.countries":"Répartition par pays","tab.languages":"Langues","tab.timeline":"Croissance collection","tab.types":"Répartition par type","tab.categories":"Index","tab.words":"Nombre de mots","ui.loading":"Chargement de la base de données...","ui.select_visualization":"Sélectionnez une visualisation dans les onglets ci-dessus","ui.toggle_language":"English","ui.show_description":"Afficher la description","ui.hide_description":"Masquer la description","ui.no_visualization_content":"Aucun contenu de visualisation disponible","ui.enter_fullscreen":"Passer en mode plein écran","ui.exit_fullscreen":"Quitter le mode plein écran","ui.download_visualization":"Télécharger la visualisation","viz.summary":"Résumé","viz.total_items":"Nombre total d'éléments","viz.number_of_categories":"Nombre de catégories","viz.top_categories":"Principales catégories","viz.filter_by_country":"Filtrer par pays","viz.filter_by_type":"Filtrer par type","viz.showing_items":"Affichage de {0} éléments dans {1} langues","viz.all_countries":"Tous les pays","viz.all_types":"Tous les types","viz.no_data":"Aucune donnée disponible avec les filtres actuels","viz.distribution_items":"Répartition de {0} éléments par pays et sous-collection","viz.language_distribution_title":"Répartition par langue","viz.language_distribution_items":"Répartition de {0} éléments par langue","viz.language_distribution_description":"Cette visualisation montre la répartition des éléments par langue. Vous pouvez filtrer par pays et par type d'élément pour explorer la répartition des langues dans différents segments de la collection.","viz.chart_type":"Type de graphique","viz.pie_chart":"Passer au graphique en secteurs","viz.donut_chart":"Passer au graphique en anneau","viz.items_added_since_april":"{0} éléments ajoutés depuis avril 2024","viz.items_added_since_april_title":"Croissance depuis avril 2024","viz.growth_since_april_title":"Croissance depuis avril 2024","viz.growth_since_april":"Croissance de {0} éléments depuis avril 2024","viz.growth_since_april_description":"Cette visualisation montre la croissance de la base de données depuis avril 2024. La ligne bleue représente les ajouts mensuels, tandis que la ligne pointillée verte montre le total cumulatif. Vous pouvez filtrer par pays et par type d'élément pour explorer les modèles de croissance.","viz.time_period":"Période","viz.avg_monthly_additions":"Ajouts mensuels moyens","viz.peak_growth_months":"Mois de croissance maximale","viz.showing_items_over_months":"Affichage de {0} éléments sur {1} mois","viz.months":"mois","viz.monthly_additions":"Ajouts mensuels","viz.month":"Mois","viz.new_items":"Nouveaux Éléments","viz.percentage":"Pourcentage","viz.publication_year":"Année de publication","viz.year":"Année","viz.number_of_items":"Nombre d'éléments","viz.toggle_types":"Basculer les types","viz.toggle_languages":"Basculer les langues","viz.toggled_type":"Type basculé : {0}","viz.languages":"Langues","viz.country_distribution_title":"Répartition par pays","viz.country_distribution_description":"Cette visualisation montre la répartition des éléments par pays et sous-collection. Vous pouvez cliquer sur n'importe quel bloc pays pour zoomer et voir ses sous-collections. La taille de chaque bloc représente le nombre d'éléments dans ce pays ou cette sous-collection.","viz.country.items":"Éléments","viz.country.percent_parent":"% du parent","viz.country.percent_total":"% du total","viz.country.click_zoom_in":"Cliquer pour zoomer","viz.country.click_zoom_out":"Cliquer pour dézoomer","viz.country.unknown":"Inconnu","viz.country.no_set":"Sans ensemble","viz.countries":"Pays","viz.sub_collections":"Sous-collections","viz.currently_viewing":"Affichage actuel","viz.click_back_to_return":'Cliquez sur le bouton "Retour à tous" pour revenir à la vue complète',"viz.click_zoom_in":"Cliquez sur un bloc pays pour zoomer","viz.unknown":"Inconnu","viz.no_set":"Sans ensemble","viz.word_distribution":"Répartition des mots","viz.total_words":"Nombre total de mots","viz.avg_words_per_item":"Moyenne de mots par élément","viz.back_to_all":"← Retour à tous","viz.total_items_with_word_count":"Total des éléments avec nombre de mots","viz.word_distribution_subtitle":"Répartition des mots par pays et ensemble d'éléments ({0} éléments, {1} mots)","viz.word_distribution_description":"Cette visualisation montre la répartition des mots dans les éléments par pays et collection. La taille de chaque bloc représente le nombre de mots dans ce pays ou cette collection.","viz.words":"mots","viz.items":"éléments","viz.percent_of_country":"% du pays","viz.percent_of_total":"% du total","viz.item_set_summary":"Résumé de l'ensemble d'éléments","lang.Français":"Français","lang.Anglais":"Anglais","lang.Haoussa":"Haoussa","lang.Allemand":"Allemand","lang.Arabe":"Arabe","lang.Italien":"Italien","lang.Dendi":"Dendi","lang.Slovène":"Slovène","lang.Espagnol":"Espagnol","country.all":"Tous les pays","country.Bénin":"Bénin","country.Nigéria":"Nigéria","country.Côte d'Ivoire":"Côte d'Ivoire","country.Burkina Faso":"Burkina Faso","country.Togo":"Togo","country.Niger":"Niger","country.Unknown":"Inconnu","type.Article de presse":"Article de presse","type.Notice d'autorité":"Notice d'autorité","type.Périodique islamique":"Périodique islamique","type.Unknown":"Inconnu","type.Article de revue":"Article de revue","type.Document":"Document","type.Article de blog":"Article de blog","type.Chapitre de livre":"Chapitre de livre","type.Livre":"Livre","type.Thèse de doctorat":"Thèse de doctorat","type.Communication scientifique":"Communication scientifique","type.Article d'encyclopédie":"Article d'encyclopédie","type.Compte rendu de livre":"Compte rendu de livre","type.Enregistrement vidéo":"Enregistrement vidéo","type.Mémoire de licence":"Mémoire de licence","type.Mémoire de maitrise":"Mémoire de maitrise","type.Photographie":"Photographie","type.Rapport":"Rapport","type.Working paper":"Working paper","type.all":"Tous les types","viz.index_distribution_title":"Répartition des index","viz.index_distribution_items":"Répartition de {0} éléments d'index par catégorie","viz.index_distribution_description":"Cette visualisation montre la répartition des éléments d'index par catégorie. La taille de chaque barre représente le nombre d'éléments dans cette catégorie. Les éléments d'index sont des notices d'autorité qui servent de points de référence dans la base de données.","viz.categories":"Catégories","viz.uncategorized":"Non catégorisé","viz.type_distribution_title":"Répartition par type","viz.type_distribution_items":"Répartition de {0} éléments par type","viz.type_distribution_description":"Cette visualisation montre la répartition des éléments par type au fil du temps. Vous pouvez filtrer par pays et par plage d'années pour explorer comment différents types d'éléments ont été publiés au fil du temps.","viz.types":"Types","viz.published_between":"publiés entre {0} et {1}","viz.type":"Type","viz.count":"Nombre","viz.others":"Autres","category.Events":"Événements","category.Locations":"Lieux","category.Organizations":"Organisations","category.Persons":"Personnes","category.Topics":"Sujets","category.Authority Files":"Notices d'autorité"}};function Cf(){const{subscribe:t,set:e,update:n}=Ta("en"),r=typeof window<"u"&&window.location.hostname==="localhost";return{subscribe:t,setLanguage:i=>{r&&console.log("[Translation] Language changed to:",i),e(i)},toggleLanguage:()=>n(i=>i==="en"?"fr":"en")}}const xe=Cf();function Vl(t,e){return e?t.replace(/{(\d+)}/g,(n,r)=>{const i=parseInt(r);return i<Object.keys(e).length?e[i].toString():n}):t}const ot=(t,e)=>{var i;const n=Hl(xe),r=((i=Ol[n])==null?void 0:i[t])||t;return Vl(r,e)},rt=(t,e)=>vf(xe,n=>{var i;const r=((i=Ol[n])==null?void 0:i[t])||t;return Vl(r,e)});var kf=$t('<button class="btn btn-primary text-sm"> </button>');function zf(t,e){ke(e,!1);const[n,r]=on(),i=()=>xt(o,"$toggleText",n),o=rt("ui.toggle_language");function a(){xe.toggleLanguage()}Ue();var s=kf(),d=L(s);It(()=>lt(d,i())),_e("click",s,a),nt(t,s),ze(),r()}var Mf=ba('<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1laafbv"><path d="M8 3v3a2 2 0 0 1-2 2H3"></path><path d="M21 8h-3a2 2 0 0 1-2-2V3"></path><path d="M3 16h3a2 2 0 0 1 2 2v3"></path><path d="M16 21v-3a2 2 0 0 1 2-2h3"></path></svg>'),Af=ba('<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1laafbv"><path d="M8 3H5a2 2 0 0 0-2 2v3"></path><path d="M21 8V5a2 2 0 0 0-2-2h-3"></path><path d="M3 16v3a2 2 0 0 0 2 2h3"></path><path d="M16 21h3a2 2 0 0 0 2-2v-3"></path></svg>'),Sf=$t('<button class="btn btn-primary btn-icon"><!></button>');function Ef(t,e){ke(e,!1);let n=bt(!1);function r(){document.fullscreenElement?document.exitFullscreen&&document.exitFullscreen():document.documentElement.requestFullscreen().catch(l=>{console.error(`Error attempting to enable fullscreen: ${l.message}`),i()&&console.warn('This application is in an iframe. Make sure the iframe has the "allowfullscreen" attribute.')})}function i(){try{return window.self!==window.top}catch{return!0}}function o(){D(n,!!document.fullscreenElement)}Ye(()=>(document.addEventListener("fullscreenchange",o),()=>{document.removeEventListener("fullscreenchange",o)})),Ue();var a=Sf(),s=L(a);{var d=l=>{var h=Mf();nt(l,h)},c=l=>{var h=Af();nt(l,h)};Ot(s,l=>{f(n)?l(d):l(c,!1)})}It(l=>{ye(a,"title",l),ye(a,"aria-label",l)},[()=>f(n)?ot("ui.exit_fullscreen"):ot("ui.enter_fullscreen")],ie),_e("click",a,r),nt(t,a),ze()}var If=$t('<button class="btn btn-primary btn-icon"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1laafbv"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg></button>');function Lf(t,e){ke(e,!1);function n(){var h,u,g,p;const l=document.querySelector(".visualization-content svg");if(!l){console.error("No SVG found to download");return}try{const v=l.cloneNode(!0),y=document.querySelector(".visualization-header h2");let m="";if(y&&(m=((h=y.textContent)==null?void 0:h.trim())||"",m||(m=((u=y.innerText)==null?void 0:u.trim())||""),m.includes("<")&&m.includes(">"))){const I=document.createElement("div");I.innerHTML=y.innerHTML,m=((g=I.textContent)==null?void 0:g.trim())||""}r(v),m&&o(v,m),s(v),d(v);const C=new XMLSerializer().serializeToString(v),T=new Blob([C],{type:"image/svg+xml;charset=utf-8"}),x=URL.createObjectURL(T),_=document.createElement("a");_.href=x;const z=document.querySelector(".tab-item.active"),N=z?(p=z.textContent)==null?void 0:p.trim():"visualization",b=`iwac-${a(m||N||"visualization")}`;_.download=`${b}.svg`,document.body.appendChild(_),_.click(),document.body.removeChild(_),URL.revokeObjectURL(x)}catch(v){console.error("Error downloading visualization:",v)}}function r(l){const h=Array.from(document.styleSheets),u=document.createElement("style");let g="";const p=getComputedStyle(document.documentElement),v=p.getPropertyValue("--font-family-base")||p.fontFamily||"'Arial', sans-serif";g+=`
            svg {
                font-family: ${v};
                font-size: ${p.fontSize||"14px"};
                line-height: ${p.lineHeight||"1.5"};
            }
        `;let y="";h.forEach(x=>{var _;try{const z=x.cssRules||x.rules;if(z)for(let N=0;N<z.length;N++){const U=z[N];if(U instanceof CSSStyleRule){const b=U.selectorText;b&&(b.includes("svg")||b.includes("g")||b.includes("path")||b.includes("rect")||b.includes("circle")||b.includes("text")||b.includes("line")||b.includes("polyline")||b.includes("polygon")||b.includes("axis")||b.includes("tick")||b.includes("label")||b.includes("legend")||b.includes("chart")||b.includes("bar")||b.includes("plot")||b.includes("point")||b.includes("marker")||b.includes("grid")||b.includes("visualization")||b.includes(".graph")||b.includes(".data")||b.includes(".series")||b.includes(".node")||b.includes(".link")||b.includes(".arc")||b.includes(".slice")||b.includes(".area")||b.includes(".line")||b.includes(".dot")||b.includes(".bubble")||b.includes(".tooltip")||b.includes(".domain")||b.includes(".tick")||/\b(vis|chart|graph|plot|axis|legend|tooltip)\b/i.test(b))&&(g+=U.cssText+`
`)}else if(U instanceof CSSFontFaceRule)y+=U.cssText+`
`;else if(U instanceof CSSImportRule)try{const b=(_=U.styleSheet)==null?void 0:_.cssRules;if(b)for(let I=0;I<b.length;I++)if(b[I]instanceof CSSStyleRule){const S=b[I].selectorText;S&&/\b(svg|g|path|rect|circle|text|line|axis|chart|graph|vis)\b/i.test(S)&&(g+=b[I].cssText+`
`)}else b[I]instanceof CSSFontFaceRule&&(y+=b[I].cssText+`
`)}catch(b){console.warn("Could not process imported stylesheet",b)}}}catch(z){console.warn("Could not access stylesheet rules",z)}});let m=`:root {
`;const $=getComputedStyle(document.documentElement);["--color-primary","--color-primary-dark","--color-primary-300","--color-text-light","--color-text-dark","--color-bg-page","--font-family-base","--font-size-base","--font-size-sm","--font-size-lg","--font-weight-normal","--font-weight-bold","--spacing-sm","--spacing-md","--spacing-lg","--color-text-primary","--color-border","--color-border-light"].forEach(x=>{const _=$.getPropertyValue(x);_&&(m+=`    ${x}: ${_};
`)}),h.forEach(x=>{try{const _=x.cssRules||x.rules;if(_){for(let z=0;z<_.length;z++)if(_[z]instanceof CSSStyleRule){const U=_[z].cssText.match(/var\(--[a-zA-Z0-9_-]+/g);U&&U.forEach(b=>{const I=b.substring(4);if(!m.includes(I)){const S=$.getPropertyValue(I);S&&(m+=`    ${I}: ${S};
`)}})}}}catch{}}),m+=`}
`;const T=y+m+g;if(u.textContent=T,l.firstChild?l.insertBefore(u,l.firstChild):l.appendChild(u),l.setAttribute("xmlns","http://www.w3.org/2000/svg"),l.setAttribute("version","1.1"),l.setAttribute("width",l.getAttribute("width")||"800"),l.setAttribute("height",l.getAttribute("height")||"600"),l.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),!l.style.backgroundColor){const x=p.getPropertyValue("--color-bg-page")||"#ffffff";l.style.backgroundColor=x}i(l)}function i(l){try{const h=l.querySelectorAll("text"),u=new Set;if(h.forEach(g=>{const p=g.getAttribute("font-family")||window.getComputedStyle(g).fontFamily;p&&p.split(",").forEach(v=>{const y=v.trim().replace(/['"]/g,"");y&&!y.includes("serif")&&!y.includes("sans")&&!y.includes("mono")&&!y.includes("Arial")&&!y.includes("Helvetica")&&u.add(y)})}),u.size>0){const g=Array.from(document.querySelectorAll("link")).filter(p=>p.href&&(p.href.includes("fonts.googleapis.com")||p.href.includes("fonts.gstatic.com")));if(g.length>0){const p=document.createComment(` Embedded fonts: ${Array.from(u).join(", ")} `);l.insertBefore(p,l.firstChild),g.forEach(v=>{const y=document.createElementNS("http://www.w3.org/2000/svg","style");y.textContent=`@import url('${v.href}');`,l.insertBefore(y,l.firstChild)})}}}catch(h){console.warn("Could not embed web fonts:",h)}}function o(l,h){const u=document.createElementNS("http://www.w3.org/2000/svg","title");u.textContent=h,l.firstChild?l.insertBefore(u,l.firstChild):l.appendChild(u);const g=parseInt(l.getAttribute("width")||"800");parseInt(l.getAttribute("height")||"600");const p=document.createElementNS("http://www.w3.org/2000/svg","text");p.setAttribute("x",(g/2).toString()),p.setAttribute("y","24"),p.setAttribute("text-anchor","middle"),p.setAttribute("font-family","Arial, sans-serif"),p.setAttribute("font-size","16px"),p.setAttribute("font-weight","bold"),p.setAttribute("fill","var(--color-primary, #333)"),p.textContent=h,l.appendChild(p)}function a(l){let h=l.toLowerCase().replace(/[<>:"/\\|?*\x00-\x1F]/g,"-").replace(/\s+/g,"-").replace(/&/g,"and").replace(/--+/g,"-").replace(/^-+|-+$/g,"");return h.length>50&&(h=h.substring(0,50)),h.replace(/-+$/g,"")}function s(l){l.querySelectorAll("*");const h=getComputedStyle(document.documentElement),u=h.getPropertyValue("--font-family-base")||h.fontFamily||"'Arial', sans-serif";if(l.querySelectorAll("text").forEach(p=>{p.hasAttribute("font-family")||p.setAttribute("font-family",u.replace(/['"]/g,""));const v=p.getAttribute("fill");(!v||v==="none"||v==="transparent")&&p.setAttribute("fill",h.getPropertyValue("--color-text-primary")||"#333333"),p.hasAttribute("font-size")||p.setAttribute("font-size",h.getPropertyValue("--font-size-base")||"14px")}),l.querySelectorAll(".axis path, .axis line, .domain").forEach(p=>{p instanceof SVGElement&&(p.hasAttribute("stroke")||p.setAttribute("stroke",h.getPropertyValue("--color-border")||"#cccccc"))}),l.querySelectorAll(".grid line, .grid path, .tick line").forEach(p=>{p instanceof SVGElement&&(p.hasAttribute("stroke")||p.setAttribute("stroke",h.getPropertyValue("--color-border-light")||"#e5e5e5"))}),l.querySelectorAll(".bar, .line, .area, .point, .mark").forEach(p=>{p instanceof SVGElement&&!p.hasAttribute("fill")&&p.tagName.toLowerCase()!=="line"&&p.setAttribute("fill",h.getPropertyValue("--color-primary")||"#4299e1")}),!l.hasAttribute("viewBox")&&l.hasAttribute("width")&&l.hasAttribute("height")){const p=l.getAttribute("width")||"800",v=l.getAttribute("height")||"600";l.setAttribute("viewBox",`0 0 ${p} ${v}`)}l.style.backgroundColor||(l.style.backgroundColor=h.getPropertyValue("--color-bg-page")||"#ffffff")}function d(l){const h=parseInt(l.getAttribute("width")||"800"),u=parseInt(l.getAttribute("height")||"600"),g=getComputedStyle(document.documentElement),p=g.getPropertyValue("--color-bg-page")||g.getPropertyValue("--color-bg-primary")||"#ffffff",v=document.createElementNS("http://www.w3.org/2000/svg","rect");v.setAttribute("width",h.toString()),v.setAttribute("height",u.toString()),v.setAttribute("x","0"),v.setAttribute("y","0"),v.setAttribute("fill",p);const y=l.firstChild;y?l.insertBefore(v,y):l.appendChild(v),l.style.backgroundColor=p;const m=document.createComment(" Background rectangle added for proper rendering ");l.insertBefore(m,v)}Ue();var c=If();It(l=>{ye(c,"title",l),ye(c,"aria-label",l)},[()=>ot("ui.download_visualization")],ie),_e("click",c,n),nt(t,c),ze()}function Nf(t,e){ke(e,!1);const[n,r]=on(),i=()=>xt(xe,"$languageStore",n),o="TranslationContext";let a=!1,s=()=>{},d=i();wu("translationContext",{componentId:o,getLanguage:()=>d,languageStore:xe});function c(u){a&&(d=u)}Ye(()=>{a=!0,s=xe.subscribe(u=>{c(u)})}),In(()=>{s&&s(),a=!1}),Ue();var l=se(),h=jt(l);Pl(h,e,"default",{},null),nt(t,l),ze(),r()}function Ai(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Df(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Ca(t){let e,n,r;t.length!==2?(e=Ai,n=(s,d)=>Ai(t(s),d),r=(s,d)=>t(s)-d):(e=t===Ai||t===Df?t:Ff,n=t,r=t);function i(s,d,c=0,l=s.length){if(c<l){if(e(d,d)!==0)return l;do{const h=c+l>>>1;n(s[h],d)<0?c=h+1:l=h}while(c<l)}return c}function o(s,d,c=0,l=s.length){if(c<l){if(e(d,d)!==0)return l;do{const h=c+l>>>1;n(s[h],d)<=0?c=h+1:l=h}while(c<l)}return c}function a(s,d,c=0,l=s.length){const h=i(s,d,c,l-1);return h>c&&r(s[h-1],d)>-r(s[h],d)?h-1:h}return{left:i,center:a,right:o}}function Ff(){return 0}function Rf(t){return t===null?NaN:+t}const Pf=Ca(Ai),Uf=Pf.right;Ca(Rf).center;function Hf(t,e){let n,r;if(e===void 0)for(const i of t)i!=null&&(n===void 0?i>=i&&(n=r=i):(n>i&&(n=i),r<i&&(r=i)));else{let i=-1;for(let o of t)(o=e(o,++i,t))!=null&&(n===void 0?o>=o&&(n=r=o):(n>o&&(n=o),r<o&&(r=o)))}return[n,r]}class vr extends Map{constructor(e,n=Vf){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),e!=null)for(const[r,i]of e)this.set(r,i)}get(e){return super.get(ss(this,e))}has(e){return super.has(ss(this,e))}set(e,n){return super.set(Bf(this,e),n)}delete(e){return super.delete(Of(this,e))}}function ss({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):n}function Bf({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):(t.set(r,n),n)}function Of({_intern:t,_key:e},n){const r=e(n);return t.has(r)&&(n=t.get(r),t.delete(r)),n}function Vf(t){return t!==null&&typeof t=="object"?t.valueOf():t}function Xo(t){return t}function ka(t,...e){return Wl(t,Xo,Xo,e)}function ls(t,e,...n){return Wl(t,Xo,e,n)}function Wl(t,e,n,r){return function i(o,a){if(a>=r.length)return n(o);const s=new vr,d=r[a++];let c=-1;for(const l of o){const h=d(l,++c,o),u=s.get(h);u?u.push(l):s.set(h,[l])}for(const[l,h]of s)s.set(l,i(h,a));return e(s)}(t,0)}const Wf=Math.sqrt(50),qf=Math.sqrt(10),Yf=Math.sqrt(2);function Wi(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),o=r/Math.pow(10,i),a=o>=Wf?10:o>=qf?5:o>=Yf?2:1;let s,d,c;return i<0?(c=Math.pow(10,-i)/a,s=Math.round(t*c),d=Math.round(e*c),s/c<t&&++s,d/c>e&&--d,c=-c):(c=Math.pow(10,i)*a,s=Math.round(t/c),d=Math.round(e/c),s*c<t&&++s,d*c>e&&--d),d<s&&.5<=n&&n<2?Wi(t,e,n*2):[s,d,c]}function Zo(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const r=e<t,[i,o,a]=r?Wi(e,t,n):Wi(t,e,n);if(!(o>=i))return[];const s=o-i+1,d=new Array(s);if(r)if(a<0)for(let c=0;c<s;++c)d[c]=(o-c)/-a;else for(let c=0;c<s;++c)d[c]=(o-c)*a;else if(a<0)for(let c=0;c<s;++c)d[c]=(i+c)/-a;else for(let c=0;c<s;++c)d[c]=(i+c)*a;return d}function Jo(t,e,n){return e=+e,t=+t,n=+n,Wi(t,e,n)[2]}function Qo(t,e,n){e=+e,t=+t,n=+n;const r=e<t,i=r?Jo(e,t,n):Jo(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}function br(t,e){let n;if(e===void 0)for(const r of t)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of t)(i=e(i,++r,t))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function Gf(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((e-t)/n))|0,o=new Array(i);++r<i;)o[r]=t+r*n;return o}function Kf(t){return t}var Si=1,Ei=2,jo=3,Xr=4,cs=1e-6;function Xf(t){return"translate("+t+",0)"}function Zf(t){return"translate(0,"+t+")"}function Jf(t){return e=>+t(e)}function Qf(t,e){return e=Math.max(0,t.bandwidth()-e*2)/2,t.round()&&(e=Math.round(e)),n=>+t(n)+e}function jf(){return!this.__axis}function To(t,e){var n=[],r=null,i=null,o=6,a=6,s=3,d=typeof window<"u"&&window.devicePixelRatio>1?0:.5,c=t===Si||t===Xr?-1:1,l=t===Xr||t===Ei?"x":"y",h=t===Si||t===jo?Xf:Zf;function u(g){var p=r??(e.ticks?e.ticks.apply(e,n):e.domain()),v=i??(e.tickFormat?e.tickFormat.apply(e,n):Kf),y=Math.max(o,0)+s,m=e.range(),$=+m[0]+d,C=+m[m.length-1]+d,T=(e.bandwidth?Qf:Jf)(e.copy(),d),x=g.selection?g.selection():g,_=x.selectAll(".domain").data([null]),z=x.selectAll(".tick").data(p,e).order(),N=z.exit(),U=z.enter().append("g").attr("class","tick"),b=z.select("line"),I=z.select("text");_=_.merge(_.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),z=z.merge(U),b=b.merge(U.append("line").attr("stroke","currentColor").attr(l+"2",c*o)),I=I.merge(U.append("text").attr("fill","currentColor").attr(l,c*y).attr("dy",t===Si?"0em":t===jo?"0.71em":"0.32em")),g!==x&&(_=_.transition(g),z=z.transition(g),b=b.transition(g),I=I.transition(g),N=N.transition(g).attr("opacity",cs).attr("transform",function(S){return isFinite(S=T(S))?h(S+d):this.getAttribute("transform")}),U.attr("opacity",cs).attr("transform",function(S){var R=this.parentNode.__axis;return h((R&&isFinite(R=R(S))?R:T(S))+d)})),N.remove(),_.attr("d",t===Xr||t===Ei?a?"M"+c*a+","+$+"H"+d+"V"+C+"H"+c*a:"M"+d+","+$+"V"+C:a?"M"+$+","+c*a+"V"+d+"H"+C+"V"+c*a:"M"+$+","+d+"H"+C),z.attr("opacity",1).attr("transform",function(S){return h(T(S)+d)}),b.attr(l+"2",c*o),I.attr(l,c*y).text(v),x.filter(jf).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===Ei?"start":t===Xr?"end":"middle"),x.each(function(){this.__axis=T})}return u.scale=function(g){return arguments.length?(e=g,u):e},u.ticks=function(){return n=Array.from(arguments),u},u.tickArguments=function(g){return arguments.length?(n=g==null?[]:Array.from(g),u):n.slice()},u.tickValues=function(g){return arguments.length?(r=g==null?null:Array.from(g),u):r&&r.slice()},u.tickFormat=function(g){return arguments.length?(i=g,u):i},u.tickSize=function(g){return arguments.length?(o=a=+g,u):o},u.tickSizeInner=function(g){return arguments.length?(o=+g,u):o},u.tickSizeOuter=function(g){return arguments.length?(a=+g,u):a},u.tickPadding=function(g){return arguments.length?(s=+g,u):s},u.offset=function(g){return arguments.length?(d=+g,u):d},u}function td(t){return To(Si,t)}function ed(t){return To(Ei,t)}function qi(t){return To(jo,t)}function Yi(t){return To(Xr,t)}var nd={value:()=>{}};function ql(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Ii(n)}function Ii(t){this._=t}function rd(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Ii.prototype=ql.prototype={constructor:Ii,on:function(t,e){var n=this._,r=rd(t+"",n),i,o=-1,a=r.length;if(arguments.length<2){for(;++o<a;)if((i=(t=r[o]).type)&&(i=id(n[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++o<a;)if(i=(t=r[o]).type)n[i]=us(n[i],t.name,e);else if(e==null)for(i in n)n[i]=us(n[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Ii(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,o;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=this._[t],r=0,i=o.length;r<i;++r)o[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(e,n)}};function id(t,e){for(var n=0,r=t.length,i;n<r;++n)if((i=t[n]).name===e)return i.value}function us(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=nd,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var ta="http://www.w3.org/1999/xhtml";const fs={svg:"http://www.w3.org/2000/svg",xhtml:ta,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function $o(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),fs.hasOwnProperty(e)?{space:fs[e],local:t}:t}function od(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===ta&&e.documentElement.namespaceURI===ta?e.createElement(t):e.createElementNS(n,t)}}function ad(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Yl(t){var e=$o(t);return(e.local?ad:od)(e)}function sd(){}function za(t){return t==null?sd:function(){return this.querySelector(t)}}function ld(t){typeof t!="function"&&(t=za(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o=e[i],a=o.length,s=r[i]=new Array(a),d,c,l=0;l<a;++l)(d=o[l])&&(c=t.call(d,d.__data__,l,o))&&("__data__"in d&&(c.__data__=d.__data__),s[l]=c);return new qe(r,this._parents)}function cd(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function ud(){return[]}function Gl(t){return t==null?ud:function(){return this.querySelectorAll(t)}}function fd(t){return function(){return cd(t.apply(this,arguments))}}function dd(t){typeof t=="function"?t=fd(t):t=Gl(t);for(var e=this._groups,n=e.length,r=[],i=[],o=0;o<n;++o)for(var a=e[o],s=a.length,d,c=0;c<s;++c)(d=a[c])&&(r.push(t.call(d,d.__data__,c,a)),i.push(d));return new qe(r,i)}function Kl(t){return function(){return this.matches(t)}}function Xl(t){return function(e){return e.matches(t)}}var hd=Array.prototype.find;function gd(t){return function(){return hd.call(this.children,t)}}function pd(){return this.firstElementChild}function md(t){return this.select(t==null?pd:gd(typeof t=="function"?t:Xl(t)))}var vd=Array.prototype.filter;function yd(){return Array.from(this.children)}function _d(t){return function(){return vd.call(this.children,t)}}function xd(t){return this.selectAll(t==null?yd:_d(typeof t=="function"?t:Xl(t)))}function bd(t){typeof t!="function"&&(t=Kl(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o=e[i],a=o.length,s=r[i]=[],d,c=0;c<a;++c)(d=o[c])&&t.call(d,d.__data__,c,o)&&s.push(d);return new qe(r,this._parents)}function Zl(t){return new Array(t.length)}function wd(){return new qe(this._enter||this._groups.map(Zl),this._parents)}function Gi(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}Gi.prototype={constructor:Gi,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function Td(t){return function(){return t}}function $d(t,e,n,r,i,o){for(var a=0,s,d=e.length,c=o.length;a<c;++a)(s=e[a])?(s.__data__=o[a],r[a]=s):n[a]=new Gi(t,o[a]);for(;a<d;++a)(s=e[a])&&(i[a]=s)}function Cd(t,e,n,r,i,o,a){var s,d,c=new Map,l=e.length,h=o.length,u=new Array(l),g;for(s=0;s<l;++s)(d=e[s])&&(u[s]=g=a.call(d,d.__data__,s,e)+"",c.has(g)?i[s]=d:c.set(g,d));for(s=0;s<h;++s)g=a.call(t,o[s],s,o)+"",(d=c.get(g))?(r[s]=d,d.__data__=o[s],c.delete(g)):n[s]=new Gi(t,o[s]);for(s=0;s<l;++s)(d=e[s])&&c.get(u[s])===d&&(i[s]=d)}function kd(t){return t.__data__}function zd(t,e){if(!arguments.length)return Array.from(this,kd);var n=e?Cd:$d,r=this._parents,i=this._groups;typeof t!="function"&&(t=Td(t));for(var o=i.length,a=new Array(o),s=new Array(o),d=new Array(o),c=0;c<o;++c){var l=r[c],h=i[c],u=h.length,g=Md(t.call(l,l&&l.__data__,c,r)),p=g.length,v=s[c]=new Array(p),y=a[c]=new Array(p),m=d[c]=new Array(u);n(l,h,v,y,m,g,e);for(var $=0,C=0,T,x;$<p;++$)if(T=v[$]){for($>=C&&(C=$+1);!(x=y[C])&&++C<p;);T._next=x||null}}return a=new qe(a,r),a._enter=s,a._exit=d,a}function Md(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Ad(){return new qe(this._exit||this._groups.map(Zl),this._parents)}function Sd(t,e,n){var r=this.enter(),i=this,o=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),e!=null&&(i=e(i),i&&(i=i.selection())),n==null?o.remove():n(o),r&&i?r.merge(i).order():i}function Ed(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,o=r.length,a=Math.min(i,o),s=new Array(i),d=0;d<a;++d)for(var c=n[d],l=r[d],h=c.length,u=s[d]=new Array(h),g,p=0;p<h;++p)(g=c[p]||l[p])&&(u[p]=g);for(;d<i;++d)s[d]=n[d];return new qe(s,this._parents)}function Id(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],i=r.length-1,o=r[i],a;--i>=0;)(a=r[i])&&(o&&a.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(a,o),o=a);return this}function Ld(t){t||(t=Nd);function e(h,u){return h&&u?t(h.__data__,u.__data__):!h-!u}for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var a=n[o],s=a.length,d=i[o]=new Array(s),c,l=0;l<s;++l)(c=a[l])&&(d[l]=c);d.sort(e)}return new qe(i,this._parents).order()}function Nd(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Dd(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function Fd(){return Array.from(this)}function Rd(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null}function Pd(){let t=0;for(const e of this)++t;return t}function Ud(){return!this.node()}function Hd(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i=e[n],o=0,a=i.length,s;o<a;++o)(s=i[o])&&t.call(s,s.__data__,o,i);return this}function Bd(t){return function(){this.removeAttribute(t)}}function Od(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Vd(t,e){return function(){this.setAttribute(t,e)}}function Wd(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function qd(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function Yd(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function Gd(t,e){var n=$o(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?Od:Bd:typeof e=="function"?n.local?Yd:qd:n.local?Wd:Vd)(n,e))}function Jl(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Kd(t){return function(){this.style.removeProperty(t)}}function Xd(t,e,n){return function(){this.style.setProperty(t,e,n)}}function Zd(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function Jd(t,e,n){return arguments.length>1?this.each((e==null?Kd:typeof e=="function"?Zd:Xd)(t,e,n??"")):wr(this.node(),t)}function wr(t,e){return t.style.getPropertyValue(e)||Jl(t).getComputedStyle(t,null).getPropertyValue(e)}function Qd(t){return function(){delete this[t]}}function jd(t,e){return function(){this[t]=e}}function th(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function eh(t,e){return arguments.length>1?this.each((e==null?Qd:typeof e=="function"?th:jd)(t,e)):this.node()[t]}function Ql(t){return t.trim().split(/^|\s+/)}function Ma(t){return t.classList||new jl(t)}function jl(t){this._node=t,this._names=Ql(t.getAttribute("class")||"")}jl.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function tc(t,e){for(var n=Ma(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function ec(t,e){for(var n=Ma(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function nh(t){return function(){tc(this,t)}}function rh(t){return function(){ec(this,t)}}function ih(t,e){return function(){(e.apply(this,arguments)?tc:ec)(this,t)}}function oh(t,e){var n=Ql(t+"");if(arguments.length<2){for(var r=Ma(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof e=="function"?ih:e?nh:rh)(n,e))}function ah(){this.textContent=""}function sh(t){return function(){this.textContent=t}}function lh(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function ch(t){return arguments.length?this.each(t==null?ah:(typeof t=="function"?lh:sh)(t)):this.node().textContent}function uh(){this.innerHTML=""}function fh(t){return function(){this.innerHTML=t}}function dh(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function hh(t){return arguments.length?this.each(t==null?uh:(typeof t=="function"?dh:fh)(t)):this.node().innerHTML}function gh(){this.nextSibling&&this.parentNode.appendChild(this)}function ph(){return this.each(gh)}function mh(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function vh(){return this.each(mh)}function yh(t){var e=typeof t=="function"?t:Yl(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function _h(){return null}function xh(t,e){var n=typeof t=="function"?t:Yl(t),r=e==null?_h:typeof e=="function"?e:za(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function bh(){var t=this.parentNode;t&&t.removeChild(this)}function wh(){return this.each(bh)}function Th(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function $h(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Ch(t){return this.select(t?$h:Th)}function kh(t){return arguments.length?this.property("__data__",t):this.node().__data__}function zh(t){return function(e){t.call(this,e,this.__data__)}}function Mh(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function Ah(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,i=e.length,o;n<i;++n)o=e[n],(!t.type||o.type===t.type)&&o.name===t.name?this.removeEventListener(o.type,o.listener,o.options):e[++r]=o;++r?e.length=r:delete this.__on}}}function Sh(t,e,n){return function(){var r=this.__on,i,o=zh(e);if(r){for(var a=0,s=r.length;a<s;++a)if((i=r[a]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=o,i.options=n),i.value=e;return}}this.addEventListener(t.type,o,n),i={type:t.type,name:t.name,value:e,listener:o,options:n},r?r.push(i):this.__on=[i]}}function Eh(t,e,n){var r=Mh(t+""),i,o=r.length,a;if(arguments.length<2){var s=this.node().__on;if(s){for(var d=0,c=s.length,l;d<c;++d)for(i=0,l=s[d];i<o;++i)if((a=r[i]).type===l.type&&a.name===l.name)return l.value}return}for(s=e?Sh:Ah,i=0;i<o;++i)this.each(s(r[i],e,n));return this}function nc(t,e,n){var r=Jl(t),i=r.CustomEvent;typeof i=="function"?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function Ih(t,e){return function(){return nc(this,t,e)}}function Lh(t,e){return function(){return nc(this,t,e.apply(this,arguments))}}function Nh(t,e){return this.each((typeof e=="function"?Lh:Ih)(t,e))}function*Dh(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length,a;i<o;++i)(a=r[i])&&(yield a)}var rc=[null];function qe(t,e){this._groups=t,this._parents=e}function Lr(){return new qe([[document.documentElement]],rc)}function Fh(){return this}qe.prototype=Lr.prototype={constructor:qe,select:ld,selectAll:dd,selectChild:md,selectChildren:xd,filter:bd,data:zd,enter:wd,exit:Ad,join:Sd,merge:Ed,selection:Fh,order:Id,sort:Ld,call:Dd,nodes:Fd,node:Rd,size:Pd,empty:Ud,each:Hd,attr:Gd,style:Jd,property:eh,classed:oh,text:ch,html:hh,raise:ph,lower:vh,append:yh,insert:xh,remove:wh,clone:Ch,datum:kh,on:Eh,dispatch:Nh,[Symbol.iterator]:Dh};function dt(t){return typeof t=="string"?new qe([[document.querySelector(t)]],[document.documentElement]):new qe([[t]],rc)}function Aa(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function ic(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function gi(){}var ai=.7,Ki=1/ai,yr="\\s*([+-]?\\d+)\\s*",si="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",dn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Rh=/^#([0-9a-f]{3,8})$/,Ph=new RegExp(`^rgb\\(${yr},${yr},${yr}\\)$`),Uh=new RegExp(`^rgb\\(${dn},${dn},${dn}\\)$`),Hh=new RegExp(`^rgba\\(${yr},${yr},${yr},${si}\\)$`),Bh=new RegExp(`^rgba\\(${dn},${dn},${dn},${si}\\)$`),Oh=new RegExp(`^hsl\\(${si},${dn},${dn}\\)$`),Vh=new RegExp(`^hsla\\(${si},${dn},${dn},${si}\\)$`),ds={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Aa(gi,er,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:hs,formatHex:hs,formatHex8:Wh,formatHsl:qh,formatRgb:gs,toString:gs});function hs(){return this.rgb().formatHex()}function Wh(){return this.rgb().formatHex8()}function qh(){return oc(this).formatHsl()}function gs(){return this.rgb().formatRgb()}function er(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Rh.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?ps(e):n===3?new Pe(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?wi(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?wi(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Ph.exec(t))?new Pe(e[1],e[2],e[3],1):(e=Uh.exec(t))?new Pe(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Hh.exec(t))?wi(e[1],e[2],e[3],e[4]):(e=Bh.exec(t))?wi(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Oh.exec(t))?ys(e[1],e[2]/100,e[3]/100,1):(e=Vh.exec(t))?ys(e[1],e[2]/100,e[3]/100,e[4]):ds.hasOwnProperty(t)?ps(ds[t]):t==="transparent"?new Pe(NaN,NaN,NaN,0):null}function ps(t){return new Pe(t>>16&255,t>>8&255,t&255,1)}function wi(t,e,n,r){return r<=0&&(t=e=n=NaN),new Pe(t,e,n,r)}function Yh(t){return t instanceof gi||(t=er(t)),t?(t=t.rgb(),new Pe(t.r,t.g,t.b,t.opacity)):new Pe}function Fe(t,e,n,r){return arguments.length===1?Yh(t):new Pe(t,e,n,r??1)}function Pe(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}Aa(Pe,Fe,ic(gi,{brighter(t){return t=t==null?Ki:Math.pow(Ki,t),new Pe(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?ai:Math.pow(ai,t),new Pe(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Pe(jn(this.r),jn(this.g),jn(this.b),Xi(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ms,formatHex:ms,formatHex8:Gh,formatRgb:vs,toString:vs}));function ms(){return`#${Jn(this.r)}${Jn(this.g)}${Jn(this.b)}`}function Gh(){return`#${Jn(this.r)}${Jn(this.g)}${Jn(this.b)}${Jn((isNaN(this.opacity)?1:this.opacity)*255)}`}function vs(){const t=Xi(this.opacity);return`${t===1?"rgb(":"rgba("}${jn(this.r)}, ${jn(this.g)}, ${jn(this.b)}${t===1?")":`, ${t})`}`}function Xi(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function jn(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Jn(t){return t=jn(t),(t<16?"0":"")+t.toString(16)}function ys(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new en(t,e,n,r)}function oc(t){if(t instanceof en)return new en(t.h,t.s,t.l,t.opacity);if(t instanceof gi||(t=er(t)),!t)return new en;if(t instanceof en)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),a=NaN,s=o-i,d=(o+i)/2;return s?(e===o?a=(n-r)/s+(n<r)*6:n===o?a=(r-e)/s+2:a=(e-n)/s+4,s/=d<.5?o+i:2-o-i,a*=60):s=d>0&&d<1?0:a,new en(a,s,d,t.opacity)}function Kh(t,e,n,r){return arguments.length===1?oc(t):new en(t,e,n,r??1)}function en(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}Aa(en,Kh,ic(gi,{brighter(t){return t=t==null?Ki:Math.pow(Ki,t),new en(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?ai:Math.pow(ai,t),new en(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Pe(So(t>=240?t-240:t+120,i,r),So(t,i,r),So(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new en(_s(this.h),Ti(this.s),Ti(this.l),Xi(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Xi(this.opacity);return`${t===1?"hsl(":"hsla("}${_s(this.h)}, ${Ti(this.s)*100}%, ${Ti(this.l)*100}%${t===1?")":`, ${t})`}`}}));function _s(t){return t=(t||0)%360,t<0?t+360:t}function Ti(t){return Math.max(0,Math.min(1,t||0))}function So(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}function Xh(t,e,n,r,i){var o=t*t,a=o*t;return((1-3*t+3*o-a)*e+(4-6*o+3*a)*n+(1+3*t+3*o-3*a)*r+a*i)/6}function Zh(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],o=t[r+1],a=r>0?t[r-1]:2*i-o,s=r<e-1?t[r+2]:2*o-i;return Xh((n-r/e)*e,a,i,o,s)}}const Sa=t=>()=>t;function Jh(t,e){return function(n){return t+n*e}}function Qh(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function jh(t){return(t=+t)==1?ac:function(e,n){return n-e?Qh(e,n,t):Sa(isNaN(e)?n:e)}}function ac(t,e){var n=e-t;return n?Jh(t,n):Sa(isNaN(t)?e:t)}const Zi=function t(e){var n=jh(e);function r(i,o){var a=n((i=Fe(i)).r,(o=Fe(o)).r),s=n(i.g,o.g),d=n(i.b,o.b),c=ac(i.opacity,o.opacity);return function(l){return i.r=a(l),i.g=s(l),i.b=d(l),i.opacity=c(l),i+""}}return r.gamma=t,r}(1);function tg(t){return function(e){var n=e.length,r=new Array(n),i=new Array(n),o=new Array(n),a,s;for(a=0;a<n;++a)s=Fe(e[a]),r[a]=s.r||0,i[a]=s.g||0,o[a]=s.b||0;return r=t(r),i=t(i),o=t(o),s.opacity=1,function(d){return s.r=r(d),s.g=i(d),s.b=o(d),s+""}}}var eg=tg(Zh);function ng(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),i;return function(o){for(i=0;i<n;++i)r[i]=t[i]*(1-o)+e[i]*o;return r}}function rg(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function ig(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,i=new Array(r),o=new Array(n),a;for(a=0;a<r;++a)i[a]=Tr(t[a],e[a]);for(;a<n;++a)o[a]=e[a];return function(s){for(a=0;a<r;++a)o[a]=i[a](s);return o}}function og(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function tn(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function ag(t,e){var n={},r={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?n[i]=Tr(t[i],e[i]):r[i]=e[i];return function(o){for(i in n)r[i]=n[i](o);return r}}var ea=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Eo=new RegExp(ea.source,"g");function sg(t){return function(){return t}}function lg(t){return function(e){return t(e)+""}}function sc(t,e){var n=ea.lastIndex=Eo.lastIndex=0,r,i,o,a=-1,s=[],d=[];for(t=t+"",e=e+"";(r=ea.exec(t))&&(i=Eo.exec(e));)(o=i.index)>n&&(o=e.slice(n,o),s[a]?s[a]+=o:s[++a]=o),(r=r[0])===(i=i[0])?s[a]?s[a]+=i:s[++a]=i:(s[++a]=null,d.push({i:a,x:tn(r,i)})),n=Eo.lastIndex;return n<e.length&&(o=e.slice(n),s[a]?s[a]+=o:s[++a]=o),s.length<2?d[0]?lg(d[0].x):sg(e):(e=d.length,function(c){for(var l=0,h;l<e;++l)s[(h=d[l]).i]=h.x(c);return s.join("")})}function Tr(t,e){var n=typeof e,r;return e==null||n==="boolean"?Sa(e):(n==="number"?tn:n==="string"?(r=er(e))?(e=r,Zi):sc:e instanceof er?Zi:e instanceof Date?og:rg(e)?ng:Array.isArray(e)?ig:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?ag:tn)(t,e)}function lc(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var xs=180/Math.PI,na={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function cc(t,e,n,r,i,o){var a,s,d;return(a=Math.sqrt(t*t+e*e))&&(t/=a,e/=a),(d=t*n+e*r)&&(n-=t*d,r-=e*d),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,d/=s),t*r<e*n&&(t=-t,e=-e,d=-d,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(e,t)*xs,skewX:Math.atan(d)*xs,scaleX:a,scaleY:s}}var $i;function cg(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?na:cc(e.a,e.b,e.c,e.d,e.e,e.f)}function ug(t){return t==null||($i||($i=document.createElementNS("http://www.w3.org/2000/svg","g")),$i.setAttribute("transform",t),!(t=$i.transform.baseVal.consolidate()))?na:(t=t.matrix,cc(t.a,t.b,t.c,t.d,t.e,t.f))}function uc(t,e,n,r){function i(c){return c.length?c.pop()+" ":""}function o(c,l,h,u,g,p){if(c!==h||l!==u){var v=g.push("translate(",null,e,null,n);p.push({i:v-4,x:tn(c,h)},{i:v-2,x:tn(l,u)})}else(h||u)&&g.push("translate("+h+e+u+n)}function a(c,l,h,u){c!==l?(c-l>180?l+=360:l-c>180&&(c+=360),u.push({i:h.push(i(h)+"rotate(",null,r)-2,x:tn(c,l)})):l&&h.push(i(h)+"rotate("+l+r)}function s(c,l,h,u){c!==l?u.push({i:h.push(i(h)+"skewX(",null,r)-2,x:tn(c,l)}):l&&h.push(i(h)+"skewX("+l+r)}function d(c,l,h,u,g,p){if(c!==h||l!==u){var v=g.push(i(g)+"scale(",null,",",null,")");p.push({i:v-4,x:tn(c,h)},{i:v-2,x:tn(l,u)})}else(h!==1||u!==1)&&g.push(i(g)+"scale("+h+","+u+")")}return function(c,l){var h=[],u=[];return c=t(c),l=t(l),o(c.translateX,c.translateY,l.translateX,l.translateY,h,u),a(c.rotate,l.rotate,h,u),s(c.skewX,l.skewX,h,u),d(c.scaleX,c.scaleY,l.scaleX,l.scaleY,h,u),c=l=null,function(g){for(var p=-1,v=u.length,y;++p<v;)h[(y=u[p]).i]=y.x(g);return h.join("")}}}var fg=uc(cg,"px, ","px)","deg)"),dg=uc(ug,", ",")",")"),$r=0,Zr=0,Or=0,fc=1e3,Ji,Jr,Qi=0,nr=0,Co=0,li=typeof performance=="object"&&performance.now?performance:Date,dc=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Ea(){return nr||(dc(hg),nr=li.now()+Co)}function hg(){nr=0}function ji(){this._call=this._time=this._next=null}ji.prototype=hc.prototype={constructor:ji,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?Ea():+n)+(e==null?0:+e),!this._next&&Jr!==this&&(Jr?Jr._next=this:Ji=this,Jr=this),this._call=t,this._time=n,ra()},stop:function(){this._call&&(this._call=null,this._time=1/0,ra())}};function hc(t,e,n){var r=new ji;return r.restart(t,e,n),r}function gg(){Ea(),++$r;for(var t=Ji,e;t;)(e=nr-t._time)>=0&&t._call.call(void 0,e),t=t._next;--$r}function bs(){nr=(Qi=li.now())+Co,$r=Zr=0;try{gg()}finally{$r=0,mg(),nr=0}}function pg(){var t=li.now(),e=t-Qi;e>fc&&(Co-=e,Qi=t)}function mg(){for(var t,e=Ji,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:Ji=n);Jr=t,ra(r)}function ra(t){if(!$r){Zr&&(Zr=clearTimeout(Zr));var e=t-nr;e>24?(t<1/0&&(Zr=setTimeout(bs,t-li.now()-Co)),Or&&(Or=clearInterval(Or))):(Or||(Qi=li.now(),Or=setInterval(pg,fc)),$r=1,dc(bs))}}function ws(t,e,n){var r=new ji;return e=e==null?0:+e,r.restart(i=>{r.stop(),t(i+e)},e,n),r}var vg=ql("start","end","cancel","interrupt"),yg=[],gc=0,Ts=1,ia=2,Li=3,$s=4,oa=5,Ni=6;function ko(t,e,n,r,i,o){var a=t.__transition;if(!a)t.__transition={};else if(n in a)return;_g(t,n,{name:e,index:r,group:i,on:vg,tween:yg,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:gc})}function Ia(t,e){var n=an(t,e);if(n.state>gc)throw new Error("too late; already scheduled");return n}function pn(t,e){var n=an(t,e);if(n.state>Li)throw new Error("too late; already running");return n}function an(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function _g(t,e,n){var r=t.__transition,i;r[e]=n,n.timer=hc(o,0,n.time);function o(c){n.state=Ts,n.timer.restart(a,n.delay,n.time),n.delay<=c&&a(c-n.delay)}function a(c){var l,h,u,g;if(n.state!==Ts)return d();for(l in r)if(g=r[l],g.name===n.name){if(g.state===Li)return ws(a);g.state===$s?(g.state=Ni,g.timer.stop(),g.on.call("interrupt",t,t.__data__,g.index,g.group),delete r[l]):+l<e&&(g.state=Ni,g.timer.stop(),g.on.call("cancel",t,t.__data__,g.index,g.group),delete r[l])}if(ws(function(){n.state===Li&&(n.state=$s,n.timer.restart(s,n.delay,n.time),s(c))}),n.state=ia,n.on.call("start",t,t.__data__,n.index,n.group),n.state===ia){for(n.state=Li,i=new Array(u=n.tween.length),l=0,h=-1;l<u;++l)(g=n.tween[l].value.call(t,t.__data__,n.index,n.group))&&(i[++h]=g);i.length=h+1}}function s(c){for(var l=c<n.duration?n.ease.call(null,c/n.duration):(n.timer.restart(d),n.state=oa,1),h=-1,u=i.length;++h<u;)i[h].call(t,l);n.state===oa&&(n.on.call("end",t,t.__data__,n.index,n.group),d())}function d(){n.state=Ni,n.timer.stop(),delete r[e];for(var c in r)return;delete t.__transition}}function xg(t,e){var n=t.__transition,r,i,o=!0,a;if(n){e=e==null?null:e+"";for(a in n){if((r=n[a]).name!==e){o=!1;continue}i=r.state>ia&&r.state<oa,r.state=Ni,r.timer.stop(),r.on.call(i?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[a]}o&&delete t.__transition}}function bg(t){return this.each(function(){xg(this,t)})}function wg(t,e){var n,r;return function(){var i=pn(this,t),o=i.tween;if(o!==n){r=n=o;for(var a=0,s=r.length;a<s;++a)if(r[a].name===e){r=r.slice(),r.splice(a,1);break}}i.tween=r}}function Tg(t,e,n){var r,i;if(typeof n!="function")throw new Error;return function(){var o=pn(this,t),a=o.tween;if(a!==r){i=(r=a).slice();for(var s={name:e,value:n},d=0,c=i.length;d<c;++d)if(i[d].name===e){i[d]=s;break}d===c&&i.push(s)}o.tween=i}}function $g(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=an(this.node(),n).tween,i=0,o=r.length,a;i<o;++i)if((a=r[i]).name===t)return a.value;return null}return this.each((e==null?wg:Tg)(n,t,e))}function La(t,e,n){var r=t._id;return t.each(function(){var i=pn(this,r);(i.value||(i.value={}))[e]=n.apply(this,arguments)}),function(i){return an(i,r).value[e]}}function pc(t,e){var n;return(typeof e=="number"?tn:e instanceof er?Zi:(n=er(e))?(e=n,Zi):sc)(t,e)}function Cg(t){return function(){this.removeAttribute(t)}}function kg(t){return function(){this.removeAttributeNS(t.space,t.local)}}function zg(t,e,n){var r,i=n+"",o;return function(){var a=this.getAttribute(t);return a===i?null:a===r?o:o=e(r=a,n)}}function Mg(t,e,n){var r,i=n+"",o;return function(){var a=this.getAttributeNS(t.space,t.local);return a===i?null:a===r?o:o=e(r=a,n)}}function Ag(t,e,n){var r,i,o;return function(){var a,s=n(this),d;return s==null?void this.removeAttribute(t):(a=this.getAttribute(t),d=s+"",a===d?null:a===r&&d===i?o:(i=d,o=e(r=a,s)))}}function Sg(t,e,n){var r,i,o;return function(){var a,s=n(this),d;return s==null?void this.removeAttributeNS(t.space,t.local):(a=this.getAttributeNS(t.space,t.local),d=s+"",a===d?null:a===r&&d===i?o:(i=d,o=e(r=a,s)))}}function Eg(t,e){var n=$o(t),r=n==="transform"?dg:pc;return this.attrTween(t,typeof e=="function"?(n.local?Sg:Ag)(n,r,La(this,"attr."+t,e)):e==null?(n.local?kg:Cg)(n):(n.local?Mg:zg)(n,r,e))}function Ig(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function Lg(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function Ng(t,e){var n,r;function i(){var o=e.apply(this,arguments);return o!==r&&(n=(r=o)&&Lg(t,o)),n}return i._value=e,i}function Dg(t,e){var n,r;function i(){var o=e.apply(this,arguments);return o!==r&&(n=(r=o)&&Ig(t,o)),n}return i._value=e,i}function Fg(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=$o(t);return this.tween(n,(r.local?Ng:Dg)(r,e))}function Rg(t,e){return function(){Ia(this,t).delay=+e.apply(this,arguments)}}function Pg(t,e){return e=+e,function(){Ia(this,t).delay=e}}function Ug(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Rg:Pg)(e,t)):an(this.node(),e).delay}function Hg(t,e){return function(){pn(this,t).duration=+e.apply(this,arguments)}}function Bg(t,e){return e=+e,function(){pn(this,t).duration=e}}function Og(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Hg:Bg)(e,t)):an(this.node(),e).duration}function Vg(t,e){if(typeof e!="function")throw new Error;return function(){pn(this,t).ease=e}}function Wg(t){var e=this._id;return arguments.length?this.each(Vg(e,t)):an(this.node(),e).ease}function qg(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;pn(this,t).ease=n}}function Yg(t){if(typeof t!="function")throw new Error;return this.each(qg(this._id,t))}function Gg(t){typeof t!="function"&&(t=Kl(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o=e[i],a=o.length,s=r[i]=[],d,c=0;c<a;++c)(d=o[c])&&t.call(d,d.__data__,c,o)&&s.push(d);return new zn(r,this._parents,this._name,this._id)}function Kg(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,o=Math.min(r,i),a=new Array(r),s=0;s<o;++s)for(var d=e[s],c=n[s],l=d.length,h=a[s]=new Array(l),u,g=0;g<l;++g)(u=d[g]||c[g])&&(h[g]=u);for(;s<r;++s)a[s]=e[s];return new zn(a,this._parents,this._name,this._id)}function Xg(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function Zg(t,e,n){var r,i,o=Xg(e)?Ia:pn;return function(){var a=o(this,t),s=a.on;s!==r&&(i=(r=s).copy()).on(e,n),a.on=i}}function Jg(t,e){var n=this._id;return arguments.length<2?an(this.node(),n).on.on(t):this.each(Zg(n,t,e))}function Qg(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function jg(){return this.on("end.remove",Qg(this._id))}function tp(t){var e=this._name,n=this._id;typeof t!="function"&&(t=za(t));for(var r=this._groups,i=r.length,o=new Array(i),a=0;a<i;++a)for(var s=r[a],d=s.length,c=o[a]=new Array(d),l,h,u=0;u<d;++u)(l=s[u])&&(h=t.call(l,l.__data__,u,s))&&("__data__"in l&&(h.__data__=l.__data__),c[u]=h,ko(c[u],e,n,u,c,an(l,n)));return new zn(o,this._parents,e,n)}function ep(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Gl(t));for(var r=this._groups,i=r.length,o=[],a=[],s=0;s<i;++s)for(var d=r[s],c=d.length,l,h=0;h<c;++h)if(l=d[h]){for(var u=t.call(l,l.__data__,h,d),g,p=an(l,n),v=0,y=u.length;v<y;++v)(g=u[v])&&ko(g,e,n,v,u,p);o.push(u),a.push(l)}return new zn(o,a,e,n)}var np=Lr.prototype.constructor;function rp(){return new np(this._groups,this._parents)}function ip(t,e){var n,r,i;return function(){var o=wr(this,t),a=(this.style.removeProperty(t),wr(this,t));return o===a?null:o===n&&a===r?i:i=e(n=o,r=a)}}function mc(t){return function(){this.style.removeProperty(t)}}function op(t,e,n){var r,i=n+"",o;return function(){var a=wr(this,t);return a===i?null:a===r?o:o=e(r=a,n)}}function ap(t,e,n){var r,i,o;return function(){var a=wr(this,t),s=n(this),d=s+"";return s==null&&(d=s=(this.style.removeProperty(t),wr(this,t))),a===d?null:a===r&&d===i?o:(i=d,o=e(r=a,s))}}function sp(t,e){var n,r,i,o="style."+e,a="end."+o,s;return function(){var d=pn(this,t),c=d.on,l=d.value[o]==null?s||(s=mc(e)):void 0;(c!==n||i!==l)&&(r=(n=c).copy()).on(a,i=l),d.on=r}}function lp(t,e,n){var r=(t+="")=="transform"?fg:pc;return e==null?this.styleTween(t,ip(t,r)).on("end.style."+t,mc(t)):typeof e=="function"?this.styleTween(t,ap(t,r,La(this,"style."+t,e))).each(sp(this._id,t)):this.styleTween(t,op(t,r,e),n).on("end.style."+t,null)}function cp(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function up(t,e,n){var r,i;function o(){var a=e.apply(this,arguments);return a!==i&&(r=(i=a)&&cp(t,a,n)),r}return o._value=e,o}function fp(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,up(t,e,n??""))}function dp(t){return function(){this.textContent=t}}function hp(t){return function(){var e=t(this);this.textContent=e??""}}function gp(t){return this.tween("text",typeof t=="function"?hp(La(this,"text",t)):dp(t==null?"":t+""))}function pp(t){return function(e){this.textContent=t.call(this,e)}}function mp(t){var e,n;function r(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&pp(i)),e}return r._value=t,r}function vp(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,mp(t))}function yp(){for(var t=this._name,e=this._id,n=yc(),r=this._groups,i=r.length,o=0;o<i;++o)for(var a=r[o],s=a.length,d,c=0;c<s;++c)if(d=a[c]){var l=an(d,e);ko(d,t,n,c,a,{time:l.time+l.delay+l.duration,delay:0,duration:l.duration,ease:l.ease})}return new zn(r,this._parents,t,n)}function _p(){var t,e,n=this,r=n._id,i=n.size();return new Promise(function(o,a){var s={value:a},d={value:function(){--i===0&&o()}};n.each(function(){var c=pn(this,r),l=c.on;l!==t&&(e=(t=l).copy(),e._.cancel.push(s),e._.interrupt.push(s),e._.end.push(d)),c.on=e}),i===0&&o()})}var xp=0;function zn(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function vc(t){return Lr().transition(t)}function yc(){return++xp}var vn=Lr.prototype;zn.prototype=vc.prototype={constructor:zn,select:tp,selectAll:ep,selectChild:vn.selectChild,selectChildren:vn.selectChildren,filter:Gg,merge:Kg,selection:rp,transition:yp,call:vn.call,nodes:vn.nodes,node:vn.node,size:vn.size,empty:vn.empty,each:vn.each,on:Jg,attr:Eg,attrTween:Fg,style:lp,styleTween:fp,text:gp,textTween:vp,remove:jg,tween:$g,delay:Ug,duration:Og,ease:Wg,easeVarying:Yg,end:_p,[Symbol.iterator]:vn[Symbol.iterator]};function _c(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var bp={time:null,delay:0,duration:250,ease:_c};function wp(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function Tp(t){var e,n;t instanceof zn?(e=t._id,t=t._name):(e=yc(),(n=bp).time=Ea(),t=t==null?null:t+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var a=r[o],s=a.length,d,c=0;c<s;++c)(d=a[c])&&ko(d,t,e,c,a,n||wp(d,e));return new zn(r,this._parents,t,e)}Lr.prototype.interrupt=bg;Lr.prototype.transition=Tp;const aa=Math.PI,sa=2*aa,Xn=1e-6,$p=sa-Xn;function xc(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function Cp(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return xc;const n=10**e;return function(r){this._+=r[0];for(let i=1,o=r.length;i<o;++i)this._+=Math.round(arguments[i]*n)/n+r[i]}}class kp{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?xc:Cp(e)}moveTo(e,n){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,n){this._append`L${this._x1=+e},${this._y1=+n}`}quadraticCurveTo(e,n,r,i){this._append`Q${+e},${+n},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(e,n,r,i,o,a){this._append`C${+e},${+n},${+r},${+i},${this._x1=+o},${this._y1=+a}`}arcTo(e,n,r,i,o){if(e=+e,n=+n,r=+r,i=+i,o=+o,o<0)throw new Error(`negative radius: ${o}`);let a=this._x1,s=this._y1,d=r-e,c=i-n,l=a-e,h=s-n,u=l*l+h*h;if(this._x1===null)this._append`M${this._x1=e},${this._y1=n}`;else if(u>Xn)if(!(Math.abs(h*d-c*l)>Xn)||!o)this._append`L${this._x1=e},${this._y1=n}`;else{let g=r-a,p=i-s,v=d*d+c*c,y=g*g+p*p,m=Math.sqrt(v),$=Math.sqrt(u),C=o*Math.tan((aa-Math.acos((v+u-y)/(2*m*$)))/2),T=C/$,x=C/m;Math.abs(T-1)>Xn&&this._append`L${e+T*l},${n+T*h}`,this._append`A${o},${o},0,0,${+(h*g>l*p)},${this._x1=e+x*d},${this._y1=n+x*c}`}}arc(e,n,r,i,o,a){if(e=+e,n=+n,r=+r,a=!!a,r<0)throw new Error(`negative radius: ${r}`);let s=r*Math.cos(i),d=r*Math.sin(i),c=e+s,l=n+d,h=1^a,u=a?i-o:o-i;this._x1===null?this._append`M${c},${l}`:(Math.abs(this._x1-c)>Xn||Math.abs(this._y1-l)>Xn)&&this._append`L${c},${l}`,r&&(u<0&&(u=u%sa+sa),u>$p?this._append`A${r},${r},0,1,${h},${e-s},${n-d}A${r},${r},0,1,${h},${this._x1=c},${this._y1=l}`:u>Xn&&this._append`A${r},${r},0,${+(u>=aa)},${h},${this._x1=e+r*Math.cos(o)},${this._y1=n+r*Math.sin(o)}`)}rect(e,n,r,i){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}}function zp(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function to(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function Cr(t){return t=to(Math.abs(t)),t?t[1]:NaN}function Mp(t,e){return function(n,r){for(var i=n.length,o=[],a=0,s=t[0],d=0;i>0&&s>0&&(d+s+1>r&&(s=Math.max(1,r-d)),o.push(n.substring(i-=s,i+s)),!((d+=s+1)>r));)s=t[a=(a+1)%t.length];return o.reverse().join(e)}}function Ap(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var Sp=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ci(t){if(!(e=Sp.exec(t)))throw new Error("invalid format: "+t);var e;return new Na({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}ci.prototype=Na.prototype;function Na(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}Na.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Ep(t){t:for(var e=t.length,n=1,r=-1,i;n<e;++n)switch(t[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+t[n])break t;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(i+1):t}var bc;function Ip(t,e){var n=to(t,e);if(!n)return t+"";var r=n[0],i=n[1],o=i-(bc=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+to(t,Math.max(0,e+o-1))[0]}function Cs(t,e){var n=to(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const ks={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:zp,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Cs(t*100,e),r:Cs,s:Ip,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function zs(t){return t}var Ms=Array.prototype.map,As=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Lp(t){var e=t.grouping===void 0||t.thousands===void 0?zs:Mp(Ms.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",o=t.numerals===void 0?zs:Ap(Ms.call(t.numerals,String)),a=t.percent===void 0?"%":t.percent+"",s=t.minus===void 0?"−":t.minus+"",d=t.nan===void 0?"NaN":t.nan+"";function c(h){h=ci(h);var u=h.fill,g=h.align,p=h.sign,v=h.symbol,y=h.zero,m=h.width,$=h.comma,C=h.precision,T=h.trim,x=h.type;x==="n"?($=!0,x="g"):ks[x]||(C===void 0&&(C=12),T=!0,x="g"),(y||u==="0"&&g==="=")&&(y=!0,u="0",g="=");var _=v==="$"?n:v==="#"&&/[boxX]/.test(x)?"0"+x.toLowerCase():"",z=v==="$"?r:/[%p]/.test(x)?a:"",N=ks[x],U=/[defgprs%]/.test(x);C=C===void 0?6:/[gprs]/.test(x)?Math.max(1,Math.min(21,C)):Math.max(0,Math.min(20,C));function b(I){var S=_,R=z,W,X,k;if(x==="c")R=N(I)+R,I="";else{I=+I;var F=I<0||1/I<0;if(I=isNaN(I)?d:N(Math.abs(I),C),T&&(I=Ep(I)),F&&+I==0&&p!=="+"&&(F=!1),S=(F?p==="("?p:s:p==="-"||p==="("?"":p)+S,R=(x==="s"?As[8+bc/3]:"")+R+(F&&p==="("?")":""),U){for(W=-1,X=I.length;++W<X;)if(k=I.charCodeAt(W),48>k||k>57){R=(k===46?i+I.slice(W+1):I.slice(W))+R,I=I.slice(0,W);break}}}$&&!y&&(I=e(I,1/0));var q=S.length+I.length+R.length,ct=q<m?new Array(m-q+1).join(u):"";switch($&&y&&(I=e(ct+I,ct.length?m-R.length:1/0),ct=""),g){case"<":I=S+I+R+ct;break;case"=":I=S+ct+I+R;break;case"^":I=ct.slice(0,q=ct.length>>1)+S+I+R+ct.slice(q);break;default:I=ct+S+I+R;break}return o(I)}return b.toString=function(){return h+""},b}function l(h,u){var g=c((h=ci(h),h.type="f",h)),p=Math.max(-8,Math.min(8,Math.floor(Cr(u)/3)))*3,v=Math.pow(10,-p),y=As[8+p/3];return function(m){return g(v*m)+y}}return{format:c,formatPrefix:l}}var Ci,Da,wc;Np({thousands:",",grouping:[3],currency:["$",""]});function Np(t){return Ci=Lp(t),Da=Ci.format,wc=Ci.formatPrefix,Ci}function Dp(t){return Math.max(0,-Cr(Math.abs(t)))}function Fp(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Cr(e)/3)))*3-Cr(Math.abs(t)))}function Rp(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Cr(e)-Cr(t))+1}function Pp(t){var e=0,n=t.children,r=n&&n.length;if(!r)e=1;else for(;--r>=0;)e+=n[r].value;t.value=e}function Up(){return this.eachAfter(Pp)}function Hp(t,e){let n=-1;for(const r of this)t.call(e,r,++n,this);return this}function Bp(t,e){for(var n=this,r=[n],i,o,a=-1;n=r.pop();)if(t.call(e,n,++a,this),i=n.children)for(o=i.length-1;o>=0;--o)r.push(i[o]);return this}function Op(t,e){for(var n=this,r=[n],i=[],o,a,s,d=-1;n=r.pop();)if(i.push(n),o=n.children)for(a=0,s=o.length;a<s;++a)r.push(o[a]);for(;n=i.pop();)t.call(e,n,++d,this);return this}function Vp(t,e){let n=-1;for(const r of this)if(t.call(e,r,++n,this))return r}function Wp(t){return this.eachAfter(function(e){for(var n=+t(e.data)||0,r=e.children,i=r&&r.length;--i>=0;)n+=r[i].value;e.value=n})}function qp(t){return this.eachBefore(function(e){e.children&&e.children.sort(t)})}function Yp(t){for(var e=this,n=Gp(e,t),r=[e];e!==n;)e=e.parent,r.push(e);for(var i=r.length;t!==n;)r.splice(i,0,t),t=t.parent;return r}function Gp(t,e){if(t===e)return t;var n=t.ancestors(),r=e.ancestors(),i=null;for(t=n.pop(),e=r.pop();t===e;)i=t,t=n.pop(),e=r.pop();return i}function Kp(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e}function Xp(){return Array.from(this)}function Zp(){var t=[];return this.eachBefore(function(e){e.children||t.push(e)}),t}function Jp(){var t=this,e=[];return t.each(function(n){n!==t&&e.push({source:n.parent,target:n})}),e}function*Qp(){var t=this,e,n=[t],r,i,o;do for(e=n.reverse(),n=[];t=e.pop();)if(yield t,r=t.children)for(i=0,o=r.length;i<o;++i)n.push(r[i]);while(n.length)}function un(t,e){t instanceof Map?(t=[void 0,t],e===void 0&&(e=em)):e===void 0&&(e=tm);for(var n=new eo(t),r,i=[n],o,a,s,d;r=i.pop();)if((a=e(r.data))&&(d=(a=Array.from(a)).length))for(r.children=a,s=d-1;s>=0;--s)i.push(o=a[s]=new eo(a[s])),o.parent=r,o.depth=r.depth+1;return n.eachBefore(rm)}function jp(){return un(this).eachBefore(nm)}function tm(t){return t.children}function em(t){return Array.isArray(t)?t[1]:null}function nm(t){t.data.value!==void 0&&(t.value=t.data.value),t.data=t.data.data}function rm(t){var e=0;do t.height=e;while((t=t.parent)&&t.height<++e)}function eo(t){this.data=t,this.depth=this.height=0,this.parent=null}eo.prototype=un.prototype={constructor:eo,count:Up,each:Hp,eachAfter:Op,eachBefore:Bp,find:Vp,sum:Wp,sort:qp,path:Yp,ancestors:Kp,descendants:Xp,leaves:Zp,links:Jp,copy:jp,[Symbol.iterator]:Qp};function im(t){if(typeof t!="function")throw new Error;return t}function Vr(){return 0}function Wr(t){return function(){return t}}function om(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)}function am(t,e,n,r,i){for(var o=t.children,a,s=-1,d=o.length,c=t.value&&(r-e)/t.value;++s<d;)a=o[s],a.y0=n,a.y1=i,a.x0=e,a.x1=e+=a.value*c}function sm(t,e,n,r,i){for(var o=t.children,a,s=-1,d=o.length,c=t.value&&(i-n)/t.value;++s<d;)a=o[s],a.x0=e,a.x1=r,a.y0=n,a.y1=n+=a.value*c}var lm=(1+Math.sqrt(5))/2;function cm(t,e,n,r,i,o){for(var a=[],s=e.children,d,c,l=0,h=0,u=s.length,g,p,v=e.value,y,m,$,C,T,x,_;l<u;){g=i-n,p=o-r;do y=s[h++].value;while(!y&&h<u);for(m=$=y,x=Math.max(p/g,g/p)/(v*t),_=y*y*x,T=Math.max($/_,_/m);h<u;++h){if(y+=c=s[h].value,c<m&&(m=c),c>$&&($=c),_=y*y*x,C=Math.max($/_,_/m),C>T){y-=c;break}T=C}a.push(d={value:y,dice:g<p,children:s.slice(l,h)}),d.dice?am(d,n,r,i,v?r+=p*y/v:o):sm(d,n,r,v?n+=g*y/v:i,o),v-=y,l=h}return a}const um=function t(e){function n(r,i,o,a,s){cm(e,r,i,o,a,s)}return n.ratio=function(r){return t((r=+r)>1?r:1)},n}(lm);function Tc(){var t=um,e=!1,n=1,r=1,i=[0],o=Vr,a=Vr,s=Vr,d=Vr,c=Vr;function l(u){return u.x0=u.y0=0,u.x1=n,u.y1=r,u.eachBefore(h),i=[0],e&&u.eachBefore(om),u}function h(u){var g=i[u.depth],p=u.x0+g,v=u.y0+g,y=u.x1-g,m=u.y1-g;y<p&&(p=y=(p+y)/2),m<v&&(v=m=(v+m)/2),u.x0=p,u.y0=v,u.x1=y,u.y1=m,u.children&&(g=i[u.depth+1]=o(u)/2,p+=c(u)-g,v+=a(u)-g,y-=s(u)-g,m-=d(u)-g,y<p&&(p=y=(p+y)/2),m<v&&(v=m=(v+m)/2),t(u,p,v,y,m))}return l.round=function(u){return arguments.length?(e=!!u,l):e},l.size=function(u){return arguments.length?(n=+u[0],r=+u[1],l):[n,r]},l.tile=function(u){return arguments.length?(t=im(u),l):t},l.padding=function(u){return arguments.length?l.paddingInner(u).paddingOuter(u):l.paddingInner()},l.paddingInner=function(u){return arguments.length?(o=typeof u=="function"?u:Wr(+u),l):o},l.paddingOuter=function(u){return arguments.length?l.paddingTop(u).paddingRight(u).paddingBottom(u).paddingLeft(u):l.paddingTop()},l.paddingTop=function(u){return arguments.length?(a=typeof u=="function"?u:Wr(+u),l):a},l.paddingRight=function(u){return arguments.length?(s=typeof u=="function"?u:Wr(+u),l):s},l.paddingBottom=function(u){return arguments.length?(d=typeof u=="function"?u:Wr(+u),l):d},l.paddingLeft=function(u){return arguments.length?(c=typeof u=="function"?u:Wr(+u),l):c},l}function pi(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function fm(t,e){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof e=="function"?this.interpolator(e):this.range(e);break}}return this}const Ss=Symbol("implicit");function Ce(){var t=new vr,e=[],n=[],r=Ss;function i(o){let a=t.get(o);if(a===void 0){if(r!==Ss)return r;t.set(o,a=e.push(o)-1)}return n[a%n.length]}return i.domain=function(o){if(!arguments.length)return e.slice();e=[],t=new vr;for(const a of o)t.has(a)||t.set(a,e.push(a)-1);return i},i.range=function(o){return arguments.length?(n=Array.from(o),i):n.slice()},i.unknown=function(o){return arguments.length?(r=o,i):r},i.copy=function(){return Ce(e,n).unknown(r)},pi.apply(i,arguments),i}function Fa(){var t=Ce().unknown(void 0),e=t.domain,n=t.range,r=0,i=1,o,a,s=!1,d=0,c=0,l=.5;delete t.unknown;function h(){var u=e().length,g=i<r,p=g?i:r,v=g?r:i;o=(v-p)/Math.max(1,u-d+c*2),s&&(o=Math.floor(o)),p+=(v-p-o*(u-d))*l,a=o*(1-d),s&&(p=Math.round(p),a=Math.round(a));var y=Gf(u).map(function(m){return p+o*m});return n(g?y.reverse():y)}return t.domain=function(u){return arguments.length?(e(u),h()):e()},t.range=function(u){return arguments.length?([r,i]=u,r=+r,i=+i,h()):[r,i]},t.rangeRound=function(u){return[r,i]=u,r=+r,i=+i,s=!0,h()},t.bandwidth=function(){return a},t.step=function(){return o},t.round=function(u){return arguments.length?(s=!!u,h()):s},t.padding=function(u){return arguments.length?(d=Math.min(1,c=+u),h()):d},t.paddingInner=function(u){return arguments.length?(d=Math.min(1,u),h()):d},t.paddingOuter=function(u){return arguments.length?(c=+u,h()):c},t.align=function(u){return arguments.length?(l=Math.max(0,Math.min(1,u)),h()):l},t.copy=function(){return Fa(e(),[r,i]).round(s).paddingInner(d).paddingOuter(c).align(l)},pi.apply(h(),arguments)}function dm(t){return function(){return t}}function hm(t){return+t}var Es=[0,1];function Pn(t){return t}function la(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:dm(isNaN(e)?NaN:.5)}function gm(t,e){var n;return t>e&&(n=t,t=e,e=n),function(r){return Math.max(t,Math.min(e,r))}}function pm(t,e,n){var r=t[0],i=t[1],o=e[0],a=e[1];return i<r?(r=la(i,r),o=n(a,o)):(r=la(r,i),o=n(o,a)),function(s){return o(r(s))}}function mm(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),o=new Array(r),a=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<r;)i[a]=la(t[a],t[a+1]),o[a]=n(e[a],e[a+1]);return function(s){var d=Uf(t,s,1,r)-1;return o[d](i[d](s))}}function Ra(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function $c(){var t=Es,e=Es,n=Tr,r,i,o,a=Pn,s,d,c;function l(){var u=Math.min(t.length,e.length);return a!==Pn&&(a=gm(t[0],t[u-1])),s=u>2?mm:pm,d=c=null,h}function h(u){return u==null||isNaN(u=+u)?o:(d||(d=s(t.map(r),e,n)))(r(a(u)))}return h.invert=function(u){return a(i((c||(c=s(e,t.map(r),tn)))(u)))},h.domain=function(u){return arguments.length?(t=Array.from(u,hm),l()):t.slice()},h.range=function(u){return arguments.length?(e=Array.from(u),l()):e.slice()},h.rangeRound=function(u){return e=Array.from(u),n=lc,l()},h.clamp=function(u){return arguments.length?(a=u?!0:Pn,l()):a!==Pn},h.interpolate=function(u){return arguments.length?(n=u,l()):n},h.unknown=function(u){return arguments.length?(o=u,h):o},function(u,g){return r=u,i=g,l()}}function Cc(){return $c()(Pn,Pn)}function vm(t,e,n,r){var i=Qo(t,e,n),o;switch(r=ci(r??",f"),r.type){case"s":{var a=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(o=Fp(i,a))&&(r.precision=o),wc(r,a)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(o=Rp(i,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=o-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(o=Dp(i))&&(r.precision=o-(r.type==="%")*2);break}}return Da(r)}function kc(t){var e=t.domain;return t.ticks=function(n){var r=e();return Zo(r[0],r[r.length-1],n??10)},t.tickFormat=function(n,r){var i=e();return vm(i[0],i[i.length-1],n??10,r)},t.nice=function(n){n==null&&(n=10);var r=e(),i=0,o=r.length-1,a=r[i],s=r[o],d,c,l=10;for(s<a&&(c=a,a=s,s=c,c=i,i=o,o=c);l-- >0;){if(c=Jo(a,s,n),c===d)return r[i]=a,r[o]=s,e(r);if(c>0)a=Math.floor(a/c)*c,s=Math.ceil(s/c)*c;else if(c<0)a=Math.ceil(a*c)/c,s=Math.floor(s*c)/c;else break;d=c}return t},t}function ui(){var t=Cc();return t.copy=function(){return Ra(t,ui())},pi.apply(t,arguments),kc(t)}function zc(t,e){t=t.slice();var n=0,r=t.length-1,i=t[n],o=t[r],a;return o<i&&(a=n,n=r,r=a,a=i,i=o,o=a),t[n]=e.floor(i),t[r]=e.ceil(o),t}function Is(t){return Math.log(t)}function Ls(t){return Math.exp(t)}function ym(t){return-Math.log(-t)}function _m(t){return-Math.exp(-t)}function xm(t){return isFinite(t)?+("1e"+t):t<0?0:t}function bm(t){return t===10?xm:t===Math.E?Math.exp:e=>Math.pow(t,e)}function wm(t){return t===Math.E?Math.log:t===10&&Math.log10||t===2&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}function Ns(t){return(e,n)=>-t(-e,n)}function Tm(t){const e=t(Is,Ls),n=e.domain;let r=10,i,o;function a(){return i=wm(r),o=bm(r),n()[0]<0?(i=Ns(i),o=Ns(o),t(ym,_m)):t(Is,Ls),e}return e.base=function(s){return arguments.length?(r=+s,a()):r},e.domain=function(s){return arguments.length?(n(s),a()):n()},e.ticks=s=>{const d=n();let c=d[0],l=d[d.length-1];const h=l<c;h&&([c,l]=[l,c]);let u=i(c),g=i(l),p,v;const y=s==null?10:+s;let m=[];if(!(r%1)&&g-u<y){if(u=Math.floor(u),g=Math.ceil(g),c>0){for(;u<=g;++u)for(p=1;p<r;++p)if(v=u<0?p/o(-u):p*o(u),!(v<c)){if(v>l)break;m.push(v)}}else for(;u<=g;++u)for(p=r-1;p>=1;--p)if(v=u>0?p/o(-u):p*o(u),!(v<c)){if(v>l)break;m.push(v)}m.length*2<y&&(m=Zo(c,l,y))}else m=Zo(u,g,Math.min(g-u,y)).map(o);return h?m.reverse():m},e.tickFormat=(s,d)=>{if(s==null&&(s=10),d==null&&(d=r===10?"s":","),typeof d!="function"&&(!(r%1)&&(d=ci(d)).precision==null&&(d.trim=!0),d=Da(d)),s===1/0)return d;const c=Math.max(1,r*s/e.ticks().length);return l=>{let h=l/o(Math.round(i(l)));return h*r<r-.5&&(h*=r),h<=c?d(l):""}},e.nice=()=>n(zc(n(),{floor:s=>o(Math.floor(i(s))),ceil:s=>o(Math.ceil(i(s)))})),e}function Mc(){const t=Tm($c()).domain([1,10]);return t.copy=()=>Ra(t,Mc()).base(t.base()),pi.apply(t,arguments),t}const Io=new Date,Lo=new Date;function de(t,e,n,r){function i(o){return t(o=arguments.length===0?new Date:new Date(+o)),o}return i.floor=o=>(t(o=new Date(+o)),o),i.ceil=o=>(t(o=new Date(o-1)),e(o,1),t(o),o),i.round=o=>{const a=i(o),s=i.ceil(o);return o-a<s-o?a:s},i.offset=(o,a)=>(e(o=new Date(+o),a==null?1:Math.floor(a)),o),i.range=(o,a,s)=>{const d=[];if(o=i.ceil(o),s=s==null?1:Math.floor(s),!(o<a)||!(s>0))return d;let c;do d.push(c=new Date(+o)),e(o,s),t(o);while(c<o&&o<a);return d},i.filter=o=>de(a=>{if(a>=a)for(;t(a),!o(a);)a.setTime(a-1)},(a,s)=>{if(a>=a)if(s<0)for(;++s<=0;)for(;e(a,-1),!o(a););else for(;--s>=0;)for(;e(a,1),!o(a););}),n&&(i.count=(o,a)=>(Io.setTime(+o),Lo.setTime(+a),t(Io),t(Lo),Math.floor(n(Io,Lo))),i.every=o=>(o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?i.filter(r?a=>r(a)%o===0:a=>i.count(0,a)%o===0):i)),i}const no=de(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);no.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?de(e=>{e.setTime(Math.floor(e/t)*t)},(e,n)=>{e.setTime(+e+n*t)},(e,n)=>(n-e)/t):no);no.range;const xn=1e3,Ze=xn*60,bn=Ze*60,Mn=bn*24,Pa=Mn*7,Ds=Mn*30,No=Mn*365,fr=de(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*xn)},(t,e)=>(e-t)/xn,t=>t.getUTCSeconds());fr.range;const Ua=de(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*xn)},(t,e)=>{t.setTime(+t+e*Ze)},(t,e)=>(e-t)/Ze,t=>t.getMinutes());Ua.range;const $m=de(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*Ze)},(t,e)=>(e-t)/Ze,t=>t.getUTCMinutes());$m.range;const Ha=de(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*xn-t.getMinutes()*Ze)},(t,e)=>{t.setTime(+t+e*bn)},(t,e)=>(e-t)/bn,t=>t.getHours());Ha.range;const Cm=de(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*bn)},(t,e)=>(e-t)/bn,t=>t.getUTCHours());Cm.range;const mi=de(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Ze)/Mn,t=>t.getDate()-1);mi.range;const Ba=de(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/Mn,t=>t.getUTCDate()-1);Ba.range;const km=de(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/Mn,t=>Math.floor(t/Mn));km.range;function or(t){return de(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,n)=>{e.setDate(e.getDate()+n*7)},(e,n)=>(n-e-(n.getTimezoneOffset()-e.getTimezoneOffset())*Ze)/Pa)}const zo=or(0),ro=or(1),zm=or(2),Mm=or(3),kr=or(4),Am=or(5),Sm=or(6);zo.range;ro.range;zm.range;Mm.range;kr.range;Am.range;Sm.range;function ar(t){return de(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCDate(e.getUTCDate()+n*7)},(e,n)=>(n-e)/Pa)}const Ac=ar(0),io=ar(1),Em=ar(2),Im=ar(3),zr=ar(4),Lm=ar(5),Nm=ar(6);Ac.range;io.range;Em.range;Im.range;zr.range;Lm.range;Nm.range;const Oa=de(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12,t=>t.getMonth());Oa.range;const Dm=de(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());Dm.range;const An=de(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());An.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:de(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,n)=>{e.setFullYear(e.getFullYear()+n*t)});An.range;const rr=de(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());rr.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:de(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCFullYear(e.getUTCFullYear()+n*t)});rr.range;function Fm(t,e,n,r,i,o){const a=[[fr,1,xn],[fr,5,5*xn],[fr,15,15*xn],[fr,30,30*xn],[o,1,Ze],[o,5,5*Ze],[o,15,15*Ze],[o,30,30*Ze],[i,1,bn],[i,3,3*bn],[i,6,6*bn],[i,12,12*bn],[r,1,Mn],[r,2,2*Mn],[n,1,Pa],[e,1,Ds],[e,3,3*Ds],[t,1,No]];function s(c,l,h){const u=l<c;u&&([c,l]=[l,c]);const g=h&&typeof h.range=="function"?h:d(c,l,h),p=g?g.range(c,+l+1):[];return u?p.reverse():p}function d(c,l,h){const u=Math.abs(l-c)/h,g=Ca(([,,y])=>y).right(a,u);if(g===a.length)return t.every(Qo(c/No,l/No,h));if(g===0)return no.every(Math.max(Qo(c,l,h),1));const[p,v]=a[u/a[g-1][2]<a[g][2]/u?g-1:g];return p.every(v)}return[s,d]}const[Rm,Pm]=Fm(An,Oa,zo,mi,Ha,Ua);function Do(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Fo(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function qr(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function Um(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,o=t.days,a=t.shortDays,s=t.months,d=t.shortMonths,c=Yr(i),l=Gr(i),h=Yr(o),u=Gr(o),g=Yr(a),p=Gr(a),v=Yr(s),y=Gr(s),m=Yr(d),$=Gr(d),C={a:F,A:q,b:ct,B,c:null,d:Bs,e:Bs,f:lv,g:yv,G:xv,H:ov,I:av,j:sv,L:Sc,m:cv,M:uv,p:P,q:j,Q:Ws,s:qs,S:fv,u:dv,U:hv,V:gv,w:pv,W:mv,x:null,X:null,y:vv,Y:_v,Z:bv,"%":Vs},T={a:J,A:K,b:tt,B:ut,c:null,d:Os,e:Os,f:Cv,g:Dv,G:Rv,H:wv,I:Tv,j:$v,L:Ic,m:kv,M:zv,p:at,q:Y,Q:Ws,s:qs,S:Mv,u:Av,U:Sv,V:Ev,w:Iv,W:Lv,x:null,X:null,y:Nv,Y:Fv,Z:Pv,"%":Vs},x={a:b,A:I,b:S,B:R,c:W,d:Us,e:Us,f:ev,g:Ps,G:Rs,H:Hs,I:Hs,j:Jm,L:tv,m:Zm,M:Qm,p:U,q:Xm,Q:rv,s:iv,S:jm,u:Wm,U:qm,V:Ym,w:Vm,W:Gm,x:X,X:k,y:Ps,Y:Rs,Z:Km,"%":nv};C.x=_(n,C),C.X=_(r,C),C.c=_(e,C),T.x=_(n,T),T.X=_(r,T),T.c=_(e,T);function _(E,O){return function(A){var w=[],M=-1,H=0,Q=E.length,pt,ft,Z;for(A instanceof Date||(A=new Date(+A));++M<Q;)E.charCodeAt(M)===37&&(w.push(E.slice(H,M)),(ft=Fs[pt=E.charAt(++M)])!=null?pt=E.charAt(++M):ft=pt==="e"?" ":"0",(Z=O[pt])&&(pt=Z(A,ft)),w.push(pt),H=M+1);return w.push(E.slice(H,M)),w.join("")}}function z(E,O){return function(A){var w=qr(1900,void 0,1),M=N(w,E,A+="",0),H,Q;if(M!=A.length)return null;if("Q"in w)return new Date(w.Q);if("s"in w)return new Date(w.s*1e3+("L"in w?w.L:0));if(O&&!("Z"in w)&&(w.Z=0),"p"in w&&(w.H=w.H%12+w.p*12),w.m===void 0&&(w.m="q"in w?w.q:0),"V"in w){if(w.V<1||w.V>53)return null;"w"in w||(w.w=1),"Z"in w?(H=Fo(qr(w.y,0,1)),Q=H.getUTCDay(),H=Q>4||Q===0?io.ceil(H):io(H),H=Ba.offset(H,(w.V-1)*7),w.y=H.getUTCFullYear(),w.m=H.getUTCMonth(),w.d=H.getUTCDate()+(w.w+6)%7):(H=Do(qr(w.y,0,1)),Q=H.getDay(),H=Q>4||Q===0?ro.ceil(H):ro(H),H=mi.offset(H,(w.V-1)*7),w.y=H.getFullYear(),w.m=H.getMonth(),w.d=H.getDate()+(w.w+6)%7)}else("W"in w||"U"in w)&&("w"in w||(w.w="u"in w?w.u%7:"W"in w?1:0),Q="Z"in w?Fo(qr(w.y,0,1)).getUTCDay():Do(qr(w.y,0,1)).getDay(),w.m=0,w.d="W"in w?(w.w+6)%7+w.W*7-(Q+5)%7:w.w+w.U*7-(Q+6)%7);return"Z"in w?(w.H+=w.Z/100|0,w.M+=w.Z%100,Fo(w)):Do(w)}}function N(E,O,A,w){for(var M=0,H=O.length,Q=A.length,pt,ft;M<H;){if(w>=Q)return-1;if(pt=O.charCodeAt(M++),pt===37){if(pt=O.charAt(M++),ft=x[pt in Fs?O.charAt(M++):pt],!ft||(w=ft(E,A,w))<0)return-1}else if(pt!=A.charCodeAt(w++))return-1}return w}function U(E,O,A){var w=c.exec(O.slice(A));return w?(E.p=l.get(w[0].toLowerCase()),A+w[0].length):-1}function b(E,O,A){var w=g.exec(O.slice(A));return w?(E.w=p.get(w[0].toLowerCase()),A+w[0].length):-1}function I(E,O,A){var w=h.exec(O.slice(A));return w?(E.w=u.get(w[0].toLowerCase()),A+w[0].length):-1}function S(E,O,A){var w=m.exec(O.slice(A));return w?(E.m=$.get(w[0].toLowerCase()),A+w[0].length):-1}function R(E,O,A){var w=v.exec(O.slice(A));return w?(E.m=y.get(w[0].toLowerCase()),A+w[0].length):-1}function W(E,O,A){return N(E,e,O,A)}function X(E,O,A){return N(E,n,O,A)}function k(E,O,A){return N(E,r,O,A)}function F(E){return a[E.getDay()]}function q(E){return o[E.getDay()]}function ct(E){return d[E.getMonth()]}function B(E){return s[E.getMonth()]}function P(E){return i[+(E.getHours()>=12)]}function j(E){return 1+~~(E.getMonth()/3)}function J(E){return a[E.getUTCDay()]}function K(E){return o[E.getUTCDay()]}function tt(E){return d[E.getUTCMonth()]}function ut(E){return s[E.getUTCMonth()]}function at(E){return i[+(E.getUTCHours()>=12)]}function Y(E){return 1+~~(E.getUTCMonth()/3)}return{format:function(E){var O=_(E+="",C);return O.toString=function(){return E},O},parse:function(E){var O=z(E+="",!1);return O.toString=function(){return E},O},utcFormat:function(E){var O=_(E+="",T);return O.toString=function(){return E},O},utcParse:function(E){var O=z(E+="",!0);return O.toString=function(){return E},O}}}var Fs={"-":"",_:" ",0:"0"},me=/^\s*\d+/,Hm=/^%/,Bm=/[\\^$*+?|[\]().{}]/g;function Jt(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(e)+i:i)}function Om(t){return t.replace(Bm,"\\$&")}function Yr(t){return new RegExp("^(?:"+t.map(Om).join("|")+")","i")}function Gr(t){return new Map(t.map((e,n)=>[e.toLowerCase(),n]))}function Vm(t,e,n){var r=me.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function Wm(t,e,n){var r=me.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function qm(t,e,n){var r=me.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function Ym(t,e,n){var r=me.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function Gm(t,e,n){var r=me.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function Rs(t,e,n){var r=me.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function Ps(t,e,n){var r=me.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function Km(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Xm(t,e,n){var r=me.exec(e.slice(n,n+1));return r?(t.q=r[0]*3-3,n+r[0].length):-1}function Zm(t,e,n){var r=me.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function Us(t,e,n){var r=me.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function Jm(t,e,n){var r=me.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function Hs(t,e,n){var r=me.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function Qm(t,e,n){var r=me.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function jm(t,e,n){var r=me.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function tv(t,e,n){var r=me.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function ev(t,e,n){var r=me.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function nv(t,e,n){var r=Hm.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function rv(t,e,n){var r=me.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function iv(t,e,n){var r=me.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function Bs(t,e){return Jt(t.getDate(),e,2)}function ov(t,e){return Jt(t.getHours(),e,2)}function av(t,e){return Jt(t.getHours()%12||12,e,2)}function sv(t,e){return Jt(1+mi.count(An(t),t),e,3)}function Sc(t,e){return Jt(t.getMilliseconds(),e,3)}function lv(t,e){return Sc(t,e)+"000"}function cv(t,e){return Jt(t.getMonth()+1,e,2)}function uv(t,e){return Jt(t.getMinutes(),e,2)}function fv(t,e){return Jt(t.getSeconds(),e,2)}function dv(t){var e=t.getDay();return e===0?7:e}function hv(t,e){return Jt(zo.count(An(t)-1,t),e,2)}function Ec(t){var e=t.getDay();return e>=4||e===0?kr(t):kr.ceil(t)}function gv(t,e){return t=Ec(t),Jt(kr.count(An(t),t)+(An(t).getDay()===4),e,2)}function pv(t){return t.getDay()}function mv(t,e){return Jt(ro.count(An(t)-1,t),e,2)}function vv(t,e){return Jt(t.getFullYear()%100,e,2)}function yv(t,e){return t=Ec(t),Jt(t.getFullYear()%100,e,2)}function _v(t,e){return Jt(t.getFullYear()%1e4,e,4)}function xv(t,e){var n=t.getDay();return t=n>=4||n===0?kr(t):kr.ceil(t),Jt(t.getFullYear()%1e4,e,4)}function bv(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Jt(e/60|0,"0",2)+Jt(e%60,"0",2)}function Os(t,e){return Jt(t.getUTCDate(),e,2)}function wv(t,e){return Jt(t.getUTCHours(),e,2)}function Tv(t,e){return Jt(t.getUTCHours()%12||12,e,2)}function $v(t,e){return Jt(1+Ba.count(rr(t),t),e,3)}function Ic(t,e){return Jt(t.getUTCMilliseconds(),e,3)}function Cv(t,e){return Ic(t,e)+"000"}function kv(t,e){return Jt(t.getUTCMonth()+1,e,2)}function zv(t,e){return Jt(t.getUTCMinutes(),e,2)}function Mv(t,e){return Jt(t.getUTCSeconds(),e,2)}function Av(t){var e=t.getUTCDay();return e===0?7:e}function Sv(t,e){return Jt(Ac.count(rr(t)-1,t),e,2)}function Lc(t){var e=t.getUTCDay();return e>=4||e===0?zr(t):zr.ceil(t)}function Ev(t,e){return t=Lc(t),Jt(zr.count(rr(t),t)+(rr(t).getUTCDay()===4),e,2)}function Iv(t){return t.getUTCDay()}function Lv(t,e){return Jt(io.count(rr(t)-1,t),e,2)}function Nv(t,e){return Jt(t.getUTCFullYear()%100,e,2)}function Dv(t,e){return t=Lc(t),Jt(t.getUTCFullYear()%100,e,2)}function Fv(t,e){return Jt(t.getUTCFullYear()%1e4,e,4)}function Rv(t,e){var n=t.getUTCDay();return t=n>=4||n===0?zr(t):zr.ceil(t),Jt(t.getUTCFullYear()%1e4,e,4)}function Pv(){return"+0000"}function Vs(){return"%"}function Ws(t){return+t}function qs(t){return Math.floor(+t/1e3)}var cr,Un;Uv({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Uv(t){return cr=Um(t),Un=cr.format,cr.parse,cr.utcFormat,cr.utcParse,cr}function Hv(t){return new Date(t)}function Bv(t){return t instanceof Date?+t:+new Date(+t)}function Nc(t,e,n,r,i,o,a,s,d,c){var l=Cc(),h=l.invert,u=l.domain,g=c(".%L"),p=c(":%S"),v=c("%I:%M"),y=c("%I %p"),m=c("%a %d"),$=c("%b %d"),C=c("%B"),T=c("%Y");function x(_){return(d(_)<_?g:s(_)<_?p:a(_)<_?v:o(_)<_?y:r(_)<_?i(_)<_?m:$:n(_)<_?C:T)(_)}return l.invert=function(_){return new Date(h(_))},l.domain=function(_){return arguments.length?u(Array.from(_,Bv)):u().map(Hv)},l.ticks=function(_){var z=u();return t(z[0],z[z.length-1],_??10)},l.tickFormat=function(_,z){return z==null?x:c(z)},l.nice=function(_){var z=u();return(!_||typeof _.range!="function")&&(_=e(z[0],z[z.length-1],_??10)),_?u(zc(z,_)):l},l.copy=function(){return Ra(l,Nc(t,e,n,r,i,o,a,s,d,c))},l}function Dc(){return pi.apply(Nc(Rm,Pm,An,Oa,zo,mi,Ha,Ua,fr,Un).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Ov(){var t=0,e=1,n,r,i,o,a=Pn,s=!1,d;function c(h){return h==null||isNaN(h=+h)?d:a(i===0?.5:(h=(o(h)-n)*i,s?Math.max(0,Math.min(1,h)):h))}c.domain=function(h){return arguments.length?([t,e]=h,n=o(t=+t),r=o(e=+e),i=n===r?0:1/(r-n),c):[t,e]},c.clamp=function(h){return arguments.length?(s=!!h,c):s},c.interpolator=function(h){return arguments.length?(a=h,c):a};function l(h){return function(u){var g,p;return arguments.length?([g,p]=u,a=h(g,p),c):[a(0),a(1)]}}return c.range=l(Tr),c.rangeRound=l(lc),c.unknown=function(h){return arguments.length?(d=h,c):d},function(h){return o=h,n=h(t),r=h(e),i=n===r?0:1/(r-n),c}}function Vv(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function ca(){var t=kc(Ov()(Pn));return t.copy=function(){return Vv(t,ca())},fm.apply(t,arguments)}function Mo(t){for(var e=t.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+t.slice(r*6,++r*6);return n}const rn=Mo("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),Wv=Mo("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),Fc=t=>eg(t[t.length-1]);var qv=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(Mo);const Yv=Fc(qv);var Gv=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(Mo);const Kv=Fc(Gv);function oe(t){return function(){return t}}const Ys=Math.abs,we=Math.atan2,Kn=Math.cos,Xv=Math.max,Ro=Math.min,ln=Math.sin,dr=Math.sqrt,Ne=1e-12,fi=Math.PI,oo=fi/2,Di=2*fi;function Zv(t){return t>1?0:t<-1?fi:Math.acos(t)}function Gs(t){return t>=1?oo:t<=-1?-oo:Math.asin(t)}function Rc(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(n==null)e=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);e=r}return t},()=>new kp(e)}function Jv(t){return t.innerRadius}function Qv(t){return t.outerRadius}function jv(t){return t.startAngle}function t0(t){return t.endAngle}function e0(t){return t&&t.padAngle}function n0(t,e,n,r,i,o,a,s){var d=n-t,c=r-e,l=a-i,h=s-o,u=h*d-l*c;if(!(u*u<Ne))return u=(l*(e-o)-h*(t-i))/u,[t+u*d,e+u*c]}function ki(t,e,n,r,i,o,a){var s=t-n,d=e-r,c=(a?o:-o)/dr(s*s+d*d),l=c*d,h=-c*s,u=t+l,g=e+h,p=n+l,v=r+h,y=(u+p)/2,m=(g+v)/2,$=p-u,C=v-g,T=$*$+C*C,x=i-o,_=u*v-p*g,z=(C<0?-1:1)*dr(Xv(0,x*x*T-_*_)),N=(_*C-$*z)/T,U=(-_*$-C*z)/T,b=(_*C+$*z)/T,I=(-_*$+C*z)/T,S=N-y,R=U-m,W=b-y,X=I-m;return S*S+R*R>W*W+X*X&&(N=b,U=I),{cx:N,cy:U,x01:-l,y01:-h,x11:N*(i/x-1),y11:U*(i/x-1)}}function Po(){var t=Jv,e=Qv,n=oe(0),r=null,i=jv,o=t0,a=e0,s=null,d=Rc(c);function c(){var l,h,u=+t.apply(this,arguments),g=+e.apply(this,arguments),p=i.apply(this,arguments)-oo,v=o.apply(this,arguments)-oo,y=Ys(v-p),m=v>p;if(s||(s=l=d()),g<u&&(h=g,g=u,u=h),!(g>Ne))s.moveTo(0,0);else if(y>Di-Ne)s.moveTo(g*Kn(p),g*ln(p)),s.arc(0,0,g,p,v,!m),u>Ne&&(s.moveTo(u*Kn(v),u*ln(v)),s.arc(0,0,u,v,p,m));else{var $=p,C=v,T=p,x=v,_=y,z=y,N=a.apply(this,arguments)/2,U=N>Ne&&(r?+r.apply(this,arguments):dr(u*u+g*g)),b=Ro(Ys(g-u)/2,+n.apply(this,arguments)),I=b,S=b,R,W;if(U>Ne){var X=Gs(U/u*ln(N)),k=Gs(U/g*ln(N));(_-=X*2)>Ne?(X*=m?1:-1,T+=X,x-=X):(_=0,T=x=(p+v)/2),(z-=k*2)>Ne?(k*=m?1:-1,$+=k,C-=k):(z=0,$=C=(p+v)/2)}var F=g*Kn($),q=g*ln($),ct=u*Kn(x),B=u*ln(x);if(b>Ne){var P=g*Kn(C),j=g*ln(C),J=u*Kn(T),K=u*ln(T),tt;if(y<fi)if(tt=n0(F,q,J,K,P,j,ct,B)){var ut=F-tt[0],at=q-tt[1],Y=P-tt[0],E=j-tt[1],O=1/ln(Zv((ut*Y+at*E)/(dr(ut*ut+at*at)*dr(Y*Y+E*E)))/2),A=dr(tt[0]*tt[0]+tt[1]*tt[1]);I=Ro(b,(u-A)/(O-1)),S=Ro(b,(g-A)/(O+1))}else I=S=0}z>Ne?S>Ne?(R=ki(J,K,F,q,g,S,m),W=ki(P,j,ct,B,g,S,m),s.moveTo(R.cx+R.x01,R.cy+R.y01),S<b?s.arc(R.cx,R.cy,S,we(R.y01,R.x01),we(W.y01,W.x01),!m):(s.arc(R.cx,R.cy,S,we(R.y01,R.x01),we(R.y11,R.x11),!m),s.arc(0,0,g,we(R.cy+R.y11,R.cx+R.x11),we(W.cy+W.y11,W.cx+W.x11),!m),s.arc(W.cx,W.cy,S,we(W.y11,W.x11),we(W.y01,W.x01),!m))):(s.moveTo(F,q),s.arc(0,0,g,$,C,!m)):s.moveTo(F,q),!(u>Ne)||!(_>Ne)?s.lineTo(ct,B):I>Ne?(R=ki(ct,B,P,j,u,-I,m),W=ki(F,q,J,K,u,-I,m),s.lineTo(R.cx+R.x01,R.cy+R.y01),I<b?s.arc(R.cx,R.cy,I,we(R.y01,R.x01),we(W.y01,W.x01),!m):(s.arc(R.cx,R.cy,I,we(R.y01,R.x01),we(R.y11,R.x11),!m),s.arc(0,0,u,we(R.cy+R.y11,R.cx+R.x11),we(W.cy+W.y11,W.cx+W.x11),m),s.arc(W.cx,W.cy,I,we(W.y11,W.x11),we(W.y01,W.x01),!m))):s.arc(0,0,u,x,T,m)}if(s.closePath(),l)return s=null,l+""||null}return c.centroid=function(){var l=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,h=(+i.apply(this,arguments)+ +o.apply(this,arguments))/2-fi/2;return[Kn(h)*l,ln(h)*l]},c.innerRadius=function(l){return arguments.length?(t=typeof l=="function"?l:oe(+l),c):t},c.outerRadius=function(l){return arguments.length?(e=typeof l=="function"?l:oe(+l),c):e},c.cornerRadius=function(l){return arguments.length?(n=typeof l=="function"?l:oe(+l),c):n},c.padRadius=function(l){return arguments.length?(r=l==null?null:typeof l=="function"?l:oe(+l),c):r},c.startAngle=function(l){return arguments.length?(i=typeof l=="function"?l:oe(+l),c):i},c.endAngle=function(l){return arguments.length?(o=typeof l=="function"?l:oe(+l),c):o},c.padAngle=function(l){return arguments.length?(a=typeof l=="function"?l:oe(+l),c):a},c.context=function(l){return arguments.length?(s=l??null,c):s},c}function Va(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Pc(t){this._context=t}Pc.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function r0(t){return new Pc(t)}function i0(t){return t[0]}function o0(t){return t[1]}function Ks(t,e){var n=oe(!0),r=null,i=r0,o=null,a=Rc(s);t=typeof t=="function"?t:t===void 0?i0:oe(t),e=typeof e=="function"?e:e===void 0?o0:oe(e);function s(d){var c,l=(d=Va(d)).length,h,u=!1,g;for(r==null&&(o=i(g=a())),c=0;c<=l;++c)!(c<l&&n(h=d[c],c,d))===u&&((u=!u)?o.lineStart():o.lineEnd()),u&&o.point(+t(h,c,d),+e(h,c,d));if(g)return o=null,g+""||null}return s.x=function(d){return arguments.length?(t=typeof d=="function"?d:oe(+d),s):t},s.y=function(d){return arguments.length?(e=typeof d=="function"?d:oe(+d),s):e},s.defined=function(d){return arguments.length?(n=typeof d=="function"?d:oe(!!d),s):n},s.curve=function(d){return arguments.length?(i=d,r!=null&&(o=i(r)),s):i},s.context=function(d){return arguments.length?(d==null?r=o=null:o=i(r=d),s):r},s}function a0(t,e){return e<t?-1:e>t?1:e>=t?0:NaN}function s0(t){return t}function l0(){var t=s0,e=a0,n=null,r=oe(0),i=oe(Di),o=oe(0);function a(s){var d,c=(s=Va(s)).length,l,h,u=0,g=new Array(c),p=new Array(c),v=+r.apply(this,arguments),y=Math.min(Di,Math.max(-Di,i.apply(this,arguments)-v)),m,$=Math.min(Math.abs(y)/c,o.apply(this,arguments)),C=$*(y<0?-1:1),T;for(d=0;d<c;++d)(T=p[g[d]=d]=+t(s[d],d,s))>0&&(u+=T);for(e!=null?g.sort(function(x,_){return e(p[x],p[_])}):n!=null&&g.sort(function(x,_){return n(s[x],s[_])}),d=0,h=u?(y-c*C)/u:0;d<c;++d,v=m)l=g[d],T=p[l],m=v+(T>0?T*h:0)+C,p[l]={data:s[l],index:d,value:T,startAngle:v,endAngle:m,padAngle:$};return p}return a.value=function(s){return arguments.length?(t=typeof s=="function"?s:oe(+s),a):t},a.sortValues=function(s){return arguments.length?(e=s,n=null,a):e},a.sort=function(s){return arguments.length?(n=s,e=null,a):n},a.startAngle=function(s){return arguments.length?(r=typeof s=="function"?s:oe(+s),a):r},a.endAngle=function(s){return arguments.length?(i=typeof s=="function"?s:oe(+s),a):i},a.padAngle=function(s){return arguments.length?(o=typeof s=="function"?s:oe(+s),a):o},a}function Xs(t){return t<0?-1:1}function Zs(t,e,n){var r=t._x1-t._x0,i=e-t._x1,o=(t._y1-t._y0)/(r||i<0&&-0),a=(n-t._y1)/(i||r<0&&-0),s=(o*i+a*r)/(r+i);return(Xs(o)+Xs(a))*Math.min(Math.abs(o),Math.abs(a),.5*Math.abs(s))||0}function Js(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function Uo(t,e,n){var r=t._x0,i=t._y0,o=t._x1,a=t._y1,s=(o-r)/3;t._context.bezierCurveTo(r+s,i+s*e,o-s,a-s*n,o,a)}function ao(t){this._context=t}ao.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Uo(this,this._t0,Js(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,Uo(this,Js(this,n=Zs(this,t,e)),n);break;default:Uo(this,this._t0,n=Zs(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}};Object.create(ao.prototype).point=function(t,e){ao.prototype.point.call(this,e,t)};function Qs(t){return new ao(t)}function js(t,e){if((a=t.length)>1)for(var n=1,r,i,o=t[e[0]],a,s=o.length;n<a;++n)for(i=o,o=t[e[n]],r=0;r<s;++r)o[r][1]+=o[r][0]=isNaN(i[r][1])?i[r][0]:i[r][1]}function tl(t){for(var e=t.length,n=new Array(e);--e>=0;)n[e]=e;return n}function c0(t,e){return t[e]}function u0(t){const e=[];return e.key=t,e}function f0(){var t=oe([]),e=tl,n=js,r=c0;function i(o){var a=Array.from(t.apply(this,arguments),u0),s,d=a.length,c=-1,l;for(const h of o)for(s=0,++c;s<d;++s)(a[s][c]=[0,+r(h,a[s].key,c,o)]).data=h;for(s=0,l=Va(e(a));s<d;++s)a[l[s]].index=s;return n(a,l),a}return i.keys=function(o){return arguments.length?(t=typeof o=="function"?o:oe(Array.from(o)),i):t},i.value=function(o){return arguments.length?(r=typeof o=="function"?o:oe(+o),i):r},i.order=function(o){return arguments.length?(e=o==null?tl:typeof o=="function"?o:oe(Array.from(o)),i):e},i.offset=function(o){return arguments.length?(n=o??js,i):n},i}function Qr(t,e,n){this.k=t,this.x=e,this.y=n}Qr.prototype={constructor:Qr,scale:function(t){return t===1?this:new Qr(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new Qr(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};Qr.prototype;function d0(t){const e=t-1;return e*e*e+1}function h0(t,{delay:e=0,duration:n=400,easing:r=d0,axis:i="y"}={}){const o=getComputedStyle(t),a=+o.opacity,s=i==="y"?"height":"width",d=parseFloat(o[s]),c=i==="y"?["top","bottom"]:["left","right"],l=c.map(m=>`${m[0].toUpperCase()}${m.slice(1)}`),h=parseFloat(o[`padding${l[0]}`]),u=parseFloat(o[`padding${l[1]}`]),g=parseFloat(o[`margin${l[0]}`]),p=parseFloat(o[`margin${l[1]}`]),v=parseFloat(o[`border${l[0]}Width`]),y=parseFloat(o[`border${l[1]}Width`]);return{delay:e,duration:n,easing:r,css:m=>`overflow: hidden;opacity: ${Math.min(m*20,1)*a};${s}: ${m*d}px;padding-${c[0]}: ${m*h}px;padding-${c[1]}: ${m*u}px;margin-${c[0]}: ${m*g}px;margin-${c[1]}: ${m*p}px;border-${c[0]}-width: ${m*v}px;border-${c[1]}-width: ${m*y}px;min-${s}: 0`}}var g0=$t('<button class="p-xs flex items-center justify-center rounded-full cursor-pointer bg-card border border-solid border-light info-button svelte-dipw5r" type="button"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-primary"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg> <span class="sr-only"> </span></button>'),p0=$t('<div class="absolute top-100 left-0 right-0 bg-card rounded p-md mt-xs border border-solid border-default shadow-lg z-popover description svelte-dipw5r" role="region"><p class="m-0 text-secondary text-sm"> </p></div>'),m0=$t('<div><div class="flex items-center gap-sm pb-sm bg-page relative z-above title-container"><h2 class="m-0 text-lg text-primary flex-1"><!></h2> <!></div> <!></div>');function v0(t,e){ke(e,!1);const[n,r]=on(),i=()=>xt(f(d),"$hideInfoText",n),o=()=>xt(f(c),"$showInfoText",n),a=()=>xt(f(l),"$visualizationDescriptionText",n),s=()=>xt(f(h),"$descriptionText",n),d=bt(),c=bt(),l=bt(),h=bt();let u=ee(e,"title",8,""),g=ee(e,"description",8,""),p=ee(e,"descriptionTranslationKey",8,""),v=ee(e,"showDescription",12,!1),y=ee(e,"descriptionId",8),m=ee(e,"className",8,""),$=bt(),C=bt();function T(W){W.stopPropagation(),W.preventDefault(),v(!v())}function x(W){if(!v())return;const X=W.target,k=f($)&&!f($).contains(X),F=f(C)&&!f(C).contains(X);k&&F&&v(!1)}Ye(()=>{document.addEventListener("click",x)}),In(()=>{document.removeEventListener("click",x)}),pe(()=>rt,()=>{bi(D(d,rt("ui.hide_info")),"$hideInfoText",n)}),pe(()=>rt,()=>{bi(D(c,rt("ui.show_info")),"$showInfoText",n)}),pe(()=>rt,()=>{bi(D(l,rt("ui.visualization_description")),"$visualizationDescriptionText",n)}),pe(()=>(De(p()),rt),()=>{bi(D(h,p()?rt(p()):void 0),"$descriptionText",n)}),hi(),Ue();var _=m0(),z=L(_),N=L(z),U=L(N);Rl(U,u);var b=_t(N,2);{var I=W=>{var X=g0(),k=_t(L(X),2),F=L(k);We(X,q=>D($,q),()=>f($)),It(()=>{ye(X,"aria-expanded",v()),ye(X,"aria-controls",y()),lt(F,v()?i():o())}),_e("click",X,T),nt(W,X)};Ot(b,W=>{(g()||p())&&W(I)})}var S=_t(z,2);{var R=W=>{var X=p0(),k=L(X),F=L(k);We(X,q=>D(C,q),()=>f(C)),It(()=>{ye(X,"id",y()),ye(X,"aria-label",a()),lt(F,p()?s():g())}),gf(3,X,()=>h0,()=>({duration:150,easing:q=>q})),nt(W,X)};Ot(S,W=>{v()&&(g()||p())&&W(R)})}It(()=>wo(_,`mb-md relative visualization-header ${m()??""} svelte-dipw5r`)),nt(t,_),ze(),r()}function Ao(t={}){const{backgroundColor:e="rgba(0, 0, 0, 0.8)",color:n="white",padding:r="8px 12px",borderRadius:i="4px",fontSize:o="12px",zIndex:a="1000",boxShadow:s="0 2px 5px rgba(0,0,0,0.2)",defaultWidth:d=200,defaultHeight:c=100,offset:l=10}=t;let h=null;function u(){try{h&&document.body.contains(h)&&document.body.removeChild(h),h=document.createElement("div"),h.style.position="absolute",h.style.backgroundColor=e,h.style.color=n,h.style.padding=r,h.style.borderRadius=i,h.style.pointerEvents="none",h.style.display="none",h.style.fontSize=o,h.style.zIndex=a,h.style.boxShadow=s,t.maxWidth&&(h.style.maxWidth=t.maxWidth),t.whiteSpace&&(h.style.whiteSpace=t.whiteSpace),document&&document.body&&document.body.appendChild(h)}catch(m){console.error("Error creating tooltip:",m),h=null}}function g(m,$,C=d,T=c){try{if((!h||!document.body.contains(h))&&u(),!h)return;h.innerHTML=$;const x=p(m,C,T);h.style.left=`${x.left}px`,h.style.top=`${x.top}px`,h.style.display="block"}catch(x){console.error("Error showing tooltip:",x)}}function p(m,$=d,C=c){try{let T=m.pageX+l,x=m.pageY+l;return T+$>window.innerWidth&&(T=m.pageX-$-l),x+C>window.innerHeight&&(x=m.pageY-C-l),{left:T,top:x}}catch(T){return console.error("Error calculating tooltip position:",T),{left:window.innerWidth/2-$/2,top:window.innerHeight/2-C/2}}}function v(){try{h&&document.body.contains(h)&&(h.style.display="none")}catch(m){console.error("Error hiding tooltip:",m)}}function y(m){try{h&&document.body.contains(h)&&(h.innerHTML=m)}catch($){console.error("Error updating tooltip content:",$)}}return Ye(()=>{u()}),In(()=>{h&&document.body.contains(h)&&document.body.removeChild(h)}),{showTooltip:g,hideTooltip:v,updateTooltipContent:y,calculatePosition:p,getTooltipElement:()=>h}}function wn(t,e){const n=t?`<div class="font-bold mb-xs pb-xs border-b border-white border-opacity-30">
            ${t}
        </div>`:"",r=e.map(i=>`<span>${i.label}:</span><span class="text-right font-bold">${i.value}</span>`).join("");return`
        ${n}
        <div class="grid grid-cols-2 gap-xs">
            ${r}
        </div>
    `}var y0=$t('<div class="text-center text-secondary"> </div>'),_0=$t('<div class="text-center text-error" role="alert"> </div>'),x0=$t('<div class="text-center text-secondary"> </div>'),b0=$t('<div class="empty-visualization svelte-hwelso" aria-live="polite"><!></div>'),w0=$t('<div role="region"><!> <div class="w-full flex-1 flex flex-col relative z-base visualization-content" role="presentation"><!></div></div>');function Nr(t,e){ke(e,!1);const[n,r]=on(),i=()=>xt(fe,"$itemsStore",n),o=bt(),a=bt(),s=bt(),d=bt(),c=bt();let l=ee(e,"title",8,""),h=ee(e,"translationKey",8,""),u=ee(e,"titleHtml",8,""),g=ee(e,"description",8,""),p=ee(e,"descriptionTranslationKey",8,""),v=ee(e,"showDescription",12,!1),y=ee(e,"ariaLabel",8,"");const m=`viz-desc-${Math.random().toString(36).slice(2,11)}`;let $=ee(e,"enableResizeObserver",8,!0),C=bt(),T;const x=Bl();let _=ee(e,"theme",8,"default"),z=ee(e,"customBackground",8,""),N=ee(e,"customTextColor",8,""),U=ee(e,"minHeight",8,"400px"),b=ee(e,"padding",8,"var(--spacing-md)"),I=ee(e,"className",8,""),S=ee(e,"enableTooltip",8,!0),R=ee(e,"tooltipBackgroundColor",8,"rgba(0, 0, 0, 0.8)"),W=ee(e,"tooltipTextColor",8,"white"),X=ee(e,"tooltipMaxWidth",8,"250px");const k=S()?Ao({backgroundColor:R(),color:W(),maxWidth:X()}):null;function F(tt,ut,at,Y){S()&&k&&k.showTooltip(tt,ut,at,Y)}function q(){S()&&k&&k.hideTooltip()}function ct(tt){S()&&k&&k.updateTooltipContent(tt)}Ye(()=>{$()&&f(C)&&(T=new ResizeObserver(tt=>{const ut=tt[0];if(ut){const{width:at,height:Y}=ut.contentRect;x("resize",{width:at,height:Y})}}),T.observe(f(C)))}),In(()=>{T&&f(C)&&(T.unobserve(f(C)),T.disconnect())}),pe(()=>(De(U()),De(b()),De(z()),De(N())),()=>{D(o,`
        min-height: ${U()};
        padding: ${b()};
        ${z()?`background: ${z()};`:""}
        ${N()?`color: ${N()};`:""}
    `)}),pe(()=>(De(u()),De(h()),De(l())),()=>{D(a,u()||(h()?ot(h()):l()))}),pe(()=>(De(p()),De(g())),()=>{D(s,p()?ot(p()):g())}),pe(()=>(De(y()),f(a)),()=>{D(d,y()||f(a))}),pe(()=>(De(g()),De(p())),()=>{D(c,!!(g()||p()))}),hi(),Ue();var B=w0(),P=L(B);v0(P,{get title(){return f(a)},get description(){return g()},get descriptionTranslationKey(){return p()},descriptionId:m,className:"z-above",get showDescription(){return v()},set showDescription(tt){v(tt)},$$legacy:!0});var j=_t(P,2),J=L(j);Pl(J,e,"default",{},tt=>{var ut=b0(),at=L(ut);{var Y=O=>{var A=y0(),w=L(A);It(M=>lt(w,M),[()=>ot("ui.loading")],ie),nt(O,A)},E=O=>{var A=se(),w=jt(A);{var M=Q=>{var pt=_0(),ft=L(pt);It(()=>lt(ft,i().error)),nt(Q,pt)},H=Q=>{var pt=x0(),ft=L(pt);It(Z=>lt(ft,Z),[()=>ot("ui.no_visualization_content")],ie),nt(Q,pt)};Ot(w,Q=>{i().error?Q(M):Q(H,!1)},!0)}nt(O,A)};Ot(at,O=>{i().loading?O(Y):O(E,!1)})}It(()=>ye(ut,"style",f(o))),nt(tt,ut)}),We(j,tt=>D(C,tt),()=>f(C)),It(()=>{wo(B,`w-full flex flex-col relative visualization-wrapper ${_()??""} ${I()??""} svelte-hwelso`),ye(B,"aria-label",f(d)),ye(B,"aria-describedby",f(c)?m:void 0)}),nt(t,B),_i(e,"showTooltip",F),_i(e,"hideTooltip",q),_i(e,"updateTooltipContent",ct),_i(e,"createGridTooltipContent",wn);var K=ze({showTooltip:F,hideTooltip:q,updateTooltipContent:ct,createGridTooltipContent:wn});return r(),K}const hr={news_article:{id:"news_article",nameEn:"News article",nameFr:"Article de presse",description:"Newspaper and magazine articles"},islamic_periodical:{id:"islamic_periodical",nameEn:"Islamic periodical",nameFr:"Périodique islamique",description:"Islamic magazines and periodicals"},documents:{id:"documents",nameEn:"Documents",nameFr:"Documents divers",description:"Various documents"},photographs:{id:"photographs",nameEn:"Photographs",nameFr:"Photographies",description:"Photographs and images"},video_recording:{id:"video_recording",nameEn:"Video recording",nameFr:"Enregistrement vidéo",description:"Video recordings and footage"},references:{id:"references",nameEn:"References",nameFr:"Références",description:"Reference materials"},other:{id:"other",nameEn:"Other",nameFr:"Autre",description:"Uncategorized items"}},T0={"24h au Bénin":"news_article","Agence Bénin Presse":"news_article",Banouto:"news_article","Bénin Intelligent":"news_article","Boulevard des Infos":"news_article","Daho-Express":"news_article",Ehuzu:"news_article",Fraternité:"news_article","L'Evénement Précis":"news_article","La Nation":"news_article","La Nouvelle Tribune":"news_article","Le Matinal":"news_article","Les Pharaons":"news_article","Matin Libre":"news_article","Burkina 24":"news_article","Carrefour africain":"news_article",FasoZine:"news_article","L'Evénement":"news_article","L'Observateur":"news_article","L'Observateur Paalga":"news_article","Le Pays":"news_article","LeFaso.net":"news_article",Mutations:"news_article","San Finna":"news_article",Sidwaya:"news_article","Agence Ivoirienne de Presse":"news_article","Fraternité Hebdo":"news_article","Fraternité Matin":"news_article","Ivoire Dimanche":"news_article","L'Alternative":"news_article","L'Intelligent d'Abidjan":"news_article","La Voie":"news_article","Le Jour":"news_article","Le Jour Plus":"news_article","Le Nouvel Horizon":"news_article","Le Patriote":"news_article","Notre Temps":"news_article","Notre Voie":"news_article","Le Sahel":"news_article","Agence Togolaise de Presse":"news_article","Atopani Express":"news_article","Courrier du Golfe":"news_article","Forum Hebdo":"news_article","La Lettre de Tchaoudjo":"news_article","La Nouvelle Marche":"news_article","Le Démocrate":"news_article","L'éveil du Peuple":"news_article","Togo-Presse":"news_article",ASSALAM:"islamic_periodical","Islam Hebdo":"islamic_periodical","Al Mawadda":"islamic_periodical","An-Nasr Trimestriel":"islamic_periodical","An-Nasr Vendredi":"islamic_periodical","L'Appel":"islamic_periodical","L'Autre Regard":"islamic_periodical","La Preuve":"islamic_periodical","Le CERFIste":"islamic_periodical","Le vrai visage de l'islam":"islamic_periodical","AJMCI Infos":"islamic_periodical","Al Minbar":"islamic_periodical","Al Muwassat Info":"islamic_periodical","Al-Azan":"islamic_periodical",Alif:"islamic_periodical","Allahou Akbar":"islamic_periodical","Bulletin d'information du CNI":"islamic_periodical","Islam Info":"islamic_periodical","Les Échos de l'AEEMCI":"islamic_periodical","Plume Libre":"islamic_periodical","Al Maoulid Info":"islamic_periodical","Al Maoulid Magazine":"islamic_periodical","Al Maoulid Magazine (arabe)":"islamic_periodical","Le Pacific":"islamic_periodical","Le Rendez-Vous":"islamic_periodical","Documents divers (Burkina Faso)":"documents","Documents divers (Bénin)":"documents","Documents divers (Côte d'Ivoire)":"documents","Documents divers (Niger)":"documents","Documents divers (Togo)":"documents","Photographies (Burkina Faso)":"photographs","Photographies (Bénin)":"photographs","Photographies (Côte d'Ivoire)":"photographs","Photographies (Niger)":"photographs","Photographies (Togo)":"photographs","Collection de sermons islamiques sur vidéo":"video_recording","Références (Bénin)":"references","Références (Burkina Faso)":"references","Références (Côte d'Ivoire)":"references","Références (Niger)":"references","Références (Nigéria)":"references","Références (Togo)":"references"};function el(t,e){const n=hr[t]||hr.other;return e==="fr"?n.nameFr:n.nameEn}function Dr(t){const{container:e,onResize:n,debounce:r=!0,debounceDelay:i=100}=t;let o=0,a=0,s=null,d=null;function c(){if(!e)return;const h=e.getBoundingClientRect(),u=Math.abs(o-h.width)>1,g=Math.abs(a-h.height)>1;if(!u&&!g)return;o=h.width;const p=window.getComputedStyle(e);p.height!=="auto"&&!p.height.includes("%")||(a=h.height),r?(d!==null&&window.clearTimeout(d),d=window.setTimeout(()=>{n()},i)):n()}e&&(c(),s=new ResizeObserver(()=>{c()}),s.observe(e));function l(){s&&(s.disconnect(),s=null),d!==null&&(window.clearTimeout(d),d=null)}return{width:o,height:a,dimensions:{width:o,height:a},updateDimensions:c,cleanup:l}}function Oe(t={}){const{filterMissingValues:e=!0,requiredFields:n=[],filterFn:r,calculatePercentages:i=!0,sortByCount:o=!0,sortDescending:a=!0}=t;function s(h){if(!h||h.length===0)return[];let u=[...h];return r&&(u=u.filter(r)),e&&n.length>0&&(u=u.filter(g=>n.every(p=>g[p]!==void 0&&g[p]!==null&&g[p]!==""))),u}function d(h,u,g){const p=s(h),v=g||p.length,y=ls(p,$=>$.length,u),m=Array.from(y,([$,C])=>{const T={key:$,count:C,originalKey:$};return i&&(T.percentage=C/v*100),T});return o&&m.sort(($,C)=>a?C.count-$.count:$.count-C.count),m}function c(h,u,g){const p=s(h),v=g||p.length,y=ka(p,...u);function m($,C=0){return Array.from($,([T,x])=>{const _={name:T,originalName:T,value:x instanceof vr?0:x.length,itemCount:x instanceof vr?0:x.length};return i&&(_.percentage=_.value/v*100),x instanceof vr&&(_.children=m(x,C+1),_.value=_.children.reduce((z,N)=>z+N.value,0),_.itemCount=_.value),_})}return{name:"root",children:m(y)}}function l(h,u,g={}){try{const p=s(h),{startDate:v,endDate:y,includeCumulative:m=!0,initialTotal:$=0}=g;console.log("[useDataProcessing] Processing time data for",p.length,"items"),console.log("[useDataProcessing] Date range:",{startDate:v,endDate:y}),$>0&&console.log("[useDataProcessing] Using initial total of",$);const C=p.filter(_=>{try{const z=_[u];if(!z)return!1;const N=new Date(z),U=!isNaN(N.getTime()),b=!v||N>=v,I=!y||N<=y;return U&&b&&I}catch{return console.warn("[useDataProcessing] Error parsing date for item:",_),!1}});if(console.log("[useDataProcessing] Valid items after date filtering:",C.length),C.length>0)console.log("[useDataProcessing] Sample dates:",C.slice(0,3).map(_=>_[u]));else return console.warn("[useDataProcessing] No valid items with dates in the specified range"),[];const T=ls(C,_=>_.length,_=>{try{const z=new Date(_[u]);return`${z.getFullYear()}-${String(z.getMonth()+1).padStart(2,"0")}`}catch(z){return console.error("[useDataProcessing] Error formatting date for grouping:",z),"unknown"}});T.has("unknown")&&(console.warn("[useDataProcessing] Removing unknown date entries"),T.delete("unknown"));const x=Array.from(T,([_,z])=>{try{const[N,U]=_.split("-"),b=new Date(parseInt(N),parseInt(U)-1);return{date:b,month:_,monthFormatted:b.toLocaleDateString(void 0,{month:"short",year:"numeric"}),count:z,total:0,percentage:z/C.length*100}}catch(N){return console.error("[useDataProcessing] Error parsing month data:",N),null}}).filter(_=>_!==null).sort((_,z)=>_.date.getTime()-z.date.getTime());if(x.length>1){const _=[],z=x[0].date,N=x[x.length-1].date;let U=new Date(z);for(;U<=N;){const b=U.getFullYear(),I=U.getMonth(),S=`${b}-${String(I+1).padStart(2,"0")}`,R=x.find(W=>W.month===S);R?_.push(R):_.push({date:new Date(b,I),month:S,monthFormatted:new Date(b,I).toLocaleDateString(void 0,{month:"short",year:"numeric"}),count:0,total:0,percentage:0}),U.setMonth(U.getMonth()+1)}_.length>x.length&&(console.log("[useDataProcessing] Filled in missing months:",_.length-x.length),x.length=0,x.push(..._))}if(m){let _=$;x.forEach(z=>{_+=z.count,z.total=_})}return console.log("[useDataProcessing] Processed timeline data:",x.length,"data points"),x}catch(p){return console.error("[useDataProcessing] Error processing time data:",p),[]}}return{filterItems:s,groupAndCount:d,groupHierarchically:c,processTimeData:l}}var $0=$t('<span class="mx-xs opacity-50"> </span>'),C0=$t('<!> <span tabindex="0" role="link"> </span>',1),k0=$t('<nav class="breadcrumb-navigation flex items-center text-sm svelte-lpaxl5"></nav>');function z0(t,e){ke(e,!1);let n=ee(e,"items",24,()=>[]),r=ee(e,"separator",8,"/"),i=ee(e,"activeItemClass",8,"text-primary font-medium"),o=ee(e,"navItemClass",8,"hover:text-primary transition-colors cursor-pointer");const a=Bl();function s(c){a("navigate",{id:c})}Ue();var d=k0();Hn(d,5,n,mr,(c,l,h)=>{var u=C0(),g=jt(u);{var p=m=>{var $=$0(),C=L($);It(()=>lt(C,r())),nt(m,$)};Ot(g,m=>{h>0&&m(p)})}var v=_t(g,2),y=L(v);It(()=>{wo(v,`${`${o()} ${h===n().length-1?i():""}`??""} svelte-lpaxl5`),lt(y,f(l).label)}),_e("click",v,()=>s(f(l).id)),_e("keypress",v,m=>m.key==="Enter"&&s(f(l).id)),nt(c,u)}),nt(t,d),ze()}var M0=$t('<div class="loading absolute inset-center text-secondary svelte-ams09e"> </div>'),A0=$t('<div class="error absolute inset-center text-error svelte-ams09e"> </div>'),S0=$t('<div class="no-data absolute inset-center text-secondary svelte-ams09e"> </div>'),E0=$t('<div class="loading absolute inset-center text-secondary svelte-ams09e">Initializing visualization...</div>'),I0=$t('<div class="breadcrumb-wrapper absolute top-0 left-0 right-0 bg-white bg-opacity-90 p-xs z-10 shadow-sm svelte-ams09e" style="height: 30px;"><div class="px-sm py-xs svelte-ams09e"><!></div></div>'),L0=$t('<p class="text-sm text-secondary mb-xs svelte-ams09e"> <strong class="font-medium svelte-ams09e"> </strong></p>'),N0=$t('<p class="text-sm text-secondary mb-xs svelte-ams09e"> <strong class="font-medium svelte-ams09e"> </strong></p>'),D0=$t('<p class="text-sm text-secondary mb-xs svelte-ams09e"> </p>'),F0=$t('<div class="chart-container relative flex-1 min-h-450 bg-card rounded p-md overflow-hidden svelte-ams09e"><!></div> <div class="stats bg-card shadow rounded p-md svelte-ams09e"><div class="stat-summary svelte-ams09e"><h3 class="text-primary font-medium border-b pb-xs mb-sm svelte-ams09e"> </h3> <p class="text-sm text-secondary mb-xs svelte-ams09e"> <strong class="font-medium svelte-ams09e"> </strong></p> <!> <p class="text-sm text-secondary mb-xs svelte-ams09e"> <strong class="font-medium svelte-ams09e"> </strong></p> <p class="text-sm text-secondary mb-xs svelte-ams09e"> <strong class="font-medium svelte-ams09e"> </strong></p> <!></div></div>',1),R0=$t('<div class="flex flex-col gap-sm w-full h-full country-distribution-container svelte-ams09e"><!></div>');function P0(t,e){ke(e,!1);const[n,r]=on(),i=()=>xt(fe,"$itemsStore",n),o=()=>xt(j,"$noSetText",n),a=()=>xt(F,"$noDataText",n),s=()=>xt(q,"$itemsText",n),d=()=>xt(ut,"$categoriesText",n),c=()=>xt(B,"$percentTotalText",n),l=()=>xt(P,"$clickZoomInText",n),h=()=>xt(at,"$subCollectionsText",n),u=()=>xt(ct,"$percentParentText",n),g=()=>xt(J,"$summaryText",n),p=()=>xt(K,"$totalItemsText",n),v=()=>xt(tt,"$countriesText",n),y=()=>xt(Y,"$currentlyViewingText",n);let m=bt(),$={name:"root",children:[]},C=null,T="en",x=bt(""),_=bt(0),z=bt(0),N=bt(0),U=bt(0),b=[],I=null,S=bt(null),R=new Map,W=bt([{id:null,label:ot("viz.all_countries")}]),X=new Map,k=new Map;const F=rt("viz.no_data"),q=rt("viz.items"),ct=rt("viz.percent_of_country"),B=rt("viz.percent_of_total"),P=rt("viz.click_zoom_in");rt("viz.back_to_all"),rt("viz.all_countries"),rt("viz.unknown");const j=rt("viz.no_set"),J=rt("viz.summary"),K=rt("viz.total_items"),tt=rt("viz.countries"),ut=rt("viz.categories"),at=rt("viz.sub_collections"),Y=rt("viz.currently_viewing");rt("viz.click_back_to_return");let E=bt(),O,A=0,w=0,M;const{groupHierarchically:H}=Oe({filterMissingValues:!0,requiredFields:["country"],calculatePercentages:!0,sortByCount:!0,sortDescending:!0});function Q(st){return st.toLocaleString(T==="fr"?"fr-FR":"en-US")}function pt(){if(!(!f(ft)||f(Z)))try{if(f(_)>0){const st=Q(f(_));D(x,ot("viz.distribution_items",{0:st}))}else D(x,ot("viz.country_distribution_title"))}catch(st){console.error("Error updating title HTML:",st),D(x,"Country Distribution")}}let ft=bt(!1),Z=bt(!1),it;function vt(){f(ft)&&(it=fe.subscribe(st=>{f(ft)&&document.body.contains(f(m))&&(console.log("ItemsStore updated, handling change"),st.items&&st.items.length>0&&Ut())}))}Ye(()=>(D(ft,!0),D(Z,!1),console.log("CountryDistribution component mounted"),(async()=>{try{if(await kn(),f(Z)||!f(ft)){console.log("Component unmounted after tick, aborting initialization");return}if(!f(m)){console.error("Container element not found in onMount");return}if(console.log("Container is ready, initializing visualization"),O=Dr({container:f(m),onResize:()=>{if(f(ft)&&f(m)&&document.body.contains(f(m))){const{width:st,height:ht}=O.dimensions;A=st,w=ht,console.log(`Resizing to ${A}x${w}`),A>0&&w>0&&Ut()}},debounceDelay:50}),M=xe.subscribe(st=>{var ht;if(!(!f(ft)||!document.body.contains(f(m)))&&(console.log("Language changed to:",st),T=st,f(W)&&f(W).length>0&&Bo(W,f(W)[0].label=ot("viz.all_countries")),pt(),i().items&&i().items.length>0)){const Tt=f(S),St=Tt==null?void 0:Tt.data.originalName;if(D(S,null),$=Dt(i().items),Tt&&St){const Kt=(ht=un($).children)==null?void 0:ht.find(Gt=>Gt.data.originalName===St);if(Kt){Mt(Kt);return}}f(ft)&&f(m)&&document.body.contains(f(m))&&Ut()}}),vt(),i().items&&i().items.length>0){if(console.log("Processing initial data"),f(Z)||!f(ft)){console.log("Component unmounted before processing data, aborting");return}if($=Dt(i().items),$.children&&$.children.length>0){const Tt=Ce().domain($.children.map(St=>St.originalName||St.name)).range(rn);$.children.forEach(St=>{const Bt=St.originalName||St.name;X.has(Bt)||X.set(Bt,Tt(Bt))})}const{width:st,height:ht}=O.dimensions;if(A=st,w=ht,R=new Map,await kn(),f(Z)||!f(ft)){console.log("Component unmounted after second tick, aborting visualization");return}f(ft)&&f(m)&&document.body.contains(f(m))&&(console.log("Updating visualization after initialization"),Ut())}else{if(f(Z)||!f(ft)){console.log("Component unmounted before loading items, aborting");return}console.log("Loading items from store"),fe.loadItems()}}catch(st){console.error("Error during initialization:",st)}})(),()=>{try{console.log("CountryDistribution component unmounting"),D(ft,!1),D(Z,!0),O&&O.cleanup(),M&&M(),it&&it(),f(m)&&dt(f(m)).selectAll("*").remove(),C=null,D(S,null),I=null,b=[],R.clear(),console.log("CountryDistribution cleanup complete")}catch(st){console.error("Error during cleanup:",st)}}));function Dt(st){if(f(Z))return console.log("Component unmounted during data processing, aborting"),{name:"root",children:[]};const ht=H(st,[St=>St.country||"",St=>St.item_set_title||o()]),Tt={name:"root",children:ht.children.map(St=>{const Bt=ot(`country.${St.name}`)||St.name,Kt=new Map;Object.values(hr).forEach(Et=>{Kt.set(Et.id,{name:el(Et.id,T),children:[],itemCount:0,originalName:Et.id,categoryId:Et.id,isCategory:!0})}),St.children&&St.children.forEach(Et=>{const Ft=T0[Et.name]||"other",V=Kt.get(Ft);V!=null&&V.children&&(V.children.push({name:Et.name,value:Et.value,itemCount:Et.value,originalName:Et.name,categoryId:Ft}),V.itemCount=(V.itemCount||0)+Et.value)});const Gt=Array.from(Kt.values()).filter(Et=>Et.children&&Et.children.length>0).sort((Et,Ft)=>(Ft.itemCount||0)-(Et.itemCount||0));return Gt.forEach(Et=>{Et.children&&Et.children.sort((Ft,V)=>(V.itemCount||0)-(Ft.itemCount||0))}),{name:Bt,children:Gt,itemCount:St.value,originalName:St.name}})};return D(_,ht.children.reduce((St,Bt)=>St+Bt.value,0)),D(z,ht.children.length),D(U,Object.keys(hr).length),D(N,0),Tt.children&&Tt.children.forEach(St=>{St.children&&St.children.forEach(Bt=>{Bt.children&&D(N,f(N)+Bt.children.length)})}),pt(),Tt}function Mt(st){var ht,Tt,St;if(D(S,st),f(S)){f(S).data.isCategory;const Bt=f(S).data.isCategory;if(D(W,[{id:null,label:ot("viz.all_countries")}]),Bt){const Kt=f(S).parent;Kt&&(f(W).push({id:Kt.data.originalName||null,label:Kt.data.name}),console.log("Added country to breadcrumb:",Kt.data.name,"with ID:",Kt.data.originalName))}if(Bt&&f(S).data.categoryId){const Kt=f(S).data.categoryId,Gt=el(Kt,T);f(W).push({id:f(S).data.categoryId||null,label:Gt}),console.log("Added category to breadcrumb:",Gt,"with ID:",f(S).data.categoryId)}else f(W).push({id:f(S).data.originalName||null,label:f(S).data.name}),console.log("Added item to breadcrumb:",f(S).data.name,"with ID:",f(S).data.originalName);if(!f(S).children||f(S).children.length===0){console.warn("Cannot zoom to node without children");return}if(console.log("Zooming to node:",f(S).data.name,"Original name:",f(S).data.originalName,"Is category:",f(S).data.isCategory),D(_,f(S).data.itemCount||0),f(S).data.isCategory)f(S).data.isCategory&&(D(N,((Tt=f(S).children)==null?void 0:Tt.length)||0),D(U,1));else{const Kt=((ht=f(S).children)==null?void 0:ht.filter(Gt=>Gt.data.isCategory))||[];D(U,Kt.length),D(N,0),Kt.forEach(Gt=>{Gt.children&&D(N,f(N)+Gt.children.length)})}}else if(D(W,[{id:null,label:ot("viz.all_countries")}]),i().items&&i().items.length>0){$=Dt(i().items);const Bt=i().items.filter(Gt=>Gt.country&&Gt.country.trim()!=="");D(_,Bt.length);const Kt=ka(Bt,Gt=>Gt.country);D(z,Kt.size),D(U,Object.keys(hr).length),D(N,0),(St=$.children)==null||St.forEach(Gt=>{var Et;(Et=Gt.children)==null||Et.forEach(Ft=>{Ft.children&&D(N,f(N)+Ft.children.length)})})}pt(),Ut()}function Wt(st){const{id:ht}=st.detail;if(!f(ft)||f(Z)||!document.body.contains(f(m))){console.log("Component not mounted, ignoring breadcrumb click");return}if(console.log("Breadcrumb navigation requested for ID:",ht),ht===null){console.log("Navigating to root view"),Mt(null);return}if(R&&R.has(ht)){const Tt=R.get(ht);console.log("Found country node in map:",Tt==null?void 0:Tt.data.name),Mt(Tt||null);return}if(C&&R)for(const Tt of R.values()){if(!Tt.children)continue;const St=Tt.children.find(Bt=>Bt.data.categoryId===ht||Bt.data.originalName===ht||Bt.data.name===ht);if(St){console.log("Found category node:",St.data.name,"in country:",Tt.data.name),Mt(St);return}}console.log("Could not find a node matching ID:",ht)}function Ut(){var st,ht;try{if(!f(ft)||f(Z)){console.log("Component unmounted, skipping visualization update");return}if(!f(m)){console.error("Container element not found");return}const Tt={top:30,right:10,bottom:10,left:10};if(f(S)||($=Dt(i().items)),!$.children||$.children.length===0){dt(f(m)).select("svg").remove(),dt(f(m)).append("div").attr("class","no-data absolute inset-center text-secondary").text(a());return}dt(f(m)).select("svg").remove(),dt(f(m)).select(".no-data").remove();const St=f(m).getBoundingClientRect(),Bt=St.width-Tt.left-Tt.right,Kt=St.height-Tt.top-Tt.bottom,Et=dt(f(m)).append("svg").attr("width","100%").attr("height","100%").attr("viewBox",`0 0 ${St.width} ${St.height}`).attr("preserveAspectRatio","xMidYMid meet").append("g").attr("transform",`translate(${Tt.left}, ${Tt.top})`),Ft=Tc().size([Bt,Kt]).paddingOuter(4).paddingTop(20).paddingInner(2).round(!0);let V;if(f(S)){const Rt={name:f(S).data.name,children:f(S).data.children,originalName:f(S).data.originalName,isCategory:f(S).data.isCategory,categoryId:f(S).data.categoryId};V=un(Rt).sum(kt=>kt.value||0).sort((kt,Pt)=>(Pt.value||0)-(kt.value||0))}else V=un($).sum(Rt=>Rt.value||0).sort((Rt,kt)=>(kt.value||0)-(Rt.value||0)),R.clear(),V.children&&V.children.forEach(Rt=>{const kt=Rt.data.originalName||Rt.data.name;R.set(kt,Rt)});C=V;try{Ft(V)}catch(Rt){console.error("Error applying treemap layout:",Rt),D(S,null),$=Dt(i().items),V=un($).sum(kt=>kt.value||0).sort((kt,Pt)=>(Pt.value||0)-(kt.value||0)),C=V,Ft(V)}const et=Ce().domain(V.children?V.children.map(Rt=>Rt.data.originalName||Rt.data.name):[V.data.originalName||V.data.name]).range(rn),wt=Ce().domain(Object.keys(hr)).range(Wv),Ct=!f(S),gt=f(S)&&!f(S).data.isCategory,Vt=f(S)&&f(S).data.isCategory;if(Ct){const Rt=V.children||[];Et.selectAll(".country").data(Rt).enter().append("g").attr("class","country").each(function(Pt){const zt=dt(this),mt=Pt.data.name,Nt=Pt.data.originalName||mt;let qt;X.has(Nt)?qt=X.get(Nt)||et(Nt):(qt=et(Nt),X.set(Nt,qt));const he=Pt.children||[],be=zt.selectAll(".category").data(he).enter().append("g").attr("class","category").attr("transform",At=>{const Ht=At.x0||0,Xt=At.y0||0;return`translate(${Ht},${Xt})`});be.append("rect").attr("width",At=>{const Ht=At.x0||0,Xt=At.x1||0;return Math.max(0,Xt-Ht)}).attr("height",At=>{const Ht=At.y0||0,Xt=At.y1||0;return Math.max(0,Xt-Ht)}).attr("fill",At=>{const Ht=At.data.categoryId||"other",Xt=Fe(qt),ge=`${Nt}-${Ht}`;let ae;if(k.has(ge))ae=k.get(ge)||Xt.toString();else{const ve=Fe(wt(Ht));ae=Fe(Xt.r*.7+ve.r*.3,Xt.g*.7+ve.g*.3,Xt.b*.7+ve.b*.3).toString(),k.set(ge,ae)}return ae}).attr("stroke","white").attr("stroke-width",1.5).attr("opacity",.8).attr("class","cursor-pointer").on("click",(At,Ht)=>{Mt(Pt)}).on("mouseover",function(At,Ht){Lt(At,Ht)}).on("mousemove",function(At,Ht){Lt(At,Ht)}).on("mouseout",function(){f(E).hideTooltip()}),be.append("text").attr("x",5).attr("y",15).attr("font-size","var(--font-size-xs)").attr("font-weight","bold").attr("fill","white").attr("class","pointer-events-none").text(At=>At.x1-At.x0<100?At.data.name:`${At.data.name} (${At.data.itemCount||0})`).each(function(At){const Ht=dt(this),Xt=this.getComputedTextLength(),ge=At.x1-At.x0-10;if(Xt>ge){let ae=At.data.name;Ht.text(ae);let ve=this.getComputedTextLength(),Zt=!1;for(;ve>ge&&ae.length>3;)ae=ae.slice(0,-1),Ht.text(ae),ve=this.getComputedTextLength(),Zt=!0;Zt&&Ht.text(ae+"..."),Ht.append("title").text(`${mt} > ${At.data.name} (${At.data.itemCount||0} ${s()})`)}});let Me=1/0,je=1/0,Ae=-1/0,Ge=-1/0;he.forEach(At=>{const Ht=At.x0||0,Xt=At.y0||0,ge=At.x1||0,ae=At.y1||0;Me=Math.min(Me,Ht),je=Math.min(je,Xt),Ae=Math.max(Ae,ge),Ge=Math.max(Ge,ae)}),zt.append("rect").attr("x",Me).attr("y",je-20).attr("width",Ae-Me).attr("height",20).attr("fill",qt).attr("opacity",.9).attr("class","cursor-pointer").on("click",At=>{Mt(Pt)}),zt.append("text").attr("x",Me+5).attr("y",je-6).attr("font-size","var(--font-size-sm)").attr("font-weight","bold").attr("fill","white").attr("class","pointer-events-none").text(`${mt} (${Pt.data.itemCount||0} ${s()})`)})}else if(gt){const Rt=Et.selectAll(".category").data(V.children||[]).enter().append("g").attr("class","category").attr("transform",zt=>{const mt=zt.x0||0,Nt=zt.y0||0;return`translate(${mt},${Nt})`}),kt=((st=f(S))==null?void 0:st.data.originalName)||((ht=f(S))==null?void 0:ht.data.name)||"",Pt=X.get(kt)||et(kt);Rt.append("rect").attr("width",zt=>{const mt=zt.x0||0,Nt=zt.x1||0;return Math.max(0,Nt-mt)}).attr("height",zt=>{const mt=zt.y0||0,Nt=zt.y1||0;return Math.max(0,Nt-mt)}).attr("fill",zt=>{const mt=zt.data.categoryId||"other",Nt=`${kt}-${mt}`;if(k.has(Nt))return k.get(Nt)||Pt;{const qt=Fe(Pt),he=Fe(wt(mt)),Me=Fe(qt.r*.7+he.r*.3,qt.g*.7+he.g*.3,qt.b*.7+he.b*.3).toString();return k.set(Nt,Me),Me}}).attr("stroke","white").attr("stroke-width",1.5).attr("opacity",.8).attr("class","cursor-pointer").on("click",(zt,mt)=>{Mt(mt)}).on("mouseover",function(zt,mt){Lt(zt,mt)}).on("mousemove",function(zt,mt){Lt(zt,mt)}).on("mouseout",function(){f(E).hideTooltip()}),Rt.append("text").attr("x",5).attr("y",15).attr("font-size","var(--font-size-sm)").attr("font-weight","bold").attr("fill","white").attr("class","pointer-events-none").text(zt=>`${zt.data.name} (${zt.data.itemCount||0} ${s()})`).each(function(zt){const mt=dt(this),Nt=this.getComputedTextLength(),qt=zt.x1-zt.x0-10;Nt>qt&&mt.text(zt.data.name).append("title").text(`${zt.data.name} (${zt.data.itemCount||0} ${s()})`)})}else if(Vt&&f(S)){const Rt=Et.selectAll(".subcollection").data(V.children||[]).enter().append("g").attr("class","subcollection").attr("transform",mt=>{const Nt=mt.x0||0,qt=mt.y0||0;return`translate(${Nt},${qt})`}),kt=f(S).data.categoryId||"other",Pt=f(S).parent;let zt;if(Pt){const Nt=`${Pt.data.originalName||Pt.data.name}-${kt}`;zt=k.get(Nt)||wt(kt)}else zt=wt(kt);Rt.append("rect").attr("width",mt=>{const Nt=mt.x0||0,qt=mt.x1||0;return Math.max(0,qt-Nt)}).attr("height",mt=>{const Nt=mt.y0||0,qt=mt.y1||0;return Math.max(0,qt-Nt)}).attr("fill",mt=>{const Nt=Fe(zt);return Fe(Nt).brighter(.5).toString()}).attr("stroke","white").attr("stroke-width",.5).attr("class","cursor-pointer").on("mouseover",function(mt,Nt){dt(this).attr("stroke","var(--color-primary)").attr("stroke-width",2),Lt(mt,Nt)}).on("mousemove",function(mt,Nt){Lt(mt,Nt)}).on("mouseout",function(){dt(this).attr("stroke","white").attr("stroke-width",.5),f(E).hideTooltip()}),Rt.append("text").attr("x",3).attr("y",13).attr("font-size","var(--font-size-xs)").attr("fill","var(--color-text-primary)").attr("class","pointer-events-none").each(function(mt){const Nt=dt(this),qt=mt.x1-mt.x0,he=mt.y1-mt.y0;if(qt<30||he<20)return;let be=mt.data.name;const Me=qt-6,je=Pt?Pt.data.name:"",Ae=f(S)?f(S).data.name:"";let Ge="";je&&Ae?Ge=`${je} > ${Ae} > ${mt.data.name}: ${mt.data.itemCount||mt.value||0} ${s()}`:Ae?Ge=`${Ae} > ${mt.data.name}: ${mt.data.itemCount||mt.value||0} ${s()}`:Ge=`${mt.data.name}: ${mt.data.itemCount||mt.value||0} ${s()}`,Nt.text(be).append("title").text(Ge);const At=this;let Ht=At.getComputedTextLength(),Xt=!1;for(;Ht>Me&&be.length>3;)be=be.slice(0,-1),Nt.text(be),Ht=At.getComputedTextLength(),Xt=!0;Xt&&(Nt.text(be+"..."),Nt.append("title").text(Ge))})}}catch(Tt){console.error("Error in updateVisualization:",Tt)}}function Lt(st,ht){var Tt,St;try{if(!f(E))return;const Bt=ht.parent===C,Kt=ht.data.isCategory===!0,Gt=!Bt&&!Kt;if(Bt){const Et=ht.data.name,Ft=ht.data.itemCount||ht.value||0,V=((Tt=ht.children)==null?void 0:Tt.length)||0,et=f(_)>0?(Ft/f(_)*100).toFixed(1)+"%":"N/A",wt=`
                    <div class="font-bold mb-xs pb-xs border-b border-white border-opacity-30">
                        ${Et}
                    </div>
                    <div class="grid grid-cols-2 gap-xs">
                        <span>${s()}:</span>
                        <span class="text-right font-medium">${Ft}</span>
                        <span>${d()}:</span>
                        <span class="text-right">${V}</span>
                        <span>${c()}:</span>
                        <span class="text-right">${et}</span>
                    </div>
                    <div class="mt-xs italic text-xs">
                        ${l()}
                    </div>
                `;f(E).showTooltip(st,wt,250,150)}else if(Kt){const Et=ht.data.name,Ft=ht.data.itemCount||ht.value||0,V=((St=ht.children)==null?void 0:St.length)||0,et=ht.parent,wt=et?et.data.name:"",Ct=et&&(et.data.itemCount||et.value)||0,gt=Ct>0?(Ft/Ct*100).toFixed(1)+"%":"N/A",Vt=f(_)>0?(Ft/f(_)*100).toFixed(1)+"%":"N/A",Rt=`
                    <div class="font-bold mb-xs pb-xs border-b border-white border-opacity-30">
                        ${wt} > ${Et}
                    </div>
                    <div class="grid grid-cols-2 gap-xs">
                        <span>${s()}:</span>
                        <span class="text-right font-medium">${Ft}</span>
                        <span>${h()}:</span>
                        <span class="text-right">${V}</span>
                        <span>${u()}:</span>
                        <span class="text-right">${gt}</span>
                        <span>${c()}:</span>
                        <span class="text-right">${Vt}</span>
                    </div>
                    <div class="mt-xs italic text-xs">
                        ${l()}
                    </div>
                `;f(E).showTooltip(st,Rt,250,150)}else{const Et=ht.data.name,Ft=ht.data.itemCount||ht.value||0,V=ht.parent,et=V==null?void 0:V.parent,wt=V?V.data.name:"",Ct=et?et.data.name:"",gt=V&&(V.data.itemCount||V.value)||0,Vt=et&&(et.data.itemCount||et.value)||0,Rt=gt>0?(Ft/gt*100).toFixed(1)+"%":"N/A",kt=Vt>0?(Ft/Vt*100).toFixed(1)+"%":"N/A",Pt=f(_)>0?(Ft/f(_)*100).toFixed(1)+"%":"N/A";let zt=Et;wt&&Ct?zt=`${Ct} > ${wt} > ${Et}`:wt?zt=`${wt} > ${Et}`:Ct&&(zt=`${Ct} > ${Et}`);const mt=wt||null,Nt=Ct||null,qt=`
                    <div class="font-bold mb-xs pb-xs border-b border-white border-opacity-30">
                        ${zt}
                    </div>
                    <div class="grid grid-cols-2 gap-xs">
                        <span>${s()}:</span>
                        <span class="text-right font-medium">${Ft}</span>
                        ${mt?`<span>% of ${mt}:</span>
                        <span class="text-right">${Rt}</span>`:""}
                        ${Nt?`<span>${u()}:</span>
                        <span class="text-right">${kt}</span>`:""}
                        <span>${c()}:</span>
                        <span class="text-right">${Pt}</span>
                    </div>
                `;f(E).showTooltip(st,qt,250,150)}}catch(Bt){console.error("Error showing tooltip:",Bt)}}Ue();var G=R0(),yt=L(G);We(Nr(yt,{get titleHtml(){return f(x)},descriptionTranslationKey:"viz.country_distribution_description",theme:"default",className:"country-distribution",children:(st,ht)=>{var Tt=F0(),St=jt(Tt),Bt=L(St);{var Kt=At=>{var Ht=M0(),Xt=L(Ht);It(ge=>lt(Xt,ge),[()=>ot("ui.loading")],ie),nt(At,Ht)},Gt=At=>{var Ht=se(),Xt=jt(Ht);{var ge=ve=>{var Zt=A0(),Qt=L(Zt);It(()=>lt(Qt,i().error)),nt(ve,Zt)},ae=ve=>{var Zt=se(),Qt=jt(Zt);{var le=Ee=>{var ce=S0(),Ke=L(ce);It(()=>lt(Ke,a())),nt(Ee,ce)},Se=Ee=>{var ce=se(),Ke=jt(ce);{var Bn=He=>{var Ie=E0();nt(He,Ie)},On=He=>{var Ie=se(),mn=jt(Ie);{var Vn=Wn=>{var qn=I0(),sn=L(qn),Ln=L(sn);{var Fr=Nn=>{z0(Nn,{get items(){return f(W)},separator:"/",navItemClass:"text-sm hover:text-primary transition-colors cursor-pointer font-medium",activeItemClass:"text-primary font-bold",$$events:{navigate:Wt}})};Ot(Ln,Nn=>{f(W)&&f(W).length&&Nn(Fr)})}nt(Wn,qn)};Ot(mn,Wn=>{f(ft)&&!f(Z)&&Wn(Vn)},!0)}nt(He,Ie)};Ot(Ke,He=>{f(m)?He(On,!1):He(Bn)},!0)}nt(Ee,ce)};Ot(Qt,Ee=>{!i().items||i().items.length===0?Ee(le):Ee(Se,!1)},!0)}nt(ve,Zt)};Ot(Xt,ve=>{i().error?ve(ge):ve(ae,!1)},!0)}nt(At,Ht)};Ot(Bt,At=>{i().loading?At(Kt):At(Gt,!1)})}We(St,At=>D(m,At),()=>f(m));var Et=_t(St,2),Ft=L(Et),V=L(Ft),et=L(V),wt=_t(V,2),Ct=L(wt),gt=_t(Ct),Vt=L(gt),Rt=_t(wt,2);{var kt=At=>{var Ht=L0(),Xt=L(Ht),ge=_t(Xt),ae=L(ge);It(ve=>{lt(Xt,`${v()??""}: `),lt(ae,ve)},[()=>Q(f(z))],ie),nt(At,Ht)};Ot(Rt,At=>{f(S)||At(kt)})}var Pt=_t(Rt,2),zt=L(Pt),mt=_t(zt),Nt=L(mt),qt=_t(Pt,2),he=L(qt),be=_t(he),Me=L(be),je=_t(qt,2);{var Ae=At=>{var Ht=N0(),Xt=L(Ht),ge=_t(Xt),ae=L(ge);It(()=>{lt(Xt,`${y()??""}: `),lt(ae,f(S).data.name)}),nt(At,Ht)},Ge=At=>{var Ht=D0(),Xt=L(Ht);It(()=>lt(Xt,l())),nt(At,Ht)};Ot(je,At=>{f(S)?At(Ae):At(Ge,!1)})}It((At,Ht,Xt)=>{lt(et,g()),lt(Ct,`${p()??""}: `),lt(Vt,At),lt(zt,`${d()??""}: `),lt(Nt,Ht),lt(he,`${h()??""}: `),lt(Me,Xt)},[()=>Q(f(_)),()=>Q(f(U)),()=>Q(f(N))],ie),nt(st,Tt)},$$slots:{default:!0},$$legacy:!0}),st=>D(E,st),()=>f(E)),nt(t,G),ze(),r()}function Uc(t){const{container:e,title:n,titleTranslationKey:r,items:i=[],type:o="html",orientation:a="vertical",position:s="right",customPosition:d,maxItems:c=10,showValues:l=!0,className:h="",valueFormatter:u=k=>k.toLocaleString(),translateKeys:g={itemPrefix:"",othersLabel:"viz.others",countLabel:"viz.items"},responsive:p=!0,breakpoint:v=768,interactive:y=!1,onItemClick:m=()=>{},customProperties:$}=t;let C=n,T=null,x=[...i],_=null;function z(){if(!(e instanceof HTMLElement))return console.error("Container must be an HTMLElement for HTML legend"),null;if(T instanceof HTMLElement)T.innerHTML="";else{T=document.createElement("div");const K=p&&window.innerWidth<v;T.className=`legend ${K?"legend-mobile":"legend-desktop"} ${h}`.trim(),s==="custom"&&d?(T.style.position="absolute",T.style.left=`${d.x}px`,T.style.top=`${d.y}px`):T.classList.add(`legend-${s}`),e.appendChild(T)}const k=p&&window.innerWidth<v;let F="";if(r){const K=rt(r);typeof K=="string"?F=K:K.subscribe(tt=>{F=tt})()}else C&&(F=C);let q=[...x],ct=null;if(c>0&&q.length>c){const K=q.slice(0,c),tt=q.slice(c);ct={key:"others",label:ot(g.othersLabel||"viz.others"),color:"#999999",value:tt.reduce((ut,at)=>ut+(at.value||0),0)},q=K}const B=F?`<div class="legend-heading${k?"-mobile":""}">${F}</div>`:"",P=k?"legend-grid-mobile":"legend-grid",j=q.map(K=>{let tt=K.label||K.key;if(g.itemPrefix){const O=`${g.itemPrefix}${K.key}`,A=ot(O);A!==O&&(tt=A)}const ut=k?"legend-color-mobile":"legend-color",at=k?"legend-label-mobile":"legend-label",Y=k?"legend-value-mobile":"legend-value",E=K.visible===!1?"opacity: 0.5; text-decoration: line-through;":"";return`
        <div class="${ut}" data-color="${K.color}" style="${E}"></div>
        <div class="${at}" style="${E}">${tt}</div>
        ${l&&K.value!==void 0?`<div class="${Y}" style="${E}">${u(K.value)}</div>`:""}
      `}).join(""),J=ct?`
      <div class="${k?"legend-color-mobile":"legend-color"}" data-color="${ct.color}"></div>
      <div class="${k?"legend-label-mobile":"legend-label"}">${ct.label}</div>
      ${l&&ct.value!==void 0?`<div class="${k?"legend-value-mobile":"legend-value"}">${u(ct.value)}</div>`:""}
    `:"";return T.innerHTML=`
      ${B}
      <div class="${P}">
        ${j}
        ${J}
      </div>
    `,T.querySelectorAll("[data-color]").forEach(K=>{K.style.backgroundColor=K.dataset.color||""}),y&&T.querySelectorAll(`.${k?"legend-label-mobile":"legend-label"}`).forEach((tt,ut)=>{ut<q.length&&(tt.classList.add("cursor-pointer"),tt.addEventListener("click",()=>m(q[ut],ut)))}),T}function N(){let k;e instanceof HTMLElement?k=dt(e):k=e,k.selectAll(`.legend${h?`.${h}`:""}`).remove();let F=10,q=10;if(s==="custom"&&d)F=d.x,q=d.y;else if(s==="right"){const ut=k.node();ut&&(F=ut.getBoundingClientRect().width-120)}else if(s==="bottom"){const ut=k.node();ut&&(q=ut.getBoundingClientRect().height-50)}const ct=k.append("g").attr("class",`legend legend-${a} ${h}`.trim()).attr("transform",`translate(${F}, ${q})`);if(C||r){let ut="";if(r){const at=rt(r);typeof at=="string"?ut=at:at.subscribe(Y=>{ut=Y})()}else C&&(ut=C);ct.append("text").attr("class","legend-title").attr("x",0).attr("y",-10).attr("font-size","var(--font-size-xs)").attr("fill","var(--color-text-secondary)").text(ut)}const B=a==="horizontal",P=20,j=20,J=5,K=5,tt=c>0&&x.length>c?x.slice(0,c):x;if(tt.forEach((ut,at)=>{const Y=B?at*(P+J*3+60):0,E=B?0:at*(j+J);let O=ut.label||ut.key;if(g.itemPrefix){const M=`${g.itemPrefix}${ut.key}`,H=ot(M);H!==M&&(O=H)}const A=ct.append("g").attr("class","legend-item").attr("transform",`translate(${Y}, ${E})`);A.append("rect").attr("width",P).attr("height",j).attr("fill",ut.color).attr("stroke",ut.visible===!1?"#999":"none").attr("stroke-width",ut.visible===!1?1:0).attr("opacity",ut.visible===!1?.5:1);const w=A.append("text").attr("x",P+K).attr("y",j/2).attr("dy","0.35em").attr("fill","var(--color-text-primary)").attr("font-size","var(--font-size-sm)").text(O);if(l&&ut.value!==void 0){const M=B?P+K+b(w)+5:P+K,H=B?j/2:j/2+15;A.append("text").attr("x",M).attr("y",H).attr("dy","0.35em").attr("fill","var(--color-text-secondary)").attr("font-size","var(--font-size-xs)").text(u(ut.value))}if(y&&(A.attr("class","legend-item cursor-pointer").attr("role","button").style("cursor","pointer").on("click",()=>m(ut,at)),ut.visible===!1)){const M=w.node();if(M){const H=M.getComputedTextLength();A.append("line").attr("x1",P+K).attr("y1",j/2).attr("x2",P+K+H).attr("y2",j/2).attr("stroke","var(--color-text-primary)").attr("stroke-width",1)}}}),c>0&&x.length>c){const at=x.slice(c).reduce((w,M)=>w+(M.value||0),0),Y=B?tt.length*(P+J*3+60):0,E=B?0:tt.length*(j+J),O=ct.append("g").attr("class","legend-item").attr("transform",`translate(${Y}, ${E})`);O.append("rect").attr("width",P).attr("height",j).attr("fill","#999999");const A=ot(g.othersLabel||"viz.others");O.append("text").attr("x",P+K).attr("y",j/2).attr("dy","0.35em").attr("fill","var(--color-text-primary)").attr("font-size","var(--font-size-sm)").text(A),l&&O.append("text").attr("x",B?P+K+A.length*8+5:P+K).attr("y",B?j/2:j/2+15).attr("dy","0.35em").attr("fill","var(--color-text-secondary)").attr("font-size","var(--font-size-xs)").text(u(at))}return T=ct,ct}function U(){let k;e instanceof HTMLElement?k=dt(e):k=e,k.selectAll(`.legend${h?`.${h}`:""}`).remove();let F=10,q=10;if(s==="custom"&&d)F=d.x,q=d.y;else if(s==="right"){const J=k.node();J&&(F=J.getBoundingClientRect().width-120)}const ct=k.append("g").attr("class",`legend legend-${a} ${h}`.trim()).attr("transform",`translate(${F}, ${q})`);if(C||r){let J="";if(r){const K=rt(r);typeof K=="string"?J=K:K.subscribe(tt=>{J=tt})()}else C&&(J=C);ct.append("text").attr("class","legend-title").attr("x",0).attr("y",-10).attr("font-size","var(--font-size-xs)").attr("fill","var(--color-text-secondary)").text(J)}const B=20,P=20,j=5;return x.forEach((J,K)=>{var Y,E;const tt=K*P;let ut=J.label||J.key;if(g.itemPrefix){const O=`${g.itemPrefix}${J.key}`,A=ot(O);A!==O&&(ut=A)}const at=ct.append("g").attr("class","legend-item").attr("transform",`translate(0, ${tt})`);if(at.append("line").attr("x1",0).attr("y1",0).attr("x2",B).attr("y2",0).attr("stroke",J.color).attr("stroke-width",2).attr("stroke-dasharray",((Y=J.customProperties)==null?void 0:Y.dashArray)||"none"),(E=J.customProperties)!=null&&E.marker&&at.append("circle").attr("cx",B).attr("cy",0).attr("r",3).attr("fill",J.color),at.append("text").attr("x",B+j+5).attr("y",0).attr("dy","0.35em").attr("fill","var(--color-text-primary)").attr("font-size","var(--font-size-sm)").attr("class","legend-item-label").text(ut),y&&(at.attr("class","legend-item cursor-pointer").attr("role","button").style("cursor","pointer").on("click",()=>m(J,K)),J.visible===!1)){const O=ut.length*6;at.append("line").attr("x1",B+j+5).attr("y1",0).attr("x2",B+j+5+O).attr("y2",0).attr("stroke","var(--color-text-primary)").attr("stroke-width",1)}}),T=ct,ct}function b(k){const F=k.node();return F?F.getComputedTextLength():0}function I(){var k;o==="html"?z():o==="svg"&&(((k=t.customProperties)==null?void 0:k.lineChart)===!0?U():N()),p&&!_&&(_=()=>{const F=T instanceof HTMLElement&&T.classList.contains("legend-mobile"),q=window.innerWidth<v;F!==q&&I()},window.addEventListener("resize",_))}function S(k,F){x=[...k],F!==void 0&&(C=F),I()}function R(k,F){x=x.map(ct=>ct.key===k?{...ct,visible:F}:ct),I()}function W(){return T}function X(){_&&(window.removeEventListener("resize",_),_=null),T instanceof HTMLElement&&T.parentNode&&T.parentNode.removeChild(T),e&&o==="svg"&&(e instanceof HTMLElement?dt(e).selectAll(`.legend${h?`.${h}`:""}`).remove():e.selectAll(`.legend${h?`.${h}`:""}`).remove()),T=null}return{render:I,update:S,updateVisibility:R,getLegendElement:W,cleanup:X}}const U0={top:20,right:30,bottom:40,left:50};function H0(t){const{container:e,width:n=e.clientWidth,height:r=e.clientHeight,margin:i=U0,className:o="d3-visualization",responsive:a=!0}=t;dt(e).select("svg").remove();const s=dt(e).append("svg").attr("width",n).attr("height",r).attr("class",o);a&&s.attr("viewBox",`0 0 ${n} ${r}`).attr("preserveAspectRatio","xMidYMid meet");const d=s.append("g").attr("transform",`translate(${i.left}, ${i.top})`);return{svg:s,chart:d,width:n,height:r,margin:i,chartWidth:n-i.left-i.right,chartHeight:r-i.top-i.bottom}}function B0(t){const{type:e,domain:n,range:r,padding:i=.1,nice:o=!0}=t;let a;switch(e){case"linear":a=ui().domain(n).range(r);break;case"log":a=Mc().domain(n).range(r);break;case"time":a=Dc().domain(n).range(r);break;case"ordinal":a=Ce().domain(n).range(r);break;case"band":a=Fa().domain(n).range(r).padding(i);break;default:throw new Error(`Unsupported scale type: ${e}`)}return o&&["linear","time","log"].includes(e)&&a.nice(),a}function O0(t){const{type:e,scale:n,position:r=e==="x"?"bottom":"left",ticks:i,tickFormat:o,tickSize:a,tickPadding:s,rotate:d}=t;let c;if(r==="bottom")c=qi(n);else if(r==="top")c=td(n);else if(r==="left")c=Yi(n);else if(r==="right")c=ed(n);else throw new Error(`Unsupported axis position: ${r}`);return i!==void 0&&c.ticks(i),o!==void 0&&c.tickFormat(o),a!==void 0&&c.tickSize(a),s!==void 0&&c.tickPadding(s),{axis:c,rotate:d}}function V0(t,e){const{axis:n,rotate:r}=e;t.call(n),r&&t.selectAll("text").style("text-anchor",r<0?"end":r>0?"start":"middle").attr("dx",r<0?"-0.8em":r>0?"0.8em":"0").attr("dy",r!==0?"0.15em":"0.71em").attr("transform",`rotate(${r})`)}function W0(t,e="categorical"){if(e==="categorical")return Ce().domain(t).range(rn);if(e==="sequential")return ca(Kv).domain([0,t.length-1]);if(e==="diverging")return ca(Yv).domain([0,t.length-1]);throw new Error(`Unsupported color range type: ${e}`)}function q0(t,e,n="chart-title"){t.append("text").attr("class",n).attr("x",t.attr("width")?parseInt(t.attr("width"))/2:0).attr("y",20).attr("text-anchor","middle").text(e)}function Y0(t,e,n={}){const{position:r={x:10,y:10},orientation:i="horizontal",itemWidth:o=20,itemHeight:a=20,itemMargin:s=5,className:d="legend",width:c=300}=n,l=t.append("g").attr("class",d).attr("transform",`translate(${r.x}, ${r.y})`),h=i==="horizontal"?"legend-horizontal":"legend-vertical";l.classed(h,!0);const u=i==="horizontal",g=l.append("g").attr("class","legend-items");if(d.includes("multi-row-legend")){const y=Math.floor(((c||300)-r.x-20)/(o+s*4)),m=Math.max(3,y);e.forEach(($,C)=>{const T=Math.floor(C/m),_=C%m*(o+s*4),z=T*(a+s*2),N=g.append("g").attr("class","legend-item").attr("transform",`translate(${_}, ${z})`);N.append("rect").attr("class","legend-item-swatch").attr("width",o).attr("height",a).attr("fill",$.color),N.append("text").attr("class","legend-item-label").attr("x",o+s).attr("y",a/2).attr("dy","0.35em").text($.key)})}else e.forEach((v,y)=>{const m=u?y*(o+s*3):0,$=u?0:y*(a+s),C=g.append("g").attr("class","legend-item").attr("transform",`translate(${m}, ${$})`);C.append("rect").attr("class","legend-item-swatch").attr("width",o).attr("height",a).attr("fill",v.color),C.append("text").attr("class","legend-item-label").attr("x",o+s).attr("y",a/2).attr("dy","0.35em").text(v.key)});return l}function nl(t,e){return"ticks"in t&&typeof t.ticks=="function"?t.ticks(e):"domain"in t&&typeof t.domain=="function"?t.domain():[]}function G0(t,e){const{width:n,height:r,xScale:i,yScale:o,xTicks:a=10,yTicks:s=10,className:d="grid"}=e,c=t.append("g").attr("class",d);if(i){const l=nl(i,a);c.append("g").attr("class","grid-x").selectAll("line").data(l).enter().append("line").attr("x1",h=>i(h)).attr("x2",h=>i(h)).attr("y1",0).attr("y2",r).attr("stroke","#e0e0e0").attr("stroke-dasharray","3,3")}if(o){const l=nl(o,s);c.append("g").attr("class","grid-y").selectAll("line").data(l).enter().append("line").attr("x1",0).attr("x2",n).attr("y1",h=>o(h)).attr("y2",h=>o(h)).attr("stroke","#e0e0e0").attr("stroke-dasharray","3,3")}return c}function K0(t=500,e=_c){return vc().duration(t).ease(e)}function X0(t){const e=parseInt(t.attr("width")),n=parseInt(t.attr("height"));t.attr("viewBox",`0 0 ${e} ${n}`).attr("preserveAspectRatio","xMidYMid meet").attr("width","100%").attr("height","100%")}function Z0(t,e="No data available",n="absolute inset-center text-secondary z-50"){dt(t).select("svg").remove(),dt(t).selectAll(`.${n.split(" ")[0]}`).remove(),dt(t).append("div").attr("class",n).text(e)}function J0(t="visualization-tooltip",e={}){return dt(`.${t}`).remove(),dt("body").append("div").attr("class",t).style("position","absolute").style("pointer-events","none").style("opacity",0).style("background",e.background||"rgba(0, 0, 0, 0.8)").style("color",e.color||"white").style("padding",e.padding||"8px 12px").style("border-radius",e.borderRadius||"4px").style("font-size",e.fontSize||"12px").style("z-index",e.zIndex||"1000").style("box-shadow",e.boxShadow||"0 2px 5px rgba(0,0,0,0.2)")}const ue={createSVG:H0,createScale:B0,createAxis:O0,renderAxis:V0,createColorScale:W0,addTitle:q0,createLegend:Y0,addGrid:G0,createTransition:K0,makeResponsive:X0,handleNoData:Z0,createTooltipContainer:J0},Q0={margin:{top:20,right:20,bottom:20,left:20},innerRadius:0,responsive:!0,colorScheme:rn,animationDuration:500,hoverEffectEnabled:!0,hoverRadiusIncrease:10,showLegend:!0,legendPosition:"right",showLabels:!1,labelMinAngle:15,sortValues:!1,sortDescending:!0};function j0(t,e){const n={...Q0,...e},{container:r,width:i=r.clientWidth,height:o=r.clientHeight,margin:a={top:20,right:20,bottom:20,left:20},innerRadius:s=0,responsive:d=!0,animationDuration:c=500,hoverEffectEnabled:l=!0,hoverRadiusIncrease:h=10,showLabels:u=!1,labelMinAngle:g=15,sortValues:p=!1,sortDescending:v=!0}=n;dt(r).select("svg").remove();let y=[...t];p&&y.sort((k,F)=>v?F.value-k.value:k.value-F.value);const{svg:m,chartWidth:$,chartHeight:C}=ue.createSVG({container:r,width:i,height:o,margin:a,responsive:d}),x=Math.min($,C)/2*.9,_=l0().value(k=>k.value);p||_.sort(null);const z=Po().innerRadius(s*x).outerRadius(x),N=Po().innerRadius(s*x).outerRadius(x+h),U=Po().innerRadius(x*.7).outerRadius(x*.7);let b;if(typeof n.colorScheme=="function")b=n.colorScheme;else{const k=Ce().domain(y.map(F=>F.key)).range(n.colorScheme||rn);b=F=>k(F)}const I=m.append("g").attr("transform",`translate(${i/2}, ${o/2})`),S=_(y),R=I.selectAll("path").data(S).enter().append("path").attr("class","pie-segment cursor-pointer").attr("d",z).attr("fill",k=>b(k.data.key)).attr("stroke","white").attr("stroke-width",2);if(l&&R.on("mouseenter",function(k,F){dt(this).transition().duration(200).attr("d",N),n.onMouseEnter&&n.onMouseEnter(k,F)}).on("mousemove",function(k,F){n.onMouseMove&&n.onMouseMove(k,F)}).on("mouseleave",function(k,F){dt(this).transition().duration(200).attr("d",z),n.onMouseLeave&&n.onMouseLeave(k,F)}),u&&I.selectAll("text").data(S).enter().append("text").attr("transform",k=>(k.endAngle-k.startAngle)*(180/Math.PI)>=g?`translate(${U.centroid(k)})`:"").attr("dy","0.35em").attr("text-anchor","middle").text(k=>k.data.key).style("font-size","12px").style("fill","var(--color-text-primary, #333)").style("opacity",k=>(k.endAngle-k.startAngle)*(180/Math.PI)>=g?1:0),n.showLegend){y.map(at=>({key:at.key,color:b(at.key),value:at.value,percentage:at.percentage}));const k=i<768,F=k?{width:$,height:100}:{width:180,height:C};k?I.attr("transform",`translate(${i/2}, ${(o-F.height)/2})`):n.legendPosition==="right"&&I.attr("transform",`translate(${(i-F.width)/2}, ${o/2})`);const q=k?a.left:i-F.width,ct=k?o-F.height:a.top+20,B=m.append("g").attr("class","legend").attr("transform",`translate(${q}, ${ct})`);n.legendTitle&&B.append("text").attr("class","legend-title").attr("x",0).attr("y",k?0:-5).attr("font-size","14px").attr("font-weight","bold").attr("fill","var(--color-text-primary, #333)").text(n.legendTitle);const P=15,j=k?20:25,J=5,K=k?6:12;let tt=k?Math.floor($/120):1;if(tt=Math.max(1,tt),y.slice(0,K).forEach((at,Y)=>{var Q;const E=Math.floor(Y/tt),O=Y%tt,A=k?O*($/tt):0,w=(k?20:0)+E*j,M=B.append("g").attr("class","legend-item").attr("transform",`translate(${A}, ${w})`);M.append("rect").attr("width",P).attr("height",P).attr("fill",b(at.key)).attr("stroke","var(--color-border, #e2e8f0)").attr("stroke-width",.5).attr("rx",2);const H=at.label||at.key;if(M.append("text").attr("x",P+J).attr("y",P/2).attr("dy","0.35em").attr("fill","var(--color-text-primary, #333)").attr("font-size","12px").attr("font-family","var(--font-family-base, sans-serif)").text(H),at.value!==void 0){const pt=k?at.value.toLocaleString():`${at.value.toLocaleString()} (${(Q=at.percentage)==null?void 0:Q.toFixed(1)}%)`;k?M.append("text").attr("x",P+J+H.length*7+10).attr("y",P/2).attr("dy","0.35em").attr("text-anchor","start").attr("fill","var(--color-text-secondary, #666)").attr("font-size","11px").attr("font-family","var(--font-family-base, sans-serif)").text(`(${at.value.toLocaleString()})`):M.append("text").attr("x",P+J).attr("y",P/2+14).attr("fill","var(--color-text-secondary, #666)").attr("font-size","11px").attr("font-family","var(--font-family-base, sans-serif)").text(pt)}}),y.length>K){const at=y.length-K,Y=Math.floor(K/tt),E=K%tt,O=k?E*($/tt):0,A=(k?20:0)+Y*j;B.append("text").attr("x",O+(k?0:P+J)).attr("y",A+(k?0:P/2)).attr("fill","var(--color-text-secondary, #666)").attr("font-size","11px").attr("font-style","italic").attr("font-family","var(--font-family-base, sans-serif)").text(`+${at} more...`)}}return{svg:m,pieGroup:I,update:k=>{let F=[...k];if(p&&F.sort((B,P)=>v?P.value-B.value:B.value-P.value),typeof n.colorScheme!="function"){const B=Ce().domain(F.map(P=>P.key)).range(n.colorScheme||rn);b=P=>B(P)}const q=_(F),ct=I.selectAll("path").data(q);if(ct.exit().transition().duration(c).attrTween("d",function(B){const P=B,j=P.endAngle,J={...P,startAngle:j,endAngle:j},K=Tr(P,J);return function(tt){return z(K(tt))}}).remove(),ct.enter().append("path").attr("class","pie-segment cursor-pointer").attr("fill",B=>b(B.data.key)).attr("stroke","white").attr("stroke-width",2).attr("d",z).style("opacity",0).transition().duration(c).style("opacity",1),ct.transition().duration(c).attrTween("d",function(B){const j=this.__data__,J=Tr(j,B);return function(K){return z(J(K))}}).attr("fill",B=>b(B.data.key)),l&&I.selectAll("path").on("mouseenter",function(B,P){dt(this).transition().duration(200).attr("d",N),n.onMouseEnter&&n.onMouseEnter(B,P)}).on("mousemove",function(B,P){n.onMouseMove&&n.onMouseMove(B,P)}).on("mouseleave",function(B,P){dt(this).transition().duration(200).attr("d",z),n.onMouseLeave&&n.onMouseLeave(B,P)}),u){const B=I.selectAll("text").data(q);B.exit().remove(),B.enter().append("text").attr("dy","0.35em").attr("text-anchor","middle").style("font-size","12px").style("fill","var(--color-text-primary, #333)").merge(B).transition().duration(c).attr("transform",P=>(P.endAngle-P.startAngle)*(180/Math.PI)>=g?`translate(${U.centroid(P)})`:"").text(P=>P.data.key).style("opacity",P=>(P.endAngle-P.startAngle)*(180/Math.PI)>=g?1:0)}if(n.showLegend){m.select(".legend").remove();const B=i<768,P=B?{width:$,height:100}:{width:180,height:C};B?I.attr("transform",`translate(${i/2}, ${(o-P.height)/2})`):n.legendPosition==="right"&&I.attr("transform",`translate(${(i-P.width)/2}, ${o/2})`);const j=B?a.left:i-P.width,J=B?o-P.height:a.top+20,K=m.append("g").attr("class","legend").attr("transform",`translate(${j}, ${J})`);n.legendTitle&&K.append("text").attr("class","legend-title").attr("x",0).attr("y",B?0:-5).attr("font-size","14px").attr("font-weight","bold").attr("fill","var(--color-text-primary, #333)").text(n.legendTitle);const tt=15,ut=B?20:25,at=5,Y=B?6:12;let E=B?Math.floor($/120):1;if(E=Math.max(1,E),F.slice(0,Y).forEach((A,w)=>{var it;const M=Math.floor(w/E),H=w%E,Q=B?H*($/E):0,pt=(B?20:0)+M*ut,ft=K.append("g").attr("class","legend-item").attr("transform",`translate(${Q}, ${pt})`);ft.append("rect").attr("width",tt).attr("height",tt).attr("fill",b(A.key)).attr("stroke","var(--color-border, #e2e8f0)").attr("stroke-width",.5).attr("rx",2);const Z=A.label||A.key;if(ft.append("text").attr("x",tt+at).attr("y",tt/2).attr("dy","0.35em").attr("fill","var(--color-text-primary, #333)").attr("font-size","12px").attr("font-family","var(--font-family-base, sans-serif)").text(Z),A.value!==void 0){const vt=B?A.value.toLocaleString():`${A.value.toLocaleString()} (${(it=A.percentage)==null?void 0:it.toFixed(1)}%)`;B?ft.append("text").attr("x",tt+at+Z.length*7+10).attr("y",tt/2).attr("dy","0.35em").attr("text-anchor","start").attr("fill","var(--color-text-secondary, #666)").attr("font-size","11px").attr("font-family","var(--font-family-base, sans-serif)").text(`(${A.value.toLocaleString()})`):ft.append("text").attr("x",tt+at).attr("y",tt/2+14).attr("fill","var(--color-text-secondary, #666)").attr("font-size","11px").attr("font-family","var(--font-family-base, sans-serif)").text(vt)}}),F.length>Y){const A=F.length-Y,w=Math.floor(Y/E),M=Y%E,H=B?M*($/E):0,Q=(B?20:0)+w*ut;K.append("text").attr("x",H+(B?0:tt+at)).attr("y",Q+(B?0:tt/2)).attr("fill","var(--color-text-secondary, #666)").attr("font-size","11px").attr("font-style","italic").attr("font-family","var(--font-family-base, sans-serif)").text(`+${A} more...`)}}},destroy:()=>{r&&dt(r).select("svg").remove()}}}function ty(t,e){return j0(t,{...e,innerRadius:e.innerRadius===void 0?.5:e.innerRadius})}var ey=$t("<option> </option>"),ny=$t("<option> </option>"),ry=$t("<span> </span>"),iy=$t('<div class="absolute inset-center text-secondary"> </div>'),oy=$t('<div class="absolute inset-center text-error"> </div>'),ay=$t('<div class="flex flex-wrap gap-md p-md bg-card rounded-t border-b border-solid border-default filters svelte-1chk83o"><div class="flex flex-col gap-xs filter-group svelte-1chk83o"><label for="country-filter" class="text-xs font-bold text-secondary"> </label> <select id="country-filter" class="p-xs px-sm rounded-sm border border-solid border-default bg-card text-primary"></select></div> <div class="flex flex-col gap-xs filter-group svelte-1chk83o"><label for="type-filter" class="text-xs font-bold text-secondary"> </label> <select id="type-filter" class="p-xs px-sm rounded-sm border border-solid border-default bg-card text-primary"></select></div> <div class="flex flex-col gap-xs filter-group svelte-1chk83o"><label for="chart-type" class="text-xs font-bold text-secondary"> </label> <div class="flex items-center"><button class="p-xs px-sm rounded-sm border border-solid border-default bg-card text-primary hover:bg-hover"> </button></div></div> <div class="ml-auto flex items-end text-sm text-secondary summary svelte-1chk83o"><!></div></div> <div class="chart-container svelte-1chk83o"><!></div>',1),sy=$t('<div class="w-full h-full flex flex-col language-visualization-container"><!></div>');function ly(t,e){ke(e,!1);const[n,r]=on(),i=()=>xt(fe,"$itemsStore",n),o=()=>xt(B,"$toggleLanguagesText",n),a=()=>xt(xe,"$languageStore",n),s=()=>xt(q,"$filterByCountryText",n),d=()=>xt(ct,"$filterByTypeText",n);let c=bt("all"),l=bt("all"),h=bt(!0),u=bt([]),g=bt([]),p=bt([]),v=bt(0),y="en",m=bt(""),$=[],C=0,T=0,x=bt(),_=null,z=bt(),N;const{groupAndCount:U}=Oe({filterMissingValues:!0,requiredFields:["language"],filterFn:M=>!(f(c)!=="all"&&M.country!==f(c)||f(l)!=="all"&&M.type!==f(l)),calculatePercentages:!0,sortByCount:!0,sortDescending:!0}),b=Oe({filterMissingValues:!0,requiredFields:["language","country"],filterFn:M=>f(l)==="all"||M.type===f(l)}),I=Oe({filterMissingValues:!0,requiredFields:["language","type"],filterFn:M=>f(c)==="all"||M.country===f(c)});let S,R,W=bt(!1);const X=Ce(rn);let k=new Map;function F(M){if(k.has(M))return k.get(M);const H=X(M);return k.set(M,H),H}rt("viz.all_countries"),rt("viz.all_types");const q=rt("viz.filter_by_country"),ct=rt("viz.filter_by_type");rt("viz.no_data");const B=rt("viz.toggle_languages");rt("viz.showing_items",{0:P(f(v)),1:P(f(u).length)}),rt("viz.items"),rt("viz.percent_of_total");function P(M){return M.toLocaleString(y==="fr"?"fr-FR":"en-US")}function j(M){const H=P(M);return ot("viz.language_distribution_items",{0:H})}function J(){f(v)>0?D(m,j(f(v))):D(m,ot("viz.language_distribution_title"))}Ye(()=>(D(W,!0),(async()=>{try{if(await kn(),!f(x)){console.error("Container element not found in onMount");return}if(N=Dr({container:f(x),onResize:()=>{if(f(W)&&f(x)){const{width:M,height:H}=N.dimensions;C=M,T=H,at()}}}),S=xe.subscribe(M=>{f(W)&&(y=M,f(x)&&(J(),i().items&&i().items.length>0&&at()))}),i().items&&i().items.length>0){const{width:M,height:H}=N.dimensions;C=M,T=H,await kn(),f(x)&&at()}else fe.loadItems()}catch(M){console.error("Error during initialization:",M)}})(),()=>{try{D(W,!1),N&&N.cleanup(),S&&S(),R&&(R.cleanup(),R=null),_&&(_.destroy(),_=null),f(x)&&dt(f(x)).selectAll("*").remove()}catch(M){console.error("Error during cleanup:",M)}})),In(()=>{try{D(W,!1),N&&N.cleanup(),S&&S(),R&&(R.cleanup(),R=null),f(x)&&dt(f(x)).selectAll("*").remove()}catch(M){console.error("Error during cleanup:",M)}});function K(){if(!i().items||i().items.length===0)return;const H=U(i().items,Q=>Q.language||"Unknown").map(Q=>({language:Q.key,count:Q.count,percentage:Q.percentage||0}));return H.forEach(Q=>{k.has(Q.language)||k.set(Q.language,X(Q.language))}),D(v,H.reduce((Q,pt)=>Q+pt.count,0)),J(),H}function tt(){if(!i().items||i().items.length===0)return;const M=ot("viz.all_countries"),H=ot("viz.all_types"),Q=b.filterItems(i().items),pt=I.filterItems(i().items),ft=b.groupAndCount(Q,it=>it.country||"Unknown");D(g,[{value:"all",label:M,count:Q.length},...ft.filter(it=>it.key!=="Unknown").map(it=>{const vt=ot(`country.${it.key}`)||it.key;return{value:it.key,label:vt,count:it.count}}).sort((it,vt)=>vt.count-it.count)]);const Z=I.groupAndCount(pt,it=>it.type||"Unknown");D(p,[{value:"all",label:H,count:pt.length},...Z.map(it=>({value:it.key,label:it.key,count:it.count})).sort((it,vt)=>vt.count-it.count)])}function ut(M,H){var Z;if(!f(z))return;const Q=H.data,pt=ot(`lang.${Q.key}`)||Q.key,ft=wn(pt,[{label:ot("viz.items"),value:P(Q.value)},{label:ot("viz.percent_of_total"),value:`${((Z=Q.percentage)==null?void 0:Z.toFixed(2))||0}%`}]);f(z).showTooltip(M,ft)}function at(){if(!f(x))return;const M=K();if(D(u,M||[]),!M||M.length===0){_&&(_.destroy(),_=null),R&&(R.cleanup(),R=null),ue.handleNoData(f(x),ot("viz.no_data"));return}if($.length===0)$=M.map(Z=>({language:Z.language,visible:!0}));else{const Z=$.map(it=>it.language);M.forEach(it=>{Z.includes(it.language)||$.push({language:it.language,visible:!0})})}const H=M.filter(Z=>{const it=$.find(vt=>vt.language===Z.language);return(it==null?void 0:it.visible)??!0}).map(Z=>({key:Z.language,label:ot(`lang.${Z.language}`)||Z.language,value:Z.count,percentage:Z.percentage}));if(H.length===0){_&&(_.destroy(),_=null),R&&(R.cleanup(),R=null),ue.handleNoData(f(x),ot("viz.no_data"));return}_&&(_.destroy(),_=null),R&&(R.cleanup(),R=null);const Q=f(x).getBoundingClientRect();C=Q.width,T=Q.height;const pt=C<768,ft=pt?{top:10,right:10,bottom:50,left:10}:{top:20,right:20,bottom:20,left:20};if(_=ty(H,{container:f(x),width:C,height:T,margin:ft,innerRadius:f(h)?.5:0,responsive:!0,colorScheme:Z=>F(Z),hoverEffectEnabled:!0,hoverRadiusIncrease:pt?5:10,showLegend:!1,showLabels:!1,sortValues:!0,sortDescending:!0,onMouseEnter:ut,onMouseMove:ut,onMouseLeave:()=>f(z).hideTooltip()}),_){const Z=M.map(Mt=>{var Ut;const Wt=((Ut=$.find(Lt=>Lt.language===Mt.language))==null?void 0:Ut.visible)??!0;return{key:Mt.language,label:ot(`lang.${Mt.language}`)||Mt.language,color:F(Mt.language),value:Mt.count,visible:Wt,customProperties:{language:Mt.language}}});R=Uc({container:f(x),title:o(),items:Z,type:"html",position:"bottom",orientation:"horizontal",className:"multi-row-legend",showValues:!0,valueFormatter:Mt=>P(Mt),translateKeys:{itemPrefix:"lang."},responsive:!0,breakpoint:768,interactive:!0,onItemClick:Mt=>{const Wt=$.findIndex(Ut=>{var Lt;return Ut.language===((Lt=Mt.customProperties)==null?void 0:Lt.language)});Wt>=0&&($[Wt].visible=!$[Wt].visible,$=[...$],at())}}),R.render();const vt=Math.ceil(M.length/5)*22+30,Dt=dt(f(x)).select("svg");Dt.empty()||Dt.attr("height",T+vt+30)}}function Y(M){const H=M.target;D(c,H.value),tt(),at()}function E(M){const H=M.target;D(l,H.value),tt(),at()}function O(){D(h,!f(h)),at()}pe(()=>{},()=>{J()}),pe(()=>(f(W),i(),f(x)),()=>{f(W)&&i().items&&f(x)&&at()}),pe(()=>(a(),f(c),f(l),i()),()=>{(a()||f(c)||f(l))&&i().items&&i().items.length>0&&tt()}),hi(),Ue();var A=sy(),w=L(A);We(Nr(w,{get titleHtml(){return f(m)},descriptionTranslationKey:"viz.language_distribution_description",theme:"default",className:"language-visualization",children:(M,H)=>{var Q=ay(),pt=jt(Q),ft=L(pt),Z=L(ft),it=L(Z),vt=_t(Z,2);It(()=>{f(c),Za(()=>{f(g)})}),Hn(vt,5,()=>f(g),et=>et.value,(et,wt)=>{var Ct=ey(),gt={},Vt=L(Ct);It(Rt=>{gt!==(gt=f(wt).value)&&(Ct.value=(Ct.__value=f(wt).value)==null?"":f(wt).value),lt(Vt,`${f(wt).label??""} (${Rt??""})`)},[()=>P(f(wt).count)],ie),nt(et,Ct)});var Dt=_t(ft,2),Mt=L(Dt),Wt=L(Mt),Ut=_t(Mt,2);It(()=>{f(l),Za(()=>{f(p)})}),Hn(Ut,5,()=>f(p),et=>et.value,(et,wt)=>{var Ct=ny(),gt={},Vt=L(Ct);It(Rt=>{gt!==(gt=f(wt).value)&&(Ct.value=(Ct.__value=f(wt).value)==null?"":f(wt).value),lt(Vt,`${f(wt).label??""} (${Rt??""})`)},[()=>P(f(wt).count)],ie),nt(et,Ct)});var Lt=_t(Dt,2),G=L(Lt),yt=L(G),st=_t(G,2),ht=L(st),Tt=L(ht),St=_t(Lt,2),Bt=L(St);{var Kt=et=>{var wt=ry(),Ct=L(wt);It(gt=>lt(Ct,gt),[()=>ot("viz.showing_items",{0:P(f(v)),1:f(u).length.toString()})],ie),nt(et,wt)};Ot(Bt,et=>{f(u).length>0&&et(Kt)})}var Gt=_t(pt,2),Et=L(Gt);{var Ft=et=>{var wt=iy(),Ct=L(wt);It(gt=>lt(Ct,gt),[()=>ot("ui.loading")],ie),nt(et,wt)},V=et=>{var wt=se(),Ct=jt(wt);{var gt=Vt=>{var Rt=oy(),kt=L(Rt);It(()=>lt(kt,i().error)),nt(Vt,Rt)};Ot(Ct,Vt=>{i().error&&Vt(gt)},!0)}nt(et,wt)};Ot(Et,et=>{i().loading?et(Ft):et(V,!1)})}We(Gt,et=>D(x,et),()=>f(x)),It((et,wt)=>{lt(it,`${s()??""}:`),lt(Wt,`${d()??""}:`),lt(yt,`${et??""}:`),lt(Tt,wt)},[()=>ot("viz.chart_type"),()=>f(h)?ot("viz.pie_chart"):ot("viz.donut_chart")],ie),_e("change",vt,Y),rs(vt,()=>f(c),et=>D(c,et)),_e("change",Ut,E),rs(Ut,()=>f(l),et=>D(l,et)),_e("click",ht,O),nt(M,Q)},$$slots:{default:!0},$$legacy:!0}),M=>D(z,M),()=>f(z)),nt(t,A),ze(),r()}function cy(t){const{container:e,width:n=e.clientWidth,height:r=e.clientHeight,data:i,keyField:o="key",valueField:a="value",className:s="bar-chart",barPadding:d=.2,barCornerRadius:c=3,barStroke:l="white",barStrokeWidth:h=1,margin:u={top:20,right:30,bottom:60,left:50},responsive:g=!0,isMobile:p=!1,showXAxis:v=!0,showYAxis:y=!0,xAxisLabel:m,yAxisLabel:$,xAxisRotation:C=-45,xAxisTickFormat:T,yAxisTickFormat:x,xAxisTicks:_,yAxisTicks:z=5,showValueLabels:N=!0,valueLabelMinHeight:U=15,valueFormatter:b=Y=>Y.toString(),enableInteraction:I=!0,highlightColor:S,onBarMouseEnter:R,onBarMouseMove:W,onBarMouseLeave:X,onBarClick:k}=t;let F;t.barColors?Array.isArray(t.barColors)?F=Ce().domain(i.map(Y=>Y[t.keyField||"key"])).range(t.barColors):F=t.barColors:F=Ce(rn);const q=br(i,Y=>Y[a])||0,{svg:ct,chart:B,chartWidth:P,chartHeight:j}=ue.createSVG({container:e,width:n,height:r,margin:u,className:s,responsive:g}),J=ue.createScale({type:"band",domain:i.map(Y=>Y[o]),range:[0,P],padding:p?Math.min(d,.1):d}),K=ue.createScale({type:"linear",domain:[0,q*1.1],range:[j,0]});if(v){const Y=ue.createAxis({type:"x",scale:J,position:"bottom",tickFormat:T,ticks:_,rotate:C});B.append("g").attr("class","x-axis").attr("transform",`translate(0, ${j})`).call(E=>ue.renderAxis(E,Y)).selectAll("text").attr("font-size",p?"8px":"var(--font-size-xs)").attr("fill","var(--color-text-primary)"),m&&B.append("text").attr("class","x-axis-label").attr("text-anchor","middle").attr("x",P/2).attr("y",j+(p?u.bottom*.6:u.bottom*.7)).text(m)}if(y){const Y=ue.createAxis({type:"y",scale:K,position:"left",tickFormat:x,ticks:p?Math.min(z,3):z});B.append("g").attr("class","y-axis").call(E=>ue.renderAxis(E,Y)).selectAll("text").attr("font-size",p?"8px":"var(--font-size-xs)").attr("fill","var(--color-text-primary)"),$&&B.append("text").attr("class","y-axis-label").attr("text-anchor","middle").attr("transform","rotate(-90)").attr("x",-j/2).attr("y",p?-u.left+12:-u.left+15).text($)}const tt=B.selectAll(".bar").data(i).enter().append("rect").attr("class","bar").attr("x",Y=>J(Y[o])||0).attr("y",Y=>K(Y[a])).attr("width",J.bandwidth()).attr("height",Y=>Math.max(0,j-K(Y[a]))).attr("fill",Y=>F(Y.originalKey||Y[o])).attr("rx",p?Math.min(c,2):c).attr("ry",p?Math.min(c,2):c).attr("stroke",l).attr("stroke-width",p?h/2:h);I&&tt.classed("cursor-pointer",!0).on("mouseenter",function(Y,E){const O=this;if(S)dt(O).transition().duration(200).attr("fill",S);else{const A=F(E.originalKey||E[o]);dt(O).transition().duration(200).attr("fill",Fe(A).brighter(.5).toString())}R&&R(Y,E,O)}).on("mousemove",function(Y,E){W&&W(Y,E,this)}).on("mouseleave",function(Y,E){const O=this;dt(O).transition().duration(200).attr("fill",F(E.originalKey||E[o])),X&&X(Y,E,O)}).on("click",function(Y,E){k&&k(Y,E,this)}),N&&B.selectAll(".bar-label").data(i).enter().append("text").attr("class","bar-label").attr("x",Y=>(J(Y[o])||0)+J.bandwidth()/2).attr("y",Y=>K(Y[a])-5).attr("text-anchor","middle").attr("font-size",p?"8px":"var(--font-size-xs)").attr("fill","var(--color-text-secondary)").attr("display",Y=>j-K(Y[a])<U&&p?"none":"block").text(Y=>b(Y[a]));function ut(Y){J.domain(Y.map(w=>w[o]));const E=br(Y,w=>w[a])||0;if(K.domain([0,E*1.1]),v){const w=B.select(".x-axis"),M=ue.createAxis({type:"x",scale:J,position:"bottom",tickFormat:T,ticks:_,rotate:C});w.transition().duration(500).call(H=>ue.renderAxis(H,M))}if(y){const w=B.select(".y-axis"),M=ue.createAxis({type:"y",scale:K,position:"left",tickFormat:x,ticks:p?Math.min(z,3):z});w.transition().duration(500).call(H=>ue.renderAxis(H,M))}const O=B.selectAll(".bar").data(Y);O.exit().transition().duration(300).attr("y",j).attr("height",0).remove();const A=O.enter().append("rect").attr("class","bar").attr("x",w=>J(w[o])||0).attr("y",j).attr("width",J.bandwidth()).attr("height",0).attr("fill",w=>F(w.originalKey||w[o])).attr("rx",p?Math.min(c,2):c).attr("ry",p?Math.min(c,2):c).attr("stroke",l).attr("stroke-width",p?h/2:h);if(I&&A.classed("cursor-pointer",!0).on("mouseenter",function(w,M){const H=this;if(S)dt(H).transition().duration(200).attr("fill",S);else{const Q=F(M.originalKey||M[o]);dt(H).transition().duration(200).attr("fill",Fe(Q).brighter(.5).toString())}R&&R(w,M,H)}).on("mousemove",function(w,M){W&&W(w,M,this)}).on("mouseleave",function(w,M){const H=this;dt(H).transition().duration(200).attr("fill",F(M.originalKey||M[o])),X&&X(w,M,H)}).on("click",function(w,M){k&&k(w,M,this)}),O.transition().duration(500).attr("x",w=>J(w[o])||0).attr("y",w=>K(w[a])).attr("width",J.bandwidth()).attr("height",w=>Math.max(0,j-K(w[a]))).attr("fill",w=>F(w.originalKey||w[o])),A.transition().duration(500).attr("y",w=>K(w[a])).attr("height",w=>Math.max(0,j-K(w[a]))),N){const w=B.selectAll(".bar-label").data(Y);w.exit().remove(),w.enter().append("text").attr("class","bar-label").attr("x",M=>(J(M[o])||0)+J.bandwidth()/2).attr("y",M=>K(M[a])-5).attr("text-anchor","middle").attr("font-size",p?"8px":"var(--font-size-xs)").attr("fill","var(--color-text-secondary)").attr("opacity",0).text(M=>b(M[a])).attr("display",M=>j-K(M[a])<U&&p?"none":"block").transition().duration(500).attr("opacity",1),w.transition().duration(500).attr("x",M=>(J(M[o])||0)+J.bandwidth()/2).attr("y",M=>K(M[a])-5).text(M=>b(M[a])).attr("display",M=>j-K(M[a])<U&&p?"none":"block")}}function at(){ct&&(ct.selectAll("*").remove(),ct.remove())}return{svg:ct,chart:B,xScale:J,yScale:K,chartWidth:P,chartHeight:j,update:ut,destroy:at}}var uy=$t('<div class="absolute inset-center text-secondary loading"> </div>'),fy=$t('<div class="absolute inset-center text-error error"> </div>'),dy=$t('<div class="relative bg-card rounded p-md overflow-hidden min-h-400 w-full chart-container"><!></div>'),hy=$t('<div class="w-full index-visualization-container"><!></div>');function gy(t,e){ke(e,!1);const[n,r]=on(),i=()=>xt(fe,"$itemsStore",n),o={Évènements:"Events",Associations:"Organizations",Individus:"Persons",Emplacements:"Locations",Sujets:"Topics","Notices d'autorité":"Authority Files"};function a(X){return o[X]||X}let s=[],d=0,c=!1,l=bt(),h="en",u=bt(""),g=0,p=0,v=null,y=null,m=bt(),$=null;const{groupAndCount:C}=Oe({filterMissingValues:!0,requiredFields:["type"],filterFn:X=>X.type==="Notice d'autorité",calculatePercentages:!0,sortByCount:!0,sortDescending:!0}),T="viz.index_distribution_description",x=Ce(rn);function _(X){return X.toLocaleString(h==="fr"?"fr-FR":"en-US")}function z(X){const k=_(X);return ot("viz.index_distribution_items",{0:k})}function N(){c&&(d>0?D(u,z(d)):D(u,ot("viz.index_distribution_title")))}let U=null;Ye(async()=>{try{if(c=!0,await kn(),!f(l)){console.error("Container element not found in onMount");return}const X=f(l).getBoundingClientRect();g=X.width||100,p=X.height||400,$=Dr({container:f(l),onResize:()=>{c&&f(l)&&$&&(g=$.width,b())},debounce:!0,debounceDelay:200}),U=xe.subscribe(k=>{c&&(h=k,f(l)&&(N(),i().items&&i().items.length>0&&b()))}),y=fe.subscribe(k=>{c&&f(l)&&k.items&&k.items.length>0&&b()}),i().items&&i().items.length>0?b():fe.loadItems()}catch(X){console.error("Error during initialization:",X)}});function b(){if(!(!c||!f(l)))try{g=f(l).getBoundingClientRect().width,p=500;const k=I();if(!k||k.length===0){ue.handleNoData(f(l),ot("viz.no_data"));return}s=k;const F=g<768;v&&(v.destroy(),v=null);const q=k.map(P=>({key:P.category,value:P.count,originalKey:P.originalCategory,percentage:P.percentage})),ct=k.length>5,B={top:20,right:30,bottom:120,left:60};v=cy({container:f(l),width:g,height:p,data:q,margin:B,className:"index-distribution-chart",isMobile:F,barColors:x,barPadding:.2,barCornerRadius:3,xAxisLabel:ot("viz.categories"),yAxisLabel:ot("viz.number_of_items"),xAxisRotation:-45,xAxisTicks:Math.max(3,Math.floor(g/120)),yAxisTicks:F?3:5,xAxisTickFormat:P=>P.length>15?P.substring(0,12)+"...":P,valueFormatter:_,onBarMouseEnter:(P,j)=>{if(!c)return;const J=s.find(K=>K.category===j.key);J&&S(P,J)},onBarMouseMove:(P,j)=>{if(!c)return;const J=s.find(K=>K.category===j.key);J&&S(P,J)},onBarMouseLeave:()=>{c&&f(m)&&f(m).hideTooltip()}})}catch(X){console.error("Error creating bar chart:",X)}}function I(){if(!i().items||i().items.length===0)return[];console.log(`Processing ${i().items.length} items`);const X=i().items.filter(q=>q.type==="Notice d'autorité");if(console.log(`Found ${X.length} items of type "Notice d'autorité"`),X.length===0)return[];const k=C(X,q=>q.item_set_title||ot("viz.uncategorized"));console.log(`Grouped into ${k.length} categories`);const F=k.map(q=>{const B=`category.${a(q.key)}`,P=ot(B);return{category:P!==B?P:q.key,originalCategory:q.key,count:q.count,percentage:q.percentage||0}});return d=k.reduce((q,ct)=>q+ct.count,0),br(F,q=>q.count),N(),F}function S(X,k){if(!c||!f(m))return;const F=f(m).createGridTooltipContent(k.category,[{label:ot("viz.items"),value:_(k.count)},{label:ot("viz.percent_of_total"),value:`${k.percentage.toFixed(2)}%`}]);f(m).showTooltip(X,F)}In(()=>{try{c=!1,v&&(v.destroy(),v=null),$&&($.cleanup(),$=null),U&&(U(),U=null),y&&(y(),y=null),f(l)&&dt(f(l)).selectAll("*").remove()}catch(X){console.error("Error during cleanup:",X)}}),Ue();var R=hy(),W=L(R);We(Nr(W,{get titleHtml(){return f(u)},descriptionTranslationKey:T,theme:"default",className:"index-visualization",children:(X,k)=>{var F=dy(),q=L(F);{var ct=P=>{var j=uy(),J=L(j);It(K=>lt(J,K),[()=>ot("ui.loading")],ie),nt(P,j)},B=P=>{var j=se(),J=jt(j);{var K=tt=>{var ut=fy(),at=L(ut);It(()=>lt(at,i().error)),nt(tt,ut)};Ot(J,tt=>{i().error&&tt(K)},!0)}nt(P,j)};Ot(q,P=>{i().loading?P(ct):P(B,!1)})}We(F,P=>D(l,P),()=>f(l)),nt(X,F)},$$slots:{default:!0},$$legacy:!0}),X=>D(m,X),()=>f(m)),nt(t,R),ze(),r()}class rl{constructor(e){Hr(this,"options");Hr(this,"tooltipCallbacks",null);Hr(this,"monthFormat",Un("%Y-%m"));Hr(this,"displayFormat",Un("%b %Y"));this.options={...e,isMobile:e.width<768,isExtraSmall:e.width<480}}setTooltipCallbacks(e){this.tooltipCallbacks=e}render(e){try{const{container:n,width:r,height:i,isMobile:o,isExtraSmall:a,currentLang:s="en"}=this.options;if(console.log("[TimelineChart] Rendering with dimensions:",{width:r,height:i}),console.log("[TimelineChart] Container element:",n),console.log("[TimelineChart] Data points to render:",e.length),!e||e.length===0){console.warn("[TimelineChart] No timeline data available"),dt(n).selectAll("*").remove(),dt(n).append("div").attr("class","absolute inset-center text-secondary").text("No timeline data available with the current filters");return}if(!n){console.error("[TimelineChart] Container element is null or undefined");return}let d=r,c=i;(!d||d<=0)&&(console.warn("[TimelineChart] Invalid width, using minimum width of 300px"),d=300),(!c||c<=0)&&(console.warn("[TimelineChart] Invalid height, using minimum height of 500px"),c=500),console.log("[TimelineChart] Using dimensions:",{width:d,height:c}),dt(n).selectAll("*").remove();const l={top:o?20:40,right:o?15:30,bottom:o?70:80,left:o?40:60},h=dt(n).append("svg").attr("width",d).attr("height",c).attr("viewBox",`0 0 ${d} ${c}`).attr("class","timeline-chart"),u=d-l.left-l.right,p=(c-l.top-l.bottom-(o?30:50))/2,v=Dc().domain(Hf(e,y=>y.date)).range([0,u]);h.append("line").attr("x1",l.left).attr("y1",l.top+p+(o?15:25)).attr("x2",d-l.right).attr("y2",l.top+p+(o?15:25)).attr("stroke","var(--color-border-default)").attr("stroke-width",1).attr("stroke-dasharray","3,3"),this.addLegend(h,l,a,d),h.append("defs").append("marker").attr("id","circle").attr("viewBox","-5 -5 10 10").attr("refX",0).attr("refY",0).attr("markerWidth",5).attr("markerHeight",5).append("circle").attr("r",3).attr("fill","var(--color-primary)"),this.renderMonthlyChart(h,e,l,u,p,v,o),this.renderTotalChart(h,e,l,u,p,v,o),console.log("[TimelineChart] Successfully rendered timeline chart")}catch(n){console.error("[TimelineChart] Error rendering timeline chart:",n);try{this.options.container&&(dt(this.options.container).selectAll("*").remove(),dt(this.options.container).append("div").attr("class","absolute inset-center text-error p-md").text("Error rendering timeline chart. Please check console for details."))}catch(r){console.error("[TimelineChart] Error showing error message:",r)}}}addLegend(e,n,r,i){if(r)return;const{translations:o}=this.options,a=e.append("g").attr("transform",`translate(${i-n.right}, ${n.top-10})`);a.append("line").attr("x1",-100).attr("y1",0).attr("x2",-80).attr("y2",0).attr("stroke","var(--color-primary)").attr("stroke-width",2).attr("marker-end","url(#circle)"),a.append("text").attr("x",-75).attr("y",4).attr("class","text-xs text-secondary").text((o==null?void 0:o.monthlyAdditions)||"Monthly Additions"),a.append("line").attr("x1",-100).attr("y1",20).attr("x2",-80).attr("y2",20).attr("stroke","var(--color-secondary)").attr("stroke-width",2).attr("stroke-dasharray","4 2"),a.append("text").attr("x",-75).attr("y",24).attr("class","text-xs text-secondary").text((o==null?void 0:o.totalItems)||"Total Items")}renderMonthlyChart(e,n,r,i,o,a,s){const{translations:d,currentLang:c="en"}=this.options,l=e.append("g").attr("transform",`translate(${r.left}, ${r.top})`),h=ui().domain([0,(br(n,y=>y.count)||0)*1.1]).range([o,0]);l.append("g").attr("class","grid").selectAll("line").data(h.ticks(s?3:5)).enter().append("line").attr("x1",0).attr("x2",i).attr("y1",y=>h(y)).attr("y2",y=>h(y)).attr("stroke","var(--color-border-default)").attr("stroke-width",.5);const u=Math.max(2,Math.floor(i/(s?60:80))),g=qi(a).ticks(u).tickFormat(y=>{const m=y;return c==="fr"?m.toLocaleDateString("fr-FR",{month:"short",year:"2-digit"}):Un("%b '%y")(m)});l.append("g").attr("class","x-axis").attr("transform",`translate(0, ${o})`).call(g).selectAll("text").attr("class","text-xs text-primary").attr("text-anchor","end").attr("dx","-.8em").attr("dy",".15em").attr("transform",`rotate(${s?-45:-30})`);const p=Yi(h).ticks(s?3:5);l.append("g").attr("class","y-axis").call(p).selectAll("text").attr("class","text-xs text-primary"),s||l.append("text").attr("class","text-xs text-secondary").attr("transform","rotate(-90)").attr("y",-50).attr("x",-o/2).attr("text-anchor","middle").text((d==null?void 0:d.monthlyAdditions)||"Monthly Additions");const v=Ks().x(y=>a(y.date)).y(y=>h(y.count)).curve(Qs);l.append("path").datum(n).attr("fill","none").attr("stroke","var(--color-primary)").attr("stroke-width",s?1.5:2).attr("d",v),this.addMonthlyDots(l,n,a,h,s)}addMonthlyDots(e,n,r,i,o){const{formatNumber:a,translations:s,currentLang:d="en"}=this.options;if(!this.tooltipCallbacks)return;const{showTooltip:c,hideTooltip:l}=this.tooltipCallbacks;e.selectAll(".dot-monthly").data(o?n.filter((h,u)=>u%2===0):n).enter().append("circle").attr("class","dot-monthly cursor-pointer").attr("cx",h=>r(h.date)).attr("cy",h=>i(h.count)).attr("r",o?3:4).attr("fill","var(--color-primary)").attr("stroke","white").attr("stroke-width",1).on("mouseenter",function(h,u){dt(this).transition().duration(200).attr("r",o?5:6);const g=u.date.toLocaleString(d==="fr"?"fr-FR":"en-US",{month:"long"}),p=u.date.getFullYear(),v=wn(`${g} ${p}`,[{label:(s==null?void 0:s.newItems)||"New Items",value:a?a(u.count):u.count.toString()},{label:(s==null?void 0:s.percentage)||"Percentage",value:`${u.percentage.toFixed(2)}%`}]);c(h,v)}).on("mousemove",function(h,u){const g=u.date.toLocaleString(d==="fr"?"fr-FR":"en-US",{month:"long"}),p=u.date.getFullYear(),v=wn(`${g} ${p}`,[{label:(s==null?void 0:s.newItems)||"New Items",value:a?a(u.count):u.count.toString()},{label:(s==null?void 0:s.percentage)||"Percentage",value:`${u.percentage.toFixed(2)}%`}]);c(h,v)}).on("mouseleave",function(){dt(this).transition().duration(200).attr("r",o?3:4),l()})}renderTotalChart(e,n,r,i,o,a,s){const{translations:d,currentLang:c="en"}=this.options,l=e.append("g").attr("transform",`translate(${r.left}, ${r.top+o+(s?30:50)})`),h=ui().domain([0,(br(n,y=>y.total)||0)*1.1]).range([o,0]);l.append("g").attr("class","grid").selectAll("line").data(h.ticks(s?3:5)).enter().append("line").attr("x1",0).attr("x2",i).attr("y1",y=>h(y)).attr("y2",y=>h(y)).attr("stroke","var(--color-border-default)").attr("stroke-width",.5);const u=Math.max(2,Math.floor(i/(s?60:80))),g=qi(a).ticks(u).tickFormat(y=>{const m=y;return c==="fr"?m.toLocaleDateString("fr-FR",{month:"short",year:"2-digit"}):Un("%b '%y")(m)});l.append("g").attr("class","x-axis").attr("transform",`translate(0, ${o})`).call(g).selectAll("text").attr("class","text-xs text-primary").attr("text-anchor","end").attr("dx","-.8em").attr("dy",".15em").attr("transform",`rotate(${s?-45:-30})`);const p=Yi(h).ticks(s?3:5);l.append("g").attr("class","y-axis").call(p).selectAll("text").attr("class","text-xs text-primary"),s||(l.append("text").attr("class","text-xs text-secondary").attr("transform","rotate(-90)").attr("y",-50).attr("x",-o/2).attr("text-anchor","middle").text((d==null?void 0:d.totalItems)||"Total Items"),l.append("text").attr("class","text-xs text-secondary").attr("text-anchor","middle").attr("x",i/2).attr("y",o+45).text((d==null?void 0:d.month)||"Month"));const v=Ks().x(y=>a(y.date)).y(y=>h(y.total)).curve(Qs);l.append("path").datum(n).attr("fill","none").attr("stroke","var(--color-secondary)").attr("stroke-width",s?1.5:2).attr("stroke-dasharray","4 2").attr("d",v),this.addTotalDots(l,n,a,h,s)}addTotalDots(e,n,r,i,o){const{formatNumber:a,translations:s,currentLang:d="en"}=this.options;if(!this.tooltipCallbacks)return;const{showTooltip:c,hideTooltip:l}=this.tooltipCallbacks;e.selectAll(".dot-total").data(o?n.filter((h,u)=>u%2===0):n).enter().append("circle").attr("class","dot-total cursor-pointer").attr("cx",h=>r(h.date)).attr("cy",h=>i(h.total)).attr("r",o?3:4).attr("fill","var(--color-secondary)").attr("stroke","white").attr("stroke-width",1).on("mouseenter",function(h,u){dt(this).transition().duration(200).attr("r",o?5:6);const g=u.date.toLocaleString(d==="fr"?"fr-FR":"en-US",{month:"long"}),p=u.date.getFullYear(),v=wn(`${g} ${p}`,[{label:(s==null?void 0:s.totalItems)||"Total Items",value:a?a(u.total):u.total.toString()}]);c(h,v)}).on("mousemove",function(h,u){const g=u.date.toLocaleString(d==="fr"?"fr-FR":"en-US",{month:"long"}),p=u.date.getFullYear(),v=wn(`${g} ${p}`,[{label:(s==null?void 0:s.totalItems)||"Total Items",value:a?a(u.total):u.total.toString()}]);c(h,v)}).on("mouseleave",function(){dt(this).transition().duration(200).attr("r",o?3:4),l()})}}var py=$t("<option> </option>"),my=$t("<option> </option>"),vy=$t("<span> </span>"),yy=$t('<div class="absolute inset-center text-error">Store not available</div>'),_y=$t('<div class="absolute inset-center text-secondary"><div class="loading-spinner mr-sm svelte-1dm70g2"></div> <span> </span></div>'),xy=$t('<div class="absolute inset-center text-error"> </div>'),by=$t('<div class="absolute inset-center text-secondary"><div class="loading-spinner mr-sm svelte-1dm70g2"></div> <span>Initializing visualization...</span></div>'),wy=$t('<div class="absolute inset-center text-secondary"> </div>'),Ty=$t('<li class="flex justify-between mb-xs text-sm"><span class="text-primary"> </span> <span class="text-secondary font-medium"> </span></li>'),$y=$t('<div class="p-md stat-summary"><h3 class="mt-0 mb-sm text-md text-primary border-b border-solid border-default pb-xs"> </h3> <p class="text-sm mb-xs"> <strong class="font-medium"> </strong></p> <p class="text-sm mb-xs"> <strong class="font-medium"> </strong></p> <p class="text-sm"> <strong class="font-medium"> </strong></p></div> <div class="p-md peak-months"><h3 class="mt-0 mb-sm text-md text-primary border-b border-solid border-default pb-xs"> </h3> <ul class="list-style-none p-0 m-0"></ul></div>',1),Cy=$t('<div class="p-md col-span-2 text-center text-secondary"> </div>'),ky=$t('<div class="flex flex-wrap gap-md p-md bg-card rounded-t border-b border-solid border-default filters svelte-1dm70g2"><div class="flex flex-col gap-xs filter-group svelte-1dm70g2"><label for="country-filter" class="text-xs font-bold text-secondary"> </label> <select id="country-filter" class="p-xs px-sm rounded-sm border border-solid border-default bg-card text-primary text-sm"></select></div> <div class="flex flex-col gap-xs filter-group svelte-1dm70g2"><label for="type-filter" class="text-xs font-bold text-secondary"> </label> <select id="type-filter" class="p-xs px-sm rounded-sm border border-solid border-default bg-card text-primary text-sm"></select></div> <div class="ml-auto self-end text-sm text-secondary summary svelte-1dm70g2"><!></div></div> <div class="flex-1 relative min-h-500 bg-card rounded-b p-md chart-container overflow-hidden svelte-1dm70g2" style="height: 500px;"><!></div> <div class="grid grid-cols-2 gap-md p-md bg-card rounded shadow mt-md stats svelte-1dm70g2"><!></div>',1),zy=$t('<div class="w-full h-full flex flex-col gap-md"><!></div>');function My(t,e){ke(e,!1);const[n,r]=on(),i=()=>xt(xe,"$languageStore",n),o=()=>xt(fe,"$itemsStore",n),a=()=>xt(vt,"$monthlyAdditionsText",n),s=()=>xt(H,"$totalItemsText",n),d=()=>xt(Mt,"$newItemsText",n),c=()=>xt(Wt,"$percentageText",n),l=()=>xt(Dt,"$monthText",n),h=()=>xt(O,"$filterByCountryText",n),u=()=>xt(A,"$filterByTypeText",n),g=()=>xt(Z,"$showingItemsOverMonthsText",n),p=()=>xt(w,"$noDataText",n),v=()=>xt(M,"$summaryText",n),y=()=>xt(Q,"$timePeriodText",n),m=()=>xt(pt,"$avgMonthlyAdditionsText",n),$=()=>xt(ft,"$peakGrowthMonthsText",n),C=()=>xt(it,"$itemsText",n),T="viz.growth_since_april_description";let x=bt("all"),_=bt("all"),z=bt([]),N=bt([]),U=bt([]),b=bt(0),I=0,S=0,R=0,W="en",X=bt(""),k=bt(0),F=bt(0),q=bt(),ct;const{showTooltip:B,hideTooltip:P}=Ao({defaultWidth:200,defaultHeight:100});let j=bt();const{filterItems:J,processTimeData:K}=Oe({filterMissingValues:!0,requiredFields:["created_date"],calculatePercentages:!0,sortByCount:!0,sortDescending:!0,filterFn:V=>!(V.type==="Notice d'autorité"||f(x)!=="all"&&V.country!==f(x)||f(_)!=="all"&&V.type!==f(_))}),tt=Oe({filterMissingValues:!0,requiredFields:["created_date"],filterFn:V=>{if(V.type==="Notice d'autorité"||!V.created_date)return!1;const et=new Date(V.created_date);return isNaN(et.getTime())||et<new Date(2024,3,1)?!1:f(_)==="all"||V.type===f(_)}}),ut=Oe({filterMissingValues:!0,requiredFields:["created_date"],filterFn:V=>{if(V.type==="Notice d'autorité"||!V.created_date)return!1;const et=new Date(V.created_date);return isNaN(et.getTime())||et<new Date(2024,3,1)?!1:f(x)==="all"||V.country===f(x)}});let at,Y=bt(!1),E=bt(!1);Un("%Y-%m"),Un("%b %Y");const O=rt("viz.filter_by_country"),A=rt("viz.filter_by_type"),w=rt("viz.no_data"),M=rt("viz.summary"),H=rt("viz.total_items"),Q=rt("viz.time_period"),pt=rt("viz.avg_monthly_additions"),ft=rt("viz.peak_growth_months"),Z=rt("viz.showing_items_over_months"),it=rt("viz.items");rt("viz.timeline_distribution_items");const vt=rt("viz.monthly_additions"),Dt=rt("viz.month");rt("viz.growth_since_april");const Mt=rt("viz.new_items"),Wt=rt("viz.percentage");function Ut(V){return V.toLocaleString(W==="fr"?"fr-FR":"en-US")}function Lt(){if(I>0){const V=Ut(I);return ot("viz.items_added_since_april",{0:V})}else return ot("viz.items_added_since_april_title")}function G(){console.log("[TimelineDistribution] Updating title with count:",f(b)),D(X,Lt())}let yt=null;function st(){yt&&clearTimeout(yt),yt=setTimeout(()=>{Tt(),yt=null},250)}Ye(()=>(D(Y,!0),console.log("[TimelineDistribution] Component mounted"),(async()=>{var V;try{if(await kn(),!f(q)){console.error("[TimelineDistribution] Container element not found in onMount");return}console.log("[TimelineDistribution] Container element found:",f(q)),D(j,Dr({container:f(q),onResize:()=>{if(f(Y)&&f(E)&&f(q)){const{width:Ct,height:gt}=f(j).dimensions,Vt=Math.abs(f(k)-Ct)>5,Rt=Math.abs(f(F)-gt)>5;(Vt||Rt)&&(console.log("[TimelineDistribution] Size changed, updating visualization",{newWidth:Ct,newHeight:gt}),D(k,Ct),D(F,gt),st())}}}));const{width:et,height:wt}=f(j).dimensions;if(D(k,et),D(F,wt||500),console.log("[TimelineDistribution] Initial dimensions:",{width:f(k),height:f(F)}),at=xe.subscribe(Ct=>{f(Y)&&(console.log("[TimelineDistribution] Language changed to:",Ct),W=Ct,G(),f(E)&&f(q)&&st())}),!o().items||o().items.length===0){console.log("[TimelineDistribution] No items loaded, loading items");try{await fe.loadItems(),console.log("[TimelineDistribution] Items loaded:",(V=o().items)==null?void 0:V.length)}catch(Ct){console.error("[TimelineDistribution] Error loading items:",Ct)}}else console.log("[TimelineDistribution] Items already loaded:",o().items.length);Gt(),D(E,!0),await kn(),f(q)?(ht(),Tt(),console.log("[TimelineDistribution] Visualization initialized")):console.error("[TimelineDistribution] Container not available after initialization")}catch(et){console.error("[TimelineDistribution] Error during initialization:",et)}})(),()=>{try{console.log("[TimelineDistribution] Component unmounting, cleaning up"),D(Y,!1),D(E,!1),f(j)&&f(j).cleanup(),at&&at(),yt&&(clearTimeout(yt),yt=null),f(q)&&dt(f(q)).selectAll("*").remove()}catch(V){console.error("[TimelineDistribution] Error during cleanup:",V)}}));function ht(){try{console.log("[TimelineDistribution] Initializing timeline chart with dimensions:",{width:f(k),height:f(F)}),console.log("[TimelineDistribution] Container element:",f(q)),dt(f(q)).selectAll("*").remove(),ct=new rl({container:f(q),width:f(k),height:f(F),formatNumber:Ut,currentLang:W,translations:{monthlyAdditions:a(),totalItems:s(),newItems:d(),percentage:c(),month:l()}}),ct.setTooltipCallbacks({showTooltip:B,hideTooltip:P}),console.log("[TimelineDistribution] Timeline chart initialized")}catch(V){console.error("[TimelineDistribution] Error initializing timeline chart:",V)}}function Tt(){try{if(!f(q)||!f(Y)||!f(E)){console.error("[TimelineDistribution] Cannot update visualization - component not ready",{container:!!f(q),isMounted:f(Y),isInitialized:f(E)});return}console.log("[TimelineDistribution] Updating visualization with dimensions:",{width:f(k),height:f(F)}),f(F)<=0&&(D(F,500),console.log("[TimelineDistribution] Using fallback height of 500px"));const V=Kt();if(!V||V.length===0){console.warn("[TimelineDistribution] No timeline data available with current filters"),dt(f(q)).selectAll("*").remove(),dt(f(q)).append("div").attr("class","absolute inset-center text-secondary").text("No timeline data available with the current filters");return}D(z,V),console.log("[TimelineDistribution] Timeline data updated with",f(z).length,"data points"),dt(f(q)).selectAll("*").remove(),ct=new rl({container:f(q),width:f(k),height:f(F),formatNumber:Ut,currentLang:W,translations:{monthlyAdditions:a(),totalItems:s(),newItems:d(),percentage:c(),month:l()}}),ct.setTooltipCallbacks({showTooltip:B,hideTooltip:P}),ct.render(V),console.log("[TimelineDistribution] Chart rendered with",V.length,"data points"),G()}catch(V){if(console.error("[TimelineDistribution] Error updating visualization:",V),f(q))try{dt(f(q)).selectAll("*").remove(),dt(f(q)).append("div").attr("class","absolute inset-center text-error").text("Error rendering timeline visualization")}catch(et){console.error("[TimelineDistribution] Error showing error message:",et)}}}function St(V){const et=V.target;D(x,et.value),Gt(),st()}function Bt(V){const et=V.target;D(_,et.value),Gt(),st()}function Kt(){var V;if(!o().items||o().items.length===0)return console.warn("[TimelineDistribution] No items available for timeline data"),[];console.log("[TimelineDistribution] Processing data with filters:",{country:f(x),type:f(_)}),console.log("[TimelineDistribution] Total items before filtering:",o().items.length);try{const et=new Date(2024,3,1),wt=8874;o().items.length>0&&console.log("[TimelineDistribution] Sample created_date values:",o().items.slice(0,5).map(Vt=>Vt.created_date));const Ct=J(o().items);console.log("[TimelineDistribution] Items after filtering:",Ct.length);const gt=K(Ct,"created_date",{startDate:et,includeCumulative:!0,initialTotal:wt});return console.log("[TimelineDistribution] Processed timeline data length:",gt.length),gt.length>0&&console.log("[TimelineDistribution] First and last data points:",gt[0],gt[gt.length-1]),gt.length===0?(console.warn("[TimelineDistribution] No timeline data generated after processing"),[]):(D(b,((V=gt[gt.length-1])==null?void 0:V.total)||wt),I=f(b)-wt,S=Math.max(...gt.map(Vt=>Vt.count)),R=Math.max(...gt.map(Vt=>Vt.total)),gt)}catch(et){return console.error("[TimelineDistribution] Error processing timeline data:",et),[]}}function Gt(){if(!o().items||o().items.length===0)return;console.log("[TimelineDistribution] Generating facet options with filters:",{country:f(x),type:f(_)});const V=tt.filterItems(o().items),et=ut.filterItems(o().items);console.log("[TimelineDistribution] Items for country facets:",V.length),console.log("[TimelineDistribution] Items for type facets:",et.length);const wt=tt.groupAndCount(V,gt=>gt.country||"Unknown",V.length);D(N,[{value:"all",label:ot("country.all"),count:V.length},...wt.filter(gt=>gt.key!=="Unknown").map(gt=>({value:gt.key,label:ot(`country.${gt.key}`),count:gt.count})).sort((gt,Vt)=>Vt.count-gt.count)]);const Ct=ut.groupAndCount(et,gt=>gt.type||"Unknown",et.length);D(U,[{value:"all",label:ot("type.all"),count:et.length},...Ct.filter(gt=>gt.key!=="Unknown"&&gt.count>0).map(gt=>({value:gt.key,label:ot(`type.${gt.key}`),count:gt.count})).sort((gt,Vt)=>Vt.count-gt.count)]),console.log("[TimelineDistribution] Updated facet options:",{countryOptions:f(N).length,typeOptions:f(U).length})}pe(()=>i(),()=>{i(),G()}),pe(()=>(f(Y),f(E),o(),f(q),f(j),f(k),f(F)),()=>{f(Y)&&f(E)&&o().items&&f(q)&&f(j)&&(f(k)!==f(j).dimensions.width||f(F)!==f(j).dimensions.height)&&(D(k,f(j).dimensions.width),D(F,f(j).dimensions.height),Tt())}),pe(()=>(f(Y),i(),o()),()=>{f(Y)&&i()&&o().items&&o().items.length>0&&Gt()}),pe(()=>(f(E),f(x),f(_)),()=>{f(E)&&(f(x)||f(_))&&st()}),hi(),Ue();var Et=zy(),Ft=L(Et);Nr(Ft,{title:"Growth of the Database",get titleHtml(){return f(X)},descriptionTranslationKey:T,theme:"default",className:"timeline-visualization",children:(V,et)=>{var wt=ky(),Ct=jt(wt),gt=L(Ct),Vt=L(gt),Rt=L(Vt),kt=_t(Vt,2);Go(kt,()=>f(x));var Pt;Hn(kt,5,()=>f(N),mr,(Zt,Qt)=>{var le=py(),Se={},Ee=L(le);It(ce=>{Se!==(Se=f(Qt).value)&&(le.value=(le.__value=f(Qt).value)==null?"":f(Qt).value),lt(Ee,`${f(Qt).label??""} (${ce??""})`)},[()=>Ut(f(Qt).count)],ie),nt(Zt,le)});var zt=_t(gt,2),mt=L(zt),Nt=L(mt),qt=_t(mt,2);Go(qt,()=>f(_));var he;Hn(qt,5,()=>f(U),mr,(Zt,Qt)=>{var le=my(),Se={},Ee=L(le);It(ce=>{Se!==(Se=f(Qt).value)&&(le.value=(le.__value=f(Qt).value)==null?"":f(Qt).value),lt(Ee,`${f(Qt).label??""} (${ce??""})`)},[()=>Ut(f(Qt).count)],ie),nt(Zt,le)});var be=_t(zt,2),Me=L(be);{var je=Zt=>{var Qt=vy(),le=L(Qt);It(Se=>lt(le,Se),[()=>g().replace("{0}",Ut(f(b))).replace("{1}",f(z).length.toString())],ie),nt(Zt,Qt)};Ot(Me,Zt=>{f(z)&&f(z).length>0&&Zt(je)})}var Ae=_t(Ct,2),Ge=L(Ae);{var At=Zt=>{var Qt=yy();nt(Zt,Qt)},Ht=Zt=>{var Qt=se(),le=jt(Qt);{var Se=ce=>{var Ke=_y(),Bn=_t(L(Ke),2),On=L(Bn);It(He=>lt(On,He),[()=>ot("ui.loading")],ie),nt(ce,Ke)},Ee=ce=>{var Ke=se(),Bn=jt(Ke);{var On=Ie=>{var mn=xy(),Vn=L(mn);It(()=>lt(Vn,o().error)),nt(Ie,mn)},He=Ie=>{var mn=se(),Vn=jt(mn);{var Wn=sn=>{var Ln=by();nt(sn,Ln)},qn=sn=>{var Ln=se(),Fr=jt(Ln);{var Nn=Rr=>{var vi=wy(),Yn=L(vi);It(()=>lt(Yn,p())),nt(Rr,vi)};Ot(Fr,Rr=>{(!f(z)||f(z).length===0)&&Rr(Nn)},!0)}nt(sn,Ln)};Ot(Vn,sn=>{f(E)?sn(qn,!1):sn(Wn)},!0)}nt(Ie,mn)};Ot(Bn,Ie=>{o().error?Ie(On):Ie(He,!1)},!0)}nt(ce,Ke)};Ot(le,ce=>{o().loading?ce(Se):ce(Ee,!1)},!0)}nt(Zt,Qt)};Ot(Ge,Zt=>{o()?Zt(Ht,!1):Zt(At)})}We(Ae,Zt=>D(q,Zt),()=>f(q));var Xt=_t(Ae,2),ge=L(Xt);{var ae=Zt=>{var Qt=$y(),le=jt(Qt),Se=L(le),Ee=L(Se),ce=_t(Se,2),Ke=L(ce),Bn=_t(Ke),On=L(Bn),He=_t(ce,2),Ie=L(He),mn=_t(Ie),Vn=L(mn),Wn=_t(He,2),qn=L(Wn),sn=_t(qn),Ln=L(sn),Fr=_t(le,2),Nn=L(Fr),Rr=L(Nn),vi=_t(Nn,2);Hn(vi,5,()=>[...f(z)].sort((Yn,Gn)=>Gn.count-Yn.count).slice(0,3),mr,(Yn,Gn)=>{var Pr=Ty(),Ur=L(Pr),Hc=L(Ur),Bc=_t(Ur,2),Oc=L(Bc);It((Vc,Wc)=>{lt(Hc,f(Gn).monthFormatted),lt(Oc,`${Vc??""} ${C()??""} (${Wc??""}%)`)},[()=>Ut(f(Gn).count),()=>(f(Gn).count/(f(b)||1)*100).toFixed(1)],ie),nt(Yn,Pr)}),It((Yn,Gn)=>{var Pr,Ur;lt(Ee,v()),lt(Ke,`${s()??""}: `),lt(On,Yn),lt(Ie,`${y()??""}: `),lt(Vn,`${((Pr=f(z)[0])==null?void 0:Pr.monthFormatted)||""} to ${((Ur=f(z)[f(z).length-1])==null?void 0:Ur.monthFormatted)||""}`),lt(qn,`${m()??""}: `),lt(Ln,Gn),lt(Rr,$())},[()=>Ut(f(b)),()=>Ut(Math.round(f(b)/(f(z).length||1)))],ie),nt(Zt,Qt)},ve=Zt=>{var Qt=Cy(),le=L(Qt);It(()=>lt(le,p())),nt(Zt,Qt)};Ot(ge,Zt=>{f(z)&&f(z).length>0?Zt(ae):Zt(ve,!1)})}It(()=>{lt(Rt,`${h()??""}:`),Pt!==(Pt=f(x))&&(kt.value=(kt.__value=f(x))==null?"":f(x),oi(kt,f(x))),lt(Nt,`${u()??""}:`),he!==(he=f(_))&&(qt.value=(qt.__value=f(_))==null?"":f(_),oi(qt,f(_)))}),_e("change",kt,St),_e("change",qt,Bt),nt(V,wt)},$$slots:{default:!0}}),nt(t,Et),ze(),r()}const _r=[],Ay=1e3;function Sy(){return new Date().toISOString()}function re(t,e,n){const i={timestamp:Sy(),component:t,action:e,details:n};_r.push(i),_r.length>Ay&&_r.shift()}const Ey=new Set,Iy={};function Ly(){console.group("IWAC Debug Logs"),_r.forEach(t=>{console.groupCollapsed(`${t.timestamp} - ${t.component} - ${t.action}`),console.log("Component:",t.component),console.log("Action:",t.action),t.details&&console.log("Details:",t.details),console.groupEnd()}),console.groupEnd()}function Ny(){return JSON.stringify(_r,null,2)}typeof window<"u"&&(window.__IWAC_DEBUG={logs:_r,dumpLogs:Ly,exportLogs:Ny,mountedComponents:()=>Array.from(Ey),hierarchy:Iy});var Dy=ba('<svg viewBox="0 0 24 24" width="14" height="14"><path fill="currentColor" d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"></path></svg>'),Fy=$t('<div class="facet-option svelte-1uu7ity" role="checkbox" tabindex="0"><span class="facet-checkbox svelte-1uu7ity"><!></span> <span class="facet-label svelte-1uu7ity"> </span> <span class="facet-count svelte-1uu7ity"> </span></div>'),Ry=$t('<div class="absolute inset-center text-secondary z-50"> </div>'),Py=$t('<div class="absolute inset-center text-error z-50"> </div>'),Uy=$t('<div class="type-distribution-container svelte-1uu7ity"><div class="controls-container svelte-1uu7ity"><div class="facets svelte-1uu7ity"><div class="facet-group svelte-1uu7ity"><h3 class="svelte-1uu7ity"> </h3> <div class="facet-options table-layout svelte-1uu7ity"></div></div></div> <div class="year-range svelte-1uu7ity"><h3 class="svelte-1uu7ity"> </h3> <div class="slider-container svelte-1uu7ity"><div class="slider-labels svelte-1uu7ity"><span> </span> <span> </span></div> <div class="slider-inputs svelte-1uu7ity"><input type="range" data-index="0" class="svelte-1uu7ity"> <input type="range" data-index="1" class="svelte-1uu7ity"></div></div></div></div> <div class="chart-container svelte-1uu7ity"><!></div></div>');function Hy(t,e){ke(e,!1);const[n,r]=on(),i=()=>xt(fe,"$itemsStore",n),o=()=>xt(W,"$noDataText",n),a=()=>xt(X,"$yearText",n),s=()=>xt(k,"$numberOfItemsText",n),d=()=>xt(F,"$toggleTypesText",n),c=()=>xt(q,"$countriesText",n),l=()=>xt(ct,"$yearRangeText",n),h="TypeDistribution";let u=!1,g,p,v="en",y,m=bt(),$=0,C=0,T=bt([]),x=bt([]),_=bt([0,0]),z=[],N=0,U=[];const{showTooltip:b,hideTooltip:I}=Ao({defaultWidth:250,defaultHeight:150});let S;const{groupHierarchically:R}=Oe({filterMissingValues:!0,requiredFields:["publication_date","type"],calculatePercentages:!0,sortByCount:!0,sortDescending:!0}),W=rt("viz.no_data");rt("viz.filter_by_country"),rt("viz.all_countries"),rt("viz.publication_year");const X=rt("viz.year"),k=rt("viz.number_of_items"),F=rt("viz.toggle_types");rt("viz.toggled_type");const q=rt("viz.countries"),ct=rt("viz.time_period");rt("viz.summary"),rt("viz.showing_items_over_months"),rt("viz.types"),rt("viz.published_between");let B=bt("");function P(A){return A.toLocaleString(v==="fr"?"fr-FR":"en-US")}function j(){if(N>0){const A=N.toLocaleString();D(B,ot("viz.type_distribution_items",{0:A}))}else D(B,ot("viz.type_distribution_title"));console.log("Type Distribution Title updated:",f(B))}function J(A){return A?/^\d{4}$/.test(A)?parseInt(A):/^\d{4}-\d{2}$/.test(A)||/^\d{4}-\d{2}-\d{2}$/.test(A)?parseInt(A.substring(0,4)):null:null}function K(){var Z;if(!u||!i().items||i().items.length===0)return[];const A=f(T).filter(it=>it.selected).map(it=>it.value),w=A.includes("all"),M=it=>{if(it.type==="Notice d'autorité")return!1;const vt=J(it.publication_date);return!(!vt||vt<f(_)[0]||vt>f(_)[1]||!it.country||it.country.trim()===""||it.country==="Unknown"||!w&&!A.includes(it.country))},{filterItems:H}=Oe({filterMissingValues:!0,requiredFields:["publication_date","type"],filterFn:M}),Q=H(i().items);N=Q.length,j();const pt=R(Q,[it=>{var vt;return((vt=J(it.publication_date))==null?void 0:vt.toString())||"Unknown"},it=>it.type||"Unknown"]),ft=[];return(Z=pt.children)==null||Z.forEach(it=>{var Dt;const vt=parseInt(it.name);(Dt=it.children)==null||Dt.forEach(Mt=>{ft.push({year:vt,type:Mt.name,count:Mt.value})})}),ft}function tt(){var ft;if(!u||!i().items||i().items.length===0)return;const A=Z=>{if(Z.type==="Notice d'autorité")return!1;const it=J(Z.publication_date);return it!==null&&it>=f(_)[0]&&it<=f(_)[1]},{filterItems:w,groupAndCount:M}=Oe({filterMissingValues:!0,requiredFields:["publication_date"],filterFn:A}),H=w(i().items),Q=M(H,Z=>Z.country||"Unknown"),pt=H.filter(Z=>Z.country&&Z.country.trim()!==""&&Z.country!=="Unknown").length;D(T,[{value:"all",label:ot("country.all"),count:pt,selected:((ft=f(T).find(Z=>Z.value==="all"))==null?void 0:ft.selected)??!0},...Q.filter(Z=>Z.key!=="Unknown").map(Z=>{var it;return{value:Z.key,label:ot(`country.${Z.key}`)||Z.key,count:Z.count,selected:((it=f(T).find(vt=>vt.value===Z.key))==null?void 0:it.selected)??!1}})]),f(T).sort((Z,it)=>Z.value==="all"?-1:it.value==="all"?1:Z.label.localeCompare(it.label))}function ut(){if(!u||!i().items||i().items.length===0)return;const A=i().items.filter(H=>H.type!=="Notice d'autorité").map(H=>J(H.publication_date)).filter(H=>H!==null);if(A.length===0)return;const w=Math.min(...A),M=Math.max(...A);D(x,Array.from({length:M-w+1},(H,Q)=>w+Q)),(f(_)[0]===0||f(_)[1]===0)&&D(_,[w,M])}function at(A){u&&(A.value==="all"?f(T).forEach(w=>{w.selected=w.value==="all"}):(f(T).find(w=>w.value==="all").selected=!1,A.selected=!A.selected,f(T).some(w=>w.selected)||(f(T).find(w=>w.value==="all").selected=!0)),D(T,[...f(T)]),E())}function Y(A){const w=A.target,M=parseInt(w.dataset.index||"0"),H=parseInt(w.value);M===0?D(_,[H,Math.max(H,f(_)[1])]):D(_,[Math.min(H,f(_)[0]),H]),tt(),E()}function E(){if(!u||!f(m)||!document.body.contains(f(m))){console.error("Cannot update visualization - component not mounted or container not found");return}try{if(z=K(),dt(f(m)).select("svg").remove(),dt(f(m)).selectAll(".absolute.inset-center").remove(),y&&(y.cleanup(),y=null),z.length===0){dt(f(m)).append("div").attr("class","absolute inset-center text-secondary z-50").text(o());return}if(!u||!document.body.contains(f(m)))return;const A=f(m).getBoundingClientRect();if($=A.width,C=Math.max(400,A.height-100),!u||!document.body.contains(f(m)))return;const w=Array.from(new Set(z.map(G=>G.type))),M={top:20,right:30,bottom:70,left:60},H=$-M.left-M.right;if(w.sort((G,yt)=>{const st=ot(`type.${G}`)!==`type.${G}`?ot(`type.${G}`):G,ht=ot(`type.${yt}`)!==`type.${yt}`?ot(`type.${yt}`):yt;return st.localeCompare(ht)}),!u||!document.body.contains(f(m)))return;if(U.length===0)U=w.map(G=>({type:G,visible:!0}));else{const G=U.map(yt=>yt.type);w.forEach(yt=>{G.includes(yt)||U.push({type:yt,visible:!0})})}const Q=w.filter(G=>{var yt;return((yt=U.find(st=>st.type===G))==null?void 0:yt.visible)??!0}),pt=C-M.top-M.bottom;if(!u||!document.body.contains(f(m)))return;if(Q.length===0){dt(f(m)).selectAll(".absolute.inset-center").remove(),dt(f(m)).append("div").attr("class","absolute inset-center text-secondary z-50").text(o());return}const ft=dt(f(m)).append("svg").attr("width",$).attr("height",C),Z=ft.append("g").attr("transform",`translate(${M.left}, ${M.top})`),it=Array.from(ka(z.filter(G=>{var yt;return((yt=U.find(st=>st.type===G.type))==null?void 0:yt.visible)??!0}),G=>G.year),([G,yt])=>{const st={year:G};return yt.forEach(ht=>{st[ht.type]=ht.count}),st}).sort((G,yt)=>G.year-yt.year);if(it.length===0){dt(f(m)).selectAll(".absolute.inset-center").remove(),dt(f(m)).append("div").attr("class","absolute inset-center text-secondary z-50").text(o());return}const vt=Fa().domain(it.map(G=>G.year.toString())).range([0,H]).padding(.1),Dt=f0().keys(Q).value((G,yt)=>G[yt]||0)(it),Mt=ui().domain([0,br(Dt.length>0?Dt[Dt.length-1]:[],G=>G[1])||0]).range([pt,0]);if(!u||!document.body.contains(f(m)))return;const Wt=["Press Article","Journal Article","Book Chapter","Doctoral Thesis","type.Article d'encyclopédie","type.Mémoire de maitrise","Book","type.Compte rendu de livre","type.Rapport","type.Working paper","type.Mémoire de licence","Islamic Periodical","Document","type.Photographie","Blog Post","Scientific Communication","type.Enregistrement vidéo","Article de presse","Article de revue","Chapitre de livre","Thèse de doctorat","Article d'encyclopédie","Mémoire de maitrise","Livre","Compte rendu de livre","Rapport","Working paper","Mémoire de licence","Périodique islamique","Document","Photographie","Article de blog","Communication scientifique","Enregistrement vidéo"],Ut=Ce().domain(Wt).range(rn);if(Z.append("g").attr("transform",`translate(0, ${pt})`).call(qi(vt).tickValues(it.filter(G=>G.year%5===0).map(G=>G.year.toString())).tickSizeOuter(0)).selectAll("text").attr("text-anchor","end").attr("dx","-.8em").attr("dy",".15em").attr("transform","rotate(-45)").attr("class","text-xs text-primary"),!u||!document.body.contains(f(m))||(Z.append("g").call(Yi(Mt).ticks(5)).selectAll("text").attr("class","text-xs text-primary"),Z.append("text").attr("text-anchor","middle").attr("x",H/2).attr("y",pt+40).attr("fill","var(--color-text-secondary)").attr("class","text-sm text-secondary").text(a()),Z.append("text").attr("text-anchor","middle").attr("transform","rotate(-90)").attr("x",-pt/2).attr("y",-M.left+15).attr("fill","var(--color-text-secondary)").attr("class","text-sm text-secondary").text(s()),!u||!document.body.contains(f(m)))||(Z.selectAll(".type-bars").data(Dt).enter().append("g").attr("class","type-bars").attr("fill",G=>Ut(G.key)).selectAll("rect").data(G=>G).enter().append("rect").attr("x",G=>vt(G.data.year.toString())||0).attr("y",G=>Mt(G[1])).attr("height",G=>Mt(G[0])-Mt(G[1])).attr("width",vt.bandwidth()).attr("stroke","white").attr("stroke-width",1).on("mouseenter",(G,yt)=>{if(u){const st=O(yt,Dt);b(G,st)}}).on("mousemove",(G,yt)=>{if(u){const st=O(yt,Dt);b(G,st)}}).on("mouseleave",()=>{u&&I()}),!u||!document.body.contains(f(m))))return;const Lt=w.map(G=>{const yt=z.filter(st=>st.type===G).reduce((st,ht)=>st+ht.count,0);return{type:G,count:yt}}).sort((G,yt)=>yt.count-G.count);y=Uc({container:f(m),title:d(),items:Lt.map(G=>{var yt;return{key:G.type,label:ot(`type.${G.type}`)!==`type.${G.type}`?ot(`type.${G.type}`):G.type,color:Ut(G.type),value:G.count,visible:((yt=U.find(st=>st.type===G.type))==null?void 0:yt.visible)??!0,customProperties:{type:G.type}}}),type:"html",position:"bottom",orientation:"horizontal",className:"multi-row-legend",showValues:!0,valueFormatter:G=>P(G),translateKeys:{itemPrefix:"type."},responsive:!0,breakpoint:768,interactive:!0,onItemClick:G=>{if(!u)return;const yt=U.findIndex(st=>{var ht;return st.type===((ht=G.customProperties)==null?void 0:ht.type)});yt>=0&&(U[yt].visible=!U[yt].visible,U=[...U],E())}}),y.render(),ft.attr("height",C)}catch(A){console.error("Error updating visualization:",A)}}function O(A,w){const M=A.data.year,H=w.map(ft=>{const Z=ft.find(it=>it.data.year===M);return{type:ft.key,count:Z?Z[1]-Z[0]:0}}).filter(ft=>ft.count>0),Q=H.reduce((ft,Z)=>ft+Z.count,0),pt=[{label:ot("viz.type"),value:ot("viz.count")+" / %"}];return H.forEach(ft=>{const Z=`type.${ft.type}`;let it=ft.type;const vt=ot(Z);vt!==Z&&(it=vt),pt.push({label:it,value:`${P(ft.count)} (${(ft.count/Q*100).toFixed(1)}%)`})}),pt.push({label:ot("viz.total_items"),value:P(Q)}),wn(`${ot("viz.year")}: ${M}`,pt)}Ye(()=>(u=!0,(async()=>{try{if(await kn(),!f(m)){console.error("Container element not found in onMount");return}S=Dr({container:f(m),onResize:()=>{if(u&&f(m)){const{width:A,height:w}=S.dimensions;$=A,C=w,E()}}}),p=xe.subscribe(A=>{u&&(v=A,f(m)&&(j(),console.log("Language changed to",A,"- updating legend with",d()),i().items&&i().items.length>0&&(y&&(y.cleanup(),y=null),tt(),E())))}),g=fe.subscribe(A=>{u&&A!=null&&A.items&&A.items.length>0&&(ut(),tt(),j(),f(m)&&E())}),i().items&&i().items.length>0?(ut(),tt(),j(),E()):fe.loadItems()}catch(A){console.error("Error during initialization:",A)}})(),()=>{u=!1,S&&S.cleanup(),g&&(g(),g=null),p&&(p(),p=null),y&&(y.cleanup(),y=null),f(m)&&dt(f(m)).selectAll("*").remove()})),In(()=>{u=!1,g&&(g(),g=null),p&&(p(),p=null),y&&(y.cleanup(),y=null),re(h,"Component destroyed")}),Ue(),Nr(t,{title:"",translationKey:"",description:"This visualization shows the distribution of items by type over time. You can filter by country and year range to explore how different types of items have been published over time.",descriptionTranslationKey:"viz.type_distribution_description",get titleHtml(){return f(B)},className:"word-visualization-compact-header",children:(A,w)=>{var M=Uy(),H=L(M),Q=L(H),pt=L(Q),ft=L(pt),Z=L(ft),it=_t(ft,2);Hn(it,5,()=>f(T),mr,(Ft,V)=>{var et=Fy(),wt=L(et),Ct=L(wt);{var gt=zt=>{var mt=Dy();nt(zt,mt)};Ot(Ct,zt=>{f(V).selected&&zt(gt)})}var Vt=_t(wt,2),Rt=L(Vt),kt=_t(Vt,2),Pt=L(kt);It(()=>{ye(et,"aria-checked",f(V).selected),cf(et,"selected",f(V).selected),lt(Rt,f(V).label),lt(Pt,f(V).count)}),_e("click",et,()=>at(f(V))),_e("keydown",et,zt=>zt.key==="Enter"&&at(f(V))),nt(Ft,et)});var vt=_t(Q,2),Dt=L(vt),Mt=L(Dt),Wt=_t(Dt,2),Ut=L(Wt),Lt=L(Ut),G=L(Lt),yt=_t(Lt,2),st=L(yt),ht=_t(Ut,2),Tt=L(ht),St=_t(Tt,2),Bt=_t(H,2),Kt=L(Bt);{var Gt=Ft=>{var V=Ry(),et=L(V);It(wt=>lt(et,wt),[()=>ot("ui.loading")],ie),nt(Ft,V)},Et=Ft=>{var V=se(),et=jt(V);{var wt=Ct=>{var gt=Py(),Vt=L(gt);It(()=>lt(Vt,i().error)),nt(Ct,gt)};Ot(et,Ct=>{i().error&&Ct(wt)},!0)}nt(Ft,V)};Ot(Kt,Ft=>{i().loading?Ft(Gt):Ft(Et,!1)})}We(Bt,Ft=>D(m,Ft),()=>f(m)),It(()=>{lt(Z,c()),lt(Mt,l()),lt(G,f(_)[0]),lt(st,f(_)[1]),ye(Tt,"min",f(x)[0]),ye(Tt,"max",f(x)[f(x).length-1]),ts(Tt,f(_)[0]),ye(St,"min",f(x)[0]),ye(St,"max",f(x)[f(x).length-1]),ts(St,f(_)[1])}),_e("input",Tt,Y),_e("input",St,Y),nt(A,M)},$$slots:{default:!0}}),ze(),r()}class By{static createTreemap(e,n){try{const{container:r,width:i=r.clientWidth,height:o=Math.min(r.clientHeight,500),margin:a={top:10,right:10,bottom:10,left:10},padding:s={outer:3,top:16,inner:1},tooltipCallback:d,hideTooltipCallback:c,zoomCallback:l,currentZoomedNode:h=null,minSizeThreshold:u=.001,useBreadcrumbs:g=!1,rootName:p="All",labelOptions:v={parentLabel:{fontSize:"var(--font-size-sm)",fontWeight:"bold",color:"white"},childLabel:{fontSize:"var(--font-size-xs)",color:"var(--color-text-primary)",minWidth:30,minHeight:20}}}=n;if(dt(r).select("svg").remove(),dt(r).select(".absolute").remove(),!e.children||e.children.length===0)return ue.handleNoData(r),{svg:null,chart:null};r.style.height=`${o}px`,r.style.maxHeight=`${o}px`,r.style.overflow="hidden";const y={...a};h&&g&&(y.top+=30);const{svg:m,chart:$,chartWidth:C,chartHeight:T}=ue.createSVG({container:r,width:i,height:o,margin:y,responsive:!1});m.attr("height",o).attr("viewBox",`0 0 ${i} ${o}`).style("height",`${o}px`).style("max-height",`${o}px`).style("overflow","hidden").on("mouseout",U=>{var b;U.relatedTarget&&!((b=m.node())!=null&&b.contains(U.relatedTarget))&&c&&c()}),h&&(g?this.addBreadcrumbNavigation(m,a,h,p,l):this.addZoomOutButton(m,a,l));const x=Tc().size([C,T]).paddingOuter(s.outer||3).paddingTop(s.top||16).paddingInner(s.inner||1).round(!0);let _;if(h)_=this.prepareZoomedHierarchy(h);else if(_=un(e).sum(U=>U.value||0).sort((U,b)=>(b.value||0)-(U.value||0)),_.children&&u>0){const b=(_.value||0)*u;_.children=_.children.filter(I=>(I.value||0)>b)}try{x(_)}catch(U){return console.error("Error applying treemap layout:",U),ue.handleNoData(r,"Error rendering treemap"),{svg:null,chart:null}}const z=this.createColorScale(_,n);let N;return h&&n.colorMap&&(N=n.colorMap.get(h.data.name)),h?this.renderLeafNodes($,_.children||[],z,d,v,N,c):(this.renderParentNodes($,_.children||[],z,l,v),this.renderLeafNodes($,_.leaves(),z,d,v,void 0,c)),{svg:m,chart:$}}catch(r){return console.error("Error creating treemap:",r),ue.handleNoData(n.container,"Error creating treemap"),{svg:null,chart:null}}}static prepareZoomedHierarchy(e){if(e.data.children&&e.data.children.length>0){const n={name:e.data.name,children:e.data.children};return un(n).sum(r=>r.value||0).sort((r,i)=>(i.value||0)-(r.value||0))}else if(e.children&&e.children.length>0){const n=e.children.map(i=>({name:i.data.name,value:i.data.value||i.value,wordCount:i.data.wordCount,itemCount:i.data.itemCount})),r={name:e.data.name,children:n};return un(r).sum(i=>i.value||0).sort((i,o)=>(o.value||0)-(i.value||0))}else return console.warn("Zoomed node has no valid children data"),un({name:"Empty",children:[]}).sum(n=>n.value||0)}static createColorScale(e,n){if(n.colors)return n.colors;const r=Ce().domain(e.children?e.children.map(i=>i.data.name):[e.data.name]).range(rn);return n.colorMap&&e.children&&e.children.forEach(i=>{n.colorMap&&!n.colorMap.has(i.data.name)&&n.colorMap.set(i.data.name,r(i.data.name))}),r}static addZoomOutButton(e,n,r){if(!r)return;const i=e.append("g").attr("class","zoom-out-button cursor-pointer").attr("transform",`translate(${n.left}, ${n.top})`).on("click",()=>r(null));i.append("rect").attr("width",100).attr("height",24).attr("rx",4).attr("fill","var(--primary-color)").attr("opacity",.8),i.append("text").attr("x",50).attr("y",16).attr("text-anchor","middle").attr("fill","white").attr("font-size","var(--font-size-sm)").text("Back to All")}static addBreadcrumbNavigation(e,n,r,i,o){var h,u;if(!o)return;const a=30,s=((h=e.node())==null?void 0:h.getBoundingClientRect().width)||300;e.append("rect").attr("x",0).attr("y",0).attr("width",s).attr("height",a).attr("fill","white").attr("opacity",.9);const d=e.append("g").attr("class","breadcrumb-navigation").attr("transform",`translate(${n.left+10}, ${n.top+10})`),l=((u=d.append("text").attr("x",0).attr("y",5).attr("font-size","var(--font-size-sm)").attr("fill","var(--primary-color)").attr("class","cursor-pointer").text(i).on("click",()=>o(null)).node())==null?void 0:u.getComputedTextLength())||20;d.append("line").attr("x1",0).attr("y1",22).attr("x2",l).attr("y2",22).attr("stroke","var(--primary-color)").attr("stroke-width",1),d.append("text").attr("x",l+8).attr("y",5).attr("font-size","var(--font-size-sm)").attr("fill","var(--color-text-secondary)").text("/"),d.append("text").attr("x",l+20).attr("y",5).attr("font-size","var(--font-size-sm)").attr("font-weight","bold").attr("fill","var(--color-text-primary)").text(r.data.name)}static renderParentNodes(e,n,r,i,o){var s,d,c;const a=e.selectAll(".parent-node").data(n).enter().append("g").attr("class","parent-node").attr("transform",l=>{const h=l.x0||0,u=l.y0||0;return`translate(${h},${u})`});a.append("rect").attr("width",l=>{const h=l.x0||0,u=l.x1||0;return Math.max(0,u-h)}).attr("height",l=>{const h=l.y0||0,u=l.y1||0;return Math.max(0,u-h)}).attr("fill",l=>r(l.data.name)).attr("stroke","white").attr("stroke-width",2).attr("opacity",.7).attr("class","cursor-pointer").on("click",(l,h)=>{i&&i(h)}),a.append("text").attr("x",5).attr("y",15).attr("font-size",((s=o==null?void 0:o.parentLabel)==null?void 0:s.fontSize)||"var(--font-size-sm)").attr("font-weight",((d=o==null?void 0:o.parentLabel)==null?void 0:d.fontWeight)||"bold").attr("fill",((c=o==null?void 0:o.parentLabel)==null?void 0:c.color)||"white").text(l=>{var u;return l.x1-l.x0-10<150?l.data.name:`${l.data.name} (${((u=l.data.wordCount)==null?void 0:u.toLocaleString())||0})`}).attr("pointer-events","none").each(function(l){var p;const h=dt(this),u=this.getComputedTextLength(),g=l.x1-l.x0-10;if(u>g){let v=l.data.name;h.text(v);let y=this.getComputedTextLength(),m=!1;for(;y>g&&v.length>3;)v=v.slice(0,-1),h.text(v),y=this.getComputedTextLength(),m=!0;m&&h.text(v+"..."),h.append("title").text(`${l.data.name} (${((p=l.data.wordCount)==null?void 0:p.toLocaleString())||0})`)}})}static renderLeafNodes(e,n,r,i,o,a,s){var c,l;const d=e.selectAll(".leaf-node").data(n).enter().append("g").attr("class","leaf-node").attr("transform",h=>{const u=h.x0||0,g=h.y0||0;return`translate(${u},${g})`});d.append("rect").attr("width",h=>{const u=h.x0||0,g=h.x1||0;return Math.max(0,g-u)}).attr("height",h=>{const u=h.y0||0,g=h.y1||0;return Math.max(0,g-u)}).attr("fill",h=>a||(h.parent?r(h.parent.data.name):r(h.data.name))).attr("stroke","white").attr("stroke-width",.5).attr("class","cursor-pointer").on("mouseover",function(h,u){dt(this).attr("stroke","var(--primary-color)").attr("stroke-width",2),i&&i(h,u)}).on("mousemove",function(h,u){i&&i(h,u)}).on("mouseout",function(){dt(this).attr("stroke","white").attr("stroke-width",.5),s&&s()}),d.append("text").attr("x",3).attr("y",13).attr("font-size",((c=o==null?void 0:o.childLabel)==null?void 0:c.fontSize)||"var(--font-size-xs)").attr("fill",((l=o==null?void 0:o.childLabel)==null?void 0:l.color)||"var(--color-text-primary)").attr("pointer-events","none").each(function(h){var z,N,U,b;const u=dt(this),g=h.x1-h.x0,p=h.y1-h.y0,v=((z=o==null?void 0:o.childLabel)==null?void 0:z.minWidth)||30,y=((N=o==null?void 0:o.childLabel)==null?void 0:N.minHeight)||20;if(g<v||p<y)return;let m=h.data.name;const $=g-6,C=h.parent?h.parent.data.name:"";u.text(m).append("title").text(`${C} > ${h.data.name}: ${((U=h.data.wordCount)==null?void 0:U.toLocaleString())||0} (${h.data.itemCount||0} items)`);const T=this;let x=T.getComputedTextLength(),_=!1;for(;x>$&&m.length>3;)m=m.slice(0,-1),u.text(m),x=T.getComputedTextLength(),_=!0;_&&(u.text(m+"..."),u.append("title").text(`${C} > ${h.data.name}: ${((b=h.data.wordCount)==null?void 0:b.toLocaleString())||0} (${h.data.itemCount||0} items)`))})}}var Oy=$t('<div class="absolute inset-center text-secondary"> </div>'),Vy=$t('<div class="absolute inset-center text-error"> </div>'),Wy=$t('<p class="my-xs text-sm text-secondary"> <strong class="font-medium"> </strong></p>'),qy=$t('<p class="my-xs text-sm text-secondary"> <strong class="font-medium"> </strong></p> <p class="my-xs text-sm text-secondary"> </p>',1),Yy=$t('<p class="my-xs text-sm text-secondary"> </p>'),Gy=$t('<div class="flex-1 min-h-500 relative bg-card rounded shadow" style="height: 500px; max-height: 500px; overflow: hidden; position: relative;"><!></div> <div class="p-md bg-card rounded shadow mt-md"><div><h3 class="mt-0 mb-sm text-primary text-md font-medium border-b border-solid border-default pb-xs"> </h3> <p class="my-xs text-sm text-secondary"> <strong class="font-medium"> </strong></p> <p class="my-xs text-sm text-secondary"> <strong class="font-medium"> </strong></p> <!> <!></div></div>',1),Ky=$t('<div class="w-full h-full flex flex-col gap-md"><!></div>');function Xy(t,e){ke(e,!1);const[n,r]=on(),i=()=>xt(tt,"$wordsText",n),o=()=>xt(fe,"$itemsStore",n),a=()=>xt(ut,"$itemsText",n),s=()=>xt(ct,"$avgWordsPerItemText",n),d=()=>xt(at,"$percentOfCountryText",n),c=()=>xt(Y,"$percentOfTotalText",n),l=()=>xt(F,"$noDataText",n),h=()=>xt(K,"$summaryText",n),u=()=>xt(J,"$totalItemsWithWordCountText",n),g=()=>xt(q,"$totalWordsText",n),p=()=>xt(P,"$currentlyViewingText",n),v=()=>xt(j,"$clickBackText",n),y=()=>xt(B,"$clickZoomInText",n),m="WordDistributionRefactored";let $=!1,C,T=bt(),x=0,_=0,z=bt(0),N=bt(0),U={name:"root",children:[]},b=bt(null),I=bt(""),S="en",R=new Map;const{showTooltip:W,hideTooltip:X}=Ao({maxWidth:"250px"});let k;const F=rt("viz.no_data");rt("viz.word_distribution");const q=rt("viz.total_words"),ct=rt("viz.avg_words_per_item"),B=rt("viz.click_zoom_in");rt("viz.click_zoom_out"),rt("viz.unknown"),rt("viz.no_set"),rt("viz.back_to_all");const P=rt("viz.currently_viewing"),j=rt("viz.click_back_to_return"),J=rt("viz.total_items_with_word_count"),K=rt("viz.summary"),tt=rt("viz.words"),ut=rt("viz.items"),at=rt("viz.percent_of_country"),Y=rt("viz.percent_of_total");rt("viz.item_set_summary");const{filterItems:E}=Oe({filterMissingValues:!0,requiredFields:["word_count","country"],calculatePercentages:!0,sortByCount:!0,sortDescending:!0});function O(vt){return vt.toLocaleString(S==="fr"?"fr-FR":"en-US")}function A(){f(N)>0?S==="en"?D(I,`Distribution of ${O(f(z))} ${i()} by country and sub-collection`):D(I,`Répartition de ${O(f(z))} ${i()} par pays et sous-collection`):D(I,ot("viz.word_distribution"))}function w(){f(b)&&(S==="en"?D(I,`${f(b).data.name}: ${O(f(b).data.wordCount||0)} ${i()}`):D(I,`${f(b).data.name}: ${O(f(b).data.wordCount||0)} ${i()}`))}function M(){if(!o().items||o().items.length===0)return{name:"root",children:[]};const vt=Lt=>!(Lt.word_count===void 0||Lt.word_count===0||!Lt.country),{filterItems:Dt}=Oe({filterMissingValues:!0,requiredFields:["word_count","country"],filterFn:vt}),Mt=Dt(o().items);D(N,Mt.length),D(z,Mt.reduce((Lt,G)=>Lt+(G.word_count||0),0)),A();const Wt=new Map;Mt.forEach(Lt=>{const G=Lt.country||"Unknown",yt=Lt.item_set_title||"No Set",st=Lt.word_count||0;Wt.has(G)||Wt.set(G,{words:0,items:0,sets:new Map});const ht=Wt.get(G);ht.words+=st,ht.items+=1,ht.sets.has(yt)||ht.sets.set(yt,{words:0,items:0});const Tt=ht.sets.get(yt);Tt.words+=st,Tt.items+=1});const Ut={name:"Word Distribution",children:Array.from(Wt.entries()).map(([Lt,G])=>({name:Lt,wordCount:G.words,itemCount:G.items,children:Array.from(G.sets.entries()).map(([yt,st])=>({name:yt,value:st.words,wordCount:st.words,itemCount:st.items}))}))};return Ut.children&&(Ut.children.sort((Lt,G)=>(G.wordCount||0)-(Lt.wordCount||0)),Ut.children.forEach(Lt=>{Lt.children&&Lt.children.sort((G,yt)=>(yt.wordCount||0)-(G.wordCount||0))})),Ut}function H(vt){if(D(b,vt),f(b))D(N,f(b).data.itemCount||0),D(z,f(b).data.wordCount||0),w();else{if(o().items&&o().items.length>0){const Dt=E(o().items).filter(Mt=>Mt.word_count!==void 0&&Mt.word_count>0&&Mt.country);D(N,Dt.length),D(z,Dt.reduce((Mt,Wt)=>Mt+(Wt.word_count||0),0))}A()}pt()}function Q(vt,Dt){try{if(!vt){re(m,"Event object is undefined in handleShowTooltip");return}const Mt=Dt.parent?Dt.parent.data.name:Dt.data.name,Wt=Dt.parent?Dt.data.name:"All",Ut=Dt.data.wordCount||0,Lt=Dt.data.itemCount||0,G=Lt>0?Math.round(Ut/Lt):0,yt=f(b)?f(b).data.wordCount:Dt.parent?Dt.parent.data.wordCount:0,st=yt&&yt>0?(Ut/yt*100).toFixed(1)+"%":"N/A",ht=f(z)>0?(Ut/f(z)*100).toFixed(1)+"%":"N/A",Tt=wn(`${Mt} > ${Wt}`,[{label:i(),value:Ut.toLocaleString()},{label:a(),value:Lt},{label:s(),value:G},{label:d(),value:st},{label:c(),value:ht}]);W(vt,Tt,250,150),re(m,"Tooltip shown",{country:Mt,itemSet:Wt})}catch(Mt){console.error("Error showing tooltip:",Mt),re(m,"Error showing tooltip",Mt)}}function pt(){try{if(!f(T)){console.error("Container element not found");return}if(f(b)||(U=M()),!U.children||U.children.length===0){dt(f(T)).select("svg").remove(),dt(f(T)).append("div").attr("class","absolute inset-center text-secondary").text(l());return}By.createTreemap(U,{container:f(T),height:500,colorMap:R,tooltipCallback:Q,hideTooltipCallback:X,zoomCallback:H,currentZoomedNode:f(b),useBreadcrumbs:!0,rootName:S==="en"?"All":"Tous",labelOptions:{parentLabel:{fontSize:"var(--font-size-sm)",fontWeight:"bold",color:"white"},childLabel:{fontSize:"var(--font-size-xs)",color:"var(--color-text-primary)",minWidth:30,minHeight:20}}})}catch(vt){console.error("Error in updateVisualization:",vt)}}function ft(vt){!$||!f(T)||(re(m,"Items store changed",{itemCount:(vt==null?void 0:vt.length)||0}),document.body.contains(f(T))&&pt())}Ye(()=>{try{$=!0,re(m,"Component mounted");const Dt=(async()=>{if(await kn(),!f(T))return console.error("Container element not found in onMount"),()=>{};k=Dr({container:f(T),onResize:()=>{if($&&f(T)){const{width:Wt}=k.dimensions;x=Wt,_=500,pt()}},debounce:!0,debounceDelay:300}),x=f(T).clientWidth,_=Math.min(f(T).clientHeight,500);const Mt=xe.subscribe(Wt=>{$&&(S=Wt,f(b)?w():A(),f(T)&&document.body.contains(f(T))&&pt())});return C=fe.subscribe(Wt=>{ft(Wt.items)}),o().items&&o().items.length>0?pt():fe.loadItems(),()=>{try{$=!1,re(m,"Component cleanup started"),f(T)&&(dt(f(T)).selectAll("*").remove(),re(m,"D3 selections removed")),k&&(k.cleanup(),re(m,"Resize hook cleaned up")),C&&(C(),re(m,"Unsubscribed from items store")),Mt&&(Mt(),re(m,"Unsubscribed from language store")),re(m,"Component cleanup completed")}catch(Wt){console.error("Error during cleanup:",Wt)}}})();return()=>{Dt.then(Mt=>Mt())}}catch(vt){return console.error("Error in onMount:",vt),()=>{}}}),In(()=>{if($){$=!1,re(m,"Component destroyed (backup cleanup)");try{k&&(k.cleanup(),re(m,"Resize hook cleaned up (backup)")),C&&(C(),re(m,"Unsubscribed from items store (backup)"))}catch(vt){console.error("Error during backup cleanup:",vt)}}}),Ue();var Z=Ky(),it=L(Z);Nr(it,{title:"",translationKey:"",description:"This visualization shows the distribution of words across items by country and collection. The size of each block represents the word count in that country or collection.",descriptionTranslationKey:"viz.word_distribution_description",get titleHtml(){return f(I)},className:"word-visualization-compact-header",children:(vt,Dt)=>{var Mt=Gy(),Wt=jt(Mt),Ut=L(Wt);{var Lt=kt=>{var Pt=Oy(),zt=L(Pt);It(mt=>lt(zt,mt),[()=>ot("ui.loading")],ie),nt(kt,Pt)},G=kt=>{var Pt=se(),zt=jt(Pt);{var mt=Nt=>{var qt=Vy(),he=L(qt);It(()=>lt(he,o().error)),nt(Nt,qt)};Ot(zt,Nt=>{o().error&&Nt(mt)},!0)}nt(kt,Pt)};Ot(Ut,kt=>{o().loading?kt(Lt):kt(G,!1)})}We(Wt,kt=>D(T,kt),()=>f(T));var yt=_t(Wt,2),st=L(yt),ht=L(st),Tt=L(ht),St=_t(ht,2),Bt=L(St),Kt=_t(Bt),Gt=L(Kt),Et=_t(St,2),Ft=L(Et),V=_t(Ft),et=L(V),wt=_t(Et,2);{var Ct=kt=>{var Pt=Wy(),zt=L(Pt),mt=_t(zt),Nt=L(mt);It(qt=>{lt(zt,`${s()??""}: `),lt(Nt,qt)},[()=>O(Math.round(f(z)/f(N)))],ie),nt(kt,Pt)};Ot(wt,kt=>{f(N)>0&&kt(Ct)})}var gt=_t(wt,2);{var Vt=kt=>{var Pt=qy(),zt=jt(Pt),mt=L(zt),Nt=_t(mt),qt=L(Nt),he=_t(zt,2),be=L(he);It(()=>{lt(mt,`${p()??""}: `),lt(qt,f(b).data.name),lt(be,v())}),nt(kt,Pt)},Rt=kt=>{var Pt=Yy(),zt=L(Pt);It(()=>lt(zt,y())),nt(kt,Pt)};Ot(gt,kt=>{f(b)?kt(Vt):kt(Rt,!1)})}It((kt,Pt)=>{lt(Tt,h()),lt(Bt,`${u()??""}: `),lt(Gt,kt),lt(Ft,`${g()??""}: `),lt(et,Pt)},[()=>O(f(N)),()=>O(f(z))],ie),nt(vt,Mt)},$$slots:{default:!0}}),nt(t,Z),ze(),r()}function Zy(t,e,n){const r=new URL(window.location.href);return r.searchParams.set("lang",t),r.searchParams.set("tab",e),r.toString()}function Jy(){if(typeof window>"u")return{lang:null,tab:null};const t=new URLSearchParams(window.location.search),e=t.get("lang"),n=t.get("tab");return{lang:e==="en"||e==="fr"?e:null,tab:n}}function il(t,e){if(typeof window>"u")return;const n=Zy(t,e);window.history.pushState({},"",n)}var Qy=$t('<li role="tab" tabindex="0"> </li>'),jy=$t('<div class="flex justify-center items-center font-lg loading-container svelte-1w47g2g"> </div>'),t_=$t('<div class="flex justify-center items-center font-lg text-error loading-container svelte-1w47g2g"> </div>'),e_=$t('<main class="container mx-auto p-md"><header class="mb-lg"><div class="flex justify-between items-center mb-md"><h1 class="m-0 text-xl text-primary"><!></h1> <div class="flex gap-md items-center"><!> <!> <!></div></div> <nav><ul class="flex p-0 m-0 border-b list-style-none app-tabs tabs-container svelte-1w47g2g"><div class="tab-scroll-left-indicator"></div> <div class="tab-scroll-indicator"></div> <!></ul></nav></header> <div class="bg-card rounded shadow p-md content-container svelte-1w47g2g"><!></div></main> <!>',1);function n_(t,e){ke(e,!1);const[n,r]=on(),i=()=>xt(xe,"$languageStore",n),o=()=>xt(fe,"$itemsStore",n),a=()=>xt(p,"$appTitle",n),s=bt(),d="App";let c=bt(!1),l=0,h=()=>{},u=0,g=bt();const p=rt("app.title");let v=bt("countries");const y=[{id:"countries",label:"tab.countries"},{id:"types",label:"tab.types"},{id:"words",label:"tab.words"},{id:"languages",label:"tab.languages"},{id:"categories",label:"tab.categories"},{id:"timeline",label:"tab.timeline"}];let m="",$="";function C(){if(typeof window>"u")return;const{lang:b,tab:I}=Jy();re(d,`URL parameters: lang=${b}, tab=${I}`),b&&(xe.setLanguage(b),re(d,`Setting language from URL: ${b}`)),I&&y.some(S=>S.id===I)&&(D(v,I),re(d,`Setting tab from URL: ${I}`))}function T(){if(!f(g))return;f(g).scrollWidth>f(g).clientWidth?f(g).classList.add("tab-scroll-active"):f(g).classList.remove("tab-scroll-active")}function x(){if(!f(g))return;const b=f(g).querySelector(".tab-item.active");if(!b)return;const I=f(g).getBoundingClientRect(),S=b.getBoundingClientRect(),R=S.right<=I.right,W=S.left>=I.left;if(R){if(!W)try{b.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})}catch{Bo(g,f(g).scrollLeft+=S.left-I.left-16)}}else try{b.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})}catch{Bo(g,f(g).scrollLeft+=S.right-I.right+16)}}function _(b){D(v,b),m&&il(m,b),setTimeout(()=>{x()},50)}function z(b){var I;if(!f(c)){re(d,`Language change ignored (not mounted): ${b}`);return}$=m,m=b,il(b,f(v)),D(s,y.map(S=>({...S,translatedLabel:ot(S.label)}))),re(d,`Language changed from ${$} to ${b}`,{isMounted:f(c),updateCount:l,subscriptionActive:!!h}),re(d,"Current translations:",{title:ot("app.title"),loading:ot("ui.loading"),activeTab:ot(((I=y.find(S=>S.id===f(v)))==null?void 0:I.label)||"")}),setTimeout(()=>{T(),x()},100)}xf(()=>{u++,re(d,`Before update (render #${u})`,{isMounted:f(c),currentLanguage:m,activeTab:f(v)})}),Ye(()=>{try{D(c,!0),C(),re(d,`Component mounted, initial language: ${i()}`,{storeValue:i(),activeTab:f(v)}),m=i(),D(s,y.map(b=>({...b,translatedLabel:ot(b.label)})));try{h=xe.subscribe(I=>{z(I)}),re(d,"Successfully subscribed to language store")}catch(b){re(d,`Error subscribing to language store: ${b}`)}if((!o().items||o().items.length===0)&&fe.loadItems(),f(g)){if(T(),navigator.userAgent.toLowerCase().indexOf("firefox")>-1){const b=document.createElement("style");b.textContent=".tabs-container { scrollbar-width: none; }",b.setAttribute("data-firefox-scrollbar","true"),document.head.appendChild(b)}f(g).addEventListener("scroll",N),f(g).dispatchEvent(new Event("scroll")),window.addEventListener("resize",U),setTimeout(()=>{x()},100)}}catch(b){console.error("[App] Error in onMount:",b)}}),In(()=>{try{if(h&&h(),D(c,!1),re(d,"Component unmounted"),f(g)){f(g).removeEventListener("scroll",N);const b=document.querySelector("style[data-firefox-scrollbar]");b&&b.remove()}window.removeEventListener("resize",U)}catch(b){console.error("[App] Error in onDestroy:",b)}}),bf(()=>{l++,re(d,`Component updated (${l})`,{isMounted:f(c),currentLanguage:m,storeValue:i(),activeTab:f(v)}),setTimeout(()=>{T()},50)});function N(){if(!f(g))return;const b=f(g).scrollLeft+f(g).clientWidth>=f(g).scrollWidth-5,I=f(g).scrollLeft<=5;b?f(g).classList.remove("tab-scroll-active"):f(g).classList.add("tab-scroll-active"),I?f(g).classList.remove("tab-scroll-not-at-start"):f(g).classList.add("tab-scroll-not-at-start")}function U(){T(),x()}pe(()=>ot,()=>{D(s,y.map(b=>({...b,translatedLabel:ot(b.label)})))}),pe(()=>(i(),f(c),ot),()=>{i()&&f(c)&&D(s,y.map(b=>({...b,translatedLabel:ot(b.label)})))}),hi(),Ue(),Nf(t,{children:(b,I)=>{var S=e_(),R=jt(S),W=L(R),X=L(W),k=L(X),F=L(k);Rl(F,a);var q=_t(k,2),ct=L(q);Lf(ct,{});var B=_t(ct,2);Ef(B,{});var P=_t(B,2);zf(P,{});var j=_t(X,2),J=L(j),K=_t(L(J),4);Hn(K,1,()=>f(s),mr,(O,A)=>{var w=Qy(),M=L(w);It(()=>{wo(w,`py-sm px-md cursor-pointer transition tab-item tab-flexible tabs-mobile ${(f(v)===f(A).id?"active":"")??""} svelte-1w47g2g`),ye(w,"aria-selected",f(v)===f(A).id),lt(M,f(A).translatedLabel)}),_e("click",w,()=>_(f(A).id)),_e("keydown",w,H=>H.key==="Enter"&&_(f(A).id)),nt(O,w)}),We(J,O=>D(g,O),()=>f(g));var tt=_t(W,2),ut=L(tt);{var at=O=>{var A=jy(),w=L(A);It(M=>lt(w,M),[()=>ot("ui.loading")],ie),nt(O,A)},Y=O=>{var A=se(),w=jt(A);{var M=Q=>{var pt=t_(),ft=L(pt);It(()=>lt(ft,o().error)),nt(Q,pt)},H=Q=>{var pt=se(),ft=jt(pt);{var Z=vt=>{P0(vt,{})},it=vt=>{var Dt=se(),Mt=jt(Dt);{var Wt=Lt=>{Hy(Lt,{})},Ut=Lt=>{var G=se(),yt=jt(G);{var st=Tt=>{Xy(Tt,{})},ht=Tt=>{var St=se(),Bt=jt(St);{var Kt=Et=>{ly(Et,{})},Gt=Et=>{var Ft=se(),V=jt(Ft);{var et=Ct=>{gy(Ct,{})},wt=Ct=>{var gt=se(),Vt=jt(gt);{var Rt=kt=>{My(kt,{})};Ot(Vt,kt=>{f(v)==="timeline"&&kt(Rt)},!0)}nt(Ct,gt)};Ot(V,Ct=>{f(v)==="categories"?Ct(et):Ct(wt,!1)},!0)}nt(Et,Ft)};Ot(Bt,Et=>{f(v)==="languages"?Et(Kt):Et(Gt,!1)},!0)}nt(Tt,St)};Ot(yt,Tt=>{f(v)==="words"?Tt(st):Tt(ht,!1)},!0)}nt(Lt,G)};Ot(Mt,Lt=>{f(v)==="types"?Lt(Wt):Lt(Ut,!1)},!0)}nt(vt,Dt)};Ot(ft,vt=>{f(v)==="countries"?vt(Z):vt(it,!1)})}nt(Q,pt)};Ot(w,Q=>{o().error?Q(M):Q(H,!1)},!0)}nt(O,A)};Ot(ut,O=>{o().loading?O(at):O(Y,!1)})}var E=_t(R,2);Ot(E,O=>{}),nt(b,S)},$$slots:{default:!0}}),ze(),r()}ju(n_,{target:document.getElementById("app")});
