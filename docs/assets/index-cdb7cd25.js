(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();function Tt(){}const Xl=t=>t;function Kl(t,e){for(const n in e)t[n]=e[n];return t}function Ro(t){return t()}function fi(){return Object.create(null)}function Ot(t){t.forEach(Ro)}function or(t){return typeof t=="function"}function Vt(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function jl(t){return Object.keys(t).length===0}function Yr(t,...e){if(t==null)return Tt;const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function Zl(t){let e;return Yr(t,n=>e=n)(),e}function yt(t,e,n){t.$$.on_destroy.push(Yr(e,n))}function Oo(t,e,n,r){if(t){const i=Yo(t,e,n,r);return t[0](i)}}function Yo(t,e,n,r){return t[1]&&r?Kl(n.ctx.slice(),t[1](r(e))):n.ctx}function Wo(t,e,n,r){if(t[2]&&r){const i=t[2](r(n));if(e.dirty===void 0)return i;if(typeof i=="object"){const o=[],l=Math.max(e.dirty.length,i.length);for(let a=0;a<l;a+=1)o[a]=e.dirty[a]|i[a];return o}return e.dirty|i}return e.dirty}function Po(t,e,n,r,i,o){if(i){const l=Yo(e,n,r,o);t.p(l,i)}}function Bo(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let r=0;r<n;r++)e[r]=-1;return e}return-1}const qo=typeof window<"u";let Gl=qo?()=>window.performance.now():()=>Date.now(),Wr=qo?t=>requestAnimationFrame(t):Tt;const Ye=new Set;function Vo(t){Ye.forEach(e=>{e.c(t)||(Ye.delete(e),e.f())}),Ye.size!==0&&Wr(Vo)}function Ql(t){let e;return Ye.size===0&&Wr(Vo),{promise:new Promise(n=>{Ye.add(e={c:t,f:n})}),abort(){Ye.delete(e)}}}function p(t,e){t.appendChild(e)}function Xo(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function Jl(t){const e=z("style");return ta(Xo(t),e),e.sheet}function ta(t,e){return p(t.head||t,e),e.sheet}function Q(t,e,n){t.insertBefore(e,n||null)}function j(t){t.parentNode&&t.parentNode.removeChild(t)}function Ve(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function z(t){return document.createElement(t)}function dn(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function H(t){return document.createTextNode(t)}function ht(){return H(" ")}function Ko(){return H("")}function Ut(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function k(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function ea(t){return Array.from(t.childNodes)}function tt(t,e){e=""+e,t.data!==e&&(t.data=e)}function ge(t,e,n){for(let r=0;r<t.options.length;r+=1){const i=t.options[r];if(i.__value===e){i.selected=!0;return}}(!n||e!==void 0)&&(t.selectedIndex=-1)}function di(t){const e=t.querySelector(":checked");return e&&e.__value}function ye(t,e,n){t.classList[n?"add":"remove"](e)}function na(t,e,{bubbles:n=!1,cancelable:r=!1}={}){const i=document.createEvent("CustomEvent");return i.initCustomEvent(t,n,r,e),i}class ra{constructor(e=!1){this.is_svg=!1,this.is_svg=e,this.e=this.n=null}c(e){this.h(e)}m(e,n,r=null){this.e||(this.is_svg?this.e=dn(n.nodeName):this.e=z(n.nodeType===11?"TEMPLATE":n.nodeName),this.t=n.tagName!=="TEMPLATE"?n:n.content,this.c(e)),this.i(r)}h(e){this.e.innerHTML=e,this.n=Array.from(this.e.nodeName==="TEMPLATE"?this.e.content.childNodes:this.e.childNodes)}i(e){for(let n=0;n<this.n.length;n+=1)Q(this.t,this.n[n],e)}p(e){this.d(),this.h(e),this.i(this.a)}d(){this.n.forEach(j)}}const Rn=new Map;let On=0;function ia(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}function oa(t,e){const n={stylesheet:Jl(e),rules:{}};return Rn.set(t,n),n}function hi(t,e,n,r,i,o,l,a=0){const c=16.666/r;let s=`{
`;for(let _=0;_<=1;_+=c){const T=e+(n-e)*o(_);s+=_*100+`%{${l(T,1-T)}}
`}const u=s+`100% {${l(n,1-n)}}
}`,d=`__svelte_${ia(u)}_${a}`,f=Xo(t),{stylesheet:h,rules:g}=Rn.get(f)||oa(f,t);g[d]||(g[d]=!0,h.insertRule(`@keyframes ${d} ${u}`,h.cssRules.length));const x=t.style.animation||"";return t.style.animation=`${x?`${x}, `:""}${d} ${r}ms linear ${i}ms 1 both`,On+=1,d}function la(t,e){const n=(t.style.animation||"").split(", "),r=n.filter(e?o=>o.indexOf(e)<0:o=>o.indexOf("__svelte")===-1),i=n.length-r.length;i&&(t.style.animation=r.join(", "),On-=i,On||aa())}function aa(){Wr(()=>{On||(Rn.forEach(t=>{const{ownerNode:e}=t.stylesheet;e&&j(e)}),Rn.clear())})}let hn;function fn(t){hn=t}function bn(){if(!hn)throw new Error("Function called outside component initialization");return hn}function jo(t){bn().$$.before_update.push(t)}function _e(t){bn().$$.on_mount.push(t)}function Zo(t){bn().$$.after_update.push(t)}function lr(t){bn().$$.on_destroy.push(t)}function sa(t,e){return bn().$$.context.set(t,e),e}const Le=[],fe=[];let We=[];const Cr=[],Go=Promise.resolve();let zr=!1;function Qo(){zr||(zr=!0,Go.then(Jo))}function Te(){return Qo(),Go}function Ce(t){We.push(t)}function ua(t){Cr.push(t)}const dr=new Set;let Ne=0;function Jo(){if(Ne!==0)return;const t=hn;do{try{for(;Ne<Le.length;){const e=Le[Ne];Ne++,fn(e),ca(e.$$)}}catch(e){throw Le.length=0,Ne=0,e}for(fn(null),Le.length=0,Ne=0;fe.length;)fe.pop()();for(let e=0;e<We.length;e+=1){const n=We[e];dr.has(n)||(dr.add(n),n())}We.length=0}while(Le.length);for(;Cr.length;)Cr.pop()();zr=!1,dr.clear(),fn(t)}function ca(t){if(t.fragment!==null){t.update(),Ot(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Ce)}}function fa(t){const e=[],n=[];We.forEach(r=>t.indexOf(r)===-1?e.push(r):n.push(r)),n.forEach(r=>r()),We=e}let Je;function da(){return Je||(Je=Promise.resolve(),Je.then(()=>{Je=null})),Je}function hr(t,e,n){t.dispatchEvent(na(`${e?"intro":"outro"}${n}`))}const En=new Set;let se;function Pr(){se={r:0,c:[],p:se}}function Br(){se.r||Ot(se.c),se=se.p}function St(t,e){t&&t.i&&(En.delete(t),t.i(e))}function $t(t,e,n,r){if(t&&t.o){if(En.has(t))return;En.add(t),se.c.push(()=>{En.delete(t),r&&(n&&t.d(1),r())}),t.o(e)}else r&&r()}const ha={duration:0};function pi(t,e,n,r){const i={direction:"both"};let o=e(t,n,i),l=r?0:1,a=null,c=null,s=null;function u(){s&&la(t,s)}function d(h,g){const x=h.b-l;return g*=Math.abs(x),{a:l,b:h.b,d:x,duration:g,start:h.start,end:h.start+g,group:h.group}}function f(h){const{delay:g=0,duration:x=300,easing:_=Xl,tick:T=Tt,css:b}=o||ha,m={start:Gl()+g,b:h};h||(m.group=se,se.r+=1),a||c?c=m:(b&&(u(),s=hi(t,l,h,x,g,_,b)),h&&T(0,1),a=d(m,x),Ce(()=>hr(t,h,"start")),Ql(y=>{if(c&&y>c.start&&(a=d(c,x),c=null,hr(t,a.b,"start"),b&&(u(),s=hi(t,l,a.b,a.duration,0,_,o.css))),a){if(y>=a.end)T(l=a.b,1-l),hr(t,a.b,"end"),c||(a.b?u():--a.group.r||Ot(a.group.c)),a=null;else if(y>=a.start){const E=y-a.start;l=a.a+a.d*_(E/a.duration),T(l,1-l)}}return!!(a||c)}))}return{run(h){or(o)?da().then(()=>{o=o(i),f(h)}):f(h)},end(){u(),a=c=null}}}function gi(t,e){t.d(1),e.delete(t.key)}function mi(t,e,n,r,i,o,l,a,c,s,u,d){let f=t.length,h=o.length,g=f;const x={};for(;g--;)x[t[g].key]=g;const _=[],T=new Map,b=new Map,m=[];for(g=h;g--;){const w=d(i,o,g),I=n(w);let M=l.get(I);M?r&&m.push(()=>M.p(w,e)):(M=s(I,w),M.c()),T.set(I,_[g]=M),I in x&&b.set(I,Math.abs(g-x[I]))}const y=new Set,E=new Set;function C(w){St(w,1),w.m(a,u),l.set(w.key,w),u=w.first,h--}for(;f&&h;){const w=_[h-1],I=t[f-1],M=w.key,S=I.key;w===I?(u=w.first,f--,h--):T.has(S)?!l.has(M)||y.has(M)?C(w):E.has(S)?f--:b.get(M)>b.get(S)?(E.add(M),C(w)):(y.add(S),f--):(c(I,l),f--)}for(;f--;){const w=t[f];T.has(w.key)||c(w,l)}for(;h;)C(_[h-1]);return Ot(m),_}function pa(t,e,n){const r=t.$$.props[e];r!==void 0&&(t.$$.bound[r]=n,n(t.$$.ctx[r]))}function Xt(t){t&&t.c()}function Pt(t,e,n,r){const{fragment:i,after_update:o}=t.$$;i&&i.m(e,n),r||Ce(()=>{const l=t.$$.on_mount.map(Ro).filter(or);t.$$.on_destroy?t.$$.on_destroy.push(...l):Ot(l),t.$$.on_mount=[]}),o.forEach(Ce)}function Bt(t,e){const n=t.$$;n.fragment!==null&&(fa(n.after_update),Ot(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function ga(t,e){t.$$.dirty[0]===-1&&(Le.push(t),Qo(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Qt(t,e,n,r,i,o,l,a=[-1]){const c=hn;fn(t);const s=t.$$={fragment:null,ctx:[],props:o,update:Tt,not_equal:i,bound:fi(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(c?c.$$.context:[])),callbacks:fi(),dirty:a,skip_bound:!1,root:e.target||c.$$.root};l&&l(s.root);let u=!1;if(s.ctx=n?n(t,e.props||{},(d,f,...h)=>{const g=h.length?h[0]:f;return s.ctx&&i(s.ctx[d],s.ctx[d]=g)&&(!s.skip_bound&&s.bound[d]&&s.bound[d](g),u&&ga(t,d)),f}):[],s.update(),u=!0,Ot(s.before_update),s.fragment=r?r(s.ctx):!1,e.target){if(e.hydrate){const d=ea(e.target);s.fragment&&s.fragment.l(d),d.forEach(j)}else s.fragment&&s.fragment.c();e.intro&&St(t.$$.fragment),Pt(t,e.target,e.anchor,e.customElement),Jo()}fn(c)}class Jt{$destroy(){Bt(this,1),this.$destroy=Tt}$on(e,n){if(!or(n))return Tt;const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(n),()=>{const i=r.indexOf(n);i!==-1&&r.splice(i,1)}}$set(e){this.$$set&&!jl(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Ee=[];function ma(t,e){return{subscribe:qr(t,e).subscribe}}function qr(t,e=Tt){let n;const r=new Set;function i(a){if(Vt(t,a)&&(t=a,n)){const c=!Ee.length;for(const s of r)s[1](),Ee.push(s,t);if(c){for(let s=0;s<Ee.length;s+=2)Ee[s][0](Ee[s+1]);Ee.length=0}}}function o(a){i(a(t))}function l(a,c=Tt){const s=[a,c];return r.add(s),r.size===1&&(n=e(i)||Tt),a(t),()=>{r.delete(s),r.size===0&&n&&(n(),n=null)}}return{set:i,update:o,subscribe:l}}function ya(t,e,n){const r=!Array.isArray(t),i=r?[t]:t,o=e.length<2;return ma(n,l=>{let a=!1;const c=[];let s=0,u=Tt;const d=()=>{if(s)return;u();const h=e(r?c[0]:c,l);o?l(h):u=or(h)?h:Tt},f=i.map((h,g)=>Yr(h,x=>{c[g]=x,s&=~(1<<g),a&&d()},()=>{s|=1<<g}));return a=!0,d(),function(){Ot(f),u(),a=!1}})}const va=()=>{const{subscribe:t,set:e,update:n}=qr({items:[],loading:!1,error:null});return{subscribe:t,loadItems:async()=>{n(r=>({...r,loading:!0,error:null}));try{const o=await(await fetch("/IWAC-overview/items.json")).json();e({items:o,loading:!1,error:null})}catch(r){n(i=>({...i,loading:!1,error:r instanceof Error?r.message:"Failed to load items"}))}}}},It=va(),tl={en:{"app.title":"IWAC Database Overview","tab.countries":"Country Distribution","tab.languages":"Languages","tab.timeline":"Timeline","tab.types":"Type Distribution","tab.categories":"Index Categories","tab.words":"Word Distribution","ui.loading":"Loading database...","ui.select_visualization":"Select a visualization from the tabs above","ui.toggle_language":"Changer en français","ui.show_description":"Show description","ui.hide_description":"Hide description","ui.no_visualization_content":"No visualization content available","viz.summary":"Summary","viz.total_items":"Total items","viz.number_of_categories":"Number of categories","viz.top_categories":"Top Categories","viz.filter_by_country":"Filter by Country","viz.filter_by_type":"Filter by Type","viz.showing_items":"Showing {0} items in {1} languages","viz.all_countries":"All Countries","viz.all_types":"All Types","viz.no_data":"No data available with the current filters","viz.distribution_items":"Distribution of {0} items by country and sub-collection","viz.language_distribution_title":"Language Distribution","viz.language_distribution_items":"Distribution of {0} items by language","viz.language_distribution_description":"This visualization shows the distribution of items by language. You can filter by country and item type to explore the language distribution across different segments of the collection.","viz.timeline_distribution_title":"Timeline Distribution","viz.timeline_distribution_items":"Growth timeline of {0} items over time","viz.timeline_distribution_description":"This visualization shows the growth of the database over time. The blue line represents monthly additions, while the green dotted line shows the cumulative total. You can filter by country and item type to explore growth patterns across different segments of the collection.","viz.time_period":"Time period","viz.avg_monthly_additions":"Average monthly additions","viz.peak_growth_months":"Peak Growth Months","viz.showing_items_over_months":"Showing {0} items over {1} months","viz.months":"months","viz.monthly_additions":"Monthly Additions","viz.month":"Month","viz.publication_year":"Publication Year","viz.number_of_items":"Number of Items","viz.toggle_types":"Toggle Types","viz.toggled_type":"Toggled type: {0}","viz.languages":"Languages","viz.country_distribution_title":"Country Distribution","viz.country_distribution_description":"This visualization shows the distribution of items by country and sub-collection. You can click on any country block to zoom in and see its sub-collections. The size of each block represents the number of items in that country or sub-collection.","viz.country.items":"Items","viz.country.percent_parent":"% of Parent","viz.country.percent_total":"% of Total","viz.country.click_zoom_in":"Click to zoom in","viz.country.click_zoom_out":"Click to zoom out","viz.country.unknown":"Unknown","viz.country.no_set":"No Set","viz.countries":"Countries","viz.sub_collections":"Sub-collections","viz.currently_viewing":"Currently viewing","viz.click_back_to_return":'Click the "Back to All" button to return to the full view',"viz.click_zoom_in":"Click on a country block to zoom in","viz.unknown":"Unknown","viz.no_set":"No Set","viz.word_distribution":"Word Distribution","viz.total_words":"Total Words","viz.avg_words_per_item":"Average Words per Item","viz.back_to_all":"← Back to All","viz.total_items_with_word_count":"Total items with word count","viz.word_distribution_subtitle":"Word Distribution by Country and Item Set ({0} items, {1} words)","viz.words":"words","viz.items":"items","viz.percent_of_country":"% of country","viz.percent_of_total":"% of total","viz.item_set_summary":"Item Set Summary","lang.Français":"French","lang.Anglais":"English","lang.Haoussa":"Hausa","lang.Allemand":"German","lang.Arabe":"Arabic","lang.Italien":"Italian","lang.Dendi":"Dendi","lang.Slovène":"Slovenian","lang.Espagnol":"Spanish","country.all":"All Countries","country.Bénin":"Benin","country.Nigéria":"Nigeria","country.Côte d'Ivoire":"Côte d'Ivoire","country.Burkina Faso":"Burkina Faso","country.Togo":"Togo","country.Niger":"Niger","country.Unknown":"Unknown","type.Article de presse":"Press Article","type.Notice d'autorité":"Authority Record","type.Périodique islamique":"Islamic Periodical","type.Unknown":"Unknown","type.Article de revue":"Journal Article","type.Document":"Document","type.Article de blog":"Blog Post","type.Chapitre de livre":"Book Chapter","type.Livre":"Book","type.Thèse de doctorat":"Doctoral Thesis","type.Communication scientifique":"Scientific Communication","type.all":"All Types"},fr:{"app.title":"Aperçu de la base de données IWAC","tab.countries":"Répartition par pays","tab.languages":"Langues","tab.timeline":"Chronologie","tab.types":"Répartition par type","tab.categories":"Catégories d'index","tab.words":"Répartition des mots","ui.loading":"Chargement de la base de données...","ui.select_visualization":"Sélectionnez une visualisation dans les onglets ci-dessus","ui.toggle_language":"Switch to English","ui.show_description":"Afficher la description","ui.hide_description":"Masquer la description","ui.no_visualization_content":"Aucun contenu de visualisation disponible","viz.summary":"Résumé","viz.total_items":"Nombre total d'éléments","viz.number_of_categories":"Nombre de catégories","viz.top_categories":"Principales catégories","viz.filter_by_country":"Filtrer par pays","viz.filter_by_type":"Filtrer par type","viz.showing_items":"Affichage de {0} éléments dans {1} langues","viz.all_countries":"Tous les pays","viz.all_types":"Tous les types","viz.no_data":"Aucune donnée disponible avec les filtres actuels","viz.distribution_items":"Répartition de {0} éléments par pays et sous-collection","viz.language_distribution_title":"Répartition par langue","viz.language_distribution_items":"Répartition de {0} éléments par langue","viz.language_distribution_description":"Cette visualisation montre la répartition des éléments par langue. Vous pouvez filtrer par pays et par type d'élément pour explorer la répartition des langues dans différents segments de la collection.","viz.timeline_distribution_title":"Chronologie","viz.timeline_distribution_items":"Chronologie de croissance de {0} éléments au fil du temps","viz.timeline_distribution_description":"Cette visualisation montre la croissance de la base de données au fil du temps. La ligne bleue représente les ajouts mensuels, tandis que la ligne pointillée verte montre le total cumulatif. Vous pouvez filtrer par pays et par type d'élément pour explorer les modèles de croissance dans différents segments de la collection.","viz.time_period":"Période","viz.avg_monthly_additions":"Ajouts mensuels moyens","viz.peak_growth_months":"Mois de croissance maximale","viz.showing_items_over_months":"Affichage de {0} éléments sur {1} mois","viz.months":"mois","viz.monthly_additions":"Ajouts mensuels","viz.month":"Mois","viz.publication_year":"Année de publication","viz.number_of_items":"Nombre d'éléments","viz.toggle_types":"Basculer les types","viz.toggled_type":"Type basculé : {0}","viz.languages":"Langues","viz.country_distribution_title":"Répartition par pays","viz.country_distribution_description":"Cette visualisation montre la répartition des éléments par pays et sous-collection. Vous pouvez cliquer sur n'importe quel bloc pays pour zoomer et voir ses sous-collections. La taille de chaque bloc représente le nombre d'éléments dans ce pays ou cette sous-collection.","viz.country.items":"Éléments","viz.country.percent_parent":"% du parent","viz.country.percent_total":"% du total","viz.country.click_zoom_in":"Cliquer pour zoomer","viz.country.click_zoom_out":"Cliquer pour dézoomer","viz.country.unknown":"Inconnu","viz.country.no_set":"Sans ensemble","viz.countries":"Pays","viz.sub_collections":"Sous-collections","viz.currently_viewing":"Affichage actuel","viz.click_back_to_return":'Cliquez sur le bouton "Retour à tous" pour revenir à la vue complète',"viz.click_zoom_in":"Cliquez sur un bloc pays pour zoomer","viz.unknown":"Inconnu","viz.no_set":"Sans ensemble","viz.word_distribution":"Répartition des mots","viz.total_words":"Nombre total de mots","viz.avg_words_per_item":"Moyenne de mots par élément","viz.back_to_all":"← Retour à tous","viz.total_items_with_word_count":"Total des éléments avec nombre de mots","viz.word_distribution_subtitle":"Répartition des mots par pays et ensemble d'éléments ({0} éléments, {1} mots)","viz.words":"mots","viz.items":"éléments","viz.percent_of_country":"% du pays","viz.percent_of_total":"% du total","viz.item_set_summary":"Résumé de l'ensemble d'éléments","lang.Français":"Français","lang.Anglais":"Anglais","lang.Haoussa":"Haoussa","lang.Allemand":"Allemand","lang.Arabe":"Arabe","lang.Italien":"Italien","lang.Dendi":"Dendi","lang.Slovène":"Slovène","lang.Espagnol":"Espagnol","country.all":"Tous les pays","country.Bénin":"Bénin","country.Nigéria":"Nigéria","country.Côte d'Ivoire":"Côte d'Ivoire","country.Burkina Faso":"Burkina Faso","country.Togo":"Togo","country.Niger":"Niger","country.Unknown":"Inconnu","type.Article de presse":"Article de presse","type.Notice d'autorité":"Notice d'autorité","type.Périodique islamique":"Périodique islamique","type.Unknown":"Inconnu","type.Article de revue":"Article de revue","type.Document":"Document","type.Article de blog":"Article de blog","type.Chapitre de livre":"Chapitre de livre","type.Livre":"Livre","type.Thèse de doctorat":"Thèse de doctorat","type.Communication scientifique":"Communication scientifique","type.all":"Tous les types"}};function _a(){const{subscribe:t,set:e,update:n}=qr("en");return{subscribe:t,setLanguage:r=>{console.log("[TranslationStore] Setting language to:",r),e(r)},toggleLanguage:()=>n(r=>{const i=r==="en"?"fr":"en";return console.log("[TranslationStore] Toggling language from",r,"to",i),i})}}const Yt=_a();function el(t,e=[]){console.log("[TranslationStore] Processing translation:",{text:t,replacements:e});const n=t.replace(/{(\d+)}/g,(r,i)=>{const o=parseInt(i);return o<e.length?e[o]:r});return console.log("[TranslationStore] Processed result:",n),n}function wt(t,e=[]){var i;const n=Zl(Yt);console.log("[TranslationStore] t() translation lookup:",{key:t,currentLang:n,replacements:e});const r=((i=tl[n])==null?void 0:i[t])||t;return el(r,e)}function gt(t,e=[]){return console.log("[TranslationStore] Creating reactive translation for key:",t),ya(Yt,n=>{var i;console.log("[TranslationStore] Reactive translation update:",{key:t,language:n});const r=((i=tl[n])==null?void 0:i[t])||t;return el(r,e)})}function ba(t){let e,n,r,i;return{c(){e=z("button"),n=H(t[0]),k(e,"class","language-toggle svelte-u9ii1h")},m(o,l){Q(o,e,l),p(e,n),r||(i=Ut(e,"click",t[2]),r=!0)},p(o,[l]){l&1&&tt(n,o[0])},i:Tt,o:Tt,d(o){o&&j(e),r=!1,i()}}}function wa(t,e,n){let r,i;yt(t,Yt,a=>n(3,i=a));const o=gt("ui.toggle_language");yt(t,o,a=>n(0,r=a));function l(){console.log("[LanguageToggle] Button clicked, current language:",i),Yt.toggleLanguage(),console.log("[LanguageToggle] Toggle text is:",r)}return[r,o,l]}class xa extends Jt{constructor(e){super(),Qt(this,e,wa,ba,Vt,{})}}const ka=!1,Pe=[],Ta=1e3;function Ca(){return new Date().toISOString()}function kt(t,e,n){const i={timestamp:Ca(),component:t,action:e,details:n};Pe.push(i),Pe.length>Ta&&Pe.shift()}const za=new Set,Ma={};function nl(){console.group("IWAC Debug Logs"),Pe.forEach(t=>{console.groupCollapsed(`${t.timestamp} - ${t.component} - ${t.action}`),console.log("Component:",t.component),console.log("Action:",t.action),t.details&&console.log("Details:",t.details),console.groupEnd()}),console.groupEnd()}function rl(){return JSON.stringify(Pe,null,2)}typeof window<"u"&&(window.__IWAC_DEBUG={logs:Pe,dumpLogs:nl,exportLogs:rl,mountedComponents:()=>Array.from(za),hierarchy:Ma});function Aa(t){let e;const n=t[1].default,r=Oo(n,t,t[0],null);return{c(){r&&r.c()},m(i,o){r&&r.m(i,o),e=!0},p(i,[o]){r&&r.p&&(!e||o&1)&&Po(r,n,i,i[0],e?Wo(n,i[0],o,null):Bo(i[0]),null)},i(i){e||(St(r,i),e=!0)},o(i){$t(r,i),e=!1},d(i){r&&r.d(i)}}}const Kt="TranslationContext";function Sa(t,e,n){let r;yt(t,Yt,f=>n(7,r=f));let{$$slots:i={},$$scope:o}=e,l=!1,a,c=0,s=r,u="";sa("translationContext",{componentId:Kt,getLanguage:()=>s});function d(f){if(!l){kt(Kt,`Language change ignored (not mounted): ${f}`);return}u=s,s=f,kt(Kt,`Language changed from ${u} to ${f}`,{isMounted:l,updateCount:c,subscriptionActive:!!a})}return jo(()=>{kt(Kt,"Before update",{isMounted:l,currentLanguage:s,updateCount:c})}),_e(()=>{l=!0,kt(Kt,`Component mounted, initial language: ${r}`,{storeValue:r,currentLanguage:s});try{a=Yt.subscribe(f=>{d(f)}),kt(Kt,"Subscribed to language store")}catch(f){kt(Kt,"Error subscribing to language store",f)}typeof window<"u"&&(window.__TRANSLATION_DEBUG={dumpLogs:nl,exportLogs:rl,currentLanguage:()=>s,isMounted:()=>l})}),lr(()=>{if(kt(Kt,"Component being destroyed",{isMounted:l,currentLanguage:s,hasUnsubscribe:!!a}),l=!1,a)try{a(),kt(Kt,"Unsubscribed from language store"),a=void 0}catch(f){kt(Kt,"Error unsubscribing from language store",f)}}),Zo(()=>{c++,kt(Kt,`Component updated (${c})`,{isMounted:l,currentLanguage:s,storeValue:r})}),t.$$set=f=>{"$$scope"in f&&n(0,o=f.$$scope)},[o,i]}class $a extends Jt{constructor(e){super(),Qt(this,e,Sa,Aa,Vt,{})}}function In(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Da(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Vr(t){let e,n,r;t.length!==2?(e=In,n=(a,c)=>In(t(a),c),r=(a,c)=>t(a)-c):(e=t===In||t===Da?t:Na,n=t,r=t);function i(a,c,s=0,u=a.length){if(s<u){if(e(c,c)!==0)return u;do{const d=s+u>>>1;n(a[d],c)<0?s=d+1:u=d}while(s<u)}return s}function o(a,c,s=0,u=a.length){if(s<u){if(e(c,c)!==0)return u;do{const d=s+u>>>1;n(a[d],c)<=0?s=d+1:u=d}while(s<u)}return s}function l(a,c,s=0,u=a.length){const d=i(a,c,s,u-1);return d>s&&r(a[d-1],c)>-r(a[d],c)?d-1:d}return{left:i,center:l,right:o}}function Na(){return 0}function Ea(t){return t===null?NaN:+t}const Ia=Vr(In),La=Ia.right;Vr(Ea).center;const Ua=La;function Fa(t,e){let n,r;if(e===void 0)for(const i of t)i!=null&&(n===void 0?i>=i&&(n=r=i):(n>i&&(n=i),r<i&&(r=i)));else{let i=-1;for(let o of t)(o=e(o,++i,t))!=null&&(n===void 0?o>=o&&(n=r=o):(n>o&&(n=o),r<o&&(r=o)))}return[n,r]}class Mr extends Map{constructor(e,n=Oa){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),e!=null)for(const[r,i]of e)this.set(r,i)}get(e){return super.get(yi(this,e))}has(e){return super.has(yi(this,e))}set(e,n){return super.set(Ha(this,e),n)}delete(e){return super.delete(Ra(this,e))}}function yi({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):n}function Ha({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):(t.set(r,n),n)}function Ra({_intern:t,_key:e},n){const r=e(n);return t.has(r)&&(n=t.get(r),t.delete(r)),n}function Oa(t){return t!==null&&typeof t=="object"?t.valueOf():t}function Ar(t){return t}function me(t,...e){return il(t,Ar,Ar,e)}function Be(t,e,...n){return il(t,Ar,e,n)}function il(t,e,n,r){return function i(o,l){if(l>=r.length)return n(o);const a=new Mr,c=r[l++];let s=-1;for(const u of o){const d=c(u,++s,o),f=a.get(d);f?f.push(u):a.set(d,[u])}for(const[u,d]of a)a.set(u,i(d,l));return e(a)}(t,0)}const Ya=Math.sqrt(50),Wa=Math.sqrt(10),Pa=Math.sqrt(2);function Yn(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),o=r/Math.pow(10,i),l=o>=Ya?10:o>=Wa?5:o>=Pa?2:1;let a,c,s;return i<0?(s=Math.pow(10,-i)/l,a=Math.round(t*s),c=Math.round(e*s),a/s<t&&++a,c/s>e&&--c,s=-s):(s=Math.pow(10,i)*l,a=Math.round(t/s),c=Math.round(e/s),a*s<t&&++a,c*s>e&&--c),c<a&&.5<=n&&n<2?Yn(t,e,n*2):[a,c,s]}function Ba(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const r=e<t,[i,o,l]=r?Yn(e,t,n):Yn(t,e,n);if(!(o>=i))return[];const a=o-i+1,c=new Array(a);if(r)if(l<0)for(let s=0;s<a;++s)c[s]=(o-s)/-l;else for(let s=0;s<a;++s)c[s]=(o-s)*l;else if(l<0)for(let s=0;s<a;++s)c[s]=(i+s)/-l;else for(let s=0;s<a;++s)c[s]=(i+s)*l;return c}function Sr(t,e,n){return e=+e,t=+t,n=+n,Yn(t,e,n)[2]}function $r(t,e,n){e=+e,t=+t,n=+n;const r=e<t,i=r?Sr(e,t,n):Sr(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}function Ue(t,e){let n;if(e===void 0)for(const r of t)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of t)(i=e(i,++r,t))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function qa(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((e-t)/n))|0,o=new Array(i);++r<i;)o[r]=t+r*n;return o}function Va(t){return t}var pr=1,gr=2,Dr=3,an=4,vi=1e-6;function Xa(t){return"translate("+t+",0)"}function Ka(t){return"translate(0,"+t+")"}function ja(t){return e=>+t(e)}function Za(t,e){return e=Math.max(0,t.bandwidth()-e*2)/2,t.round()&&(e=Math.round(e)),n=>+t(n)+e}function Ga(){return!this.__axis}function ol(t,e){var n=[],r=null,i=null,o=6,l=6,a=3,c=typeof window<"u"&&window.devicePixelRatio>1?0:.5,s=t===pr||t===an?-1:1,u=t===an||t===gr?"x":"y",d=t===pr||t===Dr?Xa:Ka;function f(h){var g=r??(e.ticks?e.ticks.apply(e,n):e.domain()),x=i??(e.tickFormat?e.tickFormat.apply(e,n):Va),_=Math.max(o,0)+a,T=e.range(),b=+T[0]+c,m=+T[T.length-1]+c,y=(e.bandwidth?Za:ja)(e.copy(),c),E=h.selection?h.selection():h,C=E.selectAll(".domain").data([null]),w=E.selectAll(".tick").data(g,e).order(),I=w.exit(),M=w.enter().append("g").attr("class","tick"),S=w.select("line"),Y=w.select("text");C=C.merge(C.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),w=w.merge(M),S=S.merge(M.append("line").attr("stroke","currentColor").attr(u+"2",s*o)),Y=Y.merge(M.append("text").attr("fill","currentColor").attr(u,s*_).attr("dy",t===pr?"0em":t===Dr?"0.71em":"0.32em")),h!==E&&(C=C.transition(h),w=w.transition(h),S=S.transition(h),Y=Y.transition(h),I=I.transition(h).attr("opacity",vi).attr("transform",function(W){return isFinite(W=y(W))?d(W+c):this.getAttribute("transform")}),M.attr("opacity",vi).attr("transform",function(W){var D=this.parentNode.__axis;return d((D&&isFinite(D=D(W))?D:y(W))+c)})),I.remove(),C.attr("d",t===an||t===gr?l?"M"+s*l+","+b+"H"+c+"V"+m+"H"+s*l:"M"+c+","+b+"V"+m:l?"M"+b+","+s*l+"V"+c+"H"+m+"V"+s*l:"M"+b+","+c+"H"+m),w.attr("opacity",1).attr("transform",function(W){return d(y(W)+c)}),S.attr(u+"2",s*o),Y.attr(u,s*_).text(x),E.filter(Ga).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===gr?"start":t===an?"end":"middle"),E.each(function(){this.__axis=y})}return f.scale=function(h){return arguments.length?(e=h,f):e},f.ticks=function(){return n=Array.from(arguments),f},f.tickArguments=function(h){return arguments.length?(n=h==null?[]:Array.from(h),f):n.slice()},f.tickValues=function(h){return arguments.length?(r=h==null?null:Array.from(h),f):r&&r.slice()},f.tickFormat=function(h){return arguments.length?(i=h,f):i},f.tickSize=function(h){return arguments.length?(o=l=+h,f):o},f.tickSizeInner=function(h){return arguments.length?(o=+h,f):o},f.tickSizeOuter=function(h){return arguments.length?(l=+h,f):l},f.tickPadding=function(h){return arguments.length?(a=+h,f):a},f.offset=function(h){return arguments.length?(c=+h,f):c},f}function Wn(t){return ol(Dr,t)}function Pn(t){return ol(an,t)}var Qa={value:()=>{}};function ll(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Ln(n)}function Ln(t){this._=t}function Ja(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Ln.prototype=ll.prototype={constructor:Ln,on:function(t,e){var n=this._,r=Ja(t+"",n),i,o=-1,l=r.length;if(arguments.length<2){for(;++o<l;)if((i=(t=r[o]).type)&&(i=ts(n[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++o<l;)if(i=(t=r[o]).type)n[i]=_i(n[i],t.name,e);else if(e==null)for(i in n)n[i]=_i(n[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Ln(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,o;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=this._[t],r=0,i=o.length;r<i;++r)o[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(e,n)}};function ts(t,e){for(var n=0,r=t.length,i;n<r;++n)if((i=t[n]).name===e)return i.value}function _i(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=Qa,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var Nr="http://www.w3.org/1999/xhtml";const bi={svg:"http://www.w3.org/2000/svg",xhtml:Nr,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function ar(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),bi.hasOwnProperty(e)?{space:bi[e],local:t}:t}function es(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Nr&&e.documentElement.namespaceURI===Nr?e.createElement(t):e.createElementNS(n,t)}}function ns(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function al(t){var e=ar(t);return(e.local?ns:es)(e)}function rs(){}function Xr(t){return t==null?rs:function(){return this.querySelector(t)}}function is(t){typeof t!="function"&&(t=Xr(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o=e[i],l=o.length,a=r[i]=new Array(l),c,s,u=0;u<l;++u)(c=o[u])&&(s=t.call(c,c.__data__,u,o))&&("__data__"in c&&(s.__data__=c.__data__),a[u]=s);return new Wt(r,this._parents)}function os(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function ls(){return[]}function sl(t){return t==null?ls:function(){return this.querySelectorAll(t)}}function as(t){return function(){return os(t.apply(this,arguments))}}function ss(t){typeof t=="function"?t=as(t):t=sl(t);for(var e=this._groups,n=e.length,r=[],i=[],o=0;o<n;++o)for(var l=e[o],a=l.length,c,s=0;s<a;++s)(c=l[s])&&(r.push(t.call(c,c.__data__,s,l)),i.push(c));return new Wt(r,i)}function ul(t){return function(){return this.matches(t)}}function cl(t){return function(e){return e.matches(t)}}var us=Array.prototype.find;function cs(t){return function(){return us.call(this.children,t)}}function fs(){return this.firstElementChild}function ds(t){return this.select(t==null?fs:cs(typeof t=="function"?t:cl(t)))}var hs=Array.prototype.filter;function ps(){return Array.from(this.children)}function gs(t){return function(){return hs.call(this.children,t)}}function ms(t){return this.selectAll(t==null?ps:gs(typeof t=="function"?t:cl(t)))}function ys(t){typeof t!="function"&&(t=ul(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o=e[i],l=o.length,a=r[i]=[],c,s=0;s<l;++s)(c=o[s])&&t.call(c,c.__data__,s,o)&&a.push(c);return new Wt(r,this._parents)}function fl(t){return new Array(t.length)}function vs(){return new Wt(this._enter||this._groups.map(fl),this._parents)}function Bn(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}Bn.prototype={constructor:Bn,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function _s(t){return function(){return t}}function bs(t,e,n,r,i,o){for(var l=0,a,c=e.length,s=o.length;l<s;++l)(a=e[l])?(a.__data__=o[l],r[l]=a):n[l]=new Bn(t,o[l]);for(;l<c;++l)(a=e[l])&&(i[l]=a)}function ws(t,e,n,r,i,o,l){var a,c,s=new Map,u=e.length,d=o.length,f=new Array(u),h;for(a=0;a<u;++a)(c=e[a])&&(f[a]=h=l.call(c,c.__data__,a,e)+"",s.has(h)?i[a]=c:s.set(h,c));for(a=0;a<d;++a)h=l.call(t,o[a],a,o)+"",(c=s.get(h))?(r[a]=c,c.__data__=o[a],s.delete(h)):n[a]=new Bn(t,o[a]);for(a=0;a<u;++a)(c=e[a])&&s.get(f[a])===c&&(i[a]=c)}function xs(t){return t.__data__}function ks(t,e){if(!arguments.length)return Array.from(this,xs);var n=e?ws:bs,r=this._parents,i=this._groups;typeof t!="function"&&(t=_s(t));for(var o=i.length,l=new Array(o),a=new Array(o),c=new Array(o),s=0;s<o;++s){var u=r[s],d=i[s],f=d.length,h=Ts(t.call(u,u&&u.__data__,s,r)),g=h.length,x=a[s]=new Array(g),_=l[s]=new Array(g),T=c[s]=new Array(f);n(u,d,x,_,T,h,e);for(var b=0,m=0,y,E;b<g;++b)if(y=x[b]){for(b>=m&&(m=b+1);!(E=_[m])&&++m<g;);y._next=E||null}}return l=new Wt(l,r),l._enter=a,l._exit=c,l}function Ts(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Cs(){return new Wt(this._exit||this._groups.map(fl),this._parents)}function zs(t,e,n){var r=this.enter(),i=this,o=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),e!=null&&(i=e(i),i&&(i=i.selection())),n==null?o.remove():n(o),r&&i?r.merge(i).order():i}function Ms(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,o=r.length,l=Math.min(i,o),a=new Array(i),c=0;c<l;++c)for(var s=n[c],u=r[c],d=s.length,f=a[c]=new Array(d),h,g=0;g<d;++g)(h=s[g]||u[g])&&(f[g]=h);for(;c<i;++c)a[c]=n[c];return new Wt(a,this._parents)}function As(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],i=r.length-1,o=r[i],l;--i>=0;)(l=r[i])&&(o&&l.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(l,o),o=l);return this}function Ss(t){t||(t=$s);function e(d,f){return d&&f?t(d.__data__,f.__data__):!d-!f}for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var l=n[o],a=l.length,c=i[o]=new Array(a),s,u=0;u<a;++u)(s=l[u])&&(c[u]=s);c.sort(e)}return new Wt(i,this._parents).order()}function $s(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Ds(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function Ns(){return Array.from(this)}function Es(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length;i<o;++i){var l=r[i];if(l)return l}return null}function Is(){let t=0;for(const e of this)++t;return t}function Ls(){return!this.node()}function Us(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i=e[n],o=0,l=i.length,a;o<l;++o)(a=i[o])&&t.call(a,a.__data__,o,i);return this}function Fs(t){return function(){this.removeAttribute(t)}}function Hs(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Rs(t,e){return function(){this.setAttribute(t,e)}}function Os(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Ys(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function Ws(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function Ps(t,e){var n=ar(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?Hs:Fs:typeof e=="function"?n.local?Ws:Ys:n.local?Os:Rs)(n,e))}function dl(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Bs(t){return function(){this.style.removeProperty(t)}}function qs(t,e,n){return function(){this.style.setProperty(t,e,n)}}function Vs(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function Xs(t,e,n){return arguments.length>1?this.each((e==null?Bs:typeof e=="function"?Vs:qs)(t,e,n??"")):Xe(this.node(),t)}function Xe(t,e){return t.style.getPropertyValue(e)||dl(t).getComputedStyle(t,null).getPropertyValue(e)}function Ks(t){return function(){delete this[t]}}function js(t,e){return function(){this[t]=e}}function Zs(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function Gs(t,e){return arguments.length>1?this.each((e==null?Ks:typeof e=="function"?Zs:js)(t,e)):this.node()[t]}function hl(t){return t.trim().split(/^|\s+/)}function Kr(t){return t.classList||new pl(t)}function pl(t){this._node=t,this._names=hl(t.getAttribute("class")||"")}pl.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function gl(t,e){for(var n=Kr(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function ml(t,e){for(var n=Kr(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function Qs(t){return function(){gl(this,t)}}function Js(t){return function(){ml(this,t)}}function tu(t,e){return function(){(e.apply(this,arguments)?gl:ml)(this,t)}}function eu(t,e){var n=hl(t+"");if(arguments.length<2){for(var r=Kr(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof e=="function"?tu:e?Qs:Js)(n,e))}function nu(){this.textContent=""}function ru(t){return function(){this.textContent=t}}function iu(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function ou(t){return arguments.length?this.each(t==null?nu:(typeof t=="function"?iu:ru)(t)):this.node().textContent}function lu(){this.innerHTML=""}function au(t){return function(){this.innerHTML=t}}function su(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function uu(t){return arguments.length?this.each(t==null?lu:(typeof t=="function"?su:au)(t)):this.node().innerHTML}function cu(){this.nextSibling&&this.parentNode.appendChild(this)}function fu(){return this.each(cu)}function du(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function hu(){return this.each(du)}function pu(t){var e=typeof t=="function"?t:al(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function gu(){return null}function mu(t,e){var n=typeof t=="function"?t:al(t),r=e==null?gu:typeof e=="function"?e:Xr(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function yu(){var t=this.parentNode;t&&t.removeChild(this)}function vu(){return this.each(yu)}function _u(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function bu(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function wu(t){return this.select(t?bu:_u)}function xu(t){return arguments.length?this.property("__data__",t):this.node().__data__}function ku(t){return function(e){t.call(this,e,this.__data__)}}function Tu(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function Cu(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,i=e.length,o;n<i;++n)o=e[n],(!t.type||o.type===t.type)&&o.name===t.name?this.removeEventListener(o.type,o.listener,o.options):e[++r]=o;++r?e.length=r:delete this.__on}}}function zu(t,e,n){return function(){var r=this.__on,i,o=ku(e);if(r){for(var l=0,a=r.length;l<a;++l)if((i=r[l]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=o,i.options=n),i.value=e;return}}this.addEventListener(t.type,o,n),i={type:t.type,name:t.name,value:e,listener:o,options:n},r?r.push(i):this.__on=[i]}}function Mu(t,e,n){var r=Tu(t+""),i,o=r.length,l;if(arguments.length<2){var a=this.node().__on;if(a){for(var c=0,s=a.length,u;c<s;++c)for(i=0,u=a[c];i<o;++i)if((l=r[i]).type===u.type&&l.name===u.name)return u.value}return}for(a=e?zu:Cu,i=0;i<o;++i)this.each(a(r[i],e,n));return this}function yl(t,e,n){var r=dl(t),i=r.CustomEvent;typeof i=="function"?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function Au(t,e){return function(){return yl(this,t,e)}}function Su(t,e){return function(){return yl(this,t,e.apply(this,arguments))}}function $u(t,e){return this.each((typeof e=="function"?Su:Au)(t,e))}function*Du(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length,l;i<o;++i)(l=r[i])&&(yield l)}var vl=[null];function Wt(t,e){this._groups=t,this._parents=e}function wn(){return new Wt([[document.documentElement]],vl)}function Nu(){return this}Wt.prototype=wn.prototype={constructor:Wt,select:is,selectAll:ss,selectChild:ds,selectChildren:ms,filter:ys,data:ks,enter:vs,exit:Cs,join:zs,merge:Ms,selection:Nu,order:As,sort:Ss,call:Ds,nodes:Ns,node:Es,size:Is,empty:Ls,each:Us,attr:Ps,style:Xs,property:Gs,classed:eu,text:ou,html:uu,raise:fu,lower:hu,append:pu,insert:mu,remove:vu,clone:wu,datum:xu,on:Mu,dispatch:$u,[Symbol.iterator]:Du};function _t(t){return typeof t=="string"?new Wt([[document.querySelector(t)]],[document.documentElement]):new Wt([[t]],vl)}function jr(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function _l(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function xn(){}var pn=.7,qn=1/pn,qe="\\s*([+-]?\\d+)\\s*",gn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ie="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Eu=/^#([0-9a-f]{3,8})$/,Iu=new RegExp(`^rgb\\(${qe},${qe},${qe}\\)$`),Lu=new RegExp(`^rgb\\(${ie},${ie},${ie}\\)$`),Uu=new RegExp(`^rgba\\(${qe},${qe},${qe},${gn}\\)$`),Fu=new RegExp(`^rgba\\(${ie},${ie},${ie},${gn}\\)$`),Hu=new RegExp(`^hsl\\(${gn},${ie},${ie}\\)$`),Ru=new RegExp(`^hsla\\(${gn},${ie},${ie},${gn}\\)$`),wi={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};jr(xn,ze,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:xi,formatHex:xi,formatHex8:Ou,formatHsl:Yu,formatRgb:ki,toString:ki});function xi(){return this.rgb().formatHex()}function Ou(){return this.rgb().formatHex8()}function Yu(){return bl(this).formatHsl()}function ki(){return this.rgb().formatRgb()}function ze(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Eu.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?Ti(e):n===3?new Rt(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?Mn(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?Mn(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Iu.exec(t))?new Rt(e[1],e[2],e[3],1):(e=Lu.exec(t))?new Rt(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Uu.exec(t))?Mn(e[1],e[2],e[3],e[4]):(e=Fu.exec(t))?Mn(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Hu.exec(t))?Mi(e[1],e[2]/100,e[3]/100,1):(e=Ru.exec(t))?Mi(e[1],e[2]/100,e[3]/100,e[4]):wi.hasOwnProperty(t)?Ti(wi[t]):t==="transparent"?new Rt(NaN,NaN,NaN,0):null}function Ti(t){return new Rt(t>>16&255,t>>8&255,t&255,1)}function Mn(t,e,n,r){return r<=0&&(t=e=n=NaN),new Rt(t,e,n,r)}function Wu(t){return t instanceof xn||(t=ze(t)),t?(t=t.rgb(),new Rt(t.r,t.g,t.b,t.opacity)):new Rt}function ve(t,e,n,r){return arguments.length===1?Wu(t):new Rt(t,e,n,r??1)}function Rt(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}jr(Rt,ve,_l(xn,{brighter(t){return t=t==null?qn:Math.pow(qn,t),new Rt(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?pn:Math.pow(pn,t),new Rt(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Rt(ke(this.r),ke(this.g),ke(this.b),Vn(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ci,formatHex:Ci,formatHex8:Pu,formatRgb:zi,toString:zi}));function Ci(){return`#${xe(this.r)}${xe(this.g)}${xe(this.b)}`}function Pu(){return`#${xe(this.r)}${xe(this.g)}${xe(this.b)}${xe((isNaN(this.opacity)?1:this.opacity)*255)}`}function zi(){const t=Vn(this.opacity);return`${t===1?"rgb(":"rgba("}${ke(this.r)}, ${ke(this.g)}, ${ke(this.b)}${t===1?")":`, ${t})`}`}function Vn(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function ke(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function xe(t){return t=ke(t),(t<16?"0":"")+t.toString(16)}function Mi(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Gt(t,e,n,r)}function bl(t){if(t instanceof Gt)return new Gt(t.h,t.s,t.l,t.opacity);if(t instanceof xn||(t=ze(t)),!t)return new Gt;if(t instanceof Gt)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),l=NaN,a=o-i,c=(o+i)/2;return a?(e===o?l=(n-r)/a+(n<r)*6:n===o?l=(r-e)/a+2:l=(e-n)/a+4,a/=c<.5?o+i:2-o-i,l*=60):a=c>0&&c<1?0:l,new Gt(l,a,c,t.opacity)}function Bu(t,e,n,r){return arguments.length===1?bl(t):new Gt(t,e,n,r??1)}function Gt(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}jr(Gt,Bu,_l(xn,{brighter(t){return t=t==null?qn:Math.pow(qn,t),new Gt(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?pn:Math.pow(pn,t),new Gt(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Rt(mr(t>=240?t-240:t+120,i,r),mr(t,i,r),mr(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new Gt(Ai(this.h),An(this.s),An(this.l),Vn(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Vn(this.opacity);return`${t===1?"hsl(":"hsla("}${Ai(this.h)}, ${An(this.s)*100}%, ${An(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Ai(t){return t=(t||0)%360,t<0?t+360:t}function An(t){return Math.max(0,Math.min(1,t||0))}function mr(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const Zr=t=>()=>t;function qu(t,e){return function(n){return t+n*e}}function Vu(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function Xu(t){return(t=+t)==1?wl:function(e,n){return n-e?Vu(e,n,t):Zr(isNaN(e)?n:e)}}function wl(t,e){var n=e-t;return n?qu(t,n):Zr(isNaN(t)?e:t)}const Xn=function t(e){var n=Xu(e);function r(i,o){var l=n((i=ve(i)).r,(o=ve(o)).r),a=n(i.g,o.g),c=n(i.b,o.b),s=wl(i.opacity,o.opacity);return function(u){return i.r=l(u),i.g=a(u),i.b=c(u),i.opacity=s(u),i+""}}return r.gamma=t,r}(1);function Ku(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),i;return function(o){for(i=0;i<n;++i)r[i]=t[i]*(1-o)+e[i]*o;return r}}function ju(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Zu(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,i=new Array(r),o=new Array(n),l;for(l=0;l<r;++l)i[l]=Gr(t[l],e[l]);for(;l<n;++l)o[l]=e[l];return function(a){for(l=0;l<r;++l)o[l]=i[l](a);return o}}function Gu(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function Zt(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function Qu(t,e){var n={},r={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?n[i]=Gr(t[i],e[i]):r[i]=e[i];return function(o){for(i in n)r[i]=n[i](o);return r}}var Er=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,yr=new RegExp(Er.source,"g");function Ju(t){return function(){return t}}function tc(t){return function(e){return t(e)+""}}function xl(t,e){var n=Er.lastIndex=yr.lastIndex=0,r,i,o,l=-1,a=[],c=[];for(t=t+"",e=e+"";(r=Er.exec(t))&&(i=yr.exec(e));)(o=i.index)>n&&(o=e.slice(n,o),a[l]?a[l]+=o:a[++l]=o),(r=r[0])===(i=i[0])?a[l]?a[l]+=i:a[++l]=i:(a[++l]=null,c.push({i:l,x:Zt(r,i)})),n=yr.lastIndex;return n<e.length&&(o=e.slice(n),a[l]?a[l]+=o:a[++l]=o),a.length<2?c[0]?tc(c[0].x):Ju(e):(e=c.length,function(s){for(var u=0,d;u<e;++u)a[(d=c[u]).i]=d.x(s);return a.join("")})}function Gr(t,e){var n=typeof e,r;return e==null||n==="boolean"?Zr(e):(n==="number"?Zt:n==="string"?(r=ze(e))?(e=r,Xn):xl:e instanceof ze?Xn:e instanceof Date?Gu:ju(e)?Ku:Array.isArray(e)?Zu:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?Qu:Zt)(t,e)}function ec(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var Si=180/Math.PI,Ir={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function kl(t,e,n,r,i,o){var l,a,c;return(l=Math.sqrt(t*t+e*e))&&(t/=l,e/=l),(c=t*n+e*r)&&(n-=t*c,r-=e*c),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,c/=a),t*r<e*n&&(t=-t,e=-e,c=-c,l=-l),{translateX:i,translateY:o,rotate:Math.atan2(e,t)*Si,skewX:Math.atan(c)*Si,scaleX:l,scaleY:a}}var Sn;function nc(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Ir:kl(e.a,e.b,e.c,e.d,e.e,e.f)}function rc(t){return t==null||(Sn||(Sn=document.createElementNS("http://www.w3.org/2000/svg","g")),Sn.setAttribute("transform",t),!(t=Sn.transform.baseVal.consolidate()))?Ir:(t=t.matrix,kl(t.a,t.b,t.c,t.d,t.e,t.f))}function Tl(t,e,n,r){function i(s){return s.length?s.pop()+" ":""}function o(s,u,d,f,h,g){if(s!==d||u!==f){var x=h.push("translate(",null,e,null,n);g.push({i:x-4,x:Zt(s,d)},{i:x-2,x:Zt(u,f)})}else(d||f)&&h.push("translate("+d+e+f+n)}function l(s,u,d,f){s!==u?(s-u>180?u+=360:u-s>180&&(s+=360),f.push({i:d.push(i(d)+"rotate(",null,r)-2,x:Zt(s,u)})):u&&d.push(i(d)+"rotate("+u+r)}function a(s,u,d,f){s!==u?f.push({i:d.push(i(d)+"skewX(",null,r)-2,x:Zt(s,u)}):u&&d.push(i(d)+"skewX("+u+r)}function c(s,u,d,f,h,g){if(s!==d||u!==f){var x=h.push(i(h)+"scale(",null,",",null,")");g.push({i:x-4,x:Zt(s,d)},{i:x-2,x:Zt(u,f)})}else(d!==1||f!==1)&&h.push(i(h)+"scale("+d+","+f+")")}return function(s,u){var d=[],f=[];return s=t(s),u=t(u),o(s.translateX,s.translateY,u.translateX,u.translateY,d,f),l(s.rotate,u.rotate,d,f),a(s.skewX,u.skewX,d,f),c(s.scaleX,s.scaleY,u.scaleX,u.scaleY,d,f),s=u=null,function(h){for(var g=-1,x=f.length,_;++g<x;)d[(_=f[g]).i]=_.x(h);return d.join("")}}}var ic=Tl(nc,"px, ","px)","deg)"),oc=Tl(rc,", ",")",")"),Ke=0,sn=0,tn=0,Cl=1e3,Kn,un,jn=0,Me=0,sr=0,mn=typeof performance=="object"&&performance.now?performance:Date,zl=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Qr(){return Me||(zl(lc),Me=mn.now()+sr)}function lc(){Me=0}function Zn(){this._call=this._time=this._next=null}Zn.prototype=Ml.prototype={constructor:Zn,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?Qr():+n)+(e==null?0:+e),!this._next&&un!==this&&(un?un._next=this:Kn=this,un=this),this._call=t,this._time=n,Lr()},stop:function(){this._call&&(this._call=null,this._time=1/0,Lr())}};function Ml(t,e,n){var r=new Zn;return r.restart(t,e,n),r}function ac(){Qr(),++Ke;for(var t=Kn,e;t;)(e=Me-t._time)>=0&&t._call.call(void 0,e),t=t._next;--Ke}function $i(){Me=(jn=mn.now())+sr,Ke=sn=0;try{ac()}finally{Ke=0,uc(),Me=0}}function sc(){var t=mn.now(),e=t-jn;e>Cl&&(sr-=e,jn=t)}function uc(){for(var t,e=Kn,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:Kn=n);un=t,Lr(r)}function Lr(t){if(!Ke){sn&&(sn=clearTimeout(sn));var e=t-Me;e>24?(t<1/0&&(sn=setTimeout($i,t-mn.now()-sr)),tn&&(tn=clearInterval(tn))):(tn||(jn=mn.now(),tn=setInterval(sc,Cl)),Ke=1,zl($i))}}function Di(t,e,n){var r=new Zn;return e=e==null?0:+e,r.restart(i=>{r.stop(),t(i+e)},e,n),r}var cc=ll("start","end","cancel","interrupt"),fc=[],Al=0,Ni=1,Ur=2,Un=3,Ei=4,Fr=5,Fn=6;function ur(t,e,n,r,i,o){var l=t.__transition;if(!l)t.__transition={};else if(n in l)return;dc(t,n,{name:e,index:r,group:i,on:cc,tween:fc,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:Al})}function Jr(t,e){var n=te(t,e);if(n.state>Al)throw new Error("too late; already scheduled");return n}function oe(t,e){var n=te(t,e);if(n.state>Un)throw new Error("too late; already running");return n}function te(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function dc(t,e,n){var r=t.__transition,i;r[e]=n,n.timer=Ml(o,0,n.time);function o(s){n.state=Ni,n.timer.restart(l,n.delay,n.time),n.delay<=s&&l(s-n.delay)}function l(s){var u,d,f,h;if(n.state!==Ni)return c();for(u in r)if(h=r[u],h.name===n.name){if(h.state===Un)return Di(l);h.state===Ei?(h.state=Fn,h.timer.stop(),h.on.call("interrupt",t,t.__data__,h.index,h.group),delete r[u]):+u<e&&(h.state=Fn,h.timer.stop(),h.on.call("cancel",t,t.__data__,h.index,h.group),delete r[u])}if(Di(function(){n.state===Un&&(n.state=Ei,n.timer.restart(a,n.delay,n.time),a(s))}),n.state=Ur,n.on.call("start",t,t.__data__,n.index,n.group),n.state===Ur){for(n.state=Un,i=new Array(f=n.tween.length),u=0,d=-1;u<f;++u)(h=n.tween[u].value.call(t,t.__data__,n.index,n.group))&&(i[++d]=h);i.length=d+1}}function a(s){for(var u=s<n.duration?n.ease.call(null,s/n.duration):(n.timer.restart(c),n.state=Fr,1),d=-1,f=i.length;++d<f;)i[d].call(t,u);n.state===Fr&&(n.on.call("end",t,t.__data__,n.index,n.group),c())}function c(){n.state=Fn,n.timer.stop(),delete r[e];for(var s in r)return;delete t.__transition}}function hc(t,e){var n=t.__transition,r,i,o=!0,l;if(n){e=e==null?null:e+"";for(l in n){if((r=n[l]).name!==e){o=!1;continue}i=r.state>Ur&&r.state<Fr,r.state=Fn,r.timer.stop(),r.on.call(i?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[l]}o&&delete t.__transition}}function pc(t){return this.each(function(){hc(this,t)})}function gc(t,e){var n,r;return function(){var i=oe(this,t),o=i.tween;if(o!==n){r=n=o;for(var l=0,a=r.length;l<a;++l)if(r[l].name===e){r=r.slice(),r.splice(l,1);break}}i.tween=r}}function mc(t,e,n){var r,i;if(typeof n!="function")throw new Error;return function(){var o=oe(this,t),l=o.tween;if(l!==r){i=(r=l).slice();for(var a={name:e,value:n},c=0,s=i.length;c<s;++c)if(i[c].name===e){i[c]=a;break}c===s&&i.push(a)}o.tween=i}}function yc(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=te(this.node(),n).tween,i=0,o=r.length,l;i<o;++i)if((l=r[i]).name===t)return l.value;return null}return this.each((e==null?gc:mc)(n,t,e))}function ti(t,e,n){var r=t._id;return t.each(function(){var i=oe(this,r);(i.value||(i.value={}))[e]=n.apply(this,arguments)}),function(i){return te(i,r).value[e]}}function Sl(t,e){var n;return(typeof e=="number"?Zt:e instanceof ze?Xn:(n=ze(e))?(e=n,Xn):xl)(t,e)}function vc(t){return function(){this.removeAttribute(t)}}function _c(t){return function(){this.removeAttributeNS(t.space,t.local)}}function bc(t,e,n){var r,i=n+"",o;return function(){var l=this.getAttribute(t);return l===i?null:l===r?o:o=e(r=l,n)}}function wc(t,e,n){var r,i=n+"",o;return function(){var l=this.getAttributeNS(t.space,t.local);return l===i?null:l===r?o:o=e(r=l,n)}}function xc(t,e,n){var r,i,o;return function(){var l,a=n(this),c;return a==null?void this.removeAttribute(t):(l=this.getAttribute(t),c=a+"",l===c?null:l===r&&c===i?o:(i=c,o=e(r=l,a)))}}function kc(t,e,n){var r,i,o;return function(){var l,a=n(this),c;return a==null?void this.removeAttributeNS(t.space,t.local):(l=this.getAttributeNS(t.space,t.local),c=a+"",l===c?null:l===r&&c===i?o:(i=c,o=e(r=l,a)))}}function Tc(t,e){var n=ar(t),r=n==="transform"?oc:Sl;return this.attrTween(t,typeof e=="function"?(n.local?kc:xc)(n,r,ti(this,"attr."+t,e)):e==null?(n.local?_c:vc)(n):(n.local?wc:bc)(n,r,e))}function Cc(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function zc(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function Mc(t,e){var n,r;function i(){var o=e.apply(this,arguments);return o!==r&&(n=(r=o)&&zc(t,o)),n}return i._value=e,i}function Ac(t,e){var n,r;function i(){var o=e.apply(this,arguments);return o!==r&&(n=(r=o)&&Cc(t,o)),n}return i._value=e,i}function Sc(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=ar(t);return this.tween(n,(r.local?Mc:Ac)(r,e))}function $c(t,e){return function(){Jr(this,t).delay=+e.apply(this,arguments)}}function Dc(t,e){return e=+e,function(){Jr(this,t).delay=e}}function Nc(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?$c:Dc)(e,t)):te(this.node(),e).delay}function Ec(t,e){return function(){oe(this,t).duration=+e.apply(this,arguments)}}function Ic(t,e){return e=+e,function(){oe(this,t).duration=e}}function Lc(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Ec:Ic)(e,t)):te(this.node(),e).duration}function Uc(t,e){if(typeof e!="function")throw new Error;return function(){oe(this,t).ease=e}}function Fc(t){var e=this._id;return arguments.length?this.each(Uc(e,t)):te(this.node(),e).ease}function Hc(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;oe(this,t).ease=n}}function Rc(t){if(typeof t!="function")throw new Error;return this.each(Hc(this._id,t))}function Oc(t){typeof t!="function"&&(t=ul(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o=e[i],l=o.length,a=r[i]=[],c,s=0;s<l;++s)(c=o[s])&&t.call(c,c.__data__,s,o)&&a.push(c);return new de(r,this._parents,this._name,this._id)}function Yc(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,o=Math.min(r,i),l=new Array(r),a=0;a<o;++a)for(var c=e[a],s=n[a],u=c.length,d=l[a]=new Array(u),f,h=0;h<u;++h)(f=c[h]||s[h])&&(d[h]=f);for(;a<r;++a)l[a]=e[a];return new de(l,this._parents,this._name,this._id)}function Wc(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function Pc(t,e,n){var r,i,o=Wc(e)?Jr:oe;return function(){var l=o(this,t),a=l.on;a!==r&&(i=(r=a).copy()).on(e,n),l.on=i}}function Bc(t,e){var n=this._id;return arguments.length<2?te(this.node(),n).on.on(t):this.each(Pc(n,t,e))}function qc(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function Vc(){return this.on("end.remove",qc(this._id))}function Xc(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Xr(t));for(var r=this._groups,i=r.length,o=new Array(i),l=0;l<i;++l)for(var a=r[l],c=a.length,s=o[l]=new Array(c),u,d,f=0;f<c;++f)(u=a[f])&&(d=t.call(u,u.__data__,f,a))&&("__data__"in u&&(d.__data__=u.__data__),s[f]=d,ur(s[f],e,n,f,s,te(u,n)));return new de(o,this._parents,e,n)}function Kc(t){var e=this._name,n=this._id;typeof t!="function"&&(t=sl(t));for(var r=this._groups,i=r.length,o=[],l=[],a=0;a<i;++a)for(var c=r[a],s=c.length,u,d=0;d<s;++d)if(u=c[d]){for(var f=t.call(u,u.__data__,d,c),h,g=te(u,n),x=0,_=f.length;x<_;++x)(h=f[x])&&ur(h,e,n,x,f,g);o.push(f),l.push(u)}return new de(o,l,e,n)}var jc=wn.prototype.constructor;function Zc(){return new jc(this._groups,this._parents)}function Gc(t,e){var n,r,i;return function(){var o=Xe(this,t),l=(this.style.removeProperty(t),Xe(this,t));return o===l?null:o===n&&l===r?i:i=e(n=o,r=l)}}function $l(t){return function(){this.style.removeProperty(t)}}function Qc(t,e,n){var r,i=n+"",o;return function(){var l=Xe(this,t);return l===i?null:l===r?o:o=e(r=l,n)}}function Jc(t,e,n){var r,i,o;return function(){var l=Xe(this,t),a=n(this),c=a+"";return a==null&&(c=a=(this.style.removeProperty(t),Xe(this,t))),l===c?null:l===r&&c===i?o:(i=c,o=e(r=l,a))}}function tf(t,e){var n,r,i,o="style."+e,l="end."+o,a;return function(){var c=oe(this,t),s=c.on,u=c.value[o]==null?a||(a=$l(e)):void 0;(s!==n||i!==u)&&(r=(n=s).copy()).on(l,i=u),c.on=r}}function ef(t,e,n){var r=(t+="")=="transform"?ic:Sl;return e==null?this.styleTween(t,Gc(t,r)).on("end.style."+t,$l(t)):typeof e=="function"?this.styleTween(t,Jc(t,r,ti(this,"style."+t,e))).each(tf(this._id,t)):this.styleTween(t,Qc(t,r,e),n).on("end.style."+t,null)}function nf(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function rf(t,e,n){var r,i;function o(){var l=e.apply(this,arguments);return l!==i&&(r=(i=l)&&nf(t,l,n)),r}return o._value=e,o}function of(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,rf(t,e,n??""))}function lf(t){return function(){this.textContent=t}}function af(t){return function(){var e=t(this);this.textContent=e??""}}function sf(t){return this.tween("text",typeof t=="function"?af(ti(this,"text",t)):lf(t==null?"":t+""))}function uf(t){return function(e){this.textContent=t.call(this,e)}}function cf(t){var e,n;function r(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&uf(i)),e}return r._value=t,r}function ff(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,cf(t))}function df(){for(var t=this._name,e=this._id,n=Dl(),r=this._groups,i=r.length,o=0;o<i;++o)for(var l=r[o],a=l.length,c,s=0;s<a;++s)if(c=l[s]){var u=te(c,e);ur(c,t,n,s,l,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new de(r,this._parents,t,n)}function hf(){var t,e,n=this,r=n._id,i=n.size();return new Promise(function(o,l){var a={value:l},c={value:function(){--i===0&&o()}};n.each(function(){var s=oe(this,r),u=s.on;u!==t&&(e=(t=u).copy(),e._.cancel.push(a),e._.interrupt.push(a),e._.end.push(c)),s.on=e}),i===0&&o()})}var pf=0;function de(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function Dl(){return++pf}var le=wn.prototype;de.prototype={constructor:de,select:Xc,selectAll:Kc,selectChild:le.selectChild,selectChildren:le.selectChildren,filter:Oc,merge:Yc,selection:Zc,transition:df,call:le.call,nodes:le.nodes,node:le.node,size:le.size,empty:le.empty,each:le.each,on:Bc,attr:Tc,attrTween:Sc,style:ef,styleTween:of,text:sf,textTween:ff,remove:Vc,tween:yc,delay:Nc,duration:Lc,ease:Fc,easeVarying:Rc,end:hf,[Symbol.iterator]:le[Symbol.iterator]};function gf(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var mf={time:null,delay:0,duration:250,ease:gf};function yf(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function vf(t){var e,n;t instanceof de?(e=t._id,t=t._name):(e=Dl(),(n=mf).time=Qr(),t=t==null?null:t+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var l=r[o],a=l.length,c,s=0;s<a;++s)(c=l[s])&&ur(c,t,e,s,l,n||yf(c,e));return new de(r,this._parents,t,e)}wn.prototype.interrupt=pc;wn.prototype.transition=vf;const Hr=Math.PI,Rr=2*Hr,we=1e-6,_f=Rr-we;function Nl(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function bf(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return Nl;const n=10**e;return function(r){this._+=r[0];for(let i=1,o=r.length;i<o;++i)this._+=Math.round(arguments[i]*n)/n+r[i]}}class wf{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?Nl:bf(e)}moveTo(e,n){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,n){this._append`L${this._x1=+e},${this._y1=+n}`}quadraticCurveTo(e,n,r,i){this._append`Q${+e},${+n},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(e,n,r,i,o,l){this._append`C${+e},${+n},${+r},${+i},${this._x1=+o},${this._y1=+l}`}arcTo(e,n,r,i,o){if(e=+e,n=+n,r=+r,i=+i,o=+o,o<0)throw new Error(`negative radius: ${o}`);let l=this._x1,a=this._y1,c=r-e,s=i-n,u=l-e,d=a-n,f=u*u+d*d;if(this._x1===null)this._append`M${this._x1=e},${this._y1=n}`;else if(f>we)if(!(Math.abs(d*c-s*u)>we)||!o)this._append`L${this._x1=e},${this._y1=n}`;else{let h=r-l,g=i-a,x=c*c+s*s,_=h*h+g*g,T=Math.sqrt(x),b=Math.sqrt(f),m=o*Math.tan((Hr-Math.acos((x+f-_)/(2*T*b)))/2),y=m/b,E=m/T;Math.abs(y-1)>we&&this._append`L${e+y*u},${n+y*d}`,this._append`A${o},${o},0,0,${+(d*h>u*g)},${this._x1=e+E*c},${this._y1=n+E*s}`}}arc(e,n,r,i,o,l){if(e=+e,n=+n,r=+r,l=!!l,r<0)throw new Error(`negative radius: ${r}`);let a=r*Math.cos(i),c=r*Math.sin(i),s=e+a,u=n+c,d=1^l,f=l?i-o:o-i;this._x1===null?this._append`M${s},${u}`:(Math.abs(this._x1-s)>we||Math.abs(this._y1-u)>we)&&this._append`L${s},${u}`,r&&(f<0&&(f=f%Rr+Rr),f>_f?this._append`A${r},${r},0,1,${d},${e-a},${n-c}A${r},${r},0,1,${d},${this._x1=s},${this._y1=u}`:f>we&&this._append`A${r},${r},0,${+(f>=Hr)},${d},${this._x1=e+r*Math.cos(o)},${this._y1=n+r*Math.sin(o)}`)}rect(e,n,r,i){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}}function xf(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function Gn(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function je(t){return t=Gn(Math.abs(t)),t?t[1]:NaN}function kf(t,e){return function(n,r){for(var i=n.length,o=[],l=0,a=t[0],c=0;i>0&&a>0&&(c+a+1>r&&(a=Math.max(1,r-c)),o.push(n.substring(i-=a,i+a)),!((c+=a+1)>r));)a=t[l=(l+1)%t.length];return o.reverse().join(e)}}function Tf(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var Cf=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Qn(t){if(!(e=Cf.exec(t)))throw new Error("invalid format: "+t);var e;return new ei({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}Qn.prototype=ei.prototype;function ei(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}ei.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function zf(t){t:for(var e=t.length,n=1,r=-1,i;n<e;++n)switch(t[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+t[n])break t;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(i+1):t}var El;function Mf(t,e){var n=Gn(t,e);if(!n)return t+"";var r=n[0],i=n[1],o=i-(El=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,l=r.length;return o===l?r:o>l?r+new Array(o-l+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+Gn(t,Math.max(0,e+o-1))[0]}function Ii(t,e){var n=Gn(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const Li={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:xf,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Ii(t*100,e),r:Ii,s:Mf,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Ui(t){return t}var Fi=Array.prototype.map,Hi=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Af(t){var e=t.grouping===void 0||t.thousands===void 0?Ui:kf(Fi.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",o=t.numerals===void 0?Ui:Tf(Fi.call(t.numerals,String)),l=t.percent===void 0?"%":t.percent+"",a=t.minus===void 0?"−":t.minus+"",c=t.nan===void 0?"NaN":t.nan+"";function s(d){d=Qn(d);var f=d.fill,h=d.align,g=d.sign,x=d.symbol,_=d.zero,T=d.width,b=d.comma,m=d.precision,y=d.trim,E=d.type;E==="n"?(b=!0,E="g"):Li[E]||(m===void 0&&(m=12),y=!0,E="g"),(_||f==="0"&&h==="=")&&(_=!0,f="0",h="=");var C=x==="$"?n:x==="#"&&/[boxX]/.test(E)?"0"+E.toLowerCase():"",w=x==="$"?r:/[%p]/.test(E)?l:"",I=Li[E],M=/[defgprs%]/.test(E);m=m===void 0?6:/[gprs]/.test(E)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m));function S(Y){var W=C,D=w,$,Z,B;if(E==="c")D=I(Y)+D,Y="";else{Y=+Y;var ct=Y<0||1/Y<0;if(Y=isNaN(Y)?c:I(Math.abs(Y),m),y&&(Y=zf(Y)),ct&&+Y==0&&g!=="+"&&(ct=!1),W=(ct?g==="("?g:a:g==="-"||g==="("?"":g)+W,D=(E==="s"?Hi[8+El/3]:"")+D+(ct&&g==="("?")":""),M){for($=-1,Z=Y.length;++$<Z;)if(B=Y.charCodeAt($),48>B||B>57){D=(B===46?i+Y.slice($+1):Y.slice($))+D,Y=Y.slice(0,$);break}}}b&&!_&&(Y=e(Y,1/0));var nt=W.length+Y.length+D.length,dt=nt<T?new Array(T-nt+1).join(f):"";switch(b&&_&&(Y=e(dt+Y,dt.length?T-D.length:1/0),dt=""),h){case"<":Y=W+Y+D+dt;break;case"=":Y=W+dt+Y+D;break;case"^":Y=dt.slice(0,nt=dt.length>>1)+W+Y+D+dt.slice(nt);break;default:Y=dt+W+Y+D;break}return o(Y)}return S.toString=function(){return d+""},S}function u(d,f){var h=s((d=Qn(d),d.type="f",d)),g=Math.max(-8,Math.min(8,Math.floor(je(f)/3)))*3,x=Math.pow(10,-g),_=Hi[8+g/3];return function(T){return h(x*T)+_}}return{format:s,formatPrefix:u}}var $n,Il,Ll;Sf({thousands:",",grouping:[3],currency:["$",""]});function Sf(t){return $n=Af(t),Il=$n.format,Ll=$n.formatPrefix,$n}function $f(t){return Math.max(0,-je(Math.abs(t)))}function Df(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(je(e)/3)))*3-je(Math.abs(t)))}function Nf(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,je(e)-je(t))+1}function Ef(t){var e=0,n=t.children,r=n&&n.length;if(!r)e=1;else for(;--r>=0;)e+=n[r].value;t.value=e}function If(){return this.eachAfter(Ef)}function Lf(t,e){let n=-1;for(const r of this)t.call(e,r,++n,this);return this}function Uf(t,e){for(var n=this,r=[n],i,o,l=-1;n=r.pop();)if(t.call(e,n,++l,this),i=n.children)for(o=i.length-1;o>=0;--o)r.push(i[o]);return this}function Ff(t,e){for(var n=this,r=[n],i=[],o,l,a,c=-1;n=r.pop();)if(i.push(n),o=n.children)for(l=0,a=o.length;l<a;++l)r.push(o[l]);for(;n=i.pop();)t.call(e,n,++c,this);return this}function Hf(t,e){let n=-1;for(const r of this)if(t.call(e,r,++n,this))return r}function Rf(t){return this.eachAfter(function(e){for(var n=+t(e.data)||0,r=e.children,i=r&&r.length;--i>=0;)n+=r[i].value;e.value=n})}function Of(t){return this.eachBefore(function(e){e.children&&e.children.sort(t)})}function Yf(t){for(var e=this,n=Wf(e,t),r=[e];e!==n;)e=e.parent,r.push(e);for(var i=r.length;t!==n;)r.splice(i,0,t),t=t.parent;return r}function Wf(t,e){if(t===e)return t;var n=t.ancestors(),r=e.ancestors(),i=null;for(t=n.pop(),e=r.pop();t===e;)i=t,t=n.pop(),e=r.pop();return i}function Pf(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e}function Bf(){return Array.from(this)}function qf(){var t=[];return this.eachBefore(function(e){e.children||t.push(e)}),t}function Vf(){var t=this,e=[];return t.each(function(n){n!==t&&e.push({source:n.parent,target:n})}),e}function*Xf(){var t=this,e,n=[t],r,i,o;do for(e=n.reverse(),n=[];t=e.pop();)if(yield t,r=t.children)for(i=0,o=r.length;i<o;++i)n.push(r[i]);while(n.length)}function re(t,e){t instanceof Map?(t=[void 0,t],e===void 0&&(e=Zf)):e===void 0&&(e=jf);for(var n=new Jn(t),r,i=[n],o,l,a,c;r=i.pop();)if((l=e(r.data))&&(c=(l=Array.from(l)).length))for(r.children=l,a=c-1;a>=0;--a)i.push(o=l[a]=new Jn(l[a])),o.parent=r,o.depth=r.depth+1;return n.eachBefore(Qf)}function Kf(){return re(this).eachBefore(Gf)}function jf(t){return t.children}function Zf(t){return Array.isArray(t)?t[1]:null}function Gf(t){t.data.value!==void 0&&(t.value=t.data.value),t.data=t.data.data}function Qf(t){var e=0;do t.height=e;while((t=t.parent)&&t.height<++e)}function Jn(t){this.data=t,this.depth=this.height=0,this.parent=null}Jn.prototype=re.prototype={constructor:Jn,count:If,each:Lf,eachAfter:Ff,eachBefore:Uf,find:Hf,sum:Rf,sort:Of,path:Yf,ancestors:Pf,descendants:Bf,leaves:qf,links:Vf,copy:Kf,[Symbol.iterator]:Xf};function Jf(t){if(typeof t!="function")throw new Error;return t}function en(){return 0}function nn(t){return function(){return t}}function td(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)}function ed(t,e,n,r,i){for(var o=t.children,l,a=-1,c=o.length,s=t.value&&(r-e)/t.value;++a<c;)l=o[a],l.y0=n,l.y1=i,l.x0=e,l.x1=e+=l.value*s}function nd(t,e,n,r,i){for(var o=t.children,l,a=-1,c=o.length,s=t.value&&(i-n)/t.value;++a<c;)l=o[a],l.x0=e,l.x1=r,l.y0=n,l.y1=n+=l.value*s}var rd=(1+Math.sqrt(5))/2;function id(t,e,n,r,i,o){for(var l=[],a=e.children,c,s,u=0,d=0,f=a.length,h,g,x=e.value,_,T,b,m,y,E,C;u<f;){h=i-n,g=o-r;do _=a[d++].value;while(!_&&d<f);for(T=b=_,E=Math.max(g/h,h/g)/(x*t),C=_*_*E,y=Math.max(b/C,C/T);d<f;++d){if(_+=s=a[d].value,s<T&&(T=s),s>b&&(b=s),C=_*_*E,m=Math.max(b/C,C/T),m>y){_-=s;break}y=m}l.push(c={value:_,dice:h<g,children:a.slice(u,d)}),c.dice?ed(c,n,r,i,x?r+=g*_/x:o):nd(c,n,r,x?n+=h*_/x:i,o),x-=_,u=d}return l}const od=function t(e){function n(r,i,o,l,a){id(e,r,i,o,l,a)}return n.ratio=function(r){return t((r=+r)>1?r:1)},n}(rd);function Ul(){var t=od,e=!1,n=1,r=1,i=[0],o=en,l=en,a=en,c=en,s=en;function u(f){return f.x0=f.y0=0,f.x1=n,f.y1=r,f.eachBefore(d),i=[0],e&&f.eachBefore(td),f}function d(f){var h=i[f.depth],g=f.x0+h,x=f.y0+h,_=f.x1-h,T=f.y1-h;_<g&&(g=_=(g+_)/2),T<x&&(x=T=(x+T)/2),f.x0=g,f.y0=x,f.x1=_,f.y1=T,f.children&&(h=i[f.depth+1]=o(f)/2,g+=s(f)-h,x+=l(f)-h,_-=a(f)-h,T-=c(f)-h,_<g&&(g=_=(g+_)/2),T<x&&(x=T=(x+T)/2),t(f,g,x,_,T))}return u.round=function(f){return arguments.length?(e=!!f,u):e},u.size=function(f){return arguments.length?(n=+f[0],r=+f[1],u):[n,r]},u.tile=function(f){return arguments.length?(t=Jf(f),u):t},u.padding=function(f){return arguments.length?u.paddingInner(f).paddingOuter(f):u.paddingInner()},u.paddingInner=function(f){return arguments.length?(o=typeof f=="function"?f:nn(+f),u):o},u.paddingOuter=function(f){return arguments.length?u.paddingTop(f).paddingRight(f).paddingBottom(f).paddingLeft(f):u.paddingTop()},u.paddingTop=function(f){return arguments.length?(l=typeof f=="function"?f:nn(+f),u):l},u.paddingRight=function(f){return arguments.length?(a=typeof f=="function"?f:nn(+f),u):a},u.paddingBottom=function(f){return arguments.length?(c=typeof f=="function"?f:nn(+f),u):c},u.paddingLeft=function(f){return arguments.length?(s=typeof f=="function"?f:nn(+f),u):s},u}function cr(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}const Ri=Symbol("implicit");function Se(){var t=new Mr,e=[],n=[],r=Ri;function i(o){let l=t.get(o);if(l===void 0){if(r!==Ri)return r;t.set(o,l=e.push(o)-1)}return n[l%n.length]}return i.domain=function(o){if(!arguments.length)return e.slice();e=[],t=new Mr;for(const l of o)t.has(l)||t.set(l,e.push(l)-1);return i},i.range=function(o){return arguments.length?(n=Array.from(o),i):n.slice()},i.unknown=function(o){return arguments.length?(r=o,i):r},i.copy=function(){return Se(e,n).unknown(r)},cr.apply(i,arguments),i}function ni(){var t=Se().unknown(void 0),e=t.domain,n=t.range,r=0,i=1,o,l,a=!1,c=0,s=0,u=.5;delete t.unknown;function d(){var f=e().length,h=i<r,g=h?i:r,x=h?r:i;o=(x-g)/Math.max(1,f-c+s*2),a&&(o=Math.floor(o)),g+=(x-g-o*(f-c))*u,l=o*(1-c),a&&(g=Math.round(g),l=Math.round(l));var _=qa(f).map(function(T){return g+o*T});return n(h?_.reverse():_)}return t.domain=function(f){return arguments.length?(e(f),d()):e()},t.range=function(f){return arguments.length?([r,i]=f,r=+r,i=+i,d()):[r,i]},t.rangeRound=function(f){return[r,i]=f,r=+r,i=+i,a=!0,d()},t.bandwidth=function(){return l},t.step=function(){return o},t.round=function(f){return arguments.length?(a=!!f,d()):a},t.padding=function(f){return arguments.length?(c=Math.min(1,s=+f),d()):c},t.paddingInner=function(f){return arguments.length?(c=Math.min(1,f),d()):c},t.paddingOuter=function(f){return arguments.length?(s=+f,d()):s},t.align=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),d()):u},t.copy=function(){return ni(e(),[r,i]).round(a).paddingInner(c).paddingOuter(s).align(u)},cr.apply(d(),arguments)}function ld(t){return function(){return t}}function ad(t){return+t}var Oi=[0,1];function Fe(t){return t}function Or(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:ld(isNaN(e)?NaN:.5)}function sd(t,e){var n;return t>e&&(n=t,t=e,e=n),function(r){return Math.max(t,Math.min(e,r))}}function ud(t,e,n){var r=t[0],i=t[1],o=e[0],l=e[1];return i<r?(r=Or(i,r),o=n(l,o)):(r=Or(r,i),o=n(o,l)),function(a){return o(r(a))}}function cd(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),o=new Array(r),l=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++l<r;)i[l]=Or(t[l],t[l+1]),o[l]=n(e[l],e[l+1]);return function(a){var c=Ua(t,a,1,r)-1;return o[c](i[c](a))}}function Fl(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function fd(){var t=Oi,e=Oi,n=Gr,r,i,o,l=Fe,a,c,s;function u(){var f=Math.min(t.length,e.length);return l!==Fe&&(l=sd(t[0],t[f-1])),a=f>2?cd:ud,c=s=null,d}function d(f){return f==null||isNaN(f=+f)?o:(c||(c=a(t.map(r),e,n)))(r(l(f)))}return d.invert=function(f){return l(i((s||(s=a(e,t.map(r),Zt)))(f)))},d.domain=function(f){return arguments.length?(t=Array.from(f,ad),u()):t.slice()},d.range=function(f){return arguments.length?(e=Array.from(f),u()):e.slice()},d.rangeRound=function(f){return e=Array.from(f),n=ec,u()},d.clamp=function(f){return arguments.length?(l=f?!0:Fe,u()):l!==Fe},d.interpolate=function(f){return arguments.length?(n=f,u()):n},d.unknown=function(f){return arguments.length?(o=f,d):o},function(f,h){return r=f,i=h,u()}}function Hl(){return fd()(Fe,Fe)}function dd(t,e,n,r){var i=$r(t,e,n),o;switch(r=Qn(r??",f"),r.type){case"s":{var l=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(o=Df(i,l))&&(r.precision=o),Ll(r,l)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(o=Nf(i,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=o-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(o=$f(i))&&(r.precision=o-(r.type==="%")*2);break}}return Il(r)}function hd(t){var e=t.domain;return t.ticks=function(n){var r=e();return Ba(r[0],r[r.length-1],n??10)},t.tickFormat=function(n,r){var i=e();return dd(i[0],i[i.length-1],n??10,r)},t.nice=function(n){n==null&&(n=10);var r=e(),i=0,o=r.length-1,l=r[i],a=r[o],c,s,u=10;for(a<l&&(s=l,l=a,a=s,s=i,i=o,o=s);u-- >0;){if(s=Sr(l,a,n),s===c)return r[i]=l,r[o]=a,e(r);if(s>0)l=Math.floor(l/s)*s,a=Math.ceil(a/s)*s;else if(s<0)l=Math.ceil(l*s)/s,a=Math.floor(a*s)/s;else break;c=s}return t},t}function yn(){var t=Hl();return t.copy=function(){return Fl(t,yn())},cr.apply(t,arguments),hd(t)}function pd(t,e){t=t.slice();var n=0,r=t.length-1,i=t[n],o=t[r],l;return o<i&&(l=n,n=r,r=l,l=i,i=o,o=l),t[n]=e.floor(i),t[r]=e.ceil(o),t}const vr=new Date,_r=new Date;function Dt(t,e,n,r){function i(o){return t(o=arguments.length===0?new Date:new Date(+o)),o}return i.floor=o=>(t(o=new Date(+o)),o),i.ceil=o=>(t(o=new Date(o-1)),e(o,1),t(o),o),i.round=o=>{const l=i(o),a=i.ceil(o);return o-l<a-o?l:a},i.offset=(o,l)=>(e(o=new Date(+o),l==null?1:Math.floor(l)),o),i.range=(o,l,a)=>{const c=[];if(o=i.ceil(o),a=a==null?1:Math.floor(a),!(o<l)||!(a>0))return c;let s;do c.push(s=new Date(+o)),e(o,a),t(o);while(s<o&&o<l);return c},i.filter=o=>Dt(l=>{if(l>=l)for(;t(l),!o(l);)l.setTime(l-1)},(l,a)=>{if(l>=l)if(a<0)for(;++a<=0;)for(;e(l,-1),!o(l););else for(;--a>=0;)for(;e(l,1),!o(l););}),n&&(i.count=(o,l)=>(vr.setTime(+o),_r.setTime(+l),t(vr),t(_r),Math.floor(n(vr,_r))),i.every=o=>(o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?i.filter(r?l=>r(l)%o===0:l=>i.count(0,l)%o===0):i)),i}const tr=Dt(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);tr.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?Dt(e=>{e.setTime(Math.floor(e/t)*t)},(e,n)=>{e.setTime(+e+n*t)},(e,n)=>(n-e)/t):tr);tr.range;const ue=1e3,qt=ue*60,ce=qt*60,he=ce*24,ri=he*7,Yi=he*30,br=he*365,He=Dt(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*ue)},(t,e)=>(e-t)/ue,t=>t.getUTCSeconds());He.range;const ii=Dt(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*ue)},(t,e)=>{t.setTime(+t+e*qt)},(t,e)=>(e-t)/qt,t=>t.getMinutes());ii.range;const gd=Dt(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*qt)},(t,e)=>(e-t)/qt,t=>t.getUTCMinutes());gd.range;const oi=Dt(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*ue-t.getMinutes()*qt)},(t,e)=>{t.setTime(+t+e*ce)},(t,e)=>(e-t)/ce,t=>t.getHours());oi.range;const md=Dt(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*ce)},(t,e)=>(e-t)/ce,t=>t.getUTCHours());md.range;const kn=Dt(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*qt)/he,t=>t.getDate()-1);kn.range;const li=Dt(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/he,t=>t.getUTCDate()-1);li.range;const yd=Dt(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/he,t=>Math.floor(t/he));yd.range;function $e(t){return Dt(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,n)=>{e.setDate(e.getDate()+n*7)},(e,n)=>(n-e-(n.getTimezoneOffset()-e.getTimezoneOffset())*qt)/ri)}const fr=$e(0),er=$e(1),vd=$e(2),_d=$e(3),Ze=$e(4),bd=$e(5),wd=$e(6);fr.range;er.range;vd.range;_d.range;Ze.range;bd.range;wd.range;function De(t){return Dt(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCDate(e.getUTCDate()+n*7)},(e,n)=>(n-e)/ri)}const Rl=De(0),nr=De(1),xd=De(2),kd=De(3),Ge=De(4),Td=De(5),Cd=De(6);Rl.range;nr.range;xd.range;kd.range;Ge.range;Td.range;Cd.range;const vn=Dt(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12,t=>t.getMonth());vn.range;const zd=Dt(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());zd.range;const pe=Dt(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());pe.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:Dt(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,n)=>{e.setFullYear(e.getFullYear()+n*t)});pe.range;const Ae=Dt(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());Ae.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:Dt(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCFullYear(e.getUTCFullYear()+n*t)});Ae.range;function Md(t,e,n,r,i,o){const l=[[He,1,ue],[He,5,5*ue],[He,15,15*ue],[He,30,30*ue],[o,1,qt],[o,5,5*qt],[o,15,15*qt],[o,30,30*qt],[i,1,ce],[i,3,3*ce],[i,6,6*ce],[i,12,12*ce],[r,1,he],[r,2,2*he],[n,1,ri],[e,1,Yi],[e,3,3*Yi],[t,1,br]];function a(s,u,d){const f=u<s;f&&([s,u]=[u,s]);const h=d&&typeof d.range=="function"?d:c(s,u,d),g=h?h.range(s,+u+1):[];return f?g.reverse():g}function c(s,u,d){const f=Math.abs(u-s)/d,h=Vr(([,,_])=>_).right(l,f);if(h===l.length)return t.every($r(s/br,u/br,d));if(h===0)return tr.every(Math.max($r(s,u,d),1));const[g,x]=l[f/l[h-1][2]<l[h][2]/f?h-1:h];return g.every(x)}return[a,c]}const[Ad,Sd]=Md(pe,vn,fr,kn,oi,ii);function wr(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function xr(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function rn(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function $d(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,o=t.days,l=t.shortDays,a=t.months,c=t.shortMonths,s=on(i),u=ln(i),d=on(o),f=ln(o),h=on(l),g=ln(l),x=on(a),_=ln(a),T=on(c),b=ln(c),m={a:ct,A:nt,b:dt,B:Ct,c:null,d:Xi,e:Xi,f:Jd,g:uh,G:fh,H:Zd,I:Gd,j:Qd,L:Ol,m:th,M:eh,p:J,q:V,Q:Zi,s:Gi,S:nh,u:rh,U:ih,V:oh,w:lh,W:ah,x:null,X:null,y:sh,Y:ch,Z:dh,"%":ji},y={a:F,A:G,b:at,B:lt,c:null,d:Ki,e:Ki,f:mh,g:zh,G:Ah,H:hh,I:ph,j:gh,L:Wl,m:yh,M:vh,p:xt,q:ft,Q:Zi,s:Gi,S:_h,u:bh,U:wh,V:xh,w:kh,W:Th,x:null,X:null,y:Ch,Y:Mh,Z:Sh,"%":ji},E={a:S,A:Y,b:W,B:D,c:$,d:qi,e:qi,f:Vd,g:Bi,G:Pi,H:Vi,I:Vi,j:Wd,L:qd,m:Yd,M:Pd,p:M,q:Od,Q:Kd,s:jd,S:Bd,u:Ld,U:Ud,V:Fd,w:Id,W:Hd,x:Z,X:B,y:Bi,Y:Pi,Z:Rd,"%":Xd};m.x=C(n,m),m.X=C(r,m),m.c=C(e,m),y.x=C(n,y),y.X=C(r,y),y.c=C(e,y);function C(R,rt){return function(st){var v=[],L=-1,q=0,it=R.length,U,A,N;for(st instanceof Date||(st=new Date(+st));++L<it;)R.charCodeAt(L)===37&&(v.push(R.slice(q,L)),(A=Wi[U=R.charAt(++L)])!=null?U=R.charAt(++L):A=U==="e"?" ":"0",(N=rt[U])&&(U=N(st,A)),v.push(U),q=L+1);return v.push(R.slice(q,L)),v.join("")}}function w(R,rt){return function(st){var v=rn(1900,void 0,1),L=I(v,R,st+="",0),q,it;if(L!=st.length)return null;if("Q"in v)return new Date(v.Q);if("s"in v)return new Date(v.s*1e3+("L"in v?v.L:0));if(rt&&!("Z"in v)&&(v.Z=0),"p"in v&&(v.H=v.H%12+v.p*12),v.m===void 0&&(v.m="q"in v?v.q:0),"V"in v){if(v.V<1||v.V>53)return null;"w"in v||(v.w=1),"Z"in v?(q=xr(rn(v.y,0,1)),it=q.getUTCDay(),q=it>4||it===0?nr.ceil(q):nr(q),q=li.offset(q,(v.V-1)*7),v.y=q.getUTCFullYear(),v.m=q.getUTCMonth(),v.d=q.getUTCDate()+(v.w+6)%7):(q=wr(rn(v.y,0,1)),it=q.getDay(),q=it>4||it===0?er.ceil(q):er(q),q=kn.offset(q,(v.V-1)*7),v.y=q.getFullYear(),v.m=q.getMonth(),v.d=q.getDate()+(v.w+6)%7)}else("W"in v||"U"in v)&&("w"in v||(v.w="u"in v?v.u%7:"W"in v?1:0),it="Z"in v?xr(rn(v.y,0,1)).getUTCDay():wr(rn(v.y,0,1)).getDay(),v.m=0,v.d="W"in v?(v.w+6)%7+v.W*7-(it+5)%7:v.w+v.U*7-(it+6)%7);return"Z"in v?(v.H+=v.Z/100|0,v.M+=v.Z%100,xr(v)):wr(v)}}function I(R,rt,st,v){for(var L=0,q=rt.length,it=st.length,U,A;L<q;){if(v>=it)return-1;if(U=rt.charCodeAt(L++),U===37){if(U=rt.charAt(L++),A=E[U in Wi?rt.charAt(L++):U],!A||(v=A(R,st,v))<0)return-1}else if(U!=st.charCodeAt(v++))return-1}return v}function M(R,rt,st){var v=s.exec(rt.slice(st));return v?(R.p=u.get(v[0].toLowerCase()),st+v[0].length):-1}function S(R,rt,st){var v=h.exec(rt.slice(st));return v?(R.w=g.get(v[0].toLowerCase()),st+v[0].length):-1}function Y(R,rt,st){var v=d.exec(rt.slice(st));return v?(R.w=f.get(v[0].toLowerCase()),st+v[0].length):-1}function W(R,rt,st){var v=T.exec(rt.slice(st));return v?(R.m=b.get(v[0].toLowerCase()),st+v[0].length):-1}function D(R,rt,st){var v=x.exec(rt.slice(st));return v?(R.m=_.get(v[0].toLowerCase()),st+v[0].length):-1}function $(R,rt,st){return I(R,e,rt,st)}function Z(R,rt,st){return I(R,n,rt,st)}function B(R,rt,st){return I(R,r,rt,st)}function ct(R){return l[R.getDay()]}function nt(R){return o[R.getDay()]}function dt(R){return c[R.getMonth()]}function Ct(R){return a[R.getMonth()]}function J(R){return i[+(R.getHours()>=12)]}function V(R){return 1+~~(R.getMonth()/3)}function F(R){return l[R.getUTCDay()]}function G(R){return o[R.getUTCDay()]}function at(R){return c[R.getUTCMonth()]}function lt(R){return a[R.getUTCMonth()]}function xt(R){return i[+(R.getUTCHours()>=12)]}function ft(R){return 1+~~(R.getUTCMonth()/3)}return{format:function(R){var rt=C(R+="",m);return rt.toString=function(){return R},rt},parse:function(R){var rt=w(R+="",!1);return rt.toString=function(){return R},rt},utcFormat:function(R){var rt=C(R+="",y);return rt.toString=function(){return R},rt},utcParse:function(R){var rt=w(R+="",!0);return rt.toString=function(){return R},rt}}}var Wi={"-":"",_:" ",0:"0"},Et=/^\s*\d+/,Dd=/^%/,Nd=/[\\^$*+?|[\]().{}]/g;function zt(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(e)+i:i)}function Ed(t){return t.replace(Nd,"\\$&")}function on(t){return new RegExp("^(?:"+t.map(Ed).join("|")+")","i")}function ln(t){return new Map(t.map((e,n)=>[e.toLowerCase(),n]))}function Id(t,e,n){var r=Et.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function Ld(t,e,n){var r=Et.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function Ud(t,e,n){var r=Et.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function Fd(t,e,n){var r=Et.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function Hd(t,e,n){var r=Et.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function Pi(t,e,n){var r=Et.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function Bi(t,e,n){var r=Et.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function Rd(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Od(t,e,n){var r=Et.exec(e.slice(n,n+1));return r?(t.q=r[0]*3-3,n+r[0].length):-1}function Yd(t,e,n){var r=Et.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function qi(t,e,n){var r=Et.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function Wd(t,e,n){var r=Et.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function Vi(t,e,n){var r=Et.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function Pd(t,e,n){var r=Et.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function Bd(t,e,n){var r=Et.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function qd(t,e,n){var r=Et.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function Vd(t,e,n){var r=Et.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function Xd(t,e,n){var r=Dd.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function Kd(t,e,n){var r=Et.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function jd(t,e,n){var r=Et.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function Xi(t,e){return zt(t.getDate(),e,2)}function Zd(t,e){return zt(t.getHours(),e,2)}function Gd(t,e){return zt(t.getHours()%12||12,e,2)}function Qd(t,e){return zt(1+kn.count(pe(t),t),e,3)}function Ol(t,e){return zt(t.getMilliseconds(),e,3)}function Jd(t,e){return Ol(t,e)+"000"}function th(t,e){return zt(t.getMonth()+1,e,2)}function eh(t,e){return zt(t.getMinutes(),e,2)}function nh(t,e){return zt(t.getSeconds(),e,2)}function rh(t){var e=t.getDay();return e===0?7:e}function ih(t,e){return zt(fr.count(pe(t)-1,t),e,2)}function Yl(t){var e=t.getDay();return e>=4||e===0?Ze(t):Ze.ceil(t)}function oh(t,e){return t=Yl(t),zt(Ze.count(pe(t),t)+(pe(t).getDay()===4),e,2)}function lh(t){return t.getDay()}function ah(t,e){return zt(er.count(pe(t)-1,t),e,2)}function sh(t,e){return zt(t.getFullYear()%100,e,2)}function uh(t,e){return t=Yl(t),zt(t.getFullYear()%100,e,2)}function ch(t,e){return zt(t.getFullYear()%1e4,e,4)}function fh(t,e){var n=t.getDay();return t=n>=4||n===0?Ze(t):Ze.ceil(t),zt(t.getFullYear()%1e4,e,4)}function dh(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+zt(e/60|0,"0",2)+zt(e%60,"0",2)}function Ki(t,e){return zt(t.getUTCDate(),e,2)}function hh(t,e){return zt(t.getUTCHours(),e,2)}function ph(t,e){return zt(t.getUTCHours()%12||12,e,2)}function gh(t,e){return zt(1+li.count(Ae(t),t),e,3)}function Wl(t,e){return zt(t.getUTCMilliseconds(),e,3)}function mh(t,e){return Wl(t,e)+"000"}function yh(t,e){return zt(t.getUTCMonth()+1,e,2)}function vh(t,e){return zt(t.getUTCMinutes(),e,2)}function _h(t,e){return zt(t.getUTCSeconds(),e,2)}function bh(t){var e=t.getUTCDay();return e===0?7:e}function wh(t,e){return zt(Rl.count(Ae(t)-1,t),e,2)}function Pl(t){var e=t.getUTCDay();return e>=4||e===0?Ge(t):Ge.ceil(t)}function xh(t,e){return t=Pl(t),zt(Ge.count(Ae(t),t)+(Ae(t).getUTCDay()===4),e,2)}function kh(t){return t.getUTCDay()}function Th(t,e){return zt(nr.count(Ae(t)-1,t),e,2)}function Ch(t,e){return zt(t.getUTCFullYear()%100,e,2)}function zh(t,e){return t=Pl(t),zt(t.getUTCFullYear()%100,e,2)}function Mh(t,e){return zt(t.getUTCFullYear()%1e4,e,4)}function Ah(t,e){var n=t.getUTCDay();return t=n>=4||n===0?Ge(t):Ge.ceil(t),zt(t.getUTCFullYear()%1e4,e,4)}function Sh(){return"+0000"}function ji(){return"%"}function Zi(t){return+t}function Gi(t){return Math.floor(+t/1e3)}var Ie,Re;$h({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function $h(t){return Ie=$d(t),Re=Ie.format,Ie.parse,Ie.utcFormat,Ie.utcParse,Ie}function Dh(t){return new Date(t)}function Nh(t){return t instanceof Date?+t:+new Date(+t)}function Bl(t,e,n,r,i,o,l,a,c,s){var u=Hl(),d=u.invert,f=u.domain,h=s(".%L"),g=s(":%S"),x=s("%I:%M"),_=s("%I %p"),T=s("%a %d"),b=s("%b %d"),m=s("%B"),y=s("%Y");function E(C){return(c(C)<C?h:a(C)<C?g:l(C)<C?x:o(C)<C?_:r(C)<C?i(C)<C?T:b:n(C)<C?m:y)(C)}return u.invert=function(C){return new Date(d(C))},u.domain=function(C){return arguments.length?f(Array.from(C,Nh)):f().map(Dh)},u.ticks=function(C){var w=f();return t(w[0],w[w.length-1],C??10)},u.tickFormat=function(C,w){return w==null?E:s(w)},u.nice=function(C){var w=f();return(!C||typeof C.range!="function")&&(C=e(w[0],w[w.length-1],C??10)),C?f(pd(w,C)):u},u.copy=function(){return Fl(u,Bl(t,e,n,r,i,o,l,a,c,s))},u}function Eh(){return cr.apply(Bl(Ad,Sd,pe,vn,fr,kn,oi,ii,He,Re).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Ih(t){for(var e=t.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+t.slice(r*6,++r*6);return n}const Tn=Ih("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf");function At(t){return function(){return t}}const Qi=Math.abs,Lt=Math.atan2,be=Math.cos,Lh=Math.max,kr=Math.min,ne=Math.sin,Oe=Math.sqrt,Ht=1e-12,_n=Math.PI,rr=_n/2,Hn=2*_n;function Uh(t){return t>1?0:t<-1?_n:Math.acos(t)}function Ji(t){return t>=1?rr:t<=-1?-rr:Math.asin(t)}function ql(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(n==null)e=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);e=r}return t},()=>new wf(e)}function Fh(t){return t.innerRadius}function Hh(t){return t.outerRadius}function Rh(t){return t.startAngle}function Oh(t){return t.endAngle}function Yh(t){return t&&t.padAngle}function Wh(t,e,n,r,i,o,l,a){var c=n-t,s=r-e,u=l-i,d=a-o,f=d*c-u*s;if(!(f*f<Ht))return f=(u*(e-o)-d*(t-i))/f,[t+f*c,e+f*s]}function Dn(t,e,n,r,i,o,l){var a=t-n,c=e-r,s=(l?o:-o)/Oe(a*a+c*c),u=s*c,d=-s*a,f=t+u,h=e+d,g=n+u,x=r+d,_=(f+g)/2,T=(h+x)/2,b=g-f,m=x-h,y=b*b+m*m,E=i-o,C=f*x-g*h,w=(m<0?-1:1)*Oe(Lh(0,E*E*y-C*C)),I=(C*m-b*w)/y,M=(-C*b-m*w)/y,S=(C*m+b*w)/y,Y=(-C*b+m*w)/y,W=I-_,D=M-T,$=S-_,Z=Y-T;return W*W+D*D>$*$+Z*Z&&(I=S,M=Y),{cx:I,cy:M,x01:-u,y01:-d,x11:I*(i/E-1),y11:M*(i/E-1)}}function to(){var t=Fh,e=Hh,n=At(0),r=null,i=Rh,o=Oh,l=Yh,a=null,c=ql(s);function s(){var u,d,f=+t.apply(this,arguments),h=+e.apply(this,arguments),g=i.apply(this,arguments)-rr,x=o.apply(this,arguments)-rr,_=Qi(x-g),T=x>g;if(a||(a=u=c()),h<f&&(d=h,h=f,f=d),!(h>Ht))a.moveTo(0,0);else if(_>Hn-Ht)a.moveTo(h*be(g),h*ne(g)),a.arc(0,0,h,g,x,!T),f>Ht&&(a.moveTo(f*be(x),f*ne(x)),a.arc(0,0,f,x,g,T));else{var b=g,m=x,y=g,E=x,C=_,w=_,I=l.apply(this,arguments)/2,M=I>Ht&&(r?+r.apply(this,arguments):Oe(f*f+h*h)),S=kr(Qi(h-f)/2,+n.apply(this,arguments)),Y=S,W=S,D,$;if(M>Ht){var Z=Ji(M/f*ne(I)),B=Ji(M/h*ne(I));(C-=Z*2)>Ht?(Z*=T?1:-1,y+=Z,E-=Z):(C=0,y=E=(g+x)/2),(w-=B*2)>Ht?(B*=T?1:-1,b+=B,m-=B):(w=0,b=m=(g+x)/2)}var ct=h*be(b),nt=h*ne(b),dt=f*be(E),Ct=f*ne(E);if(S>Ht){var J=h*be(m),V=h*ne(m),F=f*be(y),G=f*ne(y),at;if(_<_n)if(at=Wh(ct,nt,F,G,J,V,dt,Ct)){var lt=ct-at[0],xt=nt-at[1],ft=J-at[0],R=V-at[1],rt=1/ne(Uh((lt*ft+xt*R)/(Oe(lt*lt+xt*xt)*Oe(ft*ft+R*R)))/2),st=Oe(at[0]*at[0]+at[1]*at[1]);Y=kr(S,(f-st)/(rt-1)),W=kr(S,(h-st)/(rt+1))}else Y=W=0}w>Ht?W>Ht?(D=Dn(F,G,ct,nt,h,W,T),$=Dn(J,V,dt,Ct,h,W,T),a.moveTo(D.cx+D.x01,D.cy+D.y01),W<S?a.arc(D.cx,D.cy,W,Lt(D.y01,D.x01),Lt($.y01,$.x01),!T):(a.arc(D.cx,D.cy,W,Lt(D.y01,D.x01),Lt(D.y11,D.x11),!T),a.arc(0,0,h,Lt(D.cy+D.y11,D.cx+D.x11),Lt($.cy+$.y11,$.cx+$.x11),!T),a.arc($.cx,$.cy,W,Lt($.y11,$.x11),Lt($.y01,$.x01),!T))):(a.moveTo(ct,nt),a.arc(0,0,h,b,m,!T)):a.moveTo(ct,nt),!(f>Ht)||!(C>Ht)?a.lineTo(dt,Ct):Y>Ht?(D=Dn(dt,Ct,J,V,f,-Y,T),$=Dn(ct,nt,F,G,f,-Y,T),a.lineTo(D.cx+D.x01,D.cy+D.y01),Y<S?a.arc(D.cx,D.cy,Y,Lt(D.y01,D.x01),Lt($.y01,$.x01),!T):(a.arc(D.cx,D.cy,Y,Lt(D.y01,D.x01),Lt(D.y11,D.x11),!T),a.arc(0,0,f,Lt(D.cy+D.y11,D.cx+D.x11),Lt($.cy+$.y11,$.cx+$.x11),T),a.arc($.cx,$.cy,Y,Lt($.y11,$.x11),Lt($.y01,$.x01),!T))):a.arc(0,0,f,E,y,T)}if(a.closePath(),u)return a=null,u+""||null}return s.centroid=function(){var u=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,d=(+i.apply(this,arguments)+ +o.apply(this,arguments))/2-_n/2;return[be(d)*u,ne(d)*u]},s.innerRadius=function(u){return arguments.length?(t=typeof u=="function"?u:At(+u),s):t},s.outerRadius=function(u){return arguments.length?(e=typeof u=="function"?u:At(+u),s):e},s.cornerRadius=function(u){return arguments.length?(n=typeof u=="function"?u:At(+u),s):n},s.padRadius=function(u){return arguments.length?(r=u==null?null:typeof u=="function"?u:At(+u),s):r},s.startAngle=function(u){return arguments.length?(i=typeof u=="function"?u:At(+u),s):i},s.endAngle=function(u){return arguments.length?(o=typeof u=="function"?u:At(+u),s):o},s.padAngle=function(u){return arguments.length?(l=typeof u=="function"?u:At(+u),s):l},s.context=function(u){return arguments.length?(a=u??null,s):a},s}function ai(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Vl(t){this._context=t}Vl.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function Ph(t){return new Vl(t)}function Bh(t){return t[0]}function qh(t){return t[1]}function eo(t,e){var n=At(!0),r=null,i=Ph,o=null,l=ql(a);t=typeof t=="function"?t:t===void 0?Bh:At(t),e=typeof e=="function"?e:e===void 0?qh:At(e);function a(c){var s,u=(c=ai(c)).length,d,f=!1,h;for(r==null&&(o=i(h=l())),s=0;s<=u;++s)!(s<u&&n(d=c[s],s,c))===f&&((f=!f)?o.lineStart():o.lineEnd()),f&&o.point(+t(d,s,c),+e(d,s,c));if(h)return o=null,h+""||null}return a.x=function(c){return arguments.length?(t=typeof c=="function"?c:At(+c),a):t},a.y=function(c){return arguments.length?(e=typeof c=="function"?c:At(+c),a):e},a.defined=function(c){return arguments.length?(n=typeof c=="function"?c:At(!!c),a):n},a.curve=function(c){return arguments.length?(i=c,r!=null&&(o=i(r)),a):i},a.context=function(c){return arguments.length?(c==null?r=o=null:o=i(r=c),a):r},a}function Vh(t,e){return e<t?-1:e>t?1:e>=t?0:NaN}function Xh(t){return t}function Kh(){var t=Xh,e=Vh,n=null,r=At(0),i=At(Hn),o=At(0);function l(a){var c,s=(a=ai(a)).length,u,d,f=0,h=new Array(s),g=new Array(s),x=+r.apply(this,arguments),_=Math.min(Hn,Math.max(-Hn,i.apply(this,arguments)-x)),T,b=Math.min(Math.abs(_)/s,o.apply(this,arguments)),m=b*(_<0?-1:1),y;for(c=0;c<s;++c)(y=g[h[c]=c]=+t(a[c],c,a))>0&&(f+=y);for(e!=null?h.sort(function(E,C){return e(g[E],g[C])}):n!=null&&h.sort(function(E,C){return n(a[E],a[C])}),c=0,d=f?(_-s*m)/f:0;c<s;++c,x=T)u=h[c],y=g[u],T=x+(y>0?y*d:0)+m,g[u]={data:a[u],index:c,value:y,startAngle:x,endAngle:T,padAngle:b};return g}return l.value=function(a){return arguments.length?(t=typeof a=="function"?a:At(+a),l):t},l.sortValues=function(a){return arguments.length?(e=a,n=null,l):e},l.sort=function(a){return arguments.length?(n=a,e=null,l):n},l.startAngle=function(a){return arguments.length?(r=typeof a=="function"?a:At(+a),l):r},l.endAngle=function(a){return arguments.length?(i=typeof a=="function"?a:At(+a),l):i},l.padAngle=function(a){return arguments.length?(o=typeof a=="function"?a:At(+a),l):o},l}function no(t){return t<0?-1:1}function ro(t,e,n){var r=t._x1-t._x0,i=e-t._x1,o=(t._y1-t._y0)/(r||i<0&&-0),l=(n-t._y1)/(i||r<0&&-0),a=(o*i+l*r)/(r+i);return(no(o)+no(l))*Math.min(Math.abs(o),Math.abs(l),.5*Math.abs(a))||0}function io(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function Tr(t,e,n){var r=t._x0,i=t._y0,o=t._x1,l=t._y1,a=(o-r)/3;t._context.bezierCurveTo(r+a,i+a*e,o-a,l-a*n,o,l)}function ir(t){this._context=t}ir.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Tr(this,this._t0,io(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,Tr(this,io(this,n=ro(this,t,e)),n);break;default:Tr(this,this._t0,n=ro(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}};Object.create(ir.prototype).point=function(t,e){ir.prototype.point.call(this,e,t)};function oo(t){return new ir(t)}function lo(t,e){if((l=t.length)>1)for(var n=1,r,i,o=t[e[0]],l,a=o.length;n<l;++n)for(i=o,o=t[e[n]],r=0;r<a;++r)o[r][1]+=o[r][0]=isNaN(i[r][1])?i[r][0]:i[r][1]}function ao(t){for(var e=t.length,n=new Array(e);--e>=0;)n[e]=e;return n}function jh(t,e){return t[e]}function Zh(t){const e=[];return e.key=t,e}function Gh(){var t=At([]),e=ao,n=lo,r=jh;function i(o){var l=Array.from(t.apply(this,arguments),Zh),a,c=l.length,s=-1,u;for(const d of o)for(a=0,++s;a<c;++a)(l[a][s]=[0,+r(d,l[a].key,s,o)]).data=d;for(a=0,u=ai(e(l));a<c;++a)l[u[a]].index=a;return n(l,u),l}return i.keys=function(o){return arguments.length?(t=typeof o=="function"?o:At(Array.from(o)),i):t},i.value=function(o){return arguments.length?(r=typeof o=="function"?o:At(+o),i):r},i.order=function(o){return arguments.length?(e=o==null?ao:typeof o=="function"?o:At(Array.from(o)),i):e},i.offset=function(o){return arguments.length?(n=o??lo,i):n},i}function cn(t,e,n){this.k=t,this.x=e,this.y=n}cn.prototype={constructor:cn,scale:function(t){return t===1?this:new cn(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new cn(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};cn.prototype;function Qh(t){const e=t-1;return e*e*e+1}function so(t,{delay:e=0,duration:n=400,easing:r=Qh,axis:i="y"}={}){const o=getComputedStyle(t),l=+o.opacity,a=i==="y"?"height":"width",c=parseFloat(o[a]),s=i==="y"?["top","bottom"]:["left","right"],u=s.map(T=>`${T[0].toUpperCase()}${T.slice(1)}`),d=parseFloat(o[`padding${u[0]}`]),f=parseFloat(o[`padding${u[1]}`]),h=parseFloat(o[`margin${u[0]}`]),g=parseFloat(o[`margin${u[1]}`]),x=parseFloat(o[`border${u[0]}Width`]),_=parseFloat(o[`border${u[1]}Width`]);return{delay:e,duration:n,easing:r,css:T=>`overflow: hidden;opacity: ${Math.min(T*20,1)*l};${a}: ${T*c}px;padding-${s[0]}: ${T*d}px;padding-${s[1]}: ${T*f}px;margin-${s[0]}: ${T*h}px;margin-${s[1]}: ${T*g}px;border-${s[0]}-width: ${T*x}px;border-${s[1]}-width: ${T*_}px;`}}function Jh(t){let e;return{c(){e=H(t[7])},m(n,r){Q(n,e,r)},p(n,r){r&128&&tt(e,n[7])},d(n){n&&j(e)}}}function tp(t){let e,n;return{c(){e=new ra(!1),n=Ko(),e.a=n},m(r,i){e.m(t[5],r,i),Q(r,n,i)},p(r,i){i&32&&e.p(r[5])},d(r){r&&j(n),r&&e.d()}}}function uo(t){let e,n,r=(t[0]?wt("ui.hide_description"):wt("ui.show_description"))+"",i,o,l,a,c,s;return{c(){e=z("button"),n=z("span"),i=H(r),o=ht(),l=dn("svg"),a=dn("path"),k(n,"class","sr-only svelte-1o4uev"),k(a,"d","M5 7.5L10 12.5L15 7.5"),k(a,"stroke","currentColor"),k(a,"stroke-width","2"),k(a,"stroke-linecap","round"),k(a,"stroke-linejoin","round"),k(l,"class","accordion-icon svelte-1o4uev"),k(l,"width","20"),k(l,"height","20"),k(l,"viewBox","0 0 20 20"),k(l,"fill","none"),k(l,"xmlns","http://www.w3.org/2000/svg"),ye(l,"open",t[0]),k(e,"class","accordion-toggle svelte-1o4uev"),k(e,"aria-expanded",t[0]),k(e,"aria-controls","description-panel")},m(u,d){Q(u,e,d),p(e,n),p(n,i),p(e,o),p(e,l),p(l,a),c||(s=[Ut(e,"click",t[8]),Ut(e,"keydown",t[9])],c=!0)},p(u,d){d&1&&r!==(r=(u[0]?wt("ui.hide_description"):wt("ui.show_description"))+"")&&tt(i,r),d&1&&ye(l,"open",u[0]),d&1&&k(e,"aria-expanded",u[0])},d(u){u&&j(e),c=!1,Ot(s)}}}function co(t){let e,n,r=t[0]&&fo(t);return{c(){e=z("div"),r&&r.c(),k(e,"class","description-panel-wrapper svelte-1o4uev")},m(i,o){Q(i,e,o),r&&r.m(e,null),n=!0},p(i,o){i[0]?r?(r.p(i,o),o&1&&St(r,1)):(r=fo(i),r.c(),St(r,1),r.m(e,null)):r&&(Pr(),$t(r,1,1,()=>{r=null}),Br())},i(i){n||(St(r),n=!0)},o(i){$t(r),n=!1},d(i){i&&j(e),r&&r.d()}}}function fo(t){let e,n,r,i,o;return{c(){e=z("div"),n=z("p"),r=H(t[6]),k(n,"class","svelte-1o4uev"),k(e,"id","description-panel"),k(e,"class","description-panel svelte-1o4uev")},m(l,a){Q(l,e,a),p(e,n),p(n,r),o=!0},p(l,a){(!o||a&64)&&tt(r,l[6])},i(l){o||(Ce(()=>{o&&(i||(i=pi(e,so,{duration:300},!0)),i.run(1))}),o=!0)},o(l){i||(i=pi(e,so,{duration:300},!1)),i.run(0),o=!1},d(l){l&&j(e),l&&i&&i.end()}}}function ep(t){let e,n,r,i,o,l;function a(f,h){if(f[5])return tp;if(f[2]||f[1])return Jh}let c=a(t),s=c&&c(t),u=(t[3]||t[4])&&uo(t),d=(t[3]||t[4])&&co(t);return{c(){e=z("div"),n=z("div"),r=z("h2"),s&&s.c(),i=ht(),u&&u.c(),o=ht(),d&&d.c(),k(r,"class","visualization-title svelte-1o4uev"),k(n,"class","title-container svelte-1o4uev"),k(e,"class","visualization-header svelte-1o4uev"),ye(e,"has-description",t[0])},m(f,h){Q(f,e,h),p(e,n),p(n,r),s&&s.m(r,null),p(n,i),u&&u.m(n,null),p(e,o),d&&d.m(e,null),l=!0},p(f,[h]){c===(c=a(f))&&s?s.p(f,h):(s&&s.d(1),s=c&&c(f),s&&(s.c(),s.m(r,null))),f[3]||f[4]?u?u.p(f,h):(u=uo(f),u.c(),u.m(n,null)):u&&(u.d(1),u=null),f[3]||f[4]?d?(d.p(f,h),h&24&&St(d,1)):(d=co(f),d.c(),St(d,1),d.m(e,null)):d&&(Pr(),$t(d,1,1,()=>{d=null}),Br()),(!l||h&1)&&ye(e,"has-description",f[0])},i(f){l||(St(d),l=!0)},o(f){$t(d),l=!1},d(f){f&&j(e),s&&s.d(),u&&u.d(),d&&d.d()}}}function np(t,e,n){let r,i,{title:o}=e,{translationKey:l=""}=e,{description:a=""}=e,{showDescription:c=!1}=e,{descriptionTranslationKey:s=""}=e,{titleHtml:u=""}=e;function d(){n(0,c=!c)}const f=h=>h.key==="Enter"&&d();return t.$$set=h=>{"title"in h&&n(1,o=h.title),"translationKey"in h&&n(2,l=h.translationKey),"description"in h&&n(3,a=h.description),"showDescription"in h&&n(0,c=h.showDescription),"descriptionTranslationKey"in h&&n(4,s=h.descriptionTranslationKey),"titleHtml"in h&&n(5,u=h.titleHtml)},t.$$.update=()=>{t.$$.dirty&6&&n(7,r=l?wt(l):o),t.$$.dirty&24&&n(6,i=s?wt(s):a)},[c,o,l,a,s,u,i,r,d,f]}class rp extends Jt{constructor(e){super(),Qt(this,e,np,ep,Vt,{title:1,translationKey:2,description:3,showDescription:0,descriptionTranslationKey:4,titleHtml:5})}}function ip(t){let e;return{c(){e=z("div"),e.textContent=`${wt("ui.no_visualization_content")}`,k(e,"class","no-content svelte-1jo3qap")},m(n,r){Q(n,e,r)},p:Tt,d(n){n&&j(e)}}}function op(t){let e,n=t[6].error+"",r;return{c(){e=z("div"),r=H(n),k(e,"class","error svelte-1jo3qap")},m(i,o){Q(i,e,o),p(e,r)},p(i,o){o&64&&n!==(n=i[6].error+"")&&tt(r,n)},d(i){i&&j(e)}}}function lp(t){let e;return{c(){e=z("div"),e.textContent=`${wt("ui.loading")}`,k(e,"class","loading svelte-1jo3qap")},m(n,r){Q(n,e,r)},p:Tt,d(n){n&&j(e)}}}function ap(t){let e;function n(o,l){return o[6].loading?lp:o[6].error?op:ip}let r=n(t),i=r(t);return{c(){e=z("div"),i.c(),k(e,"class","empty-visualization svelte-1jo3qap")},m(o,l){Q(o,e,l),i.m(e,null)},p(o,l){r===(r=n(o))&&i?i.p(o,l):(i.d(1),i=r(o),i&&(i.c(),i.m(e,null)))},d(o){o&&j(e),i.d()}}}function sp(t){let e,n,r,i,o,l;function a(f){t[9](f)}let c={title:t[1],translationKey:t[2],description:t[3],descriptionTranslationKey:t[4],titleHtml:t[5]};t[0]!==void 0&&(c.showDescription=t[0]),n=new rp({props:c}),fe.push(()=>pa(n,"showDescription",a));const s=t[8].default,u=Oo(s,t,t[7],null),d=u||ap(t);return{c(){e=z("div"),Xt(n.$$.fragment),i=ht(),o=z("div"),d&&d.c(),k(o,"class","visualization-content svelte-1jo3qap"),k(e,"class","visualization-wrapper svelte-1jo3qap")},m(f,h){Q(f,e,h),Pt(n,e,null),p(e,i),p(e,o),d&&d.m(o,null),l=!0},p(f,[h]){const g={};h&2&&(g.title=f[1]),h&4&&(g.translationKey=f[2]),h&8&&(g.description=f[3]),h&16&&(g.descriptionTranslationKey=f[4]),h&32&&(g.titleHtml=f[5]),!r&&h&1&&(r=!0,g.showDescription=f[0],ua(()=>r=!1)),n.$set(g),u?u.p&&(!l||h&128)&&Po(u,s,f,f[7],l?Wo(s,f[7],h,null):Bo(f[7]),null):d&&d.p&&(!l||h&64)&&d.p(f,l?h:-1)},i(f){l||(St(n.$$.fragment,f),St(d,f),l=!0)},o(f){$t(n.$$.fragment,f),$t(d,f),l=!1},d(f){f&&j(e),Bt(n),d&&d.d(f)}}}function up(t,e,n){let r;yt(t,It,h=>n(6,r=h));let{$$slots:i={},$$scope:o}=e,{title:l}=e,{translationKey:a=""}=e,{description:c=""}=e,{descriptionTranslationKey:s=""}=e,{showDescription:u=!1}=e,{titleHtml:d=""}=e;function f(h){u=h,n(0,u)}return t.$$set=h=>{"title"in h&&n(1,l=h.title),"translationKey"in h&&n(2,a=h.translationKey),"description"in h&&n(3,c=h.description),"descriptionTranslationKey"in h&&n(4,s=h.descriptionTranslationKey),"showDescription"in h&&n(0,u=h.showDescription),"titleHtml"in h&&n(5,d=h.titleHtml),"$$scope"in h&&n(7,o=h.$$scope)},[u,l,a,c,s,d,r,o,i,f]}class si extends Jt{constructor(e){super(),Qt(this,e,up,sp,Vt,{title:1,translationKey:2,description:3,descriptionTranslationKey:4,showDescription:0,titleHtml:5})}}function cp(t){let e;return{c(){e=z("div"),e.textContent="Initializing visualization...",k(e,"class","loading svelte-nnbg8i")},m(n,r){Q(n,e,r)},p:Tt,d(n){n&&j(e)}}}function fp(t){let e,n;return{c(){e=z("div"),n=H(t[9]),k(e,"class","no-data svelte-nnbg8i")},m(r,i){Q(r,e,i),p(e,n)},p(r,i){i[0]&512&&tt(n,r[9])},d(r){r&&j(e)}}}function dp(t){let e,n=t[3].error+"",r;return{c(){e=z("div"),r=H(n),k(e,"class","error svelte-nnbg8i")},m(i,o){Q(i,e,o),p(e,r)},p(i,o){o[0]&8&&n!==(n=i[3].error+"")&&tt(r,n)},d(i){i&&j(e)}}}function hp(t){let e;return{c(){e=z("div"),e.textContent=`${wt("ui.loading")}`,k(e,"class","loading svelte-nnbg8i")},m(n,r){Q(n,e,r)},p:Tt,d(n){n&&j(e)}}}function ho(t){let e,n,r,i,o=t[28](t[4])+"",l;return{c(){e=z("p"),n=H(t[12]),r=H(": "),i=z("strong"),l=H(o),k(e,"class","svelte-nnbg8i")},m(a,c){Q(a,e,c),p(e,n),p(e,r),p(e,i),p(i,l)},p(a,c){c[0]&4096&&tt(n,a[12]),c[0]&16&&o!==(o=a[28](a[4])+"")&&tt(l,o)},d(a){a&&j(e)}}}function pp(t){let e,n;return{c(){e=z("p"),n=H(t[7]),k(e,"class","svelte-nnbg8i")},m(r,i){Q(r,e,i),p(e,n)},p(r,i){i[0]&128&&tt(n,r[7])},d(r){r&&j(e)}}}function gp(t){let e,n,r,i,o=t[6].data.name+"",l,a,c,s;return{c(){e=z("p"),n=H(t[13]),r=H(": "),i=z("strong"),l=H(o),a=ht(),c=z("p"),s=H(t[14]),k(e,"class","svelte-nnbg8i"),k(c,"class","svelte-nnbg8i")},m(u,d){Q(u,e,d),p(e,n),p(e,r),p(e,i),p(i,l),Q(u,a,d),Q(u,c,d),p(c,s)},p(u,d){d[0]&8192&&tt(n,u[13]),d[0]&64&&o!==(o=u[6].data.name+"")&&tt(l,o),d[0]&16384&&tt(s,u[14])},d(u){u&&j(e),u&&j(a),u&&j(c)}}}function mp(t){let e,n,r,i,o,l,a,c,s,u,d,f=t[28](t[2])+"",h,g,x,_,T,b,m,y=t[28](t[5])+"",E,C;function w($,Z){if($[3].loading)return hp;if($[3].error)return dp;if(!$[3].items||$[3].items.length===0)return fp;if(!$[0])return cp}let I=w(t),M=I&&I(t),S=!t[6]&&ho(t);function Y($,Z){return $[6]?gp:pp}let W=Y(t),D=W(t);return{c(){e=z("div"),M&&M.c(),n=ht(),r=z("div"),i=z("div"),o=z("h3"),l=H(t[10]),a=ht(),c=z("p"),s=H(t[11]),u=H(": "),d=z("strong"),h=H(f),g=ht(),S&&S.c(),x=ht(),_=z("p"),T=H(t[8]),b=H(": "),m=z("strong"),E=H(y),C=ht(),D.c(),k(e,"class","chart-container svelte-nnbg8i"),k(o,"class","svelte-nnbg8i"),k(c,"class","svelte-nnbg8i"),k(_,"class","svelte-nnbg8i"),k(i,"class","stat-summary svelte-nnbg8i"),k(r,"class","stats svelte-nnbg8i")},m($,Z){Q($,e,Z),M&&M.m(e,null),t[29](e),Q($,n,Z),Q($,r,Z),p(r,i),p(i,o),p(o,l),p(i,a),p(i,c),p(c,s),p(c,u),p(c,d),p(d,h),p(i,g),S&&S.m(i,null),p(i,x),p(i,_),p(_,T),p(_,b),p(_,m),p(m,E),p(i,C),D.m(i,null)},p($,Z){I===(I=w($))&&M?M.p($,Z):(M&&M.d(1),M=I&&I($),M&&(M.c(),M.m(e,null))),Z[0]&1024&&tt(l,$[10]),Z[0]&2048&&tt(s,$[11]),Z[0]&4&&f!==(f=$[28]($[2])+"")&&tt(h,f),$[6]?S&&(S.d(1),S=null):S?S.p($,Z):(S=ho($),S.c(),S.m(i,x)),Z[0]&256&&tt(T,$[8]),Z[0]&32&&y!==(y=$[28]($[5])+"")&&tt(E,y),W===(W=Y($))&&D?D.p($,Z):(D.d(1),D=W($),D&&(D.c(),D.m(i,null)))},d($){$&&j(e),M&&M.d(),t[29](null),$&&j(n),$&&j(r),S&&S.d(),D.d()}}}function yp(t){let e,n,r;return n=new si({props:{title:"",translationKey:"",description:"This visualization shows the distribution of items by country and sub-collection. You can click on any country block to zoom in and see its sub-collections. The size of each block represents the number of items in that country or sub-collection.",descriptionTranslationKey:vp,titleHtml:t[1],$$slots:{default:[mp]},$$scope:{ctx:t}}}),{c(){e=z("div"),Xt(n.$$.fragment),k(e,"class","country-distribution-container svelte-nnbg8i")},m(i,o){Q(i,e,o),Pt(n,e,null),r=!0},p(i,o){const l={};o[0]&2&&(l.titleHtml=i[1]),o[0]&32765|o[1]&2097152&&(l.$$scope={dirty:o,ctx:i}),n.$set(l)},i(i){r||(St(n.$$.fragment,i),r=!0)},o(i){$t(n.$$.fragment,i),r=!1},d(i){i&&j(e),Bt(n)}}}const vp="viz.country_distribution_description";function _p(t,e,n){let r,i,o,l,a,c,s,u,d,f,h,g,x,_;yt(t,It,A=>n(3,r=A));let T=0,b=0,m,y,E={name:"root",children:[]},C=null,w="en",I="",M=0,S=0,Y=0,W=null,D=null;const $=gt("viz.no_data");yt(t,$,A=>n(9,u=A));const Z=gt("viz.items");yt(t,Z,A=>n(39,l=A));const B=gt("viz.percent_of_country");yt(t,B,A=>n(38,o=A));const ct=gt("viz.percent_of_total");yt(t,ct,A=>n(37,i=A));const nt=gt("viz.click_zoom_in");yt(t,nt,A=>n(7,a=A));const dt=gt("viz.back_to_all");yt(t,dt,A=>n(40,s=A)),gt("viz.unknown");const Ct=gt("viz.no_set");yt(t,Ct,A=>n(41,d=A));const J=gt("viz.summary");yt(t,J,A=>n(10,f=A));const V=gt("viz.total_items");yt(t,V,A=>n(11,h=A));const F=gt("viz.countries");yt(t,F,A=>n(12,g=A));const G=gt("viz.sub_collections");yt(t,G,A=>n(8,c=A));const at=gt("viz.currently_viewing");yt(t,at,A=>n(13,x=A));const lt=gt("viz.click_back_to_return");yt(t,lt,A=>n(14,_=A));function xt(A){return A.toLocaleString(w==="fr"?"fr-FR":"en-US")}function ft(A){const N=xt(A);return wt("viz.distribution_items",[N])}function R(){M>0?n(1,I=ft(M)):n(1,I=wt("viz.country_distribution_title")),console.log("Title HTML updated:",I)}Yt.subscribe(A=>{console.log("Language changed to:",A),w=A,R(),r.items&&r.items.length>0&&(n(6,W=null),E=rt(r.items),v())});function rt(A){var O;const N=A.filter(ut=>ut.country&&ut.country.trim()!==""),et=me(N,ut=>ut.country),pt={name:"root",children:Array.from(et,([ut,bt])=>{const vt=wt(`country.${ut}`)||ut,P=Array.from(me(bt,ot=>ot.item_set_title||d),([ot,X])=>({name:ot,value:X.length,itemCount:X.length,originalName:ot}));return{name:vt,children:P,itemCount:bt.length,originalName:ut}})};return n(2,M=N.length),n(4,S=et.size),n(5,Y=((O=pt.children)==null?void 0:O.reduce((ut,bt)=>{var vt;return ut+(((vt=bt.children)==null?void 0:vt.length)||0)},0))||0),R(),console.log("Data processed, total items:",M),pt}function st(A){var N;if(n(6,W=A),W){if(!W.children||W.children.length===0){console.warn("Cannot zoom to node without children");return}console.log("Zooming to node:",W.data.name,"Original name:",W.data.originalName),n(2,M=W.data.itemCount||0),n(5,Y=((N=W.children)==null?void 0:N.length)||0)}else if(r.items&&r.items.length>0){const pt=r.items.filter(ut=>ut.country&&ut.country.trim()!=="");n(2,M=pt.length);const O=me(pt,ut=>ut.country);n(4,S=O.size),n(5,Y=Array.from(O).reduce((ut,[bt,vt])=>{const P=me(vt,ot=>ot.item_set_title||"");return ut+P.size},0))}R(),v()}function v(){try{if(!m){console.error("Container element not found");return}if(W||(E=rt(r.items)),!E.children||E.children.length===0){_t(m).select("svg").remove(),_t(m).append("div").attr("class","no-data").style("position","absolute").style("top","50%").style("left","50%").style("transform","translate(-50%, -50%)").style("text-align","center").style("color","var(--text-color-secondary)").text(u);return}_t(m).select("svg").remove(),_t(m).select(".no-data").remove();const A=m.getBoundingClientRect();T=A.width,b=A.height;const N={top:10,right:10,bottom:10,left:10},et=T-N.left-N.right,pt=b-N.top-N.bottom,ut=_t(m).append("svg").attr("width",T).attr("height",b).append("g").attr("transform",`translate(${N.left}, ${N.top})`);if(W){const K=ut.append("g").attr("class","zoom-out-button").attr("transform","translate(0, 0)").style("cursor","pointer").on("click",()=>st(null));K.append("rect").attr("width",100).attr("height",20).attr("rx",4).attr("fill","var(--primary-color)").attr("opacity",.8),K.append("text").attr("x",50).attr("y",14).attr("text-anchor","middle").attr("fill","white").attr("font-size","var(--font-size-sm)").text(s)}const bt=Ul().size([et,pt]).paddingOuter(4).paddingTop(20).paddingInner(1).round(!0);let vt;if(W){const K={name:W.data.name,children:W.data.children};vt=re(K).sum(mt=>mt.value||0).sort((mt,Mt)=>(Mt.value||0)-(mt.value||0))}else vt=re(E).sum(K=>K.value||0).sort((K,mt)=>(mt.value||0)-(K.value||0));C=vt;try{bt(vt)}catch(K){console.error("Error applying treemap layout:",K),n(6,W=null),E=rt(r.items),vt=re(E).sum(mt=>mt.value||0).sort((mt,Mt)=>(Mt.value||0)-(mt.value||0)),C=vt,bt(vt)}const P=Se().domain(vt.children?vt.children.map(K=>K.data.name):[vt.data.name]).range(Tn),ot=ut.selectAll(".country").data(W?[]:vt.children||[]).enter().append("g").attr("class","country").attr("transform",K=>{const mt=K.x0||0,Mt=K.y0||0;return`translate(${mt},${Mt})`});ot.append("rect").attr("width",K=>{const mt=K.x0||0,Mt=K.x1||0;return Math.max(0,Mt-mt)}).attr("height",K=>{const mt=K.y0||0,Mt=K.y1||0;return Math.max(0,Mt-mt)}).attr("fill",K=>P(K.data.name)).attr("stroke","white").attr("stroke-width",2).style("opacity",.7).style("cursor","pointer").on("click",(K,mt)=>{st(mt)}).on("mouseover",function(K,mt){q(K,mt)}).on("mousemove",function(K,mt){q(K,mt)}).on("mouseout",function(){it()}).attr("title",a).append("title").text(()=>a),ot.append("text").attr("x",5).attr("y",15).attr("font-size","var(--font-size-sm)").attr("font-weight","bold").attr("fill","white").text(K=>`${K.data.name} (${K.data.itemCount||0} ${l})`).style("pointer-events","none").each(function(K){const mt=_t(this),Mt=this.getComputedTextLength(),ee=K.x1-K.x0-10;Mt>ee&&mt.text(K.data.name).append("title").text(`${K.data.name} (${K.data.itemCount||0} ${l})`)});const X=ut.selectAll(".item-set").data(W?vt.children||[]:vt.leaves()).enter().append("g").attr("class","item-set").attr("transform",K=>{const mt=K.x0||0,Mt=K.y0||0;return`translate(${mt},${Mt})`});X.append("rect").attr("width",K=>{const mt=K.x0||0,Mt=K.x1||0;return Math.max(0,Mt-mt)}).attr("height",K=>{const mt=K.y0||0,Mt=K.y1||0;return Math.max(0,Mt-mt)}).attr("fill",K=>{var ee,Ft;const mt=P(W?W.data.name:((Ft=(ee=K.parent)==null?void 0:ee.data)==null?void 0:Ft.name)||"Unknown"),Mt=ve(mt);return ve(Mt).brighter(.7).toString()}).attr("stroke","white").attr("stroke-width",.5).style("cursor","pointer").on("mouseover",function(K,mt){_t(this).attr("stroke","var(--primary-color)").attr("stroke-width",2),q(K,mt)}).on("mousemove",function(K,mt){q(K,mt)}).on("mouseout",function(){_t(this).attr("stroke","white").attr("stroke-width",.5),it()}),X.append("text").attr("x",3).attr("y",13).attr("font-size","var(--font-size-xs)").attr("fill","var(--text-color-primary)").style("pointer-events","none").each(function(K){const mt=_t(this),Mt=K.x1-K.x0,ee=K.y1-K.y0;if(Mt<30||ee<20)return;let Ft=K.data.name;const Cn=Mt-6,zn=W?W.data.name:K.parent?K.parent.data.name:"";mt.text(Ft).append("title").text(`${zn} > ${K.data.name}: ${K.data.itemCount||K.value||0} ${l}`);const Qe=this;let ui=Qe.getComputedTextLength(),ci=!1;for(;ui>Cn&&Ft.length>3;)Ft=Ft.slice(0,-1),mt.text(Ft),ui=Qe.getComputedTextLength(),ci=!0;ci&&mt.text(Ft+"...")})}catch(A){console.error("Error in updateVisualization:",A)}}function L(){y&&document.body.contains(y)&&document.body.removeChild(y);try{y=document.createElement("div"),y.style.position="absolute",y.style.backgroundColor="rgba(0, 0, 0, 0.8)",y.style.color="white",y.style.padding="8px 12px",y.style.borderRadius="4px",y.style.pointerEvents="none",y.style.display="none",y.style.fontSize="12px",y.style.zIndex="1000",y.style.boxShadow="0 2px 5px rgba(0,0,0,0.2)",y.style.maxWidth="250px",y.style.whiteSpace="nowrap",document&&document.body&&document.body.appendChild(y)}catch(A){console.error("Error creating tooltip:",A)}}function q(A,N){var et;(!y||!document.body.contains(y))&&L();try{const pt=N.parent===C,O=!pt;if(pt){const ot=N.data.name,X=N.data.itemCount||N.value||0,K=((et=N.children)==null?void 0:et.length)||0,mt=M>0?(X/M*100).toFixed(1)+"%":"N/A";y.innerHTML=`
                    <div style="font-weight:bold;margin-bottom:4px;border-bottom:1px solid rgba(255,255,255,0.3);padding-bottom:2px;">
                        ${ot}
                    </div>
                    <div style="display:grid;grid-template-columns:auto auto;gap:4px;">
                        <span>${l}:</span>
                        <span style="text-align:right;font-weight:bold">${X}</span>
                        <span>${c}:</span>
                        <span style="text-align:right">${K}</span>
                        <span>${i}:</span>
                        <span style="text-align:right">${mt}</span>
                    </div>
                    <div style="margin-top:4px;font-style:italic;font-size:10px;">
                        ${a}
                    </div>
                `}else{const ot=W?W.data.name:N.parent?N.parent.data.name:"",X=N.data.name,K=N.data.itemCount||N.value||0,mt=M,Mt=W?W.data.itemCount:N.parent?N.parent.data.itemCount:0,ee=Mt&&Mt>0?(K/Mt*100).toFixed(1)+"%":"N/A",Ft=mt>0?(K/mt*100).toFixed(1)+"%":"N/A";y.innerHTML=`
                    <div style="font-weight:bold;margin-bottom:4px;border-bottom:1px solid rgba(255,255,255,0.3);padding-bottom:2px;">
                        ${ot} > ${X}
                    </div>
                    <div style="display:grid;grid-template-columns:auto auto;gap:4px;">
                        <span>${l}:</span>
                        <span style="text-align:right;font-weight:bold">${K}</span>
                        <span>${o}:</span>
                        <span style="text-align:right">${ee}</span>
                        <span>${i}:</span>
                        <span style="text-align:right">${Ft}</span>
                    </div>
                `}const ut=250,bt=120;let vt=A.pageX+10,P=A.pageY+10;vt+ut>window.innerWidth&&(vt=A.pageX-ut-10),P+bt>window.innerHeight&&(P=A.pageY-bt-10),y.style.left=`${vt}px`,y.style.top=`${P}px`,y.style.display="block"}catch(pt){console.error("Error showing tooltip:",pt)}}function it(){try{y&&document.body.contains(y)&&(y.style.display="none")}catch(A){console.error("Error hiding tooltip:",A)}}_e(()=>{try{return Te().then(()=>{if(!m){console.error("Container element not found in onMount");return}L(),r.items&&r.items.length>0?(E=rt(r.items),v()):It.loadItems(),D=new ResizeObserver(()=>{m&&v()}),m?D.observe(m):console.error("Container element not available for ResizeObserver")}),()=>{try{D&&D.disconnect(),m&&_t(m).selectAll("*").remove(),y&&document.body.contains(y)&&document.body.removeChild(y)}catch(A){console.error("Error during cleanup:",A)}}}catch(A){return console.error("Error in onMount:",A),()=>{}}});function U(A){fe[A?"unshift":"push"](()=>{m=A,n(0,m)})}return t.$$.update=()=>{t.$$.dirty[0]&2&&console.log("Title HTML updated:",I),t.$$.dirty[0]&12&&r.items&&r.items.length>0&&!M&&(E=rt(r.items)),t.$$.dirty[0]&9&&r.items&&m&&v()},R(),[m,I,M,r,S,Y,W,a,c,u,f,h,g,x,_,$,Z,B,ct,nt,dt,Ct,J,V,F,G,at,lt,xt,U]}class bp extends Jt{constructor(e){super(),Qt(this,e,_p,yp,Vt,{},null,[-1,-1])}}function po(t,e,n){const r=t.slice();return r[42]=e[n],r}function go(t,e,n){const r=t.slice();return r[42]=e[n],r}function mo(t,e){let n,r=e[42].label+"",i,o,l=e[13](e[42].count)+"",a,c,s;return{key:t,first:null,c(){n=z("option"),i=H(r),o=H(" ("),a=H(l),c=H(")"),n.__value=s=e[42].value,n.value=n.__value,this.first=n},m(u,d){Q(u,n,d),p(n,i),p(n,o),p(n,a),p(n,c)},p(u,d){e=u,d[0]&32&&r!==(r=e[42].label+"")&&tt(i,r),d[0]&32&&l!==(l=e[13](e[42].count)+"")&&tt(a,l),d[0]&32&&s!==(s=e[42].value)&&(n.__value=s,n.value=n.__value)},d(u){u&&j(n)}}}function yo(t,e){let n,r=e[42].label+"",i,o,l=e[13](e[42].count)+"",a,c,s;return{key:t,first:null,c(){n=z("option"),i=H(r),o=H(" ("),a=H(l),c=H(")"),n.__value=s=e[42].value,n.value=n.__value,this.first=n},m(u,d){Q(u,n,d),p(n,i),p(n,o),p(n,a),p(n,c)},p(u,d){e=u,d[0]&64&&r!==(r=e[42].label+"")&&tt(i,r),d[0]&64&&l!==(l=e[13](e[42].count)+"")&&tt(a,l),d[0]&64&&s!==(s=e[42].value)&&(n.__value=s,n.value=n.__value)},d(u){u&&j(n)}}}function vo(t){let e,n=wt("viz.showing_items",[t[13](t[7]),t[4].length.toString()])+"",r;return{c(){e=z("span"),r=H(n)},m(i,o){Q(i,e,o),p(e,r)},p(i,o){o[0]&144&&n!==(n=wt("viz.showing_items",[i[13](i[7]),i[4].length.toString()])+"")&&tt(r,n)},d(i){i&&j(e)}}}function wp(t){let e,n=t[1].error+"",r;return{c(){e=z("div"),r=H(n),k(e,"class","error svelte-1ci7ag1")},m(i,o){Q(i,e,o),p(e,r)},p(i,o){o[0]&2&&n!==(n=i[1].error+"")&&tt(r,n)},d(i){i&&j(e)}}}function xp(t){let e;return{c(){e=z("div"),e.textContent=`${wt("ui.loading")}`,k(e,"class","loading svelte-1ci7ag1")},m(n,r){Q(n,e,r)},p:Tt,d(n){n&&j(e)}}}function kp(t){let e,n,r,i,o,l,a,c=[],s=new Map,u,d,f,h,g,x,_,T=[],b=new Map,m,y,E,C,w,I,M,S,Y,W,D=wt("viz.total_items")+"",$,Z,B,ct,nt,dt,Ct=wt("viz.languages")+"",J,V,F,G=t[4].length+"",at,lt,xt,ft=t[5];const R=U=>U[42].value;for(let U=0;U<ft.length;U+=1){let A=go(t,ft,U),N=R(A);s.set(N,c[U]=mo(N,A))}let rt=t[6];const st=U=>U[42].value;for(let U=0;U<rt.length;U+=1){let A=po(t,rt,U),N=st(A);b.set(N,T[U]=yo(N,A))}let v=t[4].length>0&&vo(t);function L(U,A){if(U[1].loading)return xp;if(U[1].error)return wp}let q=L(t),it=q&&q(t);return{c(){e=z("div"),n=z("div"),r=z("label"),i=H(t[9]),o=H(":"),l=ht(),a=z("select");for(let U=0;U<c.length;U+=1)c[U].c();u=ht(),d=z("div"),f=z("label"),h=H(t[10]),g=H(":"),x=ht(),_=z("select");for(let U=0;U<T.length;U+=1)T[U].c();m=ht(),y=z("div"),v&&v.c(),E=ht(),C=z("div"),it&&it.c(),w=ht(),I=z("div"),M=z("div"),S=z("h3"),S.textContent=`${wt("viz.summary")}`,Y=ht(),W=z("p"),$=H(D),Z=H(": "),B=z("strong"),ct=H(t[7]),nt=ht(),dt=z("p"),J=H(Ct),V=H(": "),F=z("strong"),at=H(G),k(r,"for","country-filter"),k(r,"class","svelte-1ci7ag1"),k(a,"id","country-filter"),k(a,"class","svelte-1ci7ag1"),t[2]===void 0&&Ce(()=>t[17].call(a)),k(n,"class","filter-group svelte-1ci7ag1"),k(f,"for","type-filter"),k(f,"class","svelte-1ci7ag1"),k(_,"id","type-filter"),k(_,"class","svelte-1ci7ag1"),t[3]===void 0&&Ce(()=>t[18].call(_)),k(d,"class","filter-group svelte-1ci7ag1"),k(y,"class","summary svelte-1ci7ag1"),k(e,"class","filters svelte-1ci7ag1"),k(C,"class","pie-container svelte-1ci7ag1"),k(S,"class","svelte-1ci7ag1"),k(W,"class","svelte-1ci7ag1"),k(dt,"class","svelte-1ci7ag1"),k(M,"class","stat-summary svelte-1ci7ag1"),k(I,"class","stats svelte-1ci7ag1")},m(U,A){Q(U,e,A),p(e,n),p(n,r),p(r,i),p(r,o),p(n,l),p(n,a);for(let N=0;N<c.length;N+=1)c[N]&&c[N].m(a,null);ge(a,t[2],!0),p(e,u),p(e,d),p(d,f),p(f,h),p(f,g),p(d,x),p(d,_);for(let N=0;N<T.length;N+=1)T[N]&&T[N].m(_,null);ge(_,t[3],!0),p(e,m),p(e,y),v&&v.m(y,null),Q(U,E,A),Q(U,C,A),it&&it.m(C,null),t[19](C),Q(U,w,A),Q(U,I,A),p(I,M),p(M,S),p(M,Y),p(M,W),p(W,$),p(W,Z),p(W,B),p(B,ct),p(M,nt),p(M,dt),p(dt,J),p(dt,V),p(dt,F),p(F,at),lt||(xt=[Ut(a,"change",t[14]),Ut(a,"change",t[17]),Ut(_,"change",t[15]),Ut(_,"change",t[18])],lt=!0)},p(U,A){A[0]&512&&tt(i,U[9]),A[0]&8224&&(ft=U[5],c=mi(c,A,R,1,U,ft,s,a,gi,mo,null,go)),A[0]&36&&ge(a,U[2]),A[0]&1024&&tt(h,U[10]),A[0]&8256&&(rt=U[6],T=mi(T,A,st,1,U,rt,b,_,gi,yo,null,po)),A[0]&72&&ge(_,U[3]),U[4].length>0?v?v.p(U,A):(v=vo(U),v.c(),v.m(y,null)):v&&(v.d(1),v=null),q===(q=L(U))&&it?it.p(U,A):(it&&it.d(1),it=q&&q(U),it&&(it.c(),it.m(C,null))),A[0]&128&&tt(ct,U[7]),A[0]&16&&G!==(G=U[4].length+"")&&tt(at,G)},d(U){U&&j(e);for(let A=0;A<c.length;A+=1)c[A].d();for(let A=0;A<T.length;A+=1)T[A].d();v&&v.d(),U&&j(E),U&&j(C),it&&it.d(),t[19](null),U&&j(w),U&&j(I),lt=!1,Ot(xt)}}}function Tp(t){let e,n,r;return n=new si({props:{title:"",translationKey:"",description:"",descriptionTranslationKey:"viz.language_distribution_description",titleHtml:t[8],$$slots:{default:[kp]},$$scope:{ctx:t}}}),{c(){e=z("div"),Xt(n.$$.fragment),k(e,"class","language-visualization-container svelte-1ci7ag1")},m(i,o){Q(i,e,o),Pt(n,e,null),r=!0},p(i,o){const l={};o[0]&256&&(l.titleHtml=i[8]),o[0]&1791|o[1]&65536&&(l.$$scope={dirty:o,ctx:i}),n.$set(l)},i(i){r||(St(n.$$.fragment,i),r=!0)},o(i){$t(n.$$.fragment,i),r=!1},d(i){i&&j(e),Bt(n)}}}function Cp(t,e,n){let r,i,o,l;yt(t,It,F=>n(1,r=F)),yt(t,Yt,F=>n(16,i=F));let a="all",c="all",s=[],u=[],d=[],f=0,h="en",g="",x=0,_=0,T,b,m;const y=Se(Tn);gt("viz.all_countries"),gt("viz.all_types");const E=gt("viz.filter_by_country");yt(t,E,F=>n(9,o=F));const C=gt("viz.filter_by_type");yt(t,C,F=>n(10,l=F)),gt("viz.no_data"),gt("viz.showing_items"),gt("viz.items"),gt("viz.percent_of_total");function w(F){return F.toLocaleString(h==="fr"?"fr-FR":"en-US")}function I(F){const G=w(F);return wt("viz.language_distribution_items",[G])}function M(){f>0?n(8,g=I(f)):n(8,g=wt("viz.language_distribution_title")),console.log("Language Distribution Title updated:",g)}Yt.subscribe(F=>{console.log("Language changed to:",F),h=F,M(),Y(),m&&s.length>0&&B(s),T&&ct()});function S(){if(!r.items||r.items.length===0)return;let F=r.items.filter(lt=>!(!lt.language||a!=="all"&&lt.country!==a||c!=="all"&&lt.type!==c));n(7,f=F.length),M(),console.log(`Processed ${f} items with language data`);const G=Be(F,lt=>lt.length,lt=>lt.language||"Unknown");return Array.from(G,([lt,xt])=>({language:lt,count:xt,percentage:xt/f*100})).sort((lt,xt)=>xt.count-lt.count)}function Y(){if(!r.items||r.items.length===0)return;const F=r.items.filter(ft=>ft.language),G=Be(F,ft=>ft.length,ft=>ft.country||"Unknown"),at=wt("viz.all_countries"),lt=wt("viz.all_types");n(5,u=[{value:"all",label:at,count:F.length},...Array.from(G,([ft,R])=>{if(ft==="Unknown")return null;const rt=wt(`country.${ft}`)||ft;return{value:ft,label:rt,count:R}}).filter(ft=>ft!==null).sort((ft,R)=>R.count-ft.count)]);const xt=Be(F,ft=>ft.length,ft=>ft.type||"Unknown");n(6,d=[{value:"all",label:lt,count:F.length},...Array.from(xt,([ft,R])=>({value:ft,label:ft,count:R})).sort((ft,R)=>R.count-ft.count)])}function W(){b=document.createElement("div"),b.style.position="absolute",b.style.backgroundColor="rgba(0, 0, 0, 0.8)",b.style.color="white",b.style.padding="8px 12px",b.style.borderRadius="4px",b.style.pointerEvents="none",b.style.display="none",b.style.fontSize="12px",b.style.zIndex="1000",b.style.boxShadow="0 2px 5px rgba(0,0,0,0.2)",document&&document.body&&document.body.appendChild(b)}function D(F,G){if(!b)return;const at=G.data,lt=wt(`lang.${at.language}`)||at.language;b.innerHTML=`
            <div style="font-weight:bold;margin-bottom:4px;border-bottom:1px solid rgba(255,255,255,0.3);padding-bottom:2px;">
                ${lt}
            </div>
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:4px;">
                <span>${wt("viz.items")}:</span><span style="text-align:right;font-weight:bold;">${w(at.count)}</span>
                <span>${wt("viz.percent_of_total")}:</span><span style="text-align:right;font-weight:bold;">${at.percentage.toFixed(2)}%</span>
            </div>
        `;const xt=200,ft=100;let R=F.pageX+10,rt=F.pageY+10;R+xt>window.innerWidth&&(R=F.pageX-xt-10),rt+ft>window.innerHeight&&(rt=F.pageY-ft-10),b.style.left=`${R}px`,b.style.top=`${rt}px`,b.style.display="block"}function $(){b&&(b.style.display="none")}function Z(){m?m.innerHTML="":(m=document.createElement("div"),m.style.position="absolute",m.style.right="20px",m.style.top="20px",m.style.backgroundColor="rgba(255, 255, 255, 0.9)",m.style.padding="10px",m.style.borderRadius="4px",m.style.boxShadow="0 2px 4px rgba(0,0,0,0.1)",m.style.maxHeight="300px",m.style.overflowY="auto",m.style.color="var(--text-color-primary)",m.style.fontFamily="var(--font-family-primary)",m.style.fontSize="var(--font-size-sm)",T.appendChild(m))}function B(F){m&&(m.innerHTML=`
            <div style="font-weight:bold;margin-bottom:8px;font-size:14px;color:var(--text-color-primary);">${wt("viz.languages")} (${F.length})</div>
            <div style="display:grid;grid-template-columns:20px auto 40px;gap:4px;font-size:12px;">
                ${F.map((G,at)=>{const lt=wt(`lang.${G.language}`)||G.language;return`
                        <div style="width:12px;height:12px;background-color:${y(G.language)};border-radius:2px;margin-top:2px;"></div>
                        <div style="white-space:nowrap;overflow:hidden;text-overflow:ellipsis;color:var(--text-color-primary);">${lt}</div>
                        <div style="text-align:right;color:var(--text-color-secondary);">${w(G.count)}</div>
                    `}).join("")}
            </div>
        `)}function ct(){if(!T)return;const F=S();if(n(4,s=F||[]),!F||F.length===0){_t(T).select("svg").remove();return}_t(T).select("svg").remove();const G=T.getBoundingClientRect();x=G.width,_=G.height;const at={top:20,right:20,bottom:20,left:20},lt=x-at.left-at.right,xt=_-at.top-at.bottom,ft=Math.min(lt,xt)/2,R=_t(T).append("svg").attr("width",x).attr("height",_).append("g").attr("transform",`translate(${x/2}, ${_/2})`),rt=Kh().value(L=>L.count).sort(null),st=to().innerRadius(0).outerRadius(ft),v=to().innerRadius(0).outerRadius(ft+10);R.selectAll("path").data(rt(F)).enter().append("path").attr("d",st).attr("fill",L=>y(L.data.language)).attr("stroke","white").attr("stroke-width",2).on("mouseenter",function(L,q){_t(this).transition().duration(200).attr("d",it=>v(it)),D(L,q)}).on("mousemove",function(L,q){D(L,q)}).on("mouseleave",function(L,q){_t(this).transition().duration(200).attr("d",it=>st(it)),$()}),Z(),B(F)}function nt(F){const G=F.target;n(2,a=G.value),ct()}function dt(F){const G=F.target;n(3,c=G.value),ct()}_e(async()=>{if(await Te(),!T){console.error("Container element not found");return}W(),r.items&&r.items.length>0?(Y(),ct()):It.loadItems();const F=new ResizeObserver(()=>{T&&ct()});return F.observe(T),()=>{F.disconnect(),b&&document.body.contains(b)&&document.body.removeChild(b),m&&m.parentNode&&m.parentNode.removeChild(m)}});function Ct(){a=di(this),n(2,a),n(5,u)}function J(){c=di(this),n(3,c),n(6,d)}function V(F){fe[F?"unshift":"push"](()=>{T=F,n(0,T)})}return t.$$.update=()=>{t.$$.dirty[0]&3&&r.items&&T&&(Y(),ct()),t.$$.dirty[0]&65538&&i&&r.items&&r.items.length>0&&Y()},M(),[T,r,a,c,s,u,d,f,g,o,l,E,C,w,nt,dt,i,Ct,J,V]}class zp extends Jt{constructor(e){super(),Qt(this,e,Cp,Tp,Vt,{},null,[-1,-1])}}function _o(t,e,n){const r=t.slice();return r[15]=e[n],r}function Mp(t){let e,n=t[1].error+"",r;return{c(){e=z("div"),r=H(n),k(e,"class","error svelte-18pj101")},m(i,o){Q(i,e,o),p(e,r)},p(i,o){o&2&&n!==(n=i[1].error+"")&&tt(r,n)},d(i){i&&j(e)}}}function Ap(t){let e;return{c(){e=z("div"),e.textContent="Loading...",k(e,"class","loading svelte-18pj101")},m(n,r){Q(n,e,r)},p:Tt,d(n){n&&j(e)}}}function bo(t){let e,n,r,i,o,l,a,c,s,u,d,f=t[2].length+"",h,g,x,_,T,b,m=t[2].slice(0,5),y=[];for(let E=0;E<m.length;E+=1)y[E]=wo(_o(t,m,E));return{c(){e=z("div"),n=z("h3"),n.textContent="Summary",r=ht(),i=z("p"),o=H("Total index items: "),l=z("strong"),a=H(t[3]),c=ht(),s=z("p"),u=H("Number of categories: "),d=z("strong"),h=H(f),g=ht(),x=z("div"),_=z("h3"),_.textContent="Top Categories",T=ht(),b=z("ul");for(let E=0;E<y.length;E+=1)y[E].c();k(n,"class","svelte-18pj101"),k(e,"class","stat-summary svelte-18pj101"),k(_,"class","svelte-18pj101"),k(b,"class","svelte-18pj101"),k(x,"class","top-categories svelte-18pj101")},m(E,C){Q(E,e,C),p(e,n),p(e,r),p(e,i),p(i,o),p(i,l),p(l,a),p(e,c),p(e,s),p(s,u),p(s,d),p(d,h),Q(E,g,C),Q(E,x,C),p(x,_),p(x,T),p(x,b);for(let w=0;w<y.length;w+=1)y[w]&&y[w].m(b,null)},p(E,C){if(C&8&&tt(a,E[3]),C&4&&f!==(f=E[2].length+"")&&tt(h,f),C&4){m=E[2].slice(0,5);let w;for(w=0;w<m.length;w+=1){const I=_o(E,m,w);y[w]?y[w].p(I,C):(y[w]=wo(I),y[w].c(),y[w].m(b,null))}for(;w<y.length;w+=1)y[w].d(1);y.length=m.length}},d(E){E&&j(e),E&&j(g),E&&j(x),Ve(y,E)}}}function wo(t){let e,n,r=t[15].category+"",i,o,l,a=t[15].count+"",c,s,u=t[15].percentage.toFixed(1)+"",d,f,h;return{c(){e=z("li"),n=z("span"),i=H(r),o=ht(),l=z("span"),c=H(a),s=H(" items ("),d=H(u),f=H("%)"),h=ht(),k(n,"class","category-name svelte-18pj101"),k(l,"class","category-count svelte-18pj101"),k(e,"class","svelte-18pj101")},m(g,x){Q(g,e,x),p(e,n),p(n,i),p(e,o),p(e,l),p(l,c),p(l,s),p(l,d),p(l,f),p(e,h)},p(g,x){x&4&&r!==(r=g[15].category+"")&&tt(i,r),x&4&&a!==(a=g[15].count+"")&&tt(c,a),x&4&&u!==(u=g[15].percentage.toFixed(1)+"")&&tt(d,u)},d(g){g&&j(e)}}}function Sp(t){let e,n,r,i;function o(s,u){if(s[1].loading)return Ap;if(s[1].error)return Mp}let l=o(t),a=l&&l(t),c=t[2].length>0&&bo(t);return{c(){e=z("div"),n=z("div"),a&&a.c(),r=ht(),i=z("div"),c&&c.c(),k(n,"class","chart-container svelte-18pj101"),k(i,"class","stats svelte-18pj101"),k(e,"class","index-visualization-container svelte-18pj101")},m(s,u){Q(s,e,u),p(e,n),a&&a.m(n,null),t[4](n),p(e,r),p(e,i),c&&c.m(i,null)},p(s,[u]){l===(l=o(s))&&a?a.p(s,u):(a&&a.d(1),a=l&&l(s),a&&(a.c(),a.m(n,null))),s[2].length>0?c?c.p(s,u):(c=bo(s),c.c(),c.m(i,null)):c&&(c.d(1),c=null)},i:Tt,o:Tt,d(s){s&&j(e),a&&a.d(),t[4](null),c&&c.d()}}}function $p(t,e,n){let r;yt(t,It,b=>n(1,r=b));let i=[],o=0,l=0,a=0,c=0,s,u;const d=Se(Tn);function f(){if(!r.items||r.items.length===0)return[];const b=r.items.filter(C=>C.type==="Notice d'autorité");if(n(3,o=b.length),o===0)return[];const m=Be(b,C=>C.length,C=>C.item_set_title||"Uncategorized"),E=Array.from(m,([C,w])=>({category:C,count:w,percentage:w/o*100})).sort((C,w)=>w.count-C.count);return l=Ue(E,C=>C.count)||0,E}function h(){try{u&&document.body.contains(u)&&document.body.removeChild(u),u=document.createElement("div"),u.style.position="absolute",u.style.backgroundColor="rgba(0, 0, 0, 0.8)",u.style.color="white",u.style.padding="8px 12px",u.style.borderRadius="4px",u.style.pointerEvents="none",u.style.display="none",u.style.fontSize="12px",u.style.zIndex="1000",u.style.boxShadow="0 2px 5px rgba(0,0,0,0.2)",document&&document.body&&document.body.appendChild(u)}catch(b){console.error("Error creating tooltip:",b)}}function g(b,m){try{if((!u||!document.body.contains(u))&&h(),!u)return;u.innerHTML=`
                <div style="font-weight:bold;margin-bottom:4px;border-bottom:1px solid rgba(255,255,255,0.3);padding-bottom:2px;">
                    ${m.category}
                </div>
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:4px;">
                    <span>Count:</span><span style="text-align:right;font-weight:bold;">${m.count}</span>
                    <span>Percentage:</span><span style="text-align:right;font-weight:bold;">${m.percentage.toFixed(2)}%</span>
                </div>
            `;const y=200,E=100;let C=b.pageX+10,w=b.pageY+10;C+y>window.innerWidth&&(C=b.pageX-y-10),w+E>window.innerHeight&&(w=b.pageY-E-10),u.style.left=`${C}px`,u.style.top=`${w}px`,u.style.display="block"}catch(y){console.error("Error showing tooltip:",y)}}function x(){try{u&&document.body.contains(u)&&(u.style.display="none")}catch(b){console.error("Error hiding tooltip:",b)}}function _(){try{if(!s)return;const b=f();if(!b||b.length===0){_t(s).select("svg").remove(),_t(s).append("div").attr("class","no-data").style("position","absolute").style("top","50%").style("left","50%").style("transform","translate(-50%, -50%)").style("text-align","center").style("color","var(--text-color-secondary)").text("No index items available");return}n(2,i=b),_t(s).select("svg").remove(),_t(s).select(".no-data").remove();const m=s.getBoundingClientRect();a=m.width,c=m.height-40;const y={top:60,right:30,bottom:120,left:60},E=a-y.left-y.right,C=c-y.top-y.bottom,w=_t(s).append("svg").attr("width",a).attr("height",c).attr("viewBox",`0 0 ${a} ${c}`),I=w.append("g").attr("transform",`translate(${y.left}, ${y.top})`),M=ni().domain(b.map(D=>D.category)).range([0,E]).padding(.2),S=yn().domain([0,l*1.1]).range([C,0]),Y=Wn(M);I.append("g").attr("class","x-axis").attr("transform",`translate(0, ${C})`).call(Y).selectAll("text").attr("transform","rotate(-45)").style("text-anchor","end").attr("dx","-.8em").attr("dy",".15em").style("font-size","var(--font-size-xs)").style("fill","var(--text-color-primary)");const W=Pn(S).ticks(5);I.append("g").attr("class","y-axis").call(W).selectAll("text").style("font-size","var(--font-size-xs)").style("fill","var(--text-color-primary)"),I.append("text").attr("class","x-axis-label").attr("text-anchor","middle").attr("x",E/2).attr("y",C+y.bottom-10).style("font-size","var(--font-size-sm)").style("fill","var(--text-color-secondary)").text("Categories"),I.append("text").attr("class","y-axis-label").attr("text-anchor","middle").attr("transform","rotate(-90)").attr("x",-C/2).attr("y",-y.left+15).style("font-size","var(--font-size-sm)").style("fill","var(--text-color-secondary)").text("Number of Items"),I.selectAll(".bar").data(b).enter().append("rect").attr("class","bar").attr("x",D=>M(D.category)||0).attr("y",D=>S(D.count)).attr("width",M.bandwidth()).attr("height",D=>C-S(D.count)).attr("fill",(D,$)=>d(D.category)).attr("rx",3).attr("ry",3).style("stroke","white").style("stroke-width",1).on("mouseenter",function(D,$){_t(this).transition().duration(200).attr("fill",ve(d($.category)).brighter(.5).toString()),g(D,$)}).on("mousemove",function(D,$){g(D,$)}).on("mouseleave",function(D,$){_t(this).transition().duration(200).attr("fill",d($.category)),x()}),I.selectAll(".bar-label").data(b).enter().append("text").attr("class","bar-label").attr("x",D=>(M(D.category)||0)+M.bandwidth()/2).attr("y",D=>S(D.count)-5).attr("text-anchor","middle").style("font-size","var(--font-size-xs)").style("fill","var(--text-color-secondary)").text(D=>D.count),w.append("text").attr("text-anchor","middle").attr("x",a/2).attr("y",30).attr("font-size","var(--font-size-lg)").attr("font-weight","bold").attr("fill","var(--text-color-primary)").text(`Index Distribution by Category (${o} items)`)}catch(b){console.error("Error creating bar chart:",b)}}_e(async()=>{try{if(await Te(),!s){console.error("Container element not found");return}h(),r.items&&r.items.length>0?_():It.loadItems();const b=new ResizeObserver(()=>{s&&_()});return b.observe(s),()=>{try{b&&b.disconnect(),s&&_t(s).selectAll("*").remove(),u&&document.body.contains(u)&&document.body.removeChild(u)}catch(m){console.error("Error during cleanup:",m)}}}catch(b){console.error("Error in onMount:",b)}});function T(b){fe[b?"unshift":"push"](()=>{s=b,n(0,s)})}return t.$$.update=()=>{t.$$.dirty&3&&r.items&&s&&_()},[s,r,i,o,T]}class Dp extends Jt{constructor(e){super(),Qt(this,e,$p,Sp,Vt,{})}}function xo(t,e,n){const r=t.slice();return r[52]=e[n],r}function ko(t,e,n){const r=t.slice();return r[55]=e[n],r}function To(t,e,n){const r=t.slice();return r[55]=e[n],r}function Co(t){let e,n=t[55].label+"",r,i,o=t[27](t[55].count)+"",l,a,c;return{c(){e=z("option"),r=H(n),i=H(" ("),l=H(o),a=H(")"),e.__value=c=t[55].value,e.value=e.__value},m(s,u){Q(s,e,u),p(e,r),p(e,i),p(e,l),p(e,a)},p(s,u){u[0]&32&&n!==(n=s[55].label+"")&&tt(r,n),u[0]&32&&o!==(o=s[27](s[55].count)+"")&&tt(l,o),u[0]&32&&c!==(c=s[55].value)&&(e.__value=c,e.value=e.__value)},d(s){s&&j(e)}}}function zo(t){let e,n=t[55].label+"",r,i,o=t[27](t[55].count)+"",l,a,c;return{c(){e=z("option"),r=H(n),i=H(" ("),l=H(o),a=H(")"),e.__value=c=t[55].value,e.value=e.__value},m(s,u){Q(s,e,u),p(e,r),p(e,i),p(e,l),p(e,a)},p(s,u){u[0]&64&&n!==(n=s[55].label+"")&&tt(r,n),u[0]&64&&o!==(o=s[27](s[55].count)+"")&&tt(l,o),u[0]&64&&c!==(c=s[55].value)&&(e.__value=c,e.value=e.__value)},d(s){s&&j(e)}}}function Mo(t){let e,n=t[11].replace("{0}",t[27](t[7])).replace("{1}",t[4].length.toString())+"",r;return{c(){e=z("span"),r=H(n)},m(i,o){Q(i,e,o),p(e,r)},p(i,o){o[0]&2192&&n!==(n=i[11].replace("{0}",i[27](i[7])).replace("{1}",i[4].length.toString())+"")&&tt(r,n)},d(i){i&&j(e)}}}function Np(t){let e,n=t[3].error+"",r;return{c(){e=z("div"),r=H(n),k(e,"class","error svelte-1ftjyys")},m(i,o){Q(i,e,o),p(e,r)},p(i,o){o[0]&8&&n!==(n=i[3].error+"")&&tt(r,n)},d(i){i&&j(e)}}}function Ep(t){let e;return{c(){e=z("div"),e.textContent=`${wt("ui.loading")}`,k(e,"class","loading svelte-1ftjyys")},m(n,r){Q(n,e,r)},p:Tt,d(n){n&&j(e)}}}function Ao(t){var Ct,J;let e,n,r,i,o,l,a,c,s=t[27](t[7])+"",u,d,f,h,g,x,_=(((Ct=t[4][0])==null?void 0:Ct.monthFormatted)||"")+"",T,b,m=(((J=t[4][t[4].length-1])==null?void 0:J.monthFormatted)||"")+"",y,E,C,w,I,M,S=t[27](Math.round(t[7]/(t[4].length||1)))+"",Y,W,D,$,Z,B,ct,nt=[...t[4]].sort($o).slice(0,3),dt=[];for(let V=0;V<nt.length;V+=1)dt[V]=So(xo(t,nt,V));return{c(){e=z("div"),n=z("h3"),r=H(t[12]),i=ht(),o=z("p"),l=H(t[13]),a=H(": "),c=z("strong"),u=H(s),d=ht(),f=z("p"),h=H(t[14]),g=H(": "),x=z("strong"),T=H(_),b=H(" to "),y=H(m),E=ht(),C=z("p"),w=H(t[15]),I=H(": "),M=z("strong"),Y=H(S),W=ht(),D=z("div"),$=z("h3"),Z=H(t[16]),B=ht(),ct=z("ul");for(let V=0;V<dt.length;V+=1)dt[V].c();k(n,"class","svelte-1ftjyys"),k(e,"class","stat-summary svelte-1ftjyys"),k($,"class","svelte-1ftjyys"),k(ct,"class","svelte-1ftjyys"),k(D,"class","peak-months svelte-1ftjyys")},m(V,F){Q(V,e,F),p(e,n),p(n,r),p(e,i),p(e,o),p(o,l),p(o,a),p(o,c),p(c,u),p(e,d),p(e,f),p(f,h),p(f,g),p(f,x),p(x,T),p(x,b),p(x,y),p(e,E),p(e,C),p(C,w),p(C,I),p(C,M),p(M,Y),Q(V,W,F),Q(V,D,F),p(D,$),p($,Z),p(D,B),p(D,ct);for(let G=0;G<dt.length;G+=1)dt[G]&&dt[G].m(ct,null)},p(V,F){var G,at;if(F[0]&4096&&tt(r,V[12]),F[0]&8192&&tt(l,V[13]),F[0]&128&&s!==(s=V[27](V[7])+"")&&tt(u,s),F[0]&16384&&tt(h,V[14]),F[0]&16&&_!==(_=(((G=V[4][0])==null?void 0:G.monthFormatted)||"")+"")&&tt(T,_),F[0]&16&&m!==(m=(((at=V[4][V[4].length-1])==null?void 0:at.monthFormatted)||"")+"")&&tt(y,m),F[0]&32768&&tt(w,V[15]),F[0]&144&&S!==(S=V[27](Math.round(V[7]/(V[4].length||1)))+"")&&tt(Y,S),F[0]&65536&&tt(Z,V[16]),F[0]&134348944){nt=[...V[4]].sort($o).slice(0,3);let lt;for(lt=0;lt<nt.length;lt+=1){const xt=xo(V,nt,lt);dt[lt]?dt[lt].p(xt,F):(dt[lt]=So(xt),dt[lt].c(),dt[lt].m(ct,null))}for(;lt<dt.length;lt+=1)dt[lt].d(1);dt.length=nt.length}},d(V){V&&j(e),V&&j(W),V&&j(D),Ve(dt,V)}}}function So(t){let e,n,r=t[52].monthFormatted+"",i,o,l,a=t[27](t[52].count)+"",c,s,u,d,f=(t[52].count/(t[7]||1)*100).toFixed(1)+"",h,g,x;return{c(){e=z("li"),n=z("span"),i=H(r),o=ht(),l=z("span"),c=H(a),s=ht(),u=H(t[17]),d=H(" ("),h=H(f),g=H("%)"),x=ht(),k(n,"class","month-name svelte-1ftjyys"),k(l,"class","month-count svelte-1ftjyys"),k(e,"class","svelte-1ftjyys")},m(_,T){Q(_,e,T),p(e,n),p(n,i),p(e,o),p(e,l),p(l,c),p(l,s),p(l,u),p(l,d),p(l,h),p(l,g),p(e,x)},p(_,T){T[0]&16&&r!==(r=_[52].monthFormatted+"")&&tt(i,r),T[0]&16&&a!==(a=_[27](_[52].count)+"")&&tt(c,a),T[0]&131072&&tt(u,_[17]),T[0]&144&&f!==(f=(_[52].count/(_[7]||1)*100).toFixed(1)+"")&&tt(h,f)},d(_){_&&j(e)}}}function Ip(t){let e,n,r,i,o,l,a,c,s,u,d,f,h,g,x,_,T,b,m,y,E,C,w=t[5],I=[];for(let B=0;B<w.length;B+=1)I[B]=Co(To(t,w,B));let M=t[6],S=[];for(let B=0;B<M.length;B+=1)S[B]=zo(ko(t,M,B));let Y=t[4].length>0&&Mo(t);function W(B,ct){if(B[3].loading)return Ep;if(B[3].error)return Np}let D=W(t),$=D&&D(t),Z=t[4].length>0&&Ao(t);return{c(){e=z("div"),n=z("div"),r=z("label"),i=H(t[9]),o=H(":"),l=ht(),a=z("select");for(let B=0;B<I.length;B+=1)I[B].c();c=ht(),s=z("div"),u=z("label"),d=H(t[10]),f=H(":"),h=ht(),g=z("select");for(let B=0;B<S.length;B+=1)S[B].c();x=ht(),_=z("div"),Y&&Y.c(),T=ht(),b=z("div"),$&&$.c(),m=ht(),y=z("div"),Z&&Z.c(),k(r,"for","country-filter"),k(r,"class","svelte-1ftjyys"),k(a,"id","country-filter"),k(a,"class","svelte-1ftjyys"),k(n,"class","filter-group svelte-1ftjyys"),k(u,"for","type-filter"),k(u,"class","svelte-1ftjyys"),k(g,"id","type-filter"),k(g,"class","svelte-1ftjyys"),k(s,"class","filter-group svelte-1ftjyys"),k(_,"class","summary svelte-1ftjyys"),k(e,"class","filters svelte-1ftjyys"),k(b,"class","chart-container svelte-1ftjyys"),k(y,"class","stats svelte-1ftjyys")},m(B,ct){Q(B,e,ct),p(e,n),p(n,r),p(r,i),p(r,o),p(n,l),p(n,a);for(let nt=0;nt<I.length;nt+=1)I[nt]&&I[nt].m(a,null);ge(a,t[0]),p(e,c),p(e,s),p(s,u),p(u,d),p(u,f),p(s,h),p(s,g);for(let nt=0;nt<S.length;nt+=1)S[nt]&&S[nt].m(g,null);ge(g,t[1]),p(e,x),p(e,_),Y&&Y.m(_,null),Q(B,T,ct),Q(B,b,ct),$&&$.m(b,null),t[31](b),Q(B,m,ct),Q(B,y,ct),Z&&Z.m(y,null),E||(C=[Ut(a,"change",t[28]),Ut(g,"change",t[29])],E=!0)},p(B,ct){if(ct[0]&512&&tt(i,B[9]),ct[0]&134217760){w=B[5];let nt;for(nt=0;nt<w.length;nt+=1){const dt=To(B,w,nt);I[nt]?I[nt].p(dt,ct):(I[nt]=Co(dt),I[nt].c(),I[nt].m(a,null))}for(;nt<I.length;nt+=1)I[nt].d(1);I.length=w.length}if(ct[0]&33&&ge(a,B[0]),ct[0]&1024&&tt(d,B[10]),ct[0]&134217792){M=B[6];let nt;for(nt=0;nt<M.length;nt+=1){const dt=ko(B,M,nt);S[nt]?S[nt].p(dt,ct):(S[nt]=zo(dt),S[nt].c(),S[nt].m(g,null))}for(;nt<S.length;nt+=1)S[nt].d(1);S.length=M.length}ct[0]&66&&ge(g,B[1]),B[4].length>0?Y?Y.p(B,ct):(Y=Mo(B),Y.c(),Y.m(_,null)):Y&&(Y.d(1),Y=null),D===(D=W(B))&&$?$.p(B,ct):($&&$.d(1),$=D&&D(B),$&&($.c(),$.m(b,null))),B[4].length>0?Z?Z.p(B,ct):(Z=Ao(B),Z.c(),Z.m(y,null)):Z&&(Z.d(1),Z=null)},d(B){B&&j(e),Ve(I,B),Ve(S,B),Y&&Y.d(),B&&j(T),B&&j(b),$&&$.d(),t[31](null),B&&j(m),B&&j(y),Z&&Z.d(),E=!1,Ot(C)}}}function Lp(t){let e,n,r;return n=new si({props:{title:"Timeline Distribution",titleHtml:t[8],descriptionTranslationKey:Up,$$slots:{default:[Ip]},$$scope:{ctx:t}}}),{c(){e=z("div"),Xt(n.$$.fragment),k(e,"class","timeline-visualization-container svelte-1ftjyys")},m(i,o){Q(i,e,o),Pt(n,e,null),r=!0},p(i,o){const l={};o[0]&256&&(l.titleHtml=i[8]),o[0]&261887|o[1]&536870912&&(l.$$scope={dirty:o,ctx:i}),n.$set(l)},i(i){r||(St(n.$$.fragment,i),r=!0)},o(i){$t(n.$$.fragment,i),r=!1},d(i){i&&j(e),Bt(n)}}}const Up="viz.timeline_distribution_description",$o=(t,e)=>e.count-t.count;function Fp(t,e,n){let r,i,o,l,a,c,s,u,d,f,h;yt(t,It,L=>n(3,r=L)),yt(t,Yt,L=>n(30,i=L));let g="all",x="all",_=[],T=[],b=[],m=0,y="en",E="",C=0,w=0,I,M;const S=Re("%Y-%m"),Y=Re("%b %Y"),W=gt("viz.filter_by_country");yt(t,W,L=>n(9,o=L));const D=gt("viz.filter_by_type");yt(t,D,L=>n(10,l=L)),gt("viz.no_data");const $=gt("viz.summary");yt(t,$,L=>n(12,c=L));const Z=gt("viz.total_items");yt(t,Z,L=>n(13,s=L));const B=gt("viz.time_period");yt(t,B,L=>n(14,u=L));const ct=gt("viz.avg_monthly_additions");yt(t,ct,L=>n(15,d=L));const nt=gt("viz.peak_growth_months");yt(t,nt,L=>n(16,f=L));const dt=gt("viz.showing_items_over_months");yt(t,dt,L=>n(11,a=L));const Ct=gt("viz.items");yt(t,Ct,L=>n(17,h=L)),gt("viz.timeline_distribution_items"),gt("viz.monthly_additions"),gt("viz.month");function J(L){return L.toLocaleString(y==="fr"?"fr-FR":"en-US")}function V(){if(m>0){const L=J(m);return wt("viz.timeline_distribution_items",[L])}else return wt("viz.timeline_distribution_title")}function F(){console.log("[TimelineDistribution] Updating title with count:",m),n(8,E=V())}Yt.subscribe(L=>{console.log("[TimelineDistribution] Language changed to:",L),y=L,at(),I&&R()});function G(){if(!r.items||r.items.length===0)return[];const L=new Date(2024,3,1);let q=0;const it=O=>!(!O.created_date||g!=="all"&&O.country!==g||x!=="all"&&O.type!==x);q=r.items.filter(O=>it(O)?new Date(O.created_date)<L:!1).length;let A=r.items.filter(O=>it(O)?new Date(O.created_date)>=L:!1);if(n(7,m=q+A.length),A.length===0)return[];const N=new Map;A.forEach(O=>{const ut=new Date(O.created_date),bt=S(ut);N.set(bt,(N.get(bt)||0)+1)});const et=Array.from(N.entries()).map(([O,ut])=>{const[bt,vt]=O.split("-").map(Number),P=new Date(bt,vt-1,1);return{date:P,month:O,monthFormatted:Y(P),count:ut,total:0,percentage:0}}).sort((O,ut)=>O.date.getTime()-ut.date.getTime());let pt=q;return et.forEach(O=>{pt+=O.count,O.total=pt,O.percentage=O.count/A.length*100}),Ue(et,O=>O.count),Ue(et,O=>O.total),et}function at(){if(!r.items||r.items.length===0)return;const L=new Date(2024,3,1),q=r.items.filter(A=>A.created_date?new Date(A.created_date)>=L:!1),it=Be(q,A=>A.length,A=>A.country||"Unknown");n(5,T=[{value:"all",label:wt("country.all"),count:q.length},...Array.from(it,([A,N])=>({value:A,label:wt(`country.${A}`),count:N})).filter(A=>A.value!=="Unknown").sort((A,N)=>N.count-A.count)]);const U=Be(q,A=>A.length,A=>A.type||"Unknown");n(6,b=[{value:"all",label:wt("type.all"),count:q.length},...Array.from(U,([A,N])=>({value:A,label:wt(`type.${A}`),count:N})).filter(A=>A.value!=="Unknown").sort((A,N)=>N.count-A.count)])}function lt(){try{M&&document.body.contains(M)&&document.body.removeChild(M),M=document.createElement("div"),M.style.position="absolute",M.style.backgroundColor="rgba(0, 0, 0, 0.8)",M.style.color="white",M.style.padding="8px 12px",M.style.borderRadius="4px",M.style.pointerEvents="none",M.style.display="none",M.style.fontSize="12px",M.style.zIndex="1000",M.style.boxShadow="0 2px 5px rgba(0,0,0,0.2)",document&&document.body&&document.body.appendChild(M)}catch(L){console.error("Error creating tooltip:",L)}}function xt(L,q,it){try{if((!M||!document.body.contains(M))&&lt(),!M)return;const U=q.date.toLocaleString("default",{month:"long"}),A=q.date.getFullYear();it==="monthly"?M.innerHTML=`
                    <div style="font-weight:bold;margin-bottom:4px;border-bottom:1px solid rgba(255,255,255,0.3);padding-bottom:2px;">
                        ${U} ${A}
                    </div>
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:4px;">
                        <span>New Items:</span><span style="text-align:right;font-weight:bold;">${q.count}</span>
                        <span>Percentage:</span><span style="text-align:right;font-weight:bold;">${q.percentage.toFixed(2)}%</span>
                    </div>
                `:M.innerHTML=`
                    <div style="font-weight:bold;margin-bottom:4px;border-bottom:1px solid rgba(255,255,255,0.3);padding-bottom:2px;">
                        ${U} ${A}
                    </div>
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:4px;">
                        <span>Total Items:</span><span style="text-align:right;font-weight:bold;">${q.total}</span>
                    </div>
                `;const N=200,et=100;let pt=L.pageX+10,O=L.pageY+10;pt+N>window.innerWidth&&(pt=L.pageX-N-10),O+et>window.innerHeight&&(O=L.pageY-et-10),M.style.left=`${pt}px`,M.style.top=`${O}px`,M.style.display="block"}catch(U){console.error("Error showing tooltip:",U)}}function ft(){try{M&&document.body.contains(M)&&(M.style.display="none")}catch(L){console.error("Error hiding tooltip:",L)}}function R(){if(!I){console.error("[TimelineDistribution] Container element not found in createTimeline");return}const L=G();if(!L||L.length===0){_t(I).select("svg").remove(),_t(I).append("div").attr("class","no-data").style("position","absolute").style("top","50%").style("left","50%").style("transform","translate(-50%, -50%)").style("text-align","center").style("color","var(--text-color-secondary)").text("No timeline data available with the current filters");return}n(4,_=L),_t(I).select("svg").remove(),_t(I).select(".no-data").remove();const q=I.getBoundingClientRect();C=q.width,w=q.height-50;const it=_t(I).append("svg").attr("width",C).attr("height",w).attr("viewBox",`0 0 ${C} ${w}`),U={top:30,right:60,bottom:50,left:70},A=C-U.left-U.right,N=(w-U.top-U.bottom-50)/2,et=Eh().domain(Fa(L,X=>X.date)).range([0,A]);it.append("line").attr("x1",U.left).attr("y1",U.top+N+25).attr("x2",C-U.right).attr("y2",U.top+N+25).attr("stroke","var(--divider-color)").attr("stroke-width",1).attr("stroke-dasharray","3,3");const pt=it.append("g").attr("transform",`translate(${C-U.right}, ${U.top-10})`);pt.append("line").attr("x1",-100).attr("y1",0).attr("x2",-80).attr("y2",0).attr("stroke","var(--primary-color)").attr("stroke-width",2).attr("marker-end","url(#circle)"),pt.append("text").attr("x",-75).attr("y",4).attr("fill","var(--text-color-primary)").attr("font-size","var(--font-size-sm)").text(wt("viz.monthly_additions")),pt.append("line").attr("x1",-100).attr("y1",20).attr("x2",-80).attr("y2",20).attr("stroke","var(--secondary-color)").attr("stroke-width",2).attr("stroke-dasharray","4 2"),pt.append("text").attr("x",-75).attr("y",24).attr("fill","var(--text-color-primary)").attr("font-size","var(--font-size-sm)").text(wt("viz.total_items")),it.append("defs").append("marker").attr("id","circle").attr("viewBox","-5 -5 10 10").attr("refX",0).attr("refY",0).attr("markerWidth",5).attr("markerHeight",5).append("circle").attr("r",3).attr("fill","var(--primary-color)");const O=it.append("g").attr("transform",`translate(${U.left}, ${U.top})`),ut=yn().domain([0,(Ue(L,X=>X.count)||0)*1.1]).range([N,0]);O.append("g").attr("class","grid").selectAll("line").data(ut.ticks(5)).enter().append("line").attr("x1",0).attr("x2",A).attr("y1",X=>ut(X)).attr("y2",X=>ut(X)).attr("stroke","var(--divider-color)").attr("stroke-width",.5),O.append("g").attr("class","x-axis").attr("transform",`translate(0, ${N})`).call(Wn(et).ticks(vn.every(1)).tickFormat(Re("%Y-%m"))).selectAll("text").style("font-size","var(--font-size-xs)").style("fill","var(--text-color-primary)").style("text-anchor","end").attr("dx","-.8em").attr("dy",".15em").attr("transform","rotate(-45)"),O.append("g").attr("class","y-axis").call(Pn(ut).ticks(5)).selectAll("text").style("font-size","var(--font-size-xs)").style("fill","var(--text-color-primary)"),O.append("text").attr("class","axis-label").attr("transform","rotate(-90)").attr("y",-55).attr("x",-N/2).attr("text-anchor","middle").style("font-size","var(--font-size-sm)").style("fill","var(--text-color-secondary)").text(wt("viz.monthly_additions"));const bt=eo().x(X=>et(X.date)).y(X=>ut(X.count)).curve(oo);O.append("path").datum(L).attr("fill","none").attr("stroke","var(--primary-color)").attr("stroke-width",2).attr("d",bt),O.selectAll(".dot-monthly").data(L).enter().append("circle").attr("class","dot-monthly").attr("cx",X=>et(X.date)).attr("cy",X=>ut(X.count)).attr("r",4).attr("fill","var(--primary-color)").attr("stroke","white").attr("stroke-width",1).on("mouseenter",function(X,K){_t(this).transition().duration(200).attr("r",6),xt(X,K,"monthly")}).on("mousemove",function(X,K){xt(X,K,"monthly")}).on("mouseleave",function(){_t(this).transition().duration(200).attr("r",4),ft()});const vt=it.append("g").attr("transform",`translate(${U.left}, ${U.top+N+50})`),P=yn().domain([0,(Ue(L,X=>X.total)||0)*1.1]).range([N,0]);vt.append("g").attr("class","grid").selectAll("line").data(P.ticks(5)).enter().append("line").attr("x1",0).attr("x2",A).attr("y1",X=>P(X)).attr("y2",X=>P(X)).attr("stroke","var(--divider-color)").attr("stroke-width",.5),vt.append("g").attr("class","x-axis").attr("transform",`translate(0, ${N})`).call(Wn(et).ticks(vn.every(1)).tickFormat(Re("%Y-%m"))).selectAll("text").style("font-size","var(--font-size-xs)").style("fill","var(--text-color-primary)").style("text-anchor","end").attr("dx","-.8em").attr("dy",".15em").attr("transform","rotate(-45)"),vt.append("g").attr("class","y-axis").call(Pn(P).ticks(5)).selectAll("text").style("font-size","var(--font-size-xs)").style("fill","var(--text-color-primary)"),vt.append("text").attr("class","axis-label").attr("transform","rotate(-90)").attr("y",-55).attr("x",-N/2).attr("text-anchor","middle").style("font-size","var(--font-size-sm)").style("fill","var(--text-color-secondary)").text(wt("viz.total_items")),vt.append("text").attr("class","axis-label").attr("text-anchor","middle").attr("x",A/2).attr("y",N+50).style("font-size","var(--font-size-sm)").style("fill","var(--text-color-secondary)").text(wt("viz.month"));const ot=eo().x(X=>et(X.date)).y(X=>P(X.total)).curve(oo);vt.append("path").datum(L).attr("fill","none").attr("stroke","var(--secondary-color)").attr("stroke-width",2).attr("stroke-dasharray","4 2").attr("d",ot),vt.selectAll(".dot-total").data(L).enter().append("circle").attr("class","dot-total").attr("cx",X=>et(X.date)).attr("cy",X=>P(X.total)).attr("r",4).attr("fill","var(--secondary-color)").attr("stroke","white").attr("stroke-width",1).on("mouseenter",function(X,K){_t(this).transition().duration(200).attr("r",6),xt(X,K,"total")}).on("mousemove",function(X,K){xt(X,K,"total")}).on("mouseleave",function(){_t(this).transition().duration(200).attr("r",4),ft()})}function rt(L){const q=L.target;n(0,g=q.value),R()}function st(L){const q=L.target;n(1,x=q.value),R()}_e(async()=>{if(console.log("[TimelineDistribution] Component mounted"),await Te(),lt(),(!r.items||r.items.length===0)&&(console.log("[TimelineDistribution] No items loaded, waiting for data"),await It.loadItems()),await Te(),!I){console.error("[TimelineDistribution] Container element not found after waiting");return}console.log("[TimelineDistribution] Container found, generating visualization"),at(),R();const L=new ResizeObserver(()=>{I&&R()});return L.observe(I),()=>{L.disconnect(),M&&document.body.contains(M)&&document.body.removeChild(M)}});function v(L){fe[L?"unshift":"push"](()=>{I=L,n(2,I)})}return t.$$.update=()=>{t.$$.dirty[0]&11&&r.items&&r.items.length>0&&(console.log("[TimelineDistribution] Items loaded, updating title"),n(7,m=r.items.filter(L=>!(g!=="all"&&L.country!==g||x!=="all"&&L.type!==x)).length),F()),t.$$.dirty[0]&1073741824&&F(),t.$$.dirty[0]&12&&r.items&&I&&(at(),R())},[g,x,I,r,_,T,b,m,E,o,l,a,c,s,u,d,f,h,W,D,$,Z,B,ct,nt,dt,Ct,J,rt,st,i,v]}class Hp extends Jt{constructor(e){super(),Qt(this,e,Fp,Lp,Vt,{},null,[-1,-1])}}function Do(t,e,n){const r=t.slice();return r[37]=e[n],r}function No(t){let e,n;return{c(){e=dn("svg"),n=dn("path"),k(n,"fill","currentColor"),k(n,"d","M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"),k(e,"viewBox","0 0 24 24"),k(e,"width","14"),k(e,"height","14")},m(r,i){Q(r,e,i),p(e,n)},d(r){r&&j(e)}}}function Eo(t){let e,n,r,i,o=t[37].label+"",l,a,c,s=t[37].count+"",u,d,f,h,g,x=t[37].selected&&No();function _(){return t[13](t[37])}function T(...b){return t[14](t[37],...b)}return{c(){e=z("div"),n=z("span"),x&&x.c(),r=ht(),i=z("span"),l=H(o),a=ht(),c=z("span"),u=H(s),d=ht(),k(n,"class","facet-checkbox svelte-1w69s2v"),k(i,"class","facet-label svelte-1w69s2v"),k(c,"class","facet-count svelte-1w69s2v"),k(e,"class","facet-option svelte-1w69s2v"),k(e,"role","checkbox"),k(e,"aria-checked",f=t[37].selected),k(e,"tabindex","0"),ye(e,"selected",t[37].selected)},m(b,m){Q(b,e,m),p(e,n),x&&x.m(n,null),p(e,r),p(e,i),p(i,l),p(e,a),p(e,c),p(c,u),p(e,d),h||(g=[Ut(e,"click",_),Ut(e,"keydown",T)],h=!0)},p(b,m){t=b,t[37].selected?x||(x=No(),x.c(),x.m(n,null)):x&&(x.d(1),x=null),m[0]&2&&o!==(o=t[37].label+"")&&tt(l,o),m[0]&2&&s!==(s=t[37].count+"")&&tt(u,s),m[0]&2&&f!==(f=t[37].selected)&&k(e,"aria-checked",f),m[0]&2&&ye(e,"selected",t[37].selected)},d(b){b&&j(e),x&&x.d(),h=!1,Ot(g)}}}function Rp(t){let e,n=t[6].error+"",r;return{c(){e=z("div"),r=H(n),k(e,"class","error svelte-1w69s2v")},m(i,o){Q(i,e,o),p(e,r)},p(i,o){o[0]&64&&n!==(n=i[6].error+"")&&tt(r,n)},d(i){i&&j(e)}}}function Op(t){let e;return{c(){e=z("div"),e.textContent=`${wt("ui.loading")}`,k(e,"class","loading svelte-1w69s2v")},m(n,r){Q(n,e,r)},p:Tt,d(n){n&&j(e)}}}function Io(t){let e,n,r=Array.from(new Set(t[4].map(Lo))).join(", ")+"",i;return{c(){e=z("p"),n=H(`Types: \r
                    `),i=H(r),k(e,"class","svelte-1w69s2v")},m(o,l){Q(o,e,l),p(e,n),p(e,i)},p(o,l){l[0]&16&&r!==(r=Array.from(new Set(o[4].map(Lo))).join(", ")+"")&&tt(i,r)},d(o){o&&j(e)}}}function Yp(t){let e,n,r,i,o,l,a,c,s,u,d,f,h,g,x=t[3][0]+"",_,T,b,m=t[3][1]+"",y,E,C,w,I,M,S,Y,W,D,$,Z,B,ct,nt,dt,Ct,J,V,F,G,at,lt,xt=t[3][0]+"",ft,R,rt=t[3][1]+"",st,v,L,q,it=t[1],U=[];for(let O=0;O<it.length;O+=1)U[O]=Eo(Do(t,it,O));function A(O,ut){if(O[6].loading)return Op;if(O[6].error)return Rp}let N=A(t),et=N&&N(t),pt=t[4].length>0&&Io(t);return{c(){e=z("div"),n=z("div"),r=z("div"),i=z("div"),o=z("h3"),o.textContent="Countries",l=ht(),a=z("div");for(let O=0;O<U.length;O+=1)U[O].c();c=ht(),s=z("div"),u=z("h3"),u.textContent="Year Range",d=ht(),f=z("div"),h=z("div"),g=z("span"),_=H(x),T=ht(),b=z("span"),y=H(m),E=ht(),C=z("div"),w=z("input"),Y=ht(),W=z("input"),B=ht(),ct=z("div"),et&&et.c(),nt=ht(),dt=z("div"),Ct=z("div"),J=z("h3"),J.textContent="Summary",V=ht(),F=z("p"),G=H("Showing "),at=H(t[5]),lt=H(" items published between "),ft=H(xt),R=H(" and "),st=H(rt),v=ht(),pt&&pt.c(),k(o,"class","svelte-1w69s2v"),k(a,"class","facet-options svelte-1w69s2v"),k(i,"class","facet-group"),k(r,"class","facets svelte-1w69s2v"),k(u,"class","svelte-1w69s2v"),k(h,"class","slider-labels svelte-1w69s2v"),k(w,"type","range"),k(w,"min",I=t[2][0]),k(w,"max",M=t[2][t[2].length-1]),w.value=S=t[3][0],k(w,"data-index","0"),k(w,"class","svelte-1w69s2v"),k(W,"type","range"),k(W,"min",D=t[2][0]),k(W,"max",$=t[2][t[2].length-1]),W.value=Z=t[3][1],k(W,"data-index","1"),k(W,"class","svelte-1w69s2v"),k(C,"class","slider-inputs svelte-1w69s2v"),k(f,"class","slider-container svelte-1w69s2v"),k(s,"class","year-range svelte-1w69s2v"),k(n,"class","controls svelte-1w69s2v"),k(ct,"class","chart-container svelte-1w69s2v"),k(J,"class","svelte-1w69s2v"),k(F,"class","svelte-1w69s2v"),k(Ct,"class","stat-summary svelte-1w69s2v"),k(dt,"class","stats svelte-1w69s2v"),k(e,"class","type-distribution-container svelte-1w69s2v")},m(O,ut){Q(O,e,ut),p(e,n),p(n,r),p(r,i),p(i,o),p(i,l),p(i,a);for(let bt=0;bt<U.length;bt+=1)U[bt]&&U[bt].m(a,null);p(n,c),p(n,s),p(s,u),p(s,d),p(s,f),p(f,h),p(h,g),p(g,_),p(h,T),p(h,b),p(b,y),p(f,E),p(f,C),p(C,w),p(C,Y),p(C,W),p(e,B),p(e,ct),et&&et.m(ct,null),t[15](ct),p(e,nt),p(e,dt),p(dt,Ct),p(Ct,J),p(Ct,V),p(Ct,F),p(F,G),p(F,at),p(F,lt),p(F,ft),p(F,R),p(F,st),p(Ct,v),pt&&pt.m(Ct,null),L||(q=[Ut(w,"input",t[12]),Ut(W,"input",t[12])],L=!0)},p(O,ut){if(ut[0]&2050){it=O[1];let bt;for(bt=0;bt<it.length;bt+=1){const vt=Do(O,it,bt);U[bt]?U[bt].p(vt,ut):(U[bt]=Eo(vt),U[bt].c(),U[bt].m(a,null))}for(;bt<U.length;bt+=1)U[bt].d(1);U.length=it.length}ut[0]&8&&x!==(x=O[3][0]+"")&&tt(_,x),ut[0]&8&&m!==(m=O[3][1]+"")&&tt(y,m),ut[0]&4&&I!==(I=O[2][0])&&k(w,"min",I),ut[0]&4&&M!==(M=O[2][O[2].length-1])&&k(w,"max",M),ut[0]&8&&S!==(S=O[3][0])&&(w.value=S),ut[0]&4&&D!==(D=O[2][0])&&k(W,"min",D),ut[0]&4&&$!==($=O[2][O[2].length-1])&&k(W,"max",$),ut[0]&8&&Z!==(Z=O[3][1])&&(W.value=Z),N===(N=A(O))&&et?et.p(O,ut):(et&&et.d(1),et=N&&N(O),et&&(et.c(),et.m(ct,null))),ut[0]&32&&tt(at,O[5]),ut[0]&8&&xt!==(xt=O[3][0]+"")&&tt(ft,xt),ut[0]&8&&rt!==(rt=O[3][1]+"")&&tt(st,rt),O[4].length>0?pt?pt.p(O,ut):(pt=Io(O),pt.c(),pt.m(Ct,null)):pt&&(pt.d(1),pt=null)},i:Tt,o:Tt,d(O){O&&j(e),Ve(U,O),et&&et.d(),t[15](null),pt&&pt.d(),L=!1,Ot(q)}}}const ae="TypeDistribution";function Nn(t){return t?/^\d{4}$/.test(t)?parseInt(t):/^\d{4}-\d{2}$/.test(t)||/^\d{4}-\d{2}-\d{2}$/.test(t)?parseInt(t.substring(0,4)):null:null}const Lo=t=>t.type;function Wp(t,e,n){let r,i,o,l,a;yt(t,It,J=>n(6,r=J));let c=!1,s,u,d,f=0,h=0,g=[],x=[],_=[0,0],T=[],b=0,m=[];const y=gt("viz.no_data");yt(t,y,J=>n(25,a=J)),gt("viz.filter_by_country"),gt("viz.all_countries");const E=gt("viz.publication_year");yt(t,E,J=>n(24,l=J));const C=gt("viz.number_of_items");yt(t,C,J=>n(23,o=J));const w=gt("viz.toggle_types");yt(t,w,J=>n(22,i=J)),gt("viz.toggled_type");function I(){if(!r.items||r.items.length===0)return[];const J=g.filter(at=>at.selected).map(at=>at.value),V=r.items.filter(at=>{if(at.type==="Notice d'autorité")return!1;const lt=Nn(at.publication_date);return!(!lt||lt<_[0]||lt>_[1]||J.length>0&&!J.includes(at.country))});n(5,b=V.length);const F=new Map;V.forEach(at=>{const lt=Nn(at.publication_date);if(!lt)return;const xt=at.type||"Unknown",ft=`${lt}-${xt}`;F.has(ft)?F.set(ft,F.get(ft)+1):F.set(ft,1)});const G=[];return F.forEach((at,lt)=>{const[xt,ft]=lt.split("-");G.push({year:parseInt(xt),type:ft,count:at})}),G}function M(){if(!r.items||r.items.length===0)return;const J=r.items.filter(F=>Nn(F.publication_date)!==null&&F.type!=="Notice d'autorité"),V=me(J,F=>F.country||"Unknown");n(1,g=Array.from(V,([F,G])=>({value:F,label:F,count:G.length,selected:!1})).filter(F=>F.value!=="Unknown").sort((F,G)=>G.count-F.count))}function S(){if(!r.items||r.items.length===0)return;const J=r.items.filter(G=>G.type!=="Notice d'autorité").map(G=>Nn(G.publication_date)).filter(G=>G!==null);if(J.length===0)return;const V=Math.min(...J),F=Math.max(...J);n(2,x=Array.from({length:F-V+1},(G,at)=>V+at)),n(3,_=[V,F])}function Y(J){J.selected=!J.selected,n(1,g=[...g]),B()}function W(J){const V=J.target,F=parseInt(V.dataset.index||"0"),G=parseInt(V.value);F===0?n(3,_=[G,Math.max(G,_[1])]):n(3,_=[Math.min(G,_[0]),G]),B()}function D(){try{d&&document.body.contains(d)&&document.body.removeChild(d),d=document.createElement("div"),d.style.position="absolute",d.style.backgroundColor="rgba(0, 0, 0, 0.8)",d.style.color="white",d.style.padding="8px 12px",d.style.borderRadius="4px",d.style.pointerEvents="none",d.style.display="none",d.style.fontSize="12px",d.style.zIndex="1000",d.style.boxShadow="0 2px 5px rgba(0,0,0,0.2)",document&&document.body&&document.body.appendChild(d)}catch(J){console.error("Error creating tooltip:",J)}}function $(J,V,F){try{if((!d||!document.body.contains(d))&&D(),!d)return;const G=V.data.year,at=F.map(st=>{const v=st.find(L=>L.data.year===G);return{type:st.key,count:v?v[1]-v[0]:0}}).filter(st=>st.count>0),lt=at.reduce((st,v)=>st+v.count,0);d.innerHTML=`
                <div style="font-weight:bold;margin-bottom:4px;border-bottom:1px solid rgba(255,255,255,0.3);padding-bottom:2px;">
                    Year: ${G}
                </div>
                <div style="display:grid;grid-template-columns:auto 1fr 1fr;gap:4px;">
                    <span style="font-weight:bold">Type</span>
                    <span style="text-align:right;font-weight:bold">Count</span>
                    <span style="text-align:right;font-weight:bold">%</span>
                    ${at.map(st=>`
                        <span>${st.type}</span>
                        <span style="text-align:right">${st.count}</span>
                        <span style="text-align:right">${(st.count/lt*100).toFixed(1)}%</span>
                    `).join("")}
                    <span style="border-top:1px solid rgba(255,255,255,0.3);font-weight:bold;margin-top:2px;padding-top:2px;">Total</span>
                    <span style="border-top:1px solid rgba(255,255,255,0.3);text-align:right;font-weight:bold;margin-top:2px;padding-top:2px;">${lt}</span>
                    <span></span>
                </div>
            `;const xt=250,ft=150;let R=J.pageX+10,rt=J.pageY+10;R+xt>window.innerWidth&&(R=J.pageX-xt-10),rt+ft>window.innerHeight&&(rt=J.pageY-ft-10),d.style.left=`${R}px`,d.style.top=`${rt}px`,d.style.display="block"}catch(G){console.error("Error showing tooltip:",G)}}function Z(){try{d&&document.body.contains(d)&&(d.style.display="none")}catch(J){console.error("Error hiding tooltip:",J)}}function B(){if(!u){console.error("Container element not found in updateVisualization");return}if(n(4,T=I()),T.length===0){_t(u).select("svg").remove(),_t(u).select(".no-data").remove(),_t(u).append("div").attr("class","no-data").style("position","absolute").style("top","50%").style("left","50%").style("transform","translate(-50%, -50%)").style("text-align","center").style("color","var(--text-color-secondary)").text(a);return}_t(u).select("svg").remove(),_t(u).select(".no-data").remove();const J=u.getBoundingClientRect();f=J.width,h=J.height;const V={top:40,right:60,bottom:120,left:60},F=f-V.left-V.right,G=h-V.top-V.bottom,at=Array.from(new Set(T.map(N=>N.type)));if(m.length===0)m=at.map(N=>({type:N,visible:!0}));else{const N=m.map(et=>et.type);at.forEach(et=>{N.includes(et)||m.push({type:et,visible:!0})})}const lt=Array.from(me(T.filter(N=>{var et;return((et=m.find(pt=>pt.type===N.type))==null?void 0:et.visible)??!0}),N=>N.year),([N,et])=>{const pt={year:N};return et.forEach(O=>{pt[O.type]=O.count}),pt}).sort((N,et)=>N.year-et.year),xt=at.filter(N=>{var et;return((et=m.find(pt=>pt.type===N))==null?void 0:et.visible)??!0}),ft=_t(u).append("svg").attr("width",f).attr("height",h),R=ft.append("g").attr("transform",`translate(${V.left}, ${V.top})`),rt=ni().domain(lt.map(N=>N.year.toString())).range([0,F]).padding(.1),st=Gh().keys(xt).value((N,et)=>N[et]||0)(lt),v=yn().domain([0,Ue(st.length>0?st[st.length-1]:[],N=>N[1])||0]).range([G,0]),L=Se().domain(at).range(Tn);R.append("g").attr("transform",`translate(0, ${G})`).call(Wn(rt).tickSizeOuter(0)).selectAll("text").style("text-anchor","middle").attr("dy","0.8em").style("font-size","var(--font-size-xs)").style("fill","var(--text-color-primary)"),R.append("g").call(Pn(v).ticks(5)).selectAll("text").style("font-size","var(--font-size-xs)").style("fill","var(--text-color-primary)"),R.append("text").attr("text-anchor","middle").attr("x",F/2).attr("y",G+V.bottom-10).attr("fill","var(--text-color-secondary)").style("font-size","var(--font-size-sm)").text(l),R.append("text").attr("text-anchor","middle").attr("transform","rotate(-90)").attr("x",-G/2).attr("y",-V.left+15).attr("fill","var(--text-color-secondary)").style("font-size","var(--font-size-sm)").text(o),R.selectAll(".type-bars").data(st).enter().append("g").attr("class","type-bars").attr("fill",N=>L(N.key)).selectAll("rect").data(N=>N).enter().append("rect").attr("x",N=>rt(N.data.year.toString())||0).attr("y",N=>v(N[1])).attr("height",N=>v(N[0])-v(N[1])).attr("width",rt.bandwidth()).attr("stroke","white").attr("stroke-width",1).on("mouseenter",(N,et)=>{$(N,et,st)}).on("mousemove",(N,et)=>{$(N,et,st)}).on("mouseleave",()=>{Z()}),ft.append("text").attr("x",f/2).attr("y",20).attr("text-anchor","middle").attr("font-size","var(--font-size-lg)").attr("font-weight","bold").attr("fill","var(--text-color-primary)").text(`Item Types by Publication Year (${b} items)`);const q=150,it=Math.floor(F/q),U=25,A=ft.append("g").attr("class","legend").attr("transform",`translate(${V.left}, ${V.top+G+40})`);A.append("text").attr("x",0).attr("y",-10).attr("font-size","var(--font-size-sm)").attr("font-weight","bold").attr("fill","var(--text-color-primary)").text(i),at.forEach((N,et)=>{var P;const pt=((P=m.find(ot=>ot.type===N))==null?void 0:P.visible)??!0,O=Math.floor(et/it),ut=et%it,bt=A.append("g").attr("transform",`translate(${ut*q}, ${O*U})`).attr("class","legend-item").attr("role","button").style("cursor","pointer");bt.append("rect").attr("x",-5).attr("y",-5).attr("width",q-10).attr("height",20).attr("fill","transparent").attr("class","legend-hitbox"),bt.append("rect").attr("width",14).attr("height",14).attr("fill",L(N)).attr("stroke",pt?"none":"#999").attr("stroke-width",pt?0:1).attr("opacity",pt?1:.5);const vt=bt.append("text").attr("x",24).attr("y",12).attr("font-size","var(--font-size-sm)").attr("fill","var(--text-color-primary)").style("opacity",pt?1:.5).text(N);if(!pt){const ot=vt.node();if(ot){const X=ot.getComputedTextLength();bt.append("line").attr("x1",24).attr("y1",12).attr("x2",24+X).attr("y2",12).attr("stroke","var(--text-color-primary)").attr("stroke-width",1).attr("opacity",.7)}}bt.on("click",()=>{console.log(`Clicked on type: ${N}`),_t(u).append("div").attr("class","debug-message").style("position","fixed").style("bottom","10px").style("left","10px").style("background","rgba(0,0,0,0.7)").style("color","white").style("padding","5px 10px").style("border-radius","4px").style("z-index",9999).text(`Toggled type: ${N}`).transition().duration(2e3).style("opacity",0).remove();const ot=m.findIndex(X=>X.type===N);ot>=0&&(m[ot].visible=!m[ot].visible,m=[...m],B())}).attr("tabindex","0").on("keydown",ot=>{if(ot.key==="Enter"||ot.key===" "){ot.preventDefault();const X=m.findIndex(K=>K.type===N);X>=0&&(m[X].visible=!m[X].visible,m=[...m],B())}}),bt.on("mouseenter",function(){_t(this).select("text").style("font-weight","bold"),_t(this).select(".legend-hitbox").attr("fill","rgba(0,0,0,0.05)")}).on("mouseleave",function(){_t(this).select("text").style("font-weight","normal"),_t(this).select(".legend-hitbox").attr("fill","transparent")})})}function ct(J){!c||!u||(kt(ae,"Items store changed",{itemCount:(J==null?void 0:J.length)||0}),document.body.contains(u)&&(M(),S(),B()))}_e(async()=>{if(c=!0,kt(ae,"Component mounted"),await Te(),!u){console.error("Container element not found in onMount");return}D(),s=It.subscribe(V=>{ct(V.items)}),r.items&&r.items.length>0?(M(),S(),B()):It.loadItems();const J=new ResizeObserver(()=>{c&&u&&document.body.contains(u)&&B()});return J.observe(u),()=>{c=!1,kt(ae,"Component cleanup started");try{J.disconnect(),kt(ae,"Resize observer disconnected")}catch(V){console.error("Error disconnecting resize observer:",V)}try{d&&document.body.contains(d)&&(document.body.removeChild(d),kt(ae,"Tooltip removed"))}catch(V){console.error("Error removing tooltip:",V)}s&&(s(),kt(ae,"Unsubscribed from items store")),kt(ae,"Component cleanup completed")}}),lr(()=>{c&&(c=!1,kt(ae,"Component destroyed (backup cleanup)"),s&&(s(),kt(ae,"Unsubscribed from items store (backup)")))});const nt=J=>Y(J),dt=(J,V)=>V.key==="Enter"&&Y(J);function Ct(J){fe[J?"unshift":"push"](()=>{u=J,n(0,u)})}return[u,g,x,_,T,b,r,y,E,C,w,Y,W,nt,dt,Ct]}class Pp extends Jt{constructor(e){super(),Qt(this,e,Wp,Yp,Vt,{},null,[-1,-1])}}function Bp(t){let e,n=t[4].error+"",r;return{c(){e=z("div"),r=H(n),k(e,"class","error svelte-dvynwo")},m(i,o){Q(i,e,o),p(e,r)},p(i,o){o[0]&16&&n!==(n=i[4].error+"")&&tt(r,n)},d(i){i&&j(e)}}}function qp(t){let e;return{c(){e=z("div"),e.textContent=`${wt("ui.loading")}`,k(e,"class","loading svelte-dvynwo")},m(n,r){Q(n,e,r)},p:Tt,d(n){n&&j(e)}}}function Uo(t){let e,n,r,i,o=Math.round(t[1]/t[2]).toLocaleString()+"",l;return{c(){e=z("p"),n=H(t[5]),r=H(": "),i=z("strong"),l=H(o),k(e,"class","svelte-dvynwo")},m(a,c){Q(a,e,c),p(e,n),p(e,r),p(e,i),p(i,l)},p(a,c){c[0]&32&&tt(n,a[5]),c[0]&6&&o!==(o=Math.round(a[1]/a[2]).toLocaleString()+"")&&tt(l,o)},d(a){a&&j(e)}}}function Vp(t){let e,n;return{c(){e=z("p"),n=H(t[6]),k(e,"class","svelte-dvynwo")},m(r,i){Q(r,e,i),p(e,n)},p(r,i){i[0]&64&&tt(n,r[6])},d(r){r&&j(e)}}}function Xp(t){let e,n,r,i,o=t[3].data.name+"",l,a,c,s;return{c(){e=z("p"),n=H(t[10]),r=H(": "),i=z("strong"),l=H(o),a=ht(),c=z("p"),s=H(t[11]),k(e,"class","svelte-dvynwo"),k(c,"class","svelte-dvynwo")},m(u,d){Q(u,e,d),p(e,n),p(e,r),p(e,i),p(i,l),Q(u,a,d),Q(u,c,d),p(c,s)},p(u,d){d[0]&1024&&tt(n,u[10]),d[0]&8&&o!==(o=u[3].data.name+"")&&tt(l,o),d[0]&2048&&tt(s,u[11])},d(u){u&&j(e),u&&j(a),u&&j(c)}}}function Kp(t){let e,n,r,i,o,l,a,c,s,u,d,f,h,g,x,_,T,b,m=t[1].toLocaleString()+"",y,E,C;function w($,Z){if($[4].loading)return qp;if($[4].error)return Bp}let I=w(t),M=I&&I(t),S=t[2]>0&&Uo(t);function Y($,Z){return $[3]?Xp:Vp}let W=Y(t),D=W(t);return{c(){e=z("div"),n=z("div"),M&&M.c(),r=ht(),i=z("div"),o=z("div"),l=z("h3"),a=H(t[7]),c=ht(),s=z("p"),u=H(t[8]),d=H(": "),f=z("strong"),h=H(t[2]),g=ht(),x=z("p"),_=H(t[9]),T=H(": "),b=z("strong"),y=H(m),E=ht(),S&&S.c(),C=ht(),D.c(),k(n,"class","chart-container svelte-dvynwo"),k(l,"class","svelte-dvynwo"),k(s,"class","svelte-dvynwo"),k(x,"class","svelte-dvynwo"),k(o,"class","stat-summary svelte-dvynwo"),k(i,"class","stats svelte-dvynwo"),k(e,"class","word-distribution-container svelte-dvynwo")},m($,Z){Q($,e,Z),p(e,n),M&&M.m(n,null),t[25](n),p(e,r),p(e,i),p(i,o),p(o,l),p(l,a),p(o,c),p(o,s),p(s,u),p(s,d),p(s,f),p(f,h),p(o,g),p(o,x),p(x,_),p(x,T),p(x,b),p(b,y),p(o,E),S&&S.m(o,null),p(o,C),D.m(o,null)},p($,Z){I===(I=w($))&&M?M.p($,Z):(M&&M.d(1),M=I&&I($),M&&(M.c(),M.m(n,null))),Z[0]&128&&tt(a,$[7]),Z[0]&256&&tt(u,$[8]),Z[0]&4&&tt(h,$[2]),Z[0]&512&&tt(_,$[9]),Z[0]&2&&m!==(m=$[1].toLocaleString()+"")&&tt(y,m),$[2]>0?S?S.p($,Z):(S=Uo($),S.c(),S.m(o,C)):S&&(S.d(1),S=null),W===(W=Y($))&&D?D.p($,Z):(D.d(1),D=W($),D&&(D.c(),D.m(o,null)))},i:Tt,o:Tt,d($){$&&j(e),M&&M.d(),t[25](null),S&&S.d(),D.d()}}}const Nt="WordDistribution";function jp(t,e,n){let r,i,o,l,a,c,s,u,d,f,h,g,x,_;yt(t,It,v=>n(4,r=v));let T=!1,b,m,y,E=0,C=0,w=0,I=0,M={name:"root",children:[]},S=null;const Y=gt("viz.no_data");yt(t,Y,v=>n(37,d=v)),gt("viz.word_distribution");const W=gt("viz.total_words");yt(t,W,v=>n(9,g=v));const D=gt("viz.avg_words_per_item");yt(t,D,v=>n(5,l=v));const $=gt("viz.click_zoom_in");yt(t,$,v=>n(6,s=v)),gt("viz.click_zoom_out"),gt("viz.unknown"),gt("viz.no_set");const Z=gt("viz.back_to_all");yt(t,Z,v=>n(36,u=v));const B=gt("viz.currently_viewing");yt(t,B,v=>n(10,x=v));const ct=gt("viz.click_back_to_return");yt(t,ct,v=>n(11,_=v));const nt=gt("viz.total_items_with_word_count");yt(t,nt,v=>n(8,h=v));const dt=gt("viz.summary");yt(t,dt,v=>n(7,f=v));const Ct=gt("viz.words");yt(t,Ct,v=>n(35,c=v));const J=gt("viz.items");yt(t,J,v=>n(34,a=v));const V=gt("viz.percent_of_country");yt(t,V,v=>n(33,o=v));const F=gt("viz.percent_of_total");yt(t,F,v=>n(32,i=v)),gt("viz.item_set_summary");function G(){if(!r.items||r.items.length===0)return{name:"root",children:[]};const v=r.items.filter(it=>it.word_count!==void 0);n(2,I=v.length),n(1,w=v.reduce((it,U)=>it+(U.word_count||0),0));const L=me(v,it=>it.country||"Unknown"),q={name:"Word Distribution",children:[]};return L.forEach((it,U)=>{const A=me(it,et=>et.item_set_title||"No Set"),N={name:U,children:[],wordCount:0,itemCount:it.length};A.forEach((et,pt)=>{const O=et.reduce((bt,vt)=>bt+(vt.word_count||0),0),ut={name:pt,value:O,wordCount:O,itemCount:et.length};N.children.push(ut),N.wordCount!==void 0?N.wordCount+=O:N.wordCount=O}),N.children.sort((et,pt)=>(pt.wordCount||0)-(et.wordCount||0)),q.children.push(N)}),q.children.sort((it,U)=>(U.wordCount||0)-(it.wordCount||0)),q}function at(v){if(n(3,S=v),S&&(!S.children||S.children.length===0)){const L={name:S.data.name,children:S.data.children||[],wordCount:S.data.wordCount,itemCount:S.data.itemCount};if(!L.children||L.children.length===0){console.warn("Cannot zoom to node without children");return}}lt()}function lt(){var v;try{if(!m){console.error("Container element not found");return}if(S||(M=G()),!M.children||M.children.length===0){_t(m).select("svg").remove(),_t(m).append("div").attr("class","no-data").style("position","absolute").style("top","50%").style("left","50%").style("transform","translate(-50%, -50%)").style("text-align","center").style("color","var(--text-color-secondary)").text(d);return}_t(m).select("svg").remove(),_t(m).select(".no-data").remove();const L=m.getBoundingClientRect();E=L.width,C=L.height;const q={top:40,right:10,bottom:10,left:10},it=E-q.left-q.right,U=C-q.top-q.bottom,A=_t(m).append("svg").attr("width",E).attr("height",C),N=S?`${S.data.name}: ${((v=S.data.wordCount)==null?void 0:v.toLocaleString())||0} ${c} (${S.data.itemCount} ${a})`:wt("viz.word_distribution_subtitle",[I.toString(),w.toLocaleString()]);A.append("text").attr("x",E/2).attr("y",20).attr("text-anchor","middle").attr("font-size","var(--font-size-lg)").attr("font-weight","bold").attr("fill","var(--text-color-primary)").text(N);const et=A.append("g").attr("transform",`translate(${q.left}, ${q.top})`);if(S){const P=A.append("g").attr("class","zoom-out-button").attr("transform",`translate(${q.left}, ${q.top-30})`).style("cursor","pointer").on("click",()=>at(null));P.append("rect").attr("width",100).attr("height",24).attr("rx",4).attr("fill","var(--primary-color)").attr("opacity",.8),P.append("text").attr("x",50).attr("y",16).attr("text-anchor","middle").attr("fill","white").attr("font-size","var(--font-size-sm)").text(u)}const pt=Ul().size([it,U]).paddingOuter(4).paddingTop(20).paddingInner(1).round(!0);let O;if(S)if(S.data.children&&S.data.children.length>0){const P={name:S.data.name,children:S.data.children};O=re(P).sum(ot=>ot.value||0).sort((ot,X)=>(X.value||0)-(ot.value||0))}else if(S.children&&S.children.length>0){const P=S.children.map(X=>({name:X.data.name,value:X.data.value||X.value,wordCount:X.data.wordCount,itemCount:X.data.itemCount})),ot={name:S.data.name,children:P};O=re(ot).sum(X=>X.value||0).sort((X,K)=>(K.value||0)-(X.value||0))}else console.warn("Zoomed node has no valid children data, falling back to full hierarchy"),M=G(),O=re(M).sum(P=>P.value||0).sort((P,ot)=>(ot.value||0)-(P.value||0));else O=re(M).sum(P=>P.value||0).sort((P,ot)=>(ot.value||0)-(P.value||0));try{pt(O)}catch(P){console.error("Error applying treemap layout:",P),n(3,S=null),M=G(),O=re(M).sum(ot=>ot.value||0).sort((ot,X)=>(X.value||0)-(ot.value||0)),pt(O)}const ut=Se().domain(O.children?O.children.map(P=>P.data.name):[O.data.name]).range(Tn),bt=et.selectAll(".country").data(S?[]:O.children||[]).enter().append("g").attr("class","country").attr("transform",P=>{const ot=P.x0||0,X=P.y0||0;return`translate(${ot},${X})`});bt.append("rect").attr("width",P=>{const ot=P.x0||0,X=P.x1||0;return Math.max(0,X-ot)}).attr("height",P=>{const ot=P.y0||0,X=P.y1||0;return Math.max(0,X-ot)}).attr("fill",P=>ut(P.data.name)).attr("stroke","white").attr("stroke-width",2).style("opacity",.7).style("cursor","pointer").on("click",(P,ot)=>{at(ot)}).attr("title",s).append("title").text(()=>s),bt.append("text").attr("x",5).attr("y",15).attr("font-size","var(--font-size-sm)").attr("font-weight","bold").attr("fill","white").text(P=>{var ot;return`${P.data.name} (${((ot=P.data.wordCount)==null?void 0:ot.toLocaleString())||0} ${c})`}).style("pointer-events","none").each(function(P){var mt;const ot=_t(this),X=this.getComputedTextLength(),K=P.x1-P.x0-10;X>K&&ot.text(P.data.name).append("title").text(`${P.data.name} (${((mt=P.data.wordCount)==null?void 0:mt.toLocaleString())||0} ${c})`)});const vt=et.selectAll(".item-set").data(S?O.children||[]:O.leaves()).enter().append("g").attr("class","item-set").attr("transform",P=>{const ot=P.x0||0,X=P.y0||0;return`translate(${ot},${X})`});vt.append("rect").attr("width",P=>{const ot=P.x0||0,X=P.x1||0;return Math.max(0,X-ot)}).attr("height",P=>{const ot=P.y0||0,X=P.y1||0;return Math.max(0,X-ot)}).attr("fill",P=>{var K,mt;const ot=ut(S?S.data.name:((mt=(K=P.parent)==null?void 0:K.data)==null?void 0:mt.name)||"Unknown"),X=ve(ot);return ve(X).brighter(.7).toString()}).attr("stroke","white").attr("stroke-width",.5).style("cursor","pointer").on("mouseover",function(P,ot){_t(this).attr("stroke","var(--primary-color)").attr("stroke-width",2),ft(ot,P)}).on("mousemove",function(P,ot){ft(ot,P)}).on("mouseout",function(){_t(this).attr("stroke","white").attr("stroke-width",.5),R()}),vt.append("text").attr("x",3).attr("y",13).attr("font-size","var(--font-size-xs)").attr("fill","var(--text-color-primary)").style("pointer-events","none").each(function(P){var Qe;const ot=_t(this),X=P.x1-P.x0,K=P.y1-P.y0;if(X<30||K<20)return;let mt=P.data.name;const Mt=X-6,ee=S?S.data.name:P.parent?P.parent.data.name:"";ot.text(mt).append("title").text(`${ee} > ${P.data.name}: ${((Qe=P.data.wordCount)==null?void 0:Qe.toLocaleString())||0} ${c} (${P.data.itemCount} ${a})`);const Ft=this;let Cn=Ft.getComputedTextLength(),zn=!1;for(;Cn>Mt&&mt.length>3;)mt=mt.slice(0,-1),ot.text(mt),Cn=Ft.getComputedTextLength(),zn=!0;zn&&ot.text(mt+"...")})}catch(L){console.error("Error in updateVisualization:",L)}}function xt(){try{y&&document.body.contains(y)&&document.body.removeChild(y),y=document.createElement("div"),y.style.position="absolute",y.style.backgroundColor="rgba(0, 0, 0, 0.8)",y.style.color="white",y.style.padding="8px 12px",y.style.borderRadius="4px",y.style.pointerEvents="none",y.style.display="none",y.style.fontSize="12px",y.style.zIndex="1000",y.style.boxShadow="0 2px 5px rgba(0,0,0,0.2)",document&&document.body&&document.body.appendChild(y)}catch(v){console.error("Error creating tooltip:",v)}}function ft(v,L){try{if((!y||!document.body.contains(y))&&(kt(Nt,"Tooltip element not found, creating new one"),xt()),!L){kt(Nt,"Event object is undefined in showTooltip");return}const q=v.parent?v.parent.data.name:v.data.name,it=v.parent?v.data.name:"All",U=v.data.wordCount||0,A=v.data.itemCount||0,N=A>0?Math.round(U/A):0,et=S?S.data.wordCount:v.parent?v.parent.data.wordCount:0,pt=et&&et>0?(U/et*100).toFixed(1)+"%":"N/A",O=w>0?(U/w*100).toFixed(1)+"%":"N/A";y.innerHTML=`
                <div style="font-weight:bold;margin-bottom:4px;border-bottom:1px solid rgba(255,255,255,0.3);padding-bottom:2px;">
                    ${q} > ${it}
                </div>
                <div style="display:grid;grid-template-columns:auto auto;gap:4px;">
                    <span>${c}:</span>
                    <span style="text-align:right;font-weight:bold">${U.toLocaleString()}</span>
                    <span>${a}:</span>
                    <span style="text-align:right">${A}</span>
                    <span>${l}:</span>
                    <span style="text-align:right">${N}</span>
                    <span>${o}:</span>
                    <span style="text-align:right">${pt}</span>
                    <span>${i}:</span>
                    <span style="text-align:right">${O}</span>
                </div>
            `;const ut=200,bt=120;let vt=0,P=0;try{vt=L.pageX+10,P=L.pageY+10,vt+ut>window.innerWidth&&(vt=L.pageX-ut-10),P+bt>window.innerHeight&&(P=L.pageY-bt-10),vt=Math.max(0,vt),P=Math.max(0,P)}catch(ot){kt(Nt,"Error calculating tooltip position",ot),vt=window.innerWidth/2-ut/2,P=window.innerHeight/2-bt/2}y.style.left=`${vt}px`,y.style.top=`${P}px`,y.style.display="block",kt(Nt,"Tooltip shown",{country:q,itemSet:it,position:{left:vt,top:P}})}catch(q){console.error("Error showing tooltip:",q),kt(Nt,"Error showing tooltip",q)}}function R(){try{y&&document.body.contains(y)&&(y.style.display="none")}catch(v){console.error("Error hiding tooltip:",v)}}function rt(v){!T||!m||(kt(Nt,"Items store changed",{itemCount:(v==null?void 0:v.length)||0}),document.body.contains(m)&&lt())}_e(async()=>{try{if(T=!0,kt(Nt,"Component mounted"),await Te(),!m){console.error("Container element not found in onMount");return}xt(),b=It.subscribe(L=>{rt(L.items)}),r.items&&r.items.length>0?lt():It.loadItems();const v=new ResizeObserver(()=>{T&&m&&document.body.contains(m)&&lt()});return v.observe(m),()=>{try{T=!1,kt(Nt,"Component cleanup started"),v&&(v.disconnect(),kt(Nt,"Resize observer disconnected")),m&&(_t(m).selectAll("*").remove(),kt(Nt,"D3 selections removed")),y&&document.body.contains(y)&&(document.body.removeChild(y),kt(Nt,"Tooltip removed")),b&&(b(),kt(Nt,"Unsubscribed from items store")),kt(Nt,"Component cleanup completed")}catch(L){console.error("Error during cleanup:",L)}}}catch(v){console.error("Error in onMount:",v)}}),lr(()=>{if(T){T=!1,kt(Nt,"Component destroyed (backup cleanup)");try{b&&(b(),kt(Nt,"Unsubscribed from items store (backup)")),y&&document.body.contains(y)&&(document.body.removeChild(y),kt(Nt,"Tooltip removed (backup)"))}catch(v){console.error("Error during backup cleanup:",v)}}});function st(v){fe[v?"unshift":"push"](()=>{m=v,n(0,m)})}return[m,w,I,S,r,l,s,f,h,g,x,_,Y,W,D,$,Z,B,ct,nt,dt,Ct,J,V,F,st]}class Zp extends Jt{constructor(e){super(),Qt(this,e,jp,Kp,Vt,{},null,[-1,-1])}}function Fo(t,e,n){const r=t.slice();return r[13]=e[n],r}function Ho(t){let e,n=wt(t[13].label)+"",r,i,o,l,a;function c(){return t[3](t[13])}function s(...u){return t[4](t[13],...u)}return{c(){e=z("li"),r=H(n),i=ht(),k(e,"role","tab"),k(e,"tabindex","0"),k(e,"aria-selected",o=t[0]===t[13].id),k(e,"class","svelte-s68afz"),ye(e,"active",t[0]===t[13].id)},m(u,d){Q(u,e,d),p(e,r),p(e,i),l||(a=[Ut(e,"click",c),Ut(e,"keydown",s)],l=!0)},p(u,d){t=u,d&1&&o!==(o=t[0]===t[13].id)&&k(e,"aria-selected",o),d&5&&ye(e,"active",t[0]===t[13].id)},d(u){u&&j(e),l=!1,Ot(a)}}}function Gp(t){let e,n;return e=new Zp({}),{c(){Xt(e.$$.fragment)},m(r,i){Pt(e,r,i),n=!0},p:Tt,i(r){n||(St(e.$$.fragment,r),n=!0)},o(r){$t(e.$$.fragment,r),n=!1},d(r){Bt(e,r)}}}function Qp(t){let e,n;return e=new Dp({}),{c(){Xt(e.$$.fragment)},m(r,i){Pt(e,r,i),n=!0},p:Tt,i(r){n||(St(e.$$.fragment,r),n=!0)},o(r){$t(e.$$.fragment,r),n=!1},d(r){Bt(e,r)}}}function Jp(t){let e,n;return e=new Pp({}),{c(){Xt(e.$$.fragment)},m(r,i){Pt(e,r,i),n=!0},p:Tt,i(r){n||(St(e.$$.fragment,r),n=!0)},o(r){$t(e.$$.fragment,r),n=!1},d(r){Bt(e,r)}}}function tg(t){let e,n;return e=new Hp({}),{c(){Xt(e.$$.fragment)},m(r,i){Pt(e,r,i),n=!0},p:Tt,i(r){n||(St(e.$$.fragment,r),n=!0)},o(r){$t(e.$$.fragment,r),n=!1},d(r){Bt(e,r)}}}function eg(t){let e,n;return e=new zp({}),{c(){Xt(e.$$.fragment)},m(r,i){Pt(e,r,i),n=!0},p:Tt,i(r){n||(St(e.$$.fragment,r),n=!0)},o(r){$t(e.$$.fragment,r),n=!1},d(r){Bt(e,r)}}}function ng(t){let e,n;return e=new bp({}),{c(){Xt(e.$$.fragment)},m(r,i){Pt(e,r,i),n=!0},p:Tt,i(r){n||(St(e.$$.fragment,r),n=!0)},o(r){$t(e.$$.fragment,r),n=!1},d(r){Bt(e,r)}}}function rg(t){let e,n=t[1].error+"",r;return{c(){e=z("div"),r=H(n),k(e,"class","error svelte-s68afz")},m(i,o){Q(i,e,o),p(e,r)},p(i,o){o&2&&n!==(n=i[1].error+"")&&tt(r,n)},i:Tt,o:Tt,d(i){i&&j(e)}}}function ig(t){let e;return{c(){e=z("div"),e.textContent=`${wt("ui.loading")}`,k(e,"class","loading svelte-s68afz")},m(n,r){Q(n,e,r)},p:Tt,i:Tt,o:Tt,d(n){n&&j(e)}}}function og(t){let e,n,r,i,o,l,a,c,s,u,d,f,h,g,x,_;l=new xa({});let T=t[2],b=[];for(let w=0;w<T.length;w+=1)b[w]=Ho(Fo(t,T,w));const m=[ig,rg,ng,eg,tg,Jp,Qp,Gp],y=[];function E(w,I){return w[1].loading?0:w[1].error?1:w[0]==="countries"?2:w[0]==="languages"?3:w[0]==="timeline"?4:w[0]==="types"?5:w[0]==="categories"?6:w[0]==="words"?7:-1}~(f=E(t))&&(h=y[f]=m[f](t));let C=ka;return{c(){e=z("main"),n=z("header"),r=z("div"),i=z("h1"),i.textContent=`${wt("app.title")}`,o=ht(),Xt(l.$$.fragment),a=ht(),c=z("nav"),s=z("ul");for(let w=0;w<b.length;w+=1)b[w].c();u=ht(),d=z("div"),h&&h.c(),g=ht(),x=Ko(),k(i,"class","svelte-s68afz"),k(r,"class","header-top svelte-s68afz"),k(s,"class","tabs svelte-s68afz"),k(n,"class","svelte-s68afz"),k(d,"class","content svelte-s68afz"),k(e,"class","svelte-s68afz")},m(w,I){Q(w,e,I),p(e,n),p(n,r),p(r,i),p(r,o),Pt(l,r,null),p(n,a),p(n,c),p(c,s);for(let M=0;M<b.length;M+=1)b[M]&&b[M].m(s,null);p(e,u),p(e,d),~f&&y[f].m(d,null),Q(w,g,I),Q(w,x,I),_=!0},p(w,I){if(I&5){T=w[2];let S;for(S=0;S<T.length;S+=1){const Y=Fo(w,T,S);b[S]?b[S].p(Y,I):(b[S]=Ho(Y),b[S].c(),b[S].m(s,null))}for(;S<b.length;S+=1)b[S].d(1);b.length=T.length}let M=f;f=E(w),f===M?~f&&y[f].p(w,I):(h&&(Pr(),$t(y[M],1,1,()=>{y[M]=null}),Br()),~f?(h=y[f],h?h.p(w,I):(h=y[f]=m[f](w),h.c()),St(h,1),h.m(d,null)):h=null)},i(w){_||(St(l.$$.fragment,w),St(h),St(C),_=!0)},o(w){$t(l.$$.fragment,w),$t(h),$t(C),_=!1},d(w){w&&j(e),Bt(l),Ve(b,w),~f&&y[f].d(),w&&j(g),w&&j(x)}}}function lg(t){let e,n;return e=new $a({props:{$$slots:{default:[og]},$$scope:{ctx:t}}}),{c(){Xt(e.$$.fragment)},m(r,i){Pt(e,r,i),n=!0},p(r,[i]){const o={};i&65539&&(o.$$scope={dirty:i,ctx:r}),e.$set(o)},i(r){n||(St(e.$$.fragment,r),n=!0)},o(r){$t(e.$$.fragment,r),n=!1},d(r){Bt(e,r)}}}const jt="App";function ag(t,e,n){let r,i;yt(t,Yt,_=>n(11,r=_)),yt(t,It,_=>n(1,i=_));let o=!1,l,a=0,c=0,s="countries";const u=[{id:"countries",label:"tab.countries"},{id:"languages",label:"tab.languages"},{id:"timeline",label:"tab.timeline"},{id:"types",label:"tab.types"},{id:"categories",label:"tab.categories"},{id:"words",label:"tab.words"}];let d="",f="";function h(_){var T;if(!o){kt(jt,`Language change ignored (not mounted): ${_}`);return}f=d,d=_,kt(jt,`Language changed from ${f} to ${_}`,{isMounted:o,updateCount:a,subscriptionActive:!!l}),kt(jt,"Current translations:",{title:wt("app.title"),loading:wt("ui.loading"),activeTab:wt(((T=u.find(b=>b.id===s))==null?void 0:T.label)||"")})}return jo(()=>{c++,kt(jt,`Before update (render #${c})`,{isMounted:o,currentLanguage:d,activeTab:s})}),_e(()=>{o=!0,kt(jt,`Component mounted, initial language: ${r}`,{storeValue:r,activeTab:s}),d=r;try{l=Yt.subscribe(_=>{h(_)}),kt(jt,"Subscribed to language store")}catch(_){kt(jt,"Error subscribing to language store",_)}It.loadItems()}),lr(()=>{if(kt(jt,"Component being destroyed",{isMounted:o,currentLanguage:d,hasUnsubscribe:!!l}),o=!1,l)try{l(),kt(jt,"Unsubscribed from language store"),l=void 0}catch(_){kt(jt,"Error unsubscribing from language store",_)}}),Zo(()=>{a++,kt(jt,`Component updated (${a})`,{isMounted:o,currentLanguage:d,storeValue:r,activeTab:s})}),[s,i,u,_=>n(0,s=_.id),(_,T)=>T.key==="Enter"&&n(0,s=_.id)]}class sg extends Jt{constructor(e){super(),Qt(this,e,ag,lg,Vt,{})}}new sg({target:document.getElementById("app")});
